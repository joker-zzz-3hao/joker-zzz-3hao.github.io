(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{"+K+b":function(ae,Z,w){var N=w("JHRd");function G(H){var B=new H.constructor(H.byteLength);return new N(B).set(new N(H)),B}ae.exports=G},"+Qka":function(ae,Z,w){var N=w("fmRc"),G=w("t2Dn"),H=w("cq/+"),B=w("T1AV"),h=w("GoyQ"),z=w("mTTR"),U=w("itsj");function Q(se,Ce,be,st,tt){se!==Ce&&H(Ce,function(ut,ht){if(tt||(tt=new N),h(ut))B(se,Ce,ht,be,Q,st,tt);else{var gt=st?st(U(se,ht),ut,ht+"",se,Ce,tt):void 0;gt===void 0&&(gt=ut),G(se,ht,gt)}},z)}ae.exports=Q},"+iFO":function(ae,Z,w){var N=w("dTAl"),G=w("LcsW"),H=w("6sVZ");function B(h){return typeof h.constructor=="function"&&!H(h)?N(G(h)):{}}ae.exports=B},"/ezw":function(ae,Z,w){"use strict";var N=w("rePB"),G=w("wx14"),H=w("U8pU"),B=w("q1tI"),h=w("TSYQ"),z=w.n(h),U=function(de){var Ie=de.prefixCls,we=de.className,ct=de.width,ot=de.style;return B.createElement("h3",{className:z()(Ie,we),style:Object(G.a)({width:ct},ot)})},Q=U,se=w("KQm4"),Ce=function(de){var Ie=function(Pt){var Ft=de.width,Et=de.rows,St=Et===void 0?2:Et;if(Array.isArray(Ft))return Ft[Pt];if(St-1===Pt)return Ft},we=de.prefixCls,ct=de.className,ot=de.style,wt=de.rows,S=Object(se.a)(Array(wt)).map(function(ur,Pt){return B.createElement("li",{key:Pt,style:{width:Ie(Pt)}})});return B.createElement("ul",{className:z()(we,ct),style:ot},S)},be=Ce,st=w("H84U"),tt=function(de){var Ie,we,ct=de.prefixCls,ot=de.className,wt=de.style,S=de.size,ur=de.shape,Pt=z()((Ie={},Object(N.a)(Ie,"".concat(ct,"-lg"),S==="large"),Object(N.a)(Ie,"".concat(ct,"-sm"),S==="small"),Ie)),Ft=z()((we={},Object(N.a)(we,"".concat(ct,"-circle"),ur==="circle"),Object(N.a)(we,"".concat(ct,"-square"),ur==="square"),Object(N.a)(we,"".concat(ct,"-round"),ur==="round"),we)),Et=typeof S=="number"?{width:S,height:S,lineHeight:"".concat(S,"px")}:{};return B.createElement("span",{className:z()(ct,Pt,Ft,ot),style:Object(G.a)(Object(G.a)({},Et),wt)})},ut=tt,ht=w("bT9E"),gt=function(de){var Ie=function(ct){var ot=ct.getPrefixCls,wt=de.prefixCls,S=de.className,ur=de.active,Pt=ot("skeleton",wt),Ft=Object(ht.a)(de,["prefixCls","className"]),Et=z()(Pt,"".concat(Pt,"-element"),Object(N.a)({},"".concat(Pt,"-active"),ur),S);return B.createElement("div",{className:Et},B.createElement(ut,Object(G.a)({prefixCls:"".concat(Pt,"-avatar")},Ft)))};return B.createElement(st.a,null,Ie)};gt.defaultProps={size:"default",shape:"circle"};var Be=gt,dt=function(de){var Ie=function(ct){var ot,wt=ct.getPrefixCls,S=de.prefixCls,ur=de.className,Pt=de.active,Ft=de.block,Et=Ft===void 0?!1:Ft,St=wt("skeleton",S),Zt=Object(ht.a)(de,["prefixCls"]),dr=z()(St,"".concat(St,"-element"),(ot={},Object(N.a)(ot,"".concat(St,"-active"),Pt),Object(N.a)(ot,"".concat(St,"-block"),Et),ot),ur);return B.createElement("div",{className:dr},B.createElement(ut,Object(G.a)({prefixCls:"".concat(St,"-button")},Zt)))};return B.createElement(st.a,null,Ie)};dt.defaultProps={size:"default"};var rt=dt,lt=function(de){var Ie=function(ct){var ot=ct.getPrefixCls,wt=de.prefixCls,S=de.className,ur=de.active,Pt=ot("skeleton",wt),Ft=Object(ht.a)(de,["prefixCls"]),Et=z()(Pt,"".concat(Pt,"-element"),Object(N.a)({},"".concat(Pt,"-active"),ur),S);return B.createElement("div",{className:Et},B.createElement(ut,Object(G.a)({prefixCls:"".concat(Pt,"-input")},Ft)))};return B.createElement(st.a,null,Ie)};lt.defaultProps={size:"default"};var $=lt,Qt="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",Ir=function(de){var Ie=function(ct){var ot=ct.getPrefixCls,wt=de.prefixCls,S=de.className,ur=de.style,Pt=ot("skeleton",wt),Ft=z()(Pt,"".concat(Pt,"-element"),S);return B.createElement("div",{className:Ft},B.createElement("div",{className:z()("".concat(Pt,"-image"),S),style:ur},B.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(Pt,"-image-svg")},B.createElement("path",{d:Qt,className:"".concat(Pt,"-image-path")}))))};return B.createElement(st.a,null,Ie)},br=Ir;function Rt(Er){return Er&&Object(H.a)(Er)==="object"?Er:{}}function ke(Er,de){return Er&&!de?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Mt(Er,de){return!Er&&de?{width:"38%"}:Er&&de?{width:"50%"}:{}}function Nt(Er,de){var Ie={};return(!Er||!de)&&(Ie.width="61%"),!Er&&de?Ie.rows=3:Ie.rows=2,Ie}var nr=function(de){var Ie=function(ct){var ot=ct.getPrefixCls,wt=ct.direction,S=de.prefixCls,ur=de.loading,Pt=de.className,Ft=de.style,Et=de.children,St=de.avatar,Zt=de.title,dr=de.paragraph,qt=de.active,pr=de.round,Ur=ot("skeleton",S);if(ur||!("loading"in de)){var gr,or=!!St,Rr=!!Zt,Hn=!!dr,en;if(or){var _n=Object(G.a)(Object(G.a)({prefixCls:"".concat(Ur,"-avatar")},ke(Rr,Hn)),Rt(St));en=B.createElement("div",{className:"".concat(Ur,"-header")},B.createElement(ut,_n))}var qn;if(Rr||Hn){var ii;if(Rr){var Xi=Object(G.a)(Object(G.a)({prefixCls:"".concat(Ur,"-title")},Mt(or,Hn)),Rt(Zt));ii=B.createElement(Q,Xi)}var me;if(Hn){var yn=Object(G.a)(Object(G.a)({prefixCls:"".concat(Ur,"-paragraph")},Nt(or,Rr)),Rt(dr));me=B.createElement(be,yn)}qn=B.createElement("div",{className:"".concat(Ur,"-content")},ii,me)}var Bi=z()(Ur,(gr={},Object(N.a)(gr,"".concat(Ur,"-with-avatar"),or),Object(N.a)(gr,"".concat(Ur,"-active"),qt),Object(N.a)(gr,"".concat(Ur,"-rtl"),wt==="rtl"),Object(N.a)(gr,"".concat(Ur,"-round"),pr),gr),Pt);return B.createElement("div",{className:Bi,style:Ft},en,qn)}return Et};return B.createElement(st.a,null,Ie)};nr.defaultProps={avatar:!1,title:!0,paragraph:!0},nr.Button=rt,nr.Avatar=Be,nr.Input=$,nr.Image=br;var Mr=nr,Jr=Z.a=Mr},"/kpp":function(ae,Z,w){"use strict";var N=w("rePB"),G=w("wx14"),H=w("U8pU"),B=w("q1tI"),h=w.n(B),z=w("TSYQ"),U=w.n(z),Q=w("o/2+"),se=w("H84U"),Ce=function(ut,ht){var gt={};for(var Be in ut)Object.prototype.hasOwnProperty.call(ut,Be)&&ht.indexOf(Be)<0&&(gt[Be]=ut[Be]);if(ut!=null&&typeof Object.getOwnPropertySymbols=="function")for(var dt=0,Be=Object.getOwnPropertySymbols(ut);dt<Be.length;dt++)ht.indexOf(Be[dt])<0&&Object.prototype.propertyIsEnumerable.call(ut,Be[dt])&&(gt[Be[dt]]=ut[Be[dt]]);return gt};function be(ut){return typeof ut=="number"?"".concat(ut," ").concat(ut," auto"):/^\d+(\.\d+)?(px|em|rem|%)$/.test(ut)?"0 0 ".concat(ut):ut}var st=["xs","sm","md","lg","xl","xxl"],tt=B.forwardRef(function(ut,ht){var gt,Be=B.useContext(se.b),dt=Be.getPrefixCls,rt=Be.direction,lt=B.useContext(Q.a),$=lt.gutter,Qt=lt.wrap,Ir=lt.supportFlexGap,br=ut.prefixCls,Rt=ut.span,ke=ut.order,Mt=ut.offset,Nt=ut.push,nr=ut.pull,Mr=ut.className,Jr=ut.children,Er=ut.flex,de=ut.style,Ie=Ce(ut,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),we=dt("col",br),ct={};st.forEach(function(Pt){var Ft,Et={},St=ut[Pt];typeof St=="number"?Et.span=St:Object(H.a)(St)==="object"&&(Et=St||{}),delete Ie[Pt],ct=Object(G.a)(Object(G.a)({},ct),(Ft={},Object(N.a)(Ft,"".concat(we,"-").concat(Pt,"-").concat(Et.span),Et.span!==void 0),Object(N.a)(Ft,"".concat(we,"-").concat(Pt,"-order-").concat(Et.order),Et.order||Et.order===0),Object(N.a)(Ft,"".concat(we,"-").concat(Pt,"-offset-").concat(Et.offset),Et.offset||Et.offset===0),Object(N.a)(Ft,"".concat(we,"-").concat(Pt,"-push-").concat(Et.push),Et.push||Et.push===0),Object(N.a)(Ft,"".concat(we,"-").concat(Pt,"-pull-").concat(Et.pull),Et.pull||Et.pull===0),Object(N.a)(Ft,"".concat(we,"-rtl"),rt==="rtl"),Ft))});var ot=U()(we,(gt={},Object(N.a)(gt,"".concat(we,"-").concat(Rt),Rt!==void 0),Object(N.a)(gt,"".concat(we,"-order-").concat(ke),ke),Object(N.a)(gt,"".concat(we,"-offset-").concat(Mt),Mt),Object(N.a)(gt,"".concat(we,"-push-").concat(Nt),Nt),Object(N.a)(gt,"".concat(we,"-pull-").concat(nr),nr),gt),Mr,ct),wt={};if($&&$[0]>0){var S=$[0]/2;wt.paddingLeft=S,wt.paddingRight=S}if($&&$[1]>0&&!Ir){var ur=$[1]/2;wt.paddingTop=ur,wt.paddingBottom=ur}return Er&&(wt.flex=be(Er),Qt===!1&&!wt.minWidth&&(wt.minWidth=0)),B.createElement("div",Object(G.a)({},Ie,{style:Object(G.a)(Object(G.a)({},wt),de),className:ot,ref:ht}),Jr)});tt.displayName="Col",Z.a=tt},"0JQy":function(ae,Z){var w="\\ud800-\\udfff",N="\\u0300-\\u036f",G="\\ufe20-\\ufe2f",H="\\u20d0-\\u20ff",B=N+G+H,h="\\ufe0e\\ufe0f",z="["+w+"]",U="["+B+"]",Q="\\ud83c[\\udffb-\\udfff]",se="(?:"+U+"|"+Q+")",Ce="[^"+w+"]",be="(?:\\ud83c[\\udde6-\\uddff]){2}",st="[\\ud800-\\udbff][\\udc00-\\udfff]",tt="\\u200d",ut=se+"?",ht="["+h+"]?",gt="(?:"+tt+"(?:"+[Ce,be,st].join("|")+")"+ht+ut+")*",Be=ht+ut+gt,dt="(?:"+[Ce+U+"?",U,be,st,z].join("|")+")",rt=RegExp(Q+"(?="+Q+")|"+dt+Be,"g");function lt($){return $.match(rt)||[]}ae.exports=lt},"0ZTe":function(ae,Z,w){var N=w("wy8a"),G=w("quyA"),H=w("Em2t"),B=w("dt0z");function h(z){return function(U){U=B(U);var Q=G(U)?H(U):void 0,se=Q?Q[0]:U.charAt(0),Ce=Q?N(Q,1).join(""):U.slice(1);return se[z]()+Ce}}ae.exports=h},"0gSV":function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.tagged=void 0;var N=w("GXnB"),G=w("Ztfv");function H(B,h){return function(z,U,Q){var se=new N.Metadata(B,h);typeof Q=="number"?G.tagParameter(z,U,Q,se):G.tagProperty(z,U,se)}}Z.tagged=H},"1+5i":function(ae,Z,w){var N=w("w/wX"),G=w("sEf8"),H=w("mdPL"),B=H&&H.isSet,h=B?G(B):N;ae.exports=h},"1ABj":function(ae,Z){function w(N,G){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}ae.exports=w,ae.exports.__esModule=!0,ae.exports.default=ae.exports},"2ajD":function(ae,Z){function w(N){return N!==N}ae.exports=w},"3L66":function(ae,Z,w){var N=w("MMmD"),G=w("ExA7");function H(B){return G(B)&&N(B)}ae.exports=H},"3cYt":function(ae,Z){function w(N){return function(G){return N==null?void 0:N[G]}}ae.exports=w},"406g":function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.BindingOnSyntax=void 0;var N=w("z4Hk"),G=function(){function H(B){this._binding=B}return H.prototype.onActivation=function(B){return this._binding.onActivation=B,new N.BindingWhenSyntax(this._binding)},H}();Z.BindingOnSyntax=G},"4ZJM":function(ae,Z,w){(function(N,G){ae.exports=G()})(this,function(){"use strict";var N,G,H;function B(h,z){if(!N)N=z;else if(!G)G=z;else{var U="var sharedChunk = {}; ("+N+")(sharedChunk); ("+G+")(sharedChunk);",Q={};N(Q),H=z(Q),typeof window!="undefined"&&(H.workerUrl=window.URL.createObjectURL(new Blob([U],{type:"text/javascript"})))}}return B(["exports"],function(h){"use strict";function z(a,o){return a(o={exports:{}},o.exports),o.exports}var U=Q;function Q(a,o,u,d){this.cx=3*a,this.bx=3*(u-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(d-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=d,this.p2x=u,this.p2y=d}Q.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a},Q.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a},Q.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},Q.prototype.solveCurveX=function(a,o){var u,d,y,b,C;for(o===void 0&&(o=1e-6),y=a,C=0;C<8;C++){if(b=this.sampleCurveX(y)-a,Math.abs(b)<o)return y;var P=this.sampleCurveDerivativeX(y);if(Math.abs(P)<1e-6)break;y-=b/P}if((y=a)<(u=0))return u;if(y>(d=1))return d;for(;u<d;){if(b=this.sampleCurveX(y),Math.abs(b-a)<o)return y;a>b?u=y:d=y,y=.5*(d-u)+u}return y},Q.prototype.solve=function(a,o){return this.sampleCurveY(this.solveCurveX(a,o))};var se=Ce;function Ce(a,o){this.x=a,this.y=o}Ce.prototype={clone:function(){return new Ce(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,u){return this.clone()._rotateAround(o,u)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var u=o.x-this.x,d=o.y-this.y;return u*u+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,u){return Math.atan2(this.x*u-this.y*o,this.x*o+this.y*u)},_matMult:function(o){var u=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=u,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var u=Math.cos(o),d=Math.sin(o),y=d*this.x+u*this.y;return this.x=u*this.x-d*this.y,this.y=y,this},_rotateAround:function(o,u){var d=Math.cos(o),y=Math.sin(o),b=u.y+y*(this.x-u.x)+d*(this.y-u.y);return this.x=u.x+d*(this.x-u.x)-y*(this.y-u.y),this.y=b,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ce.convert=function(a){return a instanceof Ce?a:Array.isArray(a)?new Ce(a[0],a[1]):a};var be=typeof self!="undefined"?self:{},st=Math.pow(2,53)-1;function tt(a,o,u,d){var y=new U(a,o,u,d);return function(b){return y.solve(b)}}var ut=tt(.25,.1,.25,1);function ht(a,o,u){return Math.min(u,Math.max(o,a))}function gt(a,o,u){var d=u-o,y=((a-o)%d+d)%d+o;return y===o?u:y}function Be(a){for(var o=[],u=arguments.length-1;u-- >0;)o[u]=arguments[u+1];for(var d=0,y=o;d<y.length;d+=1){var b=y[d];for(var C in b)a[C]=b[C]}return a}var dt=1;function rt(){return dt++}function lt(){return function a(o){return o?(o^16*Math.random()>>o/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function $(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function Qt(a,o){a.forEach(function(u){o[u]&&(o[u]=o[u].bind(o))})}function Ir(a,o){return a.indexOf(o,a.length-o.length)!==-1}function br(a,o,u){var d={};for(var y in a)d[y]=o.call(u||this,a[y],y,a);return d}function Rt(a,o,u){var d={};for(var y in a)o.call(u||this,a[y],y,a)&&(d[y]=a[y]);return d}function ke(a){return Array.isArray(a)?a.map(ke):typeof a=="object"&&a?br(a,ke):a}var Mt={};function Nt(a){Mt[a]||(typeof console!="undefined"&&console.warn(a),Mt[a]=!0)}function nr(a,o,u){return(u.y-a.y)*(o.x-a.x)>(o.y-a.y)*(u.x-a.x)}function Mr(a){for(var o=0,u=0,d=a.length,y=d-1,b=void 0,C=void 0;u<d;y=u++)o+=((C=a[y]).x-(b=a[u]).x)*(b.y+C.y);return o}function Jr(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Er(a){var o={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(d,y,b,C){var P=b||C;return o[y]=!P||P.toLowerCase(),""}),o["max-age"]){var u=parseInt(o["max-age"],10);isNaN(u)?delete o["max-age"]:o["max-age"]=u}return o}var de=null;function Ie(a){if(de==null){var o=a.navigator?a.navigator.userAgent:null;de=!!a.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return de}function we(a){try{var o=be[a];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch(u){return!1}}var ct,ot,wt,S,ur=be.performance&&be.performance.now?be.performance.now.bind(be.performance):Date.now.bind(Date),Pt=be.requestAnimationFrame||be.mozRequestAnimationFrame||be.webkitRequestAnimationFrame||be.msRequestAnimationFrame,Ft=be.cancelAnimationFrame||be.mozCancelAnimationFrame||be.webkitCancelAnimationFrame||be.msCancelAnimationFrame,Et={now:ur,frame:function(o){var u=Pt(o);return{cancel:function(){return Ft(u)}}},getImageData:function(o,u){u===void 0&&(u=0);var d=be.document.createElement("canvas"),y=d.getContext("2d");if(!y)throw new Error("failed to create canvas 2d context");return d.width=o.width,d.height=o.height,y.drawImage(o,0,0,o.width,o.height),y.getImageData(-u,-u,o.width+2*u,o.height+2*u)},resolveURL:function(o){return ct||(ct=be.document.createElement("a")),ct.href=o,ct.href},hardwareConcurrency:be.navigator&&be.navigator.hardwareConcurrency||4,get devicePixelRatio(){return be.devicePixelRatio},get prefersReducedMotion(){return!!be.matchMedia&&(ot==null&&(ot=be.matchMedia("(prefers-reduced-motion: reduce)")),ot.matches)}},St={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Zt={supported:!1,testSupport:function(o){!dr&&S&&(qt?pr(o):wt=o)}},dr=!1,qt=!1;function pr(a){var o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,S),a.isContextLost())return;Zt.supported=!0}catch(u){}a.deleteTexture(o),dr=!0}be.document&&((S=be.document.createElement("img")).onload=function(){wt&&pr(wt),wt=null,qt=!0},S.onerror=function(){dr=!0,wt=null},S.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Ur="01",gr=function(o,u){this._transformRequestFn=o,this._customAccessToken=u,this._createSkuToken()};function or(a){return a.indexOf("mapbox:")===0}gr.prototype._createSkuToken=function(){var a=function(){for(var o="",u=0;u<10;u++)o+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ur,o].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt},gr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},gr.prototype.transformRequest=function(a,o){return this._transformRequestFn&&this._transformRequestFn(a,o)||{url:a}},gr.prototype.normalizeStyleURL=function(a,o){if(!or(a))return a;var u=_n(a);return u.path="/styles/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||o)},gr.prototype.normalizeGlyphsURL=function(a,o){if(!or(a))return a;var u=_n(a);return u.path="/fonts/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||o)},gr.prototype.normalizeSourceURL=function(a,o){if(!or(a))return a;var u=_n(a);return u.path="/v4/"+u.authority+".json",u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||o)},gr.prototype.normalizeSpriteURL=function(a,o,u,d){var y=_n(a);return or(a)?(y.path="/styles/v1"+y.path+"/sprite"+o+u,this._makeAPIURL(y,this._customAccessToken||d)):(y.path+=""+o+u,qn(y))},gr.prototype.normalizeTileURL=function(a,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!or(a))return a;var u=_n(a);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Et.devicePixelRatio>=2||o===512?"@2x":"")+(Zt.supported?".webp":"$1")),u.path=u.path.replace(/^.+\/v4\//,"/"),u.path="/v4"+u.path;var d=this._customAccessToken||function(y){for(var b=0,C=y;b<C.length;b+=1){var P=C[b].match(/^access_token=(.*)$/);if(P)return P[1]}return null}(u.params)||St.ACCESS_TOKEN;return St.REQUIRE_ACCESS_TOKEN&&d&&this._skuToken&&u.params.push("sku="+this._skuToken),this._makeAPIURL(u,d)},gr.prototype.canonicalizeTileURL=function(a,o){var u=_n(a);if(!u.path.match(/(^\/v4\/)/)||!u.path.match(/\.[\w]+$/))return a;var d="mapbox://tiles/";d+=u.path.replace("/v4/","");var y=u.params;return o&&(y=y.filter(function(b){return!b.match(/^access_token=/)})),y.length&&(d+="?"+y.join("&")),d},gr.prototype.canonicalizeTileset=function(a,o){for(var u=!!o&&or(o),d=[],y=0,b=a.tiles||[];y<b.length;y+=1){var C=b[y];Hn(C)?d.push(this.canonicalizeTileURL(C,u)):d.push(C)}return d},gr.prototype._makeAPIURL=function(a,o){var u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",d=_n(St.API_URL);if(a.protocol=d.protocol,a.authority=d.authority,a.protocol==="http"){var y=a.params.indexOf("secure");y>=0&&a.params.splice(y,1)}if(d.path!=="/"&&(a.path=""+d.path+a.path),!St.REQUIRE_ACCESS_TOKEN)return qn(a);if(!(o=o||St.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+u);if(o[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+u);return a.params=a.params.filter(function(b){return b.indexOf("access_token")===-1}),a.params.push("access_token="+o),qn(a)};var Rr=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Hn(a){return Rr.test(a)}var en=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function _n(a){var o=a.match(en);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function qn(a){var o=a.params.length?"?"+a.params.join("&"):"";return a.protocol+"://"+a.authority+a.path+o}function ii(a){if(!a)return null;var o=a.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(decodeURIComponent(be.atob(o[1]).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(u){return null}}var Xi=function(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Xi.prototype.getStorageKey=function(a){var o,u=ii(St.ACCESS_TOKEN);return o=u&&u.u?be.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,function(d,y){return String.fromCharCode(Number("0x"+y))})):St.ACCESS_TOKEN||"",a?"mapbox.eventData."+a+":"+o:"mapbox.eventData:"+o},Xi.prototype.fetchEventData=function(){var a=we("localStorage"),o=this.getStorageKey(),u=this.getStorageKey("uuid");if(a)try{var d=be.localStorage.getItem(o);d&&(this.eventData=JSON.parse(d));var y=be.localStorage.getItem(u);y&&(this.anonId=y)}catch(b){Nt("Unable to read from LocalStorage")}},Xi.prototype.saveEventData=function(){var a=we("localStorage"),o=this.getStorageKey(),u=this.getStorageKey("uuid");if(a)try{be.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&be.localStorage.setItem(o,JSON.stringify(this.eventData))}catch(d){Nt("Unable to write to LocalStorage")}},Xi.prototype.processRequests=function(a){},Xi.prototype.postEvent=function(a,o,u,d){var y=this;if(St.EVENTS_URL){var b=_n(St.EVENTS_URL);b.params.push("access_token="+(d||St.ACCESS_TOKEN||""));var C={event:this.type,created:new Date(a).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:Ur,userId:this.anonId},P=o?Be(C,o):C,D={url:qn(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([P])};this.pendingRequest=ja(D,function(j){y.pendingRequest=null,u(j),y.saveEventData(),y.processRequests(d)})}},Xi.prototype.queueRequest=function(a,o){this.queue.push(a),this.processRequests(o)};var me,yn,Bi=function(a){function o(){a.call(this,"map.load"),this.success={},this.skuToken=""}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.postMapLoadEvent=function(u,d,y,b){this.skuToken=y,(St.EVENTS_URL&&b||St.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(C){return or(C)||Hn(C)}))&&this.queueRequest({id:d,timestamp:Date.now()},b)},o.prototype.processRequests=function(u){var d=this;if(!this.pendingRequest&&this.queue.length!==0){var y=this.queue.shift(),b=y.id,C=y.timestamp;b&&this.success[b]||(this.anonId||this.fetchEventData(),$(this.anonId)||(this.anonId=lt()),this.postEvent(C,{skuToken:this.skuToken},function(P){P||b&&(d.success[b]=!0)},u))}},o}(Xi),Mo=new(function(a){function o(u){a.call(this,"appUserTurnstile"),this._customAccessToken=u}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.postTurnstileEvent=function(u,d){St.EVENTS_URL&&St.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(y){return or(y)||Hn(y)})&&this.queueRequest(Date.now(),d)},o.prototype.processRequests=function(u){var d=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var y=ii(St.ACCESS_TOKEN),b=y?y.u:St.ACCESS_TOKEN,C=b!==this.eventData.tokenU;$(this.anonId)||(this.anonId=lt(),C=!0);var P=this.queue.shift();if(this.eventData.lastSuccess){var D=new Date(this.eventData.lastSuccess),j=new Date(P),X=(P-this.eventData.lastSuccess)/864e5;C=C||X>=1||X<-1||D.getDate()!==j.getDate()}else C=!0;if(!C)return this.processRequests();this.postEvent(P,{"enabled.telemetry":!1},function(ee){ee||(d.eventData.lastSuccess=P,d.eventData.tokenU=b)},u)}},o}(Xi)),os=Mo.postTurnstileEvent.bind(Mo),jt=new Bi,_r=jt.postMapLoadEvent.bind(jt),Xr=500,vn=50;function Kr(){be.caches&&!me&&(me=be.caches.open("mapbox-tiles"))}function ba(a){var o=a.indexOf("?");return o<0?a:a.slice(0,o)}var li,Xn=1/0;function ci(){return li==null&&(li=be.OffscreenCanvas&&new be.OffscreenCanvas(1,1).getContext("2d")&&typeof be.createImageBitmap=="function"),li}var Hi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Hi);var Yi=function(a){function o(u,d,y){d===401&&Hn(y)&&(u+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),a.call(this,u),this.status=d,this.url=y,this.name=this.constructor.name,this.message=u}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},o}(Error),No=Jr()?function(){return self.worker&&self.worker.referrer}:function(){return(be.location.protocol==="blob:"?be.parent:be).location.href},Ma,ma,Hs=function(o,u){if(!(/^file:/.test(d=o.url)||/^file:/.test(No())&&!/^\w+:/.test(d))){if(be.fetch&&be.Request&&be.AbortController&&be.Request.prototype.hasOwnProperty("signal"))return function(y,b){var C,P=new be.AbortController,D=new be.Request(y.url,{method:y.method||"GET",body:y.body,credentials:y.credentials,headers:y.headers,referrer:No(),signal:P.signal}),j=!1,X=!1,ee=(C=D.url).indexOf("sku=")>0&&Hn(C);y.type==="json"&&D.headers.set("Accept","application/json");var te=function(Oe,We,Ze){if(!X){if(Oe&&Oe.message!=="SecurityError"&&Nt(Oe),We&&Ze)return Ee(We);var yt=Date.now();be.fetch(D).then(function(Dt){if(Dt.ok){var Xt=ee?Dt.clone():null;return Ee(Dt,Xt,yt)}return b(new Yi(Dt.statusText,Dt.status,y.url))}).catch(function(Dt){Dt.code!==20&&b(new Error(Dt.message))})}},Ee=function(Oe,We,Ze){(y.type==="arrayBuffer"?Oe.arrayBuffer():y.type==="json"?Oe.json():Oe.text()).then(function(yt){X||(We&&Ze&&function(Dt,Xt,mr){if(Kr(),me){var sr={status:Xt.status,statusText:Xt.statusText,headers:new be.Headers};Xt.headers.forEach(function(nn,Gn){return sr.headers.set(Gn,nn)});var Qr=Er(Xt.headers.get("Cache-Control")||"");Qr["no-store"]||(Qr["max-age"]&&sr.headers.set("Expires",new Date(mr+1e3*Qr["max-age"]).toUTCString()),new Date(sr.headers.get("Expires")).getTime()-mr<42e4||function(nn,Gn){if(yn===void 0)try{new Response(new ReadableStream),yn=!0}catch(ei){yn=!1}yn?Gn(nn.body):nn.blob().then(Gn)}(Xt,function(nn){var Gn=new be.Response(nn,sr);Kr(),me&&me.then(function(ei){return ei.put(ba(Dt.url),Gn)}).catch(function(ei){return Nt(ei.message)})}))}}(D,We,Ze),j=!0,b(null,yt,Oe.headers.get("Cache-Control"),Oe.headers.get("Expires")))}).catch(function(yt){X||b(new Error(yt.message))})};return ee?function(Le,Oe){if(Kr(),!me)return Oe(null);var We=ba(Le.url);me.then(function(Ze){Ze.match(We).then(function(yt){var Dt=function(Xt){if(!Xt)return!1;var mr=new Date(Xt.headers.get("Expires")||0),sr=Er(Xt.headers.get("Cache-Control")||"");return mr>Date.now()&&!sr["no-cache"]}(yt);Ze.delete(We),Dt&&Ze.put(We,yt.clone()),Oe(null,yt,Dt)}).catch(Oe)}).catch(Oe)}(D,te):te(null,null),{cancel:function(){X=!0,j||P.abort()}}}(o,u);if(Jr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,u,void 0,!0)}var d;return function(y,b){var C=new be.XMLHttpRequest;for(var P in C.open(y.method||"GET",y.url,!0),y.type==="arrayBuffer"&&(C.responseType="arraybuffer"),y.headers)C.setRequestHeader(P,y.headers[P]);return y.type==="json"&&(C.responseType="text",C.setRequestHeader("Accept","application/json")),C.withCredentials=y.credentials==="include",C.onerror=function(){b(new Error(C.statusText))},C.onload=function(){if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){var D=C.response;if(y.type==="json")try{D=JSON.parse(C.response)}catch(j){return b(j)}b(null,D,C.getResponseHeader("Cache-Control"),C.getResponseHeader("Expires"))}else b(new Yi(C.statusText,C.status,y.url))},C.send(y.body),{cancel:function(){return C.abort()}}}(o,u)},il=function(o,u){return Hs(Be(o,{type:"arrayBuffer"}),u)},ja=function(o,u){return Hs(Be(o,{method:"POST"}),u)},re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Ma=[],ma=0;var J=function a(o,u){if(Zt.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),ma>=St.MAX_PARALLEL_IMAGE_REQUESTS){var d={requestParameters:o,callback:u,cancelled:!1,cancel:function(){this.cancelled=!0}};return Ma.push(d),d}ma++;var y=!1,b=function(){if(!y)for(y=!0,ma--;Ma.length&&ma<St.MAX_PARALLEL_IMAGE_REQUESTS;){var D=Ma.shift();D.cancelled||(D.cancel=a(D.requestParameters,D.callback).cancel)}},C=il(o,function(P,D,j,X){b(),P?u(P):D&&(ci()?function(ee,te){var Ee=new be.Blob([new Uint8Array(ee)],{type:"image/png"});be.createImageBitmap(Ee).then(function(Le){te(null,Le)}).catch(function(Le){te(new Error("Could not load image because of "+Le.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(D,u):function(ee,te,Ee,Le){var Oe=new be.Image,We=be.URL;Oe.onload=function(){te(null,Oe),We.revokeObjectURL(Oe.src),Oe.onload=null,be.requestAnimationFrame(function(){Oe.src=re})},Oe.onerror=function(){return te(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Ze=new be.Blob([new Uint8Array(ee)],{type:"image/png"});Oe.cacheControl=Ee,Oe.expires=Le,Oe.src=ee.byteLength?We.createObjectURL(Ze):re}(D,u,j,X))});return{cancel:function(){C.cancel(),b()}}};function pe(a,o,u){u[a]&&u[a].indexOf(o)!==-1||(u[a]=u[a]||[],u[a].push(o))}function Se(a,o,u){if(u&&u[a]){var d=u[a].indexOf(o);d!==-1&&u[a].splice(d,1)}}var De=function(o,u){u===void 0&&(u={}),Be(this,u),this.type=o},et=function(a){function o(u,d){d===void 0&&(d={}),a.call(this,"error",Be({error:u},d))}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o}(De),vt=function(){};vt.prototype.on=function(a,o){return this._listeners=this._listeners||{},pe(a,o,this._listeners),this},vt.prototype.off=function(a,o){return Se(a,o,this._listeners),Se(a,o,this._oneTimeListeners),this},vt.prototype.once=function(a,o){return this._oneTimeListeners=this._oneTimeListeners||{},pe(a,o,this._oneTimeListeners),this},vt.prototype.fire=function(a,o){typeof a=="string"&&(a=new De(a,o||{}));var u=a.type;if(this.listens(u)){a.target=this;for(var d=0,y=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];d<y.length;d+=1)y[d].call(this,a);for(var b=0,C=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];b<C.length;b+=1){var P=C[b];Se(u,P,this._oneTimeListeners),P.call(this,a)}var D=this._eventedParent;D&&(Be(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),D.fire(a))}else a instanceof et&&console.error(a.error);return this},vt.prototype.listens=function(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)},vt.prototype.setEventedParent=function(a,o){return this._eventedParent=a,this._eventedParentData=o,this};var _e={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},je=function(o,u,d,y){this.message=(o?o+": ":"")+d,y&&(this.identifier=y),u!=null&&u.__line__&&(this.line=u.__line__)};function $e(a){var o=a.value;return o?[new je(a.key,o,"constants have been deprecated as of v8")]:[]}function Ar(a){for(var o=[],u=arguments.length-1;u-- >0;)o[u]=arguments[u+1];for(var d=0,y=o;d<y.length;d+=1){var b=y[d];for(var C in b)a[C]=b[C]}return a}function kr(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function rr(a){if(Array.isArray(a))return a.map(rr);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){var o={};for(var u in a)o[u]=rr(a[u]);return o}return kr(a)}var Lr=function(a){function o(u,d){a.call(this,d),this.message=d,this.key=u}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o}(Error),an=function(o,u){u===void 0&&(u=[]),this.parent=o,this.bindings={};for(var d=0,y=u;d<y.length;d+=1){var b=y[d];this.bindings[b[0]]=b[1]}};an.prototype.concat=function(a){return new an(this,a)},an.prototype.get=function(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(a+" not found in scope.")},an.prototype.has=function(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)};var An={kind:"null"},tr={kind:"number"},Cn={kind:"string"},hn={kind:"boolean"},xn={kind:"color"},_i={kind:"object"},wn={kind:"value"},Ni={kind:"collator"},Ki={kind:"formatted"},Mi={kind:"resolvedImage"};function Fn(a,o){return{kind:"array",itemType:a,N:o}}function Ui(a){if(a.kind==="array"){var o=Ui(a.itemType);return typeof a.N=="number"?"array<"+o+", "+a.N+">":a.itemType.kind==="value"?"array":"array<"+o+">"}return a.kind}var zo=[An,tr,Cn,hn,xn,Ki,_i,Fn(wn),Mi];function ia(a,o){if(o.kind==="error")return null;if(a.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!ia(a.itemType,o.itemType))&&(typeof a.N!="number"||a.N===o.N))return null}else{if(a.kind===o.kind)return null;if(a.kind==="value"){for(var u=0,d=zo;u<d.length;u+=1)if(!ia(d[u],o))return null}}return"Expected "+Ui(a)+" but found "+Ui(o)+" instead."}function Ka(a,o){return o.some(function(u){return u.kind===a.kind})}function ri(a,o){return o.some(function(u){return u==="null"?a===null:u==="array"?Array.isArray(a):u==="object"?a&&!Array.isArray(a)&&typeof a=="object":u===typeof a})}var Ai=z(function(a,o){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function d(P){return(P=Math.round(P))<0?0:P>255?255:P}function y(P){return d(P[P.length-1]==="%"?parseFloat(P)/100*255:parseInt(P))}function b(P){return(D=P[P.length-1]==="%"?parseFloat(P)/100:parseFloat(P))<0?0:D>1?1:D;var D}function C(P,D,j){return j<0?j+=1:j>1&&(j-=1),6*j<1?P+(D-P)*j*6:2*j<1?D:3*j<2?P+(D-P)*(2/3-j)*6:P}try{o.parseCSSColor=function(P){var D,j=P.replace(/ /g,"").toLowerCase();if(j in u)return u[j].slice();if(j[0]==="#")return j.length===4?(D=parseInt(j.substr(1),16))>=0&&D<=4095?[(3840&D)>>4|(3840&D)>>8,240&D|(240&D)>>4,15&D|(15&D)<<4,1]:null:j.length===7&&(D=parseInt(j.substr(1),16))>=0&&D<=16777215?[(16711680&D)>>16,(65280&D)>>8,255&D,1]:null;var X=j.indexOf("("),ee=j.indexOf(")");if(X!==-1&&ee+1===j.length){var te=j.substr(0,X),Ee=j.substr(X+1,ee-(X+1)).split(","),Le=1;switch(te){case"rgba":if(Ee.length!==4)return null;Le=b(Ee.pop());case"rgb":return Ee.length!==3?null:[y(Ee[0]),y(Ee[1]),y(Ee[2]),Le];case"hsla":if(Ee.length!==4)return null;Le=b(Ee.pop());case"hsl":if(Ee.length!==3)return null;var Oe=(parseFloat(Ee[0])%360+360)%360/360,We=b(Ee[1]),Ze=b(Ee[2]),yt=Ze<=.5?Ze*(We+1):Ze+We-Ze*We,Dt=2*Ze-yt;return[d(255*C(Dt,yt,Oe+1/3)),d(255*C(Dt,yt,Oe)),d(255*C(Dt,yt,Oe-1/3)),Le];default:return null}}return null}}catch(P){}}).parseCSSColor,xi=function(o,u,d,y){y===void 0&&(y=1),this.r=o,this.g=u,this.b=d,this.a=y};xi.parse=function(a){if(a){if(a instanceof xi)return a;if(typeof a=="string"){var o=Ai(a);if(o)return new xi(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3])}}},xi.prototype.toString=function(){var a=this.toArray(),o=a[1],u=a[2],d=a[3];return"rgba("+Math.round(a[0])+","+Math.round(o)+","+Math.round(u)+","+d+")"},xi.prototype.toArray=function(){var a=this.a;return a===0?[0,0,0,0]:[255*this.r/a,255*this.g/a,255*this.b/a,a]},xi.black=new xi(0,0,0,1),xi.white=new xi(1,1,1,1),xi.transparent=new xi(0,0,0,0),xi.red=new xi(1,0,0,1);var to=function(o,u,d){this.sensitivity=o?u?"variant":"case":u?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};to.prototype.compare=function(a,o){return this.collator.compare(a,o)},to.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ao=function(o,u,d,y,b){this.text=o,this.image=u,this.scale=d,this.fontStack=y,this.textColor=b},Ea=function(o){this.sections=o};Ea.fromString=function(a){return new Ea([new ao(a,null,null,null,null)])},Ea.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(a){return a.text.length!==0||a.image&&a.image.name.length!==0})},Ea.factory=function(a){return a instanceof Ea?a:Ea.fromString(a)},Ea.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(a){return a.text}).join("")},Ea.prototype.serialize=function(){for(var a=["format"],o=0,u=this.sections;o<u.length;o+=1){var d=u[o];if(d.image)a.push(["image",d.image.name]);else{a.push(d.text);var y={};d.fontStack&&(y["text-font"]=["literal",d.fontStack.split(",")]),d.scale&&(y["font-scale"]=d.scale),d.textColor&&(y["text-color"]=["rgba"].concat(d.textColor.toArray())),a.push(y)}}return a};var Ct=function(o){this.name=o.name,this.available=o.available};function ss(a,o,u,d){return typeof a=="number"&&a>=0&&a<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof u=="number"&&u>=0&&u<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:"Invalid rgba value ["+[a,o,u,d].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof d=="number"?[a,o,u,d]:[a,o,u]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Bt(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof xi||a instanceof to||a instanceof Ea||a instanceof Ct)return!0;if(Array.isArray(a)){for(var o=0,u=a;o<u.length;o+=1)if(!Bt(u[o]))return!1;return!0}if(typeof a=="object"){for(var d in a)if(!Bt(a[d]))return!1;return!0}return!1}function wa(a){if(a===null)return An;if(typeof a=="string")return Cn;if(typeof a=="boolean")return hn;if(typeof a=="number")return tr;if(a instanceof xi)return xn;if(a instanceof to)return Ni;if(a instanceof Ea)return Ki;if(a instanceof Ct)return Mi;if(Array.isArray(a)){for(var o,u=a.length,d=0,y=a;d<y.length;d+=1){var b=wa(y[d]);if(o){if(o===b)continue;o=wn;break}o=b}return Fn(o||wn,u)}return _i}function ro(a){var o=typeof a;return a===null?"":o==="string"||o==="number"||o==="boolean"?String(a):a instanceof xi||a instanceof Ea||a instanceof Ct?a.toString():JSON.stringify(a)}Ct.prototype.toString=function(){return this.name},Ct.fromString=function(a){return a?new Ct({name:a,available:!1}):null},Ct.prototype.serialize=function(){return["image",this.name]};var Pa=function(o,u){this.type=o,this.value=u};Pa.parse=function(a,o){if(a.length!==2)return o.error("'literal' expression requires exactly one argument, but found "+(a.length-1)+" instead.");if(!Bt(a[1]))return o.error("invalid value");var u=a[1],d=wa(u),y=o.expectedType;return d.kind!=="array"||d.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(d=y),new Pa(d,u)},Pa.prototype.evaluate=function(){return this.value},Pa.prototype.eachChild=function(){},Pa.prototype.outputDefined=function(){return!0},Pa.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof xi?["rgba"].concat(this.value.toArray()):this.value instanceof Ea?this.value.serialize():this.value};var Ta=function(o){this.name="ExpressionEvaluationError",this.message=o};Ta.prototype.toJSON=function(){return this.message};var Po={string:Cn,number:tr,boolean:hn,object:_i},Nr=function(o,u){this.type=o,this.args=u};Nr.parse=function(a,o){if(a.length<2)return o.error("Expected at least one argument.");var u,d=1,y=a[0];if(y==="array"){var b,C;if(a.length>2){var P=a[1];if(typeof P!="string"||!(P in Po)||P==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=Po[P],d++}else b=wn;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return o.error('The length argument to "array" must be a positive integer literal',2);C=a[2],d++}u=Fn(b,C)}else u=Po[y];for(var D=[];d<a.length;d++){var j=o.parse(a[d],d,wn);if(!j)return null;D.push(j)}return new Nr(u,D)},Nr.prototype.evaluate=function(a){for(var o=0;o<this.args.length;o++){var u=this.args[o].evaluate(a);if(!ia(this.type,wa(u)))return u;if(o===this.args.length-1)throw new Ta("Expected value to be of type "+Ui(this.type)+", but found "+Ui(wa(u))+" instead.")}return null},Nr.prototype.eachChild=function(a){this.args.forEach(a)},Nr.prototype.outputDefined=function(){return this.args.every(function(a){return a.outputDefined()})},Nr.prototype.serialize=function(){var a=this.type,o=[a.kind];if(a.kind==="array"){var u=a.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){o.push(u.kind);var d=a.N;(typeof d=="number"||this.args.length>1)&&o.push(d)}}return o.concat(this.args.map(function(y){return y.serialize()}))};var Xo=function(o){this.type=Ki,this.sections=o};Xo.parse=function(a,o){if(a.length<2)return o.error("Expected at least one argument.");var u=a[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");for(var d=[],y=!1,b=1;b<=a.length-1;++b){var C=a[b];if(y&&typeof C=="object"&&!Array.isArray(C)){y=!1;var P=null;if(C["font-scale"]&&!(P=o.parse(C["font-scale"],1,tr)))return null;var D=null;if(C["text-font"]&&!(D=o.parse(C["text-font"],1,Fn(Cn))))return null;var j=null;if(C["text-color"]&&!(j=o.parse(C["text-color"],1,xn)))return null;var X=d[d.length-1];X.scale=P,X.font=D,X.textColor=j}else{var ee=o.parse(a[b],1,wn);if(!ee)return null;var te=ee.type.kind;if(te!=="string"&&te!=="value"&&te!=="null"&&te!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,d.push({content:ee,scale:null,font:null,textColor:null})}}return new Xo(d)},Xo.prototype.evaluate=function(a){return new Ea(this.sections.map(function(o){var u=o.content.evaluate(a);return wa(u)===Mi?new ao("",u,null,null,null):new ao(ro(u),null,o.scale?o.scale.evaluate(a):null,o.font?o.font.evaluate(a).join(","):null,o.textColor?o.textColor.evaluate(a):null)}))},Xo.prototype.eachChild=function(a){for(var o=0,u=this.sections;o<u.length;o+=1){var d=u[o];a(d.content),d.scale&&a(d.scale),d.font&&a(d.font),d.textColor&&a(d.textColor)}},Xo.prototype.outputDefined=function(){return!1},Xo.prototype.serialize=function(){for(var a=["format"],o=0,u=this.sections;o<u.length;o+=1){var d=u[o];a.push(d.content.serialize());var y={};d.scale&&(y["font-scale"]=d.scale.serialize()),d.font&&(y["text-font"]=d.font.serialize()),d.textColor&&(y["text-color"]=d.textColor.serialize()),a.push(y)}return a};var $r=function(o){this.type=Mi,this.input=o};$r.parse=function(a,o){if(a.length!==2)return o.error("Expected two arguments.");var u=o.parse(a[1],1,Cn);return u?new $r(u):o.error("No image name provided.")},$r.prototype.evaluate=function(a){var o=this.input.evaluate(a),u=Ct.fromString(o);return u&&a.availableImages&&(u.available=a.availableImages.indexOf(o)>-1),u},$r.prototype.eachChild=function(a){a(this.input)},$r.prototype.outputDefined=function(){return!1},$r.prototype.serialize=function(){return["image",this.input.serialize()]};var Oo={"to-boolean":hn,"to-color":xn,"to-number":tr,"to-string":Cn},mt=function(o,u){this.type=o,this.args=u};mt.parse=function(a,o){if(a.length<2)return o.error("Expected at least one argument.");var u=a[0];if((u==="to-boolean"||u==="to-string")&&a.length!==2)return o.error("Expected one argument.");for(var d=Oo[u],y=[],b=1;b<a.length;b++){var C=o.parse(a[b],b,wn);if(!C)return null;y.push(C)}return new mt(d,y)},mt.prototype.evaluate=function(a){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(a));if(this.type.kind==="color"){for(var o,u,d=0,y=this.args;d<y.length;d+=1){if(u=null,(o=y[d].evaluate(a))instanceof xi)return o;if(typeof o=="string"){var b=a.parseColor(o);if(b)return b}else if(Array.isArray(o)&&!(u=o.length<3||o.length>4?"Invalid rbga value "+JSON.stringify(o)+": expected an array containing either three or four numeric values.":ss(o[0],o[1],o[2],o[3])))return new xi(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Ta(u||"Could not parse color from value '"+(typeof o=="string"?o:String(JSON.stringify(o)))+"'")}if(this.type.kind==="number"){for(var C=null,P=0,D=this.args;P<D.length;P+=1){if((C=D[P].evaluate(a))===null)return 0;var j=Number(C);if(!isNaN(j))return j}throw new Ta("Could not convert "+JSON.stringify(C)+" to number.")}return this.type.kind==="formatted"?Ea.fromString(ro(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?Ct.fromString(ro(this.args[0].evaluate(a))):ro(this.args[0].evaluate(a))},mt.prototype.eachChild=function(a){this.args.forEach(a)},mt.prototype.outputDefined=function(){return this.args.every(function(a){return a.outputDefined()})},mt.prototype.serialize=function(){if(this.type.kind==="formatted")return new Xo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new $r(this.args[0]).serialize();var a=["to-"+this.type.kind];return this.eachChild(function(o){a.push(o.serialize())}),a};var wu=["Unknown","Point","LineString","Polygon"],ms=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ms.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ms.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?wu[this.feature.type]:this.feature.type:null},ms.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ms.prototype.canonicalID=function(){return this.canonical},ms.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ms.prototype.parseColor=function(a){var o=this._parseColorCache[a];return o||(o=this._parseColorCache[a]=xi.parse(a)),o};var oe=function(o,u,d,y){this.name=o,this.type=u,this._evaluate=d,this.args=y};oe.prototype.evaluate=function(a){return this._evaluate(a,this.args)},oe.prototype.eachChild=function(a){this.args.forEach(a)},oe.prototype.outputDefined=function(){return!1},oe.prototype.serialize=function(){return[this.name].concat(this.args.map(function(a){return a.serialize()}))},oe.parse=function(a,o){var u,d=a[0],y=oe.definitions[d];if(!y)return o.error('Unknown expression "'+d+'". If you wanted a literal array, use ["literal", [...]].',0);for(var b=Array.isArray(y)?y[0]:y.type,C=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,P=C.filter(function($n){var Bn=$n[0];return!Array.isArray(Bn)||Bn.length===a.length-1}),D=null,j=0,X=P;j<X.length;j+=1){var ee=X[j],te=ee[0],Ee=ee[1];D=new au(o.registry,o.path,null,o.scope);for(var Le=[],Oe=!1,We=1;We<a.length;We++){var Ze=a[We],yt=Array.isArray(te)?te[We-1]:te.type,Dt=D.parse(Ze,1+Le.length,yt);if(!Dt){Oe=!0;break}Le.push(Dt)}if(!Oe)if(Array.isArray(te)&&te.length!==Le.length)D.error("Expected "+te.length+" arguments, but found "+Le.length+" instead.");else{for(var Xt=0;Xt<Le.length;Xt++){var mr=Array.isArray(te)?te[Xt]:te.type,sr=Le[Xt];D.concat(Xt+1).checkSubtype(mr,sr.type)}if(D.errors.length===0)return new oe(d,b,Ee,Le)}}if(P.length===1)(u=o.errors).push.apply(u,D.errors);else{for(var Qr=(P.length?P:C).map(function($n){var Bn;return Bn=$n[0],Array.isArray(Bn)?"("+Bn.map(Ui).join(", ")+")":"("+Ui(Bn.type)+"...)"}).join(" | "),nn=[],Gn=1;Gn<a.length;Gn++){var ei=o.parse(a[Gn],1+nn.length);if(!ei)return null;nn.push(Ui(ei.type))}o.error("Expected arguments of type "+Qr+", but found ("+nn.join(", ")+") instead.")}return null},oe.register=function(a,o){for(var u in oe.definitions=o,o)a[u]=oe};var Ws=function(o,u,d){this.type=Ni,this.locale=d,this.caseSensitive=o,this.diacriticSensitive=u};function Io(a,o){a[0]=Math.min(a[0],o[0]),a[1]=Math.min(a[1],o[1]),a[2]=Math.max(a[2],o[0]),a[3]=Math.max(a[3],o[1])}function xo(a,o){return!(a[0]<=o[0]||a[2]>=o[2]||a[1]<=o[1]||a[3]>=o[3])}function Ve(a,o){var u=(180+a[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,y=Math.pow(2,o.z);return[Math.round(u*y*8192),Math.round(d*y*8192)]}function fe(a,o,u){return o[1]>a[1]!=u[1]>a[1]&&a[0]<(u[0]-o[0])*(a[1]-o[1])/(u[1]-o[1])+o[0]}function Ue(a,o){for(var u,d,y,b,C,P,D,j=!1,X=0,ee=o.length;X<ee;X++)for(var te=o[X],Ee=0,Le=te.length;Ee<Le-1;Ee++){if((b=(u=a)[0]-(d=te[Ee])[0])*(D=u[1]-(y=te[Ee+1])[1])-(P=u[0]-y[0])*(C=u[1]-d[1])==0&&b*P<=0&&C*D<=0)return!1;fe(a,te[Ee],te[Ee+1])&&(j=!j)}return j}function kt(a,o){for(var u=0;u<o.length;u++)if(Ue(a,o[u]))return!0;return!1}function Gr(a,o,u,d){var y=d[0]-u[0],b=d[1]-u[1],C=(a[0]-u[0])*b-y*(a[1]-u[1]),P=(o[0]-u[0])*b-y*(o[1]-u[1]);return C>0&&P<0||C<0&&P>0}function In(a,o,u){for(var d=0,y=u;d<y.length;d+=1)for(var b=y[d],C=0;C<b.length-1;++C)if((ee=[(X=b[C+1])[0]-(j=b[C])[0],X[1]-j[1]])[0]*(te=[(D=o)[0]-(P=a)[0],D[1]-P[1]])[1]-ee[1]*te[0]!=0&&Gr(P,D,j,X)&&Gr(j,X,P,D))return!0;var P,D,j,X,ee,te;return!1}function Li(a,o){for(var u=0;u<a.length;++u)if(!Ue(a[u],o))return!1;for(var d=0;d<a.length-1;++d)if(In(a[d],a[d+1],o))return!1;return!0}function Oa(a,o){for(var u=0;u<o.length;u++)if(Li(a,o[u]))return!0;return!1}function Sa(a,o,u){for(var d=[],y=0;y<a.length;y++){for(var b=[],C=0;C<a[y].length;C++){var P=Ve(a[y][C],u);Io(o,P),b.push(P)}d.push(b)}return d}function Ia(a,o,u){for(var d=[],y=0;y<a.length;y++){var b=Sa(a[y],o,u);d.push(b)}return d}function oo(a,o,u,d){if(a[0]<u[0]||a[0]>u[2]){var y=.5*d,b=a[0]-u[0]>y?-d:u[0]-a[0]>y?d:0;b===0&&(b=a[0]-u[2]>y?-d:u[2]-a[0]>y?d:0),a[0]+=b}Io(o,a)}function Cl(a,o,u,d){for(var y=8192*Math.pow(2,d.z),b=[8192*d.x,8192*d.y],C=[],P=0,D=a;P<D.length;P+=1)for(var j=0,X=D[P];j<X.length;j+=1){var ee=X[j],te=[ee.x+b[0],ee.y+b[1]];oo(te,o,u,y),C.push(te)}return C}function gs(a,o,u,d){for(var y,b=8192*Math.pow(2,d.z),C=[8192*d.x,8192*d.y],P=[],D=0,j=a;D<j.length;D+=1){for(var X=[],ee=0,te=j[D];ee<te.length;ee+=1){var Ee=te[ee],Le=[Ee.x+C[0],Ee.y+C[1]];Io(o,Le),X.push(Le)}P.push(X)}if(o[2]-o[0]<=b/2){(y=o)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(var Oe=0,We=P;Oe<We.length;Oe+=1)for(var Ze=0,yt=We[Oe];Ze<yt.length;Ze+=1)oo(yt[Ze],o,u,b)}return P}Ws.parse=function(a,o){if(a.length!==2)return o.error("Expected one argument.");var u=a[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");var d=o.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,hn);if(!d)return null;var y=o.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,hn);if(!y)return null;var b=null;return u.locale&&!(b=o.parse(u.locale,1,Cn))?null:new Ws(d,y,b)},Ws.prototype.evaluate=function(a){return new to(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)},Ws.prototype.eachChild=function(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)},Ws.prototype.outputDefined=function(){return!1},Ws.prototype.serialize=function(){var a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]};var ho=function(o,u){this.type=hn,this.geojson=o,this.geometries=u};function us(a){if(a instanceof oe&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof ho)return!1;var o=!0;return a.eachChild(function(u){o&&!us(u)&&(o=!1)}),o}function Ts(a){if(a instanceof oe&&a.name==="feature-state")return!1;var o=!0;return a.eachChild(function(u){o&&!Ts(u)&&(o=!1)}),o}function Ms(a,o){if(a instanceof oe&&o.indexOf(a.name)>=0)return!1;var u=!0;return a.eachChild(function(d){u&&!Ms(d,o)&&(u=!1)}),u}ho.parse=function(a,o){if(a.length!==2)return o.error("'within' expression requires exactly one argument, but found "+(a.length-1)+" instead.");if(Bt(a[1])){var u=a[1];if(u.type==="FeatureCollection")for(var d=0;d<u.features.length;++d){var y=u.features[d].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new ho(u,u.features[d].geometry)}else if(u.type==="Feature"){var b=u.geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new ho(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new ho(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ho.prototype.evaluate=function(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(o,u){var d=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=o.canonicalID();if(u.type==="Polygon"){var C=Sa(u.coordinates,y,b),P=Cl(o.geometry(),d,y,b);if(!xo(d,y))return!1;for(var D=0,j=P;D<j.length;D+=1)if(!Ue(j[D],C))return!1}if(u.type==="MultiPolygon"){var X=Ia(u.coordinates,y,b),ee=Cl(o.geometry(),d,y,b);if(!xo(d,y))return!1;for(var te=0,Ee=ee;te<Ee.length;te+=1)if(!kt(Ee[te],X))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(o,u){var d=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=o.canonicalID();if(u.type==="Polygon"){var C=Sa(u.coordinates,y,b),P=gs(o.geometry(),d,y,b);if(!xo(d,y))return!1;for(var D=0,j=P;D<j.length;D+=1)if(!Li(j[D],C))return!1}if(u.type==="MultiPolygon"){var X=Ia(u.coordinates,y,b),ee=gs(o.geometry(),d,y,b);if(!xo(d,y))return!1;for(var te=0,Ee=ee;te<Ee.length;te+=1)if(!Oa(Ee[te],X))return!1}return!0}(a,this.geometries)}return!1},ho.prototype.eachChild=function(){},ho.prototype.outputDefined=function(){return!0},ho.prototype.serialize=function(){return["within",this.geojson]};var Yo=function(o,u){this.type=u.type,this.name=o,this.boundExpression=u};Yo.parse=function(a,o){if(a.length!==2||typeof a[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");var u=a[1];return o.scope.has(u)?new Yo(u,o.scope.get(u)):o.error('Unknown variable "'+u+'". Make sure "'+u+'" has been bound in an enclosing "let" expression before using it.',1)},Yo.prototype.evaluate=function(a){return this.boundExpression.evaluate(a)},Yo.prototype.eachChild=function(){},Yo.prototype.outputDefined=function(){return!1},Yo.prototype.serialize=function(){return["var",this.name]};var au=function(o,u,d,y,b){u===void 0&&(u=[]),y===void 0&&(y=new an),b===void 0&&(b=[]),this.registry=o,this.path=u,this.key=u.map(function(C){return"["+C+"]"}).join(""),this.scope=y,this.errors=b,this.expectedType=d};function Ps(a,o){for(var u,d=a.length-1,y=0,b=d,C=0;y<=b;)if((u=a[C=Math.floor((y+b)/2)])<=o){if(C===d||o<a[C+1])return C;y=C+1}else{if(!(u>o))throw new Ta("Input is not a number.");b=C-1}return 0}au.prototype.parse=function(a,o,u,d,y){return y===void 0&&(y={}),o?this.concat(o,u,d)._parse(a,y):this._parse(a,y)},au.prototype._parse=function(a,o){function u(j,X,ee){return ee==="assert"?new Nr(X,[j]):ee==="coerce"?new mt(X,[j]):j}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var d=a[0];if(typeof d!="string")return this.error("Expression name must be a string, but found "+typeof d+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var y=this.registry[d];if(y){var b=y.parse(a,this);if(!b)return null;if(this.expectedType){var C=this.expectedType,P=b.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||P.kind!=="value")if(C.kind!=="color"&&C.kind!=="formatted"&&C.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string"){if(this.checkSubtype(C,P))return null}else b=u(b,C,o.typeAnnotation||"coerce");else b=u(b,C,o.typeAnnotation||"assert")}if(!(b instanceof Pa)&&b.type.kind!=="resolvedImage"&&function j(X){if(X instanceof Yo)return j(X.boundExpression);if(X instanceof oe&&X.name==="error"||X instanceof Ws||X instanceof ho)return!1;var ee=X instanceof mt||X instanceof Nr,te=!0;return X.eachChild(function(Ee){te=ee?te&&j(Ee):te&&Ee instanceof Pa}),!!te&&us(X)&&Ms(X,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(b)){var D=new ms;try{b=new Pa(b.type,b.evaluate(D))}catch(j){return this.error(j.message),null}}return b}return this.error('Unknown expression "'+d+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof a+" instead.")},au.prototype.concat=function(a,o,u){var d=typeof a=="number"?this.path.concat(a):this.path,y=u?this.scope.concat(u):this.scope;return new au(this.registry,d,o||null,y,this.errors)},au.prototype.error=function(a){for(var o=[],u=arguments.length-1;u-- >0;)o[u]=arguments[u+1];var d=""+this.key+o.map(function(y){return"["+y+"]"}).join("");this.errors.push(new Lr(d,a))},au.prototype.checkSubtype=function(a,o){var u=ia(a,o);return u&&this.error(u),u};var Ca=function(o,u,d){this.type=o,this.input=u,this.labels=[],this.outputs=[];for(var y=0,b=d;y<b.length;y+=1){var C=b[y],P=C[1];this.labels.push(C[0]),this.outputs.push(P)}};function Va(a,o,u){return a*(1-u)+o*u}Ca.parse=function(a,o){if(a.length-1<4)return o.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if((a.length-1)%2!=0)return o.error("Expected an even number of arguments.");var u=o.parse(a[1],1,tr);if(!u)return null;var d=[],y=null;o.expectedType&&o.expectedType.kind!=="value"&&(y=o.expectedType);for(var b=1;b<a.length;b+=2){var C=b===1?-1/0:a[b],P=a[b+1],D=b,j=b+1;if(typeof C!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(d.length&&d[d.length-1][0]>=C)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);var X=o.parse(P,j,y);if(!X)return null;y=y||X.type,d.push([C,X])}return new Ca(y,u,d)},Ca.prototype.evaluate=function(a){var o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(a);var d=this.input.evaluate(a);if(d<=o[0])return u[0].evaluate(a);var y=o.length;return d>=o[y-1]?u[y-1].evaluate(a):u[Ps(o,d)].evaluate(a)},Ca.prototype.eachChild=function(a){a(this.input);for(var o=0,u=this.outputs;o<u.length;o+=1)a(u[o])},Ca.prototype.outputDefined=function(){return this.outputs.every(function(a){return a.outputDefined()})},Ca.prototype.serialize=function(){for(var a=["step",this.input.serialize()],o=0;o<this.labels.length;o++)o>0&&a.push(this.labels[o]),a.push(this.outputs[o].serialize());return a};var lu=Object.freeze({__proto__:null,number:Va,color:function(o,u,d){return new xi(Va(o.r,u.r,d),Va(o.g,u.g,d),Va(o.b,u.b,d),Va(o.a,u.a,d))},array:function(o,u,d){return o.map(function(y,b){return Va(y,u[b],d)})}}),Tu=6/29*3*(6/29),rh=Math.PI/180,Al=180/Math.PI;function wl(a){return a>.008856451679035631?Math.pow(a,1/3):a/Tu+4/29}function cu(a){return a>6/29?a*a*a:Tu*(a-4/29)}function fu(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function _(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function O(a){var o=_(a.r),u=_(a.g),d=_(a.b),y=wl((.4124564*o+.3575761*u+.1804375*d)/.95047),b=wl((.2126729*o+.7151522*u+.072175*d)/1);return{l:116*b-16,a:500*(y-b),b:200*(b-wl((.0193339*o+.119192*u+.9503041*d)/1.08883)),alpha:a.a}}function V(a){var o=(a.l+16)/116,u=isNaN(a.a)?o:o+a.a/500,d=isNaN(a.b)?o:o-a.b/200;return o=1*cu(o),u=.95047*cu(u),d=1.08883*cu(d),new xi(fu(3.2404542*u-1.5371385*o-.4985314*d),fu(-.969266*u+1.8760108*o+.041556*d),fu(.0556434*u-.2040259*o+1.0572252*d),a.alpha)}function L(a,o,u){var d=o-a;return a+u*(d>180||d<-180?d-360*Math.round(d/360):d)}var ne={forward:O,reverse:V,interpolate:function(o,u,d){return{l:Va(o.l,u.l,d),a:Va(o.a,u.a,d),b:Va(o.b,u.b,d),alpha:Va(o.alpha,u.alpha,d)}}},Te={forward:function(o){var u=O(o),d=u.l,y=u.a,b=u.b,C=Math.atan2(b,y)*Al;return{h:C<0?C+360:C,c:Math.sqrt(y*y+b*b),l:d,alpha:o.a}},reverse:function(o){var u=o.h*rh,d=o.c;return V({l:o.l,a:Math.cos(u)*d,b:Math.sin(u)*d,alpha:o.alpha})},interpolate:function(o,u,d){return{h:L(o.h,u.h,d),c:Va(o.c,u.c,d),l:Va(o.l,u.l,d),alpha:Va(o.alpha,u.alpha,d)}}},Je=Object.freeze({__proto__:null,lab:ne,hcl:Te}),pt=function(o,u,d,y,b){this.type=o,this.operator=u,this.interpolation=d,this.input=y,this.labels=[],this.outputs=[];for(var C=0,P=b;C<P.length;C+=1){var D=P[C],j=D[1];this.labels.push(D[0]),this.outputs.push(j)}};function Tt(a,o,u,d){var y=d-u,b=a-u;return y===0?0:o===1?b/y:(Math.pow(o,b)-1)/(Math.pow(o,y)-1)}pt.interpolationFactor=function(a,o,u,d){var y=0;if(a.name==="exponential")y=Tt(o,a.base,u,d);else if(a.name==="linear")y=Tt(o,1,u,d);else if(a.name==="cubic-bezier"){var b=a.controlPoints;y=new U(b[0],b[1],b[2],b[3]).solve(Tt(o,1,u,d))}return y},pt.parse=function(a,o){var u=a[0],d=a[1],y=a[2],b=a.slice(3);if(!Array.isArray(d)||d.length===0)return o.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){var C=d[1];if(typeof C!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:C}}else{if(d[0]!=="cubic-bezier")return o.error("Unknown interpolation type "+String(d[0]),1,0);var P=d.slice(1);if(P.length!==4||P.some(function(We){return typeof We!="number"||We<0||We>1}))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:P}}if(a.length-1<4)return o.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if((a.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(!(y=o.parse(y,2,tr)))return null;var D=[],j=null;u==="interpolate-hcl"||u==="interpolate-lab"?j=xn:o.expectedType&&o.expectedType.kind!=="value"&&(j=o.expectedType);for(var X=0;X<b.length;X+=2){var ee=b[X],te=b[X+1],Ee=X+3,Le=X+4;if(typeof ee!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ee);if(D.length&&D[D.length-1][0]>=ee)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Ee);var Oe=o.parse(te,Le,j);if(!Oe)return null;j=j||Oe.type,D.push([ee,Oe])}return j.kind==="number"||j.kind==="color"||j.kind==="array"&&j.itemType.kind==="number"&&typeof j.N=="number"?new pt(j,u,d,y,D):o.error("Type "+Ui(j)+" is not interpolatable.")},pt.prototype.evaluate=function(a){var o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(a);var d=this.input.evaluate(a);if(d<=o[0])return u[0].evaluate(a);var y=o.length;if(d>=o[y-1])return u[y-1].evaluate(a);var b=Ps(o,d),C=pt.interpolationFactor(this.interpolation,d,o[b],o[b+1]),P=u[b].evaluate(a),D=u[b+1].evaluate(a);return this.operator==="interpolate"?lu[this.type.kind.toLowerCase()](P,D,C):this.operator==="interpolate-hcl"?Te.reverse(Te.interpolate(Te.forward(P),Te.forward(D),C)):ne.reverse(ne.interpolate(ne.forward(P),ne.forward(D),C))},pt.prototype.eachChild=function(a){a(this.input);for(var o=0,u=this.outputs;o<u.length;o+=1)a(u[o])},pt.prototype.outputDefined=function(){return this.outputs.every(function(a){return a.outputDefined()})},pt.prototype.serialize=function(){var a;a=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var o=[this.operator,a,this.input.serialize()],u=0;u<this.labels.length;u++)o.push(this.labels[u],this.outputs[u].serialize());return o};var wr=function(o,u){this.type=o,this.args=u};wr.parse=function(a,o){if(a.length<2)return o.error("Expectected at least one argument.");var u=null,d=o.expectedType;d&&d.kind!=="value"&&(u=d);for(var y=[],b=0,C=a.slice(1);b<C.length;b+=1){var P=o.parse(C[b],1+y.length,u,void 0,{typeAnnotation:"omit"});if(!P)return null;u=u||P.type,y.push(P)}var D=d&&y.some(function(j){return ia(d,j.type)});return new wr(D?wn:u,y)},wr.prototype.evaluate=function(a){for(var o,u=null,d=0,y=0,b=this.args;y<b.length&&(d++,(u=b[y].evaluate(a))&&u instanceof Ct&&!u.available&&(o||(o=u.name),u=null,d===this.args.length&&(u=o)),u===null);y+=1);return u},wr.prototype.eachChild=function(a){this.args.forEach(a)},wr.prototype.outputDefined=function(){return this.args.every(function(a){return a.outputDefined()})},wr.prototype.serialize=function(){var a=["coalesce"];return this.eachChild(function(o){a.push(o.serialize())}),a};var Fr=function(o,u){this.type=u.type,this.bindings=[].concat(o),this.result=u};Fr.prototype.evaluate=function(a){return this.result.evaluate(a)},Fr.prototype.eachChild=function(a){for(var o=0,u=this.bindings;o<u.length;o+=1)a(u[o][1]);a(this.result)},Fr.parse=function(a,o){if(a.length<4)return o.error("Expected at least 3 arguments, but found "+(a.length-1)+" instead.");for(var u=[],d=1;d<a.length-1;d+=2){var y=a[d];if(typeof y!="string")return o.error("Expected string, but found "+typeof y+" instead.",d);if(/[^a-zA-Z0-9_]/.test(y))return o.error("Variable names must contain only alphanumeric characters or '_'.",d);var b=o.parse(a[d+1],d+1);if(!b)return null;u.push([y,b])}var C=o.parse(a[a.length-1],a.length-1,o.expectedType,u);return C?new Fr(u,C):null},Fr.prototype.outputDefined=function(){return this.result.outputDefined()},Fr.prototype.serialize=function(){for(var a=["let"],o=0,u=this.bindings;o<u.length;o+=1){var d=u[o];a.push(d[0],d[1].serialize())}return a.push(this.result.serialize()),a};var Wn=function(o,u,d){this.type=o,this.index=u,this.input=d};Wn.parse=function(a,o){if(a.length!==3)return o.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var u=o.parse(a[1],1,tr),d=o.parse(a[2],2,Fn(o.expectedType||wn));return u&&d?new Wn(d.type.itemType,u,d):null},Wn.prototype.evaluate=function(a){var o=this.index.evaluate(a),u=this.input.evaluate(a);if(o<0)throw new Ta("Array index out of bounds: "+o+" < 0.");if(o>=u.length)throw new Ta("Array index out of bounds: "+o+" > "+(u.length-1)+".");if(o!==Math.floor(o))throw new Ta("Array index must be an integer, but found "+o+" instead.");return u[o]},Wn.prototype.eachChild=function(a){a(this.index),a(this.input)},Wn.prototype.outputDefined=function(){return!1},Wn.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ci=function(o,u){this.type=hn,this.needle=o,this.haystack=u};Ci.parse=function(a,o){if(a.length!==3)return o.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var u=o.parse(a[1],1,wn),d=o.parse(a[2],2,wn);return u&&d?Ka(u.type,[hn,Cn,tr,An,wn])?new Ci(u,d):o.error("Expected first argument to be of type boolean, string, number or null, but found "+Ui(u.type)+" instead"):null},Ci.prototype.evaluate=function(a){var o=this.needle.evaluate(a),u=this.haystack.evaluate(a);if(!u)return!1;if(!ri(o,["boolean","string","number","null"]))throw new Ta("Expected first argument to be of type boolean, string, number or null, but found "+Ui(wa(o))+" instead.");if(!ri(u,["string","array"]))throw new Ta("Expected second argument to be of type array or string, but found "+Ui(wa(u))+" instead.");return u.indexOf(o)>=0},Ci.prototype.eachChild=function(a){a(this.needle),a(this.haystack)},Ci.prototype.outputDefined=function(){return!0},Ci.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var di=function(o,u,d){this.type=tr,this.needle=o,this.haystack=u,this.fromIndex=d};di.parse=function(a,o){if(a.length<=2||a.length>=5)return o.error("Expected 3 or 4 arguments, but found "+(a.length-1)+" instead.");var u=o.parse(a[1],1,wn),d=o.parse(a[2],2,wn);if(!u||!d)return null;if(!Ka(u.type,[hn,Cn,tr,An,wn]))return o.error("Expected first argument to be of type boolean, string, number or null, but found "+Ui(u.type)+" instead");if(a.length===4){var y=o.parse(a[3],3,tr);return y?new di(u,d,y):null}return new di(u,d)},di.prototype.evaluate=function(a){var o=this.needle.evaluate(a),u=this.haystack.evaluate(a);if(!ri(o,["boolean","string","number","null"]))throw new Ta("Expected first argument to be of type boolean, string, number or null, but found "+Ui(wa(o))+" instead.");if(!ri(u,["string","array"]))throw new Ta("Expected second argument to be of type array or string, but found "+Ui(wa(u))+" instead.");if(this.fromIndex){var d=this.fromIndex.evaluate(a);return u.indexOf(o,d)}return u.indexOf(o)},di.prototype.eachChild=function(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)},di.prototype.outputDefined=function(){return!1},di.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var aa=function(o,u,d,y,b,C){this.inputType=o,this.type=u,this.input=d,this.cases=y,this.outputs=b,this.otherwise=C};aa.parse=function(a,o){if(a.length<5)return o.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if(a.length%2!=1)return o.error("Expected an even number of arguments.");var u,d;o.expectedType&&o.expectedType.kind!=="value"&&(d=o.expectedType);for(var y={},b=[],C=2;C<a.length-1;C+=2){var P=a[C],D=a[C+1];Array.isArray(P)||(P=[P]);var j=o.concat(C);if(P.length===0)return j.error("Expected at least one branch label.");for(var X=0,ee=P;X<ee.length;X+=1){var te=ee[X];if(typeof te!="number"&&typeof te!="string")return j.error("Branch labels must be numbers or strings.");if(typeof te=="number"&&Math.abs(te)>Number.MAX_SAFE_INTEGER)return j.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof te=="number"&&Math.floor(te)!==te)return j.error("Numeric branch labels must be integer values.");if(u){if(j.checkSubtype(u,wa(te)))return null}else u=wa(te);if(y[String(te)]!==void 0)return j.error("Branch labels must be unique.");y[String(te)]=b.length}var Ee=o.parse(D,C,d);if(!Ee)return null;d=d||Ee.type,b.push(Ee)}var Le=o.parse(a[1],1,wn);if(!Le)return null;var Oe=o.parse(a[a.length-1],a.length-1,d);return Oe?Le.type.kind!=="value"&&o.concat(1).checkSubtype(u,Le.type)?null:new aa(u,d,Le,y,b,Oe):null},aa.prototype.evaluate=function(a){var o=this.input.evaluate(a);return(wa(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(a)},aa.prototype.eachChild=function(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)},aa.prototype.outputDefined=function(){return this.outputs.every(function(a){return a.outputDefined()})&&this.otherwise.outputDefined()},aa.prototype.serialize=function(){for(var a=this,o=["match",this.input.serialize()],u=[],d={},y=0,b=Object.keys(this.cases).sort();y<b.length;y+=1){var C=b[y];(ee=d[this.cases[C]])===void 0?(d[this.cases[C]]=u.length,u.push([this.cases[C],[C]])):u[ee][1].push(C)}for(var P=function(Le){return a.inputType.kind==="number"?Number(Le):Le},D=0,j=u;D<j.length;D+=1){var X=j[D],ee=X[0],te=X[1];o.push(te.length===1?P(te[0]):te.map(P)),o.push(this.outputs[outputIndex$1].serialize())}return o.push(this.otherwise.serialize()),o};var sa=function(o,u,d){this.type=o,this.branches=u,this.otherwise=d};sa.parse=function(a,o){if(a.length<4)return o.error("Expected at least 3 arguments, but found only "+(a.length-1)+".");if(a.length%2!=0)return o.error("Expected an odd number of arguments.");var u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);for(var d=[],y=1;y<a.length-1;y+=2){var b=o.parse(a[y],y,hn);if(!b)return null;var C=o.parse(a[y+1],y+1,u);if(!C)return null;d.push([b,C]),u=u||C.type}var P=o.parse(a[a.length-1],a.length-1,u);return P?new sa(u,d,P):null},sa.prototype.evaluate=function(a){for(var o=0,u=this.branches;o<u.length;o+=1){var d=u[o],y=d[1];if(d[0].evaluate(a))return y.evaluate(a)}return this.otherwise.evaluate(a)},sa.prototype.eachChild=function(a){for(var o=0,u=this.branches;o<u.length;o+=1){var d=u[o],y=d[1];a(d[0]),a(y)}a(this.otherwise)},sa.prototype.outputDefined=function(){return this.branches.every(function(a){return a[1].outputDefined()})&&this.otherwise.outputDefined()},sa.prototype.serialize=function(){var a=["case"];return this.eachChild(function(o){a.push(o.serialize())}),a};var pa=function(o,u,d,y){this.type=o,this.input=u,this.beginIndex=d,this.endIndex=y};function ou(a,o){return a==="=="||a==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function ys(a,o,u,d){return d.compare(o,u)===0}function ea(a,o,u){var d=a!=="=="&&a!=="!=";return function(){function y(b,C,P){this.type=hn,this.lhs=b,this.rhs=C,this.collator=P,this.hasUntypedArgument=b.type.kind==="value"||C.type.kind==="value"}return y.parse=function(b,C){if(b.length!==3&&b.length!==4)return C.error("Expected two or three arguments.");var P=b[0],D=C.parse(b[1],1,wn);if(!D)return null;if(!ou(P,D.type))return C.concat(1).error('"'+P+`" comparisons are not supported for type '`+Ui(D.type)+"'.");var j=C.parse(b[2],2,wn);if(!j)return null;if(!ou(P,j.type))return C.concat(2).error('"'+P+`" comparisons are not supported for type '`+Ui(j.type)+"'.");if(D.type.kind!==j.type.kind&&D.type.kind!=="value"&&j.type.kind!=="value")return C.error("Cannot compare types '"+Ui(D.type)+"' and '"+Ui(j.type)+"'.");d&&(D.type.kind==="value"&&j.type.kind!=="value"?D=new Nr(j.type,[D]):D.type.kind!=="value"&&j.type.kind==="value"&&(j=new Nr(D.type,[j])));var X=null;if(b.length===4){if(D.type.kind!=="string"&&j.type.kind!=="string"&&D.type.kind!=="value"&&j.type.kind!=="value")return C.error("Cannot use collator to compare non-string types.");if(!(X=C.parse(b[3],3,Ni)))return null}return new y(D,j,X)},y.prototype.evaluate=function(b){var C=this.lhs.evaluate(b),P=this.rhs.evaluate(b);if(d&&this.hasUntypedArgument){var D=wa(C),j=wa(P);if(D.kind!==j.kind||D.kind!=="string"&&D.kind!=="number")throw new Ta('Expected arguments for "'+a+'" to be (string, string) or (number, number), but found ('+D.kind+", "+j.kind+") instead.")}if(this.collator&&!d&&this.hasUntypedArgument){var X=wa(C),ee=wa(P);if(X.kind!=="string"||ee.kind!=="string")return o(b,C,P)}return this.collator?u(b,C,P,this.collator.evaluate(b)):o(b,C,P)},y.prototype.eachChild=function(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)},y.prototype.outputDefined=function(){return!0},y.prototype.serialize=function(){var b=[a];return this.eachChild(function(C){b.push(C.serialize())}),b},y}()}pa.parse=function(a,o){if(a.length<=2||a.length>=5)return o.error("Expected 3 or 4 arguments, but found "+(a.length-1)+" instead.");var u=o.parse(a[1],1,wn),d=o.parse(a[2],2,tr);if(!u||!d)return null;if(!Ka(u.type,[Fn(wn),Cn,wn]))return o.error("Expected first argument to be of type array or string, but found "+Ui(u.type)+" instead");if(a.length===4){var y=o.parse(a[3],3,tr);return y?new pa(u.type,u,d,y):null}return new pa(u.type,u,d)},pa.prototype.evaluate=function(a){var o=this.input.evaluate(a),u=this.beginIndex.evaluate(a);if(!ri(o,["string","array"]))throw new Ta("Expected first argument to be of type array or string, but found "+Ui(wa(o))+" instead.");if(this.endIndex){var d=this.endIndex.evaluate(a);return o.slice(u,d)}return o.slice(u)},pa.prototype.eachChild=function(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)},pa.prototype.outputDefined=function(){return!1},pa.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var _s=ea("==",function(a,o,u){return o===u},ys),ic=ea("!=",function(a,o,u){return o!==u},function(a,o,u,d){return!ys(0,o,u,d)}),Tl=ea("<",function(a,o,u){return o<u},function(a,o,u,d){return d.compare(o,u)<0}),jl=ea(">",function(a,o,u){return o>u},function(a,o,u,d){return d.compare(o,u)>0}),Dc=ea("<=",function(a,o,u){return o<=u},function(a,o,u,d){return d.compare(o,u)<=0}),_f=ea(">=",function(a,o,u){return o>=u},function(a,o,u,d){return d.compare(o,u)>=0}),hu=function(o,u,d,y,b){this.type=Cn,this.number=o,this.locale=u,this.currency=d,this.minFractionDigits=y,this.maxFractionDigits=b};hu.parse=function(a,o){if(a.length!==3)return o.error("Expected two arguments.");var u=o.parse(a[1],1,tr);if(!u)return null;var d=a[2];if(typeof d!="object"||Array.isArray(d))return o.error("NumberFormat options argument must be an object.");var y=null;if(d.locale&&!(y=o.parse(d.locale,1,Cn)))return null;var b=null;if(d.currency&&!(b=o.parse(d.currency,1,Cn)))return null;var C=null;if(d["min-fraction-digits"]&&!(C=o.parse(d["min-fraction-digits"],1,tr)))return null;var P=null;return d["max-fraction-digits"]&&!(P=o.parse(d["max-fraction-digits"],1,tr))?null:new hu(u,y,b,C,P)},hu.prototype.evaluate=function(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))},hu.prototype.eachChild=function(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)},hu.prototype.outputDefined=function(){return!1},hu.prototype.serialize=function(){var a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]};var Ji=function(o){this.type=tr,this.input=o};Ji.parse=function(a,o){if(a.length!==2)return o.error("Expected 1 argument, but found "+(a.length-1)+" instead.");var u=o.parse(a[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error("Expected argument of type string or array, but found "+Ui(u.type)+" instead."):new Ji(u):null},Ji.prototype.evaluate=function(a){var o=this.input.evaluate(a);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Ta("Expected value to be of type string or array, but found "+Ui(wa(o))+" instead.")},Ji.prototype.eachChild=function(a){a(this.input)},Ji.prototype.outputDefined=function(){return!1},Ji.prototype.serialize=function(){var a=["length"];return this.eachChild(function(o){a.push(o.serialize())}),a};var Mu={"==":_s,"!=":ic,">":jl,"<":Tl,">=":_f,"<=":Dc,array:Nr,at:Wn,boolean:Nr,case:sa,coalesce:wr,collator:Ws,format:Xo,image:$r,in:Ci,"index-of":di,interpolate:pt,"interpolate-hcl":pt,"interpolate-lab":pt,length:Ji,let:Fr,literal:Pa,match:aa,number:Nr,"number-format":hu,object:Nr,slice:pa,step:Ca,string:Nr,"to-boolean":mt,"to-color":mt,"to-number":mt,"to-string":mt,var:Yo,within:ho};function xf(a,o){var u=o[0],d=o[1],y=o[2],b=o[3];u=u.evaluate(a),d=d.evaluate(a),y=y.evaluate(a);var C=b?b.evaluate(a):1,P=ss(u,d,y,C);if(P)throw new Ta(P);return new xi(u/255*C,d/255*C,y/255*C,C)}function po(a,o){return a in o}function Fc(a,o){var u=o[a];return u===void 0?null:u}function Pu(a){return{type:a}}function Ml(a){return{result:"success",value:a}}function al(a){return{result:"error",value:a}}function Wu(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Vl(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function ol(a){return!!a.expression&&a.expression.interpolated}function Ra(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function ac(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function Dh(a){return a}function oc(a,o,u){return a!==void 0?a:o!==void 0?o:u!==void 0?u:void 0}function Fh(a,o,u,d,y){return oc(typeof u===y?d[u]:void 0,a.default,o.default)}function mp(a,o,u){if(Ra(u)!=="number")return oc(a.default,o.default);var d=a.stops.length;if(d===1||u<=a.stops[0][0])return a.stops[0][1];if(u>=a.stops[d-1][0])return a.stops[d-1][1];var y=Ps(a.stops.map(function(b){return b[0]}),u);return a.stops[y][1]}function Bh(a,o,u){var d=a.base!==void 0?a.base:1;if(Ra(u)!=="number")return oc(a.default,o.default);var y=a.stops.length;if(y===1||u<=a.stops[0][0])return a.stops[0][1];if(u>=a.stops[y-1][0])return a.stops[y-1][1];var b=Ps(a.stops.map(function(ee){return ee[0]}),u),C=function(ee,te,Ee,Le){var Oe=Le-Ee,We=ee-Ee;return Oe===0?0:te===1?We/Oe:(Math.pow(te,We)-1)/(Math.pow(te,Oe)-1)}(u,d,a.stops[b][0],a.stops[b+1][0]),P=a.stops[b][1],D=a.stops[b+1][1],j=lu[o.type]||Dh;if(a.colorSpace&&a.colorSpace!=="rgb"){var X=Je[a.colorSpace];j=function(te,Ee){return X.reverse(X.interpolate(X.forward(te),X.forward(Ee),C))}}return typeof P.evaluate=="function"?{evaluate:function(){for(var te=[],Ee=arguments.length;Ee--;)te[Ee]=arguments[Ee];var Le=P.evaluate.apply(void 0,te),Oe=D.evaluate.apply(void 0,te);if(Le!==void 0&&Oe!==void 0)return j(Le,Oe,C)}}:j(P,D,C)}function sc(a,o,u){return o.type==="color"?u=xi.parse(u):o.type==="formatted"?u=Ea.fromString(u.toString()):o.type==="resolvedImage"?u=Ct.fromString(u.toString()):Ra(u)===o.type||o.type==="enum"&&o.values[u]||(u=void 0),oc(u,a.default,o.default)}oe.register(Mu,{error:[{kind:"error"},[Cn],function(a,o){throw new Ta(o[0].evaluate(a))}],typeof:[Cn,[wn],function(a,o){return Ui(wa(o[0].evaluate(a)))}],"to-rgba":[Fn(tr,4),[xn],function(a,o){return o[0].evaluate(a).toArray()}],rgb:[xn,[tr,tr,tr],xf],rgba:[xn,[tr,tr,tr,tr],xf],has:{type:hn,overloads:[[[Cn],function(a,o){return po(o[0].evaluate(a),a.properties())}],[[Cn,_i],function(a,o){var u=o[1];return po(o[0].evaluate(a),u.evaluate(a))}]]},get:{type:wn,overloads:[[[Cn],function(a,o){return Fc(o[0].evaluate(a),a.properties())}],[[Cn,_i],function(a,o){var u=o[1];return Fc(o[0].evaluate(a),u.evaluate(a))}]]},"feature-state":[wn,[Cn],function(a,o){return Fc(o[0].evaluate(a),a.featureState||{})}],properties:[_i,[],function(a){return a.properties()}],"geometry-type":[Cn,[],function(a){return a.geometryType()}],id:[wn,[],function(a){return a.id()}],zoom:[tr,[],function(a){return a.globals.zoom}],"heatmap-density":[tr,[],function(a){return a.globals.heatmapDensity||0}],"line-progress":[tr,[],function(a){return a.globals.lineProgress||0}],accumulated:[wn,[],function(a){return a.globals.accumulated===void 0?null:a.globals.accumulated}],"+":[tr,Pu(tr),function(a,o){for(var u=0,d=0,y=o;d<y.length;d+=1)u+=y[d].evaluate(a);return u}],"*":[tr,Pu(tr),function(a,o){for(var u=1,d=0,y=o;d<y.length;d+=1)u*=y[d].evaluate(a);return u}],"-":{type:tr,overloads:[[[tr,tr],function(a,o){var u=o[1];return o[0].evaluate(a)-u.evaluate(a)}],[[tr],function(a,o){return-o[0].evaluate(a)}]]},"/":[tr,[tr,tr],function(a,o){var u=o[1];return o[0].evaluate(a)/u.evaluate(a)}],"%":[tr,[tr,tr],function(a,o){var u=o[1];return o[0].evaluate(a)%u.evaluate(a)}],ln2:[tr,[],function(){return Math.LN2}],pi:[tr,[],function(){return Math.PI}],e:[tr,[],function(){return Math.E}],"^":[tr,[tr,tr],function(a,o){var u=o[1];return Math.pow(o[0].evaluate(a),u.evaluate(a))}],sqrt:[tr,[tr],function(a,o){return Math.sqrt(o[0].evaluate(a))}],log10:[tr,[tr],function(a,o){return Math.log(o[0].evaluate(a))/Math.LN10}],ln:[tr,[tr],function(a,o){return Math.log(o[0].evaluate(a))}],log2:[tr,[tr],function(a,o){return Math.log(o[0].evaluate(a))/Math.LN2}],sin:[tr,[tr],function(a,o){return Math.sin(o[0].evaluate(a))}],cos:[tr,[tr],function(a,o){return Math.cos(o[0].evaluate(a))}],tan:[tr,[tr],function(a,o){return Math.tan(o[0].evaluate(a))}],asin:[tr,[tr],function(a,o){return Math.asin(o[0].evaluate(a))}],acos:[tr,[tr],function(a,o){return Math.acos(o[0].evaluate(a))}],atan:[tr,[tr],function(a,o){return Math.atan(o[0].evaluate(a))}],min:[tr,Pu(tr),function(a,o){return Math.min.apply(Math,o.map(function(u){return u.evaluate(a)}))}],max:[tr,Pu(tr),function(a,o){return Math.max.apply(Math,o.map(function(u){return u.evaluate(a)}))}],abs:[tr,[tr],function(a,o){return Math.abs(o[0].evaluate(a))}],round:[tr,[tr],function(a,o){var u=o[0].evaluate(a);return u<0?-Math.round(-u):Math.round(u)}],floor:[tr,[tr],function(a,o){return Math.floor(o[0].evaluate(a))}],ceil:[tr,[tr],function(a,o){return Math.ceil(o[0].evaluate(a))}],"filter-==":[hn,[Cn,wn],function(a,o){var u=o[0],d=o[1];return a.properties()[u.value]===d.value}],"filter-id-==":[hn,[wn],function(a,o){var u=o[0];return a.id()===u.value}],"filter-type-==":[hn,[Cn],function(a,o){var u=o[0];return a.geometryType()===u.value}],"filter-<":[hn,[Cn,wn],function(a,o){var u=o[0],d=o[1],y=a.properties()[u.value],b=d.value;return typeof y==typeof b&&y<b}],"filter-id-<":[hn,[wn],function(a,o){var u=o[0],d=a.id(),y=u.value;return typeof d==typeof y&&d<y}],"filter->":[hn,[Cn,wn],function(a,o){var u=o[0],d=o[1],y=a.properties()[u.value],b=d.value;return typeof y==typeof b&&y>b}],"filter-id->":[hn,[wn],function(a,o){var u=o[0],d=a.id(),y=u.value;return typeof d==typeof y&&d>y}],"filter-<=":[hn,[Cn,wn],function(a,o){var u=o[0],d=o[1],y=a.properties()[u.value],b=d.value;return typeof y==typeof b&&y<=b}],"filter-id-<=":[hn,[wn],function(a,o){var u=o[0],d=a.id(),y=u.value;return typeof d==typeof y&&d<=y}],"filter->=":[hn,[Cn,wn],function(a,o){var u=o[0],d=o[1],y=a.properties()[u.value],b=d.value;return typeof y==typeof b&&y>=b}],"filter-id->=":[hn,[wn],function(a,o){var u=o[0],d=a.id(),y=u.value;return typeof d==typeof y&&d>=y}],"filter-has":[hn,[wn],function(a,o){return o[0].value in a.properties()}],"filter-has-id":[hn,[],function(a){return a.id()!==null&&a.id()!==void 0}],"filter-type-in":[hn,[Fn(Cn)],function(a,o){return o[0].value.indexOf(a.geometryType())>=0}],"filter-id-in":[hn,[Fn(wn)],function(a,o){return o[0].value.indexOf(a.id())>=0}],"filter-in-small":[hn,[Cn,Fn(wn)],function(a,o){var u=o[0];return o[1].value.indexOf(a.properties()[u.value])>=0}],"filter-in-large":[hn,[Cn,Fn(wn)],function(a,o){var u=o[0],d=o[1];return function(y,b,C,P){for(;C<=P;){var D=C+P>>1;if(b[D]===y)return!0;b[D]>y?P=D-1:C=D+1}return!1}(a.properties()[u.value],d.value,0,d.value.length-1)}],all:{type:hn,overloads:[[[hn,hn],function(a,o){var u=o[1];return o[0].evaluate(a)&&u.evaluate(a)}],[Pu(hn),function(a,o){for(var u=0,d=o;u<d.length;u+=1)if(!d[u].evaluate(a))return!1;return!0}]]},any:{type:hn,overloads:[[[hn,hn],function(a,o){var u=o[1];return o[0].evaluate(a)||u.evaluate(a)}],[Pu(hn),function(a,o){for(var u=0,d=o;u<d.length;u+=1)if(d[u].evaluate(a))return!0;return!1}]]},"!":[hn,[hn],function(a,o){return!o[0].evaluate(a)}],"is-supported-script":[hn,[Cn],function(a,o){var u=a.globals&&a.globals.isSupportedScript;return!u||u(o[0].evaluate(a))}],upcase:[Cn,[Cn],function(a,o){return o[0].evaluate(a).toUpperCase()}],downcase:[Cn,[Cn],function(a,o){return o[0].evaluate(a).toLowerCase()}],concat:[Cn,Pu(wn),function(a,o){return o.map(function(u){return ro(u.evaluate(a))}).join("")}],"resolved-locale":[Cn,[Ni],function(a,o){return o[0].evaluate(a).resolvedLocale()}]});var sl=function(o,u){this.expression=o,this._warningHistory={},this._evaluator=new ms,this._defaultValue=u?function(d){return d.type==="color"&&ac(d.default)?new xi(0,0,0,0):d.type==="color"?xi.parse(d.default)||null:d.default===void 0?null:d.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null};function ul(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Mu}function Gl(a,o){var u=new au(Mu,[],o?function(y){var b={color:xn,string:Cn,number:tr,enum:Cn,boolean:hn,formatted:Ki,resolvedImage:Mi};return y.type==="array"?Fn(b[y.value]||wn,y.length):b[y.type]}(o):void 0),d=u.parse(a,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?Ml(new sl(d,o)):al(u.errors)}sl.prototype.evaluateWithoutErrorHandling=function(a,o,u,d,y,b){return this._evaluator.globals=a,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=d,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)},sl.prototype.evaluate=function(a,o,u,d,y,b){this._evaluator.globals=a,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=d,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b||null;try{var C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new Ta("Expected value to be one of "+Object.keys(this._enumValues).map(function(P){return JSON.stringify(P)}).join(", ")+", but found "+JSON.stringify(C)+" instead.");return C}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console!="undefined"&&console.warn(P.message)),this._defaultValue}};var Zu=function(o,u){this.kind=o,this._styleExpression=u,this.isStateDependent=o!=="constant"&&!Ts(u.expression)};Zu.prototype.evaluateWithoutErrorHandling=function(a,o,u,d,y,b){return this._styleExpression.evaluateWithoutErrorHandling(a,o,u,d,y,b)},Zu.prototype.evaluate=function(a,o,u,d,y,b){return this._styleExpression.evaluate(a,o,u,d,y,b)};var Hl=function(o,u,d,y){this.kind=o,this.zoomStops=d,this._styleExpression=u,this.isStateDependent=o!=="camera"&&!Ts(u.expression),this.interpolationType=y};function bf(a,o){if((a=Gl(a,o)).result==="error")return a;var u=a.value.expression,d=us(u);if(!d&&!Wu(o))return al([new Lr("","data expressions not supported")]);var y=Ms(u,["zoom"]);if(!y&&!Vl(o))return al([new Lr("","zoom expressions not supported")]);var b=function C(P){var D=null;if(P instanceof Fr)D=C(P.result);else if(P instanceof wr)for(var j=0,X=P.args;j<X.length&&!(D=C(X[j]));j+=1);else(P instanceof Ca||P instanceof pt)&&P.input instanceof oe&&P.input.name==="zoom"&&(D=P);return D instanceof Lr||P.eachChild(function(ee){var te=C(ee);te instanceof Lr?D=te:!D&&te?D=new Lr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):D&&te&&D!==te&&(D=new Lr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),D}(u);return b||y?b instanceof Lr?al([b]):b instanceof pt&&!ol(o)?al([new Lr("",'"interpolate" expressions cannot be used with this property')]):Ml(b?new Hl(d?"camera":"composite",a.value,b.labels,b instanceof pt?b.interpolation:void 0):new Zu(d?"constant":"source",a.value)):al([new Lr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Hl.prototype.evaluateWithoutErrorHandling=function(a,o,u,d,y,b){return this._styleExpression.evaluateWithoutErrorHandling(a,o,u,d,y,b)},Hl.prototype.evaluate=function(a,o,u,d,y,b){return this._styleExpression.evaluate(a,o,u,d,y,b)},Hl.prototype.interpolationFactor=function(a,o,u){return this.interpolationType?pt.interpolationFactor(this.interpolationType,a,o,u):0};var Wl=function(o,u){this._parameters=o,this._specification=u,Ar(this,function d(y,b){var C,P,D,j=b.type==="color",X=y.stops&&typeof y.stops[0][0]=="object",ee=X||!(X||y.property!==void 0),te=y.type||(ol(b)?"exponential":"interval");if(j&&((y=Ar({},y)).stops&&(y.stops=y.stops.map(function($n){return[$n[0],xi.parse($n[1])]})),y.default=xi.parse(y.default?y.default:b.default)),y.colorSpace&&y.colorSpace!=="rgb"&&!Je[y.colorSpace])throw new Error("Unknown color space: "+y.colorSpace);if(te==="exponential")C=Bh;else if(te==="interval")C=mp;else if(te==="categorical"){C=Fh,P=Object.create(null);for(var Ee=0,Le=y.stops;Ee<Le.length;Ee+=1){var Oe=Le[Ee];P[Oe[0]]=Oe[1]}D=typeof y.stops[0][0]}else{if(te!=="identity")throw new Error('Unknown function type "'+te+'"');C=sc}if(X){for(var We={},Ze=[],yt=0;yt<y.stops.length;yt++){var Dt=y.stops[yt],Xt=Dt[0].zoom;We[Xt]===void 0&&(We[Xt]={zoom:Xt,type:y.type,property:y.property,default:y.default,stops:[]},Ze.push(Xt)),We[Xt].stops.push([Dt[0].value,Dt[1]])}for(var mr=[],sr=0,Qr=Ze;sr<Qr.length;sr+=1){var nn=Qr[sr];mr.push([We[nn].zoom,d(We[nn],b)])}var Gn={name:"linear"};return{kind:"composite",interpolationType:Gn,interpolationFactor:pt.interpolationFactor.bind(void 0,Gn),zoomStops:mr.map(function($n){return $n[0]}),evaluate:function(Bn,Ti){var ui=Bn.zoom;return Bh({stops:mr,base:y.base},b,ui).evaluate(ui,Ti)}}}if(ee){var ei=te==="exponential"?{name:"exponential",base:y.base!==void 0?y.base:1}:null;return{kind:"camera",interpolationType:ei,interpolationFactor:pt.interpolationFactor.bind(void 0,ei),zoomStops:y.stops.map(function($n){return $n[0]}),evaluate:function(Bn){return C(y,b,Bn.zoom,P,D)}}}return{kind:"source",evaluate:function(Bn,Ti){var ui=Ti&&Ti.properties?Ti.properties[y.property]:void 0;return ui===void 0?oc(y.default,b.default):C(y,b,ui,P,D)}}}(this._parameters,this._specification))};function so(a){var o=a.key,u=a.value,d=a.valueSpec||{},y=a.objectElementValidators||{},b=a.style,C=a.styleSpec,P=[],D=Ra(u);if(D!=="object")return[new je(o,u,"object expected, "+D+" found")];for(var j in u){var X=j.split(".")[0],ee=d[X]||d["*"],te=void 0;if(y[X])te=y[X];else if(d[X])te=ta;else if(y["*"])te=y["*"];else{if(!d["*"]){P.push(new je(o,u[j],'unknown property "'+j+'"'));continue}te=ta}P=P.concat(te({key:(o&&o+".")+j,value:u[j],valueSpec:ee,style:b,styleSpec:C,object:u,objectKey:j},u))}for(var Ee in d)y[Ee]||d[Ee].required&&d[Ee].default===void 0&&u[Ee]===void 0&&P.push(new je(o,u,'missing required property "'+Ee+'"'));return P}function nh(a){var o=a.value,u=a.valueSpec,d=a.style,y=a.styleSpec,b=a.key,C=a.arrayElementValidator||ta;if(Ra(o)!=="array")return[new je(b,o,"array expected, "+Ra(o)+" found")];if(u.length&&o.length!==u.length)return[new je(b,o,"array length "+u.length+" expected, length "+o.length+" found")];if(u["min-length"]&&o.length<u["min-length"])return[new je(b,o,"array length at least "+u["min-length"]+" expected, length "+o.length+" found")];var P={type:u.value,values:u.values};y.$version<7&&(P.function=u.function),Ra(u.value)==="object"&&(P=u.value);for(var D=[],j=0;j<o.length;j++)D=D.concat(C({array:o,arrayIndex:j,value:o[j],valueSpec:P,style:d,styleSpec:y,key:b+"["+j+"]"}));return D}function ih(a){var o=a.key,u=a.value,d=a.valueSpec,y=Ra(u);return y==="number"&&u!=u&&(y="NaN"),y!=="number"?[new je(o,u,"number expected, "+y+" found")]:"minimum"in d&&u<d.minimum?[new je(o,u,u+" is less than the minimum value "+d.minimum)]:"maximum"in d&&u>d.maximum?[new je(o,u,u+" is greater than the maximum value "+d.maximum)]:[]}function ah(a){var o,u,d,y=a.valueSpec,b=kr(a.value.type),C={},P=b!=="categorical"&&a.value.property===void 0,D=!P,j=Ra(a.value.stops)==="array"&&Ra(a.value.stops[0])==="array"&&Ra(a.value.stops[0][0])==="object",X=so({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(Le){if(b==="identity")return[new je(Le.key,Le.value,'identity function may not have a "stops" property')];var Oe=[],We=Le.value;return Oe=Oe.concat(nh({key:Le.key,value:We,valueSpec:Le.valueSpec,style:Le.style,styleSpec:Le.styleSpec,arrayElementValidator:ee})),Ra(We)==="array"&&We.length===0&&Oe.push(new je(Le.key,We,"array must have at least one stop")),Oe},default:function(Le){return ta({key:Le.key,value:Le.value,valueSpec:y,style:Le.style,styleSpec:Le.styleSpec})}}});return b==="identity"&&P&&X.push(new je(a.key,a.value,'missing required property "property"')),b==="identity"||a.value.stops||X.push(new je(a.key,a.value,'missing required property "stops"')),b==="exponential"&&a.valueSpec.expression&&!ol(a.valueSpec)&&X.push(new je(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(D&&!Wu(a.valueSpec)?X.push(new je(a.key,a.value,"property functions not supported")):P&&!Vl(a.valueSpec)&&X.push(new je(a.key,a.value,"zoom functions not supported"))),b!=="categorical"&&!j||a.value.property!==void 0||X.push(new je(a.key,a.value,'"property" property is required')),X;function ee(Ee){var Le=[],Oe=Ee.value,We=Ee.key;if(Ra(Oe)!=="array")return[new je(We,Oe,"array expected, "+Ra(Oe)+" found")];if(Oe.length!==2)return[new je(We,Oe,"array length 2 expected, length "+Oe.length+" found")];if(j){if(Ra(Oe[0])!=="object")return[new je(We,Oe,"object expected, "+Ra(Oe[0])+" found")];if(Oe[0].zoom===void 0)return[new je(We,Oe,"object stop key must have zoom")];if(Oe[0].value===void 0)return[new je(We,Oe,"object stop key must have value")];if(d&&d>kr(Oe[0].zoom))return[new je(We,Oe[0].zoom,"stop zoom values must appear in ascending order")];kr(Oe[0].zoom)!==d&&(d=kr(Oe[0].zoom),u=void 0,C={}),Le=Le.concat(so({key:We+"[0]",value:Oe[0],valueSpec:{zoom:{}},style:Ee.style,styleSpec:Ee.styleSpec,objectElementValidators:{zoom:ih,value:te}}))}else Le=Le.concat(te({key:We+"[0]",value:Oe[0],valueSpec:{},style:Ee.style,styleSpec:Ee.styleSpec},Oe));return ul(rr(Oe[1]))?Le.concat([new je(We+"[1]",Oe[1],"expressions are not allowed in function stops.")]):Le.concat(ta({key:We+"[1]",value:Oe[1],valueSpec:y,style:Ee.style,styleSpec:Ee.styleSpec}))}function te(Ee,Le){var Oe=Ra(Ee.value),We=kr(Ee.value),Ze=Ee.value!==null?Ee.value:Le;if(o){if(Oe!==o)return[new je(Ee.key,Ze,Oe+" stop domain type must match previous stop domain type "+o)]}else o=Oe;if(Oe!=="number"&&Oe!=="string"&&Oe!=="boolean")return[new je(Ee.key,Ze,"stop domain value must be a number, string, or boolean")];if(Oe!=="number"&&b!=="categorical"){var yt="number expected, "+Oe+" found";return Wu(y)&&b===void 0&&(yt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new je(Ee.key,Ze,yt)]}return b!=="categorical"||Oe!=="number"||isFinite(We)&&Math.floor(We)===We?b!=="categorical"&&Oe==="number"&&u!==void 0&&We<u?[new je(Ee.key,Ze,"stop domain values must appear in ascending order")]:(u=We,b==="categorical"&&We in C?[new je(Ee.key,Ze,"stop domain values must be unique")]:(C[We]=!0,[])):[new je(Ee.key,Ze,"integer expected, found "+We)]}}function Xu(a){var o=(a.expressionContext==="property"?bf:Gl)(rr(a.value),a.valueSpec);if(o.result==="error")return o.value.map(function(d){return new je(""+a.key+d.key,a.value,d.message)});var u=o.value.expression||o.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!u.outputDefined())return[new je(a.key,a.value,'Invalid data expression for "'+a.propertyKey+'". Output values must be contained as literals within the expression.')];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Ts(u))return[new je(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!Ts(u))return[new je(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Ms(u,["zoom","feature-state"]))return[new je(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!us(u))return[new je(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Pl(a){var o=a.key,u=a.value,d=a.valueSpec,y=[];return Array.isArray(d.values)?d.values.indexOf(kr(u))===-1&&y.push(new je(o,u,"expected one of ["+d.values.join(", ")+"], "+JSON.stringify(u)+" found")):Object.keys(d.values).indexOf(kr(u))===-1&&y.push(new je(o,u,"expected one of ["+Object.keys(d.values).join(", ")+"], "+JSON.stringify(u)+" found")),y}function Bc(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(var o=0,u=a.slice(1);o<u.length;o+=1){var d=u[o];if(!Bc(d)&&typeof d!="boolean")return!1}return!0;default:return!0}}Wl.deserialize=function(a){return new Wl(a._parameters,a._specification)},Wl.serialize=function(a){return{_parameters:a._parameters,_specification:a._specification}};var oh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ef(a){if(a==null)return{filter:function(){return!0},needGeometry:!1};Bc(a)||(a=zc(a));var o=Gl(a,oh);if(o.result==="error")throw new Error(o.value.map(function(u){return u.key+": "+u.message}).join(", "));return{filter:function(d,y,b){return o.value.evaluate(d,y,{},b)},needGeometry:function u(d){if(!Array.isArray(d))return!1;if(d[0]==="within")return!0;for(var y=1;y<d.length;y++)if(u(d[y]))return!0;return!1}(a)}}function Nc(a,o){return a<o?-1:a>o?1:0}function zc(a){if(!a)return!0;var o,u=a[0];return a.length<=1?u!=="any":u==="=="?Uc(a[1],a[2],"=="):u==="!="?jc(Uc(a[1],a[2],"==")):u==="<"||u===">"||u==="<="||u===">="?Uc(a[1],a[2],u):u==="any"?(o=a.slice(1),["any"].concat(o.map(zc))):u==="all"?["all"].concat(a.slice(1).map(zc)):u==="none"?["all"].concat(a.slice(1).map(zc).map(jc)):u==="in"?uc(a[1],a.slice(2)):u==="!in"?jc(uc(a[1],a.slice(2))):u==="has"?Nh(a[1]):u==="!has"?jc(Nh(a[1])):u!=="within"||a}function Uc(a,o,u){switch(a){case"$type":return["filter-type-"+u,o];case"$id":return["filter-id-"+u,o];default:return["filter-"+u,a,o]}}function uc(a,o){if(o.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(function(u){return typeof u!=typeof o[0]})?["filter-in-large",a,["literal",o.sort(Nc)]]:["filter-in-small",a,["literal",o]]}}function Nh(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function jc(a){return["!",a]}function sh(a){return Bc(rr(a.value))?Xu(Ar({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function o(u){var d=u.value,y=u.key;if(Ra(d)!=="array")return[new je(y,d,"array expected, "+Ra(d)+" found")];var b,C=u.styleSpec,P=[];if(d.length<1)return[new je(y,d,"filter array must have at least 1 element")];switch(P=P.concat(Pl({key:y+"[0]",value:d[0],valueSpec:C.filter_operator,style:u.style,styleSpec:u.styleSpec})),kr(d[0])){case"<":case"<=":case">":case">=":d.length>=2&&kr(d[1])==="$type"&&P.push(new je(y,d,'"$type" cannot be use with operator "'+d[0]+'"'));case"==":case"!=":d.length!==3&&P.push(new je(y,d,'filter array for operator "'+d[0]+'" must have 3 elements'));case"in":case"!in":d.length>=2&&(b=Ra(d[1]))!=="string"&&P.push(new je(y+"[1]",d[1],"string expected, "+b+" found"));for(var D=2;D<d.length;D++)b=Ra(d[D]),kr(d[1])==="$type"?P=P.concat(Pl({key:y+"["+D+"]",value:d[D],valueSpec:C.geometry_type,style:u.style,styleSpec:u.styleSpec})):b!=="string"&&b!=="number"&&b!=="boolean"&&P.push(new je(y+"["+D+"]",d[D],"string, number, or boolean expected, "+b+" found"));break;case"any":case"all":case"none":for(var j=1;j<d.length;j++)P=P.concat(o({key:y+"["+j+"]",value:d[j],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":b=Ra(d[1]),d.length!==2?P.push(new je(y,d,'filter array for "'+d[0]+'" operator must have 2 elements')):b!=="string"&&P.push(new je(y+"[1]",d[1],"string expected, "+b+" found"));break;case"within":b=Ra(d[1]),d.length!==2?P.push(new je(y,d,'filter array for "'+d[0]+'" operator must have 2 elements')):b!=="object"&&P.push(new je(y+"[1]",d[1],"object expected, "+b+" found"))}return P}(a)}function Vc(a,o){var u=a.key,d=a.style,y=a.styleSpec,b=a.value,C=a.objectKey,P=y[o+"_"+a.layerType];if(!P)return[];var D=C.match(/^(.*)-transition$/);if(o==="paint"&&D&&P[D[1]]&&P[D[1]].transition)return ta({key:u,value:b,valueSpec:y.transition,style:d,styleSpec:y});var j,X=a.valueSpec||P[C];if(!X)return[new je(u,b,'unknown property "'+C+'"')];if(Ra(b)==="string"&&Wu(X)&&!X.tokens&&(j=/^{([^}]+)}$/.exec(b)))return[new je(u,b,'"'+C+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(j[1])+" }`.")];var ee=[];return a.layerType==="symbol"&&(C==="text-field"&&d&&!d.glyphs&&ee.push(new je(u,b,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&ac(rr(b))&&kr(b.type)==="identity"&&ee.push(new je(u,b,'"text-font" does not support identity functions'))),ee.concat(ta({key:a.key,value:b,valueSpec:X,style:d,styleSpec:y,expressionContext:"property",propertyType:o,propertyKey:C}))}function uh(a){return Vc(a,"paint")}function Gc(a){return Vc(a,"layout")}function lc(a){var o=[],u=a.value,d=a.key,y=a.style,b=a.styleSpec;u.type||u.ref||o.push(new je(d,u,'either "type" or "ref" is required'));var C,P=kr(u.type),D=kr(u.ref);if(u.id)for(var j=kr(u.id),X=0;X<a.arrayIndex;X++){var ee=y.layers[X];kr(ee.id)===j&&o.push(new je(d,u.id,'duplicate layer id "'+u.id+'", previously used at line '+ee.id.__line__))}if("ref"in u)["type","source","source-layer","filter","layout"].forEach(function(Le){Le in u&&o.push(new je(d,u[Le],'"'+Le+'" is prohibited for ref layers'))}),y.layers.forEach(function(Le){kr(Le.id)===D&&(C=Le)}),C?C.ref?o.push(new je(d,u.ref,"ref cannot reference another ref layer")):P=kr(C.type):o.push(new je(d,u.ref,'ref layer "'+D+'" not found'));else if(P!=="background")if(u.source){var te=y.sources&&y.sources[u.source],Ee=te&&kr(te.type);te?Ee==="vector"&&P==="raster"?o.push(new je(d,u.source,'layer "'+u.id+'" requires a raster source')):Ee==="raster"&&P!=="raster"?o.push(new je(d,u.source,'layer "'+u.id+'" requires a vector source')):Ee!=="vector"||u["source-layer"]?Ee==="raster-dem"&&P!=="hillshade"?o.push(new je(d,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):P!=="line"||!u.paint||!u.paint["line-gradient"]||Ee==="geojson"&&te.lineMetrics||o.push(new je(d,u,'layer "'+u.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):o.push(new je(d,u,'layer "'+u.id+'" must specify a "source-layer"')):o.push(new je(d,u.source,'source "'+u.source+'" not found'))}else o.push(new je(d,u,'missing required property "source"'));return o=o.concat(so({key:d,value:u,valueSpec:b.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return ta({key:d+".type",value:u.type,valueSpec:b.layer.type,style:a.style,styleSpec:a.styleSpec,object:u,objectKey:"type"})},filter:sh,layout:function(Oe){return so({layer:u,key:Oe.key,value:Oe.value,style:Oe.style,styleSpec:Oe.styleSpec,objectElementValidators:{"*":function(Ze){return Gc(Ar({layerType:P},Ze))}}})},paint:function(Oe){return so({layer:u,key:Oe.key,value:Oe.value,style:Oe.style,styleSpec:Oe.styleSpec,objectElementValidators:{"*":function(Ze){return uh(Ar({layerType:P},Ze))}}})}}}))}function ll(a){var o=a.value,u=a.key,d=Ra(o);return d!=="string"?[new je(u,o,"string expected, "+d+" found")]:[]}var Wa={promoteId:function(o){var u=o.key,d=o.value;if(Ra(d)==="string")return ll({key:u,value:d});var y=[];for(var b in d)y.push.apply(y,ll({key:u+"."+b,value:d[b]}));return y}};function cc(a){var o=a.value,u=a.key,d=a.styleSpec,y=a.style;if(!o.type)return[new je(u,o,'"type" is required')];var b,C=kr(o.type);switch(C){case"vector":case"raster":case"raster-dem":return so({key:u,value:o,valueSpec:d["source_"+C.replace("-","_")],style:a.style,styleSpec:d,objectElementValidators:Wa});case"geojson":if(b=so({key:u,value:o,valueSpec:d.source_geojson,style:y,styleSpec:d,objectElementValidators:Wa}),o.cluster)for(var P in o.clusterProperties){var D=o.clusterProperties[P],j=D[0],X=typeof j=="string"?[j,["accumulated"],["get",P]]:j;b.push.apply(b,Xu({key:u+"."+P+".map",value:D[1],expressionContext:"cluster-map"})),b.push.apply(b,Xu({key:u+"."+P+".reduce",value:X,expressionContext:"cluster-reduce"}))}return b;case"video":return so({key:u,value:o,valueSpec:d.source_video,style:y,styleSpec:d});case"image":return so({key:u,value:o,valueSpec:d.source_image,style:y,styleSpec:d});case"canvas":return[new je(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Pl({key:u+".type",value:o.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:y,styleSpec:d})}}function Yu(a){var o=a.value,u=a.styleSpec,d=u.light,y=a.style,b=[],C=Ra(o);if(o===void 0)return b;if(C!=="object")return b.concat([new je("light",o,"object expected, "+C+" found")]);for(var P in o){var D=P.match(/^(.*)-transition$/);b=b.concat(D&&d[D[1]]&&d[D[1]].transition?ta({key:P,value:o[P],valueSpec:u.transition,style:y,styleSpec:u}):d[P]?ta({key:P,value:o[P],valueSpec:d[P],style:y,styleSpec:u}):[new je(P,o[P],'unknown property "'+P+'"')])}return b}var Ol={"*":function(){return[]},array:nh,boolean:function(o){var u=o.value,d=o.key,y=Ra(u);return y!=="boolean"?[new je(d,u,"boolean expected, "+y+" found")]:[]},number:ih,color:function(o){var u=o.key,d=o.value,y=Ra(d);return y!=="string"?[new je(u,d,"color expected, "+y+" found")]:Ai(d)===null?[new je(u,d,'color expected, "'+d+'" found')]:[]},constants:$e,enum:Pl,filter:sh,function:ah,layer:lc,object:so,source:cc,light:Yu,string:ll,formatted:function(o){return ll(o).length===0?[]:Xu(o)},resolvedImage:function(o){return ll(o).length===0?[]:Xu(o)}};function ta(a){var o=a.value,u=a.valueSpec,d=a.styleSpec;return u.expression&&ac(kr(o))?ah(a):u.expression&&ul(rr(o))?Xu(a):u.type&&Ol[u.type]?Ol[u.type](a):so(Ar({},a,{valueSpec:u.type?d[u.type]:u}))}function Ga(a){var o=a.value,u=a.key,d=ll(a);return d.length||(o.indexOf("{fontstack}")===-1&&d.push(new je(u,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&d.push(new je(u,o,'"glyphs" url must include a "{range}" token'))),d}function Os(a,o){o===void 0&&(o=_e);var u=[];return u=u.concat(ta({key:"",value:a,valueSpec:o.$root,styleSpec:o,style:a,objectElementValidators:{glyphs:Ga,"*":function(){return[]}}})),a.constants&&(u=u.concat($e({key:"constants",value:a.constants,style:a,styleSpec:o}))),Hc(u)}function Hc(a){return[].concat(a).sort(function(o,u){return o.line-u.line})}function Wc(a){return function(){for(var o=[],u=arguments.length;u--;)o[u]=arguments[u];return Hc(a.apply(this,o))}}Os.source=Wc(cc),Os.light=Wc(Yu),Os.layer=Wc(lc),Os.filter=Wc(sh),Os.paintProperty=Wc(uh),Os.layoutProperty=Wc(Gc);var Zl=Os,fd=Zl.light,hd=Zl.paintProperty,Sf=Zl.layoutProperty;function Zc(a,o){var u=!1;if(o&&o.length)for(var d=0,y=o;d<y.length;d+=1)a.fire(new et(new Error(y[d].message))),u=!0;return u}var Ku=Pi;function Pi(a,o,u){var d=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var y=new Int32Array(this.arrayBuffer);a=y[0],this.d=(o=y[1])+2*(u=y[2]);for(var b=0;b<this.d*this.d;b++){var C=y[3+b],P=y[3+b+1];d.push(C===P?null:y.subarray(C,P))}var D=y[3+d.length+1];this.keys=y.subarray(y[3+d.length],D),this.bboxes=y.subarray(D),this.insert=this._insertReadonly}else{this.d=o+2*u;for(var j=0;j<this.d*this.d;j++)d.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=a,this.padding=u,this.scale=o/a,this.uid=0;var X=u/o*a;this.min=-X,this.max=a+X}Pi.prototype.insert=function(a,o,u,d,y){this._forEachCell(o,u,d,y,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(d),this.bboxes.push(y)},Pi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Pi.prototype._insertCell=function(a,o,u,d,y,b){this.cells[y].push(b)},Pi.prototype.query=function(a,o,u,d,y){var b=this.min,C=this.max;if(a<=b&&o<=b&&C<=u&&C<=d&&!y)return Array.prototype.slice.call(this.keys);var P=[];return this._forEachCell(a,o,u,d,this._queryCell,P,{},y),P},Pi.prototype._queryCell=function(a,o,u,d,y,b,C,P){var D=this.cells[y];if(D!==null)for(var j=this.keys,X=this.bboxes,ee=0;ee<D.length;ee++){var te=D[ee];if(C[te]===void 0){var Ee=4*te;(P?P(X[Ee+0],X[Ee+1],X[Ee+2],X[Ee+3]):a<=X[Ee+2]&&o<=X[Ee+3]&&u>=X[Ee+0]&&d>=X[Ee+1])?(C[te]=!0,b.push(j[te])):C[te]=!1}}},Pi.prototype._forEachCell=function(a,o,u,d,y,b,C,P){for(var D=this._convertToCellCoord(a),j=this._convertToCellCoord(o),X=this._convertToCellCoord(u),ee=this._convertToCellCoord(d),te=D;te<=X;te++)for(var Ee=j;Ee<=ee;Ee++){var Le=this.d*Ee+te;if((!P||P(this._convertFromCellCoord(te),this._convertFromCellCoord(Ee),this._convertFromCellCoord(te+1),this._convertFromCellCoord(Ee+1)))&&y.call(this,a,o,u,d,Le,b,C,P))return}},Pi.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},Pi.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},Pi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,o=3+this.cells.length+1+1,u=0,d=0;d<this.cells.length;d++)u+=this.cells[d].length;var y=new Int32Array(o+u+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var b=o,C=0;C<a.length;C++){var P=a[C];y[3+C]=b,y.set(P,b),b+=P.length}return y[3+a.length]=b,y.set(this.keys,b),y[3+a.length+1]=b+=this.keys.length,y.set(this.bboxes,b),b+=this.bboxes.length,y.buffer};var Xc=be.ImageData,Kn=be.ImageBitmap,_a={};function Ln(a,o,u){u===void 0&&(u={}),Object.defineProperty(o,"_classRegistryKey",{value:a,writeable:!1}),_a[a]={klass:o,omit:u.omit||[],shallow:u.shallow||[]}}for(var Zs in Ln("Object",Object),Ku.serialize=function(a,o){var u=a.toArrayBuffer();return o&&o.push(u),{buffer:u}},Ku.deserialize=function(a){return new Ku(a.buffer)},Ln("Grid",Ku),Ln("Color",xi),Ln("Error",Error),Ln("ResolvedImage",Ct),Ln("StylePropertyFunction",Wl),Ln("StyleExpression",sl,{omit:["_evaluator"]}),Ln("ZoomDependentExpression",Hl),Ln("ZoomConstantExpression",Zu),Ln("CompoundExpression",oe,{omit:["_evaluate"]}),Mu)Mu[Zs]._classRegistryKey||Ln("Expression_"+Zs,Mu[Zs]);function Xl(a){return a&&typeof ArrayBuffer!="undefined"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Il(a){return Kn&&a instanceof Kn}function pu(a,o){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(Xl(a)||Il(a))return o&&o.push(a),a;if(ArrayBuffer.isView(a)){var u=a;return o&&o.push(u.buffer),u}if(a instanceof Xc)return o&&o.push(a.data.buffer),a;if(Array.isArray(a)){for(var d=[],y=0,b=a;y<b.length;y+=1)d.push(pu(b[y],o));return d}if(typeof a=="object"){var C=a.constructor,P=C._classRegistryKey;if(!P)throw new Error("can't serialize object of unregistered class");var D=C.serialize?C.serialize(a,o):{};if(!C.serialize){for(var j in a)if(a.hasOwnProperty(j)&&!(_a[P].omit.indexOf(j)>=0)){var X=a[j];D[j]=_a[P].shallow.indexOf(j)>=0?X:pu(X,o)}a instanceof Error&&(D.message=a.message)}if(D.$name)throw new Error("$name property is reserved for worker serialization logic.");return P!=="Object"&&(D.$name=P),D}throw new Error("can't serialize object of type "+typeof a)}function Xs(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||Xl(a)||Il(a)||ArrayBuffer.isView(a)||a instanceof Xc)return a;if(Array.isArray(a))return a.map(Xs);if(typeof a=="object"){var o=a.$name||"Object",u=_a[o].klass;if(!u)throw new Error("can't deserialize unregistered class "+o);if(u.deserialize)return u.deserialize(a);for(var d=Object.create(u.prototype),y=0,b=Object.keys(a);y<b.length;y+=1){var C=b[y];if(C!=="$name"){var P=a[C];d[C]=_a[o].shallow.indexOf(C)>=0?P:Xs(P)}}return d}throw new Error("can't deserialize object of type "+typeof a)}var Cf=function(){this.first=!0};Cf.prototype.update=function(a,o){var u=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=o),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=u,!0))};var mn={"Latin-1 Supplement":function(o){return o>=128&&o<=255},Arabic:function(o){return o>=1536&&o<=1791},"Arabic Supplement":function(o){return o>=1872&&o<=1919},"Arabic Extended-A":function(o){return o>=2208&&o<=2303},"Hangul Jamo":function(o){return o>=4352&&o<=4607},"Unified Canadian Aboriginal Syllabics":function(o){return o>=5120&&o<=5759},Khmer:function(o){return o>=6016&&o<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(o){return o>=6320&&o<=6399},"General Punctuation":function(o){return o>=8192&&o<=8303},"Letterlike Symbols":function(o){return o>=8448&&o<=8527},"Number Forms":function(o){return o>=8528&&o<=8591},"Miscellaneous Technical":function(o){return o>=8960&&o<=9215},"Control Pictures":function(o){return o>=9216&&o<=9279},"Optical Character Recognition":function(o){return o>=9280&&o<=9311},"Enclosed Alphanumerics":function(o){return o>=9312&&o<=9471},"Geometric Shapes":function(o){return o>=9632&&o<=9727},"Miscellaneous Symbols":function(o){return o>=9728&&o<=9983},"Miscellaneous Symbols and Arrows":function(o){return o>=11008&&o<=11263},"CJK Radicals Supplement":function(o){return o>=11904&&o<=12031},"Kangxi Radicals":function(o){return o>=12032&&o<=12255},"Ideographic Description Characters":function(o){return o>=12272&&o<=12287},"CJK Symbols and Punctuation":function(o){return o>=12288&&o<=12351},Hiragana:function(o){return o>=12352&&o<=12447},Katakana:function(o){return o>=12448&&o<=12543},Bopomofo:function(o){return o>=12544&&o<=12591},"Hangul Compatibility Jamo":function(o){return o>=12592&&o<=12687},Kanbun:function(o){return o>=12688&&o<=12703},"Bopomofo Extended":function(o){return o>=12704&&o<=12735},"CJK Strokes":function(o){return o>=12736&&o<=12783},"Katakana Phonetic Extensions":function(o){return o>=12784&&o<=12799},"Enclosed CJK Letters and Months":function(o){return o>=12800&&o<=13055},"CJK Compatibility":function(o){return o>=13056&&o<=13311},"CJK Unified Ideographs Extension A":function(o){return o>=13312&&o<=19903},"Yijing Hexagram Symbols":function(o){return o>=19904&&o<=19967},"CJK Unified Ideographs":function(o){return o>=19968&&o<=40959},"Yi Syllables":function(o){return o>=40960&&o<=42127},"Yi Radicals":function(o){return o>=42128&&o<=42191},"Hangul Jamo Extended-A":function(o){return o>=43360&&o<=43391},"Hangul Syllables":function(o){return o>=44032&&o<=55215},"Hangul Jamo Extended-B":function(o){return o>=55216&&o<=55295},"Private Use Area":function(o){return o>=57344&&o<=63743},"CJK Compatibility Ideographs":function(o){return o>=63744&&o<=64255},"Arabic Presentation Forms-A":function(o){return o>=64336&&o<=65023},"Vertical Forms":function(o){return o>=65040&&o<=65055},"CJK Compatibility Forms":function(o){return o>=65072&&o<=65103},"Small Form Variants":function(o){return o>=65104&&o<=65135},"Arabic Presentation Forms-B":function(o){return o>=65136&&o<=65279},"Halfwidth and Fullwidth Forms":function(o){return o>=65280&&o<=65519}};function Rl(a){for(var o=0,u=a;o<u.length;o+=1)if(bo(u[o].charCodeAt(0)))return!0;return!1}function bo(a){return!(a!==746&&a!==747&&(a<4352||!(mn["Bopomofo Extended"](a)||mn.Bopomofo(a)||mn["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||mn["CJK Compatibility Ideographs"](a)||mn["CJK Compatibility"](a)||mn["CJK Radicals Supplement"](a)||mn["CJK Strokes"](a)||!(!mn["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||mn["CJK Unified Ideographs Extension A"](a)||mn["CJK Unified Ideographs"](a)||mn["Enclosed CJK Letters and Months"](a)||mn["Hangul Compatibility Jamo"](a)||mn["Hangul Jamo Extended-A"](a)||mn["Hangul Jamo Extended-B"](a)||mn["Hangul Jamo"](a)||mn["Hangul Syllables"](a)||mn.Hiragana(a)||mn["Ideographic Description Characters"](a)||mn.Kanbun(a)||mn["Kangxi Radicals"](a)||mn["Katakana Phonetic Extensions"](a)||mn.Katakana(a)&&a!==12540||!(!mn["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!mn["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||mn["Unified Canadian Aboriginal Syllabics"](a)||mn["Unified Canadian Aboriginal Syllabics Extended"](a)||mn["Vertical Forms"](a)||mn["Yijing Hexagram Symbols"](a)||mn["Yi Syllables"](a)||mn["Yi Radicals"](a))))}function fc(a){return!(bo(a)||function(o){return!!(mn["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||mn["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||mn["Letterlike Symbols"](o)||mn["Number Forms"](o)||mn["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||mn["Control Pictures"](o)&&o!==9251||mn["Optical Character Recognition"](o)||mn["Enclosed Alphanumerics"](o)||mn["Geometric Shapes"](o)||mn["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||mn["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||mn["CJK Symbols and Punctuation"](o)||mn.Katakana(o)||mn["Private Use Area"](o)||mn["CJK Compatibility Forms"](o)||mn["Small Form Variants"](o)||mn["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(a))}function Is(a){return a>=1424&&a<=2303||mn["Arabic Presentation Forms-A"](a)||mn["Arabic Presentation Forms-B"](a)}function Uo(a,o){return!(!o&&Is(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||mn.Khmer(a))}function Yc(a){for(var o=0,u=a;o<u.length;o+=1)if(Is(u[o].charCodeAt(0)))return!0;return!1}var Kc=null,qs="unavailable",cl=null,lh=function(o){o&&typeof o=="string"&&o.indexOf("NetworkError")>-1&&(qs="error"),Kc&&Kc(o)};function $c(){qc.fire(new De("pluginStateChange",{pluginStatus:qs,pluginURL:cl}))}var qc=new vt,Af=function(){return qs},su=function(){if(qs!=="deferred"||!cl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qs="loading",$c(),cl&&il({url:cl},function(o){o?lh(o):(qs="loaded",$c())})},Qs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return qs==="loaded"||Qs.applyArabicShaping!=null},isLoading:function(){return qs==="loading"},setState:function(o){qs=o.pluginStatus,cl=o.pluginURL},isParsed:function(){return Qs.applyArabicShaping!=null&&Qs.processBidirectionalText!=null&&Qs.processStyledBidirectionalText!=null},getPluginURL:function(){return cl}},Wi=function(o,u){this.zoom=o,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.zoomHistory=u.zoomHistory,this.transition=u.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Cf,this.transition={})};Wi.prototype.isSupportedScript=function(a){return function(o,u){for(var d=0,y=o;d<y.length;d+=1)if(!Uo(y[d].charCodeAt(0),u))return!1;return!0}(a,Qs.isLoaded())},Wi.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Wi.prototype.getCrossfadeParameters=function(){var a=this.zoom,o=a-Math.floor(a),u=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*o}};var du=function(o,u){this.property=o,this.value=u,this.expression=function(d,y){if(ac(d))return new Wl(d,y);if(ul(d)){var b=bf(d,y);if(b.result==="error")throw new Error(b.value.map(function(P){return P.key+": "+P.message}).join(", "));return b.value}var C=d;return typeof d=="string"&&y.type==="color"&&(C=xi.parse(d)),{kind:"constant",evaluate:function(){return C}}}(u===void 0?o.specification.default:u,o.specification)};du.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},du.prototype.possiblyEvaluate=function(a,o,u){return this.property.possiblyEvaluate(this,a,o,u)};var vu=function(o){this.property=o,this.value=new du(o,void 0)};vu.prototype.transitioned=function(a,o){return new fl(this.property,this.value,o,Be({},a.transition,this.transition),a.now)},vu.prototype.untransitioned=function(){return new fl(this.property,this.value,null,{},0)};var ls=function(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)};ls.prototype.getValue=function(a){return ke(this._values[a].value.value)},ls.prototype.setValue=function(a,o){this._values.hasOwnProperty(a)||(this._values[a]=new vu(this._values[a].property)),this._values[a].value=new du(this._values[a].property,o===null?void 0:ke(o))},ls.prototype.getTransition=function(a){return ke(this._values[a].transition)},ls.prototype.setTransition=function(a,o){this._values.hasOwnProperty(a)||(this._values[a]=new vu(this._values[a].property)),this._values[a].transition=ke(o)||void 0},ls.prototype.serialize=function(){for(var a={},o=0,u=Object.keys(this._values);o<u.length;o+=1){var d=u[o],y=this.getValue(d);y!==void 0&&(a[d]=y);var b=this.getTransition(d);b!==void 0&&(a[d+"-transition"]=b)}return a},ls.prototype.transitioned=function(a,o){for(var u=new kl(this._properties),d=0,y=Object.keys(this._values);d<y.length;d+=1){var b=y[d];u._values[b]=this._values[b].transitioned(a,o._values[b])}return u},ls.prototype.untransitioned=function(){for(var a=new kl(this._properties),o=0,u=Object.keys(this._values);o<u.length;o+=1){var d=u[o];a._values[d]=this._values[d].untransitioned()}return a};var fl=function(o,u,d,y,b){this.property=o,this.value=u,this.begin=b+y.delay||0,this.end=this.begin+y.duration||0,o.specification.transition&&(y.delay||y.duration)&&(this.prior=d)};fl.prototype.possiblyEvaluate=function(a,o,u){var d=a.now||0,y=this.value.possiblyEvaluate(a,o,u),b=this.prior;if(b){if(d>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(d<this.begin)return b.possiblyEvaluate(a,o,u);var C=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(a,o,u),y,function(P){if(P<=0)return 0;if(P>=1)return 1;var D=P*P,j=D*P;return 4*(P<.5?j:3*(P-D)+j-.75)}(C))}return y};var kl=function(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)};kl.prototype.possiblyEvaluate=function(a,o,u){for(var d=new hc(this._properties),y=0,b=Object.keys(this._values);y<b.length;y+=1){var C=b[y];d._values[C]=this._values[C].possiblyEvaluate(a,o,u)}return d},kl.prototype.hasTransition=function(){for(var a=0,o=Object.keys(this._values);a<o.length;a+=1)if(this._values[o[a]].prior)return!0;return!1};var Ko=function(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)};Ko.prototype.getValue=function(a){return ke(this._values[a].value)},Ko.prototype.setValue=function(a,o){this._values[a]=new du(this._values[a].property,o===null?void 0:ke(o))},Ko.prototype.serialize=function(){for(var a={},o=0,u=Object.keys(this._values);o<u.length;o+=1){var d=u[o],y=this.getValue(d);y!==void 0&&(a[d]=y)}return a},Ko.prototype.possiblyEvaluate=function(a,o,u){for(var d=new hc(this._properties),y=0,b=Object.keys(this._values);y<b.length;y+=1){var C=b[y];d._values[C]=this._values[C].possiblyEvaluate(a,o,u)}return d};var Eo=function(o,u,d){this.property=o,this.value=u,this.parameters=d};Eo.prototype.isConstant=function(){return this.value.kind==="constant"},Eo.prototype.constantOr=function(a){return this.value.kind==="constant"?this.value.value:a},Eo.prototype.evaluate=function(a,o,u,d){return this.property.evaluate(this.value,this.parameters,a,o,u,d)};var hc=function(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)};hc.prototype.get=function(a){return this._values[a]};var ni=function(o){this.specification=o};ni.prototype.possiblyEvaluate=function(a,o){return a.expression.evaluate(o)},ni.prototype.interpolate=function(a,o,u){var d=lu[this.specification.type];return d?d(a,o,u):a};var Yn=function(o,u){this.specification=o,this.overrides=u};Yn.prototype.possiblyEvaluate=function(a,o,u,d){return new Eo(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(o,null,{},u,d)}:a.expression,o)},Yn.prototype.interpolate=function(a,o,u){if(a.value.kind!=="constant"||o.value.kind!=="constant")return a;if(a.value.value===void 0||o.value.value===void 0)return new Eo(this,{kind:"constant",value:void 0},a.parameters);var d=lu[this.specification.type];return d?new Eo(this,{kind:"constant",value:d(a.value.value,o.value.value,u)},a.parameters):a},Yn.prototype.evaluate=function(a,o,u,d,y,b){return a.kind==="constant"?a.value:a.evaluate(o,u,d,y,b)};var pc=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.possiblyEvaluate=function(u,d,y,b){if(u.value===void 0)return new Eo(this,{kind:"constant",value:void 0},d);if(u.expression.kind==="constant"){var C=u.expression.evaluate(d,null,{},y,b),P=u.property.specification.type==="resolvedImage"&&typeof C!="string"?C.name:C,D=this._calculate(P,P,P,d);return new Eo(this,{kind:"constant",value:D},d)}if(u.expression.kind==="camera"){var j=this._calculate(u.expression.evaluate({zoom:d.zoom-1}),u.expression.evaluate({zoom:d.zoom}),u.expression.evaluate({zoom:d.zoom+1}),d);return new Eo(this,{kind:"constant",value:j},d)}return new Eo(this,u.expression,d)},o.prototype.evaluate=function(u,d,y,b,C,P){if(u.kind==="source"){var D=u.evaluate(d,y,b,C,P);return this._calculate(D,D,D,d)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(d.zoom)-1},y,b),u.evaluate({zoom:Math.floor(d.zoom)},y,b),u.evaluate({zoom:Math.floor(d.zoom)+1},y,b),d):u.value},o.prototype._calculate=function(u,d,y,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:u,to:d}:{from:y,to:d}},o.prototype.interpolate=function(u){return u},o}(Yn),So=function(o){this.specification=o};So.prototype.possiblyEvaluate=function(a,o,u,d){if(a.value!==void 0){if(a.expression.kind==="constant"){var y=a.expression.evaluate(o,null,{},u,d);return this._calculate(y,y,y,o)}return this._calculate(a.expression.evaluate(new Wi(Math.floor(o.zoom-1),o)),a.expression.evaluate(new Wi(Math.floor(o.zoom),o)),a.expression.evaluate(new Wi(Math.floor(o.zoom+1),o)),o)}},So.prototype._calculate=function(a,o,u,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:a,to:o}:{from:u,to:o}},So.prototype.interpolate=function(a){return a};var Ou=function(o){this.specification=o};Ou.prototype.possiblyEvaluate=function(a,o,u,d){return!!a.expression.evaluate(o,null,{},u,d)},Ou.prototype.interpolate=function(){return!1};var $o=function(o){for(var u in this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],o){var d=o[u];d.specification.overridable&&this.overridableProperties.push(u);var y=this.defaultPropertyValues[u]=new du(d,void 0),b=this.defaultTransitionablePropertyValues[u]=new vu(d);this.defaultTransitioningPropertyValues[u]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=y.possiblyEvaluate({})}};Ln("DataDrivenProperty",Yn),Ln("DataConstantProperty",ni),Ln("CrossFadedDataDrivenProperty",pc),Ln("CrossFadedProperty",So),Ln("ColorRampProperty",Ou);var Iu=function(a){function o(u,d){if(a.call(this),this.id=u.id,this.type=u.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},u.type!=="custom"&&(this.metadata=(u=u).metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),d.layout&&(this._unevaluatedLayout=new Ko(d.layout)),d.paint)){for(var y in this._transitionablePaint=new ls(d.paint),u.paint)this.setPaintProperty(y,u.paint[y],{validate:!1});for(var b in u.layout)this.setLayoutProperty(b,u.layout[b],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new hc(d.paint)}}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},o.prototype.getLayoutProperty=function(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)},o.prototype.setLayoutProperty=function(u,d,y){y===void 0&&(y={}),d!=null&&this._validate(Sf,"layers."+this.id+".layout."+u,u,d,y)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,d):this.visibility=d)},o.prototype.getPaintProperty=function(u){return Ir(u,"-transition")?this._transitionablePaint.getTransition(u.slice(0,-"-transition".length)):this._transitionablePaint.getValue(u)},o.prototype.setPaintProperty=function(u,d,y){if(y===void 0&&(y={}),d!=null&&this._validate(hd,"layers."+this.id+".paint."+u,u,d,y))return!1;if(Ir(u,"-transition"))return this._transitionablePaint.setTransition(u.slice(0,-"-transition".length),d||void 0),!1;var b=this._transitionablePaint._values[u],C=b.property.specification["property-type"]==="cross-faded-data-driven",P=b.value.isDataDriven(),D=b.value;this._transitionablePaint.setValue(u,d),this._handleSpecialPaintPropertyUpdate(u);var j=this._transitionablePaint._values[u].value;return j.isDataDriven()||P||C||this._handleOverridablePaintPropertyUpdate(u,D,j)},o.prototype._handleSpecialPaintPropertyUpdate=function(u){},o.prototype._handleOverridablePaintPropertyUpdate=function(u,d,y){return!1},o.prototype.isHidden=function(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"},o.prototype.updateTransitions=function(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)},o.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},o.prototype.recalculate=function(u,d){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,d)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,d)},o.prototype.serialize=function(){var u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),Rt(u,function(d,y){return!(d===void 0||y==="layout"&&!Object.keys(d).length||y==="paint"&&!Object.keys(d).length)})},o.prototype._validate=function(u,d,y,b,C){return C===void 0&&(C={}),(!C||C.validate!==!1)&&Zc(this,u.call(Zl,{key:d,layerType:this.type,objectKey:y,value:b,styleSpec:_e,style:{glyphs:!0,sprite:!0}}))},o.prototype.is3D=function(){return!1},o.prototype.isTileClipped=function(){return!1},o.prototype.hasOffscreenPass=function(){return!1},o.prototype.resize=function(){},o.prototype.isStateDependent=function(){for(var u in this.paint._values){var d=this.paint.get(u);if(d instanceof Eo&&Wu(d.property.specification)&&(d.value.kind==="source"||d.value.kind==="composite")&&d.value.isStateDependent)return!0}return!1},o}(vt),wf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},vo=function(o,u){this._structArray=o,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},ga=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function qo(a,o){o===void 0&&(o=1);var u=0,d=0;return{members:a.map(function(y){var b=wf[y.type].BYTES_PER_ELEMENT,C=u=hl(u,Math.max(o,b)),P=y.components||1;return d=Math.max(d,b),u+=b*P,{name:y.name,type:y.type,components:P,offset:C}}),size:hl(u,Math.max(d,o)),alignment:o}}function hl(a,o){return Math.ceil(a/o)*o}ga.serialize=function(a,o){return a._trim(),o&&(a.isTransferred=!0,o.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}},ga.deserialize=function(a){var o=Object.create(this.prototype);return o.arrayBuffer=a.arrayBuffer,o.length=a.length,o.capacity=a.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o},ga.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},ga.prototype.clear=function(){this.length=0},ga.prototype.resize=function(a){this.reserve(a),this.length=a},ga.prototype.reserve=function(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}},ga.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Ru=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d){var y=this.length;return this.resize(y+1),this.emplace(y,u,d)},o.prototype.emplace=function(u,d,y){var b=2*u;return this.int16[b+0]=d,this.int16[b+1]=y,u},o}(ga);Ru.prototype.bytesPerElement=4,Ln("StructArrayLayout2i4",Ru);var $u=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y,b){var C=this.length;return this.resize(C+1),this.emplace(C,u,d,y,b)},o.prototype.emplace=function(u,d,y,b,C){var P=4*u;return this.int16[P+0]=d,this.int16[P+1]=y,this.int16[P+2]=b,this.int16[P+3]=C,u},o}(ga);$u.prototype.bytesPerElement=8,Ln("StructArrayLayout4i8",$u);var mu=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y,b,C,P){var D=this.length;return this.resize(D+1),this.emplace(D,u,d,y,b,C,P)},o.prototype.emplace=function(u,d,y,b,C,P,D){var j=6*u;return this.int16[j+0]=d,this.int16[j+1]=y,this.int16[j+2]=b,this.int16[j+3]=C,this.int16[j+4]=P,this.int16[j+5]=D,u},o}(ga);mu.prototype.bytesPerElement=12,Ln("StructArrayLayout2i4i12",mu);var Ys=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y,b,C,P){var D=this.length;return this.resize(D+1),this.emplace(D,u,d,y,b,C,P)},o.prototype.emplace=function(u,d,y,b,C,P,D){var j=4*u,X=8*u;return this.int16[j+0]=d,this.int16[j+1]=y,this.uint8[X+4]=b,this.uint8[X+5]=C,this.uint8[X+6]=P,this.uint8[X+7]=D,u},o}(ga);Ys.prototype.bytesPerElement=8,Ln("StructArrayLayout2i4ub8",Ys);var Yl=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d){var y=this.length;return this.resize(y+1),this.emplace(y,u,d)},o.prototype.emplace=function(u,d,y){var b=2*u;return this.float32[b+0]=d,this.float32[b+1]=y,u},o}(ga);Yl.prototype.bytesPerElement=8,Ln("StructArrayLayout2f8",Yl);var gu=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y,b,C,P,D,j,X,ee){var te=this.length;return this.resize(te+1),this.emplace(te,u,d,y,b,C,P,D,j,X,ee)},o.prototype.emplace=function(u,d,y,b,C,P,D,j,X,ee,te){var Ee=10*u;return this.uint16[Ee+0]=d,this.uint16[Ee+1]=y,this.uint16[Ee+2]=b,this.uint16[Ee+3]=C,this.uint16[Ee+4]=P,this.uint16[Ee+5]=D,this.uint16[Ee+6]=j,this.uint16[Ee+7]=X,this.uint16[Ee+8]=ee,this.uint16[Ee+9]=te,u},o}(ga);gu.prototype.bytesPerElement=20,Ln("StructArrayLayout10ui20",gu);var Tf=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y,b,C,P,D,j,X,ee,te,Ee){var Le=this.length;return this.resize(Le+1),this.emplace(Le,u,d,y,b,C,P,D,j,X,ee,te,Ee)},o.prototype.emplace=function(u,d,y,b,C,P,D,j,X,ee,te,Ee,Le){var Oe=12*u;return this.int16[Oe+0]=d,this.int16[Oe+1]=y,this.int16[Oe+2]=b,this.int16[Oe+3]=C,this.uint16[Oe+4]=P,this.uint16[Oe+5]=D,this.uint16[Oe+6]=j,this.uint16[Oe+7]=X,this.int16[Oe+8]=ee,this.int16[Oe+9]=te,this.int16[Oe+10]=Ee,this.int16[Oe+11]=Le,u},o}(ga);Tf.prototype.bytesPerElement=24,Ln("StructArrayLayout4i4ui4i24",Tf);var Kl=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,d,y)},o.prototype.emplace=function(u,d,y,b){var C=3*u;return this.float32[C+0]=d,this.float32[C+1]=y,this.float32[C+2]=b,u},o}(ga);Kl.prototype.bytesPerElement=12,Ln("StructArrayLayout3f12",Kl);var Mf=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u){var d=this.length;return this.resize(d+1),this.emplace(d,u)},o.prototype.emplace=function(u,d){return this.uint32[1*u+0]=d,u},o}(ga);Mf.prototype.bytesPerElement=4,Ln("StructArrayLayout1ul4",Mf);var ch=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y,b,C,P,D,j,X){var ee=this.length;return this.resize(ee+1),this.emplace(ee,u,d,y,b,C,P,D,j,X)},o.prototype.emplace=function(u,d,y,b,C,P,D,j,X,ee){var te=10*u,Ee=5*u;return this.int16[te+0]=d,this.int16[te+1]=y,this.int16[te+2]=b,this.int16[te+3]=C,this.int16[te+4]=P,this.int16[te+5]=D,this.uint32[Ee+3]=j,this.uint16[te+8]=X,this.uint16[te+9]=ee,u},o}(ga);ch.prototype.bytesPerElement=20,Ln("StructArrayLayout6i1ul2ui20",ch);var ku=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y,b,C,P){var D=this.length;return this.resize(D+1),this.emplace(D,u,d,y,b,C,P)},o.prototype.emplace=function(u,d,y,b,C,P,D){var j=6*u;return this.int16[j+0]=d,this.int16[j+1]=y,this.int16[j+2]=b,this.int16[j+3]=C,this.int16[j+4]=P,this.int16[j+5]=D,u},o}(ga);ku.prototype.bytesPerElement=12,Ln("StructArrayLayout2i2i2i12",ku);var dc=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y,b,C){var P=this.length;return this.resize(P+1),this.emplace(P,u,d,y,b,C)},o.prototype.emplace=function(u,d,y,b,C,P){var D=4*u,j=8*u;return this.float32[D+0]=d,this.float32[D+1]=y,this.float32[D+2]=b,this.int16[j+6]=C,this.int16[j+7]=P,u},o}(ga);dc.prototype.bytesPerElement=16,Ln("StructArrayLayout2f1f2i16",dc);var Qc=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y,b){var C=this.length;return this.resize(C+1),this.emplace(C,u,d,y,b)},o.prototype.emplace=function(u,d,y,b,C){var P=12*u,D=3*u;return this.uint8[P+0]=d,this.uint8[P+1]=y,this.float32[D+1]=b,this.float32[D+2]=C,u},o}(ga);Qc.prototype.bytesPerElement=12,Ln("StructArrayLayout2ub2f12",Qc);var pl=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,d,y)},o.prototype.emplace=function(u,d,y,b){var C=3*u;return this.uint16[C+0]=d,this.uint16[C+1]=y,this.uint16[C+2]=b,u},o}(ga);pl.prototype.bytesPerElement=6,Ln("StructArrayLayout3ui6",pl);var yu=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y,b,C,P,D,j,X,ee,te,Ee,Le,Oe,We,Ze,yt){var Dt=this.length;return this.resize(Dt+1),this.emplace(Dt,u,d,y,b,C,P,D,j,X,ee,te,Ee,Le,Oe,We,Ze,yt)},o.prototype.emplace=function(u,d,y,b,C,P,D,j,X,ee,te,Ee,Le,Oe,We,Ze,yt,Dt){var Xt=24*u,mr=12*u,sr=48*u;return this.int16[Xt+0]=d,this.int16[Xt+1]=y,this.uint16[Xt+2]=b,this.uint16[Xt+3]=C,this.uint32[mr+2]=P,this.uint32[mr+3]=D,this.uint32[mr+4]=j,this.uint16[Xt+10]=X,this.uint16[Xt+11]=ee,this.uint16[Xt+12]=te,this.float32[mr+7]=Ee,this.float32[mr+8]=Le,this.uint8[sr+36]=Oe,this.uint8[sr+37]=We,this.uint8[sr+38]=Ze,this.uint32[mr+10]=yt,this.int16[Xt+22]=Dt,u},o}(ga);yu.prototype.bytesPerElement=48,Ln("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",yu);var dl=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y,b,C,P,D,j,X,ee,te,Ee,Le,Oe,We,Ze,yt,Dt,Xt,mr,sr,Qr,nn,Gn,ei,$n,Bn,Ti){var ui=this.length;return this.resize(ui+1),this.emplace(ui,u,d,y,b,C,P,D,j,X,ee,te,Ee,Le,Oe,We,Ze,yt,Dt,Xt,mr,sr,Qr,nn,Gn,ei,$n,Bn,Ti)},o.prototype.emplace=function(u,d,y,b,C,P,D,j,X,ee,te,Ee,Le,Oe,We,Ze,yt,Dt,Xt,mr,sr,Qr,nn,Gn,ei,$n,Bn,Ti,ui){var ti=34*u,na=17*u;return this.int16[ti+0]=d,this.int16[ti+1]=y,this.int16[ti+2]=b,this.int16[ti+3]=C,this.int16[ti+4]=P,this.int16[ti+5]=D,this.int16[ti+6]=j,this.int16[ti+7]=X,this.uint16[ti+8]=ee,this.uint16[ti+9]=te,this.uint16[ti+10]=Ee,this.uint16[ti+11]=Le,this.uint16[ti+12]=Oe,this.uint16[ti+13]=We,this.uint16[ti+14]=Ze,this.uint16[ti+15]=yt,this.uint16[ti+16]=Dt,this.uint16[ti+17]=Xt,this.uint16[ti+18]=mr,this.uint16[ti+19]=sr,this.uint16[ti+20]=Qr,this.uint16[ti+21]=nn,this.uint16[ti+22]=Gn,this.uint32[na+12]=ei,this.float32[na+13]=$n,this.float32[na+14]=Bn,this.float32[na+15]=Ti,this.float32[na+16]=ui,u},o}(ga);dl.prototype.bytesPerElement=68,Ln("StructArrayLayout8i15ui1ul4f68",dl);var _u=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u){var d=this.length;return this.resize(d+1),this.emplace(d,u)},o.prototype.emplace=function(u,d){return this.float32[1*u+0]=d,u},o}(ga);_u.prototype.bytesPerElement=4,Ln("StructArrayLayout1f4",_u);var xs=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,d,y)},o.prototype.emplace=function(u,d,y,b){var C=3*u;return this.int16[C+0]=d,this.int16[C+1]=y,this.int16[C+2]=b,u},o}(ga);xs.prototype.bytesPerElement=6,Ln("StructArrayLayout3i6",xs);var $l=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,d,y)},o.prototype.emplace=function(u,d,y,b){var C=4*u;return this.uint32[2*u+0]=d,this.uint16[C+2]=y,this.uint16[C+3]=b,u},o}(ga);$l.prototype.bytesPerElement=8,Ln("StructArrayLayout1ul2ui8",$l);var Rs=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d){var y=this.length;return this.resize(y+1),this.emplace(y,u,d)},o.prototype.emplace=function(u,d,y){var b=2*u;return this.uint16[b+0]=d,this.uint16[b+1]=y,u},o}(ga);Rs.prototype.bytesPerElement=4,Ln("StructArrayLayout2ui4",Rs);var vc=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u){var d=this.length;return this.resize(d+1),this.emplace(d,u)},o.prototype.emplace=function(u,d){return this.uint16[1*u+0]=d,u},o}(ga);vc.prototype.bytesPerElement=2,Ln("StructArrayLayout1ui2",vc);var Pf=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,d,y,b){var C=this.length;return this.resize(C+1),this.emplace(C,u,d,y,b)},o.prototype.emplace=function(u,d,y,b,C){var P=4*u;return this.float32[P+0]=d,this.float32[P+1]=y,this.float32[P+2]=b,this.float32[P+3]=C,u},o}(ga);Pf.prototype.bytesPerElement=16,Ln("StructArrayLayout4f16",Pf);var p=function(a){function o(){a.apply(this,arguments)}a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o;var u={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return u.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},u.x1.get=function(){return this._structArray.int16[this._pos2+2]},u.y1.get=function(){return this._structArray.int16[this._pos2+3]},u.x2.get=function(){return this._structArray.int16[this._pos2+4]},u.y2.get=function(){return this._structArray.int16[this._pos2+5]},u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.anchorPoint.get=function(){return new se(this.anchorPointX,this.anchorPointY)},Object.defineProperties(o.prototype,u),o}(vo);p.prototype.size=20;var f=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.get=function(u){return new p(this,u)},o}(ch);Ln("CollisionBoxArray",f);var l=function(a){function o(){a.apply(this,arguments)}a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},u.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},u.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},u.segment.get=function(){return this._structArray.uint16[this._pos2+10]},u.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},u.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},u.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},u.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},u.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},u.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},u.placedOrientation.set=function(d){this._structArray.uint8[this._pos1+37]=d},u.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},u.hidden.set=function(d){this._structArray.uint8[this._pos1+38]=d},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},u.crossTileID.set=function(d){this._structArray.uint32[this._pos4+10]=d},u.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(o.prototype,u),o}(vo);l.prototype.size=48;var v=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.get=function(u){return new l(this,u)},o}(yu);Ln("PlacedSymbolArray",v);var E=function(a){function o(){a.apply(this,arguments)}a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},u.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},u.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},u.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},u.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},u.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},u.key.get=function(){return this._structArray.uint16[this._pos2+8]},u.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},u.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},u.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},u.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},u.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},u.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},u.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},u.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},u.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},u.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},u.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},u.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},u.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},u.crossTileID.set=function(d){this._structArray.uint32[this._pos4+12]=d},u.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},u.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},u.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},u.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(o.prototype,u),o}(vo);E.prototype.size=68;var T=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.get=function(u){return new E(this,u)},o}(dl);Ln("SymbolInstanceArray",T);var I=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.getoffsetX=function(u){return this.float32[1*u+0]},o}(_u);Ln("GlyphOffsetArray",I);var k=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.getx=function(u){return this.int16[3*u+0]},o.prototype.gety=function(u){return this.int16[3*u+1]},o.prototype.gettileUnitDistanceFromAnchor=function(u){return this.int16[3*u+2]},o}(xs);Ln("SymbolLineVertexArray",k);var W=function(a){function o(){a.apply(this,arguments)}a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o;var u={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(o.prototype,u),o}(vo);W.prototype.size=8;var q=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.get=function(u){return new W(this,u)},o}($l);Ln("FeatureIndexArray",q);var he=qo([{name:"a_pos",components:2,type:"Int16"}],4).members,ve=function(o){o===void 0&&(o=[]),this.segments=o};function xe(a,o){return 256*(a=ht(Math.floor(a),0,255))+ht(Math.floor(o),0,255)}ve.prototype.prepareSegment=function(a,o,u,d){var y=this.segments[this.segments.length-1];return a>ve.MAX_VERTEX_ARRAY_LENGTH&&Nt("Max vertices per segment is "+ve.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+a),(!y||y.vertexLength+a>ve.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==d)&&(y={vertexOffset:o.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},d!==void 0&&(y.sortKey=d),this.segments.push(y)),y},ve.prototype.get=function(){return this.segments},ve.prototype.destroy=function(){for(var a=0,o=this.segments;a<o.length;a+=1){var u=o[a];for(var d in u.vaos)u.vaos[d].destroy()}},ve.simpleSegment=function(a,o,u,d){return new ve([{vertexOffset:a,primitiveOffset:o,vertexLength:u,primitiveLength:d,vaos:{},sortKey:0}])},ve.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ln("SegmentVector",ve);var Ne=qo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Re=z(function(a){a.exports=function(o,u){var d,y,b,C,P,D,j,X;for(y=o.length-(d=3&o.length),b=u,P=3432918353,D=461845907,X=0;X<y;)j=255&o.charCodeAt(X)|(255&o.charCodeAt(++X))<<8|(255&o.charCodeAt(++X))<<16|(255&o.charCodeAt(++X))<<24,++X,b=27492+(65535&(C=5*(65535&(b=(b^=j=(65535&(j=(j=(65535&j)*P+(((j>>>16)*P&65535)<<16)&4294967295)<<15|j>>>17))*D+(((j>>>16)*D&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(j=0,d){case 3:j^=(255&o.charCodeAt(X+2))<<16;case 2:j^=(255&o.charCodeAt(X+1))<<8;case 1:b^=j=(65535&(j=(j=(65535&(j^=255&o.charCodeAt(X)))*P+(((j>>>16)*P&65535)<<16)&4294967295)<<15|j>>>17))*D+(((j>>>16)*D&65535)<<16)&4294967295}return b^=o.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}}),Ye=z(function(a){a.exports=function(o,u){for(var d,y=o.length,b=u^y,C=0;y>=4;)d=1540483477*(65535&(d=255&o.charCodeAt(C)|(255&o.charCodeAt(++C))<<8|(255&o.charCodeAt(++C))<<16|(255&o.charCodeAt(++C))<<24))+((1540483477*(d>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),y-=4,++C;switch(y){case 3:b^=(255&o.charCodeAt(C+2))<<16;case 2:b^=(255&o.charCodeAt(C+1))<<8;case 1:b=1540483477*(65535&(b^=255&o.charCodeAt(C)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}}),ze=Re,Ge=Ye;ze.murmur3=Re,ze.murmur2=Ge;var xt=function(){this.ids=[],this.positions=[],this.indexed=!1};xt.prototype.add=function(a,o,u,d){this.ids.push(fr(a)),this.positions.push(o,u,d)},xt.prototype.getPositions=function(a){for(var o=fr(a),u=0,d=this.ids.length-1;u<d;){var y=u+d>>1;this.ids[y]>=o?d=y:u=y+1}for(var b=[];this.ids[u]===o;)b.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return b},xt.serialize=function(a,o){var u=new Float64Array(a.ids),d=new Uint32Array(a.positions);return function y(b,C,P,D){for(;P<D;){for(var j=b[P+D>>1],X=P-1,ee=D+1;;){do X++;while(b[X]<j);do ee--;while(b[ee]>j);if(X>=ee)break;Vt(b,X,ee),Vt(C,3*X,3*ee),Vt(C,3*X+1,3*ee+1),Vt(C,3*X+2,3*ee+2)}ee-P<D-ee?(y(b,C,P,ee),P=ee+1):(y(b,C,ee+1,D),D=ee)}}(u,d,0,u.length-1),o&&o.push(u.buffer,d.buffer),{ids:u,positions:d}},xt.deserialize=function(a){var o=new xt;return o.ids=a.ids,o.positions=a.positions,o.indexed=!0,o};var _t=Math.pow(2,53)-1;function fr(a){var o=+a;return!isNaN(o)&&o<=_t?o:ze(String(a))}function Vt(a,o,u){var d=a[o];a[o]=a[u],a[u]=d}Ln("FeaturePositionMap",xt);var lr=function(o,u){this.gl=o.gl,this.location=u},vr=function(a){function o(u,d){a.call(this,u,d),this.current=0}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))},o}(lr),xr=function(a){function o(u,d){a.call(this,u,d),this.current=0}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))},o}(lr),Hr=function(a){function o(u,d){a.call(this,u,d),this.current=[0,0]}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))},o}(lr),cn=function(a){function o(u,d){a.call(this,u,d),this.current=[0,0,0]}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))},o}(lr),Un=function(a){function o(u,d){a.call(this,u,d),this.current=[0,0,0,0]}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))},o}(lr),Jn=function(a){function o(u,d){a.call(this,u,d),this.current=xi.transparent}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))},o}(lr),oi=new Float32Array(16),ji=function(a){function o(u,d){a.call(this,u,d),this.current=oi}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(var d=1;d<16;d++)if(u[d]!==this.current[d]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}},o}(lr);function hi(a){return[xe(255*a.r,255*a.g),xe(255*a.b,255*a.a)]}var Rn=function(o,u,d){this.value=o,this.uniformNames=u.map(function(y){return"u_"+y}),this.type=d};Rn.prototype.setUniform=function(a,o,u){a.set(u.constantOr(this.value))},Rn.prototype.getBinding=function(a,o,u){return this.type==="color"?new Jn(a,o):new xr(a,o)};var bi=function(o,u){this.uniformNames=u.map(function(d){return"u_"+d}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};bi.prototype.setConstantPatternPositions=function(a,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=a.tlbr},bi.prototype.setUniform=function(a,o,u,d){var y=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&a.set(y)},bi.prototype.getBinding=function(a,o,u){return u.substr(0,9)==="u_pattern"?new Un(a,o):new xr(a,o)};var Oi=function(o,u,d,y){this.expression=o,this.type=d,this.maxValue=0,this.paintVertexAttributes=u.map(function(b){return{name:"a_"+b,type:"Float32",components:d==="color"?2:1,offset:0}}),this.paintVertexArray=new y};Oi.prototype.populatePaintArray=function(a,o,u,d,y){var b=this.paintVertexArray.length,C=this.expression.evaluate(new Wi(0),o,{},d,[],y);this.paintVertexArray.resize(a),this._setPaintValue(b,a,C)},Oi.prototype.updatePaintArray=function(a,o,u,d){var y=this.expression.evaluate({zoom:0},u,d);this._setPaintValue(a,o,y)},Oi.prototype._setPaintValue=function(a,o,u){if(this.type==="color")for(var d=hi(u),y=a;y<o;y++)this.paintVertexArray.emplace(y,d[0],d[1]);else{for(var b=a;b<o;b++)this.paintVertexArray.emplace(b,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}},Oi.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Oi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Qn=function(o,u,d,y,b,C){this.expression=o,this.uniformNames=u.map(function(P){return"u_"+P+"_t"}),this.type=d,this.useIntegerZoom=y,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=u.map(function(P){return{name:"a_"+P,type:"Float32",components:d==="color"?4:2,offset:0}}),this.paintVertexArray=new C};Qn.prototype.populatePaintArray=function(a,o,u,d,y){var b=this.expression.evaluate(new Wi(this.zoom),o,{},d,[],y),C=this.expression.evaluate(new Wi(this.zoom+1),o,{},d,[],y),P=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(P,a,b,C)},Qn.prototype.updatePaintArray=function(a,o,u,d){var y=this.expression.evaluate({zoom:this.zoom},u,d),b=this.expression.evaluate({zoom:this.zoom+1},u,d);this._setPaintValue(a,o,y,b)},Qn.prototype._setPaintValue=function(a,o,u,d){if(this.type==="color")for(var y=hi(u),b=hi(d),C=a;C<o;C++)this.paintVertexArray.emplace(C,y[0],y[1],b[0],b[1]);else{for(var P=a;P<o;P++)this.paintVertexArray.emplace(P,u,d);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(d))}},Qn.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Qn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Qn.prototype.setUniform=function(a,o){var u=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,d=ht(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);a.set(d)},Qn.prototype.getBinding=function(a,o,u){return new xr(a,o)};var Ri=function(o,u,d,y,b,C){this.expression=o,this.type=u,this.useIntegerZoom=d,this.zoom=y,this.layerId=C,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b};Ri.prototype.populatePaintArray=function(a,o,u){var d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(d,a,o.patterns&&o.patterns[this.layerId],u)},Ri.prototype.updatePaintArray=function(a,o,u,d,y){this._setPaintValues(a,o,u.patterns&&u.patterns[this.layerId],y)},Ri.prototype._setPaintValues=function(a,o,u,d){if(d&&u){var y=d[u.min],b=d[u.mid],C=d[u.max];if(y&&b&&C)for(var P=a;P<o;P++)this.zoomInPaintVertexArray.emplace(P,b.tl[0],b.tl[1],b.br[0],b.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1],b.pixelRatio,y.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,b.tl[0],b.tl[1],b.br[0],b.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],b.pixelRatio,C.pixelRatio)}},Ri.prototype.upload=function(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,Ne.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,Ne.members,this.expression.isStateDependent))},Ri.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var si=function(o,u,d){this.binders={},this._buffers=[];var y=[];for(var b in o.paint._values)if(d(b)){var C=o.paint.get(b);if(C instanceof Eo&&Wu(C.property.specification)){var P=$i(b,o.type),D=C.value,j=C.property.specification.type,X=C.property.useIntegerZoom,ee=C.property.specification["property-type"],te=ee==="cross-faded"||ee==="cross-faded-data-driven";if(D.kind==="constant")this.binders[b]=te?new bi(D.value,P):new Rn(D.value,P,j),y.push("/u_"+b);else if(D.kind==="source"||te){var Ee=mo(b,j,"source");this.binders[b]=te?new Ri(D,j,X,u,Ee,o.id):new Oi(D,P,j,Ee),y.push("/a_"+b)}else{var Le=mo(b,j,"composite");this.binders[b]=new Qn(D,P,j,X,u,Le),y.push("/z_"+b)}}}this.cacheKey=y.sort().join("")};si.prototype.getMaxValue=function(a){var o=this.binders[a];return o instanceof Oi||o instanceof Qn?o.maxValue:0},si.prototype.populatePaintArrays=function(a,o,u,d,y){for(var b in this.binders){var C=this.binders[b];(C instanceof Oi||C instanceof Qn||C instanceof Ri)&&C.populatePaintArray(a,o,u,d,y)}},si.prototype.setConstantPatternPositions=function(a,o){for(var u in this.binders){var d=this.binders[u];d instanceof bi&&d.setConstantPatternPositions(a,o)}},si.prototype.updatePaintArrays=function(a,o,u,d,y){var b=!1;for(var C in a)for(var P=0,D=o.getPositions(C);P<D.length;P+=1){var j=D[P],X=u.feature(j.index);for(var ee in this.binders){var te=this.binders[ee];if((te instanceof Oi||te instanceof Qn||te instanceof Ri)&&te.expression.isStateDependent===!0){var Ee=d.paint.get(ee);te.expression=Ee.value,te.updatePaintArray(j.start,j.end,X,a[C],y),b=!0}}}return b},si.prototype.defines=function(){var a=[];for(var o in this.binders){var u=this.binders[o];(u instanceof Rn||u instanceof bi)&&a.push.apply(a,u.uniformNames.map(function(d){return"#define HAS_UNIFORM_"+d}))}return a},si.prototype.getBinderAttributes=function(){var a=[];for(var o in this.binders){var u=this.binders[o];if(u instanceof Oi||u instanceof Qn)for(var d=0;d<u.paintVertexAttributes.length;d++)a.push(u.paintVertexAttributes[d].name);else if(u instanceof Ri)for(var y=0;y<Ne.members.length;y++)a.push(Ne.members[y].name)}return a},si.prototype.getBinderUniforms=function(){var a=[];for(var o in this.binders){var u=this.binders[o];if(u instanceof Rn||u instanceof bi||u instanceof Qn)for(var d=0,y=u.uniformNames;d<y.length;d+=1)a.push(y[d])}return a},si.prototype.getPaintVertexBuffers=function(){return this._buffers},si.prototype.getUniforms=function(a,o){var u=[];for(var d in this.binders){var y=this.binders[d];if(y instanceof Rn||y instanceof bi||y instanceof Qn)for(var b=0,C=y.uniformNames;b<C.length;b+=1){var P=C[b];if(o[P]){var D=y.getBinding(a,o[P],P);u.push({name:P,property:d,binding:D})}}}return u},si.prototype.setUniforms=function(a,o,u,d){for(var y=0,b=o;y<b.length;y+=1){var C=b[y],P=C.name,D=C.property;this.binders[D].setUniform(C.binding,d,u.get(D),P)}},si.prototype.updatePaintBuffers=function(a){for(var o in this._buffers=[],this.binders){var u=this.binders[o];if(a&&u instanceof Ri){var d=a.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(u instanceof Oi||u instanceof Qn)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}},si.prototype.upload=function(a){for(var o in this.binders){var u=this.binders[o];(u instanceof Oi||u instanceof Qn||u instanceof Ri)&&u.upload(a)}this.updatePaintBuffers()},si.prototype.destroy=function(){for(var a in this.binders){var o=this.binders[a];(o instanceof Oi||o instanceof Qn||o instanceof Ri)&&o.destroy()}};var Di=function(o,u,d){d===void 0&&(d=function(){return!0}),this.programConfigurations={};for(var y=0,b=o;y<b.length;y+=1){var C=b[y];this.programConfigurations[C.id]=new si(C,u,d)}this.needsUpload=!1,this._featureMap=new xt,this._bufferOffset=0};function $i(a,o){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(o+"-","").replace(/-/g,"_")]}function mo(a,o,u){var d={color:{source:Yl,composite:Pf},number:{source:_u,composite:Yl}},y=function(b){return{"line-pattern":{source:gu,composite:gu},"fill-pattern":{source:gu,composite:gu},"fill-extrusion-pattern":{source:gu,composite:gu}}[b]}(a);return y&&y[u]||d[o][u]}Di.prototype.populatePaintArrays=function(a,o,u,d,y,b){for(var C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(a,o,d,y,b);o.id!==void 0&&this._featureMap.add(o.id,u,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0},Di.prototype.updatePaintArrays=function(a,o,u,d){for(var y=0,b=u;y<b.length;y+=1){var C=b[y];this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(a,this._featureMap,o,C,d)||this.needsUpload}},Di.prototype.get=function(a){return this.programConfigurations[a]},Di.prototype.upload=function(a){if(this.needsUpload){for(var o in this.programConfigurations)this.programConfigurations[o].upload(a);this.needsUpload=!1}},Di.prototype.destroy=function(){for(var a in this.programConfigurations)this.programConfigurations[a].destroy()},Ln("ConstantBinder",Rn),Ln("CrossFadedConstantBinder",bi),Ln("SourceExpressionBinder",Oi),Ln("CrossFadedCompositeBinder",Ri),Ln("CompositeExpressionBinder",Qn),Ln("ProgramConfiguration",si,{omit:["_buffers"]}),Ln("ProgramConfigurationSet",Di);var uo=Math.pow(2,14)-1,Ro=-uo-1;function Za(a){for(var o=8192/a.extent,u=a.loadGeometry(),d=0;d<u.length;d++)for(var y=u[d],b=0;b<y.length;b++){var C=y[b],P=Math.round(C.x*o),D=Math.round(C.y*o);C.x=ht(P,Ro,uo),C.y=ht(D,Ro,uo),(P<C.x||P>C.x+1||D<C.y||D>C.y+1)&&Nt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return u}function no(a,o){return{type:a.type,id:a.id,properties:a.properties,geometry:o?Za(a):[]}}function Ks(a,o,u,d,y){a.emplaceBack(2*o+(d+1)/2,2*u+(y+1)/2)}var Ba=function(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new Ru,this.indexArray=new pl,this.segments=new ve,this.programConfigurations=new Di(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};function vl(a,o){for(var u=0;u<a.length;u++)if(xu(o,a[u]))return!0;for(var d=0;d<o.length;d++)if(xu(a,o[d]))return!0;return!!Co(a,o)}function ks(a,o,u){return!!xu(a,o)||!!qu(o,a,u)}function bs(a,o){if(a.length===1)return ml(o,a[0]);for(var u=0;u<o.length;u++)for(var d=o[u],y=0;y<d.length;y++)if(xu(a,d[y]))return!0;for(var b=0;b<a.length;b++)if(ml(o,a[b]))return!0;for(var C=0;C<o.length;C++)if(Co(a,o[C]))return!0;return!1}function Es(a,o,u){if(a.length>1){if(Co(a,o))return!0;for(var d=0;d<o.length;d++)if(qu(o[d],a,u))return!0}for(var y=0;y<a.length;y++)if(qu(a[y],o,u))return!0;return!1}function Co(a,o){if(a.length===0||o.length===0)return!1;for(var u=0;u<a.length-1;u++)for(var d=a[u],y=a[u+1],b=0;b<o.length-1;b++)if(Ls(d,y,o[b],o[b+1]))return!0;return!1}function Ls(a,o,u,d){return nr(a,u,d)!==nr(o,u,d)&&nr(a,o,u)!==nr(a,o,d)}function qu(a,o,u){var d=u*u;if(o.length===1)return a.distSqr(o[0])<d;for(var y=1;y<o.length;y++)if(Ll(a,o[y-1],o[y])<d)return!0;return!1}function Ll(a,o,u){var d=o.distSqr(u);if(d===0)return a.distSqr(o);var y=((a.x-o.x)*(u.x-o.x)+(a.y-o.y)*(u.y-o.y))/d;return a.distSqr(y<0?o:y>1?u:u.sub(o)._mult(y)._add(o))}function ml(a,o){for(var u,d,y,b=!1,C=0;C<a.length;C++)for(var P=0,D=(u=a[C]).length-1;P<u.length;D=P++)(d=u[P]).y>o.y!=(y=u[D]).y>o.y&&o.x<(y.x-d.x)*(o.y-d.y)/(y.y-d.y)+d.x&&(b=!b);return b}function xu(a,o){for(var u=!1,d=0,y=a.length-1;d<a.length;y=d++){var b=a[d],C=a[y];b.y>o.y!=C.y>o.y&&o.x<(C.x-b.x)*(o.y-b.y)/(C.y-b.y)+b.x&&(u=!u)}return u}function ql(a,o,u){var d=u[0],y=u[2];if(a.x<d.x&&o.x<d.x||a.x>y.x&&o.x>y.x||a.y<d.y&&o.y<d.y||a.y>y.y&&o.y>y.y)return!1;var b=nr(a,o,u[0]);return b!==nr(a,o,u[1])||b!==nr(a,o,u[2])||b!==nr(a,o,u[3])}function bu(a,o,u){var d=o.paint.get(a).value;return d.kind==="constant"?d.value:u.programConfigurations.get(o.id).getMaxValue(a)}function ko(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Lu(a,o,u,d,y){if(!o[0]&&!o[1])return a;var b=se.convert(o)._mult(y);u==="viewport"&&b._rotate(-d);for(var C=[],P=0;P<a.length;P++)C.push(a[P].sub(b));return C}Ba.prototype.populate=function(a,o,u){var d=this.layers[0],y=[],b=null;d.type==="circle"&&(b=d.layout.get("circle-sort-key"));for(var C=0,P=a;C<P.length;C+=1){var D=P[C],j=D.feature,X=D.id,ee=D.index,te=D.sourceLayerIndex,Ee=this.layers[0]._featureFilter.needGeometry,Le=no(j,Ee);if(this.layers[0]._featureFilter.filter(new Wi(this.zoom),Le,u)){var Oe=b?b.evaluate(Le,{},u):void 0,We={id:X,properties:j.properties,type:j.type,sourceLayerIndex:te,index:ee,geometry:Ee?Le.geometry:Za(j),patterns:{},sortKey:Oe};y.push(We)}}b&&y.sort(function(nn,Gn){return nn.sortKey-Gn.sortKey});for(var Ze=0,yt=y;Ze<yt.length;Ze+=1){var Dt=yt[Ze],Xt=Dt.geometry,mr=Dt.index,sr=Dt.sourceLayerIndex,Qr=a[mr].feature;this.addFeature(Dt,Xt,mr,u),o.featureIndex.insert(Qr,Xt,mr,sr,this.index)}},Ba.prototype.update=function(a,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,o,this.stateDependentLayers,u)},Ba.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ba.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ba.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,he),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},Ba.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ba.prototype.addFeature=function(a,o,u,d){for(var y=0,b=o;y<b.length;y+=1)for(var C=0,P=b[y];C<P.length;C+=1){var D=P[C],j=D.x,X=D.y;if(!(j<0||j>=8192||X<0||X>=8192)){var ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),te=ee.vertexLength;Ks(this.layoutVertexArray,j,X,-1,-1),Ks(this.layoutVertexArray,j,X,1,-1),Ks(this.layoutVertexArray,j,X,1,1),Ks(this.layoutVertexArray,j,X,-1,1),this.indexArray.emplaceBack(te,te+1,te+2),this.indexArray.emplaceBack(te,te+3,te+2),ee.vertexLength+=4,ee.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,u,{},d)},Ln("CircleBucket",Ba,{omit:["layers"]});var Jc=new $o({"circle-sort-key":new Yn(_e.layout_circle["circle-sort-key"])}),Qu={paint:new $o({"circle-radius":new Yn(_e.paint_circle["circle-radius"]),"circle-color":new Yn(_e.paint_circle["circle-color"]),"circle-blur":new Yn(_e.paint_circle["circle-blur"]),"circle-opacity":new Yn(_e.paint_circle["circle-opacity"]),"circle-translate":new ni(_e.paint_circle["circle-translate"]),"circle-translate-anchor":new ni(_e.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ni(_e.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ni(_e.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Yn(_e.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Yn(_e.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Yn(_e.paint_circle["circle-stroke-opacity"])}),layout:Jc},jo=typeof Float32Array!="undefined"?Float32Array:Array;function Ds(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Vo(a,o,u){var d=o[0],y=o[1],b=o[2],C=o[3],P=o[4],D=o[5],j=o[6],X=o[7],ee=o[8],te=o[9],Ee=o[10],Le=o[11],Oe=o[12],We=o[13],Ze=o[14],yt=o[15],Dt=u[0],Xt=u[1],mr=u[2],sr=u[3];return a[0]=Dt*d+Xt*P+mr*ee+sr*Oe,a[1]=Dt*y+Xt*D+mr*te+sr*We,a[2]=Dt*b+Xt*j+mr*Ee+sr*Ze,a[3]=Dt*C+Xt*X+mr*Le+sr*yt,a[4]=(Dt=u[4])*d+(Xt=u[5])*P+(mr=u[6])*ee+(sr=u[7])*Oe,a[5]=Dt*y+Xt*D+mr*te+sr*We,a[6]=Dt*b+Xt*j+mr*Ee+sr*Ze,a[7]=Dt*C+Xt*X+mr*Le+sr*yt,a[8]=(Dt=u[8])*d+(Xt=u[9])*P+(mr=u[10])*ee+(sr=u[11])*Oe,a[9]=Dt*y+Xt*D+mr*te+sr*We,a[10]=Dt*b+Xt*j+mr*Ee+sr*Ze,a[11]=Dt*C+Xt*X+mr*Le+sr*yt,a[12]=(Dt=u[12])*d+(Xt=u[13])*P+(mr=u[14])*ee+(sr=u[15])*Oe,a[13]=Dt*y+Xt*D+mr*te+sr*We,a[14]=Dt*b+Xt*j+mr*Ee+sr*Ze,a[15]=Dt*C+Xt*X+mr*Le+sr*yt,a}Math.hypot||(Math.hypot=function(){for(var a=arguments,o=0,u=arguments.length;u--;)o+=a[u]*a[u];return Math.sqrt(o)});var Fs,Go=Vo;function $s(a,o,u){var d=o[0],y=o[1],b=o[2],C=o[3];return a[0]=u[0]*d+u[4]*y+u[8]*b+u[12]*C,a[1]=u[1]*d+u[5]*y+u[9]*b+u[13]*C,a[2]=u[2]*d+u[6]*y+u[10]*b+u[14]*C,a[3]=u[3]*d+u[7]*y+u[11]*b+u[15]*C,a}Fs=new jo(3),jo!=Float32Array&&(Fs[0]=0,Fs[1]=0,Fs[2]=0),function(){var a=new jo(4);jo!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0)}();var ef=(function(){var a=new jo(2);jo!=Float32Array&&(a[0]=0,a[1]=0)}(),function(a){function o(u){a.call(this,u,Qu)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.createBucket=function(u){return new Ba(u)},o.prototype.queryRadius=function(u){var d=u;return bu("circle-radius",this,d)+bu("circle-stroke-width",this,d)+ko(this.paint.get("circle-translate"))},o.prototype.queryIntersectsFeature=function(u,d,y,b,C,P,D,j){for(var X=Lu(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),P.angle,D),ee=this.paint.get("circle-radius").evaluate(d,y)+this.paint.get("circle-stroke-width").evaluate(d,y),te=this.paint.get("circle-pitch-alignment")==="map",Ee=te?X:function(Qr,nn){return Qr.map(function(Gn){return Dl(Gn,nn)})}(X,j),Le=te?ee*D:ee,Oe=0,We=b;Oe<We.length;Oe+=1)for(var Ze=0,yt=We[Oe];Ze<yt.length;Ze+=1){var Dt=yt[Ze],Xt=te?Dt:Dl(Dt,j),mr=Le,sr=$s([],[Dt.x,Dt.y,0,1],j);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?mr*=sr[3]/P.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(mr*=P.cameraToCenterDistance/sr[3]),ks(Ee,Xt,mr))return!0}return!1},o}(Iu));function Dl(a,o){var u=$s([],[a.x,a.y,0,1],o);return new se(u[0]/u[3],u[1]/u[3])}var mc=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o}(Ba);function Ju(a,o,u,d){var y=o.width,b=o.height;if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==y*b*u)throw new RangeError("mismatched image size")}else d=new Uint8Array(y*b*u);return a.width=y,a.height=b,a.data=d,a}function gl(a,o,u){var d=o.width,y=o.height;if(d!==a.width||y!==a.height){var b=Ju({},{width:d,height:y},u);Eu(a,b,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,d),height:Math.min(a.height,y)},u),a.width=d,a.height=y,a.data=b.data}}function Eu(a,o,u,d,y,b){if(y.width===0||y.height===0)return o;if(y.width>a.width||y.height>a.height||u.x>a.width-y.width||u.y>a.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>o.width||y.height>o.height||d.x>o.width-y.width||d.y>o.height-y.height)throw new RangeError("out of range destination coordinates for image copy");for(var C=a.data,P=o.data,D=0;D<y.height;D++)for(var j=((u.y+D)*a.width+u.x)*b,X=((d.y+D)*o.width+d.x)*b,ee=0;ee<y.width*b;ee++)P[X+ee]=C[j+ee];return o}Ln("HeatmapBucket",mc,{omit:["layers"]});var Bs=function(o,u){Ju(this,o,1,u)};Bs.prototype.resize=function(a){gl(this,a,1)},Bs.prototype.clone=function(){return new Bs({width:this.width,height:this.height},new Uint8Array(this.data))},Bs.copy=function(a,o,u,d,y){Eu(a,o,u,d,y,1)};var Qo=function(o,u){Ju(this,o,4,u)};Qo.prototype.resize=function(a){gl(this,a,4)},Qo.prototype.replace=function(a,o){o?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a},Qo.prototype.clone=function(){return new Qo({width:this.width,height:this.height},new Uint8Array(this.data))},Qo.copy=function(a,o,u,d,y){Eu(a,o,u,d,y,4)},Ln("AlphaImage",Bs),Ln("RGBAImage",Qo);var zh={paint:new $o({"heatmap-radius":new Yn(_e.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Yn(_e.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ni(_e.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ou(_e.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ni(_e.paint_heatmap["heatmap-opacity"])})};function Of(a){var o={},u=a.resolution||256,d=a.clips?a.clips.length:1,y=a.image||new Qo({width:u,height:d}),b=function(Oe,We,Ze){o[a.evaluationKey]=Ze;var yt=a.expression.evaluate(o);y.data[Oe+We+0]=Math.floor(255*yt.r/yt.a),y.data[Oe+We+1]=Math.floor(255*yt.g/yt.a),y.data[Oe+We+2]=Math.floor(255*yt.b/yt.a),y.data[Oe+We+3]=Math.floor(255*yt.a)};if(a.clips)for(var C=0,P=0;C<d;++C,P+=4*u)for(var D=0,j=0;D<u;D++,j+=4){var X=D/(u-1),ee=a.clips[C];b(P,j,ee.start*(1-X)+ee.end*X)}else for(var te=0,Ee=0;te<u;te++,Ee+=4)b(0,Ee,te/(u-1));return y}var gp=function(a){function o(u){a.call(this,u,zh),this._updateColorRamp()}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.createBucket=function(u){return new mc(u)},o.prototype._handleSpecialPaintPropertyUpdate=function(u){u==="heatmap-color"&&this._updateColorRamp()},o.prototype._updateColorRamp=function(){this.colorRamp=Of({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},o.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},o.prototype.queryRadius=function(){return 0},o.prototype.queryIntersectsFeature=function(){return!1},o.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},o}(Iu),yp={paint:new $o({"hillshade-illumination-direction":new ni(_e.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ni(_e.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ni(_e.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ni(_e.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ni(_e.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ni(_e.paint_hillshade["hillshade-accent-color"])})},If=function(a){function o(u){a.call(this,u,yp)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},o}(Iu),Rf=qo([{name:"a_pos",components:2,type:"Int16"}],4).members,gc=fh,uv=fh;function fh(a,o,u){u=u||2;var d,y,b,C,P,D,j,X=o&&o.length,ee=X?o[0]*u:a.length,te=_p(a,0,ee,u,!0),Ee=[];if(!te||te.next===te.prev)return Ee;if(X&&(te=function(Oe,We,Ze,yt){var Dt,Xt,mr,sr=[];for(Dt=0,Xt=We.length;Dt<Xt;Dt++)(mr=_p(Oe,We[Dt]*yt,Dt<Xt-1?We[Dt+1]*yt:Oe.length,yt,!1))===mr.next&&(mr.steiner=!0),sr.push(hv(mr));for(sr.sort(bp),Dt=0;Dt<sr.length;Dt++)cv(sr[Dt],Ze),Ze=Ql(Ze,Ze.next);return Ze}(a,o,te,u)),a.length>80*u){d=b=a[0],y=C=a[1];for(var Le=u;Le<ee;Le+=u)(P=a[Le])<d&&(d=P),(D=a[Le+1])<y&&(y=D),P>b&&(b=P),D>C&&(C=D);j=(j=Math.max(b-d,C-y))!==0?1/j:0}return kf(te,Ee,u,d,y,j),Ee}function _p(a,o,u,d,y){var b,C;if(y===rf(a,o,u,d)>0)for(b=o;b<u;b+=d)C=Bf(b,a[b],a[b+1],C);else for(b=u-d;b>=o;b-=d)C=Bf(b,a[b],a[b+1],C);return C&&Uh(C,C.next)&&(_c(C),C=C.next),C}function Ql(a,o){if(!a)return a;o||(o=a);var u,d=a;do if(u=!1,d.steiner||!Uh(d,d.next)&&Cr(d.prev,d,d.next)!==0)d=d.next;else{if(_c(d),(d=o=d.prev)===d.next)break;u=!0}while(u||d!==o);return o}function kf(a,o,u,d,y,b,C){if(a){!C&&b&&function(X,ee,te,Ee){var Le=X;do Le.z===null&&(Le.z=Ep(Le.x,Le.y,ee,te,Ee)),Le.prevZ=Le.prev,Le.nextZ=Le.next,Le=Le.next;while(Le!==X);Le.prevZ.nextZ=null,Le.prevZ=null,function(Oe){var We,Ze,yt,Dt,Xt,mr,sr,Qr,nn=1;do{for(Ze=Oe,Oe=null,Xt=null,mr=0;Ze;){for(mr++,yt=Ze,sr=0,We=0;We<nn&&(sr++,yt=yt.nextZ);We++);for(Qr=nn;sr>0||Qr>0&&yt;)sr!==0&&(Qr===0||!yt||Ze.z<=yt.z)?(Dt=Ze,Ze=Ze.nextZ,sr--):(Dt=yt,yt=yt.nextZ,Qr--),Xt?Xt.nextZ=Dt:Oe=Dt,Dt.prevZ=Xt,Xt=Dt;Ze=yt}Xt.nextZ=null,nn*=2}while(mr>1)}(Le)}(a,d,y,b);for(var P,D,j=a;a.prev!==a.next;)if(P=a.prev,D=a.next,b?xp(a,d,y,b):tf(a))o.push(P.i/u),o.push(a.i/u),o.push(D.i/u),_c(a),a=D.next,j=D.next;else if((a=D)===j){C?C===1?kf(a=lv(Ql(a),o,u),o,u,d,y,b,2):C===2&&pd(a,o,u,d,y,b):kf(Ql(a),o,u,d,y,b,1);break}}}function tf(a){var o=a.prev,u=a,d=a.next;if(Cr(o,u,d)>=0)return!1;for(var y=a.next.next;y!==a.prev;){if(Lf(o.x,o.y,u.x,u.y,d.x,d.y,y.x,y.y)&&Cr(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function xp(a,o,u,d){var y=a.prev,b=a,C=a.next;if(Cr(y,b,C)>=0)return!1;for(var P=y.x>b.x?y.x>C.x?y.x:C.x:b.x>C.x?b.x:C.x,D=y.y>b.y?y.y>C.y?y.y:C.y:b.y>C.y?b.y:C.y,j=Ep(y.x<b.x?y.x<C.x?y.x:C.x:b.x<C.x?b.x:C.x,y.y<b.y?y.y<C.y?y.y:C.y:b.y<C.y?b.y:C.y,o,u,d),X=Ep(P,D,o,u,d),ee=a.prevZ,te=a.nextZ;ee&&ee.z>=j&&te&&te.z<=X;){if(ee!==a.prev&&ee!==a.next&&Lf(y.x,y.y,b.x,b.y,C.x,C.y,ee.x,ee.y)&&Cr(ee.prev,ee,ee.next)>=0||(ee=ee.prevZ,te!==a.prev&&te!==a.next&&Lf(y.x,y.y,b.x,b.y,C.x,C.y,te.x,te.y)&&Cr(te.prev,te,te.next)>=0))return!1;te=te.nextZ}for(;ee&&ee.z>=j;){if(ee!==a.prev&&ee!==a.next&&Lf(y.x,y.y,b.x,b.y,C.x,C.y,ee.x,ee.y)&&Cr(ee.prev,ee,ee.next)>=0)return!1;ee=ee.prevZ}for(;te&&te.z<=X;){if(te!==a.prev&&te!==a.next&&Lf(y.x,y.y,b.x,b.y,C.x,C.y,te.x,te.y)&&Cr(te.prev,te,te.next)>=0)return!1;te=te.nextZ}return!0}function lv(a,o,u){var d=a;do{var y=d.prev,b=d.next.next;!Uh(y,b)&&dd(y,d,d.next,b)&&yc(y,b)&&yc(b,y)&&(o.push(y.i/u),o.push(d.i/u),o.push(b.i/u),_c(d),_c(d.next),d=a=b),d=d.next}while(d!==a);return Ql(d)}function pd(a,o,u,d,y,b){var C=a;do{for(var P=C.next.next;P!==C.prev;){if(C.i!==P.i&&pm(C,P)){var D=Ff(C,P);return C=Ql(C,C.next),D=Ql(D,D.next),kf(C,o,u,d,y,b),void kf(D,o,u,d,y,b)}P=P.next}C=C.next}while(C!==a)}function bp(a,o){return a.x-o.x}function cv(a,o){if(o=function(d,y){var b,C=y,P=d.x,D=d.y,j=-1/0;do{if(D<=C.y&&D>=C.next.y&&C.next.y!==C.y){var X=C.x+(D-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(X<=P&&X>j){if(j=X,X===P){if(D===C.y)return C;if(D===C.next.y)return C.next}b=C.x<C.next.x?C:C.next}}C=C.next}while(C!==y);if(!b)return null;if(P===j)return b;var ee,te=b,Ee=b.x,Le=b.y,Oe=1/0;C=b;do P>=C.x&&C.x>=Ee&&P!==C.x&&Lf(D<Le?P:j,D,Ee,Le,D<Le?j:P,D,C.x,C.y)&&(ee=Math.abs(D-C.y)/(P-C.x),yc(C,d)&&(ee<Oe||ee===Oe&&(C.x>b.x||C.x===b.x&&fv(b,C)))&&(b=C,Oe=ee)),C=C.next;while(C!==te);return b}(a,o)){var u=Ff(o,a);Ql(o,o.next),Ql(u,u.next)}}function fv(a,o){return Cr(a.prev,a,o.prev)<0&&Cr(o.next,a,a.next)<0}function Ep(a,o,u,d,y){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-u)*y)|a<<8))|a<<4))|a<<2))|a<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-d)*y)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function hv(a){var o=a,u=a;do(o.x<u.x||o.x===u.x&&o.y<u.y)&&(u=o),o=o.next;while(o!==a);return u}function Lf(a,o,u,d,y,b,C,P){return(y-C)*(o-P)-(a-C)*(b-P)>=0&&(a-C)*(d-P)-(u-C)*(o-P)>=0&&(u-C)*(b-P)-(y-C)*(d-P)>=0}function pm(a,o){return a.next.i!==o.i&&a.prev.i!==o.i&&!function(u,d){var y=u;do{if(y.i!==u.i&&y.next.i!==u.i&&y.i!==d.i&&y.next.i!==d.i&&dd(y,y.next,u,d))return!0;y=y.next}while(y!==u);return!1}(a,o)&&(yc(a,o)&&yc(o,a)&&function(u,d){var y=u,b=!1,C=(u.x+d.x)/2,P=(u.y+d.y)/2;do y.y>P!=y.next.y>P&&y.next.y!==y.y&&C<(y.next.x-y.x)*(P-y.y)/(y.next.y-y.y)+y.x&&(b=!b),y=y.next;while(y!==u);return b}(a,o)&&(Cr(a.prev,a,o.prev)||Cr(a,o.prev,o))||Uh(a,o)&&Cr(a.prev,a,a.next)>0&&Cr(o.prev,o,o.next)>0)}function Cr(a,o,u){return(o.y-a.y)*(u.x-o.x)-(o.x-a.x)*(u.y-o.y)}function Uh(a,o){return a.x===o.x&&a.y===o.y}function dd(a,o,u,d){var y=Df(Cr(a,o,u)),b=Df(Cr(a,o,d)),C=Df(Cr(u,d,a)),P=Df(Cr(u,d,o));return y!==b&&C!==P||!(y!==0||!Kt(a,u,o))||!(b!==0||!Kt(a,d,o))||!(C!==0||!Kt(u,a,d))||!(P!==0||!Kt(u,o,d))}function Kt(a,o,u){return o.x<=Math.max(a.x,u.x)&&o.x>=Math.min(a.x,u.x)&&o.y<=Math.max(a.y,u.y)&&o.y>=Math.min(a.y,u.y)}function Df(a){return a>0?1:a<0?-1:0}function yc(a,o){return Cr(a.prev,a,a.next)<0?Cr(a,o,a.next)>=0&&Cr(a,a.prev,o)>=0:Cr(a,o,a.prev)<0||Cr(a,a.next,o)<0}function Ff(a,o){var u=new Nf(a.i,a.x,a.y),d=new Nf(o.i,o.x,o.y),y=a.next,b=o.prev;return a.next=o,o.prev=a,u.next=y,y.prev=u,d.next=u,u.prev=d,b.next=d,d.prev=b,d}function Bf(a,o,u,d){var y=new Nf(a,o,u);return d?(y.next=d.next,y.prev=d,d.next.prev=y,d.next=y):(y.prev=y,y.next=y),y}function _c(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Nf(a,o,u){this.i=a,this.x=o,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function rf(a,o,u,d){for(var y=0,b=o,C=u-d;b<u;b+=d)y+=(a[C]-a[b])*(a[b+1]+a[C+1]),C=b;return y}function xc(a,o,u,d,y){(function b(C,P,D,j,X){for(;j>D;){if(j-D>600){var ee=j-D+1,te=P-D+1,Ee=Math.log(ee),Le=.5*Math.exp(2*Ee/3),Oe=.5*Math.sqrt(Ee*Le*(ee-Le)/ee)*(te-ee/2<0?-1:1);b(C,P,Math.max(D,Math.floor(P-te*Le/ee+Oe)),Math.min(j,Math.floor(P+(ee-te)*Le/ee+Oe)),X)}var We=C[P],Ze=D,yt=j;for(nf(C,D,P),X(C[j],We)>0&&nf(C,D,j);Ze<yt;){for(nf(C,Ze,yt),Ze++,yt--;X(C[Ze],We)<0;)Ze++;for(;X(C[yt],We)>0;)yt--}X(C[D],We)===0?nf(C,D,yt):nf(C,++yt,j),yt<=P&&(D=yt+1),P<=yt&&(j=yt-1)}})(a,o,u||0,d||a.length-1,y||jh)}function nf(a,o,u){var d=a[o];a[o]=a[u],a[u]=d}function jh(a,o){return a<o?-1:a>o?1:0}function af(a,o){var u=a.length;if(u<=1)return[a];for(var d,y,b=[],C=0;C<u;C++){var P=Mr(a[C]);P!==0&&(a[C].area=Math.abs(P),y===void 0&&(y=P<0),y===P<0?(d&&b.push(d),d=[a[C]]):d.push(a[C]))}if(d&&b.push(d),o>1)for(var D=0;D<b.length;D++)b[D].length<=o||(xc(b[D],o,1,b[D].length-1,hh),b[D]=b[D].slice(0,o));return b}function hh(a,o){return o.area-a.area}function bc(a,o,u){for(var d=u.patternDependencies,y=!1,b=0,C=o;b<C.length;b+=1){var P=C[b].paint.get(a+"-pattern");P.isConstant()||(y=!0);var D=P.constantOr(null);D&&(y=!0,d[D.to]=!0,d[D.from]=!0)}return y}function Ec(a,o,u,d,y){for(var b=y.patternDependencies,C=0,P=o;C<P.length;C+=1){var D=P[C],j=D.paint.get(a+"-pattern").value;if(j.kind!=="constant"){var X=j.evaluate({zoom:d-1},u,{},y.availableImages),ee=j.evaluate({zoom:d},u,{},y.availableImages),te=j.evaluate({zoom:d+1},u,{},y.availableImages);ee=ee&&ee.name?ee.name:ee,te=te&&te.name?te.name:te,b[X=X&&X.name?X.name:X]=!0,b[ee]=!0,b[te]=!0,u.patterns[D.id]={min:X,mid:ee,max:te}}}return u}fh.deviation=function(a,o,u,d){var y=o&&o.length,b=Math.abs(rf(a,0,y?o[0]*u:a.length,u));if(y)for(var C=0,P=o.length;C<P;C++)b-=Math.abs(rf(a,o[C]*u,C<P-1?o[C+1]*u:a.length,u));var D=0;for(C=0;C<d.length;C+=3){var j=d[C]*u,X=d[C+1]*u,ee=d[C+2]*u;D+=Math.abs((a[j]-a[ee])*(a[X+1]-a[j+1])-(a[j]-a[X])*(a[ee+1]-a[j+1]))}return b===0&&D===0?0:Math.abs((D-b)/b)},fh.flatten=function(a){for(var o=a[0][0].length,u={vertices:[],holes:[],dimensions:o},d=0,y=0;y<a.length;y++){for(var b=0;b<a[y].length;b++)for(var C=0;C<o;C++)u.vertices.push(a[y][b][C]);y>0&&u.holes.push(d+=a[y-1].length)}return u},gc.default=uv;var Js=function(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ru,this.indexArray=new pl,this.indexArray2=new Rs,this.programConfigurations=new Di(o.layers,o.zoom),this.segments=new ve,this.segments2=new ve,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Js.prototype.populate=function(a,o,u){this.hasPattern=bc("fill",this.layers,o);for(var d=this.layers[0].layout.get("fill-sort-key"),y=[],b=0,C=a;b<C.length;b+=1){var P=C[b],D=P.feature,j=P.id,X=P.index,ee=P.sourceLayerIndex,te=this.layers[0]._featureFilter.needGeometry,Ee=no(D,te);if(this.layers[0]._featureFilter.filter(new Wi(this.zoom),Ee,u)){var Le=d?d.evaluate(Ee,{},u,o.availableImages):void 0,Oe={id:j,properties:D.properties,type:D.type,sourceLayerIndex:ee,index:X,geometry:te?Ee.geometry:Za(D),patterns:{},sortKey:Le};y.push(Oe)}}d&&y.sort(function(Qr,nn){return Qr.sortKey-nn.sortKey});for(var We=0,Ze=y;We<Ze.length;We+=1){var yt=Ze[We],Dt=yt.geometry,Xt=yt.index,mr=yt.sourceLayerIndex;if(this.hasPattern){var sr=Ec("fill",this.layers,yt,this.zoom,o);this.patternFeatures.push(sr)}else this.addFeature(yt,Dt,Xt,u,{});o.featureIndex.insert(a[Xt].feature,Dt,Xt,mr,this.index)}},Js.prototype.update=function(a,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,o,this.stateDependentLayers,u)},Js.prototype.addFeatures=function(a,o,u){for(var d=0,y=this.patternFeatures;d<y.length;d+=1){var b=y[d];this.addFeature(b,b.geometry,b.index,o,u)}},Js.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Js.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Js.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Rf),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0},Js.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Js.prototype.addFeature=function(a,o,u,d,y){for(var b=0,C=af(o,500);b<C.length;b+=1){for(var P=C[b],D=0,j=0,X=P;j<X.length;j+=1)D+=X[j].length;for(var ee=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray),te=ee.vertexLength,Ee=[],Le=[],Oe=0,We=P;Oe<We.length;Oe+=1){var Ze=We[Oe];if(Ze.length!==0){Ze!==P[0]&&Le.push(Ee.length/2);var yt=this.segments2.prepareSegment(Ze.length,this.layoutVertexArray,this.indexArray2),Dt=yt.vertexLength;this.layoutVertexArray.emplaceBack(Ze[0].x,Ze[0].y),this.indexArray2.emplaceBack(Dt+Ze.length-1,Dt),Ee.push(Ze[0].x),Ee.push(Ze[0].y);for(var Xt=1;Xt<Ze.length;Xt++)this.layoutVertexArray.emplaceBack(Ze[Xt].x,Ze[Xt].y),this.indexArray2.emplaceBack(Dt+Xt-1,Dt+Xt),Ee.push(Ze[Xt].x),Ee.push(Ze[Xt].y);yt.vertexLength+=Ze.length,yt.primitiveLength+=Ze.length}}for(var mr=gc(Ee,Le),sr=0;sr<mr.length;sr+=3)this.indexArray.emplaceBack(te+mr[sr],te+mr[sr+1],te+mr[sr+2]);ee.vertexLength+=D,ee.primitiveLength+=mr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,u,y,d)},Ln("FillBucket",Js,{omit:["layers","patternFeatures"]});var ph=new $o({"fill-sort-key":new Yn(_e.layout_fill["fill-sort-key"])}),zf={paint:new $o({"fill-antialias":new ni(_e.paint_fill["fill-antialias"]),"fill-opacity":new Yn(_e.paint_fill["fill-opacity"]),"fill-color":new Yn(_e.paint_fill["fill-color"]),"fill-outline-color":new Yn(_e.paint_fill["fill-outline-color"]),"fill-translate":new ni(_e.paint_fill["fill-translate"]),"fill-translate-anchor":new ni(_e.paint_fill["fill-translate-anchor"]),"fill-pattern":new pc(_e.paint_fill["fill-pattern"])}),layout:ph},Vh=function(a){function o(u){a.call(this,u,zf)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.recalculate=function(u,d){a.prototype.recalculate.call(this,u,d);var y=this.paint._values["fill-outline-color"];y.value.kind==="constant"&&y.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},o.prototype.createBucket=function(u){return new Js(u)},o.prototype.queryRadius=function(){return ko(this.paint.get("fill-translate"))},o.prototype.queryIntersectsFeature=function(u,d,y,b,C,P,D){return bs(Lu(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),P.angle,D),b)},o.prototype.isTileClipped=function(){return!0},o}(Iu),of=qo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Sc=sf;function sf(a,o,u,d,y){this.properties={},this.extent=u,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=y,a.readFields(Sp,this,o)}function Sp(a,o,u){a==1?o.id=u.readVarint():a==2?function(d,y){for(var b=d.readVarint()+d.pos;d.pos<b;){var C=y._keys[d.readVarint()],P=y._values[d.readVarint()];y.properties[C]=P}}(u,o):a==3?o.type=u.readVarint():a==4&&(o._geometry=u.pos)}function pv(a){for(var o,u,d=0,y=0,b=a.length,C=b-1;y<b;C=y++)d+=((u=a[C]).x-(o=a[y]).x)*(o.y+u.y);return d}sf.types=["Unknown","Point","LineString","Polygon"],sf.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var o,u=a.readVarint()+a.pos,d=1,y=0,b=0,C=0,P=[];a.pos<u;){if(y<=0){var D=a.readVarint();d=7&D,y=D>>3}if(y--,d===1||d===2)b+=a.readSVarint(),C+=a.readSVarint(),d===1&&(o&&P.push(o),o=[]),o.push(new se(b,C));else{if(d!==7)throw new Error("unknown command "+d);o&&o.push(o[0].clone())}}return o&&P.push(o),P},sf.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var o=a.readVarint()+a.pos,u=1,d=0,y=0,b=0,C=1/0,P=-1/0,D=1/0,j=-1/0;a.pos<o;){if(d<=0){var X=a.readVarint();u=7&X,d=X>>3}if(d--,u===1||u===2)(y+=a.readSVarint())<C&&(C=y),y>P&&(P=y),(b+=a.readSVarint())<D&&(D=b),b>j&&(j=b);else if(u!==7)throw new Error("unknown command "+u)}return[C,D,P,j]},sf.prototype.toGeoJSON=function(a,o,u){var d,y,b=this.extent*Math.pow(2,u),C=this.extent*a,P=this.extent*o,D=this.loadGeometry(),j=sf.types[this.type];function X(Ee){for(var Le=0;Le<Ee.length;Le++){var Oe=Ee[Le];Ee[Le]=[360*(Oe.x+C)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(Oe.y+P)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var ee=[];for(d=0;d<D.length;d++)ee[d]=D[d][0];X(D=ee);break;case 2:for(d=0;d<D.length;d++)X(D[d]);break;case 3:for(D=function(Ee){var Le=Ee.length;if(Le<=1)return[Ee];for(var Oe,We,Ze=[],yt=0;yt<Le;yt++){var Dt=pv(Ee[yt]);Dt!==0&&(We===void 0&&(We=Dt<0),We===Dt<0?(Oe&&Ze.push(Oe),Oe=[Ee[yt]]):Oe.push(Ee[yt]))}return Oe&&Ze.push(Oe),Ze}(D),d=0;d<D.length;d++)for(y=0;y<D[d].length;y++)X(D[d][y])}D.length===1?D=D[0]:j="Multi"+j;var te={type:"Feature",geometry:{type:j,coordinates:D},properties:this.properties};return"id"in this&&(te.id=this.id),te};var vd=md;function md(a,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Cc,this,o),this.length=this._features.length}function Cc(a,o,u){a===15?o.version=u.readVarint():a===1?o.name=u.readString():a===5?o.extent=u.readVarint():a===2?o._features.push(u.pos):a===3?o._keys.push(u.readString()):a===4&&o._values.push(function(d){for(var y=null,b=d.readVarint()+d.pos;d.pos<b;){var C=d.readVarint()>>3;y=C===1?d.readString():C===2?d.readFloat():C===3?d.readDouble():C===4?d.readVarint64():C===5?d.readVarint():C===6?d.readSVarint():C===7?d.readBoolean():null}return y}(u))}function Cp(a,o,u){if(a===3){var d=new vd(u,u.readVarint()+u.pos);d.length&&(o[d.name]=d)}}md.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var o=this._pbf.readVarint()+this._pbf.pos;return new Sc(this._pbf,o,this.extent,this._keys,this._values)};var uf={VectorTile:function(o,u){this.layers=o.readFields(Cp,{},u)},VectorTileFeature:Sc,VectorTileLayer:vd},Ap=uf.VectorTileFeature.types,wp=Math.pow(2,13);function dh(a,o,u,d,y,b,C,P){a.emplaceBack(o,u,2*Math.floor(d*wp)+C,y*wp*2,b*wp*2,Math.round(P))}var yl=function(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new mu,this.indexArray=new pl,this.programConfigurations=new Di(o.layers,o.zoom),this.segments=new ve,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};function _l(a,o){return a.x===o.x&&(a.x<0||a.x>8192)||a.y===o.y&&(a.y<0||a.y>8192)}yl.prototype.populate=function(a,o,u){this.features=[],this.hasPattern=bc("fill-extrusion",this.layers,o);for(var d=0,y=a;d<y.length;d+=1){var b=y[d],C=b.feature,P=b.id,D=b.index,j=b.sourceLayerIndex,X=this.layers[0]._featureFilter.needGeometry,ee=no(C,X);if(this.layers[0]._featureFilter.filter(new Wi(this.zoom),ee,u)){var te={id:P,sourceLayerIndex:j,index:D,geometry:X?ee.geometry:Za(C),properties:C.properties,type:C.type,patterns:{}};this.hasPattern?this.features.push(Ec("fill-extrusion",this.layers,te,this.zoom,o)):this.addFeature(te,te.geometry,D,u,{}),o.featureIndex.insert(C,te.geometry,D,j,this.index,!0)}}},yl.prototype.addFeatures=function(a,o,u){for(var d=0,y=this.features;d<y.length;d+=1){var b=y[d];this.addFeature(b,b.geometry,b.index,o,u)}},yl.prototype.update=function(a,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,o,this.stateDependentLayers,u)},yl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},yl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},yl.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,of),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},yl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},yl.prototype.addFeature=function(a,o,u,d,y){for(var b=0,C=af(o,500);b<C.length;b+=1){for(var P=C[b],D=0,j=0,X=P;j<X.length;j+=1)D+=X[j].length;for(var ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),te=0,Ee=P;te<Ee.length;te+=1){var Le=Ee[te];if(Le.length!==0&&!((na=Le).every(function(ki){return ki.x<0})||na.every(function(ki){return ki.x>8192})||na.every(function(ki){return ki.y<0})||na.every(function(ki){return ki.y>8192})))for(var Oe=0,We=0;We<Le.length;We++){var Ze=Le[We];if(We>=1){var yt=Le[We-1];if(!_l(Ze,yt)){ee.vertexLength+4>ve.MAX_VERTEX_ARRAY_LENGTH&&(ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Dt=Ze.sub(yt)._perp()._unit(),Xt=yt.dist(Ze);Oe+Xt>32768&&(Oe=0),dh(this.layoutVertexArray,Ze.x,Ze.y,Dt.x,Dt.y,0,0,Oe),dh(this.layoutVertexArray,Ze.x,Ze.y,Dt.x,Dt.y,0,1,Oe),dh(this.layoutVertexArray,yt.x,yt.y,Dt.x,Dt.y,0,0,Oe+=Xt),dh(this.layoutVertexArray,yt.x,yt.y,Dt.x,Dt.y,0,1,Oe);var mr=ee.vertexLength;this.indexArray.emplaceBack(mr,mr+2,mr+1),this.indexArray.emplaceBack(mr+1,mr+2,mr+3),ee.vertexLength+=4,ee.primitiveLength+=2}}}}if(ee.vertexLength+D>ve.MAX_VERTEX_ARRAY_LENGTH&&(ee=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray)),Ap[a.type]==="Polygon"){for(var sr=[],Qr=[],nn=ee.vertexLength,Gn=0,ei=P;Gn<ei.length;Gn+=1){var $n=ei[Gn];if($n.length!==0){$n!==P[0]&&Qr.push(sr.length/2);for(var Bn=0;Bn<$n.length;Bn++){var Ti=$n[Bn];dh(this.layoutVertexArray,Ti.x,Ti.y,0,0,1,1,0),sr.push(Ti.x),sr.push(Ti.y)}}}for(var ui=gc(sr,Qr),ti=0;ti<ui.length;ti+=3)this.indexArray.emplaceBack(nn+ui[ti],nn+ui[ti+2],nn+ui[ti+1]);ee.primitiveLength+=ui.length/3,ee.vertexLength+=D}}var na;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,u,y,d)},Ln("FillExtrusionBucket",yl,{omit:["layers","features"]});var Tp={paint:new $o({"fill-extrusion-opacity":new ni(_e["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Yn(_e["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ni(_e["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ni(_e["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new pc(_e["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Yn(_e["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Yn(_e["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ni(_e["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Uf=function(a){function o(u){a.call(this,u,Tp)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.createBucket=function(u){return new yl(u)},o.prototype.queryRadius=function(){return ko(this.paint.get("fill-extrusion-translate"))},o.prototype.is3D=function(){return!0},o.prototype.queryIntersectsFeature=function(u,d,y,b,C,P,D,j){var X=Lu(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),P.angle,D),ee=this.paint.get("fill-extrusion-height").evaluate(d,y),te=this.paint.get("fill-extrusion-base").evaluate(d,y),Ee=function(Oe,We,Ze,yt){for(var Dt=[],Xt=0,mr=Oe;Xt<mr.length;Xt+=1){var sr=mr[Xt],Qr=[sr.x,sr.y,0,1];$s(Qr,Qr,We),Dt.push(new se(Qr[0]/Qr[3],Qr[1]/Qr[3]))}return Dt}(X,j),Le=function(Oe,We,Ze,yt){for(var Dt=[],Xt=[],mr=yt[8]*We,sr=yt[9]*We,Qr=yt[10]*We,nn=yt[11]*We,Gn=yt[8]*Ze,ei=yt[9]*Ze,$n=yt[10]*Ze,Bn=yt[11]*Ze,Ti=0,ui=Oe;Ti<ui.length;Ti+=1){for(var ti=[],na=[],ki=0,xa=ui[Ti];ki<xa.length;ki+=1){var gi=xa[ki],ua=gi.x,qa=gi.y,Xa=yt[0]*ua+yt[4]*qa+yt[12],lo=yt[1]*ua+yt[5]*qa+yt[13],co=yt[2]*ua+yt[6]*qa+yt[14],Ao=yt[3]*ua+yt[7]*qa+yt[15],zs=co+Qr,Fo=Ao+nn,eu=Xa+Gn,Cs=lo+ei,tu=co+$n,ds=Ao+Bn,ns=new se((Xa+mr)/Fo,(lo+sr)/Fo);ns.z=zs/Fo,ti.push(ns);var is=new se(eu/ds,Cs/ds);is.z=tu/ds,na.push(is)}Dt.push(ti),Xt.push(na)}return[Dt,Xt]}(b,te,ee,j);return function(Oe,We,Ze){var yt=1/0;bs(Ze,We)&&(yt=Gh(Ze,We[0]));for(var Dt=0;Dt<We.length;Dt++)for(var Xt=We[Dt],mr=Oe[Dt],sr=0;sr<Xt.length-1;sr++){var Qr=Xt[sr],nn=[Qr,Xt[sr+1],mr[sr+1],mr[sr],Qr];vl(Ze,nn)&&(yt=Math.min(yt,Gh(Ze,nn)))}return yt!==1/0&&yt}(Le[0],Le[1],Ee)},o}(Iu);function Du(a,o){return a.x*o.x+a.y*o.y}function Gh(a,o){if(a.length===1){for(var u,d=0,y=o[d++];!u||y.equals(u);)if(!(u=o[d++]))return 1/0;for(;d<o.length;d++){var b=o[d],C=a[0],P=u.sub(y),D=b.sub(y),j=C.sub(y),X=Du(P,P),ee=Du(P,D),te=Du(D,D),Ee=Du(j,P),Le=Du(j,D),Oe=X*te-ee*ee,We=(te*Ee-ee*Le)/Oe,Ze=(X*Le-ee*Ee)/Oe,yt=y.z*(1-We-Ze)+u.z*We+b.z*Ze;if(isFinite(yt))return yt}return 1/0}for(var Dt=1/0,Xt=0,mr=o;Xt<mr.length;Xt+=1)Dt=Math.min(Dt,mr[Xt].z);return Dt}var Mp=qo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Hh=qo([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,gd=uf.VectorTileFeature.types,Jo=Math.cos(Math.PI/180*37.5),Fu=Math.pow(2,14)/.5,va=function(o){var u=this;this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(d){u.gradients[d.id]={}}),this.layoutVertexArray=new Ys,this.layoutVertexArray2=new Yl,this.indexArray=new pl,this.programConfigurations=new Di(o.layers,o.zoom),this.segments=new ve,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};va.prototype.populate=function(a,o,u){this.hasPattern=bc("line",this.layers,o);for(var d=this.layers[0].layout.get("line-sort-key"),y=[],b=0,C=a;b<C.length;b+=1){var P=C[b],D=P.feature,j=P.id,X=P.index,ee=P.sourceLayerIndex,te=this.layers[0]._featureFilter.needGeometry,Ee=no(D,te);if(this.layers[0]._featureFilter.filter(new Wi(this.zoom),Ee,u)){var Le=d?d.evaluate(Ee,{},u):void 0,Oe={id:j,properties:D.properties,type:D.type,sourceLayerIndex:ee,index:X,geometry:te?Ee.geometry:Za(D),patterns:{},sortKey:Le};y.push(Oe)}}d&&y.sort(function(Qr,nn){return Qr.sortKey-nn.sortKey});for(var We=0,Ze=y;We<Ze.length;We+=1){var yt=Ze[We],Dt=yt.geometry,Xt=yt.index,mr=yt.sourceLayerIndex;if(this.hasPattern){var sr=Ec("line",this.layers,yt,this.zoom,o);this.patternFeatures.push(sr)}else this.addFeature(yt,Dt,Xt,u,{});o.featureIndex.insert(a[Xt].feature,Dt,Xt,mr,this.index)}},va.prototype.update=function(a,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,o,this.stateDependentLayers,u)},va.prototype.addFeatures=function(a,o,u){for(var d=0,y=this.patternFeatures;d<y.length;d+=1){var b=y[d];this.addFeature(b,b.geometry,b.index,o,u)}},va.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},va.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},va.prototype.upload=function(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,Hh)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Mp),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},va.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},va.prototype.lineFeatureClips=function(a){if(a.properties&&a.properties.hasOwnProperty("mapbox_clip_start")&&a.properties.hasOwnProperty("mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}},va.prototype.addFeature=function(a,o,u,d,y){var b=this.layers[0].layout,C=b.get("line-join").evaluate(a,{}),P=b.get("line-cap"),D=b.get("line-miter-limit"),j=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(var X=0,ee=o;X<ee.length;X+=1)this.addLine(ee[X],a,C,P,D,j);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,u,y,d)},va.prototype.addLine=function(a,o,u,d,y,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var C=0;C<a.length-1;C++)this.totalDistance+=a[C].dist(a[C+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var P=gd[o.type]==="Polygon",D=a.length;D>=2&&a[D-1].equals(a[D-2]);)D--;for(var j=0;j<D-1&&a[j].equals(a[j+1]);)j++;if(!(D<(P?3:2))){u==="bevel"&&(y=1.05);var X,ee=this.overscaling<=16?122880/(512*this.overscaling):0,te=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray),Ee=void 0,Le=void 0,Oe=void 0,We=void 0;this.e1=this.e2=-1,P&&(We=a[j].sub(X=a[D-2])._unit()._perp());for(var Ze=j;Ze<D;Ze++)if(!(Le=Ze===D-1?P?a[j+1]:void 0:a[Ze+1])||!a[Ze].equals(Le)){We&&(Oe=We),X&&(Ee=X),X=a[Ze],We=Le?Le.sub(X)._unit()._perp():Oe;var yt=(Oe=Oe||We).add(We);yt.x===0&&yt.y===0||yt._unit();var Dt=Oe.x*We.x+Oe.y*We.y,Xt=yt.x*We.x+yt.y*We.y,mr=Xt!==0?1/Xt:1/0,sr=2*Math.sqrt(2-2*Xt),Qr=Xt<Jo&&Ee&&Le,nn=Oe.x*We.y-Oe.y*We.x>0;if(Qr&&Ze>j){var Gn=X.dist(Ee);if(Gn>2*ee){var ei=X.sub(X.sub(Ee)._mult(ee/Gn)._round());this.updateDistance(Ee,ei),this.addCurrentVertex(ei,Oe,0,0,te),Ee=ei}}var $n=Ee&&Le,Bn=$n?u:P?"butt":d;if($n&&Bn==="round"&&(mr<b?Bn="miter":mr<=2&&(Bn="fakeround")),Bn==="miter"&&mr>y&&(Bn="bevel"),Bn==="bevel"&&(mr>2&&(Bn="flipbevel"),mr<y&&(Bn="miter")),Ee&&this.updateDistance(Ee,X),Bn==="miter")yt._mult(mr),this.addCurrentVertex(X,yt,0,0,te);else if(Bn==="flipbevel"){if(mr>100)yt=We.mult(-1);else{var Ti=mr*Oe.add(We).mag()/Oe.sub(We).mag();yt._perp()._mult(Ti*(nn?-1:1))}this.addCurrentVertex(X,yt,0,0,te),this.addCurrentVertex(X,yt.mult(-1),0,0,te)}else if(Bn==="bevel"||Bn==="fakeround"){var ui=-Math.sqrt(mr*mr-1),ti=nn?ui:0,na=nn?0:ui;if(Ee&&this.addCurrentVertex(X,Oe,ti,na,te),Bn==="fakeround")for(var ki=Math.round(180*sr/Math.PI/20),xa=1;xa<ki;xa++){var gi=xa/ki;if(gi!==.5){var ua=gi-.5;gi+=gi*ua*(gi-1)*((1.0904+Dt*(Dt*(3.55645-1.43519*Dt)-3.2452))*ua*ua+(.848013+Dt*(.215638*Dt-1.06021)))}var qa=We.sub(Oe)._mult(gi)._add(Oe)._unit()._mult(nn?-1:1);this.addHalfVertex(X,qa.x,qa.y,!1,nn,0,te)}Le&&this.addCurrentVertex(X,We,-ti,-na,te)}else if(Bn==="butt")this.addCurrentVertex(X,yt,0,0,te);else if(Bn==="square"){var Xa=Ee?1:-1;this.addCurrentVertex(X,yt,Xa,Xa,te)}else Bn==="round"&&(Ee&&(this.addCurrentVertex(X,Oe,0,0,te),this.addCurrentVertex(X,Oe,1,1,te,!0)),Le&&(this.addCurrentVertex(X,We,-1,-1,te,!0),this.addCurrentVertex(X,We,0,0,te)));if(Qr&&Ze<D-1){var lo=X.dist(Le);if(lo>2*ee){var co=X.add(Le.sub(X)._mult(ee/lo)._round());this.updateDistance(X,co),this.addCurrentVertex(co,We,0,0,te),X=co}}}}},va.prototype.addCurrentVertex=function(a,o,u,d,y,b){b===void 0&&(b=!1);var C=o.y*d-o.x,P=-o.y-o.x*d;this.addHalfVertex(a,o.x+o.y*u,o.y-o.x*u,b,!1,u,y),this.addHalfVertex(a,C,P,b,!0,-d,y),this.distance>Fu/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(a,o,u,d,y,b))},va.prototype.addHalfVertex=function(a,o,u,d,y,b,C){var P=.5*(this.lineClips?this.scaledDistance*(Fu-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a.x<<1)+(d?1:0),(a.y<<1)+(y?1:0),Math.round(63*o)+128,Math.round(63*u)+128,1+(b===0?0:b<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var D=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),C.primitiveLength++),y?this.e2=D:this.e1=D},va.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},va.prototype.updateDistance=function(a,o){this.distance+=a.dist(o),this.updateScaledDistance()},Ln("LineBucket",va,{omit:["layers","patternFeatures"]});var Zi=new $o({"line-cap":new ni(_e.layout_line["line-cap"]),"line-join":new Yn(_e.layout_line["line-join"]),"line-miter-limit":new ni(_e.layout_line["line-miter-limit"]),"line-round-limit":new ni(_e.layout_line["line-round-limit"]),"line-sort-key":new Yn(_e.layout_line["line-sort-key"])}),go={paint:new $o({"line-opacity":new Yn(_e.paint_line["line-opacity"]),"line-color":new Yn(_e.paint_line["line-color"]),"line-translate":new ni(_e.paint_line["line-translate"]),"line-translate-anchor":new ni(_e.paint_line["line-translate-anchor"]),"line-width":new Yn(_e.paint_line["line-width"]),"line-gap-width":new Yn(_e.paint_line["line-gap-width"]),"line-offset":new Yn(_e.paint_line["line-offset"]),"line-blur":new Yn(_e.paint_line["line-blur"]),"line-dasharray":new So(_e.paint_line["line-dasharray"]),"line-pattern":new pc(_e.paint_line["line-pattern"]),"line-gradient":new Ou(_e.paint_line["line-gradient"])}),layout:Zi},Ac=new(function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.possiblyEvaluate=function(u,d){return d=new Wi(Math.floor(d.zoom),{now:d.now,fadeDuration:d.fadeDuration,zoomHistory:d.zoomHistory,transition:d.transition}),a.prototype.possiblyEvaluate.call(this,u,d)},o.prototype.evaluate=function(u,d,y,b){return d=Be({},d,{zoom:Math.floor(d.zoom)}),a.prototype.evaluate.call(this,u,d,y,b)},o}(Yn))(go.paint.properties["line-width"].specification);Ac.useIntegerZoom=!0;var dm=function(a){function o(u){a.call(this,u,go),this.gradientVersion=0}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._handleSpecialPaintPropertyUpdate=function(u){u==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ca,this.gradientVersion=(this.gradientVersion+1)%st)},o.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},o.prototype.recalculate=function(u,d){a.prototype.recalculate.call(this,u,d),this.paint._values["line-floorwidth"]=Ac.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)},o.prototype.createBucket=function(u){return new va(u)},o.prototype.queryRadius=function(u){var d=u,y=yd(bu("line-width",this,d),bu("line-gap-width",this,d)),b=bu("line-offset",this,d);return y/2+Math.abs(b)+ko(this.paint.get("line-translate"))},o.prototype.queryIntersectsFeature=function(u,d,y,b,C,P,D){var j=Lu(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),P.angle,D),X=D/2*yd(this.paint.get("line-width").evaluate(d,y),this.paint.get("line-gap-width").evaluate(d,y)),ee=this.paint.get("line-offset").evaluate(d,y);return ee&&(b=function(te,Ee){for(var Le=[],Oe=new se(0,0),We=0;We<te.length;We++){for(var Ze=te[We],yt=[],Dt=0;Dt<Ze.length;Dt++){var Xt=Ze[Dt],mr=Ze[Dt+1],sr=Dt===0?Oe:Xt.sub(Ze[Dt-1])._unit()._perp(),Qr=Dt===Ze.length-1?Oe:mr.sub(Xt)._unit()._perp(),nn=sr._add(Qr)._unit();nn._mult(1/(nn.x*Qr.x+nn.y*Qr.y)),yt.push(nn._mult(Ee)._add(Xt))}Le.push(yt)}return Le}(b,ee*D)),function(te,Ee,Le){for(var Oe=0;Oe<Ee.length;Oe++){var We=Ee[Oe];if(te.length>=3){for(var Ze=0;Ze<We.length;Ze++)if(xu(te,We[Ze]))return!0}if(Es(te,We,Le))return!0}return!1}(j,b,X)},o.prototype.isTileClipped=function(){return!0},o}(Iu);function yd(a,o){return o>0?o+2*a:a}var vm=qo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),dv=qo([{name:"a_projected_pos",components:3,type:"Float32"}],4),vv=(qo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),qo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),_d=(qo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),qo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),mv=qo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function gv(a,o,u){return a.sections.forEach(function(d){d.text=function(y,b,C){var P=b.layout.get("text-transform").evaluate(C,{});return P==="uppercase"?y=y.toLocaleUpperCase():P==="lowercase"&&(y=y.toLocaleLowerCase()),Qs.applyArabicShaping&&(y=Qs.applyArabicShaping(y)),y}(d.text,o,u)}),a}qo([{name:"triangle",components:3,type:"Uint16"}]),qo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),qo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),qo([{type:"Float32",name:"offsetX"}]),qo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var vh={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Pp=function(o,u,d,y,b){var C,P,D=8*b-y-1,j=(1<<D)-1,X=j>>1,ee=-7,te=d?b-1:0,Ee=d?-1:1,Le=o[u+te];for(te+=Ee,C=Le&(1<<-ee)-1,Le>>=-ee,ee+=D;ee>0;C=256*C+o[u+te],te+=Ee,ee-=8);for(P=C&(1<<-ee)-1,C>>=-ee,ee+=y;ee>0;P=256*P+o[u+te],te+=Ee,ee-=8);if(C===0)C=1-X;else{if(C===j)return P?NaN:1/0*(Le?-1:1);P+=Math.pow(2,y),C-=X}return(Le?-1:1)*P*Math.pow(2,C-y)},Op=function(o,u,d,y,b,C){var P,D,j,X=8*C-b-1,ee=(1<<X)-1,te=ee>>1,Ee=b===23?Math.pow(2,-24)-Math.pow(2,-77):0,Le=y?0:C-1,Oe=y?1:-1,We=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(D=isNaN(u)?1:0,P=ee):(P=Math.floor(Math.log(u)/Math.LN2),u*(j=Math.pow(2,-P))<1&&(P--,j*=2),(u+=P+te>=1?Ee/j:Ee*Math.pow(2,1-te))*j>=2&&(P++,j/=2),P+te>=ee?(D=0,P=ee):P+te>=1?(D=(u*j-1)*Math.pow(2,b),P+=te):(D=u*Math.pow(2,te-1)*Math.pow(2,b),P=0));b>=8;o[d+Le]=255&D,Le+=Oe,D/=256,b-=8);for(P=P<<b|D,X+=b;X>0;o[d+Le]=255&P,Le+=Oe,P/=256,X-=8);o[d+Le-Oe]|=128*We},mh=Na;function Na(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Na.Varint=0,Na.Fixed64=1,Na.Bytes=2,Na.Fixed32=5;var xd=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function xl(a){return a.type===Na.Bytes?a.readVarint()+a.pos:a.pos+1}function jf(a,o,u){return u?4294967296*o+(a>>>0):4294967296*(o>>>0)+(a>>>0)}function K(a,o,u){var d=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));u.realloc(d);for(var y=u.pos-1;y>=a;y--)u.buf[y+d]=u.buf[y]}function ue(a,o){for(var u=0;u<a.length;u++)o.writeVarint(a[u])}function He(a,o){for(var u=0;u<a.length;u++)o.writeSVarint(a[u])}function Ht(a,o){for(var u=0;u<a.length;u++)o.writeFloat(a[u])}function hr(a,o){for(var u=0;u<a.length;u++)o.writeDouble(a[u])}function ar(a,o){for(var u=0;u<a.length;u++)o.writeBoolean(a[u])}function Jt(a,o){for(var u=0;u<a.length;u++)o.writeFixed32(a[u])}function Pr(a,o){for(var u=0;u<a.length;u++)o.writeSFixed32(a[u])}function jr(a,o){for(var u=0;u<a.length;u++)o.writeFixed64(a[u])}function Vr(a,o){for(var u=0;u<a.length;u++)o.writeSFixed64(a[u])}function Yr(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+16777216*a[o+3]}function Wr(a,o,u){a[u]=o,a[u+1]=o>>>8,a[u+2]=o>>>16,a[u+3]=o>>>24}function pn(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+(a[o+3]<<24)}function on(a,o,u){a===1&&u.readMessage(zr,o)}function zr(a,o,u){if(a===3){var d=u.readMessage(Gt,{}),y=d.width,b=d.height,C=d.left,P=d.top,D=d.advance;o.push({id:d.id,bitmap:new Bs({width:y+6,height:b+6},d.bitmap),metrics:{width:y,height:b,left:C,top:P,advance:D}})}}function Gt(a,o,u){a===1?o.id=u.readVarint():a===2?o.bitmap=u.readBytes():a===3?o.width=u.readVarint():a===4?o.height=u.readVarint():a===5?o.left=u.readSVarint():a===6?o.top=u.readSVarint():a===7&&(o.advance=u.readVarint())}function Wt(a){for(var o=0,u=0,d=0,y=a;d<y.length;d+=1){var b=y[d];o+=b.w*b.h,u=Math.max(u,b.w)}a.sort(function(Oe,We){return We.h-Oe.h});for(var C=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),u),h:1/0}],P=0,D=0,j=0,X=a;j<X.length;j+=1)for(var ee=X[j],te=C.length-1;te>=0;te--){var Ee=C[te];if(!(ee.w>Ee.w||ee.h>Ee.h)){if(ee.x=Ee.x,ee.y=Ee.y,D=Math.max(D,ee.y+ee.h),P=Math.max(P,ee.x+ee.w),ee.w===Ee.w&&ee.h===Ee.h){var Le=C.pop();te<C.length&&(C[te]=Le)}else ee.h===Ee.h?(Ee.x+=ee.w,Ee.w-=ee.w):ee.w===Ee.w?(Ee.y+=ee.h,Ee.h-=ee.h):(C.push({x:Ee.x+ee.w,y:Ee.y,w:Ee.w-ee.w,h:ee.h}),Ee.y+=ee.h,Ee.h-=ee.h);break}}return{w:P,h:D,fill:o/(P*D)||0}}Na.prototype={destroy:function(){this.buf=null},readFields:function(o,u,d){for(d=d||this.length;this.pos<d;){var y=this.readVarint(),b=y>>3,C=this.pos;this.type=7&y,o(b,u,this),this.pos===C&&this.skip(y)}return u},readMessage:function(o,u){return this.readFields(o,u,this.readVarint()+this.pos)},readFixed32:function(){var o=Yr(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=pn(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=Yr(this.buf,this.pos)+4294967296*Yr(this.buf,this.pos+4);return this.pos+=8,o},readSFixed64:function(){var o=Yr(this.buf,this.pos)+4294967296*pn(this.buf,this.pos+4);return this.pos+=8,o},readFloat:function(){var o=Pp(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=Pp(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var u,d,y=this.buf;return u=127&(d=y[this.pos++]),d<128?u:(u|=(127&(d=y[this.pos++]))<<7,d<128?u:(u|=(127&(d=y[this.pos++]))<<14,d<128?u:(u|=(127&(d=y[this.pos++]))<<21,d<128?u:function(b,C,P){var D,j,X=P.buf;if(D=(112&(j=X[P.pos++]))>>4,j<128||(D|=(127&(j=X[P.pos++]))<<3,j<128)||(D|=(127&(j=X[P.pos++]))<<10,j<128)||(D|=(127&(j=X[P.pos++]))<<17,j<128)||(D|=(127&(j=X[P.pos++]))<<24,j<128)||(D|=(1&(j=X[P.pos++]))<<31,j<128))return jf(b,D,C);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(d=y[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var o=this.readVarint()+this.pos,u=this.pos;return this.pos=o,o-u>=12&&xd?function(d,y,b){return xd.decode(d.subarray(y,b))}(this.buf,u,o):function(d,y,b){for(var C="",P=y;P<b;){var D,j,X,ee=d[P],te=null,Ee=ee>239?4:ee>223?3:ee>191?2:1;if(P+Ee>b)break;Ee===1?ee<128&&(te=ee):Ee===2?(192&(D=d[P+1]))==128&&(te=(31&ee)<<6|63&D)<=127&&(te=null):Ee===3?(j=d[P+2],(192&(D=d[P+1]))==128&&(192&j)==128&&((te=(15&ee)<<12|(63&D)<<6|63&j)<=2047||te>=55296&&te<=57343)&&(te=null)):Ee===4&&(j=d[P+2],X=d[P+3],(192&(D=d[P+1]))==128&&(192&j)==128&&(192&X)==128&&((te=(15&ee)<<18|(63&D)<<12|(63&j)<<6|63&X)<=65535||te>=1114112)&&(te=null)),te===null?(te=65533,Ee=1):te>65535&&(te-=65536,C+=String.fromCharCode(te>>>10&1023|55296),te=56320|1023&te),C+=String.fromCharCode(te),P+=Ee}return C}(this.buf,u,o)},readBytes:function(){var o=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,o);return this.pos=o,u},readPackedVarint:function(o,u){if(this.type!==Na.Bytes)return o.push(this.readVarint(u));var d=xl(this);for(o=o||[];this.pos<d;)o.push(this.readVarint(u));return o},readPackedSVarint:function(o){if(this.type!==Na.Bytes)return o.push(this.readSVarint());var u=xl(this);for(o=o||[];this.pos<u;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==Na.Bytes)return o.push(this.readBoolean());var u=xl(this);for(o=o||[];this.pos<u;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==Na.Bytes)return o.push(this.readFloat());var u=xl(this);for(o=o||[];this.pos<u;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==Na.Bytes)return o.push(this.readDouble());var u=xl(this);for(o=o||[];this.pos<u;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==Na.Bytes)return o.push(this.readFixed32());var u=xl(this);for(o=o||[];this.pos<u;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==Na.Bytes)return o.push(this.readSFixed32());var u=xl(this);for(o=o||[];this.pos<u;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==Na.Bytes)return o.push(this.readFixed64());var u=xl(this);for(o=o||[];this.pos<u;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==Na.Bytes)return o.push(this.readSFixed64());var u=xl(this);for(o=o||[];this.pos<u;)o.push(this.readSFixed64());return o},skip:function(o){var u=7&o;if(u===Na.Varint)for(;this.buf[this.pos++]>127;);else if(u===Na.Bytes)this.pos=this.readVarint()+this.pos;else if(u===Na.Fixed32)this.pos+=4;else{if(u!==Na.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(o,u){this.writeVarint(o<<3|u)},realloc:function(o){for(var u=this.length||16;u<this.pos+o;)u*=2;if(u!==this.length){var d=new Uint8Array(u);d.set(this.buf),this.buf=d,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),Wr(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),Wr(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),Wr(this.buf,-1&o,this.pos),Wr(this.buf,Math.floor(o*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),Wr(this.buf,-1&o,this.pos),Wr(this.buf,Math.floor(o*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(u,d){var y,b;if(u>=0?(y=u%4294967296|0,b=u/4294967296|0):(b=~(-u/4294967296),4294967295^(y=~(-u%4294967296))?y=y+1|0:(y=0,b=b+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");d.realloc(10),function(C,P,D){D.buf[D.pos++]=127&C|128,C>>>=7,D.buf[D.pos++]=127&C|128,C>>>=7,D.buf[D.pos++]=127&C|128,C>>>=7,D.buf[D.pos++]=127&C|128,D.buf[D.pos]=127&(C>>>=7)}(y,0,d),function(C,P){var D=(7&C)<<4;P.buf[P.pos++]|=D|((C>>>=3)?128:0),C&&(P.buf[P.pos++]=127&C|((C>>>=7)?128:0),C&&(P.buf[P.pos++]=127&C|((C>>>=7)?128:0),C&&(P.buf[P.pos++]=127&C|((C>>>=7)?128:0),C&&(P.buf[P.pos++]=127&C|((C>>>=7)?128:0),C&&(P.buf[P.pos++]=127&C)))))}(b,d)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(Boolean(o))},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var u=this.pos;this.pos=function(y,b,C){for(var P,D,j=0;j<b.length;j++){if((P=b.charCodeAt(j))>55295&&P<57344){if(!D){P>56319||j+1===b.length?(y[C++]=239,y[C++]=191,y[C++]=189):D=P;continue}if(P<56320){y[C++]=239,y[C++]=191,y[C++]=189,D=P;continue}P=D-55296<<10|P-56320|65536,D=null}else D&&(y[C++]=239,y[C++]=191,y[C++]=189,D=null);P<128?y[C++]=P:(P<2048?y[C++]=P>>6|192:(P<65536?y[C++]=P>>12|224:(y[C++]=P>>18|240,y[C++]=P>>12&63|128),y[C++]=P>>6&63|128),y[C++]=63&P|128)}return C}(this.buf,o,this.pos);var d=this.pos-u;d>=128&&K(u,d,this),this.pos=u-1,this.writeVarint(d),this.pos+=d},writeFloat:function(o){this.realloc(4),Op(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),Op(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var u=o.length;this.writeVarint(u),this.realloc(u);for(var d=0;d<u;d++)this.buf[this.pos++]=o[d]},writeRawMessage:function(o,u){this.pos++;var d=this.pos;o(u,this);var y=this.pos-d;y>=128&&K(d,y,this),this.pos=d-1,this.writeVarint(y),this.pos+=y},writeMessage:function(o,u,d){this.writeTag(o,Na.Bytes),this.writeRawMessage(u,d)},writePackedVarint:function(o,u){u.length&&this.writeMessage(o,ue,u)},writePackedSVarint:function(o,u){u.length&&this.writeMessage(o,He,u)},writePackedBoolean:function(o,u){u.length&&this.writeMessage(o,ar,u)},writePackedFloat:function(o,u){u.length&&this.writeMessage(o,Ht,u)},writePackedDouble:function(o,u){u.length&&this.writeMessage(o,hr,u)},writePackedFixed32:function(o,u){u.length&&this.writeMessage(o,Jt,u)},writePackedSFixed32:function(o,u){u.length&&this.writeMessage(o,Pr,u)},writePackedFixed64:function(o,u){u.length&&this.writeMessage(o,jr,u)},writePackedSFixed64:function(o,u){u.length&&this.writeMessage(o,Vr,u)},writeBytesField:function(o,u){this.writeTag(o,Na.Bytes),this.writeBytes(u)},writeFixed32Field:function(o,u){this.writeTag(o,Na.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(o,u){this.writeTag(o,Na.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(o,u){this.writeTag(o,Na.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(o,u){this.writeTag(o,Na.Fixed64),this.writeSFixed64(u)},writeVarintField:function(o,u){this.writeTag(o,Na.Varint),this.writeVarint(u)},writeSVarintField:function(o,u){this.writeTag(o,Na.Varint),this.writeSVarint(u)},writeStringField:function(o,u){this.writeTag(o,Na.Bytes),this.writeString(u)},writeFloatField:function(o,u){this.writeTag(o,Na.Fixed32),this.writeFloat(u)},writeDoubleField:function(o,u){this.writeTag(o,Na.Fixed64),this.writeDouble(u)},writeBooleanField:function(o,u){this.writeVarintField(o,Boolean(u))}};var Br=function(o,u){var d=u.pixelRatio,y=u.version,b=u.stretchX,C=u.stretchY,P=u.content;this.paddedRect=o,this.pixelRatio=d,this.stretchX=b,this.stretchY=C,this.content=P,this.version=y},Tn={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Tn.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Tn.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Tn.tlbr.get=function(){return this.tl.concat(this.br)},Tn.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Br.prototype,Tn);var cr=function(o,u){var d={},y={};this.haveRenderCallbacks=[];var b=[];this.addImages(o,d,b),this.addImages(u,y,b);var C=Wt(b),P=new Qo({width:C.w||1,height:C.h||1});for(var D in o){var j=o[D],X=d[D].paddedRect;Qo.copy(j.data,P,{x:0,y:0},{x:X.x+1,y:X.y+1},j.data)}for(var ee in u){var te=u[ee],Ee=y[ee].paddedRect,Le=Ee.x+1,Oe=Ee.y+1,We=te.data.width,Ze=te.data.height;Qo.copy(te.data,P,{x:0,y:0},{x:Le,y:Oe},te.data),Qo.copy(te.data,P,{x:0,y:Ze-1},{x:Le,y:Oe-1},{width:We,height:1}),Qo.copy(te.data,P,{x:0,y:0},{x:Le,y:Oe+Ze},{width:We,height:1}),Qo.copy(te.data,P,{x:We-1,y:0},{x:Le-1,y:Oe},{width:1,height:Ze}),Qo.copy(te.data,P,{x:0,y:0},{x:Le+We,y:Oe},{width:1,height:Ze})}this.image=P,this.iconPositions=d,this.patternPositions=y};cr.prototype.addImages=function(a,o,u){for(var d in a){var y=a[d],b={x:0,y:0,w:y.data.width+2,h:y.data.height+2};u.push(b),o[d]=new Br(b,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(d)}},cr.prototype.patchUpdatedImages=function(a,o){for(var u in a.dispatchRenderCallbacks(this.haveRenderCallbacks),a.updatedImages)this.patchUpdatedImage(this.iconPositions[u],a.getImage(u),o),this.patchUpdatedImage(this.patternPositions[u],a.getImage(u),o)},cr.prototype.patchUpdatedImage=function(a,o,u){if(a&&o&&a.version!==o.version){a.version=o.version;var d=a.tl;u.update(o.data,void 0,{x:d[0],y:d[1]})}},Ln("ImagePosition",Br),Ln("ImageAtlas",cr);var kn={horizontal:1,vertical:2,horizontalOnly:3},Mn=function(){this.scale=1,this.fontStack="",this.imageName=null};Mn.forText=function(a,o){var u=new Mn;return u.scale=a||1,u.fontStack=o,u},Mn.forImage=function(a){var o=new Mn;return o.imageName=a,o};var qr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function yr(a,o,u,d,y,b,C,P,D,j,X,ee,te,Ee,Le,Oe){var We,Ze=qr.fromFeature(a,y);ee===kn.vertical&&Ze.verticalizePunctuation();var yt=Qs.processBidirectionalText,Dt=Qs.processStyledBidirectionalText;if(yt&&Ze.sections.length===1){We=[];for(var Xt=0,mr=yt(Ze.toString(),Ii(Ze,j,b,o,d,Ee,Le));Xt<mr.length;Xt+=1){var sr=mr[Xt],Qr=new qr;Qr.text=sr,Qr.sections=Ze.sections;for(var nn=0;nn<sr.length;nn++)Qr.sectionIndex.push(0);We.push(Qr)}}else if(Dt){We=[];for(var Gn=0,ei=Dt(Ze.text,Ze.sectionIndex,Ii(Ze,j,b,o,d,Ee,Le));Gn<ei.length;Gn+=1){var $n=ei[Gn],Bn=new qr;Bn.text=$n[0],Bn.sectionIndex=$n[1],Bn.sections=Ze.sections,We.push(Bn)}}else We=function(ti,na){for(var ki=[],xa=ti.text,gi=0,ua=0,qa=na;ua<qa.length;ua+=1){var Xa=qa[ua];ki.push(ti.substring(gi,Xa)),gi=Xa}return gi<xa.length&&ki.push(ti.substring(gi,xa.length)),ki}(Ze,Ii(Ze,j,b,o,d,Ee,Le));var Ti=[],ui={positionedLines:Ti,text:Ze.toString(),top:X[1],bottom:X[1],left:X[0],right:X[0],writingMode:ee,iconsInText:!1,verticalizable:!1};return function(ti,na,ki,xa,gi,ua,qa,Xa,lo,co,Ao,zs){for(var Fo=0,eu=-17,Cs=0,tu=0,ds=Xa==="right"?1:Xa==="left"?0:.5,ns=0,is=0,ca=gi;is<ca.length;is+=1){var oa=ca[is];oa.trim();var za=oa.getMaxScale(),Ya=24*(za-1),ru={positionedGlyphs:[],lineOffset:0};ti.positionedLines[ns]=ru;var Qa=ru.positionedGlyphs,fo=0;if(oa.length()){for(var Us=0;Us<oa.length();Us++){var fa=oa.getSection(Us),wc=oa.getSectionIndex(Us),tl=oa.getCharCode(Us),Bl=0,Nu=null,js=null,ff=null,hf=24,pf=!(lo===kn.horizontal||!Ao&&!bo(tl)||Ao&&(ir[tl]||(Gf=tl,mn.Arabic(Gf)||mn["Arabic Supplement"](Gf)||mn["Arabic Extended-A"](Gf)||mn["Arabic Presentation Forms-A"](Gf)||mn["Arabic Presentation Forms-B"](Gf))));if(fa.imageName){var Lp=xa[fa.imageName];if(!Lp)continue;ff=fa.imageName,ti.iconsInText=ti.iconsInText||!0,js=Lp.paddedRect;var Tc=Lp.displaySize;fa.scale=24*fa.scale/zs,Bl=Ya+(24-Tc[1]*fa.scale),hf=(Nu={width:Tc[0],height:Tc[1],left:1,top:-3,advance:pf?Tc[1]:Tc[0]}).advance;var Dp=pf?Tc[0]*fa.scale-24*za:Tc[1]*fa.scale-24*za;Dp>0&&Dp>fo&&(fo=Dp)}else{var Zh=ki[fa.fontStack],Xh=Zh&&Zh[tl];if(Xh&&Xh.rect)js=Xh.rect,Nu=Xh.metrics;else{var Sd=na[fa.fontStack],Fp=Sd&&Sd[tl];if(!Fp)continue;Nu=Fp.metrics}Bl=24*(za-fa.scale)}pf?(ti.verticalizable=!0,Qa.push({glyph:tl,imageName:ff,x:Fo,y:eu+Bl,vertical:pf,scale:fa.scale,fontStack:fa.fontStack,sectionIndex:wc,metrics:Nu,rect:js}),Fo+=hf*fa.scale+co):(Qa.push({glyph:tl,imageName:ff,x:Fo,y:eu+Bl,vertical:pf,scale:fa.scale,fontStack:fa.fontStack,sectionIndex:wc,metrics:Nu,rect:js}),Fo+=Nu.advance*fa.scale+co)}Qa.length!==0&&(Cs=Math.max(Fo-co,Cs),gn(Qa,0,Qa.length-1,ds,fo)),Fo=0;var Cd=ua*za+fo;ru.lineOffset=Math.max(fo,Ya),eu+=Cd,tu=Math.max(Cd,tu),++ns}else eu+=ua,++ns}var Gf,Yh=eu- -17,Ad=Si(qa),Kh=Ad.horizontalAlign,Hf=Ad.verticalAlign;(function(Bp,wd,Td,$h,Np,zp,qh,Up,Qh){var jp,Vp=(wd-Td)*Np;jp=zp!==qh?-Up*$h- -17:(-$h*Qh+.5)*qh;for(var _h=0,Gp=Bp;_h<Gp.length;_h+=1)for(var xh=0,bh=Gp[_h].positionedGlyphs;xh<bh.length;xh+=1){var Hp=bh[xh];Hp.x+=Vp,Hp.y+=jp}})(ti.positionedLines,ds,Kh,Hf,Cs,tu,ua,Yh,gi.length),ti.top+=-Hf*Yh,ti.bottom=ti.top+Yh,ti.left+=-Kh*Cs,ti.right=ti.left+Cs}(ui,o,u,d,We,C,P,D,ee,j,te,Oe),!function(ti){for(var na=0,ki=ti;na<ki.length;na+=1)if(ki[na].positionedGlyphs.length!==0)return!1;return!0}(Ti)&&ui}qr.fromFeature=function(a,o){for(var u=new qr,d=0;d<a.sections.length;d++){var y=a.sections[d];y.image?u.addImageSection(y):u.addTextSection(y,o)}return u},qr.prototype.length=function(){return this.text.length},qr.prototype.getSection=function(a){return this.sections[this.sectionIndex[a]]},qr.prototype.getSectionIndex=function(a){return this.sectionIndex[a]},qr.prototype.getCharCode=function(a){return this.text.charCodeAt(a)},qr.prototype.verticalizePunctuation=function(){this.text=function(a){for(var o="",u=0;u<a.length;u++){var d=a.charCodeAt(u+1)||null,y=a.charCodeAt(u-1)||null;o+=d&&fc(d)&&!vh[a[u+1]]||y&&fc(y)&&!vh[a[u-1]]||!vh[a[u]]?a[u]:vh[a[u]]}return o}(this.text)},qr.prototype.trim=function(){for(var a=0,o=0;o<this.text.length&&ir[this.text.charCodeAt(o)];o++)a++;for(var u=this.text.length,d=this.text.length-1;d>=0&&d>=a&&ir[this.text.charCodeAt(d)];d--)u--;this.text=this.text.substring(a,u),this.sectionIndex=this.sectionIndex.slice(a,u)},qr.prototype.substring=function(a,o){var u=new qr;return u.text=this.text.substring(a,o),u.sectionIndex=this.sectionIndex.slice(a,o),u.sections=this.sections,u},qr.prototype.toString=function(){return this.text},qr.prototype.getMaxScale=function(){var a=this;return this.sectionIndex.reduce(function(o,u){return Math.max(o,a.sections[u].scale)},0)},qr.prototype.addTextSection=function(a,o){this.text+=a.text,this.sections.push(Mn.forText(a.scale,a.fontStack||o));for(var u=this.sections.length-1,d=0;d<a.text.length;++d)this.sectionIndex.push(u)},qr.prototype.addImageSection=function(a){var o=a.image?a.image.name:"";if(o.length!==0){var u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Mn.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Nt("Reached maximum number of images 6401")}else Nt("Can't add FormattedSection with an empty image.")},qr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var ir={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},tn={};function sn(a,o,u,d,y,b){if(o.imageName){var C=d[o.imageName];return C?C.displaySize[0]*o.scale*24/b+y:0}var P=u[o.fontStack],D=P&&P[a];return D?D.metrics.advance*o.scale+y:0}function Zr(a,o,u,d){var y=Math.pow(a-o,2);return d?a<o?y/2:2*y:y+Math.abs(u)*u}function dn(a,o,u){var d=0;return a===10&&(d-=1e4),u&&(d+=150),a!==40&&a!==65288||(d+=50),o!==41&&o!==65289||(d+=50),d}function fn(a,o,u,d,y,b){for(var C=null,P=Zr(o,u,y,b),D=0,j=d;D<j.length;D+=1){var X=j[D],ee=Zr(o-X.x,u,y,b)+X.badness;ee<=P&&(C=X,P=ee)}return{index:a,x:o,priorBreak:C,badness:P}}function Ii(a,o,u,d,y,b,C){if(b!=="point")return[];if(!a)return[];for(var P,D=[],j=function(We,Ze,yt,Dt,Xt,mr){for(var sr=0,Qr=0;Qr<We.length();Qr++){var nn=We.getSection(Qr);sr+=sn(We.getCharCode(Qr),nn,Dt,Xt,Ze,mr)}return sr/Math.max(1,Math.ceil(sr/yt))}(a,o,u,d,y,C),X=a.text.indexOf("\u200B")>=0,ee=0,te=0;te<a.length();te++){var Ee=a.getSection(te),Le=a.getCharCode(te);if(ir[Le]||(ee+=sn(Le,Ee,d,y,o,C)),te<a.length()-1){var Oe=!((P=Le)<11904||!(mn["Bopomofo Extended"](P)||mn.Bopomofo(P)||mn["CJK Compatibility Forms"](P)||mn["CJK Compatibility Ideographs"](P)||mn["CJK Compatibility"](P)||mn["CJK Radicals Supplement"](P)||mn["CJK Strokes"](P)||mn["CJK Symbols and Punctuation"](P)||mn["CJK Unified Ideographs Extension A"](P)||mn["CJK Unified Ideographs"](P)||mn["Enclosed CJK Letters and Months"](P)||mn["Halfwidth and Fullwidth Forms"](P)||mn.Hiragana(P)||mn["Ideographic Description Characters"](P)||mn["Kangxi Radicals"](P)||mn["Katakana Phonetic Extensions"](P)||mn.Katakana(P)||mn["Vertical Forms"](P)||mn["Yi Radicals"](P)||mn["Yi Syllables"](P)));(tn[Le]||Oe||Ee.imageName)&&D.push(fn(te+1,ee,j,D,dn(Le,a.getCharCode(te+1),Oe&&X),!1))}}return function We(Ze){return Ze?We(Ze.priorBreak).concat(Ze.index):[]}(fn(a.length(),ee,j,D,0,!0))}function Si(a){var o=.5,u=.5;switch(a){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:o,verticalAlign:u}}function gn(a,o,u,d,y){if(d||y)for(var b=a[u],C=(a[u].x+b.metrics.advance*b.scale)*d,P=o;P<=u;P++)a[P].x-=C,a[P].y+=y}function bn(a,o,u,d,y,b){var C,P=a.image;if(P.content){var D=P.content,j=P.pixelRatio||1;C=[D[0]/j,D[1]/j,P.displaySize[0]-D[2]/j,P.displaySize[1]-D[3]/j]}var X,ee,te,Ee,Le=o.left*b,Oe=o.right*b;u==="width"||u==="both"?(Ee=y[0]+Le-d[3],ee=y[0]+Oe+d[1]):ee=(Ee=y[0]+(Le+Oe-P.displaySize[0])/2)+P.displaySize[0];var We=o.top*b,Ze=o.bottom*b;return u==="height"||u==="both"?(X=y[1]+We-d[0],te=y[1]+Ze+d[2]):te=(X=y[1]+(We+Ze-P.displaySize[1])/2)+P.displaySize[1],{image:P,top:X,right:ee,bottom:te,left:Ee,collisionPadding:C}}tn[10]=!0,tn[32]=!0,tn[38]=!0,tn[40]=!0,tn[41]=!0,tn[43]=!0,tn[45]=!0,tn[47]=!0,tn[173]=!0,tn[183]=!0,tn[8203]=!0,tn[8208]=!0,tn[8211]=!0,tn[8231]=!0;var fi=function(a){function o(u,d,y,b){a.call(this,u,d),this.angle=y,b!==void 0&&(this.segment=b)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.clone=function(){return new o(this.x,this.y,this.angle,this.segment)},o}(se);function wi(a,o){var u=o.expression;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new Wi(a+1))};if(u.kind==="source")return{kind:"source"};for(var d=u.zoomStops,y=u.interpolationType,b=0;b<d.length&&d[b]<=a;)b++;for(var C=b=Math.max(0,b-1);C<d.length&&d[C]<a+1;)C++;C=Math.min(d.length-1,C);var P=d[b],D=d[C];return u.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:D,interpolationType:y}:{kind:"camera",minZoom:P,maxZoom:D,minSize:u.evaluate(new Wi(P)),maxSize:u.evaluate(new Wi(D)),interpolationType:y}}function qi(a,o,u){var d=o.uSize,y=u.lowerSize;return a.kind==="source"?y/128:a.kind==="composite"?Va(y/128,u.upperSize/128,o.uSizeT):d}function $a(a,o){var u=0,d=0;if(a.kind==="constant")d=a.layoutSize;else if(a.kind!=="source"){var y=a.interpolationType,b=y?ht(pt.interpolationFactor(y,o,a.minZoom,a.maxZoom),0,1):0;a.kind==="camera"?d=Va(a.minSize,a.maxSize,b):u=b}return{uSizeT:u,uSize:d}}Ln("Anchor",fi);var yo=Object.freeze({__proto__:null,getSizeData:wi,evaluateSizeForFeature:qi,evaluateSizeForZoom:$a,SIZE_PACK_FACTOR:128});function Qi(a,o,u,d,y){if(o.segment===void 0)return!0;for(var b=o,C=o.segment+1,P=0;P>-u/2;){if(--C<0)return!1;P-=a[C].dist(b),b=a[C]}P+=a[C].dist(a[C+1]),C++;for(var D=[],j=0;P<u/2;){var X=a[C],ee=a[C+1];if(!ee)return!1;var te=a[C-1].angleTo(X)-X.angleTo(ee);for(te=Math.abs((te+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:P,angleDelta:te}),j+=te;P-D[0].distance>d;)j-=D.shift().angleDelta;if(j>y)return!1;C++,P+=X.dist(ee)}return!0}function es(a){for(var o=0,u=0;u<a.length-1;u++)o+=a[u].dist(a[u+1]);return o}function Ha(a,o,u){return a?.6*o*u:0}function Ho(a,o){return Math.max(a?a.right-a.left:0,o?o.right-o.left:0)}function Lo(a,o,u,d,y,b){for(var C=Ha(u,y,b),P=Ho(u,d)*b,D=0,j=es(a)/2,X=0;X<a.length-1;X++){var ee=a[X],te=a[X+1],Ee=ee.dist(te);if(D+Ee>j){var Le=(j-D)/Ee,Oe=Va(ee.x,te.x,Le),We=Va(ee.y,te.y,Le),Ze=new fi(Oe,We,te.angleTo(ee),X);return Ze._round(),!C||Qi(a,Ze,P,C,o)?Ze:void 0}D+=Ee}}function cs(a,o,u,d,y,b,C,P,D){var j=Ha(d,b,C),X=Ho(d,y),ee=X*C,te=a[0].x===0||a[0].x===D||a[0].y===0||a[0].y===D;return o-ee<o/4&&(o=ee+o/4),function Ee(Le,Oe,We,Ze,yt,Dt,Xt,mr,sr){for(var Qr=Dt/2,nn=es(Le),Gn=0,ei=Oe-We,$n=[],Bn=0;Bn<Le.length-1;Bn++){for(var Ti=Le[Bn],ui=Le[Bn+1],ti=Ti.dist(ui),na=ui.angleTo(Ti);ei+We<Gn+ti;){var ki=((ei+=We)-Gn)/ti,xa=Va(Ti.x,ui.x,ki),gi=Va(Ti.y,ui.y,ki);if(xa>=0&&xa<sr&&gi>=0&&gi<sr&&ei-Qr>=0&&ei+Qr<=nn){var ua=new fi(xa,gi,na,Bn);ua._round(),Ze&&!Qi(Le,ua,Dt,Ze,yt)||$n.push(ua)}}Gn+=ti}return mr||$n.length||Xt||($n=Ee(Le,Gn/2,We,Ze,yt,Dt,Xt,!0,sr)),$n}(a,te?o/2*P%o:(X/2+2*b)*C*P%o,o,j,u,ee,te,!1,D)}function fs(a,o,u,d,y){for(var b=[],C=0;C<a.length;C++)for(var P=a[C],D=void 0,j=0;j<P.length-1;j++){var X=P[j],ee=P[j+1];X.x<o&&ee.x<o||(X.x<o?X=new se(o,X.y+(o-X.x)/(ee.x-X.x)*(ee.y-X.y))._round():ee.x<o&&(ee=new se(o,X.y+(o-X.x)/(ee.x-X.x)*(ee.y-X.y))._round()),X.y<u&&ee.y<u||(X.y<u?X=new se(X.x+(u-X.y)/(ee.y-X.y)*(ee.x-X.x),u)._round():ee.y<u&&(ee=new se(X.x+(u-X.y)/(ee.y-X.y)*(ee.x-X.x),u)._round()),X.x>=d&&ee.x>=d||(X.x>=d?X=new se(d,X.y+(d-X.x)/(ee.x-X.x)*(ee.y-X.y))._round():ee.x>=d&&(ee=new se(d,X.y+(d-X.x)/(ee.x-X.x)*(ee.y-X.y))._round()),X.y>=y&&ee.y>=y||(X.y>=y?X=new se(X.x+(y-X.y)/(ee.y-X.y)*(ee.x-X.x),y)._round():ee.y>=y&&(ee=new se(X.x+(y-X.y)/(ee.y-X.y)*(ee.x-X.x),y)._round()),D&&X.equals(D[D.length-1])||b.push(D=[X]),D.push(ee)))))}return b}function hs(a,o,u,d){var y=[],b=a.image,C=b.pixelRatio,P=b.paddedRect.w-2,D=b.paddedRect.h-2,j=a.right-a.left,X=a.bottom-a.top,ee=b.stretchX||[[0,P]],te=b.stretchY||[[0,D]],Ee=function(gi,ua){return gi+ua[1]-ua[0]},Le=ee.reduce(Ee,0),Oe=te.reduce(Ee,0),We=P-Le,Ze=D-Oe,yt=0,Dt=Le,Xt=0,mr=Oe,sr=0,Qr=We,nn=0,Gn=Ze;if(b.content&&d){var ei=b.content;yt=io(ee,0,ei[0]),Xt=io(te,0,ei[1]),Dt=io(ee,ei[0],ei[2]),mr=io(te,ei[1],ei[3]),sr=ei[0]-yt,nn=ei[1]-Xt,Qr=ei[2]-ei[0]-Dt,Gn=ei[3]-ei[1]-mr}var $n=function(gi,ua,qa,Xa){var lo=Wo(gi.stretch-yt,Dt,j,a.left),co=da(gi.fixed-sr,Qr,gi.stretch,Le),Ao=Wo(ua.stretch-Xt,mr,X,a.top),zs=da(ua.fixed-nn,Gn,ua.stretch,Oe),Fo=Wo(qa.stretch-yt,Dt,j,a.left),eu=da(qa.fixed-sr,Qr,qa.stretch,Le),Cs=Wo(Xa.stretch-Xt,mr,X,a.top),tu=da(Xa.fixed-nn,Gn,Xa.stretch,Oe),ds=new se(lo,Ao),ns=new se(Fo,Ao),is=new se(Fo,Cs),ca=new se(lo,Cs),oa=new se(co/C,zs/C),za=new se(eu/C,tu/C),Ya=o*Math.PI/180;if(Ya){var ru=Math.sin(Ya),Qa=Math.cos(Ya),fo=[Qa,-ru,ru,Qa];ds._matMult(fo),ns._matMult(fo),ca._matMult(fo),is._matMult(fo)}var Us=gi.stretch+gi.fixed,fa=ua.stretch+ua.fixed;return{tl:ds,tr:ns,bl:ca,br:is,tex:{x:b.paddedRect.x+1+Us,y:b.paddedRect.y+1+fa,w:qa.stretch+qa.fixed-Us,h:Xa.stretch+Xa.fixed-fa},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:oa,pixelOffsetBR:za,minFontScaleX:Qr/C/j,minFontScaleY:Gn/C/X,isSDF:u}};if(d&&(b.stretchX||b.stretchY))for(var Bn=zi(ee,We,Le),Ti=zi(te,Ze,Oe),ui=0;ui<Bn.length-1;ui++)for(var ti=Bn[ui],na=Bn[ui+1],ki=0;ki<Ti.length-1;ki++)y.push($n(ti,Ti[ki],na,Ti[ki+1]));else y.push($n({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:D+1}));return y}function io(a,o,u){for(var d=0,y=0,b=a;y<b.length;y+=1){var C=b[y];d+=Math.max(o,Math.min(u,C[1]))-Math.max(o,Math.min(u,C[0]))}return d}function zi(a,o,u){for(var d=[{fixed:-1,stretch:0}],y=0,b=a;y<b.length;y+=1){var C=b[y],P=C[0],D=C[1],j=d[d.length-1];d.push({fixed:P-j.stretch,stretch:j.stretch}),d.push({fixed:P-j.stretch,stretch:j.stretch+(D-P)})}return d.push({fixed:o+1,stretch:u}),d}function Wo(a,o,u,d){return a/o*u+d}function da(a,o,u,d){return a-o*u/d}var Do=function(o,u,d,y,b,C,P,D,j,X){if(this.boxStartIndex=o.length,j){var ee=C.top,te=C.bottom,Ee=C.collisionPadding;Ee&&(ee-=Ee[1],te+=Ee[3]);var Le=te-ee;Le>0&&(Le=Math.max(10,Le),this.circleDiameter=Le)}else{var Oe=C.top*P-D,We=C.bottom*P+D,Ze=C.left*P-D,yt=C.right*P+D,Dt=C.collisionPadding;if(Dt&&(Ze-=Dt[0]*P,Oe-=Dt[1]*P,yt+=Dt[2]*P,We+=Dt[3]*P),X){var Xt=new se(Ze,Oe),mr=new se(yt,Oe),sr=new se(Ze,We),Qr=new se(yt,We),nn=X*Math.PI/180;Xt._rotate(nn),mr._rotate(nn),sr._rotate(nn),Qr._rotate(nn),Ze=Math.min(Xt.x,mr.x,sr.x,Qr.x),yt=Math.max(Xt.x,mr.x,sr.x,Qr.x),Oe=Math.min(Xt.y,mr.y,sr.y,Qr.y),We=Math.max(Xt.y,mr.y,sr.y,Qr.y)}o.emplaceBack(u.x,u.y,Ze,Oe,yt,We,d,y,b)}this.boxEndIndex=o.length},vi=function(o,u){if(o===void 0&&(o=[]),u===void 0&&(u=Fi),this.data=o,this.length=this.data.length,this.compare=u,this.length>0)for(var d=(this.length>>1)-1;d>=0;d--)this._down(d)};function Fi(a,o){return a<o?-1:a>o?1:0}function ka(a,o,u){o===void 0&&(o=1),u===void 0&&(u=!1);for(var d=1/0,y=1/0,b=-1/0,C=-1/0,P=a[0],D=0;D<P.length;D++){var j=P[D];(!D||j.x<d)&&(d=j.x),(!D||j.y<y)&&(y=j.y),(!D||j.x>b)&&(b=j.x),(!D||j.y>C)&&(C=j.y)}var X=Math.min(b-d,C-y),ee=X/2,te=new vi([],Ns);if(X===0)return new se(d,y);for(var Ee=d;Ee<b;Ee+=X)for(var Le=y;Le<C;Le+=X)te.push(new Ss(Ee+ee,Le+ee,ee,a));for(var Oe=function(yt){for(var Dt=0,Xt=0,mr=0,sr=yt[0],Qr=0,nn=sr.length,Gn=nn-1;Qr<nn;Gn=Qr++){var ei=sr[Qr],$n=sr[Gn],Bn=ei.x*$n.y-$n.x*ei.y;Xt+=(ei.x+$n.x)*Bn,mr+=(ei.y+$n.y)*Bn,Dt+=3*Bn}return new Ss(Xt/Dt,mr/Dt,0,yt)}(a),We=te.length;te.length;){var Ze=te.pop();(Ze.d>Oe.d||!Oe.d)&&(Oe=Ze,u&&console.log("found best %d after %d probes",Math.round(1e4*Ze.d)/1e4,We)),Ze.max-Oe.d<=o||(te.push(new Ss(Ze.p.x-(ee=Ze.h/2),Ze.p.y-ee,ee,a)),te.push(new Ss(Ze.p.x+ee,Ze.p.y-ee,ee,a)),te.push(new Ss(Ze.p.x-ee,Ze.p.y+ee,ee,a)),te.push(new Ss(Ze.p.x+ee,Ze.p.y+ee,ee,a)),We+=4)}return u&&(console.log("num probes: "+We),console.log("best distance: "+Oe.d)),Oe.p}function Ns(a,o){return o.max-a.max}function Ss(a,o,u,d){this.p=new se(a,o),this.h=u,this.d=function(y,b){for(var C=!1,P=1/0,D=0;D<b.length;D++)for(var j=b[D],X=0,ee=j.length,te=ee-1;X<ee;te=X++){var Ee=j[X],Le=j[te];Ee.y>y.y!=Le.y>y.y&&y.x<(Le.x-Ee.x)*(y.y-Ee.y)/(Le.y-Ee.y)+Ee.x&&(C=!C),P=Math.min(P,Ll(y,Ee,Le))}return(C?1:-1)*Math.sqrt(P)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}vi.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},vi.prototype.pop=function(){if(this.length!==0){var a=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),a}},vi.prototype.peek=function(){return this.data[0]},vi.prototype._up=function(a){for(var o=this.data,u=this.compare,d=o[a];a>0;){var y=a-1>>1,b=o[y];if(u(d,b)>=0)break;o[a]=b,a=y}o[a]=d},vi.prototype._down=function(a){for(var o=this.data,u=this.compare,d=this.length>>1,y=o[a];a<d;){var b=1+(a<<1),C=o[b],P=b+1;if(P<this.length&&u(o[P],C)<0&&(b=P,C=o[P]),u(C,y)>=0)break;o[a]=C,a=b}o[a]=y};var Fe=Number.POSITIVE_INFINITY;function er(a,o){return o[1]!==Fe?function(u,d,y){var b=0,C=0;switch(d=Math.abs(d),y=Math.abs(y),u){case"top-right":case"top-left":case"top":C=y-7;break;case"bottom-right":case"bottom-left":case"bottom":C=7-y}switch(u){case"top-right":case"bottom-right":case"right":b=-d;break;case"top-left":case"bottom-left":case"left":b=d}return[b,C]}(a,o[0],o[1]):function(u,d){var y=0,b=0;d<0&&(d=0);var C=d/Math.sqrt(2);switch(u){case"top-right":case"top-left":b=C-7;break;case"bottom-right":case"bottom-left":b=7-C;break;case"bottom":b=7-d;break;case"top":b=d-7}switch(u){case"top-right":case"bottom-right":y=-C;break;case"top-left":case"bottom-left":y=C;break;case"left":y=d;break;case"right":y=-d}return[y,b]}(a,o[0])}function Lt(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function On(a,o,u,d,y,b,C,P,D,j,X,ee,te,Ee,Le){var Oe=function(Xt,mr,sr,Qr,nn,Gn,ei,$n){for(var Bn=Qr.layout.get("text-rotate").evaluate(Gn,{})*Math.PI/180,Ti=[],ui=0,ti=mr.positionedLines;ui<ti.length;ui+=1)for(var na=ti[ui],ki=0,xa=na.positionedGlyphs;ki<xa.length;ki+=1){var gi=xa[ki];if(gi.rect){var ua=gi.rect||{},qa=4,Xa=!0,lo=1,co=0,Ao=(nn||$n)&&gi.vertical,zs=gi.metrics.advance*gi.scale/2;if($n&&mr.verticalizable&&(co=na.lineOffset/2-(gi.imageName?-(24-gi.metrics.width*gi.scale)/2:24*(gi.scale-1))),gi.imageName){var Fo=ei[gi.imageName];Xa=Fo.sdf,qa=1/(lo=Fo.pixelRatio)}var eu=nn?[gi.x+zs,gi.y]:[0,0],Cs=nn?[0,0]:[gi.x+zs+sr[0],gi.y+sr[1]-co],tu=[0,0];Ao&&(tu=Cs,Cs=[0,0]);var ds=(gi.metrics.left-qa)*gi.scale-zs+Cs[0],ns=(-gi.metrics.top-qa)*gi.scale+Cs[1],is=ds+ua.w*gi.scale/lo,ca=ns+ua.h*gi.scale/lo,oa=new se(ds,ns),za=new se(is,ns),Ya=new se(ds,ca),ru=new se(is,ca);if(Ao){var Qa=new se(-zs,zs- -17),fo=-Math.PI/2,Us=12-zs,fa=new se(22-Us,-(gi.imageName?Us:0)),wc=new(Function.prototype.bind.apply(se,[null].concat(tu)));oa._rotateAround(fo,Qa)._add(fa)._add(wc),za._rotateAround(fo,Qa)._add(fa)._add(wc),Ya._rotateAround(fo,Qa)._add(fa)._add(wc),ru._rotateAround(fo,Qa)._add(fa)._add(wc)}if(Bn){var tl=Math.sin(Bn),Bl=Math.cos(Bn),Nu=[Bl,-tl,tl,Bl];oa._matMult(Nu),za._matMult(Nu),Ya._matMult(Nu),ru._matMult(Nu)}var js=new se(0,0),ff=new se(0,0);Ti.push({tl:oa,tr:za,bl:Ya,br:ru,tex:ua,writingMode:mr.writingMode,glyphOffset:eu,sectionIndex:gi.sectionIndex,isSDF:Xa,pixelOffsetTL:js,pixelOffsetBR:ff,minFontScaleX:0,minFontScaleY:0})}}return Ti}(0,u,P,y,b,C,d,a.allowVerticalPlacement),We=a.textSizeData,Ze=null;We.kind==="source"?(Ze=[128*y.layout.get("text-size").evaluate(C,{})])[0]>32640&&Nt(a.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):We.kind==="composite"&&((Ze=[128*Ee.compositeTextSizes[0].evaluate(C,{},Le),128*Ee.compositeTextSizes[1].evaluate(C,{},Le)])[0]>32640||Ze[1]>32640)&&Nt(a.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),a.addSymbols(a.text,Oe,Ze,P,b,C,j,o,D.lineStartIndex,D.lineLength,te,Le);for(var yt=0,Dt=X;yt<Dt.length;yt+=1)ee[Dt[yt]]=a.text.placedSymbolArray.length-1;return 4*Oe.length}function Vi(a){for(var o in a)return a[o];return null}function Me(a,o,u,d){var y=a.compareText;if(o in y){for(var b=y[o],C=b.length-1;C>=0;C--)if(d.dist(b[C])<u)return!0}else y[o]=[];return y[o].push(d),!1}var ge=uf.VectorTileFeature.types,qe=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function At(a,o,u,d,y,b,C,P,D,j,X,ee,te){var Ee=P?Math.min(32640,Math.round(P[0])):0,Le=P?Math.min(32640,Math.round(P[1])):0;a.emplaceBack(o,u,Math.round(32*d),Math.round(32*y),b,C,(Ee<<1)+(D?1:0),Le,16*j,16*X,256*ee,256*te)}function Yt(a,o,u){a.emplaceBack(o.x,o.y,u),a.emplaceBack(o.x,o.y,u),a.emplaceBack(o.x,o.y,u),a.emplaceBack(o.x,o.y,u)}function it(a){for(var o=0,u=a.sections;o<u.length;o+=1)if(Yc(u[o].text))return!0;return!1}var Qe=function(o){this.layoutVertexArray=new Tf,this.indexArray=new pl,this.programConfigurations=o,this.segments=new ve,this.dynamicLayoutVertexArray=new Kl,this.opacityVertexArray=new Mf,this.placedSymbolArray=new v};Qe.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Qe.prototype.upload=function(a,o,u,d){this.isEmpty()||(u&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,vm.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,dv.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,qe,!0),this.opacityVertexBuffer.itemSize=1),(u||d)&&this.programConfigurations.upload(a))},Qe.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Ln("SymbolBuffers",Qe);var ft=function(o,u,d){this.layoutVertexArray=new o,this.layoutAttributes=u,this.indexArray=new d,this.segments=new ve,this.collisionVertexArray=new Qc};ft.prototype.upload=function(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,vv.members,!0)},ft.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Ln("CollisionBuffers",ft);var ye=function(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(C){return C.id}),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ds([]),this.placementViewportMatrix=Ds([]);var u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=wi(this.zoom,u["text-size"]),this.iconSizeData=wi(this.zoom,u["icon-size"]);var d=this.layers[0].layout,y=d.get("symbol-sort-key"),b=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&y.constantOr(1)!==void 0,this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,d.get("symbol-placement")==="point"&&(this.writingModes=d.get("text-writing-mode").map(function(C){return kn[C]})),this.stateDependentLayerIds=this.layers.filter(function(C){return C.isStateDependent()}).map(function(C){return C.id}),this.sourceID=o.sourceID};ye.prototype.createArrays=function(){this.text=new Qe(new Di(this.layers,this.zoom,function(a){return/^text/.test(a)})),this.icon=new Qe(new Di(this.layers,this.zoom,function(a){return/^icon/.test(a)})),this.glyphOffsetArray=new I,this.lineVertexArray=new k,this.symbolInstances=new T},ye.prototype.calculateGlyphDependencies=function(a,o,u,d,y){for(var b=0;b<a.length;b++)if(o[a.charCodeAt(b)]=!0,(u||d)&&y){var C=vh[a.charAt(b)];C&&(o[C.charCodeAt(0)]=!0)}},ye.prototype.populate=function(a,o,u){var d=this.layers[0],y=d.layout,b=y.get("text-font"),C=y.get("text-field"),P=y.get("icon-image"),D=(C.value.kind!=="constant"||C.value.value instanceof Ea&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),j=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,X=y.get("symbol-sort-key");if(this.features=[],D||j){for(var ee=o.iconDependencies,te=o.glyphDependencies,Ee=o.availableImages,Le=new Wi(this.zoom),Oe=0,We=a;Oe<We.length;Oe+=1){var Ze=We[Oe],yt=Ze.feature,Dt=Ze.id,Xt=Ze.index,mr=Ze.sourceLayerIndex,sr=d._featureFilter.needGeometry,Qr=no(yt,sr);if(d._featureFilter.filter(Le,Qr,u)){sr||(Qr.geometry=Za(yt));var nn=void 0;if(D){var Gn=d.getValueAndResolveTokens("text-field",Qr,u,Ee),ei=Ea.factory(Gn);it(ei)&&(this.hasRTLText=!0),(!this.hasRTLText||Af()==="unavailable"||this.hasRTLText&&Qs.isParsed())&&(nn=gv(ei,d,Qr))}var $n=void 0;if(j){var Bn=d.getValueAndResolveTokens("icon-image",Qr,u,Ee);$n=Bn instanceof Ct?Bn:Ct.fromString(Bn)}if(nn||$n){var Ti=this.sortFeaturesByKey?X.evaluate(Qr,{},u):void 0;if(this.features.push({id:Dt,text:nn,icon:$n,index:Xt,sourceLayerIndex:mr,geometry:Qr.geometry,properties:yt.properties,type:ge[yt.type],sortKey:Ti}),$n&&(ee[$n.name]=!0),nn){var ui=b.evaluate(Qr,{},u).join(","),ti=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(kn.vertical)>=0;for(var na=0,ki=nn.sections;na<ki.length;na+=1){var xa=ki[na];if(xa.image)ee[xa.image.name]=!0;else{var gi=Rl(nn.toString()),ua=xa.fontStack||ui,qa=te[ua]=te[ua]||{};this.calculateGlyphDependencies(xa.text,qa,ti,this.allowVerticalPlacement,gi)}}}}}}y.get("symbol-placement")==="line"&&(this.features=function(Xa){var lo={},co={},Ao=[],zs=0;function Fo(Qa){Ao.push(Xa[Qa]),zs++}function eu(Qa,fo,Us){var fa=co[Qa];return delete co[Qa],co[fo]=fa,Ao[fa].geometry[0].pop(),Ao[fa].geometry[0]=Ao[fa].geometry[0].concat(Us[0]),fa}function Cs(Qa,fo,Us){var fa=lo[fo];return delete lo[fo],lo[Qa]=fa,Ao[fa].geometry[0].shift(),Ao[fa].geometry[0]=Us[0].concat(Ao[fa].geometry[0]),fa}function tu(Qa,fo,Us){var fa=Us?fo[0][fo[0].length-1]:fo[0][0];return Qa+":"+fa.x+":"+fa.y}for(var ds=0;ds<Xa.length;ds++){var ns=Xa[ds],is=ns.geometry,ca=ns.text?ns.text.toString():null;if(ca){var oa=tu(ca,is),za=tu(ca,is,!0);if(oa in co&&za in lo&&co[oa]!==lo[za]){var Ya=Cs(oa,za,is),ru=eu(oa,za,Ao[Ya].geometry);delete lo[oa],delete co[za],co[tu(ca,Ao[ru].geometry,!0)]=ru,Ao[Ya].geometry=null}else oa in co?eu(oa,za,is):za in lo?Cs(oa,za,is):(Fo(ds),lo[oa]=zs-1,co[za]=zs-1)}else Fo(ds)}return Ao.filter(function(Qa){return Qa.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Xa,lo){return Xa.sortKey-lo.sortKey})}},ye.prototype.update=function(a,o,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,o,this.layers,u),this.icon.programConfigurations.updatePaintArrays(a,o,this.layers,u))},ye.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},ye.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ye.prototype.upload=function(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ye.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},ye.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},ye.prototype.addToLineVertexArray=function(a,o){var u=this.lineVertexArray.length;if(a.segment!==void 0){for(var d=a.dist(o[a.segment+1]),y=a.dist(o[a.segment]),b={},C=a.segment+1;C<o.length;C++)b[C]={x:o[C].x,y:o[C].y,tileUnitDistanceFromAnchor:d},C<o.length-1&&(d+=o[C+1].dist(o[C]));for(var P=a.segment||0;P>=0;P--)b[P]={x:o[P].x,y:o[P].y,tileUnitDistanceFromAnchor:y},P>0&&(y+=o[P-1].dist(o[P]));for(var D=0;D<o.length;D++){var j=b[D];this.lineVertexArray.emplaceBack(j.x,j.y,j.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}},ye.prototype.addSymbols=function(a,o,u,d,y,b,C,P,D,j,X,ee){for(var te=a.indexArray,Ee=a.layoutVertexArray,Le=a.segments.prepareSegment(4*o.length,Ee,te,this.canOverlap?b.sortKey:void 0),Oe=this.glyphOffsetArray.length,We=Le.vertexLength,Ze=this.allowVerticalPlacement&&C===kn.vertical?Math.PI/2:0,yt=b.text&&b.text.sections,Dt=0;Dt<o.length;Dt++){var Xt=o[Dt],mr=Xt.tl,sr=Xt.tr,Qr=Xt.bl,nn=Xt.br,Gn=Xt.tex,ei=Xt.pixelOffsetTL,$n=Xt.pixelOffsetBR,Bn=Xt.minFontScaleX,Ti=Xt.minFontScaleY,ui=Xt.glyphOffset,ti=Xt.isSDF,na=Xt.sectionIndex,ki=Le.vertexLength,xa=ui[1];At(Ee,P.x,P.y,mr.x,xa+mr.y,Gn.x,Gn.y,u,ti,ei.x,ei.y,Bn,Ti),At(Ee,P.x,P.y,sr.x,xa+sr.y,Gn.x+Gn.w,Gn.y,u,ti,$n.x,ei.y,Bn,Ti),At(Ee,P.x,P.y,Qr.x,xa+Qr.y,Gn.x,Gn.y+Gn.h,u,ti,ei.x,$n.y,Bn,Ti),At(Ee,P.x,P.y,nn.x,xa+nn.y,Gn.x+Gn.w,Gn.y+Gn.h,u,ti,$n.x,$n.y,Bn,Ti),Yt(a.dynamicLayoutVertexArray,P,Ze),te.emplaceBack(ki,ki+1,ki+2),te.emplaceBack(ki+1,ki+2,ki+3),Le.vertexLength+=4,Le.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ui[0]),Dt!==o.length-1&&na===o[Dt+1].sectionIndex||a.programConfigurations.populatePaintArrays(Ee.length,b,b.index,{},ee,yt&&yt[na])}a.placedSymbolArray.emplaceBack(P.x,P.y,Oe,this.glyphOffsetArray.length-Oe,We,D,j,P.segment,u?u[0]:0,u?u[1]:0,d[0],d[1],C,0,!1,0,X)},ye.prototype._addCollisionDebugVertex=function(a,o,u,d,y,b){return o.emplaceBack(0,0),a.emplaceBack(u.x,u.y,d,y,Math.round(b.x),Math.round(b.y))},ye.prototype.addCollisionDebugVertices=function(a,o,u,d,y,b,C){var P=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),D=P.vertexLength,j=y.layoutVertexArray,X=y.collisionVertexArray,ee=C.anchorX,te=C.anchorY;this._addCollisionDebugVertex(j,X,b,ee,te,new se(a,o)),this._addCollisionDebugVertex(j,X,b,ee,te,new se(u,o)),this._addCollisionDebugVertex(j,X,b,ee,te,new se(u,d)),this._addCollisionDebugVertex(j,X,b,ee,te,new se(a,d)),P.vertexLength+=4;var Ee=y.indexArray;Ee.emplaceBack(D,D+1),Ee.emplaceBack(D+1,D+2),Ee.emplaceBack(D+2,D+3),Ee.emplaceBack(D+3,D),P.primitiveLength+=4},ye.prototype.addDebugCollisionBoxes=function(a,o,u,d){for(var y=a;y<o;y++){var b=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,d?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,u)}},ye.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ft(ku,_d.members,Rs),this.iconCollisionBox=new ft(ku,_d.members,Rs);for(var a=0;a<this.symbolInstances.length;a++){var o=this.symbolInstances.get(a);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}},ye.prototype._deserializeCollisionBoxesForSymbol=function(a,o,u,d,y,b,C,P,D){for(var j={},X=o;X<u;X++){var ee=a.get(X);j.textBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},j.textFeatureIndex=ee.featureIndex;break}for(var te=d;te<y;te++){var Ee=a.get(te);j.verticalTextBox={x1:Ee.x1,y1:Ee.y1,x2:Ee.x2,y2:Ee.y2,anchorPointX:Ee.anchorPointX,anchorPointY:Ee.anchorPointY},j.verticalTextFeatureIndex=Ee.featureIndex;break}for(var Le=b;Le<C;Le++){var Oe=a.get(Le);j.iconBox={x1:Oe.x1,y1:Oe.y1,x2:Oe.x2,y2:Oe.y2,anchorPointX:Oe.anchorPointX,anchorPointY:Oe.anchorPointY},j.iconFeatureIndex=Oe.featureIndex;break}for(var We=P;We<D;We++){var Ze=a.get(We);j.verticalIconBox={x1:Ze.x1,y1:Ze.y1,x2:Ze.x2,y2:Ze.y2,anchorPointX:Ze.anchorPointX,anchorPointY:Ze.anchorPointY},j.verticalIconFeatureIndex=Ze.featureIndex;break}return j},ye.prototype.deserializeCollisionBoxes=function(a){this.collisionArrays=[];for(var o=0;o<this.symbolInstances.length;o++){var u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}},ye.prototype.hasTextData=function(){return this.text.segments.get().length>0},ye.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ye.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},ye.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},ye.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},ye.prototype.addIndicesForPlacedSymbol=function(a,o){for(var u=a.placedSymbolArray.get(o),d=u.vertexStartIndex+4*u.numGlyphs,y=u.vertexStartIndex;y<d;y+=4)a.indexArray.emplaceBack(y,y+1,y+2),a.indexArray.emplaceBack(y+1,y+2,y+3)},ye.prototype.getSortedSymbolIndexes=function(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var o=Math.sin(a),u=Math.cos(a),d=[],y=[],b=[],C=0;C<this.symbolInstances.length;++C){b.push(C);var P=this.symbolInstances.get(C);d.push(0|Math.round(o*P.anchorX+u*P.anchorY)),y.push(P.featureIndex)}return b.sort(function(D,j){return d[D]-d[j]||y[j]-y[D]}),b},ye.prototype.addToSortKeyRanges=function(a,o){var u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:a,symbolInstanceEnd:a+1})},ye.prototype.sortFeatures=function(a){var o=this;if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,d=this.symbolInstanceIndexes;u<d.length;u+=1){var y=this.symbolInstances.get(d[u]);this.featureSortOrder.push(y.featureIndex),[y.rightJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.leftJustifiedTextSymbolIndex].forEach(function(b,C,P){b>=0&&P.indexOf(b)===C&&o.addIndicesForPlacedSymbol(o.text,b)}),y.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,y.verticalPlacedTextSymbolIndex),y.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.placedIconSymbolIndex),y.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Ln("SymbolBucket",ye,{omit:["layers","collisionBoxArray","features","compareText"]}),ye.MAX_GLYPHS=65535,ye.addDynamicAttributes=Yt;var Ke=new $o({"symbol-placement":new ni(_e.layout_symbol["symbol-placement"]),"symbol-spacing":new ni(_e.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ni(_e.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Yn(_e.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ni(_e.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ni(_e.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ni(_e.layout_symbol["icon-ignore-placement"]),"icon-optional":new ni(_e.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ni(_e.layout_symbol["icon-rotation-alignment"]),"icon-size":new Yn(_e.layout_symbol["icon-size"]),"icon-text-fit":new ni(_e.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ni(_e.layout_symbol["icon-text-fit-padding"]),"icon-image":new Yn(_e.layout_symbol["icon-image"]),"icon-rotate":new Yn(_e.layout_symbol["icon-rotate"]),"icon-padding":new ni(_e.layout_symbol["icon-padding"]),"icon-keep-upright":new ni(_e.layout_symbol["icon-keep-upright"]),"icon-offset":new Yn(_e.layout_symbol["icon-offset"]),"icon-anchor":new Yn(_e.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ni(_e.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ni(_e.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ni(_e.layout_symbol["text-rotation-alignment"]),"text-field":new Yn(_e.layout_symbol["text-field"]),"text-font":new Yn(_e.layout_symbol["text-font"]),"text-size":new Yn(_e.layout_symbol["text-size"]),"text-max-width":new Yn(_e.layout_symbol["text-max-width"]),"text-line-height":new ni(_e.layout_symbol["text-line-height"]),"text-letter-spacing":new Yn(_e.layout_symbol["text-letter-spacing"]),"text-justify":new Yn(_e.layout_symbol["text-justify"]),"text-radial-offset":new Yn(_e.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ni(_e.layout_symbol["text-variable-anchor"]),"text-anchor":new Yn(_e.layout_symbol["text-anchor"]),"text-max-angle":new ni(_e.layout_symbol["text-max-angle"]),"text-writing-mode":new ni(_e.layout_symbol["text-writing-mode"]),"text-rotate":new Yn(_e.layout_symbol["text-rotate"]),"text-padding":new ni(_e.layout_symbol["text-padding"]),"text-keep-upright":new ni(_e.layout_symbol["text-keep-upright"]),"text-transform":new Yn(_e.layout_symbol["text-transform"]),"text-offset":new Yn(_e.layout_symbol["text-offset"]),"text-allow-overlap":new ni(_e.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ni(_e.layout_symbol["text-ignore-placement"]),"text-optional":new ni(_e.layout_symbol["text-optional"])}),Pe={paint:new $o({"icon-opacity":new Yn(_e.paint_symbol["icon-opacity"]),"icon-color":new Yn(_e.paint_symbol["icon-color"]),"icon-halo-color":new Yn(_e.paint_symbol["icon-halo-color"]),"icon-halo-width":new Yn(_e.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Yn(_e.paint_symbol["icon-halo-blur"]),"icon-translate":new ni(_e.paint_symbol["icon-translate"]),"icon-translate-anchor":new ni(_e.paint_symbol["icon-translate-anchor"]),"text-opacity":new Yn(_e.paint_symbol["text-opacity"]),"text-color":new Yn(_e.paint_symbol["text-color"],{runtimeType:xn,getOverride:function(o){return o.textColor},hasOverride:function(o){return!!o.textColor}}),"text-halo-color":new Yn(_e.paint_symbol["text-halo-color"]),"text-halo-width":new Yn(_e.paint_symbol["text-halo-width"]),"text-halo-blur":new Yn(_e.paint_symbol["text-halo-blur"]),"text-translate":new ni(_e.paint_symbol["text-translate"]),"text-translate-anchor":new ni(_e.paint_symbol["text-translate-anchor"])}),layout:Ke},bt=function(o){this.type=o.property.overrides?o.property.overrides.runtimeType:An,this.defaultValue=o};bt.prototype.evaluate=function(a){if(a.formattedSection){var o=this.defaultValue.property.overrides;if(o&&o.hasOverride(a.formattedSection))return o.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default},bt.prototype.eachChild=function(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)},bt.prototype.outputDefined=function(){return!1},bt.prototype.serialize=function(){return null},Ln("FormatSectionOverride",bt,{omit:["defaultValue"]});var zt=function(a){function o(u){a.call(this,u,Pe)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.recalculate=function(u,d){if(a.prototype.recalculate.call(this,u,d),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var y=this.layout.get("text-writing-mode");if(y){for(var b=[],C=0,P=y;C<P.length;C+=1){var D=P[C];b.indexOf(D)<0&&b.push(D)}this.layout._values["text-writing-mode"]=b}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},o.prototype.getValueAndResolveTokens=function(u,d,y,b){var C=this.layout.get(u).evaluate(d,{},y,b),P=this._unevaluatedLayout._values[u];return P.isDataDriven()||ul(P.value)||!C?C:function(D,j){return j.replace(/{([^{}]+)}/g,function(X,ee){return ee in D?String(D[ee]):""})}(d.properties,C)},o.prototype.createBucket=function(u){return new ye(u)},o.prototype.queryRadius=function(){return 0},o.prototype.queryIntersectsFeature=function(){return!1},o.prototype._setPaintOverrides=function(){for(var u=0,d=Pe.paint.overridableProperties;u<d.length;u+=1){var y=d[u];if(o.hasPaintOverride(this.layout,y)){var b,C=this.paint.get(y),P=new bt(C),D=new sl(P,C.property.specification);b=C.value.kind==="constant"||C.value.kind==="source"?new Zu("source",D):new Hl("composite",D,C.value.zoomStops,C.value._interpolationType),this.paint._values[y]=new Eo(C.property,b,C.parameters)}}},o.prototype._handleOverridablePaintPropertyUpdate=function(u,d,y){return!(!this.layout||d.isDataDriven()||y.isDataDriven())&&o.hasPaintOverride(this.layout,u)},o.hasPaintOverride=function(u,d){var y=u.get("text-field"),b=Pe.paint.properties[d],C=!1,P=function(ee){for(var te=0,Ee=ee;te<Ee.length;te+=1)if(b.overrides&&b.overrides.hasOverride(Ee[te]))return void(C=!0)};if(y.value.kind==="constant"&&y.value.value instanceof Ea)P(y.value.value.sections);else if(y.value.kind==="source"){var D=function X(ee){C||(ee instanceof Pa&&wa(ee.value)===Ki?P(ee.value.sections):ee instanceof Xo?P(ee.sections):ee.eachChild(X))},j=y.value;j._styleExpression&&D(j._styleExpression.expression)}return C},o}(Iu),Or={paint:new $o({"background-color":new ni(_e.paint_background["background-color"]),"background-pattern":new So(_e.paint_background["background-pattern"]),"background-opacity":new ni(_e.paint_background["background-opacity"])})},un=function(a){function o(u){a.call(this,u,Or)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o}(Iu),ln={paint:new $o({"raster-opacity":new ni(_e.paint_raster["raster-opacity"]),"raster-hue-rotate":new ni(_e.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ni(_e.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ni(_e.paint_raster["raster-brightness-max"]),"raster-saturation":new ni(_e.paint_raster["raster-saturation"]),"raster-contrast":new ni(_e.paint_raster["raster-contrast"]),"raster-resampling":new ni(_e.paint_raster["raster-resampling"]),"raster-fade-duration":new ni(_e.paint_raster["raster-fade-duration"])})},En=function(a){function o(u){a.call(this,u,ln)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o}(Iu),rn=function(a){function o(u){a.call(this,u,{}),this.implementation=u}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},o.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},o.prototype.recalculate=function(){},o.prototype.updateTransitions=function(){},o.prototype.hasTransition=function(){},o.prototype.serialize=function(){},o.prototype.onAdd=function(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},o.prototype.onRemove=function(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},o}(Iu),Zn={circle:ef,heatmap:gp,hillshade:If,fill:Vh,"fill-extrusion":Uf,line:dm,symbol:zt,background:un,raster:En},Pn=be.HTMLImageElement,zn=be.HTMLCanvasElement,jn=be.HTMLVideoElement,Vn=be.ImageData,pi=be.ImageBitmap,ya=function(o,u,d,y){this.context=o,this.format=d,this.texture=o.gl.createTexture(),this.update(u,y)};ya.prototype.update=function(a,o,u){var d=a.width,y=a.height,b=!(this.size&&this.size[0]===d&&this.size[1]===y||u),C=this.context,P=C.gl;if(this.useMipmap=Boolean(o&&o.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!o||o.premultiply!==!1)),b)this.size=[d,y],a instanceof Pn||a instanceof zn||a instanceof jn||a instanceof Vn||pi&&a instanceof pi?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,a):P.texImage2D(P.TEXTURE_2D,0,this.format,d,y,0,this.format,P.UNSIGNED_BYTE,a.data);else{var D=u||{x:0,y:0},j=D.x,X=D.y;a instanceof Pn||a instanceof zn||a instanceof jn||a instanceof Vn||pi&&a instanceof pi?P.texSubImage2D(P.TEXTURE_2D,0,j,X,P.RGBA,P.UNSIGNED_BYTE,a):P.texSubImage2D(P.TEXTURE_2D,0,j,X,d,y,P.RGBA,P.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)},ya.prototype.bind=function(a,o,u){var d=this.context.gl;d.bindTexture(d.TEXTURE_2D,this.texture),u!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=d.LINEAR),a!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,a),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,u||a),this.filter=a),o!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,o),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,o),this.wrap=o)},ya.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ya.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ts=function(o){var u=this;this._callback=o,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){u._triggered=!1,u._callback()})};ts.prototype.trigger=function(){var a=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){a._triggered=!1,a._callback()},0))},ts.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Su=function(o,u,d){this.target=o,this.parent=u,this.mapId=d,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Qt(["receive","process"],this),this.invoker=new ts(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Jr()?o:be};function Fl(a,o,u){var d=2*Math.PI*6378137/256/Math.pow(2,u);return[a*d-2*Math.PI*6378137/2,o*d-2*Math.PI*6378137/2]}Su.prototype.send=function(a,o,u,d,y){var b=this;y===void 0&&(y=!1);var C=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[C]=u);var P=Ie(this.globalScope)?void 0:[];return this.target.postMessage({id:C,type:a,hasCallback:!!u,targetMapId:d,mustQueue:y,sourceMapId:this.mapId,data:pu(o,P)},P),{cancel:function(){u&&delete b.callbacks[C],b.target.postMessage({id:C,type:"<cancel>",targetMapId:d,sourceMapId:b.mapId})}}},Su.prototype.receive=function(a){var o=a.data,u=o.id;if(u&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){delete this.tasks[u];var d=this.cancelCallbacks[u];delete this.cancelCallbacks[u],d&&d()}else Jr()||o.mustQueue?(this.tasks[u]=o,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,o)},Su.prototype.process=function(){if(this.taskQueue.length){var a=this.taskQueue.shift(),o=this.tasks[a];delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),o&&this.processTask(a,o)}},Su.prototype.processTask=function(a,o){var u=this;if(o.type==="<response>"){var d=this.callbacks[a];delete this.callbacks[a],d&&(o.error?d(Xs(o.error)):d(null,Xs(o.data)))}else{var y=!1,b=Ie(this.globalScope)?void 0:[],C=o.hasCallback?function(X,ee){y=!0,delete u.cancelCallbacks[a],u.target.postMessage({id:a,type:"<response>",sourceMapId:u.mapId,error:X?pu(X):null,data:pu(ee,b)},b)}:function(X){y=!0},P=null,D=Xs(o.data);if(this.parent[o.type])P=this.parent[o.type](o.sourceMapId,D,C);else if(this.parent.getWorkerSource){var j=o.type.split(".");P=this.parent.getWorkerSource(o.sourceMapId,j[0],D.source)[j[1]](D,C)}else C(new Error("Could not find function "+o.type));!y&&P&&P.cancel&&(this.cancelCallbacks[a]=P.cancel)}},Su.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var La=function(o,u){o&&(u?this.setSouthWest(o).setNorthEast(u):o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))};La.prototype.setNorthEast=function(a){return this._ne=a instanceof ra?new ra(a.lng,a.lat):ra.convert(a),this},La.prototype.setSouthWest=function(a){return this._sw=a instanceof ra?new ra(a.lng,a.lat):ra.convert(a),this},La.prototype.extend=function(a){var o,u,d=this._sw,y=this._ne;if(a instanceof ra)o=a,u=a;else{if(!(a instanceof La))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(La.convert(a)):this.extend(ra.convert(a)):this;if(u=a._ne,!(o=a._sw)||!u)return this}return d||y?(d.lng=Math.min(o.lng,d.lng),d.lat=Math.min(o.lat,d.lat),y.lng=Math.max(u.lng,y.lng),y.lat=Math.max(u.lat,y.lat)):(this._sw=new ra(o.lng,o.lat),this._ne=new ra(u.lng,u.lat)),this},La.prototype.getCenter=function(){return new ra((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},La.prototype.getSouthWest=function(){return this._sw},La.prototype.getNorthEast=function(){return this._ne},La.prototype.getNorthWest=function(){return new ra(this.getWest(),this.getNorth())},La.prototype.getSouthEast=function(){return new ra(this.getEast(),this.getSouth())},La.prototype.getWest=function(){return this._sw.lng},La.prototype.getSouth=function(){return this._sw.lat},La.prototype.getEast=function(){return this._ne.lng},La.prototype.getNorth=function(){return this._ne.lat},La.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},La.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},La.prototype.isEmpty=function(){return!(this._sw&&this._ne)},La.prototype.contains=function(a){var o=ra.convert(a),u=o.lng,d=o.lat,y=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&y},La.convert=function(a){return!a||a instanceof La?a:new La(a)};var ra=function(o,u){if(isNaN(o)||isNaN(u))throw new Error("Invalid LngLat object: ("+o+", "+u+")");if(this.lng=+o,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};ra.prototype.wrap=function(){return new ra(gt(this.lng,-180,180),this.lat)},ra.prototype.toArray=function(){return[this.lng,this.lat]},ra.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ra.prototype.distanceTo=function(a){var o=Math.PI/180,u=this.lat*o,d=a.lat*o,y=Math.sin(u)*Math.sin(d)+Math.cos(u)*Math.cos(d)*Math.cos((a.lng-this.lng)*o);return 63710088e-1*Math.acos(Math.min(y,1))},ra.prototype.toBounds=function(a){a===void 0&&(a=0);var o=360*a/40075017,u=o/Math.cos(Math.PI/180*this.lat);return new La(new ra(this.lng-u,this.lat-o),new ra(this.lng+u,this.lat+o))},ra.convert=function(a){if(a instanceof ra)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new ra(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new ra(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var bl=2*Math.PI*63710088e-1;function Bu(a){return bl*Math.cos(a*Math.PI/180)}function Ip(a){return(180+a)/360}function el(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Rp(a,o){return a/Bu(o)}function yv(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}var gh=function(o,u,d){d===void 0&&(d=0),this.x=+o,this.y=+u,this.z=+d};gh.fromLngLat=function(a,o){o===void 0&&(o=0);var u=ra.convert(a);return new gh(Ip(u.lng),el(u.lat),Rp(o,u.lat))},gh.prototype.toLngLat=function(){return new ra(360*this.x-180,yv(this.y))},gh.prototype.toAltitude=function(){return this.z*Bu(yv(this.y))},gh.prototype.meterInMercatorCoordinateUnits=function(){return 1/bl*(a=yv(this.y),1/Math.cos(a*Math.PI/180));var a};var yh=function(o,u,d){this.z=o,this.x=u,this.y=d,this.key=kp(0,o,o,u,d)};yh.prototype.equals=function(a){return this.z===a.z&&this.x===a.x&&this.y===a.y},yh.prototype.url=function(a,o){var u,d,y,b,C,P=(d=this.y,y=this.z,b=Fl(256*(u=this.x),256*(d=Math.pow(2,y)-d-1),y),C=Fl(256*(u+1),256*(d+1),y),b[0]+","+b[1]+","+C[0]+","+C[1]),D=function(j,X,ee){for(var te,Ee="",Le=j;Le>0;Le--)Ee+=(X&(te=1<<Le-1)?1:0)+(ee&te?2:0);return Ee}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",D).replace("{bbox-epsg-3857}",P)},yh.prototype.getTilePoint=function(a){var o=Math.pow(2,this.z);return new se(8192*(a.x*o-this.x),8192*(a.y*o-this.y))},yh.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var mm=function(o,u){this.wrap=o,this.canonical=u,this.key=kp(o,u.z,u.z,u.x,u.y)},rs=function(o,u,d,y,b){this.overscaledZ=o,this.wrap=u,this.canonical=new yh(d,+y,+b),this.key=kp(u,o,d,y,b)};function kp(a,o,u,d,y){(a*=2)<0&&(a=-1*a-1);var b=1<<u;return(b*b*a+b*y+d).toString(36)+u.toString(36)+o.toString(36)}rs.prototype.equals=function(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)},rs.prototype.scaledTo=function(a){var o=this.canonical.z-a;return a>this.canonical.z?new rs(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new rs(a,this.wrap,a,this.canonical.x>>o,this.canonical.y>>o)},rs.prototype.calculateScaledKey=function(a,o){var u=this.canonical.z-a;return a>this.canonical.z?kp(this.wrap*+o,a,this.canonical.z,this.canonical.x,this.canonical.y):kp(this.wrap*+o,a,a,this.canonical.x>>u,this.canonical.y>>u)},rs.prototype.isChildOf=function(a){if(a.wrap!==this.wrap)return!1;var o=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>o&&a.canonical.y===this.canonical.y>>o},rs.prototype.children=function(a){if(this.overscaledZ>=a)return[new rs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var o=this.canonical.z+1,u=2*this.canonical.x,d=2*this.canonical.y;return[new rs(o,this.wrap,o,u,d),new rs(o,this.wrap,o,u+1,d),new rs(o,this.wrap,o,u,d+1),new rs(o,this.wrap,o,u+1,d+1)]},rs.prototype.isLessThan=function(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))},rs.prototype.wrapped=function(){return new rs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},rs.prototype.unwrapTo=function(a){return new rs(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)},rs.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},rs.prototype.toUnwrapped=function(){return new mm(this.wrap,this.canonical)},rs.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},rs.prototype.getTilePoint=function(a){return this.canonical.getTilePoint(new gh(a.x-this.wrap,a.y))},Ln("CanonicalTileID",yh),Ln("OverscaledTileID",rs,{omit:["posMatrix"]});var lf=function(o,u,d){if(this.uid=o,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return Nt('"'+d+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=u.height;var y=this.dim=u.height-2;this.data=new Uint32Array(u.data.buffer),this.encoding=d||"mapbox";for(var b=0;b<y;b++)this.data[this._idx(-1,b)]=this.data[this._idx(0,b)],this.data[this._idx(y,b)]=this.data[this._idx(y-1,b)],this.data[this._idx(b,-1)]=this.data[this._idx(b,0)],this.data[this._idx(b,y)]=this.data[this._idx(b,y-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(y,-1)]=this.data[this._idx(y-1,0)],this.data[this._idx(-1,y)]=this.data[this._idx(0,y-1)],this.data[this._idx(y,y)]=this.data[this._idx(y-1,y-1)]};lf.prototype.get=function(a,o){var u=new Uint8Array(this.data.buffer),d=4*this._idx(a,o);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(u[d],u[d+1],u[d+2])},lf.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},lf.prototype._idx=function(a,o){if(a<-1||a>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(a+1)},lf.prototype._unpackMapbox=function(a,o,u){return(256*a*256+256*o+u)/10-1e4},lf.prototype._unpackTerrarium=function(a,o,u){return 256*a+o+u/256-32768},lf.prototype.getPixels=function(){return new Qo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},lf.prototype.backfillBorder=function(a,o,u){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");var d=o*this.dim,y=o*this.dim+this.dim,b=u*this.dim,C=u*this.dim+this.dim;switch(o){case-1:d=y-1;break;case 1:y=d+1}switch(u){case-1:b=C-1;break;case 1:C=b+1}for(var P=-o*this.dim,D=-u*this.dim,j=b;j<C;j++)for(var X=d;X<y;X++)this.data[this._idx(X,j)]=a.data[this._idx(X+P,j+D)]},Ln("DEMData",lf);var bd=function(o){this._stringToNumber={},this._numberToString=[];for(var u=0;u<o.length;u++){var d=o[u];this._stringToNumber[d]=u,this._numberToString[u]=d}};bd.prototype.encode=function(a){return this._stringToNumber[a]},bd.prototype.decode=function(a){return this._numberToString[a]};var Ed=function(o,u,d,y,b){this.type="Feature",this._vectorTileFeature=o,o._z=u,o._x=d,o._y=y,this.properties=o.properties,this.id=b},_v={geometry:{configurable:!0}};_v.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},_v.geometry.set=function(a){this._geometry=a},Ed.prototype.toJSON=function(){var a={geometry:this.geometry};for(var o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(a[o]=this[o]);return a},Object.defineProperties(Ed.prototype,_v);var Wh=function(){this.state={},this.stateChanges={},this.deletedStates={}};Wh.prototype.updateState=function(a,o,u){var d=String(o);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][d]=this.stateChanges[a][d]||{},Be(this.stateChanges[a][d],u),this.deletedStates[a]===null)for(var y in this.deletedStates[a]={},this.state[a])y!==d&&(this.deletedStates[a][y]=null);else if(this.deletedStates[a]&&this.deletedStates[a][d]===null)for(var b in this.deletedStates[a][d]={},this.state[a][d])u[b]||(this.deletedStates[a][d][b]=null);else for(var C in u)this.deletedStates[a]&&this.deletedStates[a][d]&&this.deletedStates[a][d][C]===null&&delete this.deletedStates[a][d][C]},Wh.prototype.removeFeatureState=function(a,o,u){if(this.deletedStates[a]!==null){var d=String(o);if(this.deletedStates[a]=this.deletedStates[a]||{},u&&o!==void 0)this.deletedStates[a][d]!==null&&(this.deletedStates[a][d]=this.deletedStates[a][d]||{},this.deletedStates[a][d][u]=null);else if(o!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][d])for(u in this.deletedStates[a][d]={},this.stateChanges[a][d])this.deletedStates[a][d][u]=null;else this.deletedStates[a][d]=null;else this.deletedStates[a]=null}},Wh.prototype.getState=function(a,o){var u=String(o),d=Be({},(this.state[a]||{})[u],(this.stateChanges[a]||{})[u]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){var y=this.deletedStates[a][o];if(y===null)return{};for(var b in y)delete d[b]}return d},Wh.prototype.initializeTileState=function(a,o){a.setFeatureState(this.state,o)},Wh.prototype.coalesceChanges=function(a,o){var u={};for(var d in this.stateChanges){this.state[d]=this.state[d]||{};var y={};for(var b in this.stateChanges[d])this.state[d][b]||(this.state[d][b]={}),Be(this.state[d][b],this.stateChanges[d][b]),y[b]=this.state[d][b];u[d]=y}for(var C in this.deletedStates){this.state[C]=this.state[C]||{};var P={};if(this.deletedStates[C]===null)for(var D in this.state[C])P[D]={},this.state[C][D]={};else for(var j in this.deletedStates[C]){if(this.deletedStates[C][j]===null)this.state[C][j]={};else for(var X=0,ee=Object.keys(this.deletedStates[C][j]);X<ee.length;X+=1)delete this.state[C][j][ee[X]];P[j]=this.state[C][j]}u[C]=u[C]||{},Be(u[C],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(var te in a)a[te].setFeatureState(u,o)};var cf=function(o,u){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new Ku(8192,16,0),this.grid3D=new Ku(8192,16,0),this.featureIndexArray=new q,this.promoteId=u};function gm(a,o,u,d,y){return br(a,function(b,C){var P=o instanceof hc?o.get(C):null;return P&&P.evaluate?P.evaluate(u,d,y):P})}function xv(a){for(var o=1/0,u=1/0,d=-1/0,y=-1/0,b=0,C=a;b<C.length;b+=1){var P=C[b];o=Math.min(o,P.x),u=Math.min(u,P.y),d=Math.max(d,P.x),y=Math.max(y,P.y)}return{minX:o,minY:u,maxX:d,maxY:y}}function $0(a,o){return o-a}cf.prototype.insert=function(a,o,u,d,y,b){var C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,d,y);for(var P=b?this.grid3D:this.grid,D=0;D<o.length;D++){for(var j=o[D],X=[1/0,1/0,-1/0,-1/0],ee=0;ee<j.length;ee++){var te=j[ee];X[0]=Math.min(X[0],te.x),X[1]=Math.min(X[1],te.y),X[2]=Math.max(X[2],te.x),X[3]=Math.max(X[3],te.y)}X[0]<8192&&X[1]<8192&&X[2]>=0&&X[3]>=0&&P.insert(C,X[0],X[1],X[2],X[3])}},cf.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new uf.VectorTile(new mh(this.rawTileData)).layers,this.sourceLayerCoder=new bd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},cf.prototype.query=function(a,o,u,d){var y=this;this.loadVTLayers();for(var b=a.params||{},C=8192/a.tileSize/a.scale,P=Ef(b.filter),D=a.queryGeometry,j=a.queryPadding*C,X=xv(D),ee=this.grid.query(X.minX-j,X.minY-j,X.maxX+j,X.maxY+j),te=xv(a.cameraQueryGeometry),Ee=this.grid3D.query(te.minX-j,te.minY-j,te.maxX+j,te.maxY+j,function(Xt,mr,sr,Qr){return function(nn,Gn,ei,$n,Bn){for(var Ti=0,ui=nn;Ti<ui.length;Ti+=1){var ti=ui[Ti];if(Gn<=ti.x&&ei<=ti.y&&$n>=ti.x&&Bn>=ti.y)return!0}var na=[new se(Gn,ei),new se(Gn,Bn),new se($n,Bn),new se($n,ei)];if(nn.length>2){for(var ki=0,xa=na;ki<xa.length;ki+=1)if(xu(nn,xa[ki]))return!0}for(var gi=0;gi<nn.length-1;gi++)if(ql(nn[gi],nn[gi+1],na))return!0;return!1}(a.cameraQueryGeometry,Xt-j,mr-j,sr+j,Qr+j)}),Le=0,Oe=Ee;Le<Oe.length;Le+=1)ee.push(Oe[Le]);ee.sort($0);for(var We,Ze={},yt=function(mr){var sr=ee[mr];if(sr!==We){We=sr;var Qr=y.featureIndexArray.get(sr),nn=null;y.loadMatchingFeature(Ze,Qr.bucketIndex,Qr.sourceLayerIndex,Qr.featureIndex,P,b.layers,b.availableImages,o,u,d,function(Gn,ei,$n){return nn||(nn=Za(Gn)),ei.queryIntersectsFeature(D,Gn,$n,nn,y.z,a.transform,C,a.pixelPosMatrix)})}},Dt=0;Dt<ee.length;Dt++)yt(Dt);return Ze},cf.prototype.loadMatchingFeature=function(a,o,u,d,y,b,C,P,D,j,X){var ee=this.bucketLayerIDs[o];if(!b||function(nn,Gn){for(var ei=0;ei<nn.length;ei++)if(Gn.indexOf(nn[ei])>=0)return!0;return!1}(b,ee)){var te=this.sourceLayerCoder.decode(u),Ee=this.vtLayers[te].feature(d);if(y.needGeometry){var Le=no(Ee,!0);if(!y.filter(new Wi(this.tileID.overscaledZ),Le,this.tileID.canonical))return}else if(!y.filter(new Wi(this.tileID.overscaledZ),Ee))return;for(var Oe=this.getId(Ee,te),We=0;We<ee.length;We++){var Ze=ee[We];if(!(b&&b.indexOf(Ze)<0)){var yt=P[Ze];if(yt){var Dt={};Oe!==void 0&&j&&(Dt=j.getState(yt.sourceLayer||"_geojsonTileLayer",Oe));var Xt=Be({},D[Ze]);Xt.paint=gm(Xt.paint,yt.paint,Ee,Dt,C),Xt.layout=gm(Xt.layout,yt.layout,Ee,Dt,C);var mr=!X||X(Ee,yt,Dt);if(mr){var sr=new Ed(Ee,this.z,this.x,this.y,Oe);sr.layer=Xt;var Qr=a[Ze];Qr===void 0&&(Qr=a[Ze]=[]),Qr.push({featureIndex:d,feature:sr,intersectionZ:mr})}}}}}},cf.prototype.lookupSymbolFeatures=function(a,o,u,d,y,b,C,P){var D={};this.loadVTLayers();for(var j=Ef(y),X=0,ee=a;X<ee.length;X+=1)this.loadMatchingFeature(D,u,d,ee[X],j,b,C,P,o);return D},cf.prototype.hasLayer=function(a){for(var o=0,u=this.bucketLayerIDs;o<u.length;o+=1)for(var d=0,y=u[o];d<y.length;d+=1)if(a===y[d])return!0;return!1},cf.prototype.getId=function(a,o){var u=a.id;return this.promoteId&&typeof(u=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]])=="boolean"&&(u=Number(u)),u},Ln("FeatureIndex",cf,{omit:["rawTileData","sourceLayerCoder"]});var ps=function(o,u){this.tileID=o,this.uid=rt(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};ps.prototype.registerFadeDuration=function(a){var o=a+this.timeAdded;o<Et.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)},ps.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},ps.prototype.loadVectorData=function(a,o,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",a){for(var d in a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(j,X){var ee={};if(!X)return ee;for(var te=function(){var We=Le[Ee],Ze=We.layerIds.map(function(Xt){return X.getLayer(Xt)}).filter(Boolean);if(Ze.length!==0){We.layers=Ze,We.stateDependentLayerIds&&(We.stateDependentLayers=We.stateDependentLayerIds.map(function(Xt){return Ze.filter(function(mr){return mr.id===Xt})[0]}));for(var yt=0,Dt=Ze;yt<Dt.length;yt+=1)ee[Dt[yt].id]=We}},Ee=0,Le=j;Ee<Le.length;Ee+=1)te();return ee}(a.buckets,o.style),this.hasSymbolBuckets=!1,this.buckets){var y=this.buckets[d];if(y instanceof ye){if(this.hasSymbolBuckets=!0,!u)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var b in this.buckets){var C=this.buckets[b];if(C instanceof ye&&C.hasRTLText){this.hasRTLText=!0,Qs.isLoading()||Qs.isLoaded()||Af()!=="deferred"||su();break}}for(var P in this.queryPadding=0,this.buckets){var D=this.buckets[P];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(P).queryRadius(D))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)}else this.collisionBoxArray=new f},ps.prototype.unloadVectorData=function(){for(var a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},ps.prototype.getBucket=function(a){return this.buckets[a.id]},ps.prototype.upload=function(a){for(var o in this.buckets){var u=this.buckets[o];u.uploadPending()&&u.upload(a)}var d=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ya(a,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ya(a,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)},ps.prototype.prepare=function(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)},ps.prototype.queryRenderedFeatures=function(a,o,u,d,y,b,C,P,D,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:y,scale:b,tileSize:this.tileSize,pixelPosMatrix:j,transform:P,params:C,queryPadding:this.queryPadding*D},a,o,u):{}},ps.prototype.querySourceFeatures=function(a,o){var u=this.latestFeatureIndex;if(u&&u.rawTileData){var d=u.loadVTLayers(),y=o?o.sourceLayer:"",b=d._geojsonTileLayer||d[y];if(b)for(var C=Ef(o&&o.filter),P=this.tileID.canonical,D=P.z,j=P.x,X=P.y,ee={z:D,x:j,y:X},te=0;te<b.length;te++){var Ee=b.feature(te);if(C.needGeometry){var Le=no(Ee,!0);if(!C.filter(new Wi(this.tileID.overscaledZ),Le,this.tileID.canonical))continue}else if(!C.filter(new Wi(this.tileID.overscaledZ),Ee))continue;var Oe=u.getId(Ee,y),We=new Ed(Ee,D,j,X,Oe);We.tile=ee,a.push(We)}}},ps.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},ps.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},ps.prototype.setExpiryData=function(a){var o=this.expirationTime;if(a.cacheControl){var u=Er(a.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){var d=Date.now(),y=!1;if(this.expirationTime>d)y=!1;else if(o)if(this.expirationTime<o)y=!0;else{var b=this.expirationTime-o;b?this.expirationTime=d+Math.max(b,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},ps.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},ps.prototype.setFeatureState=function(a,o){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(a).length!==0){var u=this.latestFeatureIndex.loadVTLayers();for(var d in this.buckets)if(o.style.hasLayer(d)){var y=this.buckets[d],b=y.layers[0].sourceLayer||"_geojsonTileLayer",C=u[b],P=a[b];if(C&&P&&Object.keys(P).length!==0){y.update(P,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});var D=o&&o.style&&o.style.getLayer(d);D&&(this.queryPadding=Math.max(this.queryPadding,D.queryRadius(y)))}}}},ps.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},ps.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Et.now()},ps.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},ps.prototype.setHoldDuration=function(a){this.symbolFadeHoldUntil=Et.now()+a},ps.prototype.setDependencies=function(a,o){for(var u={},d=0,y=o;d<y.length;d+=1)u[y[d]]=!0;this.dependencies[a]=u},ps.prototype.hasDependency=function(a,o){for(var u=0,d=a;u<d.length;u+=1){var y=this.dependencies[d[u]];if(y){for(var b=0,C=o;b<C.length;b+=1)if(y[C[b]])return!0}}return!1};var Vf=be.performance,ym=function(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},Vf.mark(this._marks.start)};ym.prototype.finish=function(){Vf.mark(this._marks.end);var a=Vf.getEntriesByName(this._marks.measure);return a.length===0&&(Vf.measure(this._marks.measure,this._marks.start,this._marks.end),a=Vf.getEntriesByName(this._marks.measure),Vf.clearMarks(this._marks.start),Vf.clearMarks(this._marks.end),Vf.clearMeasures(this._marks.measure)),a},h.Actor=Su,h.AlphaImage=Bs,h.CanonicalTileID=yh,h.CollisionBoxArray=f,h.Color=xi,h.DEMData=lf,h.DataConstantProperty=ni,h.DictionaryCoder=bd,h.EXTENT=8192,h.ErrorEvent=et,h.EvaluationParameters=Wi,h.Event=De,h.Evented=vt,h.FeatureIndex=cf,h.FillBucket=Js,h.FillExtrusionBucket=yl,h.ImageAtlas=cr,h.ImagePosition=Br,h.LineBucket=va,h.LngLat=ra,h.LngLatBounds=La,h.MercatorCoordinate=gh,h.ONE_EM=24,h.OverscaledTileID=rs,h.Point=se,h.Point$1=se,h.Properties=$o,h.Protobuf=mh,h.RGBAImage=Qo,h.RequestManager=gr,h.RequestPerformance=ym,h.ResourceType=Hi,h.SegmentVector=ve,h.SourceFeatureState=Wh,h.StructArrayLayout1ui2=vc,h.StructArrayLayout2f1f2i16=dc,h.StructArrayLayout2i4=Ru,h.StructArrayLayout3ui6=pl,h.StructArrayLayout4i8=$u,h.SymbolBucket=ye,h.Texture=ya,h.Tile=ps,h.Transitionable=ls,h.Uniform1f=xr,h.Uniform1i=vr,h.Uniform2f=Hr,h.Uniform3f=cn,h.Uniform4f=Un,h.UniformColor=Jn,h.UniformMatrix4f=ji,h.UnwrappedTileID=mm,h.ValidationError=je,h.WritingMode=kn,h.ZoomHistory=Cf,h.add=function(a,o,u){return a[0]=o[0]+u[0],a[1]=o[1]+u[1],a[2]=o[2]+u[2],a},h.addDynamicAttributes=Yt,h.asyncAll=function(a,o,u){if(!a.length)return u(null,[]);var d=a.length,y=new Array(a.length),b=null;a.forEach(function(C,P){o(C,function(D,j){D&&(b=D),y[P]=j,--d==0&&u(b,y)})})},h.bezier=tt,h.bindAll=Qt,h.browser=Et,h.cacheEntryPossiblyAdded=function(a){++Xn>vn&&(a.getActor().send("enforceCacheSizeLimit",Xr),Xn=0)},h.clamp=ht,h.clearTileCache=function(a){var o=be.caches.delete("mapbox-tiles");a&&o.catch(a).then(function(){return a()})},h.clipLine=fs,h.clone=function(a){var o=new jo(16);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],o[4]=a[4],o[5]=a[5],o[6]=a[6],o[7]=a[7],o[8]=a[8],o[9]=a[9],o[10]=a[10],o[11]=a[11],o[12]=a[12],o[13]=a[13],o[14]=a[14],o[15]=a[15],o},h.clone$1=ke,h.clone$2=function(a){var o=new jo(3);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o},h.collisionCircleLayout=mv,h.config=St,h.create=function(){var a=new jo(16);return jo!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},h.create$1=function(){var a=new jo(9);return jo!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a},h.create$2=function(){var a=new jo(4);return jo!=Float32Array&&(a[1]=0,a[2]=0),a[0]=1,a[3]=1,a},h.createCommonjsModule=z,h.createExpression=Gl,h.createLayout=qo,h.createStyleLayer=function(a){return a.type==="custom"?new rn(a):new Zn[a.type](a)},h.cross=function(a,o,u){var d=o[0],y=o[1],b=o[2],C=u[0],P=u[1],D=u[2];return a[0]=y*D-b*P,a[1]=b*C-d*D,a[2]=d*P-y*C,a},h.deepEqual=function a(o,u){if(Array.isArray(o)){if(!Array.isArray(u)||o.length!==u.length)return!1;for(var d=0;d<o.length;d++)if(!a(o[d],u[d]))return!1;return!0}if(typeof o=="object"&&o!==null&&u!==null){if(typeof u!="object"||Object.keys(o).length!==Object.keys(u).length)return!1;for(var y in o)if(!a(o[y],u[y]))return!1;return!0}return o===u},h.dot=function(a,o){return a[0]*o[0]+a[1]*o[1]+a[2]*o[2]},h.dot$1=function(a,o){return a[0]*o[0]+a[1]*o[1]+a[2]*o[2]+a[3]*o[3]},h.ease=ut,h.emitValidationErrors=Zc,h.endsWith=Ir,h.enforceCacheSizeLimit=function(a){Kr(),me&&me.then(function(o){o.keys().then(function(u){for(var d=0;d<u.length-a;d++)o.delete(u[d])})})},h.evaluateSizeForFeature=qi,h.evaluateSizeForZoom=$a,h.evaluateVariableOffset=er,h.evented=qc,h.extend=Be,h.featureFilter=Ef,h.filterObject=Rt,h.fromRotation=function(a,o){var u=Math.sin(o),d=Math.cos(o);return a[0]=d,a[1]=u,a[2]=0,a[3]=-u,a[4]=d,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},h.getAnchorAlignment=Si,h.getAnchorJustification=Lt,h.getArrayBuffer=il,h.getImage=J,h.getJSON=function(a,o){return Hs(Be(a,{type:"json"}),o)},h.getRTLTextPluginStatus=Af,h.getReferrer=No,h.getVideo=function(a,o){var u,d,y=be.document.createElement("video");y.muted=!0,y.onloadstart=function(){o(null,y)};for(var b=0;b<a.length;b++){var C=be.document.createElement("source");u=a[b],d=void 0,(d=be.document.createElement("a")).href=u,(d.protocol!==be.document.location.protocol||d.host!==be.document.location.host)&&(y.crossOrigin="Anonymous"),C.src=a[b],y.appendChild(C)}return{cancel:function(){}}},h.identity=Ds,h.invert=function(a,o){var u=o[0],d=o[1],y=o[2],b=o[3],C=o[4],P=o[5],D=o[6],j=o[7],X=o[8],ee=o[9],te=o[10],Ee=o[11],Le=o[12],Oe=o[13],We=o[14],Ze=o[15],yt=u*P-d*C,Dt=u*D-y*C,Xt=u*j-b*C,mr=d*D-y*P,sr=d*j-b*P,Qr=y*j-b*D,nn=X*Oe-ee*Le,Gn=X*We-te*Le,ei=X*Ze-Ee*Le,$n=ee*We-te*Oe,Bn=ee*Ze-Ee*Oe,Ti=te*Ze-Ee*We,ui=yt*Ti-Dt*Bn+Xt*$n+mr*ei-sr*Gn+Qr*nn;return ui?(a[0]=(P*Ti-D*Bn+j*$n)*(ui=1/ui),a[1]=(y*Bn-d*Ti-b*$n)*ui,a[2]=(Oe*Qr-We*sr+Ze*mr)*ui,a[3]=(te*sr-ee*Qr-Ee*mr)*ui,a[4]=(D*ei-C*Ti-j*Gn)*ui,a[5]=(u*Ti-y*ei+b*Gn)*ui,a[6]=(We*Xt-Le*Qr-Ze*Dt)*ui,a[7]=(X*Qr-te*Xt+Ee*Dt)*ui,a[8]=(C*Bn-P*ei+j*nn)*ui,a[9]=(d*ei-u*Bn-b*nn)*ui,a[10]=(Le*sr-Oe*Xt+Ze*yt)*ui,a[11]=(ee*Xt-X*sr-Ee*yt)*ui,a[12]=(P*Gn-C*$n-D*nn)*ui,a[13]=(u*$n-d*Gn+y*nn)*ui,a[14]=(Oe*Dt-Le*mr-We*yt)*ui,a[15]=(X*mr-ee*Dt+te*yt)*ui,a):null},h.isChar=mn,h.isMapboxURL=or,h.keysDifference=function(a,o){var u=[];for(var d in a)d in o||u.push(d);return u},h.makeRequest=Hs,h.mapObject=br,h.mercatorXfromLng=Ip,h.mercatorYfromLat=el,h.mercatorZfromAltitude=Rp,h.mul=Go,h.multiply=Vo,h.mvt=uf,h.nextPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},h.normalize=function(a,o){var u=o[0],d=o[1],y=o[2],b=u*u+d*d+y*y;return b>0&&(b=1/Math.sqrt(b)),a[0]=o[0]*b,a[1]=o[1]*b,a[2]=o[2]*b,a},h.number=Va,h.offscreenCanvasSupported=ci,h.ortho=function(a,o,u,d,y,b,C){var P=1/(o-u),D=1/(d-y),j=1/(b-C);return a[0]=-2*P,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*D,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(o+u)*P,a[13]=(y+d)*D,a[14]=(C+b)*j,a[15]=1,a},h.parseGlyphPBF=function(a){return new mh(a).readFields(on,[])},h.pbf=mh,h.performSymbolLayout=function(a,o,u,d,y,b,C){a.createArrays(),a.tilePixelRatio=8192/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;var P=a.layers[0].layout,D=a.layers[0]._unevaluatedLayout._values,j={};if(a.textSizeData.kind==="composite"){var X=a.textSizeData,ee=X.maxZoom;j.compositeTextSizes=[D["text-size"].possiblyEvaluate(new Wi(X.minZoom),C),D["text-size"].possiblyEvaluate(new Wi(ee),C)]}if(a.iconSizeData.kind==="composite"){var te=a.iconSizeData,Ee=te.maxZoom;j.compositeIconSizes=[D["icon-size"].possiblyEvaluate(new Wi(te.minZoom),C),D["icon-size"].possiblyEvaluate(new Wi(Ee),C)]}j.layoutTextSize=D["text-size"].possiblyEvaluate(new Wi(a.zoom+1),C),j.layoutIconSize=D["icon-size"].possiblyEvaluate(new Wi(a.zoom+1),C),j.textMaxSize=D["text-size"].possiblyEvaluate(new Wi(18));for(var Le=24*P.get("text-line-height"),Oe=P.get("text-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",We=P.get("text-keep-upright"),Ze=P.get("text-size"),yt=function(){var sr=Xt[Dt],Qr=P.get("text-font").evaluate(sr,{},C).join(","),nn=Ze.evaluate(sr,{},C),Gn=j.layoutTextSize.evaluate(sr,{},C),ei=j.layoutIconSize.evaluate(sr,{},C),$n={horizontal:{},vertical:void 0},Bn=sr.text,Ti=[0,0];if(Bn){var ui=Bn.toString(),ti=24*P.get("text-letter-spacing").evaluate(sr,{},C),na=function(ca){for(var oa=0,za=ca;oa<za.length;oa+=1)if(Ya=za[oa].charCodeAt(0),mn.Arabic(Ya)||mn["Arabic Supplement"](Ya)||mn["Arabic Extended-A"](Ya)||mn["Arabic Presentation Forms-A"](Ya)||mn["Arabic Presentation Forms-B"](Ya))return!1;var Ya;return!0}(ui)?ti:0,ki=P.get("text-anchor").evaluate(sr,{},C),xa=P.get("text-variable-anchor");if(!xa){var gi=P.get("text-radial-offset").evaluate(sr,{},C);Ti=gi?er(ki,[24*gi,Fe]):P.get("text-offset").evaluate(sr,{},C).map(function(ca){return 24*ca})}var ua=Oe?"center":P.get("text-justify").evaluate(sr,{},C),qa=P.get("symbol-placement"),Xa=qa==="point"?24*P.get("text-max-width").evaluate(sr,{},C):0,lo=function(){a.allowVerticalPlacement&&Rl(ui)&&($n.vertical=yr(Bn,o,u,y,Qr,Xa,Le,ki,"left",na,Ti,kn.vertical,!0,qa,Gn,nn))};if(!Oe&&xa){for(var co=ua==="auto"?xa.map(function(ca){return Lt(ca)}):[ua],Ao=!1,zs=0;zs<co.length;zs++){var Fo=co[zs];if(!$n.horizontal[Fo])if(Ao)$n.horizontal[Fo]=$n.horizontal[0];else{var eu=yr(Bn,o,u,y,Qr,Xa,Le,"center",Fo,na,Ti,kn.horizontal,!1,qa,Gn,nn);eu&&($n.horizontal[Fo]=eu,Ao=eu.positionedLines.length===1)}}lo()}else{ua==="auto"&&(ua=Lt(ki));var Cs=yr(Bn,o,u,y,Qr,Xa,Le,ki,ua,na,Ti,kn.horizontal,!1,qa,Gn,nn);Cs&&($n.horizontal[ua]=Cs),lo(),Rl(ui)&&Oe&&We&&($n.vertical=yr(Bn,o,u,y,Qr,Xa,Le,ki,ua,na,Ti,kn.vertical,!1,qa,Gn,nn))}}var tu=void 0,ds=!1;if(sr.icon&&sr.icon.name){var ns=d[sr.icon.name];ns&&(tu=function(ca,oa,za){var Ya=Si(za),ru=oa[0]-ca.displaySize[0]*Ya.horizontalAlign,Qa=oa[1]-ca.displaySize[1]*Ya.verticalAlign;return{image:ca,top:Qa,bottom:Qa+ca.displaySize[1],left:ru,right:ru+ca.displaySize[0]}}(y[sr.icon.name],P.get("icon-offset").evaluate(sr,{},C),P.get("icon-anchor").evaluate(sr,{},C)),ds=ns.sdf,a.sdfIcons===void 0?a.sdfIcons=ns.sdf:a.sdfIcons!==ns.sdf&&Nt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ns.pixelRatio!==a.pixelRatio||P.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0))}var is=Vi($n.horizontal)||$n.vertical;a.iconsInText=!!is&&is.iconsInText,(is||tu)&&function(ca,oa,za,Ya,ru,Qa,fo,Us,fa,wc,tl){var Bl=Qa.textMaxSize.evaluate(oa,{});Bl===void 0&&(Bl=fo);var Nu,js=ca.layers[0].layout,ff=js.get("icon-offset").evaluate(oa,{},tl),hf=Vi(za.horizontal),pf=fo/24,Lp=ca.tilePixelRatio*pf,Tc=ca.tilePixelRatio*Bl/24,Dp=ca.tilePixelRatio*Us,Zh=ca.tilePixelRatio*js.get("symbol-spacing"),Xh=js.get("text-padding")*ca.tilePixelRatio,Sd=js.get("icon-padding")*ca.tilePixelRatio,Fp=js.get("text-max-angle")/180*Math.PI,Cd=js.get("text-rotation-alignment")==="map"&&js.get("symbol-placement")!=="point",Gf=js.get("icon-rotation-alignment")==="map"&&js.get("symbol-placement")!=="point",Yh=js.get("symbol-placement"),Ad=Zh/2,Kh=js.get("icon-text-fit");Ya&&Kh!=="none"&&(ca.allowVerticalPlacement&&za.vertical&&(Nu=bn(Ya,za.vertical,Kh,js.get("icon-text-fit-padding"),ff,pf)),hf&&(Ya=bn(Ya,hf,Kh,js.get("icon-text-fit-padding"),ff,pf)));var Hf=function(xm,Jh){Jh.x<0||Jh.x>=8192||Jh.y<0||Jh.y>=8192||function(wo,El,q0,Wf,Sv,bm,Ei,Mc,yi,Od,ep,Id,Rd,Cv,Vs,Zf,Av,wv,Tv,kd,zu,Ld,Em,Pc,Wp){var nu,Xf,Eh,Sh,Yf,Ch=wo.addToLineVertexArray(El,q0),Sm=0,Cm=0,Am=0,wm=0,Mv=-1,as=-1,df={},la=ze(""),Pv=0,Ov=0;if(Mc._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Pv=(nu=Mc.layout.get("text-offset").evaluate(zu,{},Pc).map(function(rp){return 24*rp}))[0],Ov=nu[1]):(Pv=24*Mc.layout.get("text-radial-offset").evaluate(zu,{},Pc),Ov=Fe),wo.allowVerticalPlacement&&Wf.vertical){var Tm=Mc.layout.get("text-rotate").evaluate(zu,{},Pc)+90;Sh=new Do(yi,El,Od,ep,Id,Wf.vertical,Rd,Cv,Vs,Tm),Ei&&(Yf=new Do(yi,El,Od,ep,Id,Ei,Av,wv,Vs,Tm))}if(Sv){var ce=Mc.layout.get("icon-rotate").evaluate(zu,{}),Iv=Mc.layout.get("icon-text-fit")!=="none",Rv=hs(Sv,ce,Em,Iv),Dd=Ei?hs(Ei,ce,Em,Iv):void 0;Eh=new Do(yi,El,Od,ep,Id,Sv,Av,wv,!1,ce),Sm=4*Rv.length;var kv=wo.iconSizeData,tp=null;kv.kind==="source"?(tp=[128*Mc.layout.get("icon-size").evaluate(zu,{})])[0]>32640&&Nt(wo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):kv.kind==="composite"&&((tp=[128*Ld.compositeIconSizes[0].evaluate(zu,{},Pc),128*Ld.compositeIconSizes[1].evaluate(zu,{},Pc)])[0]>32640||tp[1]>32640)&&Nt(wo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),wo.addSymbols(wo.icon,Rv,tp,kd,Tv,zu,!1,El,Ch.lineStartIndex,Ch.lineLength,-1,Pc),Mv=wo.icon.placedSymbolArray.length-1,Dd&&(Cm=4*Dd.length,wo.addSymbols(wo.icon,Dd,tp,kd,Tv,zu,kn.vertical,El,Ch.lineStartIndex,Ch.lineLength,-1,Pc),as=wo.icon.placedSymbolArray.length-1)}for(var Lv in Wf.horizontal){var vf=Wf.horizontal[Lv];if(!Xf){la=ze(vf.text);var Mm=Mc.layout.get("text-rotate").evaluate(zu,{},Pc);Xf=new Do(yi,El,Od,ep,Id,vf,Rd,Cv,Vs,Mm)}var Dv=vf.positionedLines.length===1;if(Am+=On(wo,El,vf,bm,Mc,Vs,zu,Zf,Ch,Wf.vertical?kn.horizontal:kn.horizontalOnly,Dv?Object.keys(Wf.horizontal):[Lv],df,Mv,Ld,Pc),Dv)break}Wf.vertical&&(wm+=On(wo,El,Wf.vertical,bm,Mc,Vs,zu,Zf,Ch,kn.vertical,["vertical"],df,as,Ld,Pc));var Pm=Xf?Xf.boxStartIndex:wo.collisionBoxArray.length,Om=Xf?Xf.boxEndIndex:wo.collisionBoxArray.length,Im=Sh?Sh.boxStartIndex:wo.collisionBoxArray.length,Fd=Sh?Sh.boxEndIndex:wo.collisionBoxArray.length,Q0=Eh?Eh.boxStartIndex:wo.collisionBoxArray.length,J0=Eh?Eh.boxEndIndex:wo.collisionBoxArray.length,Rm=Yf?Yf.boxStartIndex:wo.collisionBoxArray.length,km=Yf?Yf.boxEndIndex:wo.collisionBoxArray.length,Jl=-1,Zp=function(Bd,Bv){return Bd&&Bd.circleDiameter?Math.max(Bd.circleDiameter,Bv):Bv};Jl=Zp(Xf,Jl),Jl=Zp(Sh,Jl),Jl=Zp(Eh,Jl);var Fv=(Jl=Zp(Yf,Jl))>-1?1:0;Fv&&(Jl*=Wp/24),wo.glyphOffsetArray.length>=ye.MAX_GLYPHS&&Nt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),zu.sortKey!==void 0&&wo.addToSortKeyRanges(wo.symbolInstances.length,zu.sortKey),wo.symbolInstances.emplaceBack(El.x,El.y,df.right>=0?df.right:-1,df.center>=0?df.center:-1,df.left>=0?df.left:-1,df.vertical||-1,Mv,as,la,Pm,Om,Im,Fd,Q0,J0,Rm,km,Od,Am,wm,Sm,Cm,Fv,0,Rd,Pv,Ov,Jl)}(ca,Jh,xm,za,Ya,ru,Nu,ca.layers[0],ca.collisionBoxArray,oa.index,oa.sourceLayerIndex,ca.index,Lp,Xh,Cd,fa,Dp,Sd,Gf,ff,oa,Qa,wc,tl,fo)};if(Yh==="line")for(var Bp=0,wd=fs(oa.geometry,0,0,8192,8192);Bp<wd.length;Bp+=1)for(var Td=wd[Bp],$h=0,Np=cs(Td,Zh,Fp,za.vertical||hf,Ya,24,Tc,ca.overscaling,8192);$h<Np.length;$h+=1){var zp=Np[$h];hf&&Me(ca,hf.text,Ad,zp)||Hf(Td,zp)}else if(Yh==="line-center")for(var qh=0,Up=oa.geometry;qh<Up.length;qh+=1){var Qh=Up[qh];if(Qh.length>1){var jp=Lo(Qh,Fp,za.vertical||hf,Ya,24,Tc);jp&&Hf(Qh,jp)}}else if(oa.type==="Polygon")for(var Vp=0,_h=af(oa.geometry,0);Vp<_h.length;Vp+=1){var Gp=_h[Vp],xh=ka(Gp,16);Hf(Gp[0],new fi(xh.x,xh.y,0))}else if(oa.type==="LineString")for(var bh=0,Hp=oa.geometry;bh<Hp.length;bh+=1){var Md=Hp[bh];Hf(Md,new fi(Md[0].x,Md[0].y,0))}else if(oa.type==="Point")for(var Pd=0,_m=oa.geometry;Pd<_m.length;Pd+=1)for(var bv=0,_o=_m[Pd];bv<_o.length;bv+=1){var Ev=_o[bv];Hf([Ev],new fi(Ev.x,Ev.y,0))}}(a,sr,$n,tu,d,j,Gn,ei,Ti,ds,C)},Dt=0,Xt=a.features;Dt<Xt.length;Dt+=1)yt();b&&a.generateCollisionDebugBuffers()},h.perspective=function(a,o,u,d,y){var b,C=1/Math.tan(o/2);return a[0]=C/u,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=C,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,y!=null&&y!==1/0?(a[10]=(y+d)*(b=1/(d-y)),a[14]=2*y*d*b):(a[10]=-1,a[14]=-2*d),a},h.pick=function(a,o){for(var u={},d=0;d<o.length;d++){var y=o[d];y in a&&(u[y]=a[y])}return u},h.plugin=Qs,h.polygonIntersectsPolygon=vl,h.postMapLoadEvent=_r,h.postTurnstileEvent=os,h.potpack=Wt,h.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],h.register=Ln,h.registerForPluginStateChange=function(a){return a({pluginStatus:qs,pluginURL:cl}),qc.on("pluginStateChange",a),a},h.renderColorRamp=Of,h.rotate=function(a,o,u){var d=o[0],y=o[1],b=o[2],C=o[3],P=Math.sin(u),D=Math.cos(u);return a[0]=d*D+b*P,a[1]=y*D+C*P,a[2]=d*-P+b*D,a[3]=y*-P+C*D,a},h.rotateX=function(a,o,u){var d=Math.sin(u),y=Math.cos(u),b=o[4],C=o[5],P=o[6],D=o[7],j=o[8],X=o[9],ee=o[10],te=o[11];return o!==a&&(a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[4]=b*y+j*d,a[5]=C*y+X*d,a[6]=P*y+ee*d,a[7]=D*y+te*d,a[8]=j*y-b*d,a[9]=X*y-C*d,a[10]=ee*y-P*d,a[11]=te*y-D*d,a},h.rotateZ=function(a,o,u){var d=Math.sin(u),y=Math.cos(u),b=o[0],C=o[1],P=o[2],D=o[3],j=o[4],X=o[5],ee=o[6],te=o[7];return o!==a&&(a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=b*y+j*d,a[1]=C*y+X*d,a[2]=P*y+ee*d,a[3]=D*y+te*d,a[4]=j*y-b*d,a[5]=X*y-C*d,a[6]=ee*y-P*d,a[7]=te*y-D*d,a},h.scale=function(a,o,u){var d=u[0],y=u[1],b=u[2];return a[0]=o[0]*d,a[1]=o[1]*d,a[2]=o[2]*d,a[3]=o[3]*d,a[4]=o[4]*y,a[5]=o[5]*y,a[6]=o[6]*y,a[7]=o[7]*y,a[8]=o[8]*b,a[9]=o[9]*b,a[10]=o[10]*b,a[11]=o[11]*b,a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],a},h.scale$1=function(a,o,u){return a[0]=o[0]*u,a[1]=o[1]*u,a[2]=o[2]*u,a[3]=o[3]*u,a},h.scale$2=function(a,o,u){return a[0]=o[0]*u,a[1]=o[1]*u,a[2]=o[2]*u,a},h.setCacheLimits=function(a,o){Xr=a,vn=o},h.setRTLTextPlugin=function(a,o,u){if(u===void 0&&(u=!1),qs==="deferred"||qs==="loading"||qs==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");cl=Et.resolveURL(a),qs="deferred",Kc=o,$c(),u||su()},h.sphericalToCartesian=function(a){var o=a[0],u=a[1],d=a[2];return u+=90,u*=Math.PI/180,d*=Math.PI/180,{x:o*Math.cos(u)*Math.sin(d),y:o*Math.sin(u)*Math.sin(d),z:o*Math.cos(d)}},h.sqrLen=function(a){var o=a[0],u=a[1];return o*o+u*u},h.styleSpec=_e,h.sub=function(a,o,u){return a[0]=o[0]-u[0],a[1]=o[1]-u[1],a[2]=o[2]-u[2],a},h.symbolSize=yo,h.transformMat3=function(a,o,u){var d=o[0],y=o[1],b=o[2];return a[0]=d*u[0]+y*u[3]+b*u[6],a[1]=d*u[1]+y*u[4]+b*u[7],a[2]=d*u[2]+y*u[5]+b*u[8],a},h.transformMat4=$s,h.translate=function(a,o,u){var d,y,b,C,P,D,j,X,ee,te,Ee,Le,Oe=u[0],We=u[1],Ze=u[2];return o===a?(a[12]=o[0]*Oe+o[4]*We+o[8]*Ze+o[12],a[13]=o[1]*Oe+o[5]*We+o[9]*Ze+o[13],a[14]=o[2]*Oe+o[6]*We+o[10]*Ze+o[14],a[15]=o[3]*Oe+o[7]*We+o[11]*Ze+o[15]):(y=o[1],b=o[2],C=o[3],P=o[4],D=o[5],j=o[6],X=o[7],ee=o[8],te=o[9],Ee=o[10],Le=o[11],a[0]=d=o[0],a[1]=y,a[2]=b,a[3]=C,a[4]=P,a[5]=D,a[6]=j,a[7]=X,a[8]=ee,a[9]=te,a[10]=Ee,a[11]=Le,a[12]=d*Oe+P*We+ee*Ze+o[12],a[13]=y*Oe+D*We+te*Ze+o[13],a[14]=b*Oe+j*We+Ee*Ze+o[14],a[15]=C*Oe+X*We+Le*Ze+o[15]),a},h.triggerPluginCompletionEvent=lh,h.uniqueId=rt,h.validateCustomStyleLayer=function(a){var o=[],u=a.id;return u===void 0&&o.push({message:"layers."+u+': missing required property "id"'}),a.render===void 0&&o.push({message:"layers."+u+': missing required method "render"'}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&o.push({message:"layers."+u+': property "renderingMode" must be either "2d" or "3d"'}),o},h.validateLight=fd,h.validateStyle=Zl,h.values=function(a){var o=[];for(var u in a)o.push(a[u]);return o},h.vectorTile=uf,h.version="1.13.2",h.warnOnce=Nt,h.webpSupported=Zt,h.window=be,h.wrap=gt}),B(["./shared"],function(h){"use strict";function z(re){var J=typeof re;if(J==="number"||J==="boolean"||J==="string"||re==null)return JSON.stringify(re);if(Array.isArray(re)){for(var pe="[",Se=0,De=re;Se<De.length;Se+=1)pe+=z(De[Se])+",";return pe+"]"}for(var et=Object.keys(re).sort(),vt="{",_e=0;_e<et.length;_e++)vt+=JSON.stringify(et[_e])+":"+z(re[et[_e]])+",";return vt+"}"}function U(re){for(var J="",pe=0,Se=h.refProperties;pe<Se.length;pe+=1)J+="/"+z(re[Se[pe]]);return J}var Q=function(J){this.keyCache={},J&&this.replace(J)};Q.prototype.replace=function(re){this._layerConfigs={},this._layers={},this.update(re,[])},Q.prototype.update=function(re,J){for(var pe=this,Se=0,De=re;Se<De.length;Se+=1){var et=De[Se];this._layerConfigs[et.id]=et;var vt=this._layers[et.id]=h.createStyleLayer(et);vt._featureFilter=h.featureFilter(vt.filter),this.keyCache[et.id]&&delete this.keyCache[et.id]}for(var _e=0,je=J;_e<je.length;_e+=1){var $e=je[_e];delete this.keyCache[$e],delete this._layerConfigs[$e],delete this._layers[$e]}this.familiesBySource={};for(var Ar=0,kr=function(hn,xn){for(var _i={},wn=0;wn<hn.length;wn++){var Ni=xn&&xn[hn[wn].id]||U(hn[wn]);xn&&(xn[hn[wn].id]=Ni);var Ki=_i[Ni];Ki||(Ki=_i[Ni]=[]),Ki.push(hn[wn])}var Mi=[];for(var Fn in _i)Mi.push(_i[Fn]);return Mi}(h.values(this._layerConfigs),this.keyCache);Ar<kr.length;Ar+=1){var rr=kr[Ar].map(function(hn){return pe._layers[hn.id]}),Lr=rr[0];if(Lr.visibility!=="none"){var an=Lr.source||"",An=this.familiesBySource[an];An||(An=this.familiesBySource[an]={});var tr=Lr.sourceLayer||"_geojsonTileLayer",Cn=An[tr];Cn||(Cn=An[tr]=[]),Cn.push(rr)}}};var se=function(J){var pe={},Se=[];for(var De in J){var et=J[De],vt=pe[De]={};for(var _e in et){var je=et[+_e];if(je&&je.bitmap.width!==0&&je.bitmap.height!==0){var $e={x:0,y:0,w:je.bitmap.width+2,h:je.bitmap.height+2};Se.push($e),vt[_e]={rect:$e,metrics:je.metrics}}}}var Ar=h.potpack(Se),kr=new h.AlphaImage({width:Ar.w||1,height:Ar.h||1});for(var rr in J){var Lr=J[rr];for(var an in Lr){var An=Lr[+an];if(An&&An.bitmap.width!==0&&An.bitmap.height!==0){var tr=pe[rr][an].rect;h.AlphaImage.copy(An.bitmap,kr,{x:0,y:0},{x:tr.x+1,y:tr.y+1},An.bitmap)}}}this.image=kr,this.positions=pe};h.register("GlyphAtlas",se);var Ce=function(J){this.tileID=new h.OverscaledTileID(J.tileID.overscaledZ,J.tileID.wrap,J.tileID.canonical.z,J.tileID.canonical.x,J.tileID.canonical.y),this.uid=J.uid,this.zoom=J.zoom,this.pixelRatio=J.pixelRatio,this.tileSize=J.tileSize,this.source=J.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=J.showCollisionBoxes,this.collectResourceTiming=!!J.collectResourceTiming,this.returnDependencies=!!J.returnDependencies,this.promoteId=J.promoteId};function be(re,J,pe){for(var Se=new h.EvaluationParameters(J),De=0,et=re;De<et.length;De+=1)et[De].recalculate(Se,pe)}function st(re,J){var pe=h.getArrayBuffer(re.request,function(Se,De,et,vt){Se?J(Se):De&&J(null,{vectorTile:new h.vectorTile.VectorTile(new h.pbf(De)),rawData:De,cacheControl:et,expires:vt})});return function(){pe.cancel(),J()}}Ce.prototype.parse=function(re,J,pe,Se,De){var et=this;this.status="parsing",this.data=re,this.collisionBoxArray=new h.CollisionBoxArray;var vt=new h.DictionaryCoder(Object.keys(re.layers).sort()),_e=new h.FeatureIndex(this.tileID,this.promoteId);_e.bucketLayerIDs=[];var je,$e,Ar,kr,rr={},Lr={featureIndex:_e,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:pe},an=J.familiesBySource[this.source];for(var An in an){var tr=re.layers[An];if(tr){tr.version===1&&h.warnOnce('Vector tile source "'+this.source+'" layer "'+An+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Cn=vt.encode(An),hn=[],xn=0;xn<tr.length;xn++){var _i=tr.feature(xn),wn=_e.getId(_i,An);hn.push({feature:_i,id:wn,index:xn,sourceLayerIndex:Cn})}for(var Ni=0,Ki=an[An];Ni<Ki.length;Ni+=1){var Mi=Ki[Ni],Fn=Mi[0];Fn.minzoom&&this.zoom<Math.floor(Fn.minzoom)||Fn.maxzoom&&this.zoom>=Fn.maxzoom||Fn.visibility!=="none"&&(be(Mi,this.zoom,pe),(rr[Fn.id]=Fn.createBucket({index:_e.bucketLayerIDs.length,layers:Mi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Cn,sourceID:this.source})).populate(hn,Lr,this.tileID.canonical),_e.bucketLayerIDs.push(Mi.map(function(ri){return ri.id})))}}}var Ui=h.mapObject(Lr.glyphDependencies,function(ri){return Object.keys(ri).map(Number)});Object.keys(Ui).length?Se.send("getGlyphs",{uid:this.uid,stacks:Ui},function(ri,Ai){je||(je=ri,$e=Ai,Ka.call(et))}):$e={};var zo=Object.keys(Lr.iconDependencies);zo.length?Se.send("getImages",{icons:zo,source:this.source,tileID:this.tileID,type:"icons"},function(ri,Ai){je||(je=ri,Ar=Ai,Ka.call(et))}):Ar={};var ia=Object.keys(Lr.patternDependencies);function Ka(){if(je)return De(je);if($e&&Ar&&kr){var ri=new se($e),Ai=new h.ImageAtlas(Ar,kr);for(var xi in rr){var to=rr[xi];to instanceof h.SymbolBucket?(be(to.layers,this.zoom,pe),h.performSymbolLayout(to,$e,ri.positions,Ar,Ai.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):to.hasPattern&&(to instanceof h.LineBucket||to instanceof h.FillBucket||to instanceof h.FillExtrusionBucket)&&(be(to.layers,this.zoom,pe),to.addFeatures(Lr,this.tileID.canonical,Ai.patternPositions))}this.status="done",De(null,{buckets:h.values(rr).filter(function(ao){return!ao.isEmpty()}),featureIndex:_e,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ri.image,imageAtlas:Ai,glyphMap:this.returnDependencies?$e:null,iconMap:this.returnDependencies?Ar:null,glyphPositions:this.returnDependencies?ri.positions:null})}}ia.length?Se.send("getImages",{icons:ia,source:this.source,tileID:this.tileID,type:"patterns"},function(ri,Ai){je||(je=ri,kr=Ai,Ka.call(et))}):kr={},Ka.call(this)};var tt=function(J,pe,Se,De){this.actor=J,this.layerIndex=pe,this.availableImages=Se,this.loadVectorData=De||st,this.loading={},this.loaded={}};tt.prototype.loadTile=function(re,J){var pe=this,Se=re.uid;this.loading||(this.loading={});var De=!!(re&&re.request&&re.request.collectResourceTiming)&&new h.RequestPerformance(re.request),et=this.loading[Se]=new Ce(re);et.abort=this.loadVectorData(re,function(vt,_e){if(delete pe.loading[Se],vt||!_e)return et.status="done",pe.loaded[Se]=et,J(vt);var je=_e.rawData,$e={};_e.expires&&($e.expires=_e.expires),_e.cacheControl&&($e.cacheControl=_e.cacheControl);var Ar={};if(De){var kr=De.finish();kr&&(Ar.resourceTiming=JSON.parse(JSON.stringify(kr)))}et.vectorTile=_e.vectorTile,et.parse(_e.vectorTile,pe.layerIndex,pe.availableImages,pe.actor,function(rr,Lr){if(rr||!Lr)return J(rr);J(null,h.extend({rawTileData:je.slice(0)},Lr,$e,Ar))}),pe.loaded=pe.loaded||{},pe.loaded[Se]=et})},tt.prototype.reloadTile=function(re,J){var pe=this,Se=this.loaded,De=re.uid,et=this;if(Se&&Se[De]){var vt=Se[De];vt.showCollisionBoxes=re.showCollisionBoxes;var _e=function($e,Ar){var kr=vt.reloadCallback;kr&&(delete vt.reloadCallback,vt.parse(vt.vectorTile,et.layerIndex,pe.availableImages,et.actor,kr)),J($e,Ar)};vt.status==="parsing"?vt.reloadCallback=_e:vt.status==="done"&&(vt.vectorTile?vt.parse(vt.vectorTile,this.layerIndex,this.availableImages,this.actor,_e):_e())}},tt.prototype.abortTile=function(re,J){var pe=this.loading,Se=re.uid;pe&&pe[Se]&&pe[Se].abort&&(pe[Se].abort(),delete pe[Se]),J()},tt.prototype.removeTile=function(re,J){var pe=this.loaded,Se=re.uid;pe&&pe[Se]&&delete pe[Se],J()};var ut=h.window.ImageBitmap,ht=function(){this.loaded={}};function gt(re,J){if(re.length!==0){Be(re[0],J);for(var pe=1;pe<re.length;pe++)Be(re[pe],!J)}}function Be(re,J){for(var pe=0,Se=0,De=re.length,et=De-1;Se<De;et=Se++)pe+=(re[Se][0]-re[et][0])*(re[et][1]+re[Se][1]);pe>=0!=!!J&&re.reverse()}ht.prototype.loadTile=function(re,J){var pe=re.uid,Se=re.encoding,De=re.rawImageData,et=ut&&De instanceof ut?this.getImageData(De):De,vt=new h.DEMData(pe,et,Se);this.loaded=this.loaded||{},this.loaded[pe]=vt,J(null,vt)},ht.prototype.getImageData=function(re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(re.width,re.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=re.width,this.offscreenCanvas.height=re.height,this.offscreenCanvasContext.drawImage(re,0,0,re.width,re.height);var J=this.offscreenCanvasContext.getImageData(-1,-1,re.width+2,re.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new h.RGBAImage({width:J.width,height:J.height},J.data)},ht.prototype.removeTile=function(re){var J=this.loaded,pe=re.uid;J&&J[pe]&&delete J[pe]};var dt=h.vectorTile.VectorTileFeature.prototype.toGeoJSON,rt=function(J){this._feature=J,this.extent=h.EXTENT,this.type=J.type,this.properties=J.tags,"id"in J&&!isNaN(J.id)&&(this.id=parseInt(J.id,10))};rt.prototype.loadGeometry=function(){if(this._feature.type===1){for(var re=[],J=0,pe=this._feature.geometry;J<pe.length;J+=1){var Se=pe[J];re.push([new h.Point$1(Se[0],Se[1])])}return re}for(var De=[],et=0,vt=this._feature.geometry;et<vt.length;et+=1){for(var _e=[],je=0,$e=vt[et];je<$e.length;je+=1){var Ar=$e[je];_e.push(new h.Point$1(Ar[0],Ar[1]))}De.push(_e)}return De},rt.prototype.toGeoJSON=function(re,J,pe){return dt.call(this,re,J,pe)};var lt=function(J){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.EXTENT,this.length=J.length,this._features=J};lt.prototype.feature=function(re){return new rt(this._features[re])};var $=h.vectorTile.VectorTileFeature,Qt=Ir;function Ir(re,J){this.options=J||{},this.features=re,this.length=re.length}function br(re,J){this.id=typeof re.id=="number"?re.id:void 0,this.type=re.type,this.rawGeometry=re.type===1?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=J||4096}Ir.prototype.feature=function(re){return new br(this.features[re],this.options.extent)},br.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var J=0;J<re.length;J++){for(var pe=re[J],Se=[],De=0;De<pe.length;De++)Se.push(new h.Point$1(pe[De][0],pe[De][1]));this.geometry.push(Se)}return this.geometry},br.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,J=1/0,pe=-1/0,Se=1/0,De=-1/0,et=0;et<re.length;et++)for(var vt=re[et],_e=0;_e<vt.length;_e++){var je=vt[_e];J=Math.min(J,je.x),pe=Math.max(pe,je.x),Se=Math.min(Se,je.y),De=Math.max(De,je.y)}return[J,Se,pe,De]},br.prototype.toGeoJSON=$.prototype.toGeoJSON;var Rt=Mt,ke=Qt;function Mt(re){var J=new h.pbf;return function(pe,Se){for(var De in pe.layers)Se.writeMessage(3,Nt,pe.layers[De])}(re,J),J.finish()}function Nt(re,J){var pe;J.writeVarintField(15,re.version||1),J.writeStringField(1,re.name||""),J.writeVarintField(5,re.extent||4096);var Se={keys:[],values:[],keycache:{},valuecache:{}};for(pe=0;pe<re.length;pe++)Se.feature=re.feature(pe),J.writeMessage(2,nr,Se);var De=Se.keys;for(pe=0;pe<De.length;pe++)J.writeStringField(3,De[pe]);var et=Se.values;for(pe=0;pe<et.length;pe++)J.writeMessage(4,Ie,et[pe])}function nr(re,J){var pe=re.feature;pe.id!==void 0&&J.writeVarintField(1,pe.id),J.writeMessage(2,Mr,re),J.writeVarintField(3,pe.type),J.writeMessage(4,de,pe)}function Mr(re,J){var pe=re.feature,Se=re.keys,De=re.values,et=re.keycache,vt=re.valuecache;for(var _e in pe.properties){var je=et[_e];je===void 0&&(Se.push(_e),et[_e]=je=Se.length-1),J.writeVarint(je);var $e=pe.properties[_e],Ar=typeof $e;Ar!=="string"&&Ar!=="boolean"&&Ar!=="number"&&($e=JSON.stringify($e));var kr=Ar+":"+$e,rr=vt[kr];rr===void 0&&(De.push($e),vt[kr]=rr=De.length-1),J.writeVarint(rr)}}function Jr(re,J){return(J<<3)+(7&re)}function Er(re){return re<<1^re>>31}function de(re,J){for(var pe=re.loadGeometry(),Se=re.type,De=0,et=0,vt=pe.length,_e=0;_e<vt;_e++){var je=pe[_e],$e=1;Se===1&&($e=je.length),J.writeVarint(Jr(1,$e));for(var Ar=Se===3?je.length-1:je.length,kr=0;kr<Ar;kr++){kr===1&&Se!==1&&J.writeVarint(Jr(2,Ar-1));var rr=je[kr].x-De,Lr=je[kr].y-et;J.writeVarint(Er(rr)),J.writeVarint(Er(Lr)),De+=rr,et+=Lr}Se===3&&J.writeVarint(Jr(7,1))}}function Ie(re,J){var pe=typeof re;pe==="string"?J.writeStringField(1,re):pe==="boolean"?J.writeBooleanField(7,re):pe==="number"&&(re%1!=0?J.writeDoubleField(3,re):re<0?J.writeSVarintField(6,re):J.writeVarintField(5,re))}function we(re,J,pe,Se){ct(re,pe,Se),ct(J,2*pe,2*Se),ct(J,2*pe+1,2*Se+1)}function ct(re,J,pe){var Se=re[J];re[J]=re[pe],re[pe]=Se}function ot(re,J,pe,Se){var De=re-pe,et=J-Se;return De*De+et*et}Rt.fromVectorTileJs=Mt,Rt.fromGeojsonVt=function(re,J){J=J||{};var pe={};for(var Se in re)pe[Se]=new Qt(re[Se].features,J),pe[Se].name=Se,pe[Se].version=J.version,pe[Se].extent=J.extent;return Mt({layers:pe})},Rt.GeoJSONWrapper=ke;var wt=function(J){return J[0]},S=function(J){return J[1]},ur=function(J,pe,Se,De,et){pe===void 0&&(pe=wt),Se===void 0&&(Se=S),De===void 0&&(De=64),et===void 0&&(et=Float64Array),this.nodeSize=De,this.points=J;for(var vt=J.length<65536?Uint16Array:Uint32Array,_e=this.ids=new vt(J.length),je=this.coords=new et(2*J.length),$e=0;$e<J.length;$e++)_e[$e]=$e,je[2*$e]=pe(J[$e]),je[2*$e+1]=Se(J[$e]);(function Ar(kr,rr,Lr,an,An,tr){if(!(An-an<=Lr)){var Cn=an+An>>1;(function hn(xn,_i,wn,Ni,Ki,Mi){for(;Ki>Ni;){if(Ki-Ni>600){var Fn=Ki-Ni+1,Ui=wn-Ni+1,zo=Math.log(Fn),ia=.5*Math.exp(2*zo/3),Ka=.5*Math.sqrt(zo*ia*(Fn-ia)/Fn)*(Ui-Fn/2<0?-1:1);hn(xn,_i,wn,Math.max(Ni,Math.floor(wn-Ui*ia/Fn+Ka)),Math.min(Ki,Math.floor(wn+(Fn-Ui)*ia/Fn+Ka)),Mi)}var ri=_i[2*wn+Mi],Ai=Ni,xi=Ki;for(we(xn,_i,Ni,wn),_i[2*Ki+Mi]>ri&&we(xn,_i,Ni,Ki);Ai<xi;){for(we(xn,_i,Ai,xi),Ai++,xi--;_i[2*Ai+Mi]<ri;)Ai++;for(;_i[2*xi+Mi]>ri;)xi--}_i[2*Ni+Mi]===ri?we(xn,_i,Ni,xi):we(xn,_i,++xi,Ki),xi<=wn&&(Ni=xi+1),wn<=xi&&(Ki=xi-1)}})(kr,rr,Cn,an,An,tr%2),Ar(kr,rr,Lr,an,Cn-1,tr+1),Ar(kr,rr,Lr,Cn+1,An,tr+1)}})(_e,je,De,0,_e.length-1,0)};ur.prototype.range=function(re,J,pe,Se){return function(De,et,vt,_e,je,$e,Ar){for(var kr,rr,Lr=[0,De.length-1,0],an=[];Lr.length;){var An=Lr.pop(),tr=Lr.pop(),Cn=Lr.pop();if(tr-Cn<=Ar)for(var hn=Cn;hn<=tr;hn++)rr=et[2*hn+1],(kr=et[2*hn])>=vt&&kr<=je&&rr>=_e&&rr<=$e&&an.push(De[hn]);else{var xn=Math.floor((Cn+tr)/2);rr=et[2*xn+1],(kr=et[2*xn])>=vt&&kr<=je&&rr>=_e&&rr<=$e&&an.push(De[xn]);var _i=(An+1)%2;(An===0?vt<=kr:_e<=rr)&&(Lr.push(Cn),Lr.push(xn-1),Lr.push(_i)),(An===0?je>=kr:$e>=rr)&&(Lr.push(xn+1),Lr.push(tr),Lr.push(_i))}}return an}(this.ids,this.coords,re,J,pe,Se,this.nodeSize)},ur.prototype.within=function(re,J,pe){return function(Se,De,et,vt,_e,je){for(var $e=[0,Se.length-1,0],Ar=[],kr=_e*_e;$e.length;){var rr=$e.pop(),Lr=$e.pop(),an=$e.pop();if(Lr-an<=je)for(var An=an;An<=Lr;An++)ot(De[2*An],De[2*An+1],et,vt)<=kr&&Ar.push(Se[An]);else{var tr=Math.floor((an+Lr)/2),Cn=De[2*tr],hn=De[2*tr+1];ot(Cn,hn,et,vt)<=kr&&Ar.push(Se[tr]);var xn=(rr+1)%2;(rr===0?et-_e<=Cn:vt-_e<=hn)&&($e.push(an),$e.push(tr-1),$e.push(xn)),(rr===0?et+_e>=Cn:vt+_e>=hn)&&($e.push(tr+1),$e.push(Lr),$e.push(xn))}}return Ar}(this.ids,this.coords,re,J,pe,this.nodeSize)};var Pt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(J){return J}},Ft=function(J){this.options=Ur(Object.create(Pt),J),this.trees=new Array(this.options.maxZoom+1)};function Et(re,J,pe,Se,De){return{x:re,y:J,zoom:1/0,id:pe,parentId:-1,numPoints:Se,properties:De}}function St(re,J){var pe=re.geometry.coordinates,Se=pe[1];return{x:qt(pe[0]),y:pr(Se),zoom:1/0,index:J,parentId:-1}}function Zt(re){return{type:"Feature",id:re.id,properties:dr(re),geometry:{type:"Point",coordinates:[(Se=re.x,360*(Se-.5)),(J=re.y,pe=(180-360*J)*Math.PI/180,360*Math.atan(Math.exp(pe))/Math.PI-90)]}};var J,pe,Se}function dr(re){var J=re.numPoints,pe=J>=1e4?Math.round(J/1e3)+"k":J>=1e3?Math.round(J/100)/10+"k":J;return Ur(Ur({},re.properties),{cluster:!0,cluster_id:re.id,point_count:J,point_count_abbreviated:pe})}function qt(re){return re/360+.5}function pr(re){var J=Math.sin(re*Math.PI/180),pe=.5-.25*Math.log((1+J)/(1-J))/Math.PI;return pe<0?0:pe>1?1:pe}function Ur(re,J){for(var pe in J)re[pe]=J[pe];return re}function gr(re){return re.x}function or(re){return re.y}function Rr(re,J,pe,Se,De,et){var vt=De-pe,_e=et-Se;if(vt!==0||_e!==0){var je=((re-pe)*vt+(J-Se)*_e)/(vt*vt+_e*_e);je>1?(pe=De,Se=et):je>0&&(pe+=vt*je,Se+=_e*je)}return(vt=re-pe)*vt+(_e=J-Se)*_e}function Hn(re,J,pe,Se){var De={id:re===void 0?null:re,type:J,geometry:pe,tags:Se,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(et){var vt=et.geometry,_e=et.type;if(_e==="Point"||_e==="MultiPoint"||_e==="LineString")en(et,vt);else if(_e==="Polygon"||_e==="MultiLineString")for(var je=0;je<vt.length;je++)en(et,vt[je]);else if(_e==="MultiPolygon")for(je=0;je<vt.length;je++)for(var $e=0;$e<vt[je].length;$e++)en(et,vt[je][$e])}(De),De}function en(re,J){for(var pe=0;pe<J.length;pe+=3)re.minX=Math.min(re.minX,J[pe]),re.minY=Math.min(re.minY,J[pe+1]),re.maxX=Math.max(re.maxX,J[pe]),re.maxY=Math.max(re.maxY,J[pe+1])}function _n(re,J,pe,Se){if(J.geometry){var De=J.geometry.coordinates,et=J.geometry.type,vt=Math.pow(pe.tolerance/((1<<pe.maxZoom)*pe.extent),2),_e=[],je=J.id;if(pe.promoteId?je=J.properties[pe.promoteId]:pe.generateId&&(je=Se||0),et==="Point")qn(De,_e);else if(et==="MultiPoint")for(var $e=0;$e<De.length;$e++)qn(De[$e],_e);else if(et==="LineString")ii(De,_e,vt,!1);else if(et==="MultiLineString"){if(pe.lineMetrics){for($e=0;$e<De.length;$e++)ii(De[$e],_e=[],vt,!1),re.push(Hn(je,"LineString",_e,J.properties));return}Xi(De,_e,vt,!1)}else if(et==="Polygon")Xi(De,_e,vt,!0);else{if(et!=="MultiPolygon"){if(et==="GeometryCollection"){for($e=0;$e<J.geometry.geometries.length;$e++)_n(re,{id:je,geometry:J.geometry.geometries[$e],properties:J.properties},pe,Se);return}throw new Error("Input data is not a valid GeoJSON object.")}for($e=0;$e<De.length;$e++){var Ar=[];Xi(De[$e],Ar,vt,!0),_e.push(Ar)}}re.push(Hn(je,et,_e,J.properties))}}function qn(re,J){J.push(me(re[0])),J.push(yn(re[1])),J.push(0)}function ii(re,J,pe,Se){for(var De,et,vt=0,_e=0;_e<re.length;_e++){var je=me(re[_e][0]),$e=yn(re[_e][1]);J.push(je),J.push($e),J.push(0),_e>0&&(vt+=Se?(De*$e-je*et)/2:Math.sqrt(Math.pow(je-De,2)+Math.pow($e-et,2))),De=je,et=$e}var Ar=J.length-3;J[2]=1,function kr(rr,Lr,an,An){for(var tr,Cn=An,hn=an-Lr>>1,xn=an-Lr,_i=rr[Lr],wn=rr[Lr+1],Ni=rr[an],Ki=rr[an+1],Mi=Lr+3;Mi<an;Mi+=3){var Fn=Rr(rr[Mi],rr[Mi+1],_i,wn,Ni,Ki);if(Fn>Cn)tr=Mi,Cn=Fn;else if(Fn===Cn){var Ui=Math.abs(Mi-hn);Ui<xn&&(tr=Mi,xn=Ui)}}Cn>An&&(tr-Lr>3&&kr(rr,Lr,tr,An),rr[tr+2]=Cn,an-tr>3&&kr(rr,tr,an,An))}(J,0,Ar,pe),J[Ar+2]=1,J.size=Math.abs(vt),J.start=0,J.end=J.size}function Xi(re,J,pe,Se){for(var De=0;De<re.length;De++){var et=[];ii(re[De],et,pe,Se),J.push(et)}}function me(re){return re/360+.5}function yn(re){var J=Math.sin(re*Math.PI/180),pe=.5-.25*Math.log((1+J)/(1-J))/Math.PI;return pe<0?0:pe>1?1:pe}function Bi(re,J,pe,Se,De,et,vt,_e){if(Se/=J,et>=(pe/=J)&&vt<Se)return re;if(vt<pe||et>=Se)return null;for(var je=[],$e=0;$e<re.length;$e++){var Ar=re[$e],kr=Ar.geometry,rr=Ar.type,Lr=De===0?Ar.minX:Ar.minY,an=De===0?Ar.maxX:Ar.maxY;if(Lr>=pe&&an<Se)je.push(Ar);else if(!(an<pe||Lr>=Se)){var An=[];if(rr==="Point"||rr==="MultiPoint")Mo(kr,An,pe,Se,De);else if(rr==="LineString")os(kr,An,pe,Se,De,!1,_e.lineMetrics);else if(rr==="MultiLineString")_r(kr,An,pe,Se,De,!1);else if(rr==="Polygon")_r(kr,An,pe,Se,De,!0);else if(rr==="MultiPolygon")for(var tr=0;tr<kr.length;tr++){var Cn=[];_r(kr[tr],Cn,pe,Se,De,!0),Cn.length&&An.push(Cn)}if(An.length){if(_e.lineMetrics&&rr==="LineString"){for(tr=0;tr<An.length;tr++)je.push(Hn(Ar.id,rr,An[tr],Ar.tags));continue}rr!=="LineString"&&rr!=="MultiLineString"||(An.length===1?(rr="LineString",An=An[0]):rr="MultiLineString"),rr!=="Point"&&rr!=="MultiPoint"||(rr=An.length===3?"Point":"MultiPoint"),je.push(Hn(Ar.id,rr,An,Ar.tags))}}}return je.length?je:null}function Mo(re,J,pe,Se,De){for(var et=0;et<re.length;et+=3){var vt=re[et+De];vt>=pe&&vt<=Se&&(J.push(re[et]),J.push(re[et+1]),J.push(re[et+2]))}}function os(re,J,pe,Se,De,et,vt){for(var _e,je,$e=jt(re),Ar=De===0?vn:Kr,kr=re.start,rr=0;rr<re.length-3;rr+=3){var Lr=re[rr],an=re[rr+1],An=re[rr+2],tr=re[rr+3],Cn=re[rr+4],hn=De===0?Lr:an,xn=De===0?tr:Cn,_i=!1;vt&&(_e=Math.sqrt(Math.pow(Lr-tr,2)+Math.pow(an-Cn,2))),hn<pe?xn>pe&&(je=Ar($e,Lr,an,tr,Cn,pe),vt&&($e.start=kr+_e*je)):hn>Se?xn<Se&&(je=Ar($e,Lr,an,tr,Cn,Se),vt&&($e.start=kr+_e*je)):Xr($e,Lr,an,An),xn<pe&&hn>=pe&&(je=Ar($e,Lr,an,tr,Cn,pe),_i=!0),xn>Se&&hn<=Se&&(je=Ar($e,Lr,an,tr,Cn,Se),_i=!0),!et&&_i&&(vt&&($e.end=kr+_e*je),J.push($e),$e=jt(re)),vt&&(kr+=_e)}var wn=re.length-3;Lr=re[wn],an=re[wn+1],An=re[wn+2],(hn=De===0?Lr:an)>=pe&&hn<=Se&&Xr($e,Lr,an,An),wn=$e.length-3,et&&wn>=3&&($e[wn]!==$e[0]||$e[wn+1]!==$e[1])&&Xr($e,$e[0],$e[1],$e[2]),$e.length&&J.push($e)}function jt(re){var J=[];return J.size=re.size,J.start=re.start,J.end=re.end,J}function _r(re,J,pe,Se,De,et){for(var vt=0;vt<re.length;vt++)os(re[vt],J,pe,Se,De,et,!1)}function Xr(re,J,pe,Se){re.push(J),re.push(pe),re.push(Se)}function vn(re,J,pe,Se,De,et){var vt=(et-J)/(Se-J);return re.push(et),re.push(pe+(De-pe)*vt),re.push(1),vt}function Kr(re,J,pe,Se,De,et){var vt=(et-pe)/(De-pe);return re.push(J+(Se-J)*vt),re.push(et),re.push(1),vt}function ba(re,J){for(var pe=[],Se=0;Se<re.length;Se++){var De,et=re[Se],vt=et.type;if(vt==="Point"||vt==="MultiPoint"||vt==="LineString")De=li(et.geometry,J);else if(vt==="MultiLineString"||vt==="Polygon"){De=[];for(var _e=0;_e<et.geometry.length;_e++)De.push(li(et.geometry[_e],J))}else if(vt==="MultiPolygon")for(De=[],_e=0;_e<et.geometry.length;_e++){for(var je=[],$e=0;$e<et.geometry[_e].length;$e++)je.push(li(et.geometry[_e][$e],J));De.push(je)}pe.push(Hn(et.id,vt,De,et.tags))}return pe}function li(re,J){var pe=[];pe.size=re.size,re.start!==void 0&&(pe.start=re.start,pe.end=re.end);for(var Se=0;Se<re.length;Se+=3)pe.push(re[Se]+J,re[Se+1],re[Se+2]);return pe}function Xn(re,J){if(re.transformed)return re;var pe,Se,De,et=1<<re.z,vt=re.x,_e=re.y;for(pe=0;pe<re.features.length;pe++){var je=re.features[pe],$e=je.geometry,Ar=je.type;if(je.geometry=[],Ar===1)for(Se=0;Se<$e.length;Se+=2)je.geometry.push(ci($e[Se],$e[Se+1],J,et,vt,_e));else for(Se=0;Se<$e.length;Se++){var kr=[];for(De=0;De<$e[Se].length;De+=2)kr.push(ci($e[Se][De],$e[Se][De+1],J,et,vt,_e));je.geometry.push(kr)}}return re.transformed=!0,re}function ci(re,J,pe,Se,De,et){return[Math.round(pe*(re*Se-De)),Math.round(pe*(J*Se-et))]}function Hi(re,J,pe,Se,De){for(var et=J===De.maxZoom?0:De.tolerance/((1<<J)*De.extent),vt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:pe,y:Se,z:J,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},_e=0;_e<re.length;_e++){vt.numFeatures++,Yi(vt,re[_e],et,De);var je=re[_e].minX,$e=re[_e].minY,Ar=re[_e].maxX,kr=re[_e].maxY;je<vt.minX&&(vt.minX=je),$e<vt.minY&&(vt.minY=$e),Ar>vt.maxX&&(vt.maxX=Ar),kr>vt.maxY&&(vt.maxY=kr)}return vt}function Yi(re,J,pe,Se){var De=J.geometry,et=J.type,vt=[];if(et==="Point"||et==="MultiPoint")for(var _e=0;_e<De.length;_e+=3)vt.push(De[_e]),vt.push(De[_e+1]),re.numPoints++,re.numSimplified++;else if(et==="LineString")No(vt,De,re,pe,!1,!1);else if(et==="MultiLineString"||et==="Polygon")for(_e=0;_e<De.length;_e++)No(vt,De[_e],re,pe,et==="Polygon",_e===0);else if(et==="MultiPolygon")for(var je=0;je<De.length;je++){var $e=De[je];for(_e=0;_e<$e.length;_e++)No(vt,$e[_e],re,pe,!0,_e===0)}if(vt.length){var Ar=J.tags||null;if(et==="LineString"&&Se.lineMetrics){for(var kr in Ar={},J.tags)Ar[kr]=J.tags[kr];Ar.mapbox_clip_start=De.start/De.size,Ar.mapbox_clip_end=De.end/De.size}var rr={geometry:vt,type:et==="Polygon"||et==="MultiPolygon"?3:et==="LineString"||et==="MultiLineString"?2:1,tags:Ar};J.id!==null&&(rr.id=J.id),re.features.push(rr)}}function No(re,J,pe,Se,De,et){var vt=Se*Se;if(Se>0&&J.size<(De?vt:Se))pe.numPoints+=J.length/3;else{for(var _e=[],je=0;je<J.length;je+=3)(Se===0||J[je+2]>vt)&&(pe.numSimplified++,_e.push(J[je]),_e.push(J[je+1])),pe.numPoints++;De&&function($e,Ar){for(var kr=0,rr=0,Lr=$e.length,an=Lr-2;rr<Lr;an=rr,rr+=2)kr+=($e[rr]-$e[an])*($e[rr+1]+$e[an+1]);if(kr>0===Ar)for(rr=0,Lr=$e.length;rr<Lr/2;rr+=2){var An=$e[rr],tr=$e[rr+1];$e[rr]=$e[Lr-2-rr],$e[rr+1]=$e[Lr-1-rr],$e[Lr-2-rr]=An,$e[Lr-1-rr]=tr}}(_e,et),re.push(_e)}}function Ma(re,J){var pe=(J=this.options=function(De,et){for(var vt in et)De[vt]=et[vt];return De}(Object.create(this.options),J)).debug;if(pe&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");var Se=function(De,et){var vt=[];if(De.type==="FeatureCollection")for(var _e=0;_e<De.features.length;_e++)_n(vt,De.features[_e],et,_e);else _n(vt,De.type==="Feature"?De:{geometry:De},et);return vt}(re,J);this.tiles={},this.tileCoords=[],pe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Se=function(De,et){var vt=et.buffer/et.extent,_e=De,je=Bi(De,1,-1-vt,vt,0,-1,2,et),$e=Bi(De,1,1-vt,2+vt,0,-1,2,et);return(je||$e)&&(_e=Bi(De,1,-vt,1+vt,0,-1,2,et)||[],je&&(_e=ba(je,1).concat(_e)),$e&&(_e=_e.concat(ba($e,-1)))),_e}(Se,J)).length&&this.splitTile(Se,0,0,0),pe&&(Se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ma(re,J,pe){return 32*((1<<re)*pe+J)+re}function Hs(re,J){var pe=re.tileID.canonical;if(!this._geoJSONIndex)return J(null,null);var Se=this._geoJSONIndex.getTile(pe.z,pe.x,pe.y);if(!Se)return J(null,null);var De=new lt(Se.features),et=Rt(De);et.byteOffset===0&&et.byteLength===et.buffer.byteLength||(et=new Uint8Array(et)),J(null,{vectorTile:De,rawData:et.buffer})}Ft.prototype.load=function(re){var J=this.options,pe=J.log,Se=J.minZoom,De=J.maxZoom,et=J.nodeSize;pe&&console.time("total time");var vt="prepare "+re.length+" points";pe&&console.time(vt),this.points=re;for(var _e=[],je=0;je<re.length;je++)re[je].geometry&&_e.push(St(re[je],je));this.trees[De+1]=new ur(_e,gr,or,et,Float32Array),pe&&console.timeEnd(vt);for(var $e=De;$e>=Se;$e--){var Ar=+Date.now();_e=this._cluster(_e,$e),this.trees[$e]=new ur(_e,gr,or,et,Float32Array),pe&&console.log("z%d: %d clusters in %dms",$e,_e.length,+Date.now()-Ar)}return pe&&console.timeEnd("total time"),this},Ft.prototype.getClusters=function(re,J){var pe=((re[0]+180)%360+360)%360-180,Se=Math.max(-90,Math.min(90,re[1])),De=re[2]===180?180:((re[2]+180)%360+360)%360-180,et=Math.max(-90,Math.min(90,re[3]));if(re[2]-re[0]>=360)pe=-180,De=180;else if(pe>De){var vt=this.getClusters([pe,Se,180,et],J),_e=this.getClusters([-180,Se,De,et],J);return vt.concat(_e)}for(var je=this.trees[this._limitZoom(J)],$e=[],Ar=0,kr=je.range(qt(pe),pr(et),qt(De),pr(Se));Ar<kr.length;Ar+=1){var rr=je.points[kr[Ar]];$e.push(rr.numPoints?Zt(rr):this.points[rr.index])}return $e},Ft.prototype.getChildren=function(re){var J=this._getOriginId(re),pe=this._getOriginZoom(re),Se="No cluster with the specified id.",De=this.trees[pe];if(!De)throw new Error(Se);var et=De.points[J];if(!et)throw new Error(Se);for(var vt=this.options.radius/(this.options.extent*Math.pow(2,pe-1)),_e=[],je=0,$e=De.within(et.x,et.y,vt);je<$e.length;je+=1){var Ar=De.points[$e[je]];Ar.parentId===re&&_e.push(Ar.numPoints?Zt(Ar):this.points[Ar.index])}if(_e.length===0)throw new Error(Se);return _e},Ft.prototype.getLeaves=function(re,J,pe){var Se=[];return this._appendLeaves(Se,re,J=J||10,pe=pe||0,0),Se},Ft.prototype.getTile=function(re,J,pe){var Se=this.trees[this._limitZoom(re)],De=Math.pow(2,re),et=this.options,vt=et.radius/et.extent,_e=(pe-vt)/De,je=(pe+1+vt)/De,$e={features:[]};return this._addTileFeatures(Se.range((J-vt)/De,_e,(J+1+vt)/De,je),Se.points,J,pe,De,$e),J===0&&this._addTileFeatures(Se.range(1-vt/De,_e,1,je),Se.points,De,pe,De,$e),J===De-1&&this._addTileFeatures(Se.range(0,_e,vt/De,je),Se.points,-1,pe,De,$e),$e.features.length?$e:null},Ft.prototype.getClusterExpansionZoom=function(re){for(var J=this._getOriginZoom(re)-1;J<=this.options.maxZoom;){var pe=this.getChildren(re);if(J++,pe.length!==1)break;re=pe[0].properties.cluster_id}return J},Ft.prototype._appendLeaves=function(re,J,pe,Se,De){for(var et=0,vt=this.getChildren(J);et<vt.length;et+=1){var _e=vt[et],je=_e.properties;if(je&&je.cluster?De+je.point_count<=Se?De+=je.point_count:De=this._appendLeaves(re,je.cluster_id,pe,Se,De):De<Se?De++:re.push(_e),re.length===pe)break}return De},Ft.prototype._addTileFeatures=function(re,J,pe,Se,De,et){for(var vt=0,_e=re;vt<_e.length;vt+=1){var je=J[_e[vt]],$e=je.numPoints,Ar={type:1,geometry:[[Math.round(this.options.extent*(je.x*De-pe)),Math.round(this.options.extent*(je.y*De-Se))]],tags:$e?dr(je):this.points[je.index].properties},kr=void 0;$e?kr=je.id:this.options.generateId?kr=je.index:this.points[je.index].id&&(kr=this.points[je.index].id),kr!==void 0&&(Ar.id=kr),et.features.push(Ar)}},Ft.prototype._limitZoom=function(re){return Math.max(this.options.minZoom,Math.min(+re,this.options.maxZoom+1))},Ft.prototype._cluster=function(re,J){for(var pe=[],Se=this.options,De=Se.reduce,et=Se.minPoints,vt=Se.radius/(Se.extent*Math.pow(2,J)),_e=0;_e<re.length;_e++){var je=re[_e];if(!(je.zoom<=J)){je.zoom=J;for(var $e=this.trees[J+1],Ar=$e.within(je.x,je.y,vt),kr=je.numPoints||1,rr=kr,Lr=0,an=Ar;Lr<an.length;Lr+=1){var An=$e.points[an[Lr]];An.zoom>J&&(rr+=An.numPoints||1)}if(rr>=et){for(var tr=je.x*kr,Cn=je.y*kr,hn=De&&kr>1?this._map(je,!0):null,xn=(_e<<5)+(J+1)+this.points.length,_i=0,wn=Ar;_i<wn.length;_i+=1){var Ni=$e.points[wn[_i]];if(!(Ni.zoom<=J)){Ni.zoom=J;var Ki=Ni.numPoints||1;tr+=Ni.x*Ki,Cn+=Ni.y*Ki,Ni.parentId=xn,De&&(hn||(hn=this._map(je,!0)),De(hn,this._map(Ni)))}}je.parentId=xn,pe.push(Et(tr/rr,Cn/rr,xn,rr,hn))}else if(pe.push(je),rr>1)for(var Mi=0,Fn=Ar;Mi<Fn.length;Mi+=1){var Ui=$e.points[Fn[Mi]];Ui.zoom<=J||(Ui.zoom=J,pe.push(Ui))}}}return pe},Ft.prototype._getOriginId=function(re){return re-this.points.length>>5},Ft.prototype._getOriginZoom=function(re){return(re-this.points.length)%32},Ft.prototype._map=function(re,J){if(re.numPoints)return J?Ur({},re.properties):re.properties;var pe=this.points[re.index].properties,Se=this.options.map(pe);return J&&Se===pe?Ur({},Se):Se},Ma.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ma.prototype.splitTile=function(re,J,pe,Se,De,et,vt){for(var _e=[re,J,pe,Se],je=this.options,$e=je.debug;_e.length;){Se=_e.pop(),pe=_e.pop(),J=_e.pop(),re=_e.pop();var Ar=1<<J,kr=ma(J,pe,Se),rr=this.tiles[kr];if(!rr&&($e>1&&console.time("creation"),rr=this.tiles[kr]=Hi(re,J,pe,Se,je),this.tileCoords.push({z:J,x:pe,y:Se}),$e)){$e>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,pe,Se,rr.numFeatures,rr.numPoints,rr.numSimplified),console.timeEnd("creation"));var Lr="z"+J;this.stats[Lr]=(this.stats[Lr]||0)+1,this.total++}if(rr.source=re,De){if(J===je.maxZoom||J===De)continue;var an=1<<De-J;if(pe!==Math.floor(et/an)||Se!==Math.floor(vt/an))continue}else if(J===je.indexMaxZoom||rr.numPoints<=je.indexMaxPoints)continue;if(rr.source=null,re.length!==0){$e>1&&console.time("clipping");var An,tr,Cn,hn,xn,_i,wn=.5*je.buffer/je.extent,Ni=.5-wn,Ki=.5+wn,Mi=1+wn;An=tr=Cn=hn=null,xn=Bi(re,Ar,pe-wn,pe+Ki,0,rr.minX,rr.maxX,je),_i=Bi(re,Ar,pe+Ni,pe+Mi,0,rr.minX,rr.maxX,je),re=null,xn&&(An=Bi(xn,Ar,Se-wn,Se+Ki,1,rr.minY,rr.maxY,je),tr=Bi(xn,Ar,Se+Ni,Se+Mi,1,rr.minY,rr.maxY,je),xn=null),_i&&(Cn=Bi(_i,Ar,Se-wn,Se+Ki,1,rr.minY,rr.maxY,je),hn=Bi(_i,Ar,Se+Ni,Se+Mi,1,rr.minY,rr.maxY,je),_i=null),$e>1&&console.timeEnd("clipping"),_e.push(An||[],J+1,2*pe,2*Se),_e.push(tr||[],J+1,2*pe,2*Se+1),_e.push(Cn||[],J+1,2*pe+1,2*Se),_e.push(hn||[],J+1,2*pe+1,2*Se+1)}}},Ma.prototype.getTile=function(re,J,pe){var Se=this.options,De=Se.extent,et=Se.debug;if(re<0||re>24)return null;var vt=1<<re,_e=ma(re,J=(J%vt+vt)%vt,pe);if(this.tiles[_e])return Xn(this.tiles[_e],De);et>1&&console.log("drilling down to z%d-%d-%d",re,J,pe);for(var je,$e=re,Ar=J,kr=pe;!je&&$e>0;)$e--,Ar=Math.floor(Ar/2),kr=Math.floor(kr/2),je=this.tiles[ma($e,Ar,kr)];return je&&je.source?(et>1&&console.log("found parent tile z%d-%d-%d",$e,Ar,kr),et>1&&console.time("drilling down"),this.splitTile(je.source,$e,Ar,kr,re,J,pe),et>1&&console.timeEnd("drilling down"),this.tiles[_e]?Xn(this.tiles[_e],De):null):null};var il=function(re){function J(pe,Se,De,et){re.call(this,pe,Se,De,Hs),et&&(this.loadGeoJSON=et)}return re&&(J.__proto__=re),(J.prototype=Object.create(re&&re.prototype)).constructor=J,J.prototype.loadData=function(pe,Se){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Se,this._pendingLoadDataParams=pe,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},J.prototype._loadData=function(){var pe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Se=this._pendingCallback,De=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var et=!!(De&&De.request&&De.request.collectResourceTiming)&&new h.RequestPerformance(De.request);this.loadGeoJSON(De,function(vt,_e){if(vt||!_e)return Se(vt);if(typeof _e!="object")return Se(new Error("Input data given to '"+De.source+"' is not a valid GeoJSON object."));(function rr(Lr,an){var An,tr=Lr&&Lr.type;if(tr==="FeatureCollection")for(An=0;An<Lr.features.length;An++)rr(Lr.features[An],an);else if(tr==="GeometryCollection")for(An=0;An<Lr.geometries.length;An++)rr(Lr.geometries[An],an);else if(tr==="Feature")rr(Lr.geometry,an);else if(tr==="Polygon")gt(Lr.coordinates,an);else if(tr==="MultiPolygon")for(An=0;An<Lr.coordinates.length;An++)gt(Lr.coordinates[An],an);return Lr})(_e,!0);try{if(De.filter){var je=h.createExpression(De.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(je.result==="error")throw new Error(je.value.map(function(rr){return rr.key+": "+rr.message}).join(", "));var $e=_e.features.filter(function(rr){return je.value.evaluate({zoom:0},rr)});_e={type:"FeatureCollection",features:$e}}pe._geoJSONIndex=De.cluster?new Ft(function(rr){var Lr=rr.superclusterOptions,an=rr.clusterProperties;if(!an||!Lr)return Lr;for(var An={},tr={},Cn={accumulated:null,zoom:0},hn={properties:null},xn=Object.keys(an),_i=0,wn=xn;_i<wn.length;_i+=1){var Ni=wn[_i],Ki=an[Ni],Mi=Ki[0],Fn=h.createExpression(Ki[1]),Ui=h.createExpression(typeof Mi=="string"?[Mi,["accumulated"],["get",Ni]]:Mi);An[Ni]=Fn.value,tr[Ni]=Ui.value}return Lr.map=function(zo){hn.properties=zo;for(var ia={},Ka=0,ri=xn;Ka<ri.length;Ka+=1){var Ai=ri[Ka];ia[Ai]=An[Ai].evaluate(Cn,hn)}return ia},Lr.reduce=function(zo,ia){hn.properties=ia;for(var Ka=0,ri=xn;Ka<ri.length;Ka+=1){var Ai=ri[Ka];Cn.accumulated=zo[Ai],zo[Ai]=tr[Ai].evaluate(Cn,hn)}},Lr}(De)).load(_e.features):function(rr,Lr){return new Ma(rr,Lr)}(_e,De.geojsonVtOptions)}catch(rr){return Se(rr)}pe.loaded={};var Ar={};if(et){var kr=et.finish();kr&&(Ar.resourceTiming={},Ar.resourceTiming[De.source]=JSON.parse(JSON.stringify(kr)))}Se(null,Ar)})}},J.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},J.prototype.reloadTile=function(pe,Se){var De=this.loaded;return De&&De[pe.uid]?re.prototype.reloadTile.call(this,pe,Se):this.loadTile(pe,Se)},J.prototype.loadGeoJSON=function(pe,Se){if(pe.request)h.getJSON(pe.request,Se);else{if(typeof pe.data!="string")return Se(new Error("Input data given to '"+pe.source+"' is not a valid GeoJSON object."));try{return Se(null,JSON.parse(pe.data))}catch(De){return Se(new Error("Input data given to '"+pe.source+"' is not a valid GeoJSON object."))}}},J.prototype.removeSource=function(pe,Se){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Se()},J.prototype.getClusterExpansionZoom=function(pe,Se){try{Se(null,this._geoJSONIndex.getClusterExpansionZoom(pe.clusterId))}catch(De){Se(De)}},J.prototype.getClusterChildren=function(pe,Se){try{Se(null,this._geoJSONIndex.getChildren(pe.clusterId))}catch(De){Se(De)}},J.prototype.getClusterLeaves=function(pe,Se){try{Se(null,this._geoJSONIndex.getLeaves(pe.clusterId,pe.limit,pe.offset))}catch(De){Se(De)}},J}(tt),ja=function(J){var pe=this;this.self=J,this.actor=new h.Actor(J,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:tt,geojson:il},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Se,De){if(pe.workerSourceTypes[Se])throw new Error('Worker source with name "'+Se+'" already registered.');pe.workerSourceTypes[Se]=De},this.self.registerRTLTextPlugin=function(Se){if(h.plugin.isParsed())throw new Error("RTL text plugin already registered.");h.plugin.applyArabicShaping=Se.applyArabicShaping,h.plugin.processBidirectionalText=Se.processBidirectionalText,h.plugin.processStyledBidirectionalText=Se.processStyledBidirectionalText}};return ja.prototype.setReferrer=function(re,J){this.referrer=J},ja.prototype.setImages=function(re,J,pe){for(var Se in this.availableImages[re]=J,this.workerSources[re]){var De=this.workerSources[re][Se];for(var et in De)De[et].availableImages=J}pe()},ja.prototype.setLayers=function(re,J,pe){this.getLayerIndex(re).replace(J),pe()},ja.prototype.updateLayers=function(re,J,pe){this.getLayerIndex(re).update(J.layers,J.removedIds),pe()},ja.prototype.loadTile=function(re,J,pe){this.getWorkerSource(re,J.type,J.source).loadTile(J,pe)},ja.prototype.loadDEMTile=function(re,J,pe){this.getDEMWorkerSource(re,J.source).loadTile(J,pe)},ja.prototype.reloadTile=function(re,J,pe){this.getWorkerSource(re,J.type,J.source).reloadTile(J,pe)},ja.prototype.abortTile=function(re,J,pe){this.getWorkerSource(re,J.type,J.source).abortTile(J,pe)},ja.prototype.removeTile=function(re,J,pe){this.getWorkerSource(re,J.type,J.source).removeTile(J,pe)},ja.prototype.removeDEMTile=function(re,J){this.getDEMWorkerSource(re,J.source).removeTile(J)},ja.prototype.removeSource=function(re,J,pe){if(this.workerSources[re]&&this.workerSources[re][J.type]&&this.workerSources[re][J.type][J.source]){var Se=this.workerSources[re][J.type][J.source];delete this.workerSources[re][J.type][J.source],Se.removeSource!==void 0?Se.removeSource(J,pe):pe()}},ja.prototype.loadWorkerSource=function(re,J,pe){try{this.self.importScripts(J.url),pe()}catch(Se){pe(Se.toString())}},ja.prototype.syncRTLPluginState=function(re,J,pe){try{h.plugin.setState(J);var Se=h.plugin.getPluginURL();if(h.plugin.isLoaded()&&!h.plugin.isParsed()&&Se!=null){this.self.importScripts(Se);var De=h.plugin.isParsed();pe(De?void 0:new Error("RTL Text Plugin failed to import scripts from "+Se),De)}}catch(et){pe(et.toString())}},ja.prototype.getAvailableImages=function(re){var J=this.availableImages[re];return J||(J=[]),J},ja.prototype.getLayerIndex=function(re){var J=this.layerIndexes[re];return J||(J=this.layerIndexes[re]=new Q),J},ja.prototype.getWorkerSource=function(re,J,pe){var Se=this;return this.workerSources[re]||(this.workerSources[re]={}),this.workerSources[re][J]||(this.workerSources[re][J]={}),this.workerSources[re][J][pe]||(this.workerSources[re][J][pe]=new this.workerSourceTypes[J]({send:function(et,vt,_e){Se.actor.send(et,vt,_e,re)}},this.getLayerIndex(re),this.getAvailableImages(re))),this.workerSources[re][J][pe]},ja.prototype.getDEMWorkerSource=function(re,J){return this.demWorkerSources[re]||(this.demWorkerSources[re]={}),this.demWorkerSources[re][J]||(this.demWorkerSources[re][J]=new ht),this.demWorkerSources[re][J]},ja.prototype.enforceCacheSizeLimit=function(re,J){h.enforceCacheSizeLimit(J)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new ja(self)),ja}),B(["./shared"],function(h){"use strict";var z=h.createCommonjsModule(function(p){function f(E){return!l(E)}function l(E){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var I,k,W=new Blob([""],{type:"text/javascript"}),q=URL.createObjectURL(W);try{k=new Worker(q),I=!0}catch(he){I=!1}return k&&k.terminate(),URL.revokeObjectURL(q),I}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var I=document.createElement("canvas");I.width=I.height=1;var k=I.getContext("2d");if(!k)return!1;var W=k.getImageData(0,0,1,1);return W&&W.width===I.width}()?(v[T=E&&E.failIfMajorPerformanceCaveat]===void 0&&(v[T]=function(I){var k=function(q){var he=document.createElement("canvas"),ve=Object.create(f.webGLContextAttributes);return ve.failIfMajorPerformanceCaveat=q,he.probablySupportsContext?he.probablySupportsContext("webgl",ve)||he.probablySupportsContext("experimental-webgl",ve):he.supportsContext?he.supportsContext("webgl",ve)||he.supportsContext("experimental-webgl",ve):he.getContext("webgl",ve)||he.getContext("experimental-webgl",ve)}(I);if(!k)return!1;var W=k.createShader(k.VERTEX_SHADER);return!(!W||k.isContextLost())&&(k.shaderSource(W,"void main() {}"),k.compileShader(W),k.getShaderParameter(W,k.COMPILE_STATUS)===!0)}(T)),v[T]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var T}p.exports?p.exports=f:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=f,window.mapboxgl.notSupportedReason=l);var v={};f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),U={create:function(f,l,v){var E=h.window.document.createElement(f);return l!==void 0&&(E.className=l),v&&v.appendChild(E),E},createNS:function(f,l){return h.window.document.createElementNS(f,l)}},Q=h.window.document&&h.window.document.documentElement.style;function se(p){if(!Q)return p[0];for(var f=0;f<p.length;f++)if(p[f]in Q)return p[f];return p[0]}var Ce,be=se(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);U.disableDrag=function(){Q&&be&&(Ce=Q[be],Q[be]="none")},U.enableDrag=function(){Q&&be&&(Q[be]=Ce)};var st=se(["transform","WebkitTransform"]);U.setTransform=function(p,f){p.style[st]=f};var tt=!1;try{var ut=Object.defineProperty({},"passive",{get:function(){tt=!0}});h.window.addEventListener("test",ut,ut),h.window.removeEventListener("test",ut,ut)}catch(p){tt=!1}U.addEventListener=function(p,f,l,v){v===void 0&&(v={}),p.addEventListener(f,l,"passive"in v&&tt?v:v.capture)},U.removeEventListener=function(p,f,l,v){v===void 0&&(v={}),p.removeEventListener(f,l,"passive"in v&&tt?v:v.capture)};var ht=function p(f){f.preventDefault(),f.stopPropagation(),h.window.removeEventListener("click",p,!0)};function gt(p){var f=p.userImage;return!!(f&&f.render&&f.render())&&(p.data.replace(new Uint8Array(f.data.buffer)),!0)}U.suppressClick=function(){h.window.addEventListener("click",ht,!0),h.window.setTimeout(function(){h.window.removeEventListener("click",ht,!0)},0)},U.mousePos=function(p,f){var l=p.getBoundingClientRect();return new h.Point(f.clientX-l.left-p.clientLeft,f.clientY-l.top-p.clientTop)},U.touchPos=function(p,f){for(var l=p.getBoundingClientRect(),v=[],E=0;E<f.length;E++)v.push(new h.Point(f[E].clientX-l.left-p.clientLeft,f[E].clientY-l.top-p.clientTop));return v},U.mouseButton=function(p){return h.window.InstallTrigger!==void 0&&p.button===2&&p.ctrlKey&&h.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:p.button},U.remove=function(p){p.parentNode&&p.parentNode.removeChild(p)};var Be=function(p){function f(){p.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.RGBAImage({width:1,height:1}),this.dirty=!0}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.isLoaded=function(){return this.loaded},f.prototype.setLoaded=function(l){if(this.loaded!==l&&(this.loaded=l,l)){for(var v=0,E=this.requestors;v<E.length;v+=1){var T=E[v];this._notify(T.ids,T.callback)}this.requestors=[]}},f.prototype.getImage=function(l){return this.images[l]},f.prototype.addImage=function(l,v){this._validate(l,v)&&(this.images[l]=v)},f.prototype._validate=function(l,v){var E=!0;return this._validateStretch(v.stretchX,v.data&&v.data.width)||(this.fire(new h.ErrorEvent(new Error('Image "'+l+'" has invalid "stretchX" value'))),E=!1),this._validateStretch(v.stretchY,v.data&&v.data.height)||(this.fire(new h.ErrorEvent(new Error('Image "'+l+'" has invalid "stretchY" value'))),E=!1),this._validateContent(v.content,v)||(this.fire(new h.ErrorEvent(new Error('Image "'+l+'" has invalid "content" value'))),E=!1),E},f.prototype._validateStretch=function(l,v){if(!l)return!0;for(var E=0,T=0,I=l;T<I.length;T+=1){var k=I[T];if(k[0]<E||k[1]<k[0]||v<k[1])return!1;E=k[1]}return!0},f.prototype._validateContent=function(l,v){return!(l&&(l.length!==4||l[0]<0||v.data.width<l[0]||l[1]<0||v.data.height<l[1]||l[2]<0||v.data.width<l[2]||l[3]<0||v.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))},f.prototype.updateImage=function(l,v){v.version=this.images[l].version+1,this.images[l]=v,this.updatedImages[l]=!0},f.prototype.removeImage=function(l){var v=this.images[l];delete this.images[l],delete this.patterns[l],v.userImage&&v.userImage.onRemove&&v.userImage.onRemove()},f.prototype.listImages=function(){return Object.keys(this.images)},f.prototype.getImages=function(l,v){var E=!0;if(!this.isLoaded())for(var T=0,I=l;T<I.length;T+=1)this.images[I[T]]||(E=!1);this.isLoaded()||E?this._notify(l,v):this.requestors.push({ids:l,callback:v})},f.prototype._notify=function(l,v){for(var E={},T=0,I=l;T<I.length;T+=1){var k=I[T];this.images[k]||this.fire(new h.Event("styleimagemissing",{id:k}));var W=this.images[k];W?E[k]={data:W.data.clone(),pixelRatio:W.pixelRatio,sdf:W.sdf,version:W.version,stretchX:W.stretchX,stretchY:W.stretchY,content:W.content,hasRenderCallback:Boolean(W.userImage&&W.userImage.render)}:h.warnOnce('Image "'+k+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}v(null,E)},f.prototype.getPixelSize=function(){var l=this.atlasImage;return{width:l.width,height:l.height}},f.prototype.getPattern=function(l){var v=this.patterns[l],E=this.getImage(l);if(!E)return null;if(v&&v.position.version===E.version)return v.position;if(v)v.position.version=E.version;else{var T={w:E.data.width+2,h:E.data.height+2,x:0,y:0},I=new h.ImagePosition(T,E);this.patterns[l]={bin:T,position:I}}return this._updatePatternAtlas(),this.patterns[l].position},f.prototype.bind=function(l){var v=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new h.Texture(l,this.atlasImage,v.RGBA),this.atlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE)},f.prototype._updatePatternAtlas=function(){var l=[];for(var v in this.patterns)l.push(this.patterns[v].bin);var E=h.potpack(l),T=E.w,I=E.h,k=this.atlasImage;for(var W in k.resize({width:T||1,height:I||1}),this.patterns){var q=this.patterns[W].bin,he=q.x+1,ve=q.y+1,xe=this.images[W].data,Ne=xe.width,Re=xe.height;h.RGBAImage.copy(xe,k,{x:0,y:0},{x:he,y:ve},{width:Ne,height:Re}),h.RGBAImage.copy(xe,k,{x:0,y:Re-1},{x:he,y:ve-1},{width:Ne,height:1}),h.RGBAImage.copy(xe,k,{x:0,y:0},{x:he,y:ve+Re},{width:Ne,height:1}),h.RGBAImage.copy(xe,k,{x:Ne-1,y:0},{x:he-1,y:ve},{width:1,height:Re}),h.RGBAImage.copy(xe,k,{x:0,y:0},{x:he+Ne,y:ve},{width:1,height:Re})}this.dirty=!0},f.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},f.prototype.dispatchRenderCallbacks=function(l){for(var v=0,E=l;v<E.length;v+=1){var T=E[v];if(!this.callbackDispatchedThisFrame[T]){this.callbackDispatchedThisFrame[T]=!0;var I=this.images[T];gt(I)&&this.updateImage(T,I)}}},f}(h.Evented),dt=$,rt=$,lt=1e20;function $(p,f,l,v,E,T){this.fontSize=p||24,this.buffer=f===void 0?3:f,this.cutoff=v||.25,this.fontFamily=E||"sans-serif",this.fontWeight=T||"normal",this.radius=l||8;var I=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=I,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.d=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Int16Array(I),this.middle=Math.round(I/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Qt(p,f,l,v,E,T,I){for(var k=0;k<f;k++){for(var W=0;W<l;W++)v[W]=p[W*f+k];for(Ir(v,E,T,I,l),W=0;W<l;W++)p[W*f+k]=E[W]}for(W=0;W<l;W++){for(k=0;k<f;k++)v[k]=p[W*f+k];for(Ir(v,E,T,I,f),k=0;k<f;k++)p[W*f+k]=Math.sqrt(E[k])}}function Ir(p,f,l,v,E){l[0]=0,v[0]=-lt,v[1]=+lt;for(var T=1,I=0;T<E;T++){for(var k=(p[T]+T*T-(p[l[I]]+l[I]*l[I]))/(2*T-2*l[I]);k<=v[I];)I--,k=(p[T]+T*T-(p[l[I]]+l[I]*l[I]))/(2*T-2*l[I]);l[++I]=T,v[I]=k,v[I+1]=+lt}for(T=0,I=0;T<E;T++){for(;v[I+1]<T;)I++;f[T]=(T-l[I])*(T-l[I])+p[l[I]]}}$.prototype.draw=function(p){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(p,this.buffer,this.middle);for(var f=this.ctx.getImageData(0,0,this.size,this.size),l=new Uint8ClampedArray(this.size*this.size),v=0;v<this.size*this.size;v++){var E=f.data[4*v+3]/255;this.gridOuter[v]=E===1?0:E===0?lt:Math.pow(Math.max(0,.5-E),2),this.gridInner[v]=E===1?lt:E===0?0:Math.pow(Math.max(0,E-.5),2)}for(Qt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Qt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),v=0;v<this.size*this.size;v++)l[v]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[v]-this.gridInner[v])/this.radius+this.cutoff))));return l},dt.default=rt;var br=function(f,l){this.requestManager=f,this.localIdeographFontFamily=l,this.entries={}};br.prototype.setURL=function(p){this.url=p},br.prototype.getGlyphs=function(p,f){var l=this,v=[];for(var E in p)for(var T=0,I=p[E];T<I.length;T+=1)v.push({stack:E,id:I[T]});h.asyncAll(v,function(k,W){var q=k.stack,he=k.id,ve=l.entries[q];ve||(ve=l.entries[q]={glyphs:{},requests:{},ranges:{}});var xe=ve.glyphs[he];if(xe===void 0){if(xe=l._tinySDF(ve,q,he))return ve.glyphs[he]=xe,void W(null,{stack:q,id:he,glyph:xe});var Ne=Math.floor(he/256);if(256*Ne>65535)W(new Error("glyphs > 65535 not supported"));else if(ve.ranges[Ne])W(null,{stack:q,id:he,glyph:xe});else{var Re=ve.requests[Ne];Re||(Re=ve.requests[Ne]=[],br.loadGlyphRange(q,Ne,l.url,l.requestManager,function(Ye,ze){if(ze){for(var Ge in ze)l._doesCharSupportLocalGlyph(+Ge)||(ve.glyphs[+Ge]=ze[+Ge]);ve.ranges[Ne]=!0}for(var xt=0,_t=Re;xt<_t.length;xt+=1)(0,_t[xt])(Ye,ze);delete ve.requests[Ne]})),Re.push(function(Ye,ze){Ye?W(Ye):ze&&W(null,{stack:q,id:he,glyph:ze[he]||null})})}}else W(null,{stack:q,id:he,glyph:xe})},function(k,W){if(k)f(k);else if(W){for(var q={},he=0,ve=W;he<ve.length;he+=1){var xe=ve[he],Ne=xe.stack,Re=xe.id,Ye=xe.glyph;(q[Ne]||(q[Ne]={}))[Re]=Ye&&{id:Ye.id,bitmap:Ye.bitmap.clone(),metrics:Ye.metrics}}f(null,q)}})},br.prototype._doesCharSupportLocalGlyph=function(p){return!!this.localIdeographFontFamily&&(h.isChar["CJK Unified Ideographs"](p)||h.isChar["Hangul Syllables"](p)||h.isChar.Hiragana(p)||h.isChar.Katakana(p))},br.prototype._tinySDF=function(p,f,l){var v=this.localIdeographFontFamily;if(v&&this._doesCharSupportLocalGlyph(l)){var E=p.tinySDF;if(!E){var T="400";/bold/i.test(f)?T="900":/medium/i.test(f)?T="500":/light/i.test(f)&&(T="200"),E=p.tinySDF=new br.TinySDF(24,3,8,.25,v,T)}return{id:l,bitmap:new h.AlphaImage({width:30,height:30},E.draw(String.fromCharCode(l))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},br.loadGlyphRange=function(p,f,l,v,E){var T=256*f,I=T+255,k=v.transformRequest(v.normalizeGlyphsURL(l).replace("{fontstack}",p).replace("{range}",T+"-"+I),h.ResourceType.Glyphs);h.getArrayBuffer(k,function(W,q){if(W)E(W);else if(q){for(var he={},ve=0,xe=h.parseGlyphPBF(q);ve<xe.length;ve+=1){var Ne=xe[ve];he[Ne.id]=Ne}E(null,he)}})},br.TinySDF=dt;var Rt=function(){this.specification=h.styleSpec.light.position};Rt.prototype.possiblyEvaluate=function(p,f){return h.sphericalToCartesian(p.expression.evaluate(f))},Rt.prototype.interpolate=function(p,f,l){return{x:h.number(p.x,f.x,l),y:h.number(p.y,f.y,l),z:h.number(p.z,f.z,l)}};var ke=new h.Properties({anchor:new h.DataConstantProperty(h.styleSpec.light.anchor),position:new Rt,color:new h.DataConstantProperty(h.styleSpec.light.color),intensity:new h.DataConstantProperty(h.styleSpec.light.intensity)}),Mt=function(p){function f(l){p.call(this),this._transitionable=new h.Transitionable(ke),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getLight=function(){return this._transitionable.serialize()},f.prototype.setLight=function(l,v){if(v===void 0&&(v={}),!this._validate(h.validateLight,l,v))for(var E in l){var T=l[E];h.endsWith(E,"-transition")?this._transitionable.setTransition(E.slice(0,-"-transition".length),T):this._transitionable.setValue(E,T)}},f.prototype.updateTransitions=function(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)},f.prototype.hasTransition=function(){return this._transitioning.hasTransition()},f.prototype.recalculate=function(l){this.properties=this._transitioning.possiblyEvaluate(l)},f.prototype._validate=function(l,v,E){return(!E||E.validate!==!1)&&h.emitValidationErrors(this,l.call(h.validateStyle,h.extend({value:v,style:{glyphs:!0,sprite:!0},styleSpec:h.styleSpec})))},f}(h.Evented),Nt=function(f,l){this.width=f,this.height=l,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Nt.prototype.getDash=function(p,f){var l=p.join(",")+String(f);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(p,f)),this.dashEntry[l]},Nt.prototype.getDashRanges=function(p,f,l){var v=[],E=p.length%2==1?-p[p.length-1]*l:0,T=p[0]*l,I=!0;v.push({left:E,right:T,isDash:I,zeroLength:p[0]===0});for(var k=p[0],W=1;W<p.length;W++){var q=p[W];v.push({left:E=k*l,right:T=(k+=q)*l,isDash:I=!I,zeroLength:q===0})}return v},Nt.prototype.addRoundDash=function(p,f,l){for(var v=f/2,E=-l;E<=l;E++)for(var T=this.width*(this.nextRow+l+E),I=0,k=p[I],W=0;W<this.width;W++){W/k.right>1&&(k=p[++I]);var q=Math.abs(W-k.left),he=Math.abs(W-k.right),ve=Math.min(q,he),xe=void 0,Ne=E/l*(v+1);if(k.isDash){var Re=v-Math.abs(Ne);xe=Math.sqrt(ve*ve+Re*Re)}else xe=v-Math.sqrt(ve*ve+Ne*Ne);this.data[T+W]=Math.max(0,Math.min(255,xe+128))}},Nt.prototype.addRegularDash=function(p){for(var f=p.length-1;f>=0;--f){var l=p[f],v=p[f+1];l.zeroLength?p.splice(f,1):v&&v.isDash===l.isDash&&(v.left=l.left,p.splice(f,1))}var E=p[0],T=p[p.length-1];E.isDash===T.isDash&&(E.left=T.left-this.width,T.right=E.right+this.width);for(var I=this.width*this.nextRow,k=0,W=p[k],q=0;q<this.width;q++){q/W.right>1&&(W=p[++k]);var he=Math.abs(q-W.left),ve=Math.abs(q-W.right),xe=Math.min(he,ve);this.data[I+q]=Math.max(0,Math.min(255,(W.isDash?xe:-xe)+128))}},Nt.prototype.addDash=function(p,f){var l=f?7:0,v=2*l+1;if(this.nextRow+v>this.height)return h.warnOnce("LineAtlas out of space"),null;for(var E=0,T=0;T<p.length;T++)E+=p[T];if(E!==0){var I=this.width/E,k=this.getDashRanges(p,this.width,I);f?this.addRoundDash(k,I,l):this.addRegularDash(k)}var W={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:E};return this.nextRow+=v,this.dirty=!0,W},Nt.prototype.bind=function(p){var f=p.gl;this.texture?(f.bindTexture(f.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,f.texSubImage2D(f.TEXTURE_2D,0,0,0,this.width,this.height,f.ALPHA,f.UNSIGNED_BYTE,this.data))):(this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.ALPHA,this.width,this.height,0,f.ALPHA,f.UNSIGNED_BYTE,this.data))};var nr=function p(f,l){this.workerPool=f,this.actors=[],this.currentActor=0,this.id=h.uniqueId();for(var v=this.workerPool.acquire(this.id),E=0;E<v.length;E++){var T=new p.Actor(v[E],l,this.id);T.name="Worker "+E,this.actors.push(T)}};function Mr(p,f,l){var v=function(T,I){if(T)return l(T);if(I){var k=h.pick(h.extend(I,p),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(k.vectorLayers=I.vector_layers,k.vectorLayerIds=k.vectorLayers.map(function(W){return W.id})),k.tiles=f.canonicalizeTileset(k,p.url),l(null,k)}};return p.url?h.getJSON(f.transformRequest(f.normalizeSourceURL(p.url),h.ResourceType.Source),v):h.browser.frame(function(){return v(null,p)})}nr.prototype.broadcast=function(p,f,l){h.asyncAll(this.actors,function(v,E){v.send(p,f,E)},l=l||function(){})},nr.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},nr.prototype.remove=function(){this.actors.forEach(function(p){p.remove()}),this.actors=[],this.workerPool.release(this.id)},nr.Actor=h.Actor;var Jr=function(f,l,v){this.bounds=h.LngLatBounds.convert(this.validateBounds(f)),this.minzoom=l||0,this.maxzoom=v||24};Jr.prototype.validateBounds=function(p){return Array.isArray(p)&&p.length===4?[Math.max(-180,p[0]),Math.max(-90,p[1]),Math.min(180,p[2]),Math.min(90,p[3])]:[-180,-90,180,90]},Jr.prototype.contains=function(p){var f=Math.pow(2,p.z),l=Math.floor(h.mercatorXfromLng(this.bounds.getWest())*f),v=Math.floor(h.mercatorYfromLat(this.bounds.getNorth())*f),E=Math.ceil(h.mercatorXfromLng(this.bounds.getEast())*f),T=Math.ceil(h.mercatorYfromLat(this.bounds.getSouth())*f);return p.x>=l&&p.x<E&&p.y>=v&&p.y<T};var Er=function(p){function f(l,v,E,T){if(p.call(this),this.id=l,this.dispatcher=E,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.extend(this,h.pick(v,["url","scheme","tileSize","promoteId"])),this._options=h.extend({type:"vector"},v),this._collectResourceTiming=v.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(T)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.load=function(){var l=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Mr(this._options,this.map._requestManager,function(v,E){l._tileJSONRequest=null,l._loaded=!0,v?l.fire(new h.ErrorEvent(v)):E&&(h.extend(l,E),E.bounds&&(l.tileBounds=new Jr(E.bounds,l.minzoom,l.maxzoom)),h.postTurnstileEvent(E.tiles,l.map._requestManager._customAccessToken),h.postMapLoadEvent(E.tiles,l.map._getMapId(),l.map._requestManager._skuToken,l.map._requestManager._customAccessToken),l.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),l.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.hasTile=function(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)},f.prototype.onAdd=function(l){this.map=l,this.load()},f.prototype.setSourceProperty=function(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},f.prototype.setTiles=function(l){var v=this;return this.setSourceProperty(function(){v._options.tiles=l}),this},f.prototype.setUrl=function(l){var v=this;return this.setSourceProperty(function(){v.url=l,v._options.url=l}),this},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return h.extend({},this._options)},f.prototype.loadTile=function(l,v){var E=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),T={request:this.map._requestManager.transformRequest(E,h.ResourceType.Tile),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:h.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function I(k,W){return delete l.request,l.aborted?v(null):k&&k.status!==404?v(k):(W&&W.resourceTiming&&(l.resourceTiming=W.resourceTiming),this.map._refreshExpiredTiles&&W&&l.setExpiryData(W),l.loadVectorData(W,this.map.painter),h.cacheEntryPossiblyAdded(this.dispatcher),v(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}T.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired"?l.state==="loading"?l.reloadCallback=v:l.request=l.actor.send("reloadTile",T,I.bind(this)):(l.actor=this.dispatcher.getActor(),l.request=l.actor.send("loadTile",T,I.bind(this)))},f.prototype.abortTile=function(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id},void 0)},f.prototype.unloadTile=function(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id},void 0)},f.prototype.hasTransition=function(){return!1},f}(h.Evented),de=function(p){function f(l,v,E,T){p.call(this),this.id=l,this.dispatcher=E,this.setEventedParent(T),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.extend({type:"raster"},v),h.extend(this,h.pick(v,["url","scheme","tileSize"]))}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.load=function(){var l=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Mr(this._options,this.map._requestManager,function(v,E){l._tileJSONRequest=null,l._loaded=!0,v?l.fire(new h.ErrorEvent(v)):E&&(h.extend(l,E),E.bounds&&(l.tileBounds=new Jr(E.bounds,l.minzoom,l.maxzoom)),h.postTurnstileEvent(E.tiles),h.postMapLoadEvent(E.tiles,l.map._getMapId(),l.map._requestManager._skuToken),l.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),l.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.onAdd=function(l){this.map=l,this.load()},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return h.extend({},this._options)},f.prototype.hasTile=function(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)},f.prototype.loadTile=function(l,v){var E=this,T=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);l.request=h.getImage(this.map._requestManager.transformRequest(T,h.ResourceType.Tile),function(I,k){if(delete l.request,l.aborted)l.state="unloaded",v(null);else if(I)l.state="errored",v(I);else if(k){E.map._refreshExpiredTiles&&l.setExpiryData(k),delete k.cacheControl,delete k.expires;var W=E.map.painter.context,q=W.gl;l.texture=E.map.painter.getTileTexture(k.width),l.texture?l.texture.update(k,{useMipmap:!0}):(l.texture=new h.Texture(W,k,q.RGBA,{useMipmap:!0}),l.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),W.extTextureFilterAnisotropic&&q.texParameterf(q.TEXTURE_2D,W.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,W.extTextureFilterAnisotropicMax)),l.state="loaded",h.cacheEntryPossiblyAdded(E.dispatcher),v(null)}})},f.prototype.abortTile=function(l,v){l.request&&(l.request.cancel(),delete l.request),v()},f.prototype.unloadTile=function(l,v){l.texture&&this.map.painter.saveTileTexture(l.texture),v()},f.prototype.hasTransition=function(){return!1},f}(h.Evented),Ie=function(p){function f(l,v,E,T){p.call(this,l,v,E,T),this.type="raster-dem",this.maxzoom=22,this._options=h.extend({type:"raster-dem"},v),this.encoding=v.encoding||"mapbox"}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},f.prototype.loadTile=function(l,v){var E=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function T(I,k){I&&(l.state="errored",v(I)),k&&(l.dem=k,l.needsHillshadePrepare=!0,l.state="loaded",v(null))}l.request=h.getImage(this.map._requestManager.transformRequest(E,h.ResourceType.Tile),function(I,k){if(delete l.request,l.aborted)l.state="unloaded",v(null);else if(I)l.state="errored",v(I);else if(k){this.map._refreshExpiredTiles&&l.setExpiryData(k),delete k.cacheControl,delete k.expires;var W=h.window.ImageBitmap&&k instanceof h.window.ImageBitmap&&h.offscreenCanvasSupported()?k:h.browser.getImageData(k,1),q={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:W,encoding:this.encoding};l.actor&&l.state!=="expired"||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",q,T.bind(this)))}}.bind(this)),l.neighboringTiles=this._getNeighboringTiles(l.tileID)},f.prototype._getNeighboringTiles=function(l){var v=l.canonical,E=Math.pow(2,v.z),T=(v.x-1+E)%E,I=v.x===0?l.wrap-1:l.wrap,k=(v.x+1+E)%E,W=v.x+1===E?l.wrap+1:l.wrap,q={};return q[new h.OverscaledTileID(l.overscaledZ,I,v.z,T,v.y).key]={backfilled:!1},q[new h.OverscaledTileID(l.overscaledZ,W,v.z,k,v.y).key]={backfilled:!1},v.y>0&&(q[new h.OverscaledTileID(l.overscaledZ,I,v.z,T,v.y-1).key]={backfilled:!1},q[new h.OverscaledTileID(l.overscaledZ,l.wrap,v.z,v.x,v.y-1).key]={backfilled:!1},q[new h.OverscaledTileID(l.overscaledZ,W,v.z,k,v.y-1).key]={backfilled:!1}),v.y+1<E&&(q[new h.OverscaledTileID(l.overscaledZ,I,v.z,T,v.y+1).key]={backfilled:!1},q[new h.OverscaledTileID(l.overscaledZ,l.wrap,v.z,v.x,v.y+1).key]={backfilled:!1},q[new h.OverscaledTileID(l.overscaledZ,W,v.z,k,v.y+1).key]={backfilled:!1}),q},f.prototype.unloadTile=function(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&l.actor.send("removeDEMTile",{uid:l.uid,source:this.id})},f}(de),we=function(p){function f(l,v,E,T){p.call(this),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=E.getActor(),this.setEventedParent(T),this._data=v.data,this._options=h.extend({},v),this._collectResourceTiming=v.collectResourceTiming,this._resourceTiming=[],v.maxzoom!==void 0&&(this.maxzoom=v.maxzoom),v.type&&(this.type=v.type),v.attribution&&(this.attribution=v.attribution),this.promoteId=v.promoteId;var I=h.EXTENT/this.tileSize;this.workerOptions=h.extend({source:this.id,cluster:v.cluster||!1,geojsonVtOptions:{buffer:(v.buffer!==void 0?v.buffer:128)*I,tolerance:(v.tolerance!==void 0?v.tolerance:.375)*I,extent:h.EXTENT,maxZoom:this.maxzoom,lineMetrics:v.lineMetrics||!1,generateId:v.generateId||!1},superclusterOptions:{maxZoom:v.clusterMaxZoom!==void 0?Math.min(v.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,v.clusterMinPoints||2),extent:h.EXTENT,radius:(v.clusterRadius||50)*I,log:!1,generateId:v.generateId||!1},clusterProperties:v.clusterProperties,filter:v.filter},v.workerOptions)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.load=function(){var l=this;this.fire(new h.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(v){if(v)l.fire(new h.ErrorEvent(v));else{var E={dataType:"source",sourceDataType:"metadata"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(E.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new h.Event("data",E))}})},f.prototype.onAdd=function(l){this.map=l,this.load()},f.prototype.setData=function(l){var v=this;return this._data=l,this.fire(new h.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(E){if(E)v.fire(new h.ErrorEvent(E));else{var T={dataType:"source",sourceDataType:"content"};v._collectResourceTiming&&v._resourceTiming&&v._resourceTiming.length>0&&(T.resourceTiming=v._resourceTiming,v._resourceTiming=[]),v.fire(new h.Event("data",T))}}),this},f.prototype.getClusterExpansionZoom=function(l,v){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},v),this},f.prototype.getClusterChildren=function(l,v){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},v),this},f.prototype.getClusterLeaves=function(l,v,E,T){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:v,offset:E},T),this},f.prototype._updateWorkerData=function(l){var v=this;this._loaded=!1;var E=h.extend({},this.workerOptions),T=this._data;typeof T=="string"?(E.request=this.map._requestManager.transformRequest(h.browser.resolveURL(T),h.ResourceType.Source),E.request.collectResourceTiming=this._collectResourceTiming):E.data=JSON.stringify(T),this.actor.send(this.type+".loadData",E,function(I,k){v._removed||k&&k.abandoned||(v._loaded=!0,k&&k.resourceTiming&&k.resourceTiming[v.id]&&(v._resourceTiming=k.resourceTiming[v.id].slice(0)),v.actor.send(v.type+".coalesce",{source:E.source},null),l(I))})},f.prototype.loaded=function(){return this._loaded},f.prototype.loadTile=function(l,v){var E=this,T=l.actor?"reloadTile":"loadTile";l.actor=this.actor,l.request=this.actor.send(T,{type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:h.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(I,k){return delete l.request,l.unloadVectorData(),l.aborted?v(null):I?v(I):(l.loadVectorData(k,E.map.painter,T==="reloadTile"),v(null))})},f.prototype.abortTile=function(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0},f.prototype.unloadTile=function(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})},f.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},f.prototype.serialize=function(){return h.extend({},this._options,{type:this.type,data:this._data})},f.prototype.hasTransition=function(){return!1},f}(h.Evented),ct=h.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ot=function(p){function f(l,v,E,T){p.call(this),this.id=l,this.dispatcher=E,this.coordinates=v.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(T),this.options=v}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.load=function(l,v){var E=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this.url=this.options.url,h.getImage(this.map._requestManager.transformRequest(this.url,h.ResourceType.Image),function(T,I){E._loaded=!0,T?E.fire(new h.ErrorEvent(T)):I&&(E.image=I,l&&(E.coordinates=l),v&&v(),E._finishLoading())})},f.prototype.loaded=function(){return this._loaded},f.prototype.updateImage=function(l){var v=this;return this.image&&l.url?(this.options.url=l.url,this.load(l.coordinates,function(){v.texture=null}),this):this},f.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})))},f.prototype.onAdd=function(l){this.map=l,this.load()},f.prototype.setCoordinates=function(l){var v=this;this.coordinates=l;var E=l.map(h.MercatorCoordinate.fromLngLat);this.tileID=function(I){for(var k=1/0,W=1/0,q=-1/0,he=-1/0,ve=0,xe=I;ve<xe.length;ve+=1){var Ne=xe[ve];k=Math.min(k,Ne.x),W=Math.min(W,Ne.y),q=Math.max(q,Ne.x),he=Math.max(he,Ne.y)}var Re=Math.max(q-k,he-W),Ye=Math.max(0,Math.floor(-Math.log(Re)/Math.LN2)),ze=Math.pow(2,Ye);return new h.CanonicalTileID(Ye,Math.floor((k+q)/2*ze),Math.floor((W+he)/2*ze))}(E),this.minzoom=this.maxzoom=this.tileID.z;var T=E.map(function(I){return v.tileID.getTilePoint(I)._round()});return this._boundsArray=new h.StructArrayLayout4i8,this._boundsArray.emplaceBack(T[0].x,T[0].y,0,0),this._boundsArray.emplaceBack(T[1].x,T[1].y,h.EXTENT,0),this._boundsArray.emplaceBack(T[3].x,T[3].y,0,h.EXTENT),this._boundsArray.emplaceBack(T[2].x,T[2].y,h.EXTENT,h.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})),this},f.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var l=this.map.painter.context,v=l.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,ct.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new h.Texture(l,this.image,v.RGBA),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE)),this.tiles){var T=this.tiles[E];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture)}}},f.prototype.loadTile=function(l,v){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},v(null)):(l.state="errored",v(null))},f.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return!1},f}(h.Evented),wt=function(p){function f(l,v,E,T){p.call(this,l,v,E,T),this.roundZoom=!0,this.type="video",this.options=v}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.load=function(){var l=this;this._loaded=!1;var v=this.options;this.urls=[];for(var E=0,T=v.urls;E<T.length;E+=1)this.urls.push(this.map._requestManager.transformRequest(T[E],h.ResourceType.Source).url);h.getVideo(this.urls,function(I,k){l._loaded=!0,I?l.fire(new h.ErrorEvent(I)):k&&(l.video=k,l.video.loop=!0,l.video.addEventListener("playing",function(){l.map.triggerRepaint()}),l.map&&l.video.play(),l._finishLoading())})},f.prototype.pause=function(){this.video&&this.video.pause()},f.prototype.play=function(){this.video&&this.video.play()},f.prototype.seek=function(l){if(this.video){var v=this.video.seekable;l<v.start(0)||l>v.end(0)?this.fire(new h.ErrorEvent(new h.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+v.start(0)+" and "+v.end(0)+"-second mark."))):this.video.currentTime=l}},f.prototype.getVideo=function(){return this.video},f.prototype.onAdd=function(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},f.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var l=this.map.painter.context,v=l.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,ct.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE),v.texSubImage2D(v.TEXTURE_2D,0,0,0,v.RGBA,v.UNSIGNED_BYTE,this.video)):(this.texture=new h.Texture(l,this.video,v.RGBA),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE)),this.tiles){var T=this.tiles[E];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this.video&&!this.video.paused},f}(ot),S=function(p){function f(l,v,E,T){p.call(this,l,v,E,T),v.coordinates?Array.isArray(v.coordinates)&&v.coordinates.length===4&&!v.coordinates.some(function(I){return!Array.isArray(I)||I.length!==2||I.some(function(k){return typeof k!="number"})})||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+l,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+l,null,'missing required property "coordinates"'))),v.animate&&typeof v.animate!="boolean"&&this.fire(new h.ErrorEvent(new h.ValidationError("sources."+l,null,'optional "animate" property must be a boolean value'))),v.canvas?typeof v.canvas=="string"||v.canvas instanceof h.window.HTMLCanvasElement||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+l,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+l,null,'missing required property "canvas"'))),this.options=v,this.animate=v.animate===void 0||v.animate}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof h.window.HTMLCanvasElement?this.options.canvas:h.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},f.prototype.getCanvas=function(){return this.canvas},f.prototype.onAdd=function(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()},f.prototype.onRemove=function(){this.pause()},f.prototype.prepare=function(){var l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var v=this.map.painter.context,E=v.gl;for(var T in this.boundsBuffer||(this.boundsBuffer=v.createVertexBuffer(this._boundsArray,ct.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new h.Texture(v,this.canvas,E.RGBA,{premultiply:!0}),this.tiles){var I=this.tiles[T];I.state!=="loaded"&&(I.state="loaded",I.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this._playing},f.prototype._hasInvalidDimensions=function(){for(var l=0,v=[this.canvas.width,this.canvas.height];l<v.length;l+=1){var E=v[l];if(isNaN(E)||E<=0)return!0}return!1},f}(ot),ur={vector:Er,raster:de,"raster-dem":Ie,geojson:we,video:wt,image:ot,canvas:S};function Pt(p,f){var l=h.identity([]);return h.translate(l,l,[1,1,0]),h.scale(l,l,[.5*p.width,.5*p.height,1]),h.multiply(l,l,p.calculatePosMatrix(f.toUnwrapped()))}function Ft(p,f,l,v,E,T){var I=function(Ye,ze,Ge){if(Ye)for(var xt=0,_t=Ye;xt<_t.length;xt+=1){var fr=ze[_t[xt]];if(fr&&fr.source===Ge&&fr.type==="fill-extrusion")return!0}else for(var Vt in ze){var lr=ze[Vt];if(lr.source===Ge&&lr.type==="fill-extrusion")return!0}return!1}(E&&E.layers,f,p.id),k=T.maxPitchScaleFactor(),W=p.tilesIn(v,k,I);W.sort(Et);for(var q=[],he=0,ve=W;he<ve.length;he+=1){var xe=ve[he];q.push({wrappedTileID:xe.tileID.wrapped().key,queryResults:xe.tile.queryRenderedFeatures(f,l,p._state,xe.queryGeometry,xe.cameraQueryGeometry,xe.scale,E,T,k,Pt(p.transform,xe.tileID))})}var Ne=function(Ye){for(var ze={},Ge={},xt=0,_t=Ye;xt<_t.length;xt+=1){var fr=_t[xt],Vt=fr.queryResults,lr=fr.wrappedTileID,vr=Ge[lr]=Ge[lr]||{};for(var xr in Vt)for(var Hr=Vt[xr],cn=vr[xr]=vr[xr]||{},Un=ze[xr]=ze[xr]||[],Jn=0,oi=Hr;Jn<oi.length;Jn+=1){var ji=oi[Jn];cn[ji.featureIndex]||(cn[ji.featureIndex]=!0,Un.push(ji))}}return ze}(q);for(var Re in Ne)Ne[Re].forEach(function(Ye){var ze=Ye.feature,Ge=p.getFeatureState(ze.layer["source-layer"],ze.id);ze.source=ze.layer.source,ze.layer["source-layer"]&&(ze.sourceLayer=ze.layer["source-layer"]),ze.state=Ge});return Ne}function Et(p,f){var l=p.tileID,v=f.tileID;return l.overscaledZ-v.overscaledZ||l.canonical.y-v.canonical.y||l.wrap-v.wrap||l.canonical.x-v.canonical.x}var St=function(f,l){this.max=f,this.onRemove=l,this.reset()};St.prototype.reset=function(){for(var p in this.data)for(var f=0,l=this.data[p];f<l.length;f+=1){var v=l[f];v.timeout&&clearTimeout(v.timeout),this.onRemove(v.value)}return this.data={},this.order=[],this},St.prototype.add=function(p,f,l){var v=this,E=p.wrapped().key;this.data[E]===void 0&&(this.data[E]=[]);var T={value:f,timeout:void 0};if(l!==void 0&&(T.timeout=setTimeout(function(){v.remove(p,T)},l)),this.data[E].push(T),this.order.push(E),this.order.length>this.max){var I=this._getAndRemoveByKey(this.order[0]);I&&this.onRemove(I)}return this},St.prototype.has=function(p){return p.wrapped().key in this.data},St.prototype.getAndRemove=function(p){return this.has(p)?this._getAndRemoveByKey(p.wrapped().key):null},St.prototype._getAndRemoveByKey=function(p){var f=this.data[p].shift();return f.timeout&&clearTimeout(f.timeout),this.data[p].length===0&&delete this.data[p],this.order.splice(this.order.indexOf(p),1),f.value},St.prototype.getByKey=function(p){var f=this.data[p];return f?f[0].value:null},St.prototype.get=function(p){return this.has(p)?this.data[p.wrapped().key][0].value:null},St.prototype.remove=function(p,f){if(!this.has(p))return this;var l=p.wrapped().key,v=f===void 0?0:this.data[l].indexOf(f),E=this.data[l][v];return this.data[l].splice(v,1),E.timeout&&clearTimeout(E.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(E.value),this.order.splice(this.order.indexOf(l),1),this},St.prototype.setMaxSize=function(p){for(this.max=p;this.order.length>this.max;){var f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this},St.prototype.filter=function(p){var f=[];for(var l in this.data)for(var v=0,E=this.data[l];v<E.length;v+=1){var T=E[v];p(T.value)||f.push(T)}for(var I=0,k=f;I<k.length;I+=1){var W=k[I];this.remove(W.value.tileID,W)}};var Zt=function(f,l,v){this.context=f;var E=f.gl;this.buffer=E.createBuffer(),this.dynamicDraw=Boolean(v),this.context.unbindVAO(),f.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer};Zt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Zt.prototype.updateData=function(p){var f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,p.arrayBuffer)},Zt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var dr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},qt=function(f,l,v,E){this.length=l.length,this.attributes=v,this.itemSize=l.bytesPerElement,this.dynamicDraw=E,this.context=f;var T=f.gl;this.buffer=T.createBuffer(),f.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer};qt.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},qt.prototype.updateData=function(p){var f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,p.arrayBuffer)},qt.prototype.enableAttributes=function(p,f){for(var l=0;l<this.attributes.length;l++){var v=f.attributes[this.attributes[l].name];v!==void 0&&p.enableVertexAttribArray(v)}},qt.prototype.setVertexAttribPointers=function(p,f,l){for(var v=0;v<this.attributes.length;v++){var E=this.attributes[v],T=f.attributes[E.name];T!==void 0&&p.vertexAttribPointer(T,E.components,p[dr[E.type]],!1,this.itemSize,E.offset+this.itemSize*(l||0))}},qt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var pr=function(f){this.gl=f.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};pr.prototype.get=function(){return this.current},pr.prototype.set=function(p){},pr.prototype.getDefault=function(){return this.default},pr.prototype.setDefault=function(){this.set(this.default)};var Ur=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return h.Color.transparent},f.prototype.set=function(l){var v=this.current;(l.r!==v.r||l.g!==v.g||l.b!==v.b||l.a!==v.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)},f}(pr),gr=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return 1},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)},f}(pr),or=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return 0},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)},f}(pr),Rr=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return[!0,!0,!0,!0]},f.prototype.set=function(l){var v=this.current;(l[0]!==v[0]||l[1]!==v[1]||l[2]!==v[2]||l[3]!==v[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)},f}(pr),Hn=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return!0},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)},f}(pr),en=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return 255},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)},f}(pr),_n=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},f.prototype.set=function(l){var v=this.current;(l.func!==v.func||l.ref!==v.ref||l.mask!==v.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)},f}(pr),qn=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){var l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]},f.prototype.set=function(l){var v=this.current;(l[0]!==v[0]||l[1]!==v[1]||l[2]!==v[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)},f}(pr),ii=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(l){if(l!==this.current||this.dirty){var v=this.gl;l?v.enable(v.STENCIL_TEST):v.disable(v.STENCIL_TEST),this.current=l,this.dirty=!1}},f}(pr),Xi=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return[0,1]},f.prototype.set=function(l){var v=this.current;(l[0]!==v[0]||l[1]!==v[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)},f}(pr),me=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(l){if(l!==this.current||this.dirty){var v=this.gl;l?v.enable(v.DEPTH_TEST):v.disable(v.DEPTH_TEST),this.current=l,this.dirty=!1}},f}(pr),yn=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.LESS},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)},f}(pr),Bi=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(l){if(l!==this.current||this.dirty){var v=this.gl;l?v.enable(v.BLEND):v.disable(v.BLEND),this.current=l,this.dirty=!1}},f}(pr),Mo=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){var l=this.gl;return[l.ONE,l.ZERO]},f.prototype.set=function(l){var v=this.current;(l[0]!==v[0]||l[1]!==v[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)},f}(pr),os=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return h.Color.transparent},f.prototype.set=function(l){var v=this.current;(l.r!==v.r||l.g!==v.g||l.b!==v.b||l.a!==v.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)},f}(pr),jt=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.FUNC_ADD},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)},f}(pr),_r=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(l){if(l!==this.current||this.dirty){var v=this.gl;l?v.enable(v.CULL_FACE):v.disable(v.CULL_FACE),this.current=l,this.dirty=!1}},f}(pr),Xr=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.BACK},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)},f}(pr),vn=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.CCW},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)},f}(pr),Kr=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)},f}(pr),ba=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.TEXTURE0},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)},f}(pr),li=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){var l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]},f.prototype.set=function(l){var v=this.current;(l[0]!==v[0]||l[1]!==v[1]||l[2]!==v[2]||l[3]!==v[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)},f}(pr),Xn=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){if(l!==this.current||this.dirty){var v=this.gl;v.bindFramebuffer(v.FRAMEBUFFER,l),this.current=l,this.dirty=!1}},f}(pr),ci=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){if(l!==this.current||this.dirty){var v=this.gl;v.bindRenderbuffer(v.RENDERBUFFER,l),this.current=l,this.dirty=!1}},f}(pr),Hi=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){if(l!==this.current||this.dirty){var v=this.gl;v.bindTexture(v.TEXTURE_2D,l),this.current=l,this.dirty=!1}},f}(pr),Yi=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){if(l!==this.current||this.dirty){var v=this.gl;v.bindBuffer(v.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}},f}(pr),No=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){var v=this.gl;v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1},f}(pr),Ma=function(p){function f(l){p.call(this,l),this.vao=l.extVertexArrayObject}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)},f}(pr),ma=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return 4},f.prototype.set=function(l){if(l!==this.current||this.dirty){var v=this.gl;v.pixelStorei(v.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}},f}(pr),Hs=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(l){if(l!==this.current||this.dirty){var v=this.gl;v.pixelStorei(v.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}},f}(pr),il=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(l){if(l!==this.current||this.dirty){var v=this.gl;v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}},f}(pr),ja=function(p){function f(l,v){p.call(this,l),this.context=l,this.parent=v}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f}(pr),re=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.setDirty=function(){this.dirty=!0},f.prototype.set=function(l){if(l!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var v=this.gl;v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}},f}(ja),J=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.set=function(l){if(l!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var v=this.gl;v.framebufferRenderbuffer(v.FRAMEBUFFER,v.DEPTH_ATTACHMENT,v.RENDERBUFFER,l),this.current=l,this.dirty=!1}},f}(ja),pe=function(f,l,v,E){this.context=f,this.width=l,this.height=v;var T=this.framebuffer=f.gl.createFramebuffer();this.colorAttachment=new re(f,T),E&&(this.depthAttachment=new J(f,T))};pe.prototype.destroy=function(){var p=this.context.gl,f=this.colorAttachment.get();if(f&&p.deleteTexture(f),this.depthAttachment){var l=this.depthAttachment.get();l&&p.deleteRenderbuffer(l)}p.deleteFramebuffer(this.framebuffer)};var Se=function(f,l,v){this.func=f,this.mask=l,this.range=v};Se.ReadOnly=!1,Se.ReadWrite=!0,Se.disabled=new Se(519,Se.ReadOnly,[0,1]);var De=function(f,l,v,E,T,I){this.test=f,this.ref=l,this.mask=v,this.fail=E,this.depthFail=T,this.pass=I};De.disabled=new De({func:519,mask:0},0,0,7680,7680,7680);var et=function(f,l,v){this.blendFunction=f,this.blendColor=l,this.mask=v};et.disabled=new et(et.Replace=[1,0],h.Color.transparent,[!1,!1,!1,!1]),et.unblended=new et(et.Replace,h.Color.transparent,[!0,!0,!0,!0]),et.alphaBlended=new et([1,771],h.Color.transparent,[!0,!0,!0,!0]);var vt=function(f,l,v){this.enable=f,this.mode=l,this.frontFace=v};vt.disabled=new vt(!1,1029,2305),vt.backCCW=new vt(!0,1029,2305);var _e=function(f){this.gl=f,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ur(this),this.clearDepth=new gr(this),this.clearStencil=new or(this),this.colorMask=new Rr(this),this.depthMask=new Hn(this),this.stencilMask=new en(this),this.stencilFunc=new _n(this),this.stencilOp=new qn(this),this.stencilTest=new ii(this),this.depthRange=new Xi(this),this.depthTest=new me(this),this.depthFunc=new yn(this),this.blend=new Bi(this),this.blendFunc=new Mo(this),this.blendColor=new os(this),this.blendEquation=new jt(this),this.cullFace=new _r(this),this.cullFaceSide=new Xr(this),this.frontFace=new vn(this),this.program=new Kr(this),this.activeTexture=new ba(this),this.viewport=new li(this),this.bindFramebuffer=new Xn(this),this.bindRenderbuffer=new ci(this),this.bindTexture=new Hi(this),this.bindVertexBuffer=new Yi(this),this.bindElementBuffer=new No(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ma(this),this.pixelStoreUnpack=new ma(this),this.pixelStoreUnpackPremultiplyAlpha=new Hs(this),this.pixelStoreUnpackFlipY=new il(this),this.extTextureFilterAnisotropic=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("MOZ_EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=f.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=f.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(f.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=f.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=f.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=f.getParameter(f.MAX_TEXTURE_SIZE)};_e.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},_e.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},_e.prototype.createIndexBuffer=function(p,f){return new Zt(this,p,f)},_e.prototype.createVertexBuffer=function(p,f,l){return new qt(this,p,f,l)},_e.prototype.createRenderbuffer=function(p,f,l){var v=this.gl,E=v.createRenderbuffer();return this.bindRenderbuffer.set(E),v.renderbufferStorage(v.RENDERBUFFER,p,f,l),this.bindRenderbuffer.set(null),E},_e.prototype.createFramebuffer=function(p,f,l){return new pe(this,p,f,l)},_e.prototype.clear=function(p){var f=p.color,l=p.depth,v=this.gl,E=0;f&&(E|=v.COLOR_BUFFER_BIT,this.clearColor.set(f),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(E|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),v.clear(E)},_e.prototype.setCullFace=function(p){p.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(p.mode),this.frontFace.set(p.frontFace))},_e.prototype.setDepthMode=function(p){p.func!==this.gl.ALWAYS||p.mask?(this.depthTest.set(!0),this.depthFunc.set(p.func),this.depthMask.set(p.mask),this.depthRange.set(p.range)):this.depthTest.set(!1)},_e.prototype.setStencilMode=function(p){p.test.func!==this.gl.ALWAYS||p.mask?(this.stencilTest.set(!0),this.stencilMask.set(p.mask),this.stencilOp.set([p.fail,p.depthFail,p.pass]),this.stencilFunc.set({func:p.test.func,ref:p.ref,mask:p.test.mask})):this.stencilTest.set(!1)},_e.prototype.setColorMode=function(p){h.deepEqual(p.blendFunction,et.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(p.blendFunction),this.blendColor.set(p.blendColor)),this.colorMask.set(p.mask)},_e.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var je=function(p){function f(l,v,E){var T=this;p.call(this),this.id=l,this.dispatcher=E,this.on("data",function(I){I.dataType==="source"&&I.sourceDataType==="metadata"&&(T._sourceLoaded=!0),T._sourceLoaded&&!T._paused&&I.dataType==="source"&&I.sourceDataType==="content"&&(T.reload(),T.transform&&T.update(T.transform))}),this.on("error",function(){T._sourceErrored=!0}),this._source=function(I,k,W,q){var he=new ur[k.type](I,k,W,q);if(he.id!==I)throw new Error("Expected Source id to be "+I+" instead of "+he.id);return h.bindAll(["load","abort","unload","serialize","prepare"],he),he}(l,v,E,this),this._tiles={},this._cache=new St(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new h.SourceFeatureState}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.onAdd=function(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(l)},f.prototype.onRemove=function(l){this._source&&this._source.onRemove&&this._source.onRemove(l)},f.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var l in this._tiles){var v=this._tiles[l];if(v.state!=="loaded"&&v.state!=="errored")return!1}return!0},f.prototype.getSource=function(){return this._source},f.prototype.pause=function(){this._paused=!0},f.prototype.resume=function(){if(this._paused){var l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform)}},f.prototype._loadTile=function(l,v){return this._source.loadTile(l,v)},f.prototype._unloadTile=function(l){if(this._source.unloadTile)return this._source.unloadTile(l,function(){})},f.prototype._abortTile=function(l){if(this._source.abortTile)return this._source.abortTile(l,function(){})},f.prototype.serialize=function(){return this._source.serialize()},f.prototype.prepare=function(l){for(var v in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var E=this._tiles[v];E.upload(l),E.prepare(this.map.style.imageManager)}},f.prototype.getIds=function(){return h.values(this._tiles).map(function(l){return l.tileID}).sort($e).map(function(l){return l.key})},f.prototype.getRenderableIds=function(l){var v=this,E=[];for(var T in this._tiles)this._isIdRenderable(T,l)&&E.push(this._tiles[T]);return l?E.sort(function(I,k){var W=I.tileID,q=k.tileID,he=new h.Point(W.canonical.x,W.canonical.y)._rotate(v.transform.angle),ve=new h.Point(q.canonical.x,q.canonical.y)._rotate(v.transform.angle);return W.overscaledZ-q.overscaledZ||ve.y-he.y||ve.x-he.x}).map(function(I){return I.tileID.key}):E.map(function(I){return I.tileID}).sort($e).map(function(I){return I.key})},f.prototype.hasRenderableParent=function(l){var v=this.findLoadedParent(l,0);return!!v&&this._isIdRenderable(v.tileID.key)},f.prototype._isIdRenderable=function(l,v){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(v||!this._tiles[l].holdingForFade())},f.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var l in this._cache.reset(),this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")},f.prototype._reloadTile=function(l,v){var E=this._tiles[l];E&&(E.state!=="loading"&&(E.state=v),this._loadTile(E,this._tileLoaded.bind(this,E,l,v)))},f.prototype._tileLoaded=function(l,v,E,T){if(T)return l.state="errored",void(T.status!==404?this._source.fire(new h.ErrorEvent(T,{tile:l})):this.update(this.transform));l.timeAdded=h.browser.now(),E==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(v,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),this._source.fire(new h.Event("data",{dataType:"source",tile:l,coord:l.tileID}))},f.prototype._backfillDEM=function(l){for(var v=this.getRenderableIds(),E=0;E<v.length;E++){var T=v[E];if(l.neighboringTiles&&l.neighboringTiles[T]){var I=this.getTileByID(T);k(l,I),k(I,l)}}function k(W,q){W.needsHillshadePrepare=!0;var he=q.tileID.canonical.x-W.tileID.canonical.x,ve=q.tileID.canonical.y-W.tileID.canonical.y,xe=Math.pow(2,W.tileID.canonical.z),Ne=q.tileID.key;he===0&&ve===0||Math.abs(ve)>1||(Math.abs(he)>1&&(Math.abs(he+xe)===1?he+=xe:Math.abs(he-xe)===1&&(he-=xe)),q.dem&&W.dem&&(W.dem.backfillBorder(q.dem,he,ve),W.neighboringTiles&&W.neighboringTiles[Ne]&&(W.neighboringTiles[Ne].backfilled=!0)))}},f.prototype.getTile=function(l){return this.getTileByID(l.key)},f.prototype.getTileByID=function(l){return this._tiles[l]},f.prototype._retainLoadedChildren=function(l,v,E,T){for(var I in this._tiles){var k=this._tiles[I];if(!(T[I]||!k.hasData()||k.tileID.overscaledZ<=v||k.tileID.overscaledZ>E)){for(var W=k.tileID;k&&k.tileID.overscaledZ>v+1;){var q=k.tileID.scaledTo(k.tileID.overscaledZ-1);(k=this._tiles[q.key])&&k.hasData()&&(W=q)}for(var he=W;he.overscaledZ>v;)if(l[(he=he.scaledTo(he.overscaledZ-1)).key]){T[W.key]=W;break}}}},f.prototype.findLoadedParent=function(l,v){if(l.key in this._loadedParentTiles){var E=this._loadedParentTiles[l.key];return E&&E.tileID.overscaledZ>=v?E:null}for(var T=l.overscaledZ-1;T>=v;T--){var I=l.scaledTo(T),k=this._getLoadedTile(I);if(k)return k}},f.prototype._getLoadedTile=function(l){var v=this._tiles[l.key];return v&&v.hasData()?v:this._cache.getByKey(l.wrapped().key)},f.prototype.updateCacheSize=function(l){var v=Math.ceil(l.width/this._source.tileSize)+1,E=Math.ceil(l.height/this._source.tileSize)+1,T=Math.floor(v*E*5),I=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,T):T;this._cache.setMaxSize(I)},f.prototype.handleWrapJump=function(l){var v=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,v){var E={};for(var T in this._tiles){var I=this._tiles[T];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+v),E[I.tileID.key]=I}for(var k in this._tiles=E,this._timers)clearTimeout(this._timers[k]),delete this._timers[k];for(var W in this._tiles)this._setTileReloadTimer(W,this._tiles[W])}},f.prototype.update=function(l){var v=this;if(this.transform=l,this._sourceLoaded&&!this._paused){var E;this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?E=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(vr){return new h.OverscaledTileID(vr.canonical.z,vr.wrap,vr.canonical.z,vr.canonical.x,vr.canonical.y)}):(E=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(E=E.filter(function(vr){return v._source.hasTile(vr)}))):E=[];var T=l.coveringZoomLevel(this._source),I=Math.max(T-f.maxOverzooming,this._source.minzoom),k=Math.max(T+f.maxUnderzooming,this._source.minzoom),W=this._updateRetainedTiles(E,T);if(Ar(this._source.type)){for(var q={},he={},ve=0,xe=Object.keys(W);ve<xe.length;ve+=1){var Ne=xe[ve],Re=W[Ne],Ye=this._tiles[Ne];if(Ye&&!(Ye.fadeEndTime&&Ye.fadeEndTime<=h.browser.now())){var ze=this.findLoadedParent(Re,I);ze&&(this._addTile(ze.tileID),q[ze.tileID.key]=ze.tileID),he[Ne]=Re}}for(var Ge in this._retainLoadedChildren(he,T,k,W),q)W[Ge]||(this._coveredTiles[Ge]=!0,W[Ge]=q[Ge])}for(var xt in W)this._tiles[xt].clearFadeHold();for(var _t=0,fr=h.keysDifference(this._tiles,W);_t<fr.length;_t+=1){var Vt=fr[_t],lr=this._tiles[Vt];lr.hasSymbolBuckets&&!lr.holdingForFade()?lr.setHoldDuration(this.map._fadeDuration):lr.hasSymbolBuckets&&!lr.symbolFadeFinished()||this._removeTile(Vt)}this._updateLoadedParentTileCache()}},f.prototype.releaseSymbolFadeTiles=function(){for(var l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)},f.prototype._updateRetainedTiles=function(l,v){for(var E={},T={},I=Math.max(v-f.maxOverzooming,this._source.minzoom),k=Math.max(v+f.maxUnderzooming,this._source.minzoom),W={},q=0,he=l;q<he.length;q+=1){var ve=he[q],xe=this._addTile(ve);E[ve.key]=ve,xe.hasData()||v<this._source.maxzoom&&(W[ve.key]=ve)}this._retainLoadedChildren(W,v,k,E);for(var Ne=0,Re=l;Ne<Re.length;Ne+=1){var Ye=Re[Ne],ze=this._tiles[Ye.key];if(!ze.hasData()){if(v+1>this._source.maxzoom){var Ge=Ye.children(this._source.maxzoom)[0],xt=this.getTile(Ge);if(xt&&xt.hasData()){E[Ge.key]=Ge;continue}}else{var _t=Ye.children(this._source.maxzoom);if(E[_t[0].key]&&E[_t[1].key]&&E[_t[2].key]&&E[_t[3].key])continue}for(var fr=ze.wasRequested(),Vt=Ye.overscaledZ-1;Vt>=I;--Vt){var lr=Ye.scaledTo(Vt);if(T[lr.key]||(T[lr.key]=!0,!(ze=this.getTile(lr))&&fr&&(ze=this._addTile(lr)),ze&&(E[lr.key]=lr,fr=ze.wasRequested(),ze.hasData())))break}}}return E},f.prototype._updateLoadedParentTileCache=function(){for(var l in this._loadedParentTiles={},this._tiles){for(var v=[],E=void 0,T=this._tiles[l].tileID;T.overscaledZ>0;){if(T.key in this._loadedParentTiles){E=this._loadedParentTiles[T.key];break}v.push(T.key);var I=T.scaledTo(T.overscaledZ-1);if(E=this._getLoadedTile(I))break;T=I}for(var k=0,W=v;k<W.length;k+=1)this._loadedParentTiles[W[k]]=E}},f.prototype._addTile=function(l){var v=this._tiles[l.key];if(v)return v;(v=this._cache.getAndRemove(l))&&(this._setTileReloadTimer(l.key,v),v.tileID=l,this._state.initializeTileState(v,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,v)));var E=Boolean(v);return E||(v=new h.Tile(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(v,this._tileLoaded.bind(this,v,l.key,v.state))),v?(v.uses++,this._tiles[l.key]=v,E||this._source.fire(new h.Event("dataloading",{tile:v,coord:v.tileID,dataType:"source"})),v):null},f.prototype._setTileReloadTimer=function(l,v){var E=this;l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);var T=v.getExpiryTimeout();T&&(this._timers[l]=setTimeout(function(){E._reloadTile(l,"expired"),delete E._timers[l]},T))},f.prototype._removeTile=function(l){var v=this._tiles[l];v&&(v.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),v.uses>0||(v.hasData()&&v.state!=="reloading"?this._cache.add(v.tileID,v,v.getExpiryTimeout()):(v.aborted=!0,this._abortTile(v),this._unloadTile(v))))},f.prototype.clearTiles=function(){for(var l in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(l);this._cache.reset()},f.prototype.tilesIn=function(l,v,E){var T=this,I=[],k=this.transform;if(!k)return I;for(var W=E?k.getCameraQueryGeometry(l):l,q=l.map(function(Vt){return k.pointCoordinate(Vt)}),he=W.map(function(Vt){return k.pointCoordinate(Vt)}),ve=this.getIds(),xe=1/0,Ne=1/0,Re=-1/0,Ye=-1/0,ze=0,Ge=he;ze<Ge.length;ze+=1){var xt=Ge[ze];xe=Math.min(xe,xt.x),Ne=Math.min(Ne,xt.y),Re=Math.max(Re,xt.x),Ye=Math.max(Ye,xt.y)}for(var _t=function(lr){var vr=T._tiles[ve[lr]];if(!vr.holdingForFade()){var xr=vr.tileID,Hr=Math.pow(2,k.zoom-vr.tileID.overscaledZ),cn=v*vr.queryPadding*h.EXTENT/vr.tileSize/Hr,Un=[xr.getTilePoint(new h.MercatorCoordinate(xe,Ne)),xr.getTilePoint(new h.MercatorCoordinate(Re,Ye))];if(Un[0].x-cn<h.EXTENT&&Un[0].y-cn<h.EXTENT&&Un[1].x+cn>=0&&Un[1].y+cn>=0){var Jn=q.map(function(ji){return xr.getTilePoint(ji)}),oi=he.map(function(ji){return xr.getTilePoint(ji)});I.push({tile:vr,tileID:xr,queryGeometry:Jn,cameraQueryGeometry:oi,scale:Hr})}}},fr=0;fr<ve.length;fr++)_t(fr);return I},f.prototype.getVisibleCoordinates=function(l){for(var v=this,E=this.getRenderableIds(l).map(function(W){return v._tiles[W].tileID}),T=0,I=E;T<I.length;T+=1){var k=I[T];k.posMatrix=this.transform.calculatePosMatrix(k.toUnwrapped())}return E},f.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ar(this._source.type))for(var l in this._tiles){var v=this._tiles[l];if(v.fadeEndTime!==void 0&&v.fadeEndTime>=h.browser.now())return!0}return!1},f.prototype.setFeatureState=function(l,v,E){this._state.updateState(l=l||"_geojsonTileLayer",v,E)},f.prototype.removeFeatureState=function(l,v,E){this._state.removeFeatureState(l=l||"_geojsonTileLayer",v,E)},f.prototype.getFeatureState=function(l,v){return this._state.getState(l=l||"_geojsonTileLayer",v)},f.prototype.setDependencies=function(l,v,E){var T=this._tiles[l];T&&T.setDependencies(v,E)},f.prototype.reloadTilesForDependencies=function(l,v){for(var E in this._tiles)this._tiles[E].hasDependency(l,v)&&this._reloadTile(E,"reloading");this._cache.filter(function(T){return!T.hasDependency(l,v)})},f}(h.Evented);function $e(p,f){var l=Math.abs(2*p.wrap)-+(p.wrap<0),v=Math.abs(2*f.wrap)-+(f.wrap<0);return p.overscaledZ-f.overscaledZ||v-l||f.canonical.y-p.canonical.y||f.canonical.x-p.canonical.x}function Ar(p){return p==="raster"||p==="image"||p==="video"}function kr(){return new h.window.Worker(Pf.workerUrl)}je.maxOverzooming=10,je.maxUnderzooming=3;var rr="mapboxgl_preloaded_worker_pool",Lr=function(){this.active={}};Lr.prototype.acquire=function(p){if(!this.workers)for(this.workers=[];this.workers.length<Lr.workerCount;)this.workers.push(new kr);return this.active[p]=!0,this.workers.slice()},Lr.prototype.release=function(p){delete this.active[p],this.numActive()===0&&(this.workers.forEach(function(f){f.terminate()}),this.workers=null)},Lr.prototype.isPreloaded=function(){return!!this.active[rr]},Lr.prototype.numActive=function(){return Object.keys(this.active).length};var an,An=Math.floor(h.browser.hardwareConcurrency/2);function tr(){return an||(an=new Lr),an}function Cn(p,f){var l={};for(var v in p)v!=="ref"&&(l[v]=p[v]);return h.refProperties.forEach(function(E){E in f&&(l[E]=f[E])}),l}function hn(p){p=p.slice();for(var f=Object.create(null),l=0;l<p.length;l++)f[p[l].id]=p[l];for(var v=0;v<p.length;v++)"ref"in p[v]&&(p[v]=Cn(p[v],f[p[v].ref]));return p}Lr.workerCount=Math.max(Math.min(An,6),1);var xn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function _i(p,f,l){l.push({command:xn.addSource,args:[p,f[p]]})}function wn(p,f,l){f.push({command:xn.removeSource,args:[p]}),l[p]=!0}function Ni(p,f,l,v){wn(p,l,v),_i(p,f,l)}function Ki(p,f,l){var v;for(v in p[l])if(p[l].hasOwnProperty(v)&&v!=="data"&&!h.deepEqual(p[l][v],f[l][v]))return!1;for(v in f[l])if(f[l].hasOwnProperty(v)&&v!=="data"&&!h.deepEqual(p[l][v],f[l][v]))return!1;return!0}function Mi(p,f,l,v,E,T){var I;for(I in f=f||{},p=p||{})p.hasOwnProperty(I)&&(h.deepEqual(p[I],f[I])||l.push({command:T,args:[v,I,f[I],E]}));for(I in f)f.hasOwnProperty(I)&&!p.hasOwnProperty(I)&&(h.deepEqual(p[I],f[I])||l.push({command:T,args:[v,I,f[I],E]}))}function Fn(p){return p.id}function Ui(p,f){return p[f.id]=f,p}var zo=function(f,l){this.reset(f,l)};zo.prototype.reset=function(p,f){this.points=p||[],this._distances=[0];for(var l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding},zo.prototype.lerp=function(p){if(this.points.length===1)return this.points[0];p=h.clamp(p,0,1);for(var f=1,l=this._distances[f],v=p*this.paddedLength+this.padding;l<v&&f<this._distances.length;)l=this._distances[++f];var E=f-1,T=this._distances[E],I=l-T,k=I>0?(v-T)/I:0;return this.points[E].mult(1-k).add(this.points[f].mult(k))};var ia=function(f,l,v){var E=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(f/v),this.yCellCount=Math.ceil(l/v);for(var I=0;I<this.xCellCount*this.yCellCount;I++)E.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=f,this.height=l,this.xScale=this.xCellCount/f,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0};function Ka(p,f,l,v,E){var T=h.create();return f?(h.scale(T,T,[1/E,1/E,1]),l||h.rotateZ(T,T,v.angle)):h.multiply(T,v.labelPlaneMatrix,p),T}function ri(p,f,l,v,E){if(f){var T=h.clone(p);return h.scale(T,T,[E,E,1]),l||h.rotateZ(T,T,-v.angle),T}return v.glCoordMatrix}function Ai(p,f){var l=[p.x,p.y,0,1];Ta(l,l,f);var v=l[3];return{point:new h.Point(l[0]/v,l[1]/v),signedDistanceFromCamera:v}}function xi(p,f){return .5+p/f*.5}function to(p,f){var l=p[0]/p[3],v=p[1]/p[3];return l>=-f[0]&&l<=f[0]&&v>=-f[1]&&v<=f[1]}function ao(p,f,l,v,E,T,I,k){var W=v?p.textSizeData:p.iconSizeData,q=h.evaluateSizeForZoom(W,l.transform.zoom),he=[256/l.width*2+1,256/l.height*2+1],ve=v?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;ve.clear();for(var xe=p.lineVertexArray,Ne=v?p.text.placedSymbolArray:p.icon.placedSymbolArray,Re=l.transform.width/l.transform.height,Ye=!1,ze=0;ze<Ne.length;ze++){var Ge=Ne.get(ze);if(Ge.hidden||Ge.writingMode===h.WritingMode.vertical&&!Ye)Pa(Ge.numGlyphs,ve);else{Ye=!1;var xt=[Ge.anchorX,Ge.anchorY,0,1];if(h.transformMat4(xt,xt,f),to(xt,he)){var _t=xi(l.transform.cameraToCenterDistance,xt[3]),fr=h.evaluateSizeForFeature(W,q,Ge),Vt=I?fr/_t:fr*_t,lr=new h.Point(Ge.anchorX,Ge.anchorY),vr=Ai(lr,E).point,xr={},Hr=ss(Ge,Vt,!1,k,f,E,T,p.glyphOffsetArray,xe,ve,vr,lr,xr,Re);Ye=Hr.useVertical,(Hr.notEnoughRoom||Ye||Hr.needsFlipping&&ss(Ge,Vt,!0,k,f,E,T,p.glyphOffsetArray,xe,ve,vr,lr,xr,Re).notEnoughRoom)&&Pa(Ge.numGlyphs,ve)}else Pa(Ge.numGlyphs,ve)}}v?p.text.dynamicLayoutVertexBuffer.updateData(ve):p.icon.dynamicLayoutVertexBuffer.updateData(ve)}function Ea(p,f,l,v,E,T,I,k,W,q,he){var ve=k.glyphStartIndex+k.numGlyphs,xe=k.lineStartIndex,Ne=k.lineStartIndex+k.lineLength,Re=f.getoffsetX(k.glyphStartIndex),Ye=f.getoffsetX(ve-1),ze=wa(p*Re,l,v,E,T,I,k.segment,xe,Ne,W,q,he);if(!ze)return null;var Ge=wa(p*Ye,l,v,E,T,I,k.segment,xe,Ne,W,q,he);return Ge?{first:ze,last:Ge}:null}function Ct(p,f,l,v){return p===h.WritingMode.horizontal&&Math.abs(l.y-f.y)>Math.abs(l.x-f.x)*v?{useVertical:!0}:(p===h.WritingMode.vertical?f.y<l.y:f.x>l.x)?{needsFlipping:!0}:null}function ss(p,f,l,v,E,T,I,k,W,q,he,ve,xe,Ne){var Re,Ye=f/24,ze=p.lineOffsetX*Ye,Ge=p.lineOffsetY*Ye;if(p.numGlyphs>1){var xt=p.glyphStartIndex+p.numGlyphs,_t=p.lineStartIndex,fr=p.lineStartIndex+p.lineLength,Vt=Ea(Ye,k,ze,Ge,l,he,ve,p,W,T,xe);if(!Vt)return{notEnoughRoom:!0};var lr=Ai(Vt.first.point,I).point,vr=Ai(Vt.last.point,I).point;if(v&&!l){var xr=Ct(p.writingMode,lr,vr,Ne);if(xr)return xr}Re=[Vt.first];for(var Hr=p.glyphStartIndex+1;Hr<xt-1;Hr++)Re.push(wa(Ye*k.getoffsetX(Hr),ze,Ge,l,he,ve,p.segment,_t,fr,W,T,xe));Re.push(Vt.last)}else{if(v&&!l){var cn=Ai(ve,E).point,Un=p.lineStartIndex+p.segment+1,Jn=new h.Point(W.getx(Un),W.gety(Un)),oi=Ai(Jn,E),ji=oi.signedDistanceFromCamera>0?oi.point:Bt(ve,Jn,cn,1,E),hi=Ct(p.writingMode,cn,ji,Ne);if(hi)return hi}var Rn=wa(Ye*k.getoffsetX(p.glyphStartIndex),ze,Ge,l,he,ve,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,W,T,xe);if(!Rn)return{notEnoughRoom:!0};Re=[Rn]}for(var bi=0,Oi=Re;bi<Oi.length;bi+=1){var Qn=Oi[bi];h.addDynamicAttributes(q,Qn.point,Qn.angle)}return{}}function Bt(p,f,l,v,E){var T=Ai(p.add(p.sub(f)._unit()),E).point,I=l.sub(T);return l.add(I._mult(v/I.mag()))}function wa(p,f,l,v,E,T,I,k,W,q,he,ve){var xe=v?p-f:p+f,Ne=xe>0?1:-1,Re=0;v&&(Ne*=-1,Re=Math.PI),Ne<0&&(Re+=Math.PI);for(var Ye=Ne>0?k+I:k+I+1,ze=E,Ge=E,xt=0,_t=0,fr=Math.abs(xe),Vt=[];xt+_t<=fr;){if((Ye+=Ne)<k||Ye>=W)return null;if(Ge=ze,Vt.push(ze),(ze=ve[Ye])===void 0){var lr=new h.Point(q.getx(Ye),q.gety(Ye)),vr=Ai(lr,he);if(vr.signedDistanceFromCamera>0)ze=ve[Ye]=vr.point;else{var xr=Ye-Ne;ze=Bt(xt===0?T:new h.Point(q.getx(xr),q.gety(xr)),lr,Ge,fr-xt+1,he)}}xt+=_t,_t=Ge.dist(ze)}var Hr=(fr-xt)/_t,cn=ze.sub(Ge),Un=cn.mult(Hr)._add(Ge);Un._add(cn._unit()._perp()._mult(l*Ne));var Jn=Re+Math.atan2(ze.y-Ge.y,ze.x-Ge.x);return Vt.push(Un),{point:Un,angle:Jn,path:Vt}}ia.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},ia.prototype.insert=function(p,f,l,v,E){this._forEachCell(f,l,v,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(p),this.bboxes.push(f),this.bboxes.push(l),this.bboxes.push(v),this.bboxes.push(E)},ia.prototype.insertCircle=function(p,f,l,v){this._forEachCell(f-v,l-v,f+v,l+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(p),this.circles.push(f),this.circles.push(l),this.circles.push(v)},ia.prototype._insertBoxCell=function(p,f,l,v,E,T){this.boxCells[E].push(T)},ia.prototype._insertCircleCell=function(p,f,l,v,E,T){this.circleCells[E].push(T)},ia.prototype._query=function(p,f,l,v,E,T){if(l<0||p>this.width||v<0||f>this.height)return!E&&[];var I=[];if(p<=0&&f<=0&&this.width<=l&&this.height<=v){if(E)return!0;for(var k=0;k<this.boxKeys.length;k++)I.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(var W=0;W<this.circleKeys.length;W++){var q=this.circles[3*W],he=this.circles[3*W+1],ve=this.circles[3*W+2];I.push({key:this.circleKeys[W],x1:q-ve,y1:he-ve,x2:q+ve,y2:he+ve})}return T?I.filter(T):I}return this._forEachCell(p,f,l,v,this._queryCell,I,{hitTest:E,seenUids:{box:{},circle:{}}},T),E?I.length>0:I},ia.prototype._queryCircle=function(p,f,l,v,E){var T=p-l,I=p+l,k=f-l,W=f+l;if(I<0||T>this.width||W<0||k>this.height)return!v&&[];var q=[];return this._forEachCell(T,k,I,W,this._queryCellCircle,q,{hitTest:v,circle:{x:p,y:f,radius:l},seenUids:{box:{},circle:{}}},E),v?q.length>0:q},ia.prototype.query=function(p,f,l,v,E){return this._query(p,f,l,v,!1,E)},ia.prototype.hitTest=function(p,f,l,v,E){return this._query(p,f,l,v,!0,E)},ia.prototype.hitTestCircle=function(p,f,l,v){return this._queryCircle(p,f,l,!0,v)},ia.prototype._queryCell=function(p,f,l,v,E,T,I,k){var W=I.seenUids,q=this.boxCells[E];if(q!==null)for(var he=this.bboxes,ve=0,xe=q;ve<xe.length;ve+=1){var Ne=xe[ve];if(!W.box[Ne]){W.box[Ne]=!0;var Re=4*Ne;if(p<=he[Re+2]&&f<=he[Re+3]&&l>=he[Re+0]&&v>=he[Re+1]&&(!k||k(this.boxKeys[Ne]))){if(I.hitTest)return T.push(!0),!0;T.push({key:this.boxKeys[Ne],x1:he[Re],y1:he[Re+1],x2:he[Re+2],y2:he[Re+3]})}}}var Ye=this.circleCells[E];if(Ye!==null)for(var ze=this.circles,Ge=0,xt=Ye;Ge<xt.length;Ge+=1){var _t=xt[Ge];if(!W.circle[_t]){W.circle[_t]=!0;var fr=3*_t;if(this._circleAndRectCollide(ze[fr],ze[fr+1],ze[fr+2],p,f,l,v)&&(!k||k(this.circleKeys[_t]))){if(I.hitTest)return T.push(!0),!0;var Vt=ze[fr],lr=ze[fr+1],vr=ze[fr+2];T.push({key:this.circleKeys[_t],x1:Vt-vr,y1:lr-vr,x2:Vt+vr,y2:lr+vr})}}}},ia.prototype._queryCellCircle=function(p,f,l,v,E,T,I,k){var W=I.circle,q=I.seenUids,he=this.boxCells[E];if(he!==null)for(var ve=this.bboxes,xe=0,Ne=he;xe<Ne.length;xe+=1){var Re=Ne[xe];if(!q.box[Re]){q.box[Re]=!0;var Ye=4*Re;if(this._circleAndRectCollide(W.x,W.y,W.radius,ve[Ye+0],ve[Ye+1],ve[Ye+2],ve[Ye+3])&&(!k||k(this.boxKeys[Re])))return T.push(!0),!0}}var ze=this.circleCells[E];if(ze!==null)for(var Ge=this.circles,xt=0,_t=ze;xt<_t.length;xt+=1){var fr=_t[xt];if(!q.circle[fr]){q.circle[fr]=!0;var Vt=3*fr;if(this._circlesCollide(Ge[Vt],Ge[Vt+1],Ge[Vt+2],W.x,W.y,W.radius)&&(!k||k(this.circleKeys[fr])))return T.push(!0),!0}}},ia.prototype._forEachCell=function(p,f,l,v,E,T,I,k){for(var W=this._convertToXCellCoord(p),q=this._convertToYCellCoord(f),he=this._convertToXCellCoord(l),ve=this._convertToYCellCoord(v),xe=W;xe<=he;xe++)for(var Ne=q;Ne<=ve;Ne++)if(E.call(this,p,f,l,v,this.xCellCount*Ne+xe,T,I,k))return},ia.prototype._convertToXCellCoord=function(p){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(p*this.xScale)))},ia.prototype._convertToYCellCoord=function(p){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(p*this.yScale)))},ia.prototype._circlesCollide=function(p,f,l,v,E,T){var I=v-p,k=E-f,W=l+T;return W*W>I*I+k*k},ia.prototype._circleAndRectCollide=function(p,f,l,v,E,T,I){var k=(T-v)/2,W=Math.abs(p-(v+k));if(W>k+l)return!1;var q=(I-E)/2,he=Math.abs(f-(E+q));if(he>q+l)return!1;if(W<=k||he<=q)return!0;var ve=W-k,xe=he-q;return ve*ve+xe*xe<=l*l};var ro=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Pa(p,f){for(var l=0;l<p;l++){var v=f.length;f.resize(v+4),f.float32.set(ro,3*v)}}function Ta(p,f,l){var v=f[0],E=f[1];return p[0]=l[0]*v+l[4]*E+l[12],p[1]=l[1]*v+l[5]*E+l[13],p[3]=l[3]*v+l[7]*E+l[15],p}var Po=function(f,l,v){l===void 0&&(l=new ia(f.width+200,f.height+200,25)),v===void 0&&(v=new ia(f.width+200,f.height+200,25)),this.transform=f,this.grid=l,this.ignoredGrid=v,this.pitchfactor=Math.cos(f._pitch)*f.cameraToCenterDistance,this.screenRightBoundary=f.width+100,this.screenBottomBoundary=f.height+100,this.gridRightBoundary=f.width+200,this.gridBottomBoundary=f.height+200};function Nr(p,f,l){return f*(h.EXTENT/(p.tileSize*Math.pow(2,l-p.tileID.overscaledZ)))}Po.prototype.placeCollisionBox=function(p,f,l,v,E){var T=this.projectAndGetPerspectiveRatio(v,p.anchorPointX,p.anchorPointY),I=l*T.perspectiveRatio,k=p.x1*I+T.point.x,W=p.y1*I+T.point.y,q=p.x2*I+T.point.x,he=p.y2*I+T.point.y;return!this.isInsideGrid(k,W,q,he)||!f&&this.grid.hitTest(k,W,q,he,E)?{box:[],offscreen:!1}:{box:[k,W,q,he],offscreen:this.isOffscreen(k,W,q,he)}},Po.prototype.placeCollisionCircles=function(p,f,l,v,E,T,I,k,W,q,he,ve,xe){var Ne=[],Re=new h.Point(f.anchorX,f.anchorY),Ye=Ai(Re,T),ze=xi(this.transform.cameraToCenterDistance,Ye.signedDistanceFromCamera),Ge=(q?E/ze:E*ze)/h.ONE_EM,xt=Ai(Re,I).point,_t=Ea(Ge,v,f.lineOffsetX*Ge,f.lineOffsetY*Ge,!1,xt,Re,f,l,I,{}),fr=!1,Vt=!1,lr=!0;if(_t){for(var vr=.5*ve*ze+xe,xr=new h.Point(-100,-100),Hr=new h.Point(this.screenRightBoundary,this.screenBottomBoundary),cn=new zo,Un=_t.first,Jn=_t.last,oi=[],ji=Un.path.length-1;ji>=1;ji--)oi.push(Un.path[ji]);for(var hi=1;hi<Jn.path.length;hi++)oi.push(Jn.path[hi]);var Rn=2.5*vr;if(k){var bi=oi.map(function(Es){return Ai(Es,k)});oi=bi.some(function(Es){return Es.signedDistanceFromCamera<=0})?[]:bi.map(function(Es){return Es.point})}var Oi=[];if(oi.length>0){for(var Qn=oi[0].clone(),Ri=oi[0].clone(),si=1;si<oi.length;si++)Qn.x=Math.min(Qn.x,oi[si].x),Qn.y=Math.min(Qn.y,oi[si].y),Ri.x=Math.max(Ri.x,oi[si].x),Ri.y=Math.max(Ri.y,oi[si].y);Oi=Qn.x>=xr.x&&Ri.x<=Hr.x&&Qn.y>=xr.y&&Ri.y<=Hr.y?[oi]:Ri.x<xr.x||Qn.x>Hr.x||Ri.y<xr.y||Qn.y>Hr.y?[]:h.clipLine([oi],xr.x,xr.y,Hr.x,Hr.y)}for(var Di=0,$i=Oi;Di<$i.length;Di+=1){var mo;cn.reset($i[Di],.25*vr),mo=cn.length<=.5*vr?1:Math.ceil(cn.paddedLength/Rn)+1;for(var uo=0;uo<mo;uo++){var Ro=uo/Math.max(mo-1,1),Za=cn.lerp(Ro),no=Za.x+100,Ks=Za.y+100;Ne.push(no,Ks,vr,0);var Ba=no-vr,vl=Ks-vr,ks=no+vr,bs=Ks+vr;if(lr=lr&&this.isOffscreen(Ba,vl,ks,bs),Vt=Vt||this.isInsideGrid(Ba,vl,ks,bs),!p&&this.grid.hitTestCircle(no,Ks,vr,he)&&(fr=!0,!W))return{circles:[],offscreen:!1,collisionDetected:fr}}}}return{circles:!W&&fr||!Vt?[]:Ne,offscreen:lr,collisionDetected:fr}},Po.prototype.queryRenderedSymbols=function(p){if(p.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var f=[],l=1/0,v=1/0,E=-1/0,T=-1/0,I=0,k=p;I<k.length;I+=1){var W=k[I],q=new h.Point(W.x+100,W.y+100);l=Math.min(l,q.x),v=Math.min(v,q.y),E=Math.max(E,q.x),T=Math.max(T,q.y),f.push(q)}for(var he={},ve={},xe=0,Ne=this.grid.query(l,v,E,T).concat(this.ignoredGrid.query(l,v,E,T));xe<Ne.length;xe+=1){var Re=Ne[xe],Ye=Re.key;if(he[Ye.bucketInstanceId]===void 0&&(he[Ye.bucketInstanceId]={}),!he[Ye.bucketInstanceId][Ye.featureIndex]){var ze=[new h.Point(Re.x1,Re.y1),new h.Point(Re.x2,Re.y1),new h.Point(Re.x2,Re.y2),new h.Point(Re.x1,Re.y2)];h.polygonIntersectsPolygon(f,ze)&&(he[Ye.bucketInstanceId][Ye.featureIndex]=!0,ve[Ye.bucketInstanceId]===void 0&&(ve[Ye.bucketInstanceId]=[]),ve[Ye.bucketInstanceId].push(Ye.featureIndex))}}return ve},Po.prototype.insertCollisionBox=function(p,f,l,v,E){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:l,featureIndex:v,collisionGroupID:E},p[0],p[1],p[2],p[3])},Po.prototype.insertCollisionCircles=function(p,f,l,v,E){for(var T=f?this.ignoredGrid:this.grid,I={bucketInstanceId:l,featureIndex:v,collisionGroupID:E},k=0;k<p.length;k+=4)T.insertCircle(I,p[k],p[k+1],p[k+2])},Po.prototype.projectAndGetPerspectiveRatio=function(p,f,l){var v=[f,l,0,1];return Ta(v,v,p),{point:new h.Point((v[0]/v[3]+1)/2*this.transform.width+100,(-v[1]/v[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/v[3]*.5}},Po.prototype.isOffscreen=function(p,f,l,v){return l<100||p>=this.screenRightBoundary||v<100||f>this.screenBottomBoundary},Po.prototype.isInsideGrid=function(p,f,l,v){return l>=0&&p<this.gridRightBoundary&&v>=0&&f<this.gridBottomBoundary},Po.prototype.getViewportMatrix=function(){var p=h.identity([]);return h.translate(p,p,[-100,-100,0]),p};var Xo=function(f,l,v,E){this.opacity=f?Math.max(0,Math.min(1,f.opacity+(f.placed?l:-l))):E&&v?1:0,this.placed=v};Xo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var $r=function(f,l,v,E,T){this.text=new Xo(f?f.text:null,l,v,T),this.icon=new Xo(f?f.icon:null,l,E,T)};$r.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Oo=function(f,l,v){this.text=f,this.icon=l,this.skipFade=v},mt=function(){this.invProjMatrix=h.create(),this.viewportMatrix=h.create(),this.circles=[]},wu=function(f,l,v,E,T){this.bucketInstanceId=f,this.featureIndex=l,this.sourceLayerIndex=v,this.bucketIndex=E,this.tileID=T},ms=function(f){this.crossSourceCollisions=f,this.maxGroupID=0,this.collisionGroups={}};function oe(p,f,l,v,E){var T=h.getAnchorAlignment(p),I=-(T.horizontalAlign-.5)*f,k=-(T.verticalAlign-.5)*l,W=h.evaluateVariableOffset(p,v);return new h.Point(I+W[0]*E,k+W[1]*E)}function Ws(p,f,l,v,E,T){var I=p.x1,k=p.x2,W=p.y1,q=p.y2,he=p.anchorPointX,ve=p.anchorPointY,xe=new h.Point(f,l);return v&&xe._rotate(E?T:-T),{x1:I+xe.x,y1:W+xe.y,x2:k+xe.x,y2:q+xe.y,anchorPointX:he,anchorPointY:ve}}ms.prototype.get=function(p){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[p]){var f=++this.maxGroupID;this.collisionGroups[p]={ID:f,predicate:function(v){return v.collisionGroupID===f}}}return this.collisionGroups[p]};var Io=function(f,l,v,E){this.transform=f.clone(),this.collisionIndex=new Po(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new ms(v),this.collisionCircleArrays={},this.prevPlacement=E,E&&(E.prevPlacement=void 0),this.placedOrientations={}};function xo(p,f,l,v,E){p.emplaceBack(f?1:0,l?1:0,v||0,E||0),p.emplaceBack(f?1:0,l?1:0,v||0,E||0),p.emplaceBack(f?1:0,l?1:0,v||0,E||0),p.emplaceBack(f?1:0,l?1:0,v||0,E||0)}Io.prototype.getBucketParts=function(p,f,l,v){var E=l.getBucket(f),T=l.latestFeatureIndex;if(E&&T&&f.id===E.layerIds[0]){var I=l.collisionBoxArray,k=E.layers[0].layout,W=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),q=l.tileSize/h.EXTENT,he=this.transform.calculatePosMatrix(l.tileID.toUnwrapped()),ve=k.get("text-pitch-alignment")==="map",xe=k.get("text-rotation-alignment")==="map",Ne=Nr(l,1,this.transform.zoom),Re=Ka(he,ve,xe,this.transform,Ne),Ye=null;if(ve){var ze=ri(he,ve,xe,this.transform,Ne);Ye=h.multiply([],this.transform.labelPlaneMatrix,ze)}this.retainedQueryData[E.bucketInstanceId]=new wu(E.bucketInstanceId,T,E.sourceLayerIndex,E.index,l.tileID);var Ge={bucket:E,layout:k,posMatrix:he,textLabelPlaneMatrix:Re,labelToScreenMatrix:Ye,scale:W,textPixelRatio:q,holdingForFade:l.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:h.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(v)for(var xt=0,_t=E.sortKeyRanges;xt<_t.length;xt+=1){var fr=_t[xt];p.push({sortKey:fr.sortKey,symbolInstanceStart:fr.symbolInstanceStart,symbolInstanceEnd:fr.symbolInstanceEnd,parameters:Ge})}else p.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:Ge})}},Io.prototype.attemptAnchorPlacement=function(p,f,l,v,E,T,I,k,W,q,he,ve,xe,Ne,Re){var Ye,ze=[ve.textOffset0,ve.textOffset1],Ge=oe(p,l,v,ze,E),xt=this.collisionIndex.placeCollisionBox(Ws(f,Ge.x,Ge.y,T,I,this.transform.angle),he,k,W,q.predicate);if(!Re||this.collisionIndex.placeCollisionBox(Ws(Re,Ge.x,Ge.y,T,I,this.transform.angle),he,k,W,q.predicate).box.length!==0)return xt.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[ve.crossTileID]&&this.prevPlacement.placements[ve.crossTileID]&&this.prevPlacement.placements[ve.crossTileID].text&&(Ye=this.prevPlacement.variableOffsets[ve.crossTileID].anchor),this.variableOffsets[ve.crossTileID]={textOffset:ze,width:l,height:v,anchor:p,textBoxScale:E,prevAnchor:Ye},this.markUsedJustification(xe,p,ve,Ne),xe.allowVerticalPlacement&&(this.markUsedOrientation(xe,Ne,ve),this.placedOrientations[ve.crossTileID]=Ne),{shift:Ge,placedGlyphBoxes:xt}):void 0},Io.prototype.placeLayerBucketPart=function(p,f,l){var v=this,E=p.parameters,T=E.bucket,I=E.layout,k=E.posMatrix,W=E.textLabelPlaneMatrix,q=E.labelToScreenMatrix,he=E.textPixelRatio,ve=E.holdingForFade,xe=E.collisionBoxArray,Ne=E.partiallyEvaluatedTextSize,Re=E.collisionGroup,Ye=I.get("text-optional"),ze=I.get("icon-optional"),Ge=I.get("text-allow-overlap"),xt=I.get("icon-allow-overlap"),_t=I.get("text-rotation-alignment")==="map",fr=I.get("text-pitch-alignment")==="map",Vt=I.get("icon-text-fit")!=="none",lr=I.get("symbol-z-order")==="viewport-y",vr=Ge&&(xt||!T.hasIconData()||ze),xr=xt&&(Ge||!T.hasTextData()||Ye);!T.collisionArrays&&xe&&T.deserializeCollisionBoxes(xe);var Hr=function(Rn,bi){if(!f[Rn.crossTileID])if(ve)v.placements[Rn.crossTileID]=new Oo(!1,!1,!1);else{var Oi,Qn=!1,Ri=!1,si=!0,Di=null,$i={box:null,offscreen:null},mo={box:null,offscreen:null},uo=null,Ro=null,Za=0,no=0,Ks=0;bi.textFeatureIndex?Za=bi.textFeatureIndex:Rn.useRuntimeCollisionCircles&&(Za=Rn.featureIndex),bi.verticalTextFeatureIndex&&(no=bi.verticalTextFeatureIndex);var Ba=bi.textBox;if(Ba){var vl=function(Vo){var Fs=h.WritingMode.horizontal;if(T.allowVerticalPlacement&&!Vo&&v.prevPlacement){var Go=v.prevPlacement.placedOrientations[Rn.crossTileID];Go&&(v.placedOrientations[Rn.crossTileID]=Go,v.markUsedOrientation(T,Fs=Go,Rn))}return Fs},ks=function(Vo,Fs){if(T.allowVerticalPlacement&&Rn.numVerticalGlyphVertices>0&&bi.verticalTextBox)for(var Go=0,$s=T.writingModes;Go<$s.length&&($s[Go]===h.WritingMode.vertical?($i=Fs(),mo=$i):$i=Vo(),!($i&&$i.box&&$i.box.length));Go+=1);else $i=Vo()};if(I.get("text-variable-anchor")){var bs=I.get("text-variable-anchor");if(v.prevPlacement&&v.prevPlacement.variableOffsets[Rn.crossTileID]){var Es=v.prevPlacement.variableOffsets[Rn.crossTileID];bs.indexOf(Es.anchor)>0&&(bs=bs.filter(function(Ds){return Ds!==Es.anchor})).unshift(Es.anchor)}var Co=function(Vo,Fs,Go){for(var $s=Vo.x2-Vo.x1,ef=Vo.y2-Vo.y1,Dl=Rn.textBoxScale,mc=Vt&&!xt?Fs:null,Ju={box:[],offscreen:!1},gl=Ge?2*bs.length:bs.length,Eu=0;Eu<gl;++Eu){var Bs=v.attemptAnchorPlacement(bs[Eu%bs.length],Vo,$s,ef,Dl,_t,fr,he,k,Re,Eu>=bs.length,Rn,T,Go,mc);if(Bs&&(Ju=Bs.placedGlyphBoxes)&&Ju.box&&Ju.box.length){Qn=!0,Di=Bs.shift;break}}return Ju};ks(function(){return Co(Ba,bi.iconBox,h.WritingMode.horizontal)},function(){var Ds=bi.verticalTextBox;return T.allowVerticalPlacement&&!($i&&$i.box&&$i.box.length)&&Rn.numVerticalGlyphVertices>0&&Ds?Co(Ds,bi.verticalIconBox,h.WritingMode.vertical):{box:null,offscreen:null}}),$i&&(Qn=$i.box,si=$i.offscreen);var Ls=vl($i&&$i.box);if(!Qn&&v.prevPlacement){var qu=v.prevPlacement.variableOffsets[Rn.crossTileID];qu&&(v.variableOffsets[Rn.crossTileID]=qu,v.markUsedJustification(T,qu.anchor,Rn,Ls))}}else{var Ll=function(Vo,Fs){var Go=v.collisionIndex.placeCollisionBox(Vo,Ge,he,k,Re.predicate);return Go&&Go.box&&Go.box.length&&(v.markUsedOrientation(T,Fs,Rn),v.placedOrientations[Rn.crossTileID]=Fs),Go};ks(function(){return Ll(Ba,h.WritingMode.horizontal)},function(){var Ds=bi.verticalTextBox;return T.allowVerticalPlacement&&Rn.numVerticalGlyphVertices>0&&Ds?Ll(Ds,h.WritingMode.vertical):{box:null,offscreen:null}}),vl($i&&$i.box&&$i.box.length)}}if(Qn=(Oi=$i)&&Oi.box&&Oi.box.length>0,si=Oi&&Oi.offscreen,Rn.useRuntimeCollisionCircles){var ml=T.text.placedSymbolArray.get(Rn.centerJustifiedTextSymbolIndex),xu=h.evaluateSizeForFeature(T.textSizeData,Ne,ml),ql=I.get("text-padding");uo=v.collisionIndex.placeCollisionCircles(Ge,ml,T.lineVertexArray,T.glyphOffsetArray,xu,k,W,q,l,fr,Re.predicate,Rn.collisionCircleDiameter,ql),Qn=Ge||uo.circles.length>0&&!uo.collisionDetected,si=si&&uo.offscreen}if(bi.iconFeatureIndex&&(Ks=bi.iconFeatureIndex),bi.iconBox){var bu=function(Vo){var Fs=Vt&&Di?Ws(Vo,Di.x,Di.y,_t,fr,v.transform.angle):Vo;return v.collisionIndex.placeCollisionBox(Fs,xt,he,k,Re.predicate)};Ri=mo&&mo.box&&mo.box.length&&bi.verticalIconBox?(Ro=bu(bi.verticalIconBox)).box.length>0:(Ro=bu(bi.iconBox)).box.length>0,si=si&&Ro.offscreen}var ko=Ye||Rn.numHorizontalGlyphVertices===0&&Rn.numVerticalGlyphVertices===0,Lu=ze||Rn.numIconVertices===0;if(ko||Lu?Lu?ko||(Ri=Ri&&Qn):Qn=Ri&&Qn:Ri=Qn=Ri&&Qn,Qn&&Oi&&Oi.box&&v.collisionIndex.insertCollisionBox(Oi.box,I.get("text-ignore-placement"),T.bucketInstanceId,mo&&mo.box&&no?no:Za,Re.ID),Ri&&Ro&&v.collisionIndex.insertCollisionBox(Ro.box,I.get("icon-ignore-placement"),T.bucketInstanceId,Ks,Re.ID),uo&&(Qn&&v.collisionIndex.insertCollisionCircles(uo.circles,I.get("text-ignore-placement"),T.bucketInstanceId,Za,Re.ID),l)){var Jc=T.bucketInstanceId,Qu=v.collisionCircleArrays[Jc];Qu===void 0&&(Qu=v.collisionCircleArrays[Jc]=new mt);for(var jo=0;jo<uo.circles.length;jo+=4)Qu.circles.push(uo.circles[jo+0]),Qu.circles.push(uo.circles[jo+1]),Qu.circles.push(uo.circles[jo+2]),Qu.circles.push(uo.collisionDetected?1:0)}v.placements[Rn.crossTileID]=new Oo(Qn||vr,Ri||xr,si||T.justReloaded),f[Rn.crossTileID]=!0}};if(lr)for(var cn=T.getSortedSymbolIndexes(this.transform.angle),Un=cn.length-1;Un>=0;--Un){var Jn=cn[Un];Hr(T.symbolInstances.get(Jn),T.collisionArrays[Jn])}else for(var oi=p.symbolInstanceStart;oi<p.symbolInstanceEnd;oi++)Hr(T.symbolInstances.get(oi),T.collisionArrays[oi]);if(l&&T.bucketInstanceId in this.collisionCircleArrays){var ji=this.collisionCircleArrays[T.bucketInstanceId];h.invert(ji.invProjMatrix,k),ji.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1},Io.prototype.markUsedJustification=function(p,f,l,v){var E;E=v===h.WritingMode.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[h.getAnchorJustification(f)];for(var T=0,I=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];T<I.length;T+=1){var k=I[T];k>=0&&(p.text.placedSymbolArray.get(k).crossTileID=E>=0&&k!==E?0:l.crossTileID)}},Io.prototype.markUsedOrientation=function(p,f,l){for(var v=f===h.WritingMode.horizontal||f===h.WritingMode.horizontalOnly?f:0,E=f===h.WritingMode.vertical?f:0,T=0,I=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];T<I.length;T+=1)p.text.placedSymbolArray.get(I[T]).placedOrientation=v;l.verticalPlacedTextSymbolIndex&&(p.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=E)},Io.prototype.commit=function(p){this.commitTime=p,this.zoomAtLastRecencyCheck=this.transform.zoom;var f=this.prevPlacement,l=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;var v=f?f.symbolFadeChange(p):1,E=f?f.opacities:{},T=f?f.variableOffsets:{},I=f?f.placedOrientations:{};for(var k in this.placements){var W=this.placements[k],q=E[k];q?(this.opacities[k]=new $r(q,v,W.text,W.icon),l=l||W.text!==q.text.placed||W.icon!==q.icon.placed):(this.opacities[k]=new $r(null,v,W.text,W.icon,W.skipFade),l=l||W.text||W.icon)}for(var he in E){var ve=E[he];if(!this.opacities[he]){var xe=new $r(ve,v,!1,!1);xe.isHidden()||(this.opacities[he]=xe,l=l||ve.text.placed||ve.icon.placed)}}for(var Ne in T)this.variableOffsets[Ne]||!this.opacities[Ne]||this.opacities[Ne].isHidden()||(this.variableOffsets[Ne]=T[Ne]);for(var Re in I)this.placedOrientations[Re]||!this.opacities[Re]||this.opacities[Re].isHidden()||(this.placedOrientations[Re]=I[Re]);l?this.lastPlacementChangeTime=p:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:p)},Io.prototype.updateLayerOpacities=function(p,f){for(var l={},v=0,E=f;v<E.length;v+=1){var T=E[v],I=T.getBucket(p);I&&T.latestFeatureIndex&&p.id===I.layerIds[0]&&this.updateBucketOpacities(I,l,T.collisionBoxArray)}},Io.prototype.updateBucketOpacities=function(p,f,l){var v=this;p.hasTextData()&&p.text.opacityVertexArray.clear(),p.hasIconData()&&p.icon.opacityVertexArray.clear(),p.hasIconCollisionBoxData()&&p.iconCollisionBox.collisionVertexArray.clear(),p.hasTextCollisionBoxData()&&p.textCollisionBox.collisionVertexArray.clear();var E=p.layers[0].layout,T=new $r(null,0,!1,!1,!0),I=E.get("text-allow-overlap"),k=E.get("icon-allow-overlap"),W=E.get("text-variable-anchor"),q=E.get("text-rotation-alignment")==="map",he=E.get("text-pitch-alignment")==="map",ve=E.get("icon-text-fit")!=="none",xe=new $r(null,0,I&&(k||!p.hasIconData()||E.get("icon-optional")),k&&(I||!p.hasTextData()||E.get("text-optional")),!0);!p.collisionArrays&&l&&(p.hasIconCollisionBoxData()||p.hasTextCollisionBoxData())&&p.deserializeCollisionBoxes(l);for(var Ne=function(xt,_t,fr){for(var Vt=0;Vt<_t/4;Vt++)xt.opacityVertexArray.emplaceBack(fr)},Re=function(xt){var _t=p.symbolInstances.get(xt),fr=_t.numHorizontalGlyphVertices,Vt=_t.numVerticalGlyphVertices,lr=_t.crossTileID,vr=v.opacities[lr];f[lr]?vr=T:vr||(v.opacities[lr]=vr=xe),f[lr]=!0;var xr=_t.numIconVertices>0,Hr=v.placedOrientations[_t.crossTileID],cn=Hr===h.WritingMode.vertical,Un=Hr===h.WritingMode.horizontal||Hr===h.WritingMode.horizontalOnly;if(fr>0||Vt>0){var Jn=Oa(vr.text);Ne(p.text,fr,cn?Sa:Jn),Ne(p.text,Vt,Un?Sa:Jn);var oi=vr.text.isHidden();[_t.rightJustifiedTextSymbolIndex,_t.centerJustifiedTextSymbolIndex,_t.leftJustifiedTextSymbolIndex].forEach(function($i){$i>=0&&(p.text.placedSymbolArray.get($i).hidden=oi||cn?1:0)}),_t.verticalPlacedTextSymbolIndex>=0&&(p.text.placedSymbolArray.get(_t.verticalPlacedTextSymbolIndex).hidden=oi||Un?1:0);var ji=v.variableOffsets[_t.crossTileID];ji&&v.markUsedJustification(p,ji.anchor,_t,Hr);var hi=v.placedOrientations[_t.crossTileID];hi&&(v.markUsedJustification(p,"left",_t,hi),v.markUsedOrientation(p,hi,_t))}if(xr){var Rn=Oa(vr.icon),bi=!(ve&&_t.verticalPlacedIconSymbolIndex&&cn);_t.placedIconSymbolIndex>=0&&(Ne(p.icon,_t.numIconVertices,bi?Rn:Sa),p.icon.placedSymbolArray.get(_t.placedIconSymbolIndex).hidden=vr.icon.isHidden()),_t.verticalPlacedIconSymbolIndex>=0&&(Ne(p.icon,_t.numVerticalIconVertices,bi?Sa:Rn),p.icon.placedSymbolArray.get(_t.verticalPlacedIconSymbolIndex).hidden=vr.icon.isHidden())}if(p.hasIconCollisionBoxData()||p.hasTextCollisionBoxData()){var Oi=p.collisionArrays[xt];if(Oi){var Qn=new h.Point(0,0);if(Oi.textBox||Oi.verticalTextBox){var Ri=!0;if(W){var si=v.variableOffsets[lr];si?(Qn=oe(si.anchor,si.width,si.height,si.textOffset,si.textBoxScale),q&&Qn._rotate(he?v.transform.angle:-v.transform.angle)):Ri=!1}Oi.textBox&&xo(p.textCollisionBox.collisionVertexArray,vr.text.placed,!Ri||cn,Qn.x,Qn.y),Oi.verticalTextBox&&xo(p.textCollisionBox.collisionVertexArray,vr.text.placed,!Ri||Un,Qn.x,Qn.y)}var Di=Boolean(!Un&&Oi.verticalIconBox);Oi.iconBox&&xo(p.iconCollisionBox.collisionVertexArray,vr.icon.placed,Di,ve?Qn.x:0,ve?Qn.y:0),Oi.verticalIconBox&&xo(p.iconCollisionBox.collisionVertexArray,vr.icon.placed,!Di,ve?Qn.x:0,ve?Qn.y:0)}}},Ye=0;Ye<p.symbolInstances.length;Ye++)Re(Ye);if(p.sortFeatures(this.transform.angle),this.retainedQueryData[p.bucketInstanceId]&&(this.retainedQueryData[p.bucketInstanceId].featureSortOrder=p.featureSortOrder),p.hasTextData()&&p.text.opacityVertexBuffer&&p.text.opacityVertexBuffer.updateData(p.text.opacityVertexArray),p.hasIconData()&&p.icon.opacityVertexBuffer&&p.icon.opacityVertexBuffer.updateData(p.icon.opacityVertexArray),p.hasIconCollisionBoxData()&&p.iconCollisionBox.collisionVertexBuffer&&p.iconCollisionBox.collisionVertexBuffer.updateData(p.iconCollisionBox.collisionVertexArray),p.hasTextCollisionBoxData()&&p.textCollisionBox.collisionVertexBuffer&&p.textCollisionBox.collisionVertexBuffer.updateData(p.textCollisionBox.collisionVertexArray),p.bucketInstanceId in this.collisionCircleArrays){var ze=this.collisionCircleArrays[p.bucketInstanceId];p.placementInvProjMatrix=ze.invProjMatrix,p.placementViewportMatrix=ze.viewportMatrix,p.collisionCircleArray=ze.circles,delete this.collisionCircleArrays[p.bucketInstanceId]}},Io.prototype.symbolFadeChange=function(p){return this.fadeDuration===0?1:(p-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Io.prototype.zoomAdjustment=function(p){return Math.max(0,(this.transform.zoom-p)/1.5)},Io.prototype.hasTransitions=function(p){return this.stale||p-this.lastPlacementChangeTime<this.fadeDuration},Io.prototype.stillRecent=function(p,f){var l=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*l>p},Io.prototype.setStale=function(){this.stale=!0};var Ve=Math.pow(2,25),fe=Math.pow(2,24),Ue=Math.pow(2,17),kt=Math.pow(2,16),Gr=Math.pow(2,9),In=Math.pow(2,8),Li=Math.pow(2,1);function Oa(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;var f=p.placed?1:0,l=Math.floor(127*p.opacity);return l*Ve+f*fe+l*Ue+f*kt+l*Gr+f*In+l*Li+f}var Sa=0,Ia=function(f){this._sortAcrossTiles=f.layout.get("symbol-z-order")!=="viewport-y"&&f.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ia.prototype.continuePlacement=function(p,f,l,v,E){for(var T=this._bucketParts;this._currentTileIndex<p.length;)if(f.getBucketParts(T,v,p[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort(function(I,k){return I.sortKey-k.sortKey}));this._currentPartIndex<T.length;)if(f.placeLayerBucketPart(T[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,E())return!0;return!1};var oo=function(f,l,v,E,T,I,k){this.placement=new Io(f,T,I,k),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=E,this._done=!1};oo.prototype.isDone=function(){return this._done},oo.prototype.continuePlacement=function(p,f,l){for(var v=this,E=h.browser.now(),T=function(){var q=h.browser.now()-E;return!v._forceFullPlacement&&q>2};this._currentPlacementIndex>=0;){var I=f[p[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(I.type==="symbol"&&(!I.minzoom||I.minzoom<=k)&&(!I.maxzoom||I.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new Ia(I)),this._inProgressLayer.continuePlacement(l[I.source],this.placement,this._showCollisionBoxes,I,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},oo.prototype.commit=function(p){return this.placement.commit(p),this.placement};var Cl=512/h.EXTENT/2,gs=function(f,l,v){this.tileID=f,this.indexedSymbolInstances={},this.bucketInstanceId=v;for(var E=0;E<l.length;E++){var T=l.get(E),I=T.key;this.indexedSymbolInstances[I]||(this.indexedSymbolInstances[I]=[]),this.indexedSymbolInstances[I].push({crossTileID:T.crossTileID,coord:this.getScaledCoordinates(T,f)})}};gs.prototype.getScaledCoordinates=function(p,f){var l=Cl/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*h.EXTENT+p.anchorX)*l),y:Math.floor((f.canonical.y*h.EXTENT+p.anchorY)*l)}},gs.prototype.findMatches=function(p,f,l){for(var v=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),E=0;E<p.length;E++){var T=p.get(E);if(!T.crossTileID){var I=this.indexedSymbolInstances[T.key];if(I)for(var k=this.getScaledCoordinates(T,f),W=0,q=I;W<q.length;W+=1){var he=q[W];if(Math.abs(he.coord.x-k.x)<=v&&Math.abs(he.coord.y-k.y)<=v&&!l[he.crossTileID]){l[he.crossTileID]=!0,T.crossTileID=he.crossTileID;break}}}}};var ho=function(){this.maxCrossTileID=0};ho.prototype.generate=function(){return++this.maxCrossTileID};var us=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};us.prototype.handleWrapJump=function(p){var f=Math.round((p-this.lng)/360);if(f!==0)for(var l in this.indexes){var v=this.indexes[l],E={};for(var T in v){var I=v[T];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+f),E[I.tileID.key]=I}this.indexes[l]=E}this.lng=p},us.prototype.addBucket=function(p,f,l){if(this.indexes[p.overscaledZ]&&this.indexes[p.overscaledZ][p.key]){if(this.indexes[p.overscaledZ][p.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(p.overscaledZ,this.indexes[p.overscaledZ][p.key])}for(var v=0;v<f.symbolInstances.length;v++)f.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[p.overscaledZ]||(this.usedCrossTileIDs[p.overscaledZ]={});var E=this.usedCrossTileIDs[p.overscaledZ];for(var T in this.indexes){var I=this.indexes[T];if(Number(T)>p.overscaledZ)for(var k in I){var W=I[k];W.tileID.isChildOf(p)&&W.findMatches(f.symbolInstances,p,E)}else{var q=I[p.scaledTo(Number(T)).key];q&&q.findMatches(f.symbolInstances,p,E)}}for(var he=0;he<f.symbolInstances.length;he++){var ve=f.symbolInstances.get(he);ve.crossTileID||(ve.crossTileID=l.generate(),E[ve.crossTileID]=!0)}return this.indexes[p.overscaledZ]===void 0&&(this.indexes[p.overscaledZ]={}),this.indexes[p.overscaledZ][p.key]=new gs(p,f.symbolInstances,f.bucketInstanceId),!0},us.prototype.removeBucketCrossTileIDs=function(p,f){for(var l in f.indexedSymbolInstances)for(var v=0,E=f.indexedSymbolInstances[l];v<E.length;v+=1)delete this.usedCrossTileIDs[p][E[v].crossTileID]},us.prototype.removeStaleBuckets=function(p){var f=!1;for(var l in this.indexes){var v=this.indexes[l];for(var E in v)p[v[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,v[E]),delete v[E],f=!0)}return f};var Ts=function(){this.layerIndexes={},this.crossTileIDs=new ho,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Ts.prototype.addLayer=function(p,f,l){var v=this.layerIndexes[p.id];v===void 0&&(v=this.layerIndexes[p.id]=new us);var E=!1,T={};v.handleWrapJump(l);for(var I=0,k=f;I<k.length;I+=1){var W=k[I],q=W.getBucket(p);q&&p.id===q.layerIds[0]&&(q.bucketInstanceId||(q.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(W.tileID,q,this.crossTileIDs)&&(E=!0),T[q.bucketInstanceId]=!0)}return v.removeStaleBuckets(T)&&(E=!0),E},Ts.prototype.pruneUnusedLayers=function(p){var f={};for(var l in p.forEach(function(v){f[v]=!0}),this.layerIndexes)f[l]||delete this.layerIndexes[l]};var Ms=function(f,l){return h.emitValidationErrors(f,l&&l.filter(function(v){return v.identifier!=="source.canvas"}))},Yo=h.pick(xn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),au=h.pick(xn,["setCenter","setZoom","setBearing","setPitch"]),Ps=function(){var p={},f=h.styleSpec.$version;for(var l in h.styleSpec.$root){var v,E=h.styleSpec.$root[l];E.required&&(v=l==="version"?f:E.type==="array"?[]:{})!=null&&(p[l]=v)}return p}(),Ca=function(p){function f(l,v){var E=this;v===void 0&&(v={}),p.call(this),this.map=l,this.dispatcher=new nr(tr(),this),this.imageManager=new Be,this.imageManager.setEventedParent(this),this.glyphManager=new br(l._requestManager,v.localIdeographFontFamily),this.lineAtlas=new Nt(256,512),this.crossTileSymbolIndex=new Ts,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",h.getReferrer());var T=this;this._rtlTextPluginCallback=f.registerForPluginStateChange(function(I){T.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:I.pluginStatus,pluginURL:I.pluginURL},function(k,W){if(h.triggerPluginCompletionEvent(k),W&&W.every(function(he){return he}))for(var q in T.sourceCaches)T.sourceCaches[q].reload()})}),this.on("data",function(I){if(I.dataType==="source"&&I.sourceDataType==="metadata"){var k=E.sourceCaches[I.sourceId];if(k){var W=k.getSource();if(W&&W.vectorLayerIds)for(var q in E._layers){var he=E._layers[q];he.source===W.id&&E._validateLayer(he)}}}})}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.loadURL=function(l,v){var E=this;v===void 0&&(v={}),this.fire(new h.Event("dataloading",{dataType:"style"}));var T=typeof v.validate=="boolean"?v.validate:!h.isMapboxURL(l);l=this.map._requestManager.normalizeStyleURL(l,v.accessToken);var I=this.map._requestManager.transformRequest(l,h.ResourceType.Style);this._request=h.getJSON(I,function(k,W){E._request=null,k?E.fire(new h.ErrorEvent(k)):W&&E._load(W,T)})},f.prototype.loadJSON=function(l,v){var E=this;v===void 0&&(v={}),this.fire(new h.Event("dataloading",{dataType:"style"})),this._request=h.browser.frame(function(){E._request=null,E._load(l,v.validate!==!1)})},f.prototype.loadEmpty=function(){this.fire(new h.Event("dataloading",{dataType:"style"})),this._load(Ps,!1)},f.prototype._load=function(l,v){if(!v||!Ms(this,h.validateStyle(l))){for(var E in this._loaded=!0,this.stylesheet=l,l.sources)this.addSource(E,l.sources[E],{validate:!1});l.sprite?this._loadSprite(l.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(l.glyphs);var T=hn(this.stylesheet.layers);this._order=T.map(function(q){return q.id}),this._layers={},this._serializedLayers={};for(var I=0,k=T;I<k.length;I+=1){var W=k[I];(W=h.createStyleLayer(W)).setEventedParent(this,{layer:{id:W.id}}),this._layers[W.id]=W,this._serializedLayers[W.id]=W.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Mt(this.stylesheet.light),this.fire(new h.Event("data",{dataType:"style"})),this.fire(new h.Event("style.load"))}},f.prototype._loadSprite=function(l){var v=this;this._spriteRequest=function(E,T,I){var k,W,q,he=h.browser.devicePixelRatio>1?"@2x":"",ve=h.getJSON(T.transformRequest(T.normalizeSpriteURL(E,he,".json"),h.ResourceType.SpriteJSON),function(Re,Ye){ve=null,q||(q=Re,k=Ye,Ne())}),xe=h.getImage(T.transformRequest(T.normalizeSpriteURL(E,he,".png"),h.ResourceType.SpriteImage),function(Re,Ye){xe=null,q||(q=Re,W=Ye,Ne())});function Ne(){if(q)I(q);else if(k&&W){var Re=h.browser.getImageData(W),Ye={};for(var ze in k){var Ge=k[ze],xt=Ge.width,_t=Ge.height,fr=Ge.x,Vt=Ge.y,lr=Ge.sdf,vr=Ge.pixelRatio,xr=Ge.stretchX,Hr=Ge.stretchY,cn=Ge.content,Un=new h.RGBAImage({width:xt,height:_t});h.RGBAImage.copy(Re,Un,{x:fr,y:Vt},{x:0,y:0},{width:xt,height:_t}),Ye[ze]={data:Un,pixelRatio:vr,sdf:lr,stretchX:xr,stretchY:Hr,content:cn}}I(null,Ye)}}return{cancel:function(){ve&&(ve.cancel(),ve=null),xe&&(xe.cancel(),xe=null)}}}(l,this.map._requestManager,function(E,T){if(v._spriteRequest=null,E)v.fire(new h.ErrorEvent(E));else if(T)for(var I in T)v.imageManager.addImage(I,T[I]);v.imageManager.setLoaded(!0),v._availableImages=v.imageManager.listImages(),v.dispatcher.broadcast("setImages",v._availableImages),v.fire(new h.Event("data",{dataType:"style"}))})},f.prototype._validateLayer=function(l){var v=this.sourceCaches[l.source];if(v){var E=l.sourceLayer;if(E){var T=v.getSource();(T.type==="geojson"||T.vectorLayerIds&&T.vectorLayerIds.indexOf(E)===-1)&&this.fire(new h.ErrorEvent(new Error('Source layer "'+E+'" does not exist on source "'+T.id+'" as specified by style layer "'+l.id+'"')))}}},f.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()},f.prototype._serializeLayers=function(l){for(var v=[],E=0,T=l;E<T.length;E+=1){var I=this._layers[T[E]];I.type!=="custom"&&v.push(I.serialize())}return v},f.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(var v in this._layers)if(this._layers[v].hasTransition())return!0;return!1},f.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},f.prototype.update=function(l){if(this._loaded){var v=this._changed;if(this._changed){var E=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);for(var I in(E.length||T.length)&&this._updateWorkerLayers(E,T),this._updatedSources){var k=this._updatedSources[I];k==="reload"?this._reloadSource(I):k==="clear"&&this._clearSource(I)}for(var W in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[W].updateTransitions(l);this.light.updateTransitions(l),this._resetUpdates()}var q={};for(var he in this.sourceCaches){var ve=this.sourceCaches[he];q[he]=ve.used,ve.used=!1}for(var xe=0,Ne=this._order;xe<Ne.length;xe+=1){var Re=this._layers[Ne[xe]];Re.recalculate(l,this._availableImages),!Re.isHidden(l.zoom)&&Re.source&&(this.sourceCaches[Re.source].used=!0)}for(var Ye in q){var ze=this.sourceCaches[Ye];q[Ye]!==ze.used&&ze.fire(new h.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Ye}))}this.light.recalculate(l),this.z=l.zoom,v&&this.fire(new h.Event("data",{dataType:"style"}))}},f.prototype._updateTilesForChangedImages=function(){var l=Object.keys(this._changedImages);if(l.length){for(var v in this.sourceCaches)this.sourceCaches[v].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}},f.prototype._updateWorkerLayers=function(l,v){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:v})},f.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},f.prototype.setState=function(l){var v=this;if(this._checkLoaded(),Ms(this,h.validateStyle(l)))return!1;(l=h.clone$1(l)).layers=hn(l.layers);var E=function(I,k){if(!I)return[{command:xn.setStyle,args:[k]}];var W=[];try{if(!h.deepEqual(I.version,k.version))return[{command:xn.setStyle,args:[k]}];h.deepEqual(I.center,k.center)||W.push({command:xn.setCenter,args:[k.center]}),h.deepEqual(I.zoom,k.zoom)||W.push({command:xn.setZoom,args:[k.zoom]}),h.deepEqual(I.bearing,k.bearing)||W.push({command:xn.setBearing,args:[k.bearing]}),h.deepEqual(I.pitch,k.pitch)||W.push({command:xn.setPitch,args:[k.pitch]}),h.deepEqual(I.sprite,k.sprite)||W.push({command:xn.setSprite,args:[k.sprite]}),h.deepEqual(I.glyphs,k.glyphs)||W.push({command:xn.setGlyphs,args:[k.glyphs]}),h.deepEqual(I.transition,k.transition)||W.push({command:xn.setTransition,args:[k.transition]}),h.deepEqual(I.light,k.light)||W.push({command:xn.setLight,args:[k.light]});var q={},he=[];(function(xe,Ne,Re,Ye){var ze;for(ze in Ne=Ne||{},xe=xe||{})xe.hasOwnProperty(ze)&&(Ne.hasOwnProperty(ze)||wn(ze,Re,Ye));for(ze in Ne)Ne.hasOwnProperty(ze)&&(xe.hasOwnProperty(ze)?h.deepEqual(xe[ze],Ne[ze])||(xe[ze].type==="geojson"&&Ne[ze].type==="geojson"&&Ki(xe,Ne,ze)?Re.push({command:xn.setGeoJSONSourceData,args:[ze,Ne[ze].data]}):Ni(ze,Ne,Re,Ye)):_i(ze,Ne,Re))})(I.sources,k.sources,he,q);var ve=[];I.layers&&I.layers.forEach(function(xe){q[xe.source]?W.push({command:xn.removeLayer,args:[xe.id]}):ve.push(xe)}),W=W.concat(he),function(xe,Ne,Re){Ne=Ne||[];var Ye,ze,Ge,xt,_t,fr,Vt,lr=(xe=xe||[]).map(Fn),vr=Ne.map(Fn),xr=xe.reduce(Ui,{}),Hr=Ne.reduce(Ui,{}),cn=lr.slice(),Un=Object.create(null);for(Ye=0,ze=0;Ye<lr.length;Ye++)Hr.hasOwnProperty(Ge=lr[Ye])?ze++:(Re.push({command:xn.removeLayer,args:[Ge]}),cn.splice(cn.indexOf(Ge,ze),1));for(Ye=0,ze=0;Ye<vr.length;Ye++)cn[cn.length-1-Ye]!==(Ge=vr[vr.length-1-Ye])&&(xr.hasOwnProperty(Ge)?(Re.push({command:xn.removeLayer,args:[Ge]}),cn.splice(cn.lastIndexOf(Ge,cn.length-ze),1)):ze++,Re.push({command:xn.addLayer,args:[Hr[Ge],fr=cn[cn.length-Ye]]}),cn.splice(cn.length-Ye,0,Ge),Un[Ge]=!0);for(Ye=0;Ye<vr.length;Ye++)if(xt=xr[Ge=vr[Ye]],_t=Hr[Ge],!Un[Ge]&&!h.deepEqual(xt,_t))if(h.deepEqual(xt.source,_t.source)&&h.deepEqual(xt["source-layer"],_t["source-layer"])&&h.deepEqual(xt.type,_t.type)){for(Vt in Mi(xt.layout,_t.layout,Re,Ge,null,xn.setLayoutProperty),Mi(xt.paint,_t.paint,Re,Ge,null,xn.setPaintProperty),h.deepEqual(xt.filter,_t.filter)||Re.push({command:xn.setFilter,args:[Ge,_t.filter]}),h.deepEqual(xt.minzoom,_t.minzoom)&&h.deepEqual(xt.maxzoom,_t.maxzoom)||Re.push({command:xn.setLayerZoomRange,args:[Ge,_t.minzoom,_t.maxzoom]}),xt)xt.hasOwnProperty(Vt)&&Vt!=="layout"&&Vt!=="paint"&&Vt!=="filter"&&Vt!=="metadata"&&Vt!=="minzoom"&&Vt!=="maxzoom"&&(Vt.indexOf("paint.")===0?Mi(xt[Vt],_t[Vt],Re,Ge,Vt.slice(6),xn.setPaintProperty):h.deepEqual(xt[Vt],_t[Vt])||Re.push({command:xn.setLayerProperty,args:[Ge,Vt,_t[Vt]]}));for(Vt in _t)_t.hasOwnProperty(Vt)&&!xt.hasOwnProperty(Vt)&&Vt!=="layout"&&Vt!=="paint"&&Vt!=="filter"&&Vt!=="metadata"&&Vt!=="minzoom"&&Vt!=="maxzoom"&&(Vt.indexOf("paint.")===0?Mi(xt[Vt],_t[Vt],Re,Ge,Vt.slice(6),xn.setPaintProperty):h.deepEqual(xt[Vt],_t[Vt])||Re.push({command:xn.setLayerProperty,args:[Ge,Vt,_t[Vt]]}))}else Re.push({command:xn.removeLayer,args:[Ge]}),fr=cn[cn.lastIndexOf(Ge)+1],Re.push({command:xn.addLayer,args:[_t,fr]})}(ve,k.layers,W)}catch(xe){console.warn("Unable to compute style diff:",xe),W=[{command:xn.setStyle,args:[k]}]}return W}(this.serialize(),l).filter(function(I){return!(I.command in au)});if(E.length===0)return!1;var T=E.filter(function(I){return!(I.command in Yo)});if(T.length>0)throw new Error("Unimplemented: "+T.map(function(I){return I.command}).join(", ")+".");return E.forEach(function(I){I.command!=="setTransition"&&v[I.command].apply(v,I.args)}),this.stylesheet=l,!0},f.prototype.addImage=function(l,v){if(this.getImage(l))return this.fire(new h.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(l,v),this._afterImageUpdated(l)},f.prototype.updateImage=function(l,v){this.imageManager.updateImage(l,v)},f.prototype.getImage=function(l){return this.imageManager.getImage(l)},f.prototype.removeImage=function(l){if(!this.getImage(l))return this.fire(new h.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(l),this._afterImageUpdated(l)},f.prototype._afterImageUpdated=function(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))},f.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},f.prototype.addSource=function(l,v,E){var T=this;if(E===void 0&&(E={}),this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error("There is already a source with this ID");if(!v.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(v).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(v.type)>=0&&this._validate(h.validateStyle.source,"sources."+l,v,null,E))){this.map&&this.map._collectResourceTiming&&(v.collectResourceTiming=!0);var I=this.sourceCaches[l]=new je(l,v,this.dispatcher);I.style=this,I.setEventedParent(this,function(){return{isSourceLoaded:T.loaded(),source:I.serialize(),sourceId:l}}),I.onAdd(this.map),this._changed=!0}},f.prototype.removeSource=function(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(var v in this._layers)if(this._layers[v].source===l)return this.fire(new h.ErrorEvent(new Error('Source "'+l+'" cannot be removed while layer "'+v+'" is using it.')));var E=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],E.fire(new h.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),E.setEventedParent(null),E.clearTiles(),E.onRemove&&E.onRemove(this.map),this._changed=!0},f.prototype.setGeoJSONSourceData=function(l,v){this._checkLoaded(),this.sourceCaches[l].getSource().setData(v),this._changed=!0},f.prototype.getSource=function(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()},f.prototype.addLayer=function(l,v,E){E===void 0&&(E={}),this._checkLoaded();var T=l.id;if(this.getLayer(T))this.fire(new h.ErrorEvent(new Error('Layer with id "'+T+'" already exists on this map')));else{var I;if(l.type==="custom"){if(Ms(this,h.validateCustomStyleLayer(l)))return;I=h.createStyleLayer(l)}else{if(typeof l.source=="object"&&(this.addSource(T,l.source),l=h.clone$1(l),l=h.extend(l,{source:T})),this._validate(h.validateStyle.layer,"layers."+T,l,{arrayIndex:-1},E))return;I=h.createStyleLayer(l),this._validateLayer(I),I.setEventedParent(this,{layer:{id:T}}),this._serializedLayers[I.id]=I.serialize()}var k=v?this._order.indexOf(v):this._order.length;if(v&&k===-1)this.fire(new h.ErrorEvent(new Error('Layer with id "'+v+'" does not exist on this map.')));else{if(this._order.splice(k,0,T),this._layerOrderChanged=!0,this._layers[T]=I,this._removedLayers[T]&&I.source&&I.type!=="custom"){var W=this._removedLayers[T];delete this._removedLayers[T],W.type!==I.type?this._updatedSources[I.source]="clear":(this._updatedSources[I.source]="reload",this.sourceCaches[I.source].pause())}this._updateLayer(I),I.onAdd&&I.onAdd(this.map)}}},f.prototype.moveLayer=function(l,v){if(this._checkLoaded(),this._changed=!0,this._layers[l]){if(l!==v){var E=this._order.indexOf(l);this._order.splice(E,1);var T=v?this._order.indexOf(v):this._order.length;v&&T===-1?this.fire(new h.ErrorEvent(new Error('Layer with id "'+v+'" does not exist on this map.'))):(this._order.splice(T,0,l),this._layerOrderChanged=!0)}}else this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be moved.")))},f.prototype.removeLayer=function(l){this._checkLoaded();var v=this._layers[l];if(v){v.setEventedParent(null);var E=this._order.indexOf(l);this._order.splice(E,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=v,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],v.onRemove&&v.onRemove(this.map)}else this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be removed.")))},f.prototype.getLayer=function(l){return this._layers[l]},f.prototype.hasLayer=function(l){return l in this._layers},f.prototype.setLayerZoomRange=function(l,v,E){this._checkLoaded();var T=this.getLayer(l);T?T.minzoom===v&&T.maxzoom===E||(v!=null&&(T.minzoom=v),E!=null&&(T.maxzoom=E),this._updateLayer(T)):this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot have zoom extent.")))},f.prototype.setFilter=function(l,v,E){E===void 0&&(E={}),this._checkLoaded();var T=this.getLayer(l);if(T){if(!h.deepEqual(T.filter,v))return v==null?(T.filter=void 0,void this._updateLayer(T)):void(this._validate(h.validateStyle.filter,"layers."+T.id+".filter",v,null,E)||(T.filter=h.clone$1(v),this._updateLayer(T)))}else this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be filtered.")))},f.prototype.getFilter=function(l){return h.clone$1(this.getLayer(l).filter)},f.prototype.setLayoutProperty=function(l,v,E,T){T===void 0&&(T={}),this._checkLoaded();var I=this.getLayer(l);I?h.deepEqual(I.getLayoutProperty(v),E)||(I.setLayoutProperty(v,E,T),this._updateLayer(I)):this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getLayoutProperty=function(l,v){var E=this.getLayer(l);if(E)return E.getLayoutProperty(v);this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style.")))},f.prototype.setPaintProperty=function(l,v,E,T){T===void 0&&(T={}),this._checkLoaded();var I=this.getLayer(l);I?h.deepEqual(I.getPaintProperty(v),E)||(I.setPaintProperty(v,E,T)&&this._updateLayer(I),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getPaintProperty=function(l,v){return this.getLayer(l).getPaintProperty(v)},f.prototype.setFeatureState=function(l,v){this._checkLoaded();var E=l.source,T=l.sourceLayer,I=this.sourceCaches[E];if(I!==void 0){var k=I.getSource().type;k==="geojson"&&T?this.fire(new h.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):k!=="vector"||T?(l.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),I.setFeatureState(T,l.id,v)):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+E+"' does not exist in the map's style.")))},f.prototype.removeFeatureState=function(l,v){this._checkLoaded();var E=l.source,T=this.sourceCaches[E];if(T!==void 0){var I=T.getSource().type,k=I==="vector"?l.sourceLayer:void 0;I!=="vector"||k?v&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new h.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):T.removeFeatureState(k,l.id,v):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+E+"' does not exist in the map's style.")))},f.prototype.getFeatureState=function(l){this._checkLoaded();var v=l.source,E=l.sourceLayer,T=this.sourceCaches[v];if(T!==void 0){if(T.getSource().type!=="vector"||E)return l.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),T.getFeatureState(E,l.id);this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+v+"' does not exist in the map's style.")))},f.prototype.getTransition=function(){return h.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},f.prototype.serialize=function(){return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:h.mapObject(this.sourceCaches,function(l){return l.serialize()}),layers:this._serializeLayers(this._order)},function(l){return l!==void 0})},f.prototype._updateLayer=function(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._changed=!0},f.prototype._flattenAndSortRenderedFeatures=function(l){for(var v=this,E=function(Hr){return v._layers[Hr].type==="fill-extrusion"},T={},I=[],k=this._order.length-1;k>=0;k--){var W=this._order[k];if(E(W)){T[W]=k;for(var q=0,he=l;q<he.length;q+=1){var ve=he[q][W];if(ve)for(var xe=0,Ne=ve;xe<Ne.length;xe+=1)I.push(Ne[xe])}}}I.sort(function(xr,Hr){return Hr.intersectionZ-xr.intersectionZ});for(var Re=[],Ye=this._order.length-1;Ye>=0;Ye--){var ze=this._order[Ye];if(E(ze))for(var Ge=I.length-1;Ge>=0;Ge--){var xt=I[Ge].feature;if(T[xt.layer.id]<Ye)break;Re.push(xt),I.pop()}else for(var _t=0,fr=l;_t<fr.length;_t+=1){var Vt=fr[_t][ze];if(Vt)for(var lr=0,vr=Vt;lr<vr.length;lr+=1)Re.push(vr[lr].feature)}}return Re},f.prototype.queryRenderedFeatures=function(l,v,E){v&&v.filter&&this._validate(h.validateStyle.filter,"queryRenderedFeatures.filter",v.filter,null,v);var T={};if(v&&v.layers){if(!Array.isArray(v.layers))return this.fire(new h.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var I=0,k=v.layers;I<k.length;I+=1){var W=k[I],q=this._layers[W];if(!q)return this.fire(new h.ErrorEvent(new Error("The layer '"+W+"' does not exist in the map's style and cannot be queried for features."))),[];T[q.source]=!0}}var he=[];for(var ve in v.availableImages=this._availableImages,this.sourceCaches)v.layers&&!T[ve]||he.push(Ft(this.sourceCaches[ve],this._layers,this._serializedLayers,l,v,E));return this.placement&&he.push(function(xe,Ne,Re,Ye,ze,Ge,xt){for(var _t={},fr=Ge.queryRenderedSymbols(Ye),Vt=[],lr=0,vr=Object.keys(fr).map(Number);lr<vr.length;lr+=1)Vt.push(xt[vr[lr]]);Vt.sort(Et);for(var xr=function(){var ji=cn[Hr],hi=ji.featureIndex.lookupSymbolFeatures(fr[ji.bucketInstanceId],Ne,ji.bucketIndex,ji.sourceLayerIndex,ze.filter,ze.layers,ze.availableImages,xe);for(var Rn in hi){var bi=_t[Rn]=_t[Rn]||[],Oi=hi[Rn];Oi.sort(function(si,Di){var $i=ji.featureSortOrder;if($i){var mo=$i.indexOf(si.featureIndex);return $i.indexOf(Di.featureIndex)-mo}return Di.featureIndex-si.featureIndex});for(var Qn=0,Ri=Oi;Qn<Ri.length;Qn+=1)bi.push(Ri[Qn])}},Hr=0,cn=Vt;Hr<cn.length;Hr+=1)xr();var Un=function(ji){_t[ji].forEach(function(hi){var Rn=hi.feature,bi=Re[xe[ji].source].getFeatureState(Rn.layer["source-layer"],Rn.id);Rn.source=Rn.layer.source,Rn.layer["source-layer"]&&(Rn.sourceLayer=Rn.layer["source-layer"]),Rn.state=bi})};for(var Jn in _t)Un(Jn);return _t}(this._layers,this._serializedLayers,this.sourceCaches,l,v,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(he)},f.prototype.querySourceFeatures=function(l,v){v&&v.filter&&this._validate(h.validateStyle.filter,"querySourceFeatures.filter",v.filter,null,v);var E=this.sourceCaches[l];return E?function(T,I){for(var k=T.getRenderableIds().map(function(Ne){return T.getTileByID(Ne)}),W=[],q={},he=0;he<k.length;he++){var ve=k[he],xe=ve.tileID.canonical.key;q[xe]||(q[xe]=!0,ve.querySourceFeatures(W,I))}return W}(E,v):[]},f.prototype.addSourceType=function(l,v,E){return f.getSourceType(l)?E(new Error('A source type called "'+l+'" already exists.')):(f.setSourceType(l,v),v.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:v.workerSourceURL},E):E(null,null))},f.prototype.getLight=function(){return this.light.getLight()},f.prototype.setLight=function(l,v){v===void 0&&(v={}),this._checkLoaded();var E=this.light.getLight(),T=!1;for(var I in l)if(!h.deepEqual(l[I],E[I])){T=!0;break}if(T){var k={now:h.browser.now(),transition:h.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,v),this.light.updateTransitions(k)}},f.prototype._validate=function(l,v,E,T,I){return I===void 0&&(I={}),(!I||I.validate!==!1)&&Ms(this,l.call(h.validateStyle,h.extend({key:v,style:this.serialize(),value:E,styleSpec:h.styleSpec},T)))},f.prototype._remove=function(){for(var l in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),h.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[l].setEventedParent(null);for(var v in this.sourceCaches)this.sourceCaches[v].clearTiles(),this.sourceCaches[v].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},f.prototype._clearSource=function(l){this.sourceCaches[l].clearTiles()},f.prototype._reloadSource=function(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()},f.prototype._updateSources=function(l){for(var v in this.sourceCaches)this.sourceCaches[v].update(l)},f.prototype._generateCollisionBoxes=function(){for(var l in this.sourceCaches)this._reloadSource(l)},f.prototype._updatePlacement=function(l,v,E,T,I){I===void 0&&(I=!1);for(var k=!1,W=!1,q={},he=0,ve=this._order;he<ve.length;he+=1){var xe=this._layers[ve[he]];if(xe.type==="symbol"){if(!q[xe.source]){var Ne=this.sourceCaches[xe.source];q[xe.source]=Ne.getRenderableIds(!0).map(function(xt){return Ne.getTileByID(xt)}).sort(function(xt,_t){return _t.tileID.overscaledZ-xt.tileID.overscaledZ||(xt.tileID.isLessThan(_t.tileID)?-1:1)})}var Re=this.crossTileSymbolIndex.addLayer(xe,q[xe.source],l.center.lng);k=k||Re}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((I=I||this._layerOrderChanged||E===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(h.browser.now(),l.zoom))&&(this.pauseablePlacement=new oo(l,this._order,I,v,E,T,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,q),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(h.browser.now()),W=!0),k&&this.pauseablePlacement.placement.setStale()),W||k)for(var Ye=0,ze=this._order;Ye<ze.length;Ye+=1){var Ge=this._layers[ze[Ye]];Ge.type==="symbol"&&this.placement.updateLayerOpacities(Ge,q[Ge.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(h.browser.now())},f.prototype._releaseSymbolFadeTiles=function(){for(var l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()},f.prototype.getImages=function(l,v,E){this.imageManager.getImages(v.icons,E),this._updateTilesForChangedImages();var T=this.sourceCaches[v.source];T&&T.setDependencies(v.tileID.key,v.type,v.icons)},f.prototype.getGlyphs=function(l,v,E){this.glyphManager.getGlyphs(v.stacks,E)},f.prototype.getResource=function(l,v,E){return h.makeRequest(v,E)},f}(h.Evented);Ca.getSourceType=function(p){return ur[p]},Ca.setSourceType=function(p,f){ur[p]=f},Ca.registerForPluginStateChange=h.registerForPluginStateChange;var Va=h.createLayout([{name:"a_pos",type:"Int16",components:2}]),lu=ea(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Tu=ea(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),rh=ea(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Al=ea(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),wl=ea("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),cu=ea(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),fu=ea(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),_=ea("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),O=ea("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),V=ea("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),L=ea(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),ne=ea(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Te=ea(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Je=ea(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),pt=ea(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Tt=ea(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),wr=ea(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Fr=ea(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Wn=ea(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ci=ea(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),di=ea(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),aa=ea(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),sa=ea(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),pa=ea(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),ou=ea(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),ys=ea(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function ea(p,f){var l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,v=f.match(/attribute ([\w]+) ([\w]+)/g),E=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),I=T?T.concat(E):E,k={};return{fragmentSource:p=p.replace(l,function(W,q,he,ve,xe){return k[xe]=!0,q==="define"?`
#ifndef HAS_UNIFORM_u_`+xe+`
varying `+he+" "+ve+" "+xe+`;
#else
uniform `+he+" "+ve+" u_"+xe+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+xe+`
    `+he+" "+ve+" "+xe+" = u_"+xe+`;
#endif
`}),vertexSource:f=f.replace(l,function(W,q,he,ve,xe){var Ne=ve==="float"?"vec2":"vec4",Re=xe.match(/color/)?"color":Ne;return k[xe]?q==="define"?`
#ifndef HAS_UNIFORM_u_`+xe+`
uniform lowp float u_`+xe+`_t;
attribute `+he+" "+Ne+" a_"+xe+`;
varying `+he+" "+ve+" "+xe+`;
#else
uniform `+he+" "+ve+" u_"+xe+`;
#endif
`:Re==="vec4"?`
#ifndef HAS_UNIFORM_u_`+xe+`
    `+xe+" = a_"+xe+`;
#else
    `+he+" "+ve+" "+xe+" = u_"+xe+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+xe+`
    `+xe+" = unpack_mix_"+Re+"(a_"+xe+", u_"+xe+`_t);
#else
    `+he+" "+ve+" "+xe+" = u_"+xe+`;
#endif
`:q==="define"?`
#ifndef HAS_UNIFORM_u_`+xe+`
uniform lowp float u_`+xe+`_t;
attribute `+he+" "+Ne+" a_"+xe+`;
#else
uniform `+he+" "+ve+" u_"+xe+`;
#endif
`:Re==="vec4"?`
#ifndef HAS_UNIFORM_u_`+xe+`
    `+he+" "+ve+" "+xe+" = a_"+xe+`;
#else
    `+he+" "+ve+" "+xe+" = u_"+xe+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+xe+`
    `+he+" "+ve+" "+xe+" = unpack_mix_"+Re+"(a_"+xe+", u_"+xe+`_t);
#else
    `+he+" "+ve+" "+xe+" = u_"+xe+`;
#endif
`}),staticAttributes:v,staticUniforms:I}}var _s=Object.freeze({__proto__:null,prelude:lu,background:Tu,backgroundPattern:rh,circle:Al,clippingMask:wl,heatmap:cu,heatmapTexture:fu,collisionBox:_,collisionCircle:O,debug:V,fill:L,fillOutline:ne,fillOutlinePattern:Te,fillPattern:Je,fillExtrusion:pt,fillExtrusionPattern:Tt,hillshadePrepare:wr,hillshade:Fr,line:Wn,lineGradient:Ci,linePattern:di,lineSDF:aa,raster:sa,symbolIcon:pa,symbolSDF:ou,symbolTextAndIcon:ys}),ic=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Tl(p){for(var f=[],l=0;l<p.length;l++)if(p[l]!==null){var v=p[l].split(" ");f.push(v.pop())}return f}ic.prototype.bind=function(p,f,l,v,E,T,I,k){this.context=p;for(var W=this.boundPaintVertexBuffers.length!==v.length,q=0;!W&&q<v.length;q++)this.boundPaintVertexBuffers[q]!==v[q]&&(W=!0);p.extVertexArrayObject&&this.vao&&this.boundProgram===f&&this.boundLayoutVertexBuffer===l&&!W&&this.boundIndexBuffer===E&&this.boundVertexOffset===T&&this.boundDynamicVertexBuffer===I&&this.boundDynamicVertexBuffer2===k?(p.bindVertexArrayOES.set(this.vao),I&&I.bind(),E&&E.dynamicDraw&&E.bind(),k&&k.bind()):this.freshBind(f,l,v,E,T,I,k)},ic.prototype.freshBind=function(p,f,l,v,E,T,I){var k,W=p.numAttributes,q=this.context,he=q.gl;if(q.extVertexArrayObject)this.vao&&this.destroy(),this.vao=q.extVertexArrayObject.createVertexArrayOES(),q.bindVertexArrayOES.set(this.vao),k=0,this.boundProgram=p,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=v,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=T,this.boundDynamicVertexBuffer2=I;else{k=q.currentNumAttributes||0;for(var ve=W;ve<k;ve++)he.disableVertexAttribArray(ve)}f.enableAttributes(he,p);for(var xe=0,Ne=l;xe<Ne.length;xe+=1)Ne[xe].enableAttributes(he,p);T&&T.enableAttributes(he,p),I&&I.enableAttributes(he,p),f.bind(),f.setVertexAttribPointers(he,p,E);for(var Re=0,Ye=l;Re<Ye.length;Re+=1){var ze=Ye[Re];ze.bind(),ze.setVertexAttribPointers(he,p,E)}T&&(T.bind(),T.setVertexAttribPointers(he,p,E)),v&&v.bind(),I&&(I.bind(),I.setVertexAttribPointers(he,p,E)),q.currentNumAttributes=W},ic.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var jl=function(f,l,v,E,T,I){var k=f.gl;this.program=k.createProgram();for(var W=Tl(v.staticAttributes),q=E?E.getBinderAttributes():[],he=W.concat(q),ve=v.staticUniforms?Tl(v.staticUniforms):[],xe=E?E.getBinderUniforms():[],Ne=[],Re=0,Ye=ve.concat(xe);Re<Ye.length;Re+=1){var ze=Ye[Re];Ne.indexOf(ze)<0&&Ne.push(ze)}var Ge=E?E.defines():[];I&&Ge.push("#define OVERDRAW_INSPECTOR;");var xt=Ge.concat(lu.fragmentSource,v.fragmentSource).join(`
`),_t=Ge.concat(lu.vertexSource,v.vertexSource).join(`
`),fr=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(fr,xt),k.compileShader(fr),k.attachShader(this.program,fr);var Vt=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(Vt,_t),k.compileShader(Vt),k.attachShader(this.program,Vt),this.attributes={};var lr={};this.numAttributes=he.length;for(var vr=0;vr<this.numAttributes;vr++)he[vr]&&(k.bindAttribLocation(this.program,vr,he[vr]),this.attributes[he[vr]]=vr);k.linkProgram(this.program),k.deleteShader(Vt),k.deleteShader(fr);for(var xr=0;xr<Ne.length;xr++){var Hr=Ne[xr];if(Hr&&!lr[Hr]){var cn=k.getUniformLocation(this.program,Hr);cn&&(lr[Hr]=cn)}}this.fixedUniforms=T(f,lr),this.binderUniforms=E?E.getUniforms(f,lr):[]}}};function Dc(p,f,l){var v=1/Nr(l,1,f.transform.tileZoom),E=Math.pow(2,l.tileID.overscaledZ),T=l.tileSize*Math.pow(2,f.transform.tileZoom)/E,I=T*(l.tileID.canonical.x+l.tileID.wrap*E),k=T*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[v,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[I>>16,k>>16],u_pixel_coord_lower:[65535&I,65535&k]}}jl.prototype.draw=function(p,f,l,v,E,T,I,k,W,q,he,ve,xe,Ne,Re,Ye){var ze,Ge=p.gl;if(!this.failedToCreate){for(var xt in p.program.set(this.program),p.setDepthMode(l),p.setStencilMode(v),p.setColorMode(E),p.setCullFace(T),this.fixedUniforms)this.fixedUniforms[xt].set(I[xt]);Ne&&Ne.setUniforms(p,this.binderUniforms,ve,{zoom:xe});for(var _t=(ze={},ze[Ge.LINES]=2,ze[Ge.TRIANGLES]=3,ze[Ge.LINE_STRIP]=1,ze)[f],fr=0,Vt=he.get();fr<Vt.length;fr+=1){var lr=Vt[fr],vr=lr.vaos||(lr.vaos={});(vr[k]||(vr[k]=new ic)).bind(p,this,W,Ne?Ne.getPaintVertexBuffers():[],q,lr.vertexOffset,Re,Ye),Ge.drawElements(f,lr.primitiveLength*_t,Ge.UNSIGNED_SHORT,lr.primitiveOffset*_t*2)}}};var _f=function(f,l,v,E){var T=l.style.light,I=T.properties.get("position"),k=[I.x,I.y,I.z],W=h.create$1();T.properties.get("anchor")==="viewport"&&h.fromRotation(W,-l.transform.angle),h.transformMat3(k,k,W);var q=T.properties.get("color");return{u_matrix:f,u_lightpos:k,u_lightintensity:T.properties.get("intensity"),u_lightcolor:[q.r,q.g,q.b],u_vertical_gradient:+v,u_opacity:E}},hu=function(f,l,v,E,T,I,k){return h.extend(_f(f,l,v,E),Dc(I,l,k),{u_height_factor:-Math.pow(2,T.overscaledZ)/k.tileSize/8})},Ji=function(f){return{u_matrix:f}},Mu=function(f,l,v,E){return h.extend(Ji(f),Dc(v,l,E))},xf=function(f,l){return{u_matrix:f,u_world:l}},po=function(f,l,v,E,T){return h.extend(Mu(f,l,v,E),{u_world:T})},Fc=function(f,l,v,E){var T,I,k=f.transform;if(E.paint.get("circle-pitch-alignment")==="map"){var W=Nr(v,1,k.zoom);T=!0,I=[W,W]}else T=!1,I=k.pixelsToGLUnits;return{u_camera_to_center_distance:k.cameraToCenterDistance,u_scale_with_map:+(E.paint.get("circle-pitch-scale")==="map"),u_matrix:f.translatePosMatrix(l.posMatrix,v,E.paint.get("circle-translate"),E.paint.get("circle-translate-anchor")),u_pitch_with_map:+T,u_device_pixel_ratio:h.browser.devicePixelRatio,u_extrude_scale:I}},Pu=function(f,l,v){var E=Nr(v,1,l.zoom),T=Math.pow(2,l.zoom-v.tileID.overscaledZ),I=v.tileID.overscaleFactor();return{u_matrix:f,u_camera_to_center_distance:l.cameraToCenterDistance,u_pixels_to_tile_units:E,u_extrude_scale:[l.pixelsToGLUnits[0]/(E*T),l.pixelsToGLUnits[1]/(E*T)],u_overscale_factor:I}},Ml=function(f,l,v){return{u_matrix:f,u_inv_matrix:l,u_camera_to_center_distance:v.cameraToCenterDistance,u_viewport_size:[v.width,v.height]}},al=function(f,l,v){return v===void 0&&(v=1),{u_matrix:f,u_color:l,u_overlay:0,u_overlay_scale:v}},Wu=function(f){return{u_matrix:f}},Vl=function(f,l,v,E){return{u_matrix:f,u_extrude_scale:Nr(l,1,v),u_intensity:E}},ol=function(f,l,v){var E=f.transform;return{u_matrix:Fh(f,l,v),u_ratio:1/Nr(l,1,E.zoom),u_device_pixel_ratio:h.browser.devicePixelRatio,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},Ra=function(f,l,v,E){return h.extend(ol(f,l,v),{u_image:0,u_image_height:E})},ac=function(f,l,v,E){var T=f.transform,I=oc(l,T);return{u_matrix:Fh(f,l,v),u_texsize:l.imageAtlasTexture.size,u_ratio:1/Nr(l,1,T.zoom),u_device_pixel_ratio:h.browser.devicePixelRatio,u_image:0,u_scale:[I,E.fromScale,E.toScale],u_fade:E.t,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]]}},Dh=function(f,l,v,E,T){var I=f.lineAtlas,k=oc(l,f.transform),W=v.layout.get("line-cap")==="round",q=I.getDash(E.from,W),he=I.getDash(E.to,W),ve=q.width*T.fromScale,xe=he.width*T.toScale;return h.extend(ol(f,l,v),{u_patternscale_a:[k/ve,-q.height/2],u_patternscale_b:[k/xe,-he.height/2],u_sdfgamma:I.width/(256*Math.min(ve,xe)*h.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:q.y,u_tex_y_b:he.y,u_mix:T.t})};function oc(p,f){return 1/Nr(p,1,f.tileZoom)}function Fh(p,f,l){return p.translatePosMatrix(f.tileID.posMatrix,f,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}var mp=function(f,l,v,E,T){return{u_matrix:f,u_tl_parent:l,u_scale_parent:v,u_buffer_scale:1,u_fade_t:E.mix,u_opacity:E.opacity*T.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:T.paint.get("raster-brightness-min"),u_brightness_high:T.paint.get("raster-brightness-max"),u_saturation_factor:(k=T.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(I=T.paint.get("raster-contrast"),I>0?1/(1-I):1+I),u_spin_weights:Bh(T.paint.get("raster-hue-rotate"))};var I,k};function Bh(p){p*=Math.PI/180;var f=Math.sin(p),l=Math.cos(p);return[(2*l+1)/3,(-Math.sqrt(3)*f-l+1)/3,(Math.sqrt(3)*f-l+1)/3]}var sc,sl=function(f,l,v,E,T,I,k,W,q,he){var ve=T.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:ve.cameraToCenterDistance,u_pitch:ve.pitch/360*2*Math.PI,u_rotate_symbol:+v,u_aspect_ratio:ve.width/ve.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_matrix:I,u_label_plane_matrix:k,u_coord_matrix:W,u_is_text:+q,u_pitch_with_map:+E,u_texsize:he,u_texture:0}},ul=function(f,l,v,E,T,I,k,W,q,he,ve){var xe=T.transform;return h.extend(sl(f,l,v,E,T,I,k,W,q,he),{u_gamma_scale:E?Math.cos(xe._pitch)*xe.cameraToCenterDistance:1,u_device_pixel_ratio:h.browser.devicePixelRatio,u_is_halo:+ve})},Gl=function(f,l,v,E,T,I,k,W,q,he){return h.extend(ul(f,l,v,E,T,I,k,W,!0,q,!0),{u_texsize_icon:he,u_texture_icon:1})},Zu=function(f,l,v){return{u_matrix:f,u_opacity:l,u_color:v}},Hl=function(f,l,v,E,T,I){return h.extend(function(k,W,q,he){var ve=q.imageManager.getPattern(k.from.toString()),xe=q.imageManager.getPattern(k.to.toString()),Ne=q.imageManager.getPixelSize(),Re=Ne.width,Ye=Ne.height,ze=Math.pow(2,he.tileID.overscaledZ),Ge=he.tileSize*Math.pow(2,q.transform.tileZoom)/ze,xt=Ge*(he.tileID.canonical.x+he.tileID.wrap*ze),_t=Ge*he.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:ve.tl,u_pattern_br_a:ve.br,u_pattern_tl_b:xe.tl,u_pattern_br_b:xe.br,u_texsize:[Re,Ye],u_mix:W.t,u_pattern_size_a:ve.displaySize,u_pattern_size_b:xe.displaySize,u_scale_a:W.fromScale,u_scale_b:W.toScale,u_tile_units_to_pixels:1/Nr(he,1,q.transform.tileZoom),u_pixel_coord_upper:[xt>>16,_t>>16],u_pixel_coord_lower:[65535&xt,65535&_t]}}(E,I,v,T),{u_matrix:f,u_opacity:l})},bf={fillExtrusion:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_lightpos:new h.Uniform3f(f,l.u_lightpos),u_lightintensity:new h.Uniform1f(f,l.u_lightintensity),u_lightcolor:new h.Uniform3f(f,l.u_lightcolor),u_vertical_gradient:new h.Uniform1f(f,l.u_vertical_gradient),u_opacity:new h.Uniform1f(f,l.u_opacity)}},fillExtrusionPattern:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_lightpos:new h.Uniform3f(f,l.u_lightpos),u_lightintensity:new h.Uniform1f(f,l.u_lightintensity),u_lightcolor:new h.Uniform3f(f,l.u_lightcolor),u_vertical_gradient:new h.Uniform1f(f,l.u_vertical_gradient),u_height_factor:new h.Uniform1f(f,l.u_height_factor),u_image:new h.Uniform1i(f,l.u_image),u_texsize:new h.Uniform2f(f,l.u_texsize),u_pixel_coord_upper:new h.Uniform2f(f,l.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(f,l.u_pixel_coord_lower),u_scale:new h.Uniform3f(f,l.u_scale),u_fade:new h.Uniform1f(f,l.u_fade),u_opacity:new h.Uniform1f(f,l.u_opacity)}},fill:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix)}},fillPattern:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_image:new h.Uniform1i(f,l.u_image),u_texsize:new h.Uniform2f(f,l.u_texsize),u_pixel_coord_upper:new h.Uniform2f(f,l.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(f,l.u_pixel_coord_lower),u_scale:new h.Uniform3f(f,l.u_scale),u_fade:new h.Uniform1f(f,l.u_fade)}},fillOutline:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_world:new h.Uniform2f(f,l.u_world)}},fillOutlinePattern:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_world:new h.Uniform2f(f,l.u_world),u_image:new h.Uniform1i(f,l.u_image),u_texsize:new h.Uniform2f(f,l.u_texsize),u_pixel_coord_upper:new h.Uniform2f(f,l.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(f,l.u_pixel_coord_lower),u_scale:new h.Uniform3f(f,l.u_scale),u_fade:new h.Uniform1f(f,l.u_fade)}},circle:function(f,l){return{u_camera_to_center_distance:new h.Uniform1f(f,l.u_camera_to_center_distance),u_scale_with_map:new h.Uniform1i(f,l.u_scale_with_map),u_pitch_with_map:new h.Uniform1i(f,l.u_pitch_with_map),u_extrude_scale:new h.Uniform2f(f,l.u_extrude_scale),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_matrix:new h.UniformMatrix4f(f,l.u_matrix)}},collisionBox:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_camera_to_center_distance:new h.Uniform1f(f,l.u_camera_to_center_distance),u_pixels_to_tile_units:new h.Uniform1f(f,l.u_pixels_to_tile_units),u_extrude_scale:new h.Uniform2f(f,l.u_extrude_scale),u_overscale_factor:new h.Uniform1f(f,l.u_overscale_factor)}},collisionCircle:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_inv_matrix:new h.UniformMatrix4f(f,l.u_inv_matrix),u_camera_to_center_distance:new h.Uniform1f(f,l.u_camera_to_center_distance),u_viewport_size:new h.Uniform2f(f,l.u_viewport_size)}},debug:function(f,l){return{u_color:new h.UniformColor(f,l.u_color),u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_overlay:new h.Uniform1i(f,l.u_overlay),u_overlay_scale:new h.Uniform1f(f,l.u_overlay_scale)}},clippingMask:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix)}},heatmap:function(f,l){return{u_extrude_scale:new h.Uniform1f(f,l.u_extrude_scale),u_intensity:new h.Uniform1f(f,l.u_intensity),u_matrix:new h.UniformMatrix4f(f,l.u_matrix)}},heatmapTexture:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_world:new h.Uniform2f(f,l.u_world),u_image:new h.Uniform1i(f,l.u_image),u_color_ramp:new h.Uniform1i(f,l.u_color_ramp),u_opacity:new h.Uniform1f(f,l.u_opacity)}},hillshade:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_image:new h.Uniform1i(f,l.u_image),u_latrange:new h.Uniform2f(f,l.u_latrange),u_light:new h.Uniform2f(f,l.u_light),u_shadow:new h.UniformColor(f,l.u_shadow),u_highlight:new h.UniformColor(f,l.u_highlight),u_accent:new h.UniformColor(f,l.u_accent)}},hillshadePrepare:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_image:new h.Uniform1i(f,l.u_image),u_dimension:new h.Uniform2f(f,l.u_dimension),u_zoom:new h.Uniform1f(f,l.u_zoom),u_unpack:new h.Uniform4f(f,l.u_unpack)}},line:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_ratio:new h.Uniform1f(f,l.u_ratio),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(f,l.u_units_to_pixels)}},lineGradient:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_ratio:new h.Uniform1f(f,l.u_ratio),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(f,l.u_units_to_pixels),u_image:new h.Uniform1i(f,l.u_image),u_image_height:new h.Uniform1f(f,l.u_image_height)}},linePattern:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_texsize:new h.Uniform2f(f,l.u_texsize),u_ratio:new h.Uniform1f(f,l.u_ratio),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_image:new h.Uniform1i(f,l.u_image),u_units_to_pixels:new h.Uniform2f(f,l.u_units_to_pixels),u_scale:new h.Uniform3f(f,l.u_scale),u_fade:new h.Uniform1f(f,l.u_fade)}},lineSDF:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_ratio:new h.Uniform1f(f,l.u_ratio),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(f,l.u_units_to_pixels),u_patternscale_a:new h.Uniform2f(f,l.u_patternscale_a),u_patternscale_b:new h.Uniform2f(f,l.u_patternscale_b),u_sdfgamma:new h.Uniform1f(f,l.u_sdfgamma),u_image:new h.Uniform1i(f,l.u_image),u_tex_y_a:new h.Uniform1f(f,l.u_tex_y_a),u_tex_y_b:new h.Uniform1f(f,l.u_tex_y_b),u_mix:new h.Uniform1f(f,l.u_mix)}},raster:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_tl_parent:new h.Uniform2f(f,l.u_tl_parent),u_scale_parent:new h.Uniform1f(f,l.u_scale_parent),u_buffer_scale:new h.Uniform1f(f,l.u_buffer_scale),u_fade_t:new h.Uniform1f(f,l.u_fade_t),u_opacity:new h.Uniform1f(f,l.u_opacity),u_image0:new h.Uniform1i(f,l.u_image0),u_image1:new h.Uniform1i(f,l.u_image1),u_brightness_low:new h.Uniform1f(f,l.u_brightness_low),u_brightness_high:new h.Uniform1f(f,l.u_brightness_high),u_saturation_factor:new h.Uniform1f(f,l.u_saturation_factor),u_contrast_factor:new h.Uniform1f(f,l.u_contrast_factor),u_spin_weights:new h.Uniform3f(f,l.u_spin_weights)}},symbolIcon:function(f,l){return{u_is_size_zoom_constant:new h.Uniform1i(f,l.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(f,l.u_is_size_feature_constant),u_size_t:new h.Uniform1f(f,l.u_size_t),u_size:new h.Uniform1f(f,l.u_size),u_camera_to_center_distance:new h.Uniform1f(f,l.u_camera_to_center_distance),u_pitch:new h.Uniform1f(f,l.u_pitch),u_rotate_symbol:new h.Uniform1i(f,l.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(f,l.u_aspect_ratio),u_fade_change:new h.Uniform1f(f,l.u_fade_change),u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(f,l.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(f,l.u_coord_matrix),u_is_text:new h.Uniform1i(f,l.u_is_text),u_pitch_with_map:new h.Uniform1i(f,l.u_pitch_with_map),u_texsize:new h.Uniform2f(f,l.u_texsize),u_texture:new h.Uniform1i(f,l.u_texture)}},symbolSDF:function(f,l){return{u_is_size_zoom_constant:new h.Uniform1i(f,l.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(f,l.u_is_size_feature_constant),u_size_t:new h.Uniform1f(f,l.u_size_t),u_size:new h.Uniform1f(f,l.u_size),u_camera_to_center_distance:new h.Uniform1f(f,l.u_camera_to_center_distance),u_pitch:new h.Uniform1f(f,l.u_pitch),u_rotate_symbol:new h.Uniform1i(f,l.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(f,l.u_aspect_ratio),u_fade_change:new h.Uniform1f(f,l.u_fade_change),u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(f,l.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(f,l.u_coord_matrix),u_is_text:new h.Uniform1i(f,l.u_is_text),u_pitch_with_map:new h.Uniform1i(f,l.u_pitch_with_map),u_texsize:new h.Uniform2f(f,l.u_texsize),u_texture:new h.Uniform1i(f,l.u_texture),u_gamma_scale:new h.Uniform1f(f,l.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(f,l.u_is_halo)}},symbolTextAndIcon:function(f,l){return{u_is_size_zoom_constant:new h.Uniform1i(f,l.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(f,l.u_is_size_feature_constant),u_size_t:new h.Uniform1f(f,l.u_size_t),u_size:new h.Uniform1f(f,l.u_size),u_camera_to_center_distance:new h.Uniform1f(f,l.u_camera_to_center_distance),u_pitch:new h.Uniform1f(f,l.u_pitch),u_rotate_symbol:new h.Uniform1i(f,l.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(f,l.u_aspect_ratio),u_fade_change:new h.Uniform1f(f,l.u_fade_change),u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(f,l.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(f,l.u_coord_matrix),u_is_text:new h.Uniform1i(f,l.u_is_text),u_pitch_with_map:new h.Uniform1i(f,l.u_pitch_with_map),u_texsize:new h.Uniform2f(f,l.u_texsize),u_texsize_icon:new h.Uniform2f(f,l.u_texsize_icon),u_texture:new h.Uniform1i(f,l.u_texture),u_texture_icon:new h.Uniform1i(f,l.u_texture_icon),u_gamma_scale:new h.Uniform1f(f,l.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(f,l.u_is_halo)}},background:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_opacity:new h.Uniform1f(f,l.u_opacity),u_color:new h.UniformColor(f,l.u_color)}},backgroundPattern:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_opacity:new h.Uniform1f(f,l.u_opacity),u_image:new h.Uniform1i(f,l.u_image),u_pattern_tl_a:new h.Uniform2f(f,l.u_pattern_tl_a),u_pattern_br_a:new h.Uniform2f(f,l.u_pattern_br_a),u_pattern_tl_b:new h.Uniform2f(f,l.u_pattern_tl_b),u_pattern_br_b:new h.Uniform2f(f,l.u_pattern_br_b),u_texsize:new h.Uniform2f(f,l.u_texsize),u_mix:new h.Uniform1f(f,l.u_mix),u_pattern_size_a:new h.Uniform2f(f,l.u_pattern_size_a),u_pattern_size_b:new h.Uniform2f(f,l.u_pattern_size_b),u_scale_a:new h.Uniform1f(f,l.u_scale_a),u_scale_b:new h.Uniform1f(f,l.u_scale_b),u_pixel_coord_upper:new h.Uniform2f(f,l.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(f,l.u_pixel_coord_lower),u_tile_units_to_pixels:new h.Uniform1f(f,l.u_tile_units_to_pixels)}}};function Wl(p,f,l,v,E,T,I){for(var k=p.context,W=k.gl,q=p.useProgram("collisionBox"),he=[],ve=0,xe=0,Ne=0;Ne<v.length;Ne++){var Re=v[Ne],Ye=f.getTile(Re),ze=Ye.getBucket(l);if(ze){var Ge=Re.posMatrix;E[0]===0&&E[1]===0||(Ge=p.translatePosMatrix(Re.posMatrix,Ye,E,T));var xt=I?ze.textCollisionBox:ze.iconCollisionBox,_t=ze.collisionCircleArray;if(_t.length>0){var fr=h.create(),Vt=Ge;h.mul(fr,ze.placementInvProjMatrix,p.transform.glCoordMatrix),h.mul(fr,fr,ze.placementViewportMatrix),he.push({circleArray:_t,circleOffset:xe,transform:Vt,invTransform:fr}),xe=ve+=_t.length/4}xt&&q.draw(k,W.LINES,Se.disabled,De.disabled,p.colorModeForRenderPass(),vt.disabled,Pu(Ge,p.transform,Ye),l.id,xt.layoutVertexBuffer,xt.indexBuffer,xt.segments,null,p.transform.zoom,null,null,xt.collisionVertexBuffer)}}if(I&&he.length){var lr=p.useProgram("collisionCircle"),vr=new h.StructArrayLayout2f1f2i16;vr.resize(4*ve),vr._trim();for(var xr=0,Hr=0,cn=he;Hr<cn.length;Hr+=1)for(var Un=cn[Hr],Jn=0;Jn<Un.circleArray.length/4;Jn++){var oi=4*Jn,ji=Un.circleArray[oi+0],hi=Un.circleArray[oi+1],Rn=Un.circleArray[oi+2],bi=Un.circleArray[oi+3];vr.emplace(xr++,ji,hi,Rn,bi,0),vr.emplace(xr++,ji,hi,Rn,bi,1),vr.emplace(xr++,ji,hi,Rn,bi,2),vr.emplace(xr++,ji,hi,Rn,bi,3)}(!sc||sc.length<2*ve)&&(sc=function(mo){var uo=2*mo,Ro=new h.StructArrayLayout3ui6;Ro.resize(uo),Ro._trim();for(var Za=0;Za<uo;Za++){var no=6*Za;Ro.uint16[no+0]=4*Za+0,Ro.uint16[no+1]=4*Za+1,Ro.uint16[no+2]=4*Za+2,Ro.uint16[no+3]=4*Za+2,Ro.uint16[no+4]=4*Za+3,Ro.uint16[no+5]=4*Za+0}return Ro}(ve));for(var Oi=k.createIndexBuffer(sc,!0),Qn=k.createVertexBuffer(vr,h.collisionCircleLayout.members,!0),Ri=0,si=he;Ri<si.length;Ri+=1){var Di=si[Ri],$i=Ml(Di.transform,Di.invTransform,p.transform);lr.draw(k,W.TRIANGLES,Se.disabled,De.disabled,p.colorModeForRenderPass(),vt.disabled,$i,l.id,Qn,Oi,h.SegmentVector.simpleSegment(0,2*Di.circleOffset,Di.circleArray.length,Di.circleArray.length/2),null,p.transform.zoom,null,null,null)}Qn.destroy(),Oi.destroy()}}var so=h.identity(new Float32Array(16));function nh(p,f,l,v,E,T){var I=h.getAnchorAlignment(p),k=-(I.horizontalAlign-.5)*f,W=-(I.verticalAlign-.5)*l,q=h.evaluateVariableOffset(p,v);return new h.Point((k/E+q[0])*T,(W/E+q[1])*T)}function ih(p,f,l,v,E,T,I,k,W,q,he){var ve=p.text.placedSymbolArray,xe=p.text.dynamicLayoutVertexArray,Ne=p.icon.dynamicLayoutVertexArray,Re={};xe.clear();for(var Ye=0;Ye<ve.length;Ye++){var ze=ve.get(Ye),Ge=ze.hidden||!ze.crossTileID||p.allowVerticalPlacement&&!ze.placedOrientation?null:v[ze.crossTileID];if(Ge){var xt=new h.Point(ze.anchorX,ze.anchorY),_t=Ai(xt,l?k:I),fr=xi(T.cameraToCenterDistance,_t.signedDistanceFromCamera),Vt=E.evaluateSizeForFeature(p.textSizeData,q,ze)*fr/h.ONE_EM;l&&(Vt*=p.tilePixelRatio/W);for(var lr=nh(Ge.anchor,Ge.width,Ge.height,Ge.textOffset,Ge.textBoxScale,Vt),vr=l?Ai(xt.add(lr),I).point:_t.point.add(f?lr.rotate(-T.angle):lr),xr=p.allowVerticalPlacement&&ze.placedOrientation===h.WritingMode.vertical?Math.PI/2:0,Hr=0;Hr<ze.numGlyphs;Hr++)h.addDynamicAttributes(xe,vr,xr);he&&ze.associatedIconIndex>=0&&(Re[ze.associatedIconIndex]={shiftedAnchor:vr,angle:xr})}else Pa(ze.numGlyphs,xe)}if(he){Ne.clear();for(var cn=p.icon.placedSymbolArray,Un=0;Un<cn.length;Un++){var Jn=cn.get(Un);if(Jn.hidden)Pa(Jn.numGlyphs,Ne);else{var oi=Re[Un];if(oi)for(var ji=0;ji<Jn.numGlyphs;ji++)h.addDynamicAttributes(Ne,oi.shiftedAnchor,oi.angle);else Pa(Jn.numGlyphs,Ne)}}p.icon.dynamicLayoutVertexBuffer.updateData(Ne)}p.text.dynamicLayoutVertexBuffer.updateData(xe)}function ah(p,f,l){return l.iconsInText&&f?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function Xu(p,f,l,v,E,T,I,k,W,q,he,ve){for(var xe=p.context,Ne=xe.gl,Re=p.transform,Ye=k==="map",ze=W==="map",Ge=Ye&&l.layout.get("symbol-placement")!=="point",xt=Ye&&!ze&&!Ge,_t=l.layout.get("symbol-sort-key").constantOr(1)!==void 0,fr=!1,Vt=p.depthModeForSublayer(0,Se.ReadOnly),lr=l.layout.get("text-variable-anchor"),vr=[],xr=0,Hr=v;xr<Hr.length;xr+=1){var cn=Hr[xr],Un=f.getTile(cn),Jn=Un.getBucket(l);if(Jn){var oi=E?Jn.text:Jn.icon;if(oi&&oi.segments.get().length){var ji=oi.programConfigurations.get(l.id),hi=E||Jn.sdfIcons,Rn=E?Jn.textSizeData:Jn.iconSizeData,bi=ze||Re.pitch!==0,Oi=p.useProgram(ah(hi,E,Jn),ji),Qn=h.evaluateSizeForZoom(Rn,Re.zoom),Ri=void 0,si=[0,0],Di=void 0,$i=void 0,mo=null,uo=void 0;if(E)Di=Un.glyphAtlasTexture,$i=Ne.LINEAR,Ri=Un.glyphAtlasTexture.size,Jn.iconsInText&&(si=Un.imageAtlasTexture.size,mo=Un.imageAtlasTexture,uo=bi||p.options.rotating||p.options.zooming||Rn.kind==="composite"||Rn.kind==="camera"?Ne.LINEAR:Ne.NEAREST);else{var Ro=l.layout.get("icon-size").constantOr(0)!==1||Jn.iconsNeedLinear;Di=Un.imageAtlasTexture,$i=hi||p.options.rotating||p.options.zooming||Ro||bi?Ne.LINEAR:Ne.NEAREST,Ri=Un.imageAtlasTexture.size}var Za=Nr(Un,1,p.transform.zoom),no=Ka(cn.posMatrix,ze,Ye,p.transform,Za),Ks=ri(cn.posMatrix,ze,Ye,p.transform,Za),Ba=lr&&Jn.hasTextData(),vl=l.layout.get("icon-text-fit")!=="none"&&Ba&&Jn.hasIconData();Ge&&ao(Jn,cn.posMatrix,p,E,no,Ks,ze,q);var ks=p.translatePosMatrix(cn.posMatrix,Un,T,I),bs=Ge||E&&lr||vl?so:no,Es=p.translatePosMatrix(Ks,Un,T,I,!0),Co=hi&&l.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ls={program:Oi,buffers:oi,uniformValues:hi?Jn.iconsInText?Gl(Rn.kind,Qn,xt,ze,p,ks,bs,Es,Ri,si):ul(Rn.kind,Qn,xt,ze,p,ks,bs,Es,E,Ri,!0):sl(Rn.kind,Qn,xt,ze,p,ks,bs,Es,E,Ri),atlasTexture:Di,atlasTextureIcon:mo,atlasInterpolation:$i,atlasInterpolationIcon:uo,isSDF:hi,hasHalo:Co};if(_t&&Jn.canOverlap){fr=!0;for(var qu=0,Ll=oi.segments.get();qu<Ll.length;qu+=1){var ml=Ll[qu];vr.push({segments:new h.SegmentVector([ml]),sortKey:ml.sortKey,state:Ls})}}else vr.push({segments:oi.segments,sortKey:0,state:Ls})}}}fr&&vr.sort(function(Jc,Qu){return Jc.sortKey-Qu.sortKey});for(var xu=0,ql=vr;xu<ql.length;xu+=1){var bu=ql[xu],ko=bu.state;if(xe.activeTexture.set(Ne.TEXTURE0),ko.atlasTexture.bind(ko.atlasInterpolation,Ne.CLAMP_TO_EDGE),ko.atlasTextureIcon&&(xe.activeTexture.set(Ne.TEXTURE1),ko.atlasTextureIcon&&ko.atlasTextureIcon.bind(ko.atlasInterpolationIcon,Ne.CLAMP_TO_EDGE)),ko.isSDF){var Lu=ko.uniformValues;ko.hasHalo&&(Lu.u_is_halo=1,Pl(ko.buffers,bu.segments,l,p,ko.program,Vt,he,ve,Lu)),Lu.u_is_halo=0}Pl(ko.buffers,bu.segments,l,p,ko.program,Vt,he,ve,ko.uniformValues)}}function Pl(p,f,l,v,E,T,I,k,W){var q=v.context;E.draw(q,q.gl.TRIANGLES,T,I,k,vt.disabled,W,l.id,p.layoutVertexBuffer,p.indexBuffer,f,l.paint,v.transform.zoom,p.programConfigurations.get(l.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function Bc(p,f,l,v,E,T,I){var k,W,q,he,ve,xe=p.context.gl,Ne=l.paint.get("fill-pattern"),Re=Ne&&Ne.constantOr(1),Ye=l.getCrossfadeParameters();I?(W=Re&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",k=xe.LINES):(W=Re?"fillPattern":"fill",k=xe.TRIANGLES);for(var ze=0,Ge=v;ze<Ge.length;ze+=1){var xt=Ge[ze],_t=f.getTile(xt);if(!Re||_t.patternsLoaded()){var fr=_t.getBucket(l);if(fr){var Vt=fr.programConfigurations.get(l.id),lr=p.useProgram(W,Vt);Re&&(p.context.activeTexture.set(xe.TEXTURE0),_t.imageAtlasTexture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),Vt.updatePaintBuffers(Ye));var vr=Ne.constantOr(null);if(vr&&_t.imageAtlas){var xr=_t.imageAtlas,Hr=xr.patternPositions[vr.to.toString()],cn=xr.patternPositions[vr.from.toString()];Hr&&cn&&Vt.setConstantPatternPositions(Hr,cn)}var Un=p.translatePosMatrix(xt.posMatrix,_t,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));if(I){he=fr.indexBuffer2,ve=fr.segments2;var Jn=[xe.drawingBufferWidth,xe.drawingBufferHeight];q=W==="fillOutlinePattern"&&Re?po(Un,p,Ye,_t,Jn):xf(Un,Jn)}else he=fr.indexBuffer,ve=fr.segments,q=Re?Mu(Un,p,Ye,_t):Ji(Un);lr.draw(p.context,k,E,p.stencilModeForClipping(xt),T,vt.disabled,q,l.id,fr.layoutVertexBuffer,he,ve,l.paint,p.transform.zoom,Vt)}}}}function oh(p,f,l,v,E,T,I){for(var k=p.context,W=k.gl,q=l.paint.get("fill-extrusion-pattern"),he=q.constantOr(1),ve=l.getCrossfadeParameters(),xe=l.paint.get("fill-extrusion-opacity"),Ne=0,Re=v;Ne<Re.length;Ne+=1){var Ye=Re[Ne],ze=f.getTile(Ye),Ge=ze.getBucket(l);if(Ge){var xt=Ge.programConfigurations.get(l.id),_t=p.useProgram(he?"fillExtrusionPattern":"fillExtrusion",xt);he&&(p.context.activeTexture.set(W.TEXTURE0),ze.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),xt.updatePaintBuffers(ve));var fr=q.constantOr(null);if(fr&&ze.imageAtlas){var Vt=ze.imageAtlas,lr=Vt.patternPositions[fr.to.toString()],vr=Vt.patternPositions[fr.from.toString()];lr&&vr&&xt.setConstantPatternPositions(lr,vr)}var xr=p.translatePosMatrix(Ye.posMatrix,ze,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Hr=l.paint.get("fill-extrusion-vertical-gradient"),cn=he?hu(xr,p,Hr,xe,Ye,ve,ze):_f(xr,p,Hr,xe);_t.draw(k,k.gl.TRIANGLES,E,T,I,vt.backCCW,cn,l.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,l.paint,p.transform.zoom,xt)}}}function Ef(p,f,l,v,E,T){var I=p.context,k=I.gl,W=f.fbo;if(W){var q=p.useProgram("hillshade");I.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,W.colorAttachment.get());var he=function(ve,xe,Ne){var Re=Ne.paint.get("hillshade-shadow-color"),Ye=Ne.paint.get("hillshade-highlight-color"),ze=Ne.paint.get("hillshade-accent-color"),Ge=Ne.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ne.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ge-=ve.transform.angle);var xt,_t,fr,Vt=!ve.options.moving;return{u_matrix:ve.transform.calculatePosMatrix(xe.tileID.toUnwrapped(),Vt),u_image:0,u_latrange:(xt=xe.tileID,_t=Math.pow(2,xt.canonical.z),fr=xt.canonical.y,[new h.MercatorCoordinate(0,fr/_t).toLngLat().lat,new h.MercatorCoordinate(0,(fr+1)/_t).toLngLat().lat]),u_light:[Ne.paint.get("hillshade-exaggeration"),Ge],u_shadow:Re,u_highlight:Ye,u_accent:ze}}(p,f,l);q.draw(I,k.TRIANGLES,v,E,T,vt.disabled,he,l.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments)}}function Nc(p,f,l,v,E,T){var I=p.context,k=I.gl,W=f.dem;if(W&&W.data){var q=W.dim,he=W.stride,ve=W.getPixels();if(I.activeTexture.set(k.TEXTURE1),I.pixelStoreUnpackPremultiplyAlpha.set(!1),f.demTexture=f.demTexture||p.getTileTexture(he),f.demTexture){var xe=f.demTexture;xe.update(ve,{premultiply:!1}),xe.bind(k.NEAREST,k.CLAMP_TO_EDGE)}else f.demTexture=new h.Texture(I,ve,k.RGBA,{premultiply:!1}),f.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);I.activeTexture.set(k.TEXTURE0);var Ne=f.fbo;if(!Ne){var Re=new h.Texture(I,{width:q,height:q,data:null},k.RGBA);Re.bind(k.LINEAR,k.CLAMP_TO_EDGE),(Ne=f.fbo=I.createFramebuffer(q,q,!0)).colorAttachment.set(Re.texture)}I.bindFramebuffer.set(Ne.framebuffer),I.viewport.set([0,0,q,q]),p.useProgram("hillshadePrepare").draw(I,k.TRIANGLES,v,E,T,vt.disabled,function(Ye,ze){var Ge=ze.stride,xt=h.create();return h.ortho(xt,0,h.EXTENT,-h.EXTENT,0,0,1),h.translate(xt,xt,[0,-h.EXTENT,0]),{u_matrix:xt,u_image:1,u_dimension:[Ge,Ge],u_zoom:Ye.overscaledZ,u_unpack:ze.getUnpackVector()}}(f.tileID,W),l.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments),f.needsHillshadePrepare=!1}}function zc(p,f,l,v,E){var T=v.paint.get("raster-fade-duration");if(T>0){var I=h.browser.now(),k=(I-p.timeAdded)/T,W=f?(I-f.timeAdded)/T:-1,q=l.getSource(),he=E.coveringZoomLevel({tileSize:q.tileSize,roundZoom:q.roundZoom}),ve=!f||Math.abs(f.tileID.overscaledZ-he)>Math.abs(p.tileID.overscaledZ-he),xe=ve&&p.refreshedUponExpiration?1:h.clamp(ve?k:1-W,0,1);return p.refreshedUponExpiration&&k>=1&&(p.refreshedUponExpiration=!1),f?{opacity:1,mix:1-xe}:{opacity:xe,mix:0}}return{opacity:1,mix:0}}var Uc=new h.Color(1,0,0,1),uc=new h.Color(0,1,0,1),Nh=new h.Color(0,0,1,1),jc=new h.Color(1,0,1,1),sh=new h.Color(0,1,1,1);function Vc(p,f,l,v){Gc(p,0,f+l/2,p.transform.width,l,v)}function uh(p,f,l,v){Gc(p,f-l/2,0,l,p.transform.height,v)}function Gc(p,f,l,v,E,T){var I=p.context,k=I.gl;k.enable(k.SCISSOR_TEST),k.scissor(f*h.browser.devicePixelRatio,l*h.browser.devicePixelRatio,v*h.browser.devicePixelRatio,E*h.browser.devicePixelRatio),I.clear({color:T}),k.disable(k.SCISSOR_TEST)}function lc(p,f,l){var v=p.context,E=v.gl,T=l.posMatrix,I=p.useProgram("debug"),k=Se.disabled,W=De.disabled,q=p.colorModeForRenderPass();v.activeTexture.set(E.TEXTURE0),p.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),I.draw(v,E.LINE_STRIP,k,W,q,vt.disabled,al(T,h.Color.red),"$debug",p.debugBuffer,p.tileBorderIndexBuffer,p.debugSegments);var he=f.getTileByID(l.key).latestRawTileData,ve=Math.floor((he&&he.byteLength||0)/1024),xe=f.getTile(l).tileSize,Ne=512/Math.min(xe,512)*(l.overscaledZ/p.transform.zoom)*.5,Re=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(Re+=" => "+l.overscaledZ),function(Ye,ze){Ye.initDebugOverlayCanvas();var Ge=Ye.debugOverlayCanvas,xt=Ye.context.gl,_t=Ye.debugOverlayCanvas.getContext("2d");_t.clearRect(0,0,Ge.width,Ge.height),_t.shadowColor="white",_t.shadowBlur=2,_t.lineWidth=1.5,_t.strokeStyle="white",_t.textBaseline="top",_t.font="bold 36px Open Sans, sans-serif",_t.fillText(ze,5,5),_t.strokeText(ze,5,5),Ye.debugOverlayTexture.update(Ge),Ye.debugOverlayTexture.bind(xt.LINEAR,xt.CLAMP_TO_EDGE)}(p,Re+" "+ve+"kb"),I.draw(v,E.TRIANGLES,k,W,et.alphaBlended,vt.disabled,al(T,h.Color.transparent,Ne),"$debug",p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments)}var ll={symbol:function(f,l,v,E,T){if(f.renderPass==="translucent"){var I=De.disabled,k=f.colorModeForRenderPass();v.layout.get("text-variable-anchor")&&function(W,q,he,ve,xe,Ne,Re){for(var Ye=q.transform,ze=xe==="map",Ge=Ne==="map",xt=0,_t=W;xt<_t.length;xt+=1){var fr=_t[xt],Vt=ve.getTile(fr),lr=Vt.getBucket(he);if(lr&&lr.text&&lr.text.segments.get().length){var vr=h.evaluateSizeForZoom(lr.textSizeData,Ye.zoom),xr=Nr(Vt,1,q.transform.zoom),Hr=Ka(fr.posMatrix,Ge,ze,q.transform,xr),cn=he.layout.get("icon-text-fit")!=="none"&&lr.hasIconData();if(vr){var Un=Math.pow(2,Ye.zoom-Vt.tileID.overscaledZ);ih(lr,ze,Ge,Re,h.symbolSize,Ye,Hr,fr.posMatrix,Un,vr,cn)}}}}(E,f,v,l,v.layout.get("text-rotation-alignment"),v.layout.get("text-pitch-alignment"),T),v.paint.get("icon-opacity").constantOr(1)!==0&&Xu(f,l,v,E,!1,v.paint.get("icon-translate"),v.paint.get("icon-translate-anchor"),v.layout.get("icon-rotation-alignment"),v.layout.get("icon-pitch-alignment"),v.layout.get("icon-keep-upright"),I,k),v.paint.get("text-opacity").constantOr(1)!==0&&Xu(f,l,v,E,!0,v.paint.get("text-translate"),v.paint.get("text-translate-anchor"),v.layout.get("text-rotation-alignment"),v.layout.get("text-pitch-alignment"),v.layout.get("text-keep-upright"),I,k),l.map.showCollisionBoxes&&(Wl(f,l,v,E,v.paint.get("text-translate"),v.paint.get("text-translate-anchor"),!0),Wl(f,l,v,E,v.paint.get("icon-translate"),v.paint.get("icon-translate-anchor"),!1))}},circle:function(f,l,v,E){if(f.renderPass==="translucent"){var T=v.paint.get("circle-opacity"),I=v.paint.get("circle-stroke-width"),k=v.paint.get("circle-stroke-opacity"),W=v.layout.get("circle-sort-key").constantOr(1)!==void 0;if(T.constantOr(1)!==0||I.constantOr(1)!==0&&k.constantOr(1)!==0){for(var q=f.context,he=q.gl,ve=f.depthModeForSublayer(0,Se.ReadOnly),xe=De.disabled,Ne=f.colorModeForRenderPass(),Re=[],Ye=0;Ye<E.length;Ye++){var ze=E[Ye],Ge=l.getTile(ze),xt=Ge.getBucket(v);if(xt){var _t=xt.programConfigurations.get(v.id),fr={programConfiguration:_t,program:f.useProgram("circle",_t),layoutVertexBuffer:xt.layoutVertexBuffer,indexBuffer:xt.indexBuffer,uniformValues:Fc(f,ze,Ge,v)};if(W)for(var Vt=0,lr=xt.segments.get();Vt<lr.length;Vt+=1){var vr=lr[Vt];Re.push({segments:new h.SegmentVector([vr]),sortKey:vr.sortKey,state:fr})}else Re.push({segments:xt.segments,sortKey:0,state:fr})}}W&&Re.sort(function(Jn,oi){return Jn.sortKey-oi.sortKey});for(var xr=0,Hr=Re;xr<Hr.length;xr+=1){var cn=Hr[xr],Un=cn.state;Un.program.draw(q,he.TRIANGLES,ve,xe,Ne,vt.disabled,Un.uniformValues,v.id,Un.layoutVertexBuffer,Un.indexBuffer,cn.segments,v.paint,f.transform.zoom,Un.programConfiguration)}}}},heatmap:function(f,l,v,E){if(v.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){var T=f.context,I=T.gl,k=De.disabled,W=new et([I.ONE,I.ONE],h.Color.transparent,[!0,!0,!0,!0]);(function(Re,Ye,ze){var Ge=Re.gl;Re.activeTexture.set(Ge.TEXTURE1),Re.viewport.set([0,0,Ye.width/4,Ye.height/4]);var xt=ze.heatmapFbo;if(xt)Ge.bindTexture(Ge.TEXTURE_2D,xt.colorAttachment.get()),Re.bindFramebuffer.set(xt.framebuffer);else{var _t=Ge.createTexture();Ge.bindTexture(Ge.TEXTURE_2D,_t),Ge.texParameteri(Ge.TEXTURE_2D,Ge.TEXTURE_WRAP_S,Ge.CLAMP_TO_EDGE),Ge.texParameteri(Ge.TEXTURE_2D,Ge.TEXTURE_WRAP_T,Ge.CLAMP_TO_EDGE),Ge.texParameteri(Ge.TEXTURE_2D,Ge.TEXTURE_MIN_FILTER,Ge.LINEAR),Ge.texParameteri(Ge.TEXTURE_2D,Ge.TEXTURE_MAG_FILTER,Ge.LINEAR),xt=ze.heatmapFbo=Re.createFramebuffer(Ye.width/4,Ye.height/4,!1),function(fr,Vt,lr,vr){var xr=fr.gl;xr.texImage2D(xr.TEXTURE_2D,0,xr.RGBA,Vt.width/4,Vt.height/4,0,xr.RGBA,fr.extRenderToTextureHalfFloat?fr.extTextureHalfFloat.HALF_FLOAT_OES:xr.UNSIGNED_BYTE,null),vr.colorAttachment.set(lr)}(Re,Ye,_t,xt)}})(T,f,v),T.clear({color:h.Color.transparent});for(var q=0;q<E.length;q++){var he=E[q];if(!l.hasRenderableParent(he)){var ve=l.getTile(he),xe=ve.getBucket(v);if(xe){var Ne=xe.programConfigurations.get(v.id);f.useProgram("heatmap",Ne).draw(T,I.TRIANGLES,Se.disabled,k,W,vt.disabled,Vl(he.posMatrix,ve,f.transform.zoom,v.paint.get("heatmap-intensity")),v.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,v.paint,f.transform.zoom,Ne)}}}T.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(Re,Ye){var ze=Re.context,Ge=ze.gl,xt=Ye.heatmapFbo;if(xt){ze.activeTexture.set(Ge.TEXTURE0),Ge.bindTexture(Ge.TEXTURE_2D,xt.colorAttachment.get()),ze.activeTexture.set(Ge.TEXTURE1);var _t=Ye.colorRampTexture;_t||(_t=Ye.colorRampTexture=new h.Texture(ze,Ye.colorRamp,Ge.RGBA)),_t.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE),Re.useProgram("heatmapTexture").draw(ze,Ge.TRIANGLES,Se.disabled,De.disabled,Re.colorModeForRenderPass(),vt.disabled,function(fr,Vt,lr,vr){var xr=h.create();h.ortho(xr,0,fr.width,fr.height,0,0,1);var Hr=fr.context.gl;return{u_matrix:xr,u_world:[Hr.drawingBufferWidth,Hr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Vt.paint.get("heatmap-opacity")}}(Re,Ye),Ye.id,Re.viewportBuffer,Re.quadTriangleIndexBuffer,Re.viewportSegments,Ye.paint,Re.transform.zoom)}}(f,v))},line:function(f,l,v,E){if(f.renderPass==="translucent"){var T=v.paint.get("line-opacity"),I=v.paint.get("line-width");if(T.constantOr(1)!==0&&I.constantOr(1)!==0)for(var k=f.depthModeForSublayer(0,Se.ReadOnly),W=f.colorModeForRenderPass(),q=v.paint.get("line-dasharray"),he=v.paint.get("line-pattern"),ve=he.constantOr(1),xe=v.paint.get("line-gradient"),Ne=v.getCrossfadeParameters(),Re=ve?"linePattern":q?"lineSDF":xe?"lineGradient":"line",Ye=f.context,ze=Ye.gl,Ge=!0,xt=0,_t=E;xt<_t.length;xt+=1){var fr=_t[xt],Vt=l.getTile(fr);if(!ve||Vt.patternsLoaded()){var lr=Vt.getBucket(v);if(lr){var vr=lr.programConfigurations.get(v.id),xr=f.context.program.get(),Hr=f.useProgram(Re,vr),cn=Ge||Hr.program!==xr,Un=he.constantOr(null);if(Un&&Vt.imageAtlas){var Jn=Vt.imageAtlas,oi=Jn.patternPositions[Un.to.toString()],ji=Jn.patternPositions[Un.from.toString()];oi&&ji&&vr.setConstantPatternPositions(oi,ji)}var hi=ve?ac(f,Vt,v,Ne):q?Dh(f,Vt,v,q,Ne):xe?Ra(f,Vt,v,lr.lineClipsArray.length):ol(f,Vt,v);if(ve)Ye.activeTexture.set(ze.TEXTURE0),Vt.imageAtlasTexture.bind(ze.LINEAR,ze.CLAMP_TO_EDGE),vr.updatePaintBuffers(Ne);else if(q&&(cn||f.lineAtlas.dirty))Ye.activeTexture.set(ze.TEXTURE0),f.lineAtlas.bind(Ye);else if(xe){var Rn=lr.gradients[v.id],bi=Rn.texture;if(v.gradientVersion!==Rn.version){var Oi=256;if(v.stepInterpolant){var Qn=l.getSource().maxzoom,Ri=fr.canonical.z===Qn?Math.ceil(1<<f.transform.maxZoom-fr.canonical.z):1;Oi=h.clamp(h.nextPowerOfTwo(lr.maxLineLength/h.EXTENT*1024*Ri),256,Ye.maxTextureSize)}Rn.gradient=h.renderColorRamp({expression:v.gradientExpression(),evaluationKey:"lineProgress",resolution:Oi,image:Rn.gradient||void 0,clips:lr.lineClipsArray}),Rn.texture?Rn.texture.update(Rn.gradient):Rn.texture=new h.Texture(Ye,Rn.gradient,ze.RGBA),Rn.version=v.gradientVersion,bi=Rn.texture}Ye.activeTexture.set(ze.TEXTURE0),bi.bind(v.stepInterpolant?ze.NEAREST:ze.LINEAR,ze.CLAMP_TO_EDGE)}Hr.draw(Ye,ze.TRIANGLES,k,f.stencilModeForClipping(fr),W,vt.disabled,hi,v.id,lr.layoutVertexBuffer,lr.indexBuffer,lr.segments,v.paint,f.transform.zoom,vr,lr.layoutVertexBuffer2),Ge=!1}}}}},fill:function(f,l,v,E){var T=v.paint.get("fill-color"),I=v.paint.get("fill-opacity");if(I.constantOr(1)!==0){var k=f.colorModeForRenderPass(),W=v.paint.get("fill-pattern"),q=f.opaquePassEnabledForLayer()&&!W.constantOr(1)&&T.constantOr(h.Color.transparent).a===1&&I.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===q){var he=f.depthModeForSublayer(1,f.renderPass==="opaque"?Se.ReadWrite:Se.ReadOnly);Bc(f,l,v,E,he,k,!1)}if(f.renderPass==="translucent"&&v.paint.get("fill-antialias")){var ve=f.depthModeForSublayer(v.getPaintProperty("fill-outline-color")?2:0,Se.ReadOnly);Bc(f,l,v,E,ve,k,!0)}}},"fill-extrusion":function(f,l,v,E){var T=v.paint.get("fill-extrusion-opacity");if(T!==0&&f.renderPass==="translucent"){var I=new Se(f.context.gl.LEQUAL,Se.ReadWrite,f.depthRangeFor3D);if(T!==1||v.paint.get("fill-extrusion-pattern").constantOr(1))oh(f,l,v,E,I,De.disabled,et.disabled),oh(f,l,v,E,I,f.stencilModeFor3D(),f.colorModeForRenderPass());else{var k=f.colorModeForRenderPass();oh(f,l,v,E,I,De.disabled,k)}}},hillshade:function(f,l,v,E){if(f.renderPass==="offscreen"||f.renderPass==="translucent"){for(var T=f.context,I=f.depthModeForSublayer(0,Se.ReadOnly),k=f.colorModeForRenderPass(),W=f.renderPass==="translucent"?f.stencilConfigForOverlap(E):[{},E],q=W[0],he=0,ve=W[1];he<ve.length;he+=1){var xe=ve[he],Ne=l.getTile(xe);Ne.needsHillshadePrepare&&f.renderPass==="offscreen"?Nc(f,Ne,v,I,De.disabled,k):f.renderPass==="translucent"&&Ef(f,Ne,v,I,q[xe.overscaledZ],k)}T.viewport.set([0,0,f.width,f.height])}},raster:function(f,l,v,E){if(f.renderPass==="translucent"&&v.paint.get("raster-opacity")!==0&&E.length)for(var T=f.context,I=T.gl,k=l.getSource(),W=f.useProgram("raster"),q=f.colorModeForRenderPass(),he=k instanceof ot?[{},E]:f.stencilConfigForOverlap(E),ve=he[0],xe=he[1],Ne=xe[xe.length-1].overscaledZ,Re=!f.options.moving,Ye=0,ze=xe;Ye<ze.length;Ye+=1){var Ge=ze[Ye],xt=f.depthModeForSublayer(Ge.overscaledZ-Ne,v.paint.get("raster-opacity")===1?Se.ReadWrite:Se.ReadOnly,I.LESS),_t=l.getTile(Ge),fr=f.transform.calculatePosMatrix(Ge.toUnwrapped(),Re);_t.registerFadeDuration(v.paint.get("raster-fade-duration"));var Vt=l.findLoadedParent(Ge,0),lr=zc(_t,Vt,l,v,f.transform),vr=void 0,xr=void 0,Hr=v.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;T.activeTexture.set(I.TEXTURE0),_t.texture.bind(Hr,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),T.activeTexture.set(I.TEXTURE1),Vt?(Vt.texture.bind(Hr,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),vr=Math.pow(2,Vt.tileID.overscaledZ-_t.tileID.overscaledZ),xr=[_t.tileID.canonical.x*vr%1,_t.tileID.canonical.y*vr%1]):_t.texture.bind(Hr,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST);var cn=mp(fr,xr||[0,0],vr||1,lr,v);k instanceof ot?W.draw(T,I.TRIANGLES,xt,De.disabled,q,vt.disabled,cn,v.id,k.boundsBuffer,f.quadTriangleIndexBuffer,k.boundsSegments):W.draw(T,I.TRIANGLES,xt,ve[Ge.overscaledZ],q,vt.disabled,cn,v.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments)}},background:function(f,l,v){var E=v.paint.get("background-color"),T=v.paint.get("background-opacity");if(T!==0){var I=f.context,k=I.gl,W=f.transform,q=W.tileSize,he=v.paint.get("background-pattern");if(!f.isPatternMissing(he)){var ve=!he&&E.a===1&&T===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass===ve){var xe=De.disabled,Ne=f.depthModeForSublayer(0,ve==="opaque"?Se.ReadWrite:Se.ReadOnly),Re=f.colorModeForRenderPass(),Ye=f.useProgram(he?"backgroundPattern":"background"),ze=W.coveringTiles({tileSize:q});he&&(I.activeTexture.set(k.TEXTURE0),f.imageManager.bind(f.context));for(var Ge=v.getCrossfadeParameters(),xt=0,_t=ze;xt<_t.length;xt+=1){var fr=_t[xt],Vt=f.transform.calculatePosMatrix(fr.toUnwrapped()),lr=he?Hl(Vt,T,f,he,{tileID:fr,tileSize:q},Ge):Zu(Vt,T,E);Ye.draw(I,k.TRIANGLES,Ne,xe,Re,vt.disabled,lr,v.id,f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}}}}},debug:function(f,l,v){for(var E=0;E<v.length;E++)lc(f,l,v[E])},custom:function(f,l,v){var E=f.context,T=v.implementation;if(f.renderPass==="offscreen"){var I=T.prerender;I&&(f.setCustomLayerDefaults(),E.setColorMode(f.colorModeForRenderPass()),I.call(T,E.gl,f.transform.customLayerMatrix()),E.setDirty(),f.setBaseState())}else if(f.renderPass==="translucent"){f.setCustomLayerDefaults(),E.setColorMode(f.colorModeForRenderPass()),E.setStencilMode(De.disabled);var k=T.renderingMode==="3d"?new Se(f.context.gl.LEQUAL,Se.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,Se.ReadOnly);E.setDepthMode(k),T.render(E.gl,f.transform.customLayerMatrix()),E.setDirty(),f.setBaseState(),E.bindFramebuffer.set(null)}}},Wa=function(f,l){this.context=new _e(f),this.transform=l,this._tileTextures={},this.setup(),this.numSublayers=je.maxUnderzooming+je.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ts,this.gpuTimers={}};Wa.prototype.resize=function(p,f){if(this.width=p*h.browser.devicePixelRatio,this.height=f*h.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var l=0,v=this.style._order;l<v.length;l+=1)this.style._layers[v[l]].resize()},Wa.prototype.setup=function(){var p=this.context,f=new h.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(h.EXTENT,0),f.emplaceBack(0,h.EXTENT),f.emplaceBack(h.EXTENT,h.EXTENT),this.tileExtentBuffer=p.createVertexBuffer(f,Va.members),this.tileExtentSegments=h.SegmentVector.simpleSegment(0,0,4,2);var l=new h.StructArrayLayout2i4;l.emplaceBack(0,0),l.emplaceBack(h.EXTENT,0),l.emplaceBack(0,h.EXTENT),l.emplaceBack(h.EXTENT,h.EXTENT),this.debugBuffer=p.createVertexBuffer(l,Va.members),this.debugSegments=h.SegmentVector.simpleSegment(0,0,4,5);var v=new h.StructArrayLayout4i8;v.emplaceBack(0,0,0,0),v.emplaceBack(h.EXTENT,0,h.EXTENT,0),v.emplaceBack(0,h.EXTENT,0,h.EXTENT),v.emplaceBack(h.EXTENT,h.EXTENT,h.EXTENT,h.EXTENT),this.rasterBoundsBuffer=p.createVertexBuffer(v,ct.members),this.rasterBoundsSegments=h.SegmentVector.simpleSegment(0,0,4,2);var E=new h.StructArrayLayout2i4;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=p.createVertexBuffer(E,Va.members),this.viewportSegments=h.SegmentVector.simpleSegment(0,0,4,2);var T=new h.StructArrayLayout1ui2;T.emplaceBack(0),T.emplaceBack(1),T.emplaceBack(3),T.emplaceBack(2),T.emplaceBack(0),this.tileBorderIndexBuffer=p.createIndexBuffer(T);var I=new h.StructArrayLayout3ui6;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=p.createIndexBuffer(I),this.emptyTexture=new h.Texture(p,{width:1,height:1,data:new Uint8Array([0,0,0,0])},p.gl.RGBA);var k=this.context.gl;this.stencilClearMode=new De({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)},Wa.prototype.clearStencil=function(){var p=this.context,f=p.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var l=h.create();h.ortho(l,0,this.width,this.height,0,0,1),h.scale(l,l,[f.drawingBufferWidth,f.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(p,f.TRIANGLES,Se.disabled,this.stencilClearMode,et.disabled,vt.disabled,Wu(l),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Wa.prototype._renderTileClippingMasks=function(p,f){if(this.currentStencilSource!==p.source&&p.isTileClipped()&&f&&f.length){this.currentStencilSource=p.source;var l=this.context,v=l.gl;this.nextStencilID+f.length>256&&this.clearStencil(),l.setColorMode(et.disabled),l.setDepthMode(Se.disabled);var E=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var T=0,I=f;T<I.length;T+=1){var k=I[T],W=this._tileClippingMaskIDs[k.key]=this.nextStencilID++;E.draw(l,v.TRIANGLES,Se.disabled,new De({func:v.ALWAYS,mask:0},W,255,v.KEEP,v.KEEP,v.REPLACE),et.disabled,vt.disabled,Wu(k.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Wa.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var p=this.nextStencilID++,f=this.context.gl;return new De({func:f.NOTEQUAL,mask:255},p,255,f.KEEP,f.KEEP,f.REPLACE)},Wa.prototype.stencilModeForClipping=function(p){var f=this.context.gl;return new De({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[p.key],0,f.KEEP,f.KEEP,f.REPLACE)},Wa.prototype.stencilConfigForOverlap=function(p){var f,l=this.context.gl,v=p.sort(function(W,q){return q.overscaledZ-W.overscaledZ}),E=v[v.length-1].overscaledZ,T=v[0].overscaledZ-E+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();for(var I={},k=0;k<T;k++)I[k+E]=new De({func:l.GEQUAL,mask:255},k+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=T,[I,v]}return[(f={},f[E]=De.disabled,f),v]},Wa.prototype.colorModeForRenderPass=function(){var p=this.context.gl;return this._showOverdrawInspector?new et([p.CONSTANT_COLOR,p.ONE],new h.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?et.unblended:et.alphaBlended},Wa.prototype.depthModeForSublayer=function(p,f,l){if(!this.opaquePassEnabledForLayer())return Se.disabled;var v=1-((1+this.currentLayer)*this.numSublayers+p)*this.depthEpsilon;return new Se(l||this.context.gl.LEQUAL,f,[v,v])},Wa.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Wa.prototype.render=function(p,f){var l=this;this.style=p,this.options=f,this.lineAtlas=p.lineAtlas,this.imageManager=p.imageManager,this.glyphManager=p.glyphManager,this.symbolFadeChange=p.placement.symbolFadeChange(h.browser.now()),this.imageManager.beginFrame();var v=this.style._order,E=this.style.sourceCaches;for(var T in E){var I=E[T];I.used&&I.prepare(this.context)}var k,W,q={},he={},ve={};for(var xe in E){var Ne=E[xe];q[xe]=Ne.getVisibleCoordinates(),he[xe]=q[xe].slice().reverse(),ve[xe]=Ne.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Re=0;Re<v.length;Re++)if(this.style._layers[v[Re]].is3D()){this.opaquePassCutoff=Re;break}this.renderPass="offscreen";for(var Ye=0,ze=v;Ye<ze.length;Ye+=1){var Ge=this.style._layers[ze[Ye]];if(Ge.hasOffscreenPass()&&!Ge.isHidden(this.transform.zoom)){var xt=he[Ge.source];(Ge.type==="custom"||xt.length)&&this.renderLayer(this,E[Ge.source],Ge,xt)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:f.showOverdrawInspector?h.Color.black:h.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.depthRangeFor3D=[0,1-(p._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){var _t=this.style._layers[v[this.currentLayer]],fr=E[_t.source],Vt=q[_t.source];this._renderTileClippingMasks(_t,Vt),this.renderLayer(this,fr,_t,Vt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){var lr=this.style._layers[v[this.currentLayer]],vr=E[lr.source],xr=(lr.type==="symbol"?ve:he)[lr.source];this._renderTileClippingMasks(lr,q[lr.source]),this.renderLayer(this,vr,lr,xr)}this.options.showTileBoundaries&&(h.values(this.style._layers).forEach(function(Hr){Hr.source&&!Hr.isHidden(l.transform.zoom)&&(Hr.source!==(W&&W.id)&&(W=l.style.sourceCaches[Hr.source]),(!k||k.getSource().maxzoom<W.getSource().maxzoom)&&(k=W))}),k&&ll.debug(this,k,k.getVisibleCoordinates())),this.options.showPadding&&function(Hr){var cn=Hr.transform.padding;Vc(Hr,Hr.transform.height-(cn.top||0),3,Uc),Vc(Hr,cn.bottom||0,3,uc),uh(Hr,cn.left||0,3,Nh),uh(Hr,Hr.transform.width-(cn.right||0),3,jc);var Un=Hr.transform.centerPoint;(function(Jn,oi,ji,hi){Gc(Jn,oi-1,ji-10,2,20,hi),Gc(Jn,oi-10,ji-1,20,2,hi)})(Hr,Un.x,Hr.transform.height-Un.y,sh)}(this),this.context.setDefault()},Wa.prototype.renderLayer=function(p,f,l,v){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||v.length)&&(this.id=l.id,this.gpuTimingStart(l),ll[l.type](p,f,l,v,this.style.placement.variableOffsets),this.gpuTimingEnd())},Wa.prototype.gpuTimingStart=function(p){if(this.options.gpuTiming){var f=this.context.extTimerQuery,l=this.gpuTimers[p.id];l||(l=this.gpuTimers[p.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),l.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,l.query)}},Wa.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var p=this.context.extTimerQuery;p.endQueryEXT(p.TIME_ELAPSED_EXT)}},Wa.prototype.collectGpuTimers=function(){var p=this.gpuTimers;return this.gpuTimers={},p},Wa.prototype.queryGpuTimers=function(p){var f={};for(var l in p){var v=p[l],E=this.context.extTimerQuery,T=E.getQueryObjectEXT(v.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(v.query),f[l]=T}return f},Wa.prototype.translatePosMatrix=function(p,f,l,v,E){if(!l[0]&&!l[1])return p;var T=E?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(T){var I=Math.sin(T),k=Math.cos(T);l=[l[0]*k-l[1]*I,l[0]*I+l[1]*k]}var W=[E?l[0]:Nr(f,l[0],this.transform.zoom),E?l[1]:Nr(f,l[1],this.transform.zoom),0],q=new Float32Array(16);return h.translate(q,p,W),q},Wa.prototype.saveTileTexture=function(p){var f=this._tileTextures[p.size[0]];f?f.push(p):this._tileTextures[p.size[0]]=[p]},Wa.prototype.getTileTexture=function(p){var f=this._tileTextures[p];return f&&f.length>0?f.pop():null},Wa.prototype.isPatternMissing=function(p){if(!p)return!1;if(!p.from||!p.to)return!0;var f=this.imageManager.getPattern(p.from.toString()),l=this.imageManager.getPattern(p.to.toString());return!f||!l},Wa.prototype.useProgram=function(p,f){this.cache=this.cache||{};var l=""+p+(f?f.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[l]||(this.cache[l]=new jl(this.context,p,_s[p],f,bf[p],this._showOverdrawInspector)),this.cache[l]},Wa.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Wa.prototype.setBaseState=function(){var p=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(p.FUNC_ADD)},Wa.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=h.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new h.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Wa.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var cc=function(f,l){this.points=f,this.planes=l};cc.fromInvProjectionMatrix=function(p,f,l){var v=Math.pow(2,l),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(I){return h.transformMat4([],I,p)}).map(function(I){return h.scale$1([],I,1/I[3]/f*v)}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(I){var k=h.sub([],E[I[0]],E[I[1]]),W=h.sub([],E[I[2]],E[I[1]]),q=h.normalize([],h.cross([],k,W)),he=-h.dot(q,E[I[1]]);return q.concat(he)});return new cc(E,T)};var Yu=function(f,l){this.min=f,this.max=l,this.center=h.scale$2([],h.add([],this.min,this.max),.5)};Yu.prototype.quadrant=function(p){for(var f=[p%2==0,p<2],l=h.clone$2(this.min),v=h.clone$2(this.max),E=0;E<f.length;E++)l[E]=f[E]?this.min[E]:this.center[E],v[E]=f[E]?this.center[E]:this.max[E];return v[2]=this.max[2],new Yu(l,v)},Yu.prototype.distanceX=function(p){return Math.max(Math.min(this.max[0],p[0]),this.min[0])-p[0]},Yu.prototype.distanceY=function(p){return Math.max(Math.min(this.max[1],p[1]),this.min[1])-p[1]},Yu.prototype.intersects=function(p){for(var f=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],l=!0,v=0;v<p.planes.length;v++){for(var E=p.planes[v],T=0,I=0;I<f.length;I++)T+=h.dot$1(E,f[I])>=0;if(T===0)return 0;T!==f.length&&(l=!1)}if(l)return 2;for(var k=0;k<3;k++){for(var W=Number.MAX_VALUE,q=-Number.MAX_VALUE,he=0;he<p.points.length;he++){var ve=p.points[he][k]-this.min[k];W=Math.min(W,ve),q=Math.max(q,ve)}if(q<0||W>this.max[k]-this.min[k])return 0}return 1};var Ol=function(f,l,v,E){if(f===void 0&&(f=0),l===void 0&&(l=0),v===void 0&&(v=0),E===void 0&&(E=0),isNaN(f)||f<0||isNaN(l)||l<0||isNaN(v)||v<0||isNaN(E)||E<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=f,this.bottom=l,this.left=v,this.right=E};Ol.prototype.interpolate=function(p,f,l){return f.top!=null&&p.top!=null&&(this.top=h.number(p.top,f.top,l)),f.bottom!=null&&p.bottom!=null&&(this.bottom=h.number(p.bottom,f.bottom,l)),f.left!=null&&p.left!=null&&(this.left=h.number(p.left,f.left,l)),f.right!=null&&p.right!=null&&(this.right=h.number(p.right,f.right,l)),this},Ol.prototype.getCenter=function(p,f){var l=h.clamp((this.left+p-this.right)/2,0,p),v=h.clamp((this.top+f-this.bottom)/2,0,f);return new h.Point(l,v)},Ol.prototype.equals=function(p){return this.top===p.top&&this.bottom===p.bottom&&this.left===p.left&&this.right===p.right},Ol.prototype.clone=function(){return new Ol(this.top,this.bottom,this.left,this.right)},Ol.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var ta=function(f,l,v,E,T){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=T===void 0||T,this._minZoom=f||0,this._maxZoom=l||22,this._minPitch=v==null?0:v,this._maxPitch=E==null?60:E,this.setMaxBounds(),this.width=0,this.height=0,this._center=new h.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ol,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ga={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};ta.prototype.clone=function(){var p=new ta(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return p.tileSize=this.tileSize,p.latRange=this.latRange,p.width=this.width,p.height=this.height,p._center=this._center,p.zoom=this.zoom,p.angle=this.angle,p._fov=this._fov,p._pitch=this._pitch,p._unmodified=this._unmodified,p._edgeInsets=this._edgeInsets.clone(),p._calcMatrices(),p},Ga.minZoom.get=function(){return this._minZoom},Ga.minZoom.set=function(p){this._minZoom!==p&&(this._minZoom=p,this.zoom=Math.max(this.zoom,p))},Ga.maxZoom.get=function(){return this._maxZoom},Ga.maxZoom.set=function(p){this._maxZoom!==p&&(this._maxZoom=p,this.zoom=Math.min(this.zoom,p))},Ga.minPitch.get=function(){return this._minPitch},Ga.minPitch.set=function(p){this._minPitch!==p&&(this._minPitch=p,this.pitch=Math.max(this.pitch,p))},Ga.maxPitch.get=function(){return this._maxPitch},Ga.maxPitch.set=function(p){this._maxPitch!==p&&(this._maxPitch=p,this.pitch=Math.min(this.pitch,p))},Ga.renderWorldCopies.get=function(){return this._renderWorldCopies},Ga.renderWorldCopies.set=function(p){p===void 0?p=!0:p===null&&(p=!1),this._renderWorldCopies=p},Ga.worldSize.get=function(){return this.tileSize*this.scale},Ga.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ga.size.get=function(){return new h.Point(this.width,this.height)},Ga.bearing.get=function(){return-this.angle/Math.PI*180},Ga.bearing.set=function(p){var f=-h.wrap(p,-180,180)*Math.PI/180;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=h.create$2(),h.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ga.pitch.get=function(){return this._pitch/Math.PI*180},Ga.pitch.set=function(p){var f=h.clamp(p,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())},Ga.fov.get=function(){return this._fov/Math.PI*180},Ga.fov.set=function(p){p=Math.max(.01,Math.min(60,p)),this._fov!==p&&(this._unmodified=!1,this._fov=p/180*Math.PI,this._calcMatrices())},Ga.zoom.get=function(){return this._zoom},Ga.zoom.set=function(p){var f=Math.min(Math.max(p,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._zoom=f,this.scale=this.zoomScale(f),this.tileZoom=Math.floor(f),this.zoomFraction=f-this.tileZoom,this._constrain(),this._calcMatrices())},Ga.center.get=function(){return this._center},Ga.center.set=function(p){p.lat===this._center.lat&&p.lng===this._center.lng||(this._unmodified=!1,this._center=p,this._constrain(),this._calcMatrices())},Ga.padding.get=function(){return this._edgeInsets.toJSON()},Ga.padding.set=function(p){this._edgeInsets.equals(p)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,p,1),this._calcMatrices())},Ga.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},ta.prototype.isPaddingEqual=function(p){return this._edgeInsets.equals(p)},ta.prototype.interpolatePadding=function(p,f,l){this._unmodified=!1,this._edgeInsets.interpolate(p,f,l),this._constrain(),this._calcMatrices()},ta.prototype.coveringZoomLevel=function(p){var f=(p.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/p.tileSize));return Math.max(0,f)},ta.prototype.getVisibleUnwrappedCoordinates=function(p){var f=[new h.UnwrappedTileID(0,p)];if(this._renderWorldCopies)for(var l=this.pointCoordinate(new h.Point(0,0)),v=this.pointCoordinate(new h.Point(this.width,0)),E=this.pointCoordinate(new h.Point(this.width,this.height)),T=this.pointCoordinate(new h.Point(0,this.height)),I=Math.floor(Math.min(l.x,v.x,E.x,T.x)),k=Math.floor(Math.max(l.x,v.x,E.x,T.x)),W=I-1;W<=k+1;W++)W!==0&&f.push(new h.UnwrappedTileID(W,p));return f},ta.prototype.coveringTiles=function(p){var f=this.coveringZoomLevel(p),l=f;if(p.minzoom!==void 0&&f<p.minzoom)return[];p.maxzoom!==void 0&&f>p.maxzoom&&(f=p.maxzoom);var v=h.MercatorCoordinate.fromLngLat(this.center),E=Math.pow(2,f),T=[E*v.x,E*v.y,0],I=cc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f),k=p.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(k=f);var W=function(cn){return{aabb:new Yu([cn*E,0,0],[(cn+1)*E,E,0]),zoom:0,x:0,y:0,wrap:cn,fullyVisible:!1}},q=[],he=[],ve=f,xe=p.reparseOverscaled?l:f;if(this._renderWorldCopies)for(var Ne=1;Ne<=3;Ne++)q.push(W(-Ne)),q.push(W(Ne));for(q.push(W(0));q.length>0;){var Re=q.pop(),Ye=Re.x,ze=Re.y,Ge=Re.fullyVisible;if(!Ge){var xt=Re.aabb.intersects(I);if(xt===0)continue;Ge=xt===2}var _t=Re.aabb.distanceX(T),fr=Re.aabb.distanceY(T),Vt=Math.max(Math.abs(_t),Math.abs(fr));if(Re.zoom===ve||Vt>3+(1<<ve-Re.zoom)-2&&Re.zoom>=k)he.push({tileID:new h.OverscaledTileID(Re.zoom===ve?xe:Re.zoom,Re.wrap,Re.zoom,Ye,ze),distanceSq:h.sqrLen([T[0]-.5-Ye,T[1]-.5-ze])});else for(var lr=0;lr<4;lr++){var vr=(Ye<<1)+lr%2,xr=(ze<<1)+(lr>>1);q.push({aabb:Re.aabb.quadrant(lr),zoom:Re.zoom+1,x:vr,y:xr,wrap:Re.wrap,fullyVisible:Ge})}}return he.sort(function(Hr,cn){return Hr.distanceSq-cn.distanceSq}).map(function(Hr){return Hr.tileID})},ta.prototype.resize=function(p,f){this.width=p,this.height=f,this.pixelsToGLUnits=[2/p,-2/f],this._constrain(),this._calcMatrices()},Ga.unmodified.get=function(){return this._unmodified},ta.prototype.zoomScale=function(p){return Math.pow(2,p)},ta.prototype.scaleZoom=function(p){return Math.log(p)/Math.LN2},ta.prototype.project=function(p){var f=h.clamp(p.lat,-this.maxValidLatitude,this.maxValidLatitude);return new h.Point(h.mercatorXfromLng(p.lng)*this.worldSize,h.mercatorYfromLat(f)*this.worldSize)},ta.prototype.unproject=function(p){return new h.MercatorCoordinate(p.x/this.worldSize,p.y/this.worldSize).toLngLat()},Ga.point.get=function(){return this.project(this.center)},ta.prototype.setLocationAtPoint=function(p,f){var l=this.pointCoordinate(f),v=this.pointCoordinate(this.centerPoint),E=this.locationCoordinate(p),T=new h.MercatorCoordinate(E.x-(l.x-v.x),E.y-(l.y-v.y));this.center=this.coordinateLocation(T),this._renderWorldCopies&&(this.center=this.center.wrap())},ta.prototype.locationPoint=function(p){return this.coordinatePoint(this.locationCoordinate(p))},ta.prototype.pointLocation=function(p){return this.coordinateLocation(this.pointCoordinate(p))},ta.prototype.locationCoordinate=function(p){return h.MercatorCoordinate.fromLngLat(p)},ta.prototype.coordinateLocation=function(p){return p.toLngLat()},ta.prototype.pointCoordinate=function(p){var f=[p.x,p.y,0,1],l=[p.x,p.y,1,1];h.transformMat4(f,f,this.pixelMatrixInverse),h.transformMat4(l,l,this.pixelMatrixInverse);var v=f[3],E=l[3],T=f[1]/v,I=l[1]/E,k=f[2]/v,W=l[2]/E,q=k===W?0:(0-k)/(W-k);return new h.MercatorCoordinate(h.number(f[0]/v,l[0]/E,q)/this.worldSize,h.number(T,I,q)/this.worldSize)},ta.prototype.coordinatePoint=function(p){var f=[p.x*this.worldSize,p.y*this.worldSize,0,1];return h.transformMat4(f,f,this.pixelMatrix),new h.Point(f[0]/f[3],f[1]/f[3])},ta.prototype.getBounds=function(){return new h.LngLatBounds().extend(this.pointLocation(new h.Point(0,0))).extend(this.pointLocation(new h.Point(this.width,0))).extend(this.pointLocation(new h.Point(this.width,this.height))).extend(this.pointLocation(new h.Point(0,this.height)))},ta.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new h.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},ta.prototype.setMaxBounds=function(p){p?(this.lngRange=[p.getWest(),p.getEast()],this.latRange=[p.getSouth(),p.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},ta.prototype.calculatePosMatrix=function(p,f){f===void 0&&(f=!1);var l=p.key,v=f?this._alignedPosMatrixCache:this._posMatrixCache;if(v[l])return v[l];var E=p.canonical,T=this.worldSize/this.zoomScale(E.z),I=E.x+Math.pow(2,E.z)*p.wrap,k=h.identity(new Float64Array(16));return h.translate(k,k,[I*T,E.y*T,0]),h.scale(k,k,[T/h.EXTENT,T/h.EXTENT,1]),h.multiply(k,f?this.alignedProjMatrix:this.projMatrix,k),v[l]=new Float32Array(k),v[l]},ta.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},ta.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var p,f,l,v,E=-90,T=90,I=-180,k=180,W=this.size,q=this._unmodified;if(this.latRange){var he=this.latRange;E=h.mercatorYfromLat(he[1])*this.worldSize,p=(T=h.mercatorYfromLat(he[0])*this.worldSize)-E<W.y?W.y/(T-E):0}if(this.lngRange){var ve=this.lngRange;I=h.mercatorXfromLng(ve[0])*this.worldSize,f=(k=h.mercatorXfromLng(ve[1])*this.worldSize)-I<W.x?W.x/(k-I):0}var xe=this.point,Ne=Math.max(f||0,p||0);if(Ne)return this.center=this.unproject(new h.Point(f?(k+I)/2:xe.x,p?(T+E)/2:xe.y)),this.zoom+=this.scaleZoom(Ne),this._unmodified=q,void(this._constraining=!1);if(this.latRange){var Re=xe.y,Ye=W.y/2;Re-Ye<E&&(v=E+Ye),Re+Ye>T&&(v=T-Ye)}if(this.lngRange){var ze=xe.x,Ge=W.x/2;ze-Ge<I&&(l=I+Ge),ze+Ge>k&&(l=k-Ge)}l===void 0&&v===void 0||(this.center=this.unproject(new h.Point(l!==void 0?l:xe.x,v!==void 0?v:xe.y))),this._unmodified=q,this._constraining=!1}},ta.prototype._calcMatrices=function(){if(this.height){var p=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var f=Math.PI/2+this._pitch,l=this._fov*(.5+p.y/this.height),v=Math.sin(l)*this.cameraToCenterDistance/Math.sin(h.clamp(Math.PI-f-l,.01,Math.PI-.01)),E=this.point,T=E.x,I=E.y,k=1.01*(Math.cos(Math.PI/2-this._pitch)*v+this.cameraToCenterDistance),W=this.height/50,q=new Float64Array(16);h.perspective(q,this._fov,this.width/this.height,W,k),q[8]=2*-p.x/this.width,q[9]=2*p.y/this.height,h.scale(q,q,[1,-1,1]),h.translate(q,q,[0,0,-this.cameraToCenterDistance]),h.rotateX(q,q,this._pitch),h.rotateZ(q,q,this.angle),h.translate(q,q,[-T,-I,0]),this.mercatorMatrix=h.scale([],q,[this.worldSize,this.worldSize,this.worldSize]),h.scale(q,q,[1,1,h.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=q,this.invProjMatrix=h.invert([],this.projMatrix);var he=this.width%2/2,ve=this.height%2/2,xe=Math.cos(this.angle),Ne=Math.sin(this.angle),Re=T-Math.round(T)+xe*he+Ne*ve,Ye=I-Math.round(I)+xe*ve+Ne*he,ze=new Float64Array(q);if(h.translate(ze,ze,[Re>.5?Re-1:Re,Ye>.5?Ye-1:Ye,0]),this.alignedProjMatrix=ze,q=h.create(),h.scale(q,q,[this.width/2,-this.height/2,1]),h.translate(q,q,[1,-1,0]),this.labelPlaneMatrix=q,q=h.create(),h.scale(q,q,[1,-1,1]),h.translate(q,q,[-1,-1,0]),h.scale(q,q,[2/this.width,2/this.height,1]),this.glCoordMatrix=q,this.pixelMatrix=h.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(q=h.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=q,this._posMatrixCache={},this._alignedPosMatrixCache={}}},ta.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var p=this.pointCoordinate(new h.Point(0,0)),f=[p.x*this.worldSize,p.y*this.worldSize,0,1];return h.transformMat4(f,f,this.pixelMatrix)[3]/this.cameraToCenterDistance},ta.prototype.getCameraPoint=function(){var p=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.Point(0,p))},ta.prototype.getCameraQueryGeometry=function(p){var f=this.getCameraPoint();if(p.length===1)return[p[0],f];for(var l=f.x,v=f.y,E=f.x,T=f.y,I=0,k=p;I<k.length;I+=1){var W=k[I];l=Math.min(l,W.x),v=Math.min(v,W.y),E=Math.max(E,W.x),T=Math.max(T,W.y)}return[new h.Point(l,v),new h.Point(E,v),new h.Point(E,T),new h.Point(l,T),new h.Point(l,v)]},Object.defineProperties(ta.prototype,Ga);var Os=function(f){var l,v,E,T;this._hashName=f&&encodeURIComponent(f),h.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(l=this._updateHashUnthrottled.bind(this),v=!1,E=null,T=function(){E=null,v&&(l(),E=setTimeout(T,300),v=!1)},function(){return v=!0,E||T(),E})};Os.prototype.addTo=function(p){return this._map=p,h.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Os.prototype.remove=function(){return h.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Os.prototype.getHashString=function(p){var f=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,v=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,v),T=Math.round(f.lng*E)/E,I=Math.round(f.lat*E)/E,k=this._map.getBearing(),W=this._map.getPitch(),q="";if(q+=p?"/"+T+"/"+I+"/"+l:l+"/"+I+"/"+T,(k||W)&&(q+="/"+Math.round(10*k)/10),W&&(q+="/"+Math.round(W)),this._hashName){var he=this._hashName,ve=!1,xe=h.window.location.hash.slice(1).split("&").map(function(Ne){var Re=Ne.split("=")[0];return Re===he?(ve=!0,Re+"="+q):Ne}).filter(function(Ne){return Ne});return ve||xe.push(he+"="+q),"#"+xe.join("&")}return"#"+q},Os.prototype._getCurrentHash=function(){var p,f=this,l=h.window.location.hash.replace("#","");return this._hashName?(l.split("&").map(function(v){return v.split("=")}).forEach(function(v){v[0]===f._hashName&&(p=v)}),(p&&p[1]||"").split("/")):l.split("/")},Os.prototype._onHashChange=function(){var p=this._getCurrentHash();if(p.length>=3&&!p.some(function(l){return isNaN(l)})){var f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(p[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:f,pitch:+(p[4]||0)}),!0}return!1},Os.prototype._updateHashUnthrottled=function(){var p=h.window.location.href.replace(/(#.+)?$/,this.getHashString());try{h.window.history.replaceState(h.window.history.state,null,p)}catch(f){}};var Hc={linearity:.3,easing:h.bezier(0,0,.3,1)},Wc=h.extend({deceleration:2500,maxSpeed:1400},Hc),Zl=h.extend({deceleration:20,maxSpeed:1400},Hc),fd=h.extend({deceleration:1e3,maxSpeed:360},Hc),hd=h.extend({deceleration:1e3,maxSpeed:90},Hc),Sf=function(f){this._map=f,this.clear()};function Zc(p,f){(!p.duration||p.duration<f.duration)&&(p.duration=f.duration,p.easing=f.easing)}function Ku(p,f,l){var v=l.maxSpeed,E=l.linearity,T=l.deceleration,I=h.clamp(p*E/(f/1e3),-v,v),k=Math.abs(I)/(T*E);return{easing:l.easing,duration:1e3*k,amount:I*(k/2)}}Sf.prototype.clear=function(){this._inertiaBuffer=[]},Sf.prototype.record=function(p){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:h.browser.now(),settings:p})},Sf.prototype._drainInertiaBuffer=function(){for(var p=this._inertiaBuffer,f=h.browser.now();p.length>0&&f-p[0].time>160;)p.shift()},Sf.prototype._onMoveEnd=function(p){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var f={zoom:0,bearing:0,pitch:0,pan:new h.Point(0,0),pinchAround:void 0,around:void 0},l=0,v=this._inertiaBuffer;l<v.length;l+=1){var E=v[l].settings;f.zoom+=E.zoomDelta||0,f.bearing+=E.bearingDelta||0,f.pitch+=E.pitchDelta||0,E.panDelta&&f.pan._add(E.panDelta),E.around&&(f.around=E.around),E.pinchAround&&(f.pinchAround=E.pinchAround)}var T=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,I={};if(f.pan.mag()){var k=Ku(f.pan.mag(),T,h.extend({},Wc,p||{}));I.offset=f.pan.mult(k.amount/f.pan.mag()),I.center=this._map.transform.center,Zc(I,k)}if(f.zoom){var W=Ku(f.zoom,T,Zl);I.zoom=this._map.transform.zoom+W.amount,Zc(I,W)}if(f.bearing){var q=Ku(f.bearing,T,fd);I.bearing=this._map.transform.bearing+h.clamp(q.amount,-179,179),Zc(I,q)}if(f.pitch){var he=Ku(f.pitch,T,hd);I.pitch=this._map.transform.pitch+he.amount,Zc(I,he)}if(I.zoom||I.bearing){var ve=f.pinchAround===void 0?f.around:f.pinchAround;I.around=ve?this._map.unproject(ve):this._map.getCenter()}return this.clear(),h.extend(I,{noMoveStart:!0})}};var Pi=function(p){function f(v,E,T,I){I===void 0&&(I={});var k=U.mousePos(E.getCanvasContainer(),T),W=E.unproject(k);p.call(this,v,h.extend({point:k,lngLat:W,originalEvent:T},I)),this._defaultPrevented=!1,this.target=E}p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f;var l={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},l.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,l),f}(h.Event),Xc=function(p){function f(v,E,T){var I=v==="touchend"?T.changedTouches:T.touches,k=U.touchPos(E.getCanvasContainer(),I),W=k.map(function(ve){return E.unproject(ve)}),q=k.reduce(function(ve,xe,Ne,Re){return ve.add(xe.div(Re.length))},new h.Point(0,0)),he=E.unproject(q);p.call(this,v,{points:k,point:q,lngLats:W,lngLat:he,originalEvent:T}),this._defaultPrevented=!1}p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f;var l={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},l.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,l),f}(h.Event),Kn=function(p){function f(v,E,T){p.call(this,v,{originalEvent:T}),this._defaultPrevented=!1}p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f;var l={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},l.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,l),f}(h.Event),_a=function(f,l){this._map=f,this._clickTolerance=l.clickTolerance};_a.prototype.reset=function(){delete this._mousedownPos},_a.prototype.wheel=function(p){return this._firePreventable(new Kn(p.type,this._map,p))},_a.prototype.mousedown=function(p,f){return this._mousedownPos=f,this._firePreventable(new Pi(p.type,this._map,p))},_a.prototype.mouseup=function(p){this._map.fire(new Pi(p.type,this._map,p))},_a.prototype.click=function(p,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||this._map.fire(new Pi(p.type,this._map,p))},_a.prototype.dblclick=function(p){return this._firePreventable(new Pi(p.type,this._map,p))},_a.prototype.mouseover=function(p){this._map.fire(new Pi(p.type,this._map,p))},_a.prototype.mouseout=function(p){this._map.fire(new Pi(p.type,this._map,p))},_a.prototype.touchstart=function(p){return this._firePreventable(new Xc(p.type,this._map,p))},_a.prototype.touchmove=function(p){this._map.fire(new Xc(p.type,this._map,p))},_a.prototype.touchend=function(p){this._map.fire(new Xc(p.type,this._map,p))},_a.prototype.touchcancel=function(p){this._map.fire(new Xc(p.type,this._map,p))},_a.prototype._firePreventable=function(p){if(this._map.fire(p),p.defaultPrevented)return{}},_a.prototype.isEnabled=function(){return!0},_a.prototype.isActive=function(){return!1},_a.prototype.enable=function(){},_a.prototype.disable=function(){};var Ln=function(f){this._map=f};Ln.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Ln.prototype.mousemove=function(p){this._map.fire(new Pi(p.type,this._map,p))},Ln.prototype.mousedown=function(){this._delayContextMenu=!0},Ln.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Ln.prototype.contextmenu=function(p){this._delayContextMenu?this._contextMenuEvent=p:this._map.fire(new Pi(p.type,this._map,p)),this._map.listens("contextmenu")&&p.preventDefault()},Ln.prototype.isEnabled=function(){return!0},Ln.prototype.isActive=function(){return!1},Ln.prototype.enable=function(){},Ln.prototype.disable=function(){};var Zs=function(f,l){this._map=f,this._el=f.getCanvasContainer(),this._container=f.getContainer(),this._clickTolerance=l.clickTolerance||1};function Xl(p,f){for(var l={},v=0;v<p.length;v++)l[p[v].identifier]=f[v];return l}Zs.prototype.isEnabled=function(){return!!this._enabled},Zs.prototype.isActive=function(){return!!this._active},Zs.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Zs.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Zs.prototype.mousedown=function(p,f){this.isEnabled()&&p.shiftKey&&p.button===0&&(U.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)},Zs.prototype.mousemoveWindow=function(p,f){if(this._active){var l=f;if(!(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)){var v=this._startPos;this._lastPos=l,this._box||(this._box=U.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",p));var E=Math.min(v.x,l.x),T=Math.max(v.x,l.x),I=Math.min(v.y,l.y),k=Math.max(v.y,l.y);U.setTransform(this._box,"translate("+E+"px,"+I+"px)"),this._box.style.width=T-E+"px",this._box.style.height=k-I+"px"}}},Zs.prototype.mouseupWindow=function(p,f){var l=this;if(this._active&&p.button===0){var v=this._startPos,E=f;if(this.reset(),U.suppressClick(),v.x!==E.x||v.y!==E.y)return this._map.fire(new h.Event("boxzoomend",{originalEvent:p})),{cameraAnimation:function(I){return I.fitScreenCoordinates(v,E,l._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",p)}},Zs.prototype.keydown=function(p){this._active&&p.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",p))},Zs.prototype.blur=function(){this.reset()},Zs.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(U.remove(this._box),this._box=null),U.enableDrag(),delete this._startPos,delete this._lastPos},Zs.prototype._fireEvent=function(p,f){return this._map.fire(new h.Event(p,{originalEvent:f}))};var Il=function(f){this.reset(),this.numTouches=f.numTouches};Il.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Il.prototype.touchstart=function(p,f,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=p.timeStamp),l.length===this.numTouches&&(this.centroid=function(v){for(var E=new h.Point(0,0),T=0,I=v;T<I.length;T+=1)E._add(I[T]);return E.div(v.length)}(f),this.touches=Xl(l,f)))},Il.prototype.touchmove=function(p,f,l){if(!this.aborted&&this.centroid){var v=Xl(l,f);for(var E in this.touches){var T=v[E];(!T||T.dist(this.touches[E])>30)&&(this.aborted=!0)}}},Il.prototype.touchend=function(p,f,l){if((!this.centroid||p.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){var v=!this.aborted&&this.centroid;if(this.reset(),v)return v}};var pu=function(f){this.singleTap=new Il(f),this.numTaps=f.numTaps,this.reset()};pu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},pu.prototype.touchstart=function(p,f,l){this.singleTap.touchstart(p,f,l)},pu.prototype.touchmove=function(p,f,l){this.singleTap.touchmove(p,f,l)},pu.prototype.touchend=function(p,f,l){var v=this.singleTap.touchend(p,f,l);if(v){var E=p.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(v)<30;if(E&&T||this.reset(),this.count++,this.lastTime=p.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}};var Xs=function(){this._zoomIn=new pu({numTouches:1,numTaps:2}),this._zoomOut=new pu({numTouches:2,numTaps:1}),this.reset()};Xs.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Xs.prototype.touchstart=function(p,f,l){this._zoomIn.touchstart(p,f,l),this._zoomOut.touchstart(p,f,l)},Xs.prototype.touchmove=function(p,f,l){this._zoomIn.touchmove(p,f,l),this._zoomOut.touchmove(p,f,l)},Xs.prototype.touchend=function(p,f,l){var v=this,E=this._zoomIn.touchend(p,f,l),T=this._zoomOut.touchend(p,f,l);return E?(this._active=!0,p.preventDefault(),setTimeout(function(){return v.reset()},0),{cameraAnimation:function(k){return k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(E)},{originalEvent:p})}}):T?(this._active=!0,p.preventDefault(),setTimeout(function(){return v.reset()},0),{cameraAnimation:function(k){return k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(T)},{originalEvent:p})}}):void 0},Xs.prototype.touchcancel=function(){this.reset()},Xs.prototype.enable=function(){this._enabled=!0},Xs.prototype.disable=function(){this._enabled=!1,this.reset()},Xs.prototype.isEnabled=function(){return this._enabled},Xs.prototype.isActive=function(){return this._active};var Cf={0:1,2:2},mn=function(f){this.reset(),this._clickTolerance=f.clickTolerance||1};mn.prototype.blur=function(){this.reset()},mn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},mn.prototype._correctButton=function(p,f){return!1},mn.prototype._move=function(p,f){return{}},mn.prototype.mousedown=function(p,f){if(!this._lastPoint){var l=U.mouseButton(p);this._correctButton(p,l)&&(this._lastPoint=f,this._eventButton=l)}},mn.prototype.mousemoveWindow=function(p,f){var l=this._lastPoint;if(l){if(p.preventDefault(),function(v,E){var T=Cf[E];return v.buttons===void 0||(v.buttons&T)!==T}(p,this._eventButton))this.reset();else if(this._moved||!(f.dist(l)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(l,f)}},mn.prototype.mouseupWindow=function(p){this._lastPoint&&U.mouseButton(p)===this._eventButton&&(this._moved&&U.suppressClick(),this.reset())},mn.prototype.enable=function(){this._enabled=!0},mn.prototype.disable=function(){this._enabled=!1,this.reset()},mn.prototype.isEnabled=function(){return this._enabled},mn.prototype.isActive=function(){return this._active};var Rl=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.mousedown=function(l,v){p.prototype.mousedown.call(this,l,v),this._lastPoint&&(this._active=!0)},f.prototype._correctButton=function(l,v){return v===0&&!l.ctrlKey},f.prototype._move=function(l,v){return{around:v,panDelta:v.sub(l)}},f}(mn),bo=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype._correctButton=function(l,v){return v===0&&l.ctrlKey||v===2},f.prototype._move=function(l,v){var E=.8*(v.x-l.x);if(E)return this._active=!0,{bearingDelta:E}},f.prototype.contextmenu=function(l){l.preventDefault()},f}(mn),fc=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype._correctButton=function(l,v){return v===0&&l.ctrlKey||v===2},f.prototype._move=function(l,v){var E=-.5*(v.y-l.y);if(E)return this._active=!0,{pitchDelta:E}},f.prototype.contextmenu=function(l){l.preventDefault()},f}(mn),Is=function(f){this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset()};Is.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new h.Point(0,0)},Is.prototype.touchstart=function(p,f,l){return this._calculateTransform(p,f,l)},Is.prototype.touchmove=function(p,f,l){if(this._active&&!(l.length<this._minTouches))return p.preventDefault(),this._calculateTransform(p,f,l)},Is.prototype.touchend=function(p,f,l){this._calculateTransform(p,f,l),this._active&&l.length<this._minTouches&&this.reset()},Is.prototype.touchcancel=function(){this.reset()},Is.prototype._calculateTransform=function(p,f,l){l.length>0&&(this._active=!0);var v=Xl(l,f),E=new h.Point(0,0),T=new h.Point(0,0),I=0;for(var k in v){var W=v[k],q=this._touches[k];q&&(E._add(W),T._add(W.sub(q)),I++,v[k]=W)}if(this._touches=v,!(I<this._minTouches)&&T.mag()){var he=T.div(I);if(this._sum._add(he),!(this._sum.mag()<this._clickTolerance))return{around:E.div(I),panDelta:he}}},Is.prototype.enable=function(){this._enabled=!0},Is.prototype.disable=function(){this._enabled=!1,this.reset()},Is.prototype.isEnabled=function(){return this._enabled},Is.prototype.isActive=function(){return this._active};var Uo=function(){this.reset()};function Yc(p,f,l){for(var v=0;v<p.length;v++)if(p[v].identifier===l)return f[v]}function Kc(p,f){return Math.log(p/f)/Math.LN2}Uo.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Uo.prototype._start=function(p){},Uo.prototype._move=function(p,f,l){return{}},Uo.prototype.touchstart=function(p,f,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([f[0],f[1]]))},Uo.prototype.touchmove=function(p,f,l){if(this._firstTwoTouches){p.preventDefault();var v=this._firstTwoTouches,E=v[1],T=Yc(l,f,v[0]),I=Yc(l,f,E);if(T&&I){var k=this._aroundCenter?null:T.add(I).div(2);return this._move([T,I],k,p)}}},Uo.prototype.touchend=function(p,f,l){if(this._firstTwoTouches){var v=this._firstTwoTouches,E=v[1],T=Yc(l,f,v[0]),I=Yc(l,f,E);T&&I||(this._active&&U.suppressClick(),this.reset())}},Uo.prototype.touchcancel=function(){this.reset()},Uo.prototype.enable=function(p){this._enabled=!0,this._aroundCenter=!!p&&p.around==="center"},Uo.prototype.disable=function(){this._enabled=!1,this.reset()},Uo.prototype.isEnabled=function(){return this._enabled},Uo.prototype.isActive=function(){return this._active};var qs=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.reset=function(){p.prototype.reset.call(this),delete this._distance,delete this._startDistance},f.prototype._start=function(l){this._startDistance=this._distance=l[0].dist(l[1])},f.prototype._move=function(l,v){var E=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(Kc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Kc(this._distance,E),pinchAround:v}},f}(Uo);function cl(p,f){return 180*p.angleWith(f)/Math.PI}var lh=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.reset=function(){p.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},f.prototype._start=function(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])},f.prototype._move=function(l,v){var E=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:cl(this._vector,E),pinchAround:v}},f.prototype._isBelowThreshold=function(l){this._minDiameter=Math.min(this._minDiameter,l.mag());var v=25/(Math.PI*this._minDiameter)*360,E=cl(l,this._startVector);return Math.abs(E)<v},f}(Uo);function $c(p){return Math.abs(p.y)>Math.abs(p.x)}var qc=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.reset=function(){p.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},f.prototype._start=function(l){this._lastPoints=l,$c(l[0].sub(l[1]))&&(this._valid=!1)},f.prototype._move=function(l,v,E){var T=l[0].sub(this._lastPoints[0]),I=l[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(T,I,E.timeStamp),this._valid)return this._lastPoints=l,this._active=!0,{pitchDelta:(T.y+I.y)/2*-.5}},f.prototype.gestureBeginsVertically=function(l,v,E){if(this._valid!==void 0)return this._valid;var T=l.mag()>=2,I=v.mag()>=2;if(T||I){if(!T||!I)return this._firstMove===void 0&&(this._firstMove=E),E-this._firstMove<100&&void 0;var k=l.y>0==v.y>0;return $c(l)&&$c(v)&&k}},f}(Uo),Af={panStep:100,bearingStep:15,pitchStep:10},su=function(){var f=Af;this._panStep=f.panStep,this._bearingStep=f.bearingStep,this._pitchStep=f.pitchStep,this._rotationDisabled=!1};function Qs(p){return p*(2-p)}su.prototype.blur=function(){this.reset()},su.prototype.reset=function(){this._active=!1},su.prototype.keydown=function(p){var f=this;if(!(p.altKey||p.ctrlKey||p.metaKey)){var l=0,v=0,E=0,T=0,I=0;switch(p.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:p.shiftKey?v=-1:(p.preventDefault(),T=-1);break;case 39:p.shiftKey?v=1:(p.preventDefault(),T=1);break;case 38:p.shiftKey?E=1:(p.preventDefault(),I=-1);break;case 40:p.shiftKey?E=-1:(p.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(v=0,E=0),{cameraAnimation:function(W){var q=W.getZoom();W.easeTo({duration:300,easeId:"keyboardHandler",easing:Qs,zoom:l?Math.round(q)+l*(p.shiftKey?2:1):q,bearing:W.getBearing()+v*f._bearingStep,pitch:W.getPitch()+E*f._pitchStep,offset:[-T*f._panStep,-I*f._panStep],center:W.getCenter()},{originalEvent:p})}}}},su.prototype.enable=function(){this._enabled=!0},su.prototype.disable=function(){this._enabled=!1,this.reset()},su.prototype.isEnabled=function(){return this._enabled},su.prototype.isActive=function(){return this._active},su.prototype.disableRotation=function(){this._rotationDisabled=!0},su.prototype.enableRotation=function(){this._rotationDisabled=!1};var Wi=function(f,l){this._map=f,this._el=f.getCanvasContainer(),this._handler=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,h.bindAll(["_onTimeout"],this)};Wi.prototype.setZoomRate=function(p){this._defaultZoomRate=p},Wi.prototype.setWheelZoomRate=function(p){this._wheelZoomRate=p},Wi.prototype.isEnabled=function(){return!!this._enabled},Wi.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Wi.prototype.isZooming=function(){return!!this._zooming},Wi.prototype.enable=function(p){this.isEnabled()||(this._enabled=!0,this._aroundCenter=p&&p.around==="center")},Wi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Wi.prototype.wheel=function(p){if(this.isEnabled()){var f=p.deltaMode===h.window.WheelEvent.DOM_DELTA_LINE?40*p.deltaY:p.deltaY,l=h.browser.now(),v=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,f!==0&&f%4.000244140625==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,p)):this._type||(this._type=Math.abs(v*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),p.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=p,this._delta-=f,this._active||this._start(p)),p.preventDefault()}},Wi.prototype._onTimeout=function(p){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},Wi.prototype._start=function(p){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var f=U.mousePos(this._el,p);this._around=h.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(f)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Wi.prototype.renderFrame=function(){var p=this;if(this._frameId&&(this._frameId=null,this.isActive())){var f=this._map.transform;if(this._delta!==0){var l=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,v=2/(1+Math.exp(-Math.abs(this._delta*l)));this._delta<0&&v!==0&&(v=1/v);var E=typeof this._targetZoom=="number"?f.zoomScale(this._targetZoom):f.scale;this._targetZoom=Math.min(f.maxZoom,Math.max(f.minZoom,f.scaleZoom(E*v))),this._type==="wheel"&&(this._startZoom=f.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var T,I=typeof this._targetZoom=="number"?this._targetZoom:f.zoom,k=this._startZoom,W=this._easing,q=!1;if(this._type==="wheel"&&k&&W){var he=Math.min((h.browser.now()-this._lastWheelEventTime)/200,1),ve=W(he);T=h.number(k,I,ve),he<1?this._frameId||(this._frameId=!0):q=!0}else T=I,q=!0;return this._active=!0,q&&(this._active=!1,this._finishTimeout=setTimeout(function(){p._zooming=!1,p._handler._triggerRenderFrame(),delete p._targetZoom,delete p._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!q,zoomDelta:T-f.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Wi.prototype._smoothOutEasing=function(p){var f=h.ease;if(this._prevEase){var l=this._prevEase,v=(h.browser.now()-l.start)/l.duration,E=l.easing(v+.01)-l.easing(v),T=.27/Math.sqrt(E*E+1e-4)*.01,I=Math.sqrt(.0729-T*T);f=h.bezier(T,I,.25,1)}return this._prevEase={start:h.browser.now(),duration:p,easing:f},f},Wi.prototype.blur=function(){this.reset()},Wi.prototype.reset=function(){this._active=!1};var du=function(f,l){this._clickZoom=f,this._tapZoom=l};du.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},du.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},du.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},du.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var vu=function(){this.reset()};vu.prototype.reset=function(){this._active=!1},vu.prototype.blur=function(){this.reset()},vu.prototype.dblclick=function(p,f){return p.preventDefault(),{cameraAnimation:function(v){v.easeTo({duration:300,zoom:v.getZoom()+(p.shiftKey?-1:1),around:v.unproject(f)},{originalEvent:p})}}},vu.prototype.enable=function(){this._enabled=!0},vu.prototype.disable=function(){this._enabled=!1,this.reset()},vu.prototype.isEnabled=function(){return this._enabled},vu.prototype.isActive=function(){return this._active};var ls=function(){this._tap=new pu({numTouches:1,numTaps:1}),this.reset()};ls.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ls.prototype.touchstart=function(p,f,l){this._swipePoint||(this._tapTime&&p.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?l.length>0&&(this._swipePoint=f[0],this._swipeTouch=l[0].identifier):this._tap.touchstart(p,f,l))},ls.prototype.touchmove=function(p,f,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;var v=f[0],E=v.y-this._swipePoint.y;return this._swipePoint=v,p.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(p,f,l)},ls.prototype.touchend=function(p,f,l){this._tapTime?this._swipePoint&&l.length===0&&this.reset():this._tap.touchend(p,f,l)&&(this._tapTime=p.timeStamp)},ls.prototype.touchcancel=function(){this.reset()},ls.prototype.enable=function(){this._enabled=!0},ls.prototype.disable=function(){this._enabled=!1,this.reset()},ls.prototype.isEnabled=function(){return this._enabled},ls.prototype.isActive=function(){return this._active};var fl=function(f,l,v){this._el=f,this._mousePan=l,this._touchPan=v};fl.prototype.enable=function(p){this._inertiaOptions=p||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},fl.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},fl.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},fl.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var kl=function(f,l,v){this._pitchWithRotate=f.pitchWithRotate,this._mouseRotate=l,this._mousePitch=v};kl.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},kl.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},kl.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},kl.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Ko=function(f,l,v,E){this._el=f,this._touchZoom=l,this._touchRotate=v,this._tapDragZoom=E,this._rotationDisabled=!1,this._enabled=!0};Ko.prototype.enable=function(p){this._touchZoom.enable(p),this._rotationDisabled||this._touchRotate.enable(p),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Ko.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Ko.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Ko.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Ko.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Ko.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Eo=function(f){return f.zoom||f.drag||f.pitch||f.rotate},hc=function(p){function f(){p.apply(this,arguments)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f}(h.Event);function ni(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}var Yn=function(f,l){this._map=f,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Sf(f),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(l),h.bindAll(["handleEvent","handleWindowEvent"],this);var v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[h.window.document,"mousemove",{capture:!0}],[h.window.document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[h.window,"blur",void 0]];for(var E=0,T=this._listeners;E<T.length;E+=1){var I=T[E],k=I[0];U.addEventListener(k,I[1],k===h.window.document?this.handleWindowEvent:this.handleEvent,I[2])}};Yn.prototype.destroy=function(){for(var p=0,f=this._listeners;p<f.length;p+=1){var l=f[p],v=l[0];U.removeEventListener(v,l[1],v===h.window.document?this.handleWindowEvent:this.handleEvent,l[2])}},Yn.prototype._addDefaultHandlers=function(p){var f=this._map,l=f.getCanvasContainer();this._add("mapEvent",new _a(f,p));var v=f.boxZoom=new Zs(f,p);this._add("boxZoom",v);var E=new Xs,T=new vu;f.doubleClickZoom=new du(T,E),this._add("tapZoom",E),this._add("clickZoom",T);var I=new ls;this._add("tapDragZoom",I);var k=f.touchPitch=new qc;this._add("touchPitch",k);var W=new bo(p),q=new fc(p);f.dragRotate=new kl(p,W,q),this._add("mouseRotate",W,["mousePitch"]),this._add("mousePitch",q,["mouseRotate"]);var he=new Rl(p),ve=new Is(p);f.dragPan=new fl(l,he,ve),this._add("mousePan",he),this._add("touchPan",ve,["touchZoom","touchRotate"]);var xe=new lh,Ne=new qs;f.touchZoomRotate=new Ko(l,Ne,xe,I),this._add("touchRotate",xe,["touchPan","touchZoom"]),this._add("touchZoom",Ne,["touchPan","touchRotate"]);var Re=f.scrollZoom=new Wi(f,this);this._add("scrollZoom",Re,["mousePan"]);var Ye=f.keyboard=new su;this._add("keyboard",Ye),this._add("blockableMapEvent",new Ln(f));for(var ze=0,Ge=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];ze<Ge.length;ze+=1){var xt=Ge[ze];p.interactive&&p[xt]&&f[xt].enable(p[xt])}},Yn.prototype._add=function(p,f,l){this._handlers.push({handlerName:p,handler:f,allowed:l}),this._handlersById[p]=f},Yn.prototype.stop=function(p){if(!this._updatingCamera){for(var f=0,l=this._handlers;f<l.length;f+=1)l[f].handler.reset();this._inertia.clear(),this._fireEvents({},{},p),this._changes=[]}},Yn.prototype.isActive=function(){for(var p=0,f=this._handlers;p<f.length;p+=1)if(f[p].handler.isActive())return!0;return!1},Yn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Yn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Yn.prototype.isMoving=function(){return Boolean(Eo(this._eventsInProgress))||this.isZooming()},Yn.prototype._blockedByActive=function(p,f,l){for(var v in p)if(v!==l&&(!f||f.indexOf(v)<0))return!0;return!1},Yn.prototype.handleWindowEvent=function(p){this.handleEvent(p,p.type+"Window")},Yn.prototype._getMapTouches=function(p){for(var f=[],l=0,v=p;l<v.length;l+=1){var E=v[l];this._el.contains(E.target)&&f.push(E)}return f},Yn.prototype.handleEvent=function(p,f){this._updatingCamera=!0;for(var l=p.type==="renderFrame"?void 0:p,v={needsRenderFrame:!1},E={},T={},I=p.touches?this._getMapTouches(p.touches):void 0,k=I?U.touchPos(this._el,I):U.mousePos(this._el,p),W=0,q=this._handlers;W<q.length;W+=1){var he=q[W],ve=he.handlerName,xe=he.handler,Ne=he.allowed;if(xe.isEnabled()){var Re=void 0;this._blockedByActive(T,Ne,ve)?xe.reset():xe[f||p.type]&&(Re=xe[f||p.type](p,k,I),this.mergeHandlerResult(v,E,Re,ve,l),Re&&Re.needsRenderFrame&&this._triggerRenderFrame()),(Re||xe.isActive())&&(T[ve]=xe)}}var Ye={};for(var ze in this._previousActiveHandlers)T[ze]||(Ye[ze]=l);this._previousActiveHandlers=T,(Object.keys(Ye).length||ni(v))&&(this._changes.push([v,E,Ye]),this._triggerRenderFrame()),(Object.keys(T).length||ni(v))&&this._map._stop(!0),this._updatingCamera=!1;var Ge=v.cameraAnimation;Ge&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Ge(this._map))},Yn.prototype.mergeHandlerResult=function(p,f,l,v,E){if(l){h.extend(p,l);var T={handlerName:v,originalEvent:l.originalEvent||E};l.zoomDelta!==void 0&&(f.zoom=T),l.panDelta!==void 0&&(f.drag=T),l.pitchDelta!==void 0&&(f.pitch=T),l.bearingDelta!==void 0&&(f.rotate=T)}},Yn.prototype._applyChanges=function(){for(var p={},f={},l={},v=0,E=this._changes;v<E.length;v+=1){var T=E[v],I=T[0],k=T[1],W=T[2];I.panDelta&&(p.panDelta=(p.panDelta||new h.Point(0,0))._add(I.panDelta)),I.zoomDelta&&(p.zoomDelta=(p.zoomDelta||0)+I.zoomDelta),I.bearingDelta&&(p.bearingDelta=(p.bearingDelta||0)+I.bearingDelta),I.pitchDelta&&(p.pitchDelta=(p.pitchDelta||0)+I.pitchDelta),I.around!==void 0&&(p.around=I.around),I.pinchAround!==void 0&&(p.pinchAround=I.pinchAround),I.noInertia&&(p.noInertia=I.noInertia),h.extend(f,k),h.extend(l,W)}this._updateMapTransform(p,f,l),this._changes=[]},Yn.prototype._updateMapTransform=function(p,f,l){var v=this._map,E=v.transform;if(!ni(p))return this._fireEvents(f,l,!0);var T=p.panDelta,I=p.zoomDelta,k=p.bearingDelta,W=p.pitchDelta,q=p.around,he=p.pinchAround;he!==void 0&&(q=he),v._stop(!0),q=q||v.transform.centerPoint;var ve=E.pointLocation(T?q.sub(T):q);k&&(E.bearing+=k),W&&(E.pitch+=W),I&&(E.zoom+=I),E.setLocationAtPoint(ve,q),this._map._update(),p.noInertia||this._inertia.record(p),this._fireEvents(f,l,!0)},Yn.prototype._fireEvents=function(p,f,l){var v=this,E=Eo(this._eventsInProgress),T=Eo(p),I={};for(var k in p)this._eventsInProgress[k]||(I[k+"start"]=p[k].originalEvent),this._eventsInProgress[k]=p[k];for(var W in!E&&T&&this._fireEvent("movestart",T.originalEvent),I)this._fireEvent(W,I[W]);for(var q in T&&this._fireEvent("move",T.originalEvent),p)this._fireEvent(q,p[q].originalEvent);var he,ve={};for(var xe in this._eventsInProgress){var Ne=this._eventsInProgress[xe],Re=Ne.handlerName,Ye=Ne.originalEvent;this._handlersById[Re].isActive()||(delete this._eventsInProgress[xe],ve[xe+"end"]=he=f[Re]||Ye)}for(var ze in ve)this._fireEvent(ze,ve[ze]);var Ge=Eo(this._eventsInProgress);if(l&&(E||T)&&!Ge){this._updatingCamera=!0;var xt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_t=function(Vt){return Vt!==0&&-v._bearingSnap<Vt&&Vt<v._bearingSnap};xt?(_t(xt.bearing||this._map.getBearing())&&(xt.bearing=0),this._map.easeTo(xt,{originalEvent:he})):(this._map.fire(new h.Event("moveend",{originalEvent:he})),_t(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Yn.prototype._fireEvent=function(p,f){this._map.fire(new h.Event(p,f?{originalEvent:f}:{}))},Yn.prototype._requestFrame=function(){var p=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(f){delete p._frameId,p.handleEvent(new hc("renderFrame",{timeStamp:f})),p._applyChanges()})},Yn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var pc=function(p){function f(l,v){p.call(this),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=v.bearingSnap,h.bindAll(["_renderFrameCallback"],this)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.getCenter=function(){return new h.LngLat(this.transform.center.lng,this.transform.center.lat)},f.prototype.setCenter=function(l,v){return this.jumpTo({center:l},v)},f.prototype.panBy=function(l,v,E){return l=h.Point.convert(l).mult(-1),this.panTo(this.transform.center,h.extend({offset:l},v),E)},f.prototype.panTo=function(l,v,E){return this.easeTo(h.extend({center:l},v),E)},f.prototype.getZoom=function(){return this.transform.zoom},f.prototype.setZoom=function(l,v){return this.jumpTo({zoom:l},v),this},f.prototype.zoomTo=function(l,v,E){return this.easeTo(h.extend({zoom:l},v),E)},f.prototype.zoomIn=function(l,v){return this.zoomTo(this.getZoom()+1,l,v),this},f.prototype.zoomOut=function(l,v){return this.zoomTo(this.getZoom()-1,l,v),this},f.prototype.getBearing=function(){return this.transform.bearing},f.prototype.setBearing=function(l,v){return this.jumpTo({bearing:l},v),this},f.prototype.getPadding=function(){return this.transform.padding},f.prototype.setPadding=function(l,v){return this.jumpTo({padding:l},v),this},f.prototype.rotateTo=function(l,v,E){return this.easeTo(h.extend({bearing:l},v),E)},f.prototype.resetNorth=function(l,v){return this.rotateTo(0,h.extend({duration:1e3},l),v),this},f.prototype.resetNorthPitch=function(l,v){return this.easeTo(h.extend({bearing:0,pitch:0,duration:1e3},l),v),this},f.prototype.snapToNorth=function(l,v){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,v):this},f.prototype.getPitch=function(){return this.transform.pitch},f.prototype.setPitch=function(l,v){return this.jumpTo({pitch:l},v),this},f.prototype.cameraForBounds=function(l,v){l=h.LngLatBounds.convert(l);var E=v&&v.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),E,v)},f.prototype._cameraForBoxAndBearing=function(l,v,E,T){var I={top:0,bottom:0,right:0,left:0};if(typeof(T=h.extend({padding:I,offset:[0,0],maxZoom:this.transform.maxZoom},T)).padding=="number"){var k=T.padding;T.padding={top:k,bottom:k,right:k,left:k}}T.padding=h.extend(I,T.padding);var W=this.transform,q=W.padding,he=W.project(h.LngLat.convert(l)),ve=W.project(h.LngLat.convert(v)),xe=he.rotate(-E*Math.PI/180),Ne=ve.rotate(-E*Math.PI/180),Re=new h.Point(Math.max(xe.x,Ne.x),Math.max(xe.y,Ne.y)),Ye=new h.Point(Math.min(xe.x,Ne.x),Math.min(xe.y,Ne.y)),ze=Re.sub(Ye),Ge=(W.width-(q.left+q.right+T.padding.left+T.padding.right))/ze.x,xt=(W.height-(q.top+q.bottom+T.padding.top+T.padding.bottom))/ze.y;if(!(xt<0||Ge<0)){var _t=Math.min(W.scaleZoom(W.scale*Math.min(Ge,xt)),T.maxZoom),fr=typeof T.offset.x=="number"?new h.Point(T.offset.x,T.offset.y):h.Point.convert(T.offset),Vt=new h.Point((T.padding.left-T.padding.right)/2,(T.padding.top-T.padding.bottom)/2).rotate(E*Math.PI/180),lr=fr.add(Vt).mult(W.scale/W.zoomScale(_t));return{center:W.unproject(he.add(ve).div(2).sub(lr)),zoom:_t,bearing:E}}h.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},f.prototype.fitBounds=function(l,v,E){return this._fitInternal(this.cameraForBounds(l,v),v,E)},f.prototype.fitScreenCoordinates=function(l,v,E,T,I){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(h.Point.convert(l)),this.transform.pointLocation(h.Point.convert(v)),E,T),T,I)},f.prototype._fitInternal=function(l,v,E){return l?(delete(v=h.extend(l,v)).padding,v.linear?this.easeTo(v,E):this.flyTo(v,E)):this},f.prototype.jumpTo=function(l,v){this.stop();var E=this.transform,T=!1,I=!1,k=!1;return"zoom"in l&&E.zoom!==+l.zoom&&(T=!0,E.zoom=+l.zoom),l.center!==void 0&&(E.center=h.LngLat.convert(l.center)),"bearing"in l&&E.bearing!==+l.bearing&&(I=!0,E.bearing=+l.bearing),"pitch"in l&&E.pitch!==+l.pitch&&(k=!0,E.pitch=+l.pitch),l.padding==null||E.isPaddingEqual(l.padding)||(E.padding=l.padding),this.fire(new h.Event("movestart",v)).fire(new h.Event("move",v)),T&&this.fire(new h.Event("zoomstart",v)).fire(new h.Event("zoom",v)).fire(new h.Event("zoomend",v)),I&&this.fire(new h.Event("rotatestart",v)).fire(new h.Event("rotate",v)).fire(new h.Event("rotateend",v)),k&&this.fire(new h.Event("pitchstart",v)).fire(new h.Event("pitch",v)).fire(new h.Event("pitchend",v)),this.fire(new h.Event("moveend",v))},f.prototype.easeTo=function(l,v){var E=this;this._stop(!1,l.easeId),((l=h.extend({offset:[0,0],duration:500,easing:h.ease},l)).animate===!1||!l.essential&&h.browser.prefersReducedMotion)&&(l.duration=0);var T=this.transform,I=this.getZoom(),k=this.getBearing(),W=this.getPitch(),q=this.getPadding(),he="zoom"in l?+l.zoom:I,ve="bearing"in l?this._normalizeBearing(l.bearing,k):k,xe="pitch"in l?+l.pitch:W,Ne="padding"in l?l.padding:T.padding,Re=h.Point.convert(l.offset),Ye=T.centerPoint.add(Re),ze=T.pointLocation(Ye),Ge=h.LngLat.convert(l.center||ze);this._normalizeCenter(Ge);var xt,_t,fr=T.project(ze),Vt=T.project(Ge).sub(fr),lr=T.zoomScale(he-I);l.around&&(xt=h.LngLat.convert(l.around),_t=T.locationPoint(xt));var vr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||he!==I,this._rotating=this._rotating||k!==ve,this._pitching=this._pitching||xe!==W,this._padding=!T.isPaddingEqual(Ne),this._easeId=l.easeId,this._prepareEase(v,l.noMoveStart,vr),this._ease(function(xr){if(E._zooming&&(T.zoom=h.number(I,he,xr)),E._rotating&&(T.bearing=h.number(k,ve,xr)),E._pitching&&(T.pitch=h.number(W,xe,xr)),E._padding&&(T.interpolatePadding(q,Ne,xr),Ye=T.centerPoint.add(Re)),xt)T.setLocationAtPoint(xt,_t);else{var Hr=T.zoomScale(T.zoom-I),cn=he>I?Math.min(2,lr):Math.max(.5,lr),Un=Math.pow(cn,1-xr),Jn=T.unproject(fr.add(Vt.mult(xr*Un)).mult(Hr));T.setLocationAtPoint(T.renderWorldCopies?Jn.wrap():Jn,Ye)}E._fireMoveEvents(v)},function(xr){E._afterEase(v,xr)},l),this},f.prototype._prepareEase=function(l,v,E){E===void 0&&(E={}),this._moving=!0,v||E.moving||this.fire(new h.Event("movestart",l)),this._zooming&&!E.zooming&&this.fire(new h.Event("zoomstart",l)),this._rotating&&!E.rotating&&this.fire(new h.Event("rotatestart",l)),this._pitching&&!E.pitching&&this.fire(new h.Event("pitchstart",l))},f.prototype._fireMoveEvents=function(l){this.fire(new h.Event("move",l)),this._zooming&&this.fire(new h.Event("zoom",l)),this._rotating&&this.fire(new h.Event("rotate",l)),this._pitching&&this.fire(new h.Event("pitch",l))},f.prototype._afterEase=function(l,v){if(!this._easeId||!v||this._easeId!==v){delete this._easeId;var E=this._zooming,T=this._rotating,I=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,E&&this.fire(new h.Event("zoomend",l)),T&&this.fire(new h.Event("rotateend",l)),I&&this.fire(new h.Event("pitchend",l)),this.fire(new h.Event("moveend",l))}},f.prototype.flyTo=function(l,v){var E=this;if(!l.essential&&h.browser.prefersReducedMotion){var T=h.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(T,v)}this.stop(),l=h.extend({offset:[0,0],speed:1.2,curve:1.42,easing:h.ease},l);var I=this.transform,k=this.getZoom(),W=this.getBearing(),q=this.getPitch(),he=this.getPadding(),ve="zoom"in l?h.clamp(+l.zoom,I.minZoom,I.maxZoom):k,xe="bearing"in l?this._normalizeBearing(l.bearing,W):W,Ne="pitch"in l?+l.pitch:q,Re="padding"in l?l.padding:I.padding,Ye=I.zoomScale(ve-k),ze=h.Point.convert(l.offset),Ge=I.centerPoint.add(ze),xt=I.pointLocation(Ge),_t=h.LngLat.convert(l.center||xt);this._normalizeCenter(_t);var fr=I.project(xt),Vt=I.project(_t).sub(fr),lr=l.curve,vr=Math.max(I.width,I.height),xr=vr/Ye,Hr=Vt.mag();if("minZoom"in l){var cn=h.clamp(Math.min(l.minZoom,k,ve),I.minZoom,I.maxZoom),Un=vr/I.zoomScale(cn-k);lr=Math.sqrt(Un/Hr*2)}var Jn=lr*lr;function oi(si){var Di=(xr*xr-vr*vr+(si?-1:1)*Jn*Jn*Hr*Hr)/(2*(si?xr:vr)*Jn*Hr);return Math.log(Math.sqrt(Di*Di+1)-Di)}function ji(si){return(Math.exp(si)-Math.exp(-si))/2}function hi(si){return(Math.exp(si)+Math.exp(-si))/2}var Rn=oi(0),bi=function(Di){return hi(Rn)/hi(Rn+lr*Di)},Oi=function(Di){return vr*((hi(Rn)*(ji($i=Rn+lr*Di)/hi($i))-ji(Rn))/Jn)/Hr;var $i},Qn=(oi(1)-Rn)/lr;if(Math.abs(Hr)<1e-6||!isFinite(Qn)){if(Math.abs(vr-xr)<1e-6)return this.easeTo(l,v);var Ri=xr<vr?-1:1;Qn=Math.abs(Math.log(xr/vr))/lr,Oi=function(){return 0},bi=function(Di){return Math.exp(Ri*lr*Di)}}return l.duration="duration"in l?+l.duration:1e3*Qn/("screenSpeed"in l?+l.screenSpeed/lr:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=W!==xe,this._pitching=Ne!==q,this._padding=!I.isPaddingEqual(Re),this._prepareEase(v,!1),this._ease(function(si){var Di=si*Qn,$i=1/bi(Di);I.zoom=si===1?ve:k+I.scaleZoom($i),E._rotating&&(I.bearing=h.number(W,xe,si)),E._pitching&&(I.pitch=h.number(q,Ne,si)),E._padding&&(I.interpolatePadding(he,Re,si),Ge=I.centerPoint.add(ze));var mo=si===1?_t:I.unproject(fr.add(Vt.mult(Oi(Di))).mult($i));I.setLocationAtPoint(I.renderWorldCopies?mo.wrap():mo,Ge),E._fireMoveEvents(v)},function(){return E._afterEase(v)},l),this},f.prototype.isEasing=function(){return!!this._easeFrameId},f.prototype.stop=function(){return this._stop()},f.prototype._stop=function(l,v){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var E=this._onEaseEnd;delete this._onEaseEnd,E.call(this,v)}if(!l){var T=this.handlers;T&&T.stop(!1)}return this},f.prototype._ease=function(l,v,E){E.animate===!1||E.duration===0?(l(1),v()):(this._easeStart=h.browser.now(),this._easeOptions=E,this._onEaseFrame=l,this._onEaseEnd=v,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},f.prototype._renderFrameCallback=function(){var l=Math.min((h.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},f.prototype._normalizeBearing=function(l,v){l=h.wrap(l,-180,180);var E=Math.abs(l-v);return Math.abs(l-360-v)<E&&(l-=360),Math.abs(l+360-v)<E&&(l+=360),l},f.prototype._normalizeCenter=function(l){var v=this.transform;if(v.renderWorldCopies&&!v.lngRange){var E=l.lng-v.center.lng;l.lng+=E>180?-360:E<-180?360:0}},f}(h.Evented),So=function(f){f===void 0&&(f={}),this.options=f,h.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};So.prototype.getDefaultPosition=function(){return"bottom-right"},So.prototype.onAdd=function(p){var f=this.options&&this.options.compact;return this._map=p,this._container=U.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=U.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=U.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},So.prototype.onRemove=function(){U.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},So.prototype._setElementTitle=function(p,f){var l=this._map._getUIString("AttributionControl."+f);p.title=l,p.setAttribute("aria-label",l)},So.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},So.prototype._updateEditLink=function(){var p=this._editLink;p||(p=this._editLink=this._container.querySelector(".mapbox-improve-map"));var f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||h.config.ACCESS_TOKEN}];if(p){var l=f.reduce(function(v,E,T){return E.value&&(v+=E.key+"="+E.value+(T<f.length-1?"&":"")),v},"?");p.href=h.config.FEEDBACK_URL+"/"+l+(this._map._hash?this._map._hash.getHashString(!0):""),p.rel="noopener nofollow",this._setElementTitle(p,"MapFeedback")}},So.prototype._updateData=function(p){!p||p.sourceDataType!=="metadata"&&p.sourceDataType!=="visibility"&&p.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},So.prototype._updateAttributions=function(){if(this._map.style){var p=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?p=p.concat(this.options.customAttribution.map(function(k){return typeof k!="string"?"":k})):typeof this.options.customAttribution=="string"&&p.push(this.options.customAttribution)),this._map.style.stylesheet){var f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}var l=this._map.style.sourceCaches;for(var v in l){var E=l[v];if(E.used){var T=E.getSource();T.attribution&&p.indexOf(T.attribution)<0&&p.push(T.attribution)}}p.sort(function(k,W){return k.length-W.length});var I=(p=p.filter(function(k,W){for(var q=W+1;q<p.length;q++)if(p[q].indexOf(k)>=0)return!1;return!0})).join(" | ");I!==this._attribHTML&&(this._attribHTML=I,p.length?(this._innerContainer.innerHTML=I,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},So.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Ou=function(){h.bindAll(["_updateLogo"],this),h.bindAll(["_updateCompact"],this)};Ou.prototype.onAdd=function(p){this._map=p,this._container=U.create("div","mapboxgl-ctrl");var f=U.create("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Ou.prototype.onRemove=function(){U.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Ou.prototype.getDefaultPosition=function(){return"bottom-left"},Ou.prototype._updateLogo=function(p){p&&p.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Ou.prototype._logoRequired=function(){if(this._map.style){var p=this._map.style.sourceCaches;for(var f in p)if(p[f].getSource().mapbox_logo)return!0;return!1}},Ou.prototype._updateCompact=function(){var p=this._container.children;if(p.length){var f=p[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}};var $o=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};$o.prototype.add=function(p){var f=++this._id;return this._queue.push({callback:p,id:f,cancelled:!1}),f},$o.prototype.remove=function(p){for(var f=this._currentlyRunning,l=0,v=f?this._queue.concat(f):this._queue;l<v.length;l+=1){var E=v[l];if(E.id===p)return void(E.cancelled=!0)}},$o.prototype.run=function(p){p===void 0&&(p=0);var f=this._currentlyRunning=this._queue;this._queue=[];for(var l=0,v=f;l<v.length;l+=1){var E=v[l];if(!E.cancelled&&(E.callback(p),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},$o.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Iu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},wf=h.window.HTMLImageElement,vo=h.window.HTMLElement,ga=h.window.ImageBitmap,qo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},hl=function(p){function f(v){var E=this;if((v=h.extend({},qo,v)).minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var T=new ta(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies);if(p.call(this,T,v),this._interactive=v.interactive,this._maxTileCacheSize=v.maxTileCacheSize,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._crossSourceCollisions=v.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=v.collectResourceTiming,this._renderTaskQueue=new $o,this._controls=[],this._mapId=h.uniqueId(),this._locale=h.extend({},Iu,v.locale),this._clickTolerance=v.clickTolerance,this._requestManager=new h.RequestManager(v.transformRequest,v.accessToken),typeof v.container=="string"){if(this._container=h.window.document.getElementById(v.container),!this._container)throw new Error("Container '"+v.container+"' not found.")}else{if(!(v.container instanceof vo))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(v.maxBounds&&this.setMaxBounds(v.maxBounds),h.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return E._update(!1)}),this.on("moveend",function(){return E._update(!1)}),this.on("zoom",function(){return E._update(!0)}),h.window!==void 0&&(h.window.addEventListener("online",this._onWindowOnline,!1),h.window.addEventListener("resize",this._onWindowResize,!1),h.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Yn(this,v),this._hash=v.hash&&new Os(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,h.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=v.localIdeographFontFamily,v.style&&this.setStyle(v.style,{localIdeographFontFamily:v.localIdeographFontFamily}),v.attributionControl&&this.addControl(new So({customAttribution:v.customAttribution})),this.addControl(new Ou,v.logoPosition),this.on("style.load",function(){E.transform.unmodified&&E.jumpTo(E.style.stylesheet)}),this.on("data",function(I){E._update(I.dataType==="style"),E.fire(new h.Event(I.dataType+"data",I))}),this.on("dataloading",function(I){E.fire(new h.Event(I.dataType+"dataloading",I))})}p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f;var l={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return f.prototype._getMapId=function(){return this._mapId},f.prototype.addControl=function(v,E){if(E===void 0&&(E=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var T=v.onAdd(this);this._controls.push(v);var I=this._controlPositions[E];return E.indexOf("bottom")!==-1?I.insertBefore(T,I.firstChild):I.appendChild(T),this},f.prototype.removeControl=function(v){if(!v||!v.onRemove)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var E=this._controls.indexOf(v);return E>-1&&this._controls.splice(E,1),v.onRemove(this),this},f.prototype.hasControl=function(v){return this._controls.indexOf(v)>-1},f.prototype.resize=function(v){var E=this._containerDimensions(),T=E[0],I=E[1];if(T===this.transform.width&&I===this.transform.height)return this;this._resizeCanvas(T,I),this.transform.resize(T,I),this.painter.resize(T,I);var k=!this._moving;return k&&this.fire(new h.Event("movestart",v)).fire(new h.Event("move",v)),this.fire(new h.Event("resize",v)),k&&this.fire(new h.Event("moveend",v)),this},f.prototype.getBounds=function(){return this.transform.getBounds()},f.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},f.prototype.setMaxBounds=function(v){return this.transform.setMaxBounds(h.LngLatBounds.convert(v)),this._update()},f.prototype.setMinZoom=function(v){if((v=v==null?-2:v)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},f.prototype.getMinZoom=function(){return this.transform.minZoom},f.prototype.setMaxZoom=function(v){if((v=v==null?22:v)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")},f.prototype.getMaxZoom=function(){return this.transform.maxZoom},f.prototype.setMinPitch=function(v){if((v=v==null?0:v)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},f.prototype.getMinPitch=function(){return this.transform.minPitch},f.prototype.setMaxPitch=function(v){if((v=v==null?60:v)>60)throw new Error("maxPitch must be less than or equal to 60");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")},f.prototype.getMaxPitch=function(){return this.transform.maxPitch},f.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},f.prototype.setRenderWorldCopies=function(v){return this.transform.renderWorldCopies=v,this._update()},f.prototype.project=function(v){return this.transform.locationPoint(h.LngLat.convert(v))},f.prototype.unproject=function(v){return this.transform.pointLocation(h.Point.convert(v))},f.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},f.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},f.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},f.prototype._createDelegatedListener=function(v,E,T){var I,k=this;if(v==="mouseenter"||v==="mouseover"){var W=!1;return{layer:E,listener:T,delegates:{mousemove:function(ve){var xe=k.getLayer(E)?k.queryRenderedFeatures(ve.point,{layers:[E]}):[];xe.length?W||(W=!0,T.call(k,new Pi(v,k,ve.originalEvent,{features:xe}))):W=!1},mouseout:function(){W=!1}}}}if(v==="mouseleave"||v==="mouseout"){var q=!1;return{layer:E,listener:T,delegates:{mousemove:function(ve){(k.getLayer(E)?k.queryRenderedFeatures(ve.point,{layers:[E]}):[]).length?q=!0:q&&(q=!1,T.call(k,new Pi(v,k,ve.originalEvent)))},mouseout:function(ve){q&&(q=!1,T.call(k,new Pi(v,k,ve.originalEvent)))}}}}return{layer:E,listener:T,delegates:(I={},I[v]=function(he){var ve=k.getLayer(E)?k.queryRenderedFeatures(he.point,{layers:[E]}):[];ve.length&&(he.features=ve,T.call(k,he),delete he.features)},I)}},f.prototype.on=function(v,E,T){if(T===void 0)return p.prototype.on.call(this,v,E);var I=this._createDelegatedListener(v,E,T);for(var k in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(I),I.delegates)this.on(k,I.delegates[k]);return this},f.prototype.once=function(v,E,T){if(T===void 0)return p.prototype.once.call(this,v,E);var I=this._createDelegatedListener(v,E,T);for(var k in I.delegates)this.once(k,I.delegates[k]);return this},f.prototype.off=function(v,E,T){var I=this;return T===void 0?p.prototype.off.call(this,v,E):(this._delegatedListeners&&this._delegatedListeners[v]&&function(k){for(var W=k[v],q=0;q<W.length;q++){var he=W[q];if(he.layer===E&&he.listener===T){for(var ve in he.delegates)I.off(ve,he.delegates[ve]);return W.splice(q,1),I}}}(this._delegatedListeners),this)},f.prototype.queryRenderedFeatures=function(v,E){if(!this.style)return[];var T;if(E!==void 0||v===void 0||v instanceof h.Point||Array.isArray(v)||(E=v,v=void 0),E=E||{},(v=v||[[0,0],[this.transform.width,this.transform.height]])instanceof h.Point||typeof v[0]=="number")T=[h.Point.convert(v)];else{var I=h.Point.convert(v[0]),k=h.Point.convert(v[1]);T=[I,new h.Point(k.x,I.y),k,new h.Point(I.x,k.y),I]}return this.style.queryRenderedFeatures(T,E,this.transform)},f.prototype.querySourceFeatures=function(v,E){return this.style.querySourceFeatures(v,E)},f.prototype.setStyle=function(v,E){return(E=h.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},E)).diff!==!1&&E.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,E),this):(this._localIdeographFontFamily=E.localIdeographFontFamily,this._updateStyle(v,E))},f.prototype._getUIString=function(v){var E=this._locale[v];if(E==null)throw new Error("Missing UI string '"+v+"'");return E},f.prototype._updateStyle=function(v,E){return this.style&&(this.style.setEventedParent(null),this.style._remove()),v?(this.style=new Ca(this,E||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v):this.style.loadJSON(v),this):(delete this.style,this)},f.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ca(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},f.prototype._diffStyle=function(v,E){var T=this;if(typeof v=="string"){var I=this._requestManager.normalizeStyleURL(v),k=this._requestManager.transformRequest(I,h.ResourceType.Style);h.getJSON(k,function(W,q){W?T.fire(new h.ErrorEvent(W)):q&&T._updateDiff(q,E)})}else typeof v=="object"&&this._updateDiff(v,E)},f.prototype._updateDiff=function(v,E){try{this.style.setState(v)&&this._update(!0)}catch(T){h.warnOnce("Unable to perform style diff: "+(T.message||T.error||T)+".  Rebuilding the style from scratch."),this._updateStyle(v,E)}},f.prototype.getStyle=function(){if(this.style)return this.style.serialize()},f.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():h.warnOnce("There is no style added to the map.")},f.prototype.addSource=function(v,E){return this._lazyInitEmptyStyle(),this.style.addSource(v,E),this._update(!0)},f.prototype.isSourceLoaded=function(v){var E=this.style&&this.style.sourceCaches[v];if(E!==void 0)return E.loaded();this.fire(new h.ErrorEvent(new Error("There is no source with ID '"+v+"'")))},f.prototype.areTilesLoaded=function(){var v=this.style&&this.style.sourceCaches;for(var E in v){var T=v[E]._tiles;for(var I in T){var k=T[I];if(k.state!=="loaded"&&k.state!=="errored")return!1}}return!0},f.prototype.addSourceType=function(v,E,T){return this._lazyInitEmptyStyle(),this.style.addSourceType(v,E,T)},f.prototype.removeSource=function(v){return this.style.removeSource(v),this._update(!0)},f.prototype.getSource=function(v){return this.style.getSource(v)},f.prototype.addImage=function(v,E,T){T===void 0&&(T={});var I=T.pixelRatio;I===void 0&&(I=1);var k=T.sdf;k===void 0&&(k=!1);var W=T.stretchX,q=T.stretchY,he=T.content;if(this._lazyInitEmptyStyle(),E instanceof wf||ga&&E instanceof ga){var ve=h.browser.getImageData(E);this.style.addImage(v,{data:new h.RGBAImage({width:ve.width,height:ve.height},ve.data),pixelRatio:I,stretchX:W,stretchY:q,content:he,sdf:k,version:0})}else{if(E.width===void 0||E.height===void 0)return this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var xe=E;this.style.addImage(v,{data:new h.RGBAImage({width:E.width,height:E.height},new Uint8Array(E.data)),pixelRatio:I,stretchX:W,stretchY:q,content:he,sdf:k,version:0,userImage:xe}),xe.onAdd&&xe.onAdd(this,v)}},f.prototype.updateImage=function(v,E){var T=this.style.getImage(v);if(!T)return this.fire(new h.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var I=E instanceof wf||ga&&E instanceof ga?h.browser.getImageData(E):E,k=I.width,W=I.height,q=I.data;return k===void 0||W===void 0?this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):k!==T.data.width||W!==T.data.height?this.fire(new h.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(T.data.replace(q,!(E instanceof wf||ga&&E instanceof ga)),void this.style.updateImage(v,T))},f.prototype.hasImage=function(v){return v?!!this.style.getImage(v):(this.fire(new h.ErrorEvent(new Error("Missing required image id"))),!1)},f.prototype.removeImage=function(v){this.style.removeImage(v)},f.prototype.loadImage=function(v,E){h.getImage(this._requestManager.transformRequest(v,h.ResourceType.Image),E)},f.prototype.listImages=function(){return this.style.listImages()},f.prototype.addLayer=function(v,E){return this._lazyInitEmptyStyle(),this.style.addLayer(v,E),this._update(!0)},f.prototype.moveLayer=function(v,E){return this.style.moveLayer(v,E),this._update(!0)},f.prototype.removeLayer=function(v){return this.style.removeLayer(v),this._update(!0)},f.prototype.getLayer=function(v){return this.style.getLayer(v)},f.prototype.setLayerZoomRange=function(v,E,T){return this.style.setLayerZoomRange(v,E,T),this._update(!0)},f.prototype.setFilter=function(v,E,T){return T===void 0&&(T={}),this.style.setFilter(v,E,T),this._update(!0)},f.prototype.getFilter=function(v){return this.style.getFilter(v)},f.prototype.setPaintProperty=function(v,E,T,I){return I===void 0&&(I={}),this.style.setPaintProperty(v,E,T,I),this._update(!0)},f.prototype.getPaintProperty=function(v,E){return this.style.getPaintProperty(v,E)},f.prototype.setLayoutProperty=function(v,E,T,I){return I===void 0&&(I={}),this.style.setLayoutProperty(v,E,T,I),this._update(!0)},f.prototype.getLayoutProperty=function(v,E){return this.style.getLayoutProperty(v,E)},f.prototype.setLight=function(v,E){return E===void 0&&(E={}),this._lazyInitEmptyStyle(),this.style.setLight(v,E),this._update(!0)},f.prototype.getLight=function(){return this.style.getLight()},f.prototype.setFeatureState=function(v,E){return this.style.setFeatureState(v,E),this._update()},f.prototype.removeFeatureState=function(v,E){return this.style.removeFeatureState(v,E),this._update()},f.prototype.getFeatureState=function(v){return this.style.getFeatureState(v)},f.prototype.getContainer=function(){return this._container},f.prototype.getCanvasContainer=function(){return this._canvasContainer},f.prototype.getCanvas=function(){return this._canvas},f.prototype._containerDimensions=function(){var v=0,E=0;return this._container&&(v=this._container.clientWidth||400,E=this._container.clientHeight||300),[v,E]},f.prototype._detectMissingCSS=function(){h.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&h.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},f.prototype._setupContainer=function(){var v=this._container;v.classList.add("mapboxgl-map"),(this._missingCSSCanary=U.create("div","mapboxgl-canary",v)).style.visibility="hidden",this._detectMissingCSS();var E=this._canvasContainer=U.create("div","mapboxgl-canvas-container",v);this._interactive&&E.classList.add("mapboxgl-interactive"),this._canvas=U.create("canvas","mapboxgl-canvas",E),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var T=this._containerDimensions();this._resizeCanvas(T[0],T[1]);var I=this._controlContainer=U.create("div","mapboxgl-control-container",v),k=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(W){k[W]=U.create("div","mapboxgl-ctrl-"+W,I)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},f.prototype._resizeCanvas=function(v,E){var T=h.browser.devicePixelRatio||1;this._canvas.width=T*v,this._canvas.height=T*E,this._canvas.style.width=v+"px",this._canvas.style.height=E+"px"},f.prototype._setupPainter=function(){var v=h.extend({},z.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),E=this._canvas.getContext("webgl",v)||this._canvas.getContext("experimental-webgl",v);E?(this.painter=new Wa(E,this.transform),h.webpSupported.testSupport(E)):this.fire(new h.ErrorEvent(new Error("Failed to initialize WebGL")))},f.prototype._contextLost=function(v){v.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new h.Event("webglcontextlost",{originalEvent:v}))},f.prototype._contextRestored=function(v){this._setupPainter(),this.resize(),this._update(),this.fire(new h.Event("webglcontextrestored",{originalEvent:v}))},f.prototype._onMapScroll=function(v){if(v.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},f.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},f.prototype._update=function(v){return this.style?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this},f.prototype._requestRenderFrame=function(v){return this._update(),this._renderTaskQueue.add(v)},f.prototype._cancelRenderFrame=function(v){this._renderTaskQueue.remove(v)},f.prototype._render=function(v){var E,T=this,I=0,k=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(E=k.createQueryEXT(),k.beginQueryEXT(k.TIME_ELAPSED_EXT,E),I=h.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),!this._removed){var W=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var q=this.transform.zoom,he=h.browser.now();this.style.zoomHistory.update(q,he);var ve=new h.EvaluationParameters(q,{now:he,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),xe=ve.crossFadingFactor();xe===1&&xe===this._crossFadingFactor||(W=!0,this._crossFadingFactor=xe),this.style.update(ve)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new h.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new h.Event("load"))),this.style&&(this.style.hasTransitions()||W)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ne=h.browser.now()-I;k.endQueryEXT(k.TIME_ELAPSED_EXT,E),setTimeout(function(){var ze=k.getQueryObjectEXT(E,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(E),T.fire(new h.Event("gpu-timing-frame",{cpuTime:Ne,gpuTime:ze}))},50)}if(this.listens("gpu-timing-layer")){var Re=this.painter.collectGpuTimers();setTimeout(function(){var ze=T.painter.queryGpuTimers(Re);T.fire(new h.Event("gpu-timing-layer",{layerTimes:ze}))},50)}var Ye=this._sourcesDirty||this._styleDirty||this._placementDirty;return Ye||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.Event("idle")),!this._loaded||this._fullyLoaded||Ye||(this._fullyLoaded=!0),this}},f.prototype.remove=function(){this._hash&&this._hash.remove();for(var v=0,E=this._controls;v<E.length;v+=1)E[v].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),h.window!==void 0&&(h.window.removeEventListener("resize",this._onWindowResize,!1),h.window.removeEventListener("orientationchange",this._onWindowResize,!1),h.window.removeEventListener("online",this._onWindowOnline,!1));var T=this.painter.context.gl.getExtension("WEBGL_lose_context");T&&T.loseContext(),Ru(this._canvasContainer),Ru(this._controlContainer),Ru(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new h.Event("remove"))},f.prototype.triggerRepaint=function(){var v=this;this.style&&!this._frame&&(this._frame=h.browser.frame(function(E){v._frame=null,v._render(E)}))},f.prototype._onWindowOnline=function(){this._update()},f.prototype._onWindowResize=function(v){this._trackResize&&this.resize({originalEvent:v})._update()},l.showTileBoundaries.get=function(){return!!this._showTileBoundaries},l.showTileBoundaries.set=function(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())},l.showPadding.get=function(){return!!this._showPadding},l.showPadding.set=function(v){this._showPadding!==v&&(this._showPadding=v,this._update())},l.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},l.showCollisionBoxes.set=function(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())},l.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},l.showOverdrawInspector.set=function(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())},l.repaint.get=function(){return!!this._repaint},l.repaint.set=function(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())},l.vertices.get=function(){return!!this._vertices},l.vertices.set=function(v){this._vertices=v,this._update()},f.prototype._setCacheLimits=function(v,E){h.setCacheLimits(v,E)},l.version.get=function(){return h.version},Object.defineProperties(f.prototype,l),f}(pc);function Ru(p){p.parentNode&&p.parentNode.removeChild(p)}var $u={showCompass:!0,showZoom:!0,visualizePitch:!1},mu=function(f){var l=this;this.options=h.extend({},$u,f),this._container=U.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(v){return v.preventDefault()}),this.options.showZoom&&(h.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(v){return l._map.zoomIn({},{originalEvent:v})}),U.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(v){return l._map.zoomOut({},{originalEvent:v})}),U.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(h.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(v){l.options.visualizePitch?l._map.resetNorthPitch({},{originalEvent:v}):l._map.resetNorth({},{originalEvent:v})}),this._compassIcon=U.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};mu.prototype._updateZoomButtons=function(){var p=this._map.getZoom(),f=p===this._map.getMaxZoom(),l=p===this._map.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},mu.prototype._rotateCompassArrow=function(){var p=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=p},mu.prototype.onAdd=function(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ys(this._map,this._compass,this.options.visualizePitch)),this._container},mu.prototype.onRemove=function(){U.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},mu.prototype._createButton=function(p,f){var l=U.create("button",p,this._container);return l.type="button",l.addEventListener("click",f),l},mu.prototype._setButtonTitle=function(p,f){var l=this._map._getUIString("NavigationControl."+f);p.title=l,p.setAttribute("aria-label",l)};var Ys=function(f,l,v){v===void 0&&(v=!1),this._clickTolerance=10,this.element=l,this.mouseRotate=new bo({clickTolerance:f.dragRotate._mouseRotate._clickTolerance}),this.map=f,v&&(this.mousePitch=new fc({clickTolerance:f.dragRotate._mousePitch._clickTolerance})),h.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),U.addEventListener(l,"mousedown",this.mousedown),U.addEventListener(l,"touchstart",this.touchstart,{passive:!1}),U.addEventListener(l,"touchmove",this.touchmove),U.addEventListener(l,"touchend",this.touchend),U.addEventListener(l,"touchcancel",this.reset)};function Yl(p,f,l){if(p=new h.LngLat(p.lng,p.lat),f){var v=new h.LngLat(p.lng-360,p.lat),E=new h.LngLat(p.lng+360,p.lat),T=l.locationPoint(p).distSqr(f);l.locationPoint(v).distSqr(f)<T?p=v:l.locationPoint(E).distSqr(f)<T&&(p=E)}for(;Math.abs(p.lng-l.center.lng)>180;){var I=l.locationPoint(p);if(I.x>=0&&I.y>=0&&I.x<=l.width&&I.y<=l.height)break;p.lng>l.center.lng?p.lng-=360:p.lng+=360}return p}Ys.prototype.down=function(p,f){this.mouseRotate.mousedown(p,f),this.mousePitch&&this.mousePitch.mousedown(p,f),U.disableDrag()},Ys.prototype.move=function(p,f){var l=this.map,v=this.mouseRotate.mousemoveWindow(p,f);if(v&&v.bearingDelta&&l.setBearing(l.getBearing()+v.bearingDelta),this.mousePitch){var E=this.mousePitch.mousemoveWindow(p,f);E&&E.pitchDelta&&l.setPitch(l.getPitch()+E.pitchDelta)}},Ys.prototype.off=function(){var p=this.element;U.removeEventListener(p,"mousedown",this.mousedown),U.removeEventListener(p,"touchstart",this.touchstart,{passive:!1}),U.removeEventListener(p,"touchmove",this.touchmove),U.removeEventListener(p,"touchend",this.touchend),U.removeEventListener(p,"touchcancel",this.reset),this.offTemp()},Ys.prototype.offTemp=function(){U.enableDrag(),U.removeEventListener(h.window,"mousemove",this.mousemove),U.removeEventListener(h.window,"mouseup",this.mouseup)},Ys.prototype.mousedown=function(p){this.down(h.extend({},p,{ctrlKey:!0,preventDefault:function(){return p.preventDefault()}}),U.mousePos(this.element,p)),U.addEventListener(h.window,"mousemove",this.mousemove),U.addEventListener(h.window,"mouseup",this.mouseup)},Ys.prototype.mousemove=function(p){this.move(p,U.mousePos(this.element,p))},Ys.prototype.mouseup=function(p){this.mouseRotate.mouseupWindow(p),this.mousePitch&&this.mousePitch.mouseupWindow(p),this.offTemp()},Ys.prototype.touchstart=function(p){p.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=U.touchPos(this.element,p.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return p.preventDefault()}},this._startPos))},Ys.prototype.touchmove=function(p){p.targetTouches.length!==1?this.reset():(this._lastPos=U.touchPos(this.element,p.targetTouches)[0],this.move({preventDefault:function(){return p.preventDefault()}},this._lastPos))},Ys.prototype.touchend=function(p){p.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Ys.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var gu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Tf(p,f,l){var v=p.classList;for(var E in gu)v.remove("mapboxgl-"+l+"-anchor-"+E);v.add("mapboxgl-"+l+"-anchor-"+f)}var Kl,Mf=function(p){function f(l,v){if(p.call(this),(l instanceof h.window.HTMLElement||v)&&(l=h.extend({element:l},v)),h.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,l&&l.element)this._element=l.element,this._offset=h.Point.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=U.create("div"),this._element.setAttribute("aria-label","Map marker");var E=U.createNS("http://www.w3.org/2000/svg","svg");E.setAttributeNS(null,"display","block"),E.setAttributeNS(null,"height","41px"),E.setAttributeNS(null,"width","27px"),E.setAttributeNS(null,"viewBox","0 0 27 41");var T=U.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"stroke","none"),T.setAttributeNS(null,"stroke-width","1"),T.setAttributeNS(null,"fill","none"),T.setAttributeNS(null,"fill-rule","evenodd");var I=U.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"fill-rule","nonzero");var k=U.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");for(var W=0,q=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];W<q.length;W+=1){var he=q[W],ve=U.createNS("http://www.w3.org/2000/svg","ellipse");ve.setAttributeNS(null,"opacity","0.04"),ve.setAttributeNS(null,"cx","10.5"),ve.setAttributeNS(null,"cy","5.80029008"),ve.setAttributeNS(null,"rx",he.rx),ve.setAttributeNS(null,"ry",he.ry),k.appendChild(ve)}var xe=U.createNS("http://www.w3.org/2000/svg","g");xe.setAttributeNS(null,"fill",this._color);var Ne=U.createNS("http://www.w3.org/2000/svg","path");Ne.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),xe.appendChild(Ne);var Re=U.createNS("http://www.w3.org/2000/svg","g");Re.setAttributeNS(null,"opacity","0.25"),Re.setAttributeNS(null,"fill","#000000");var Ye=U.createNS("http://www.w3.org/2000/svg","path");Ye.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Re.appendChild(Ye);var ze=U.createNS("http://www.w3.org/2000/svg","g");ze.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ze.setAttributeNS(null,"fill","#FFFFFF");var Ge=U.createNS("http://www.w3.org/2000/svg","g");Ge.setAttributeNS(null,"transform","translate(8.0, 8.0)");var xt=U.createNS("http://www.w3.org/2000/svg","circle");xt.setAttributeNS(null,"fill","#000000"),xt.setAttributeNS(null,"opacity","0.25"),xt.setAttributeNS(null,"cx","5.5"),xt.setAttributeNS(null,"cy","5.5"),xt.setAttributeNS(null,"r","5.4999962");var _t=U.createNS("http://www.w3.org/2000/svg","circle");_t.setAttributeNS(null,"fill","#FFFFFF"),_t.setAttributeNS(null,"cx","5.5"),_t.setAttributeNS(null,"cy","5.5"),_t.setAttributeNS(null,"r","5.4999962"),Ge.appendChild(xt),Ge.appendChild(_t),I.appendChild(k),I.appendChild(xe),I.appendChild(Re),I.appendChild(ze),I.appendChild(Ge),E.appendChild(I),E.setAttributeNS(null,"height",41*this._scale+"px"),E.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(E),this._offset=h.Point.convert(l&&l.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(fr){fr.preventDefault()}),this._element.addEventListener("mousedown",function(fr){fr.preventDefault()}),Tf(this._element,this._anchor,"marker"),this._popup=null}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.addTo=function(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},f.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),U.remove(this._element),this._popup&&this._popup.remove(),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(l){return this._lngLat=h.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},f.prototype.getElement=function(){return this._element},f.prototype.setPopup=function(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){var v=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(24.6+v)],"bottom-right":[-v,-1*(24.6+v)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=l,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},f.prototype._onKeyPress=function(l){var v=l.code,E=l.charCode||l.keyCode;v!=="Space"&&v!=="Enter"&&E!==32&&E!==13||this.togglePopup()},f.prototype._onMapClick=function(l){var v=l.originalEvent.target,E=this._element;this._popup&&(v===E||E.contains(v))&&this.togglePopup()},f.prototype.getPopup=function(){return this._popup},f.prototype.togglePopup=function(){var l=this._popup;return l?(l.isOpen()?l.remove():l.addTo(this._map),this):this},f.prototype._update=function(l){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Yl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(v="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var E="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?E="rotateX(0deg)":this._pitchAlignment==="map"&&(E="rotateX("+this._map.getPitch()+"deg)"),l&&l.type!=="moveend"||(this._pos=this._pos.round()),U.setTransform(this._element,gu[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+E+" "+v)}},f.prototype.getOffset=function(){return this._offset},f.prototype.setOffset=function(l){return this._offset=h.Point.convert(l),this._update(),this},f.prototype._onMove=function(l){if(!this._isDragging){var v=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=v}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.Event("dragstart"))),this.fire(new h.Event("drag")))},f.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.Event("dragend")),this._state="inactive"},f.prototype._addDragHandler=function(l){this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},f.prototype.setDraggable=function(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},f.prototype.isDraggable=function(){return this._draggable},f.prototype.setRotation=function(l){return this._rotation=l||0,this._update(),this},f.prototype.getRotation=function(){return this._rotation},f.prototype.setRotationAlignment=function(l){return this._rotationAlignment=l||"auto",this._update(),this},f.prototype.getRotationAlignment=function(){return this._rotationAlignment},f.prototype.setPitchAlignment=function(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this},f.prototype.getPitchAlignment=function(){return this._pitchAlignment},f}(h.Evented),ch={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ku=0,dc=!1,Qc=function(p){function f(l){p.call(this),this.options=h.extend({},ch,l),h.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.onAdd=function(l){var v;return this._map=l,this._container=U.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),v=this._setupUI,Kl!==void 0?v(Kl):h.window.navigator.permissions!==void 0?h.window.navigator.permissions.query({name:"geolocation"}).then(function(E){v(Kl=E.state!=="denied")}):v(Kl=!!h.window.navigator.geolocation),this._container},f.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(h.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),U.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ku=0,dc=!1},f.prototype._isOutOfMapMaxBounds=function(l){var v=this._map.getMaxBounds(),E=l.coords;return v&&(E.longitude<v.getWest()||E.longitude>v.getEast()||E.latitude<v.getSouth()||E.latitude>v.getNorth())},f.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},f.prototype._onSuccess=function(l){if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new h.Event("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("geolocate",l)),this._finish()}},f.prototype._updateCamera=function(l){var v=new h.LngLat(l.coords.longitude,l.coords.latitude),E=l.coords.accuracy,T=this._map.getBearing(),I=h.extend({bearing:T},this.options.fitBoundsOptions);this._map.fitBounds(v.toBounds(E),I,{geolocateSource:!0})},f.prototype._updateMarker=function(l){if(l){var v=new h.LngLat(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(v).addTo(this._map),this._userLocationDotMarker.setLngLat(v).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},f.prototype._updateCircleRadius=function(){var l=this._map._container.clientHeight/2,v=this._map.unproject([0,l]),E=this._map.unproject([1,l]),T=v.distanceTo(E),I=Math.ceil(2*this._accuracy/T);this._circleElement.style.width=I+"px",this._circleElement.style.height=I+"px"},f.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},f.prototype._onError=function(l){if(this._map){if(this.options.trackUserLocation)if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var v=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=v,this._geolocateButton.setAttribute("aria-label",v),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&dc)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("error",l)),this._finish()}},f.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},f.prototype._setupUI=function(l){var v=this;if(this._container.addEventListener("contextmenu",function(I){return I.preventDefault()}),this._geolocateButton=U.create("button","mapboxgl-ctrl-geolocate",this._container),U.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",l===!1){h.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var E=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}else{var T=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=T,this._geolocateButton.setAttribute("aria-label",T)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=U.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Mf(this._dotElement),this._circleElement=U.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Mf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(I){I.geolocateSource||v._watchState!=="ACTIVE_LOCK"||I.originalEvent&&I.originalEvent.type==="resize"||(v._watchState="BACKGROUND",v._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),v._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),v.fire(new h.Event("trackuserlocationend")))})},f.prototype.trigger=function(){if(!this._setup)return h.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ku--,dc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new h.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var l;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++ku>1?(l={maximumAge:6e5,timeout:0},dc=!0):(l=this.options.positionOptions,dc=!1),this._geolocationWatchID=h.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,l)}}else h.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},f.prototype._clearWatch=function(){h.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},f}(h.Evented),pl={maxWidth:100,unit:"metric"},yu=function(f){this.options=h.extend({},pl,f),h.bindAll(["_onMove","setUnit"],this)};function dl(p,f,l){var v=l&&l.maxWidth||100,E=p._container.clientHeight/2,T=p.unproject([0,E]),I=p.unproject([v,E]),k=T.distanceTo(I);if(l&&l.unit==="imperial"){var W=3.2808*k;W>5280?_u(f,v,W/5280,p._getUIString("ScaleControl.Miles")):_u(f,v,W,p._getUIString("ScaleControl.Feet"))}else l&&l.unit==="nautical"?_u(f,v,k/1852,p._getUIString("ScaleControl.NauticalMiles")):k>=1e3?_u(f,v,k/1e3,p._getUIString("ScaleControl.Kilometers")):_u(f,v,k,p._getUIString("ScaleControl.Meters"))}function _u(p,f,l,v){var E,T,I,k=(E=l,(T=Math.pow(10,(""+Math.floor(E)).length-1))*(I=(I=E/T)>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(W){var q=Math.pow(10,Math.ceil(-Math.log(W)/Math.LN10));return Math.round(W*q)/q}(I)));p.style.width=f*(k/l)+"px",p.innerHTML=k+"&nbsp;"+v}yu.prototype.getDefaultPosition=function(){return"bottom-left"},yu.prototype._onMove=function(){dl(this._map,this._container,this.options)},yu.prototype.onAdd=function(p){return this._map=p,this._container=U.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},yu.prototype.onRemove=function(){U.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},yu.prototype.setUnit=function(p){this.options.unit=p,dl(this._map,this._container,this.options)};var xs=function(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof h.window.HTMLElement?this._container=f.container:h.warnOnce("Full screen control 'container' must be a DOM element.")),h.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in h.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in h.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in h.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in h.window.document&&(this._fullscreenchange="MSFullscreenChange")};xs.prototype.onAdd=function(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=U.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",h.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},xs.prototype.onRemove=function(){U.remove(this._controlContainer),this._map=null,h.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},xs.prototype._checkFullscreenSupport=function(){return!!(h.window.document.fullscreenEnabled||h.window.document.mozFullScreenEnabled||h.window.document.msFullscreenEnabled||h.window.document.webkitFullscreenEnabled)},xs.prototype._setupUI=function(){var p=this._fullscreenButton=U.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);U.create("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden",!0),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),h.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},xs.prototype._updateTitle=function(){var p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.title=p},xs.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},xs.prototype._isFullscreen=function(){return this._fullscreen},xs.prototype._changeIcon=function(){(h.window.document.fullscreenElement||h.window.document.mozFullScreenElement||h.window.document.webkitFullscreenElement||h.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},xs.prototype._onClickFullscreen=function(){this._isFullscreen()?h.window.document.exitFullscreen?h.window.document.exitFullscreen():h.window.document.mozCancelFullScreen?h.window.document.mozCancelFullScreen():h.window.document.msExitFullscreen?h.window.document.msExitFullscreen():h.window.document.webkitCancelFullScreen&&h.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var $l={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Rs=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),vc=function(p){function f(l){p.call(this),this.options=h.extend(Object.create($l),l),h.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return p&&(f.__proto__=p),(f.prototype=Object.create(p&&p.prototype)).constructor=f,f.prototype.addTo=function(l){return this._map&&this.remove(),this._map=l,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new h.Event("open")),this},f.prototype.isOpen=function(){return!!this._map},f.prototype.remove=function(){return this._content&&U.remove(this._content),this._container&&(U.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new h.Event("close")),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(l){return this._lngLat=h.LngLat.convert(l),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},f.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},f.prototype.getElement=function(){return this._container},f.prototype.setText=function(l){return this.setDOMContent(h.window.document.createTextNode(l))},f.prototype.setHTML=function(l){var v,E=h.window.document.createDocumentFragment(),T=h.window.document.createElement("body");for(T.innerHTML=l;v=T.firstChild;)E.appendChild(v);return this.setDOMContent(E)},f.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},f.prototype.setMaxWidth=function(l){return this.options.maxWidth=l,this._update(),this},f.prototype.setDOMContent=function(l){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=U.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(l),this._createCloseButton(),this._update(),this._focusFirstElement(),this},f.prototype.addClassName=function(l){this._container&&this._container.classList.add(l)},f.prototype.removeClassName=function(l){this._container&&this._container.classList.remove(l)},f.prototype.setOffset=function(l){return this.options.offset=l,this._update(),this},f.prototype.toggleClassName=function(l){if(this._container)return this._container.classList.toggle(l)},f.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=U.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},f.prototype._onMouseUp=function(l){this._update(l.point)},f.prototype._onMouseMove=function(l){this._update(l.point)},f.prototype._onDrag=function(l){this._update(l.point)},f.prototype._update=function(l){var v=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=U.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=U.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(ve){return v._container.classList.add(ve)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Yl(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||l)){var E=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat),T=this.options.anchor,I=function ve(xe){if(xe){if(typeof xe=="number"){var Ne=Math.round(Math.sqrt(.5*Math.pow(xe,2)));return{center:new h.Point(0,0),top:new h.Point(0,xe),"top-left":new h.Point(Ne,Ne),"top-right":new h.Point(-Ne,Ne),bottom:new h.Point(0,-xe),"bottom-left":new h.Point(Ne,-Ne),"bottom-right":new h.Point(-Ne,-Ne),left:new h.Point(xe,0),right:new h.Point(-xe,0)}}if(xe instanceof h.Point||Array.isArray(xe)){var Re=h.Point.convert(xe);return{center:Re,top:Re,"top-left":Re,"top-right":Re,bottom:Re,"bottom-left":Re,"bottom-right":Re,left:Re,right:Re}}return{center:h.Point.convert(xe.center||[0,0]),top:h.Point.convert(xe.top||[0,0]),"top-left":h.Point.convert(xe["top-left"]||[0,0]),"top-right":h.Point.convert(xe["top-right"]||[0,0]),bottom:h.Point.convert(xe.bottom||[0,0]),"bottom-left":h.Point.convert(xe["bottom-left"]||[0,0]),"bottom-right":h.Point.convert(xe["bottom-right"]||[0,0]),left:h.Point.convert(xe.left||[0,0]),right:h.Point.convert(xe.right||[0,0])}}return ve(new h.Point(0,0))}(this.options.offset);if(!T){var k,W=this._container.offsetWidth,q=this._container.offsetHeight;k=E.y+I.bottom.y<q?["top"]:E.y>this._map.transform.height-q?["bottom"]:[],E.x<W/2?k.push("left"):E.x>this._map.transform.width-W/2&&k.push("right"),T=k.length===0?"bottom":k.join("-")}var he=E.add(I[T]).round();U.setTransform(this._container,gu[T]+" translate("+he.x+"px,"+he.y+"px)"),Tf(this._container,T,"popup")}},f.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var l=this._container.querySelector(Rs);l&&l.focus()}},f.prototype._onClose=function(){this.remove()},f}(h.Evented),Pf={version:h.version,supported:z,setRTLTextPlugin:h.setRTLTextPlugin,getRTLTextPluginStatus:h.getRTLTextPluginStatus,Map:hl,NavigationControl:mu,GeolocateControl:Qc,AttributionControl:So,ScaleControl:yu,FullscreenControl:xs,Popup:vc,Marker:Mf,Style:Ca,LngLat:h.LngLat,LngLatBounds:h.LngLatBounds,Point:h.Point,MercatorCoordinate:h.MercatorCoordinate,Evented:h.Evented,config:h.config,prewarm:function(){tr().acquire(rr)},clearPrewarmedResources:function(){var f=an;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(rr),an=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return h.config.ACCESS_TOKEN},set accessToken(p){h.config.ACCESS_TOKEN=p},get baseApiUrl(){return h.config.API_URL},set baseApiUrl(p){h.config.API_URL=p},get workerCount(){return Lr.workerCount},set workerCount(p){Lr.workerCount=p},get maxParallelImageRequests(){return h.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){h.config.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage:function(f){h.clearTileCache(f)},workerUrl:""};return Pf}),H})},"4cb6":function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.multiBindToService=Z.getServiceIdentifierAsString=Z.typeConstraint=Z.namedConstraint=Z.taggedConstraint=Z.traverseAncerstors=Z.decorate=Z.id=Z.MetadataReader=Z.postConstruct=Z.targetName=Z.multiInject=Z.unmanaged=Z.optional=Z.LazyServiceIdentifer=Z.inject=Z.named=Z.tagged=Z.injectable=Z.ContainerModule=Z.AsyncContainerModule=Z.TargetTypeEnum=Z.BindingTypeEnum=Z.BindingScopeEnum=Z.Container=Z.METADATA_KEY=void 0;var N=w("xfSm");Z.METADATA_KEY=N;var G=w("9Fde");Object.defineProperty(Z,"Container",{enumerable:!0,get:function(){return G.Container}});var H=w("FV85");Object.defineProperty(Z,"BindingScopeEnum",{enumerable:!0,get:function(){return H.BindingScopeEnum}}),Object.defineProperty(Z,"BindingTypeEnum",{enumerable:!0,get:function(){return H.BindingTypeEnum}}),Object.defineProperty(Z,"TargetTypeEnum",{enumerable:!0,get:function(){return H.TargetTypeEnum}});var B=w("dxzI");Object.defineProperty(Z,"AsyncContainerModule",{enumerable:!0,get:function(){return B.AsyncContainerModule}}),Object.defineProperty(Z,"ContainerModule",{enumerable:!0,get:function(){return B.ContainerModule}});var h=w("cZ5Q");Object.defineProperty(Z,"injectable",{enumerable:!0,get:function(){return h.injectable}});var z=w("0gSV");Object.defineProperty(Z,"tagged",{enumerable:!0,get:function(){return z.tagged}});var U=w("ZzCi");Object.defineProperty(Z,"named",{enumerable:!0,get:function(){return U.named}});var Q=w("Yk9n");Object.defineProperty(Z,"inject",{enumerable:!0,get:function(){return Q.inject}}),Object.defineProperty(Z,"LazyServiceIdentifer",{enumerable:!0,get:function(){return Q.LazyServiceIdentifer}});var se=w("jYx5");Object.defineProperty(Z,"optional",{enumerable:!0,get:function(){return se.optional}});var Ce=w("n2J3");Object.defineProperty(Z,"unmanaged",{enumerable:!0,get:function(){return Ce.unmanaged}});var be=w("jIg/");Object.defineProperty(Z,"multiInject",{enumerable:!0,get:function(){return be.multiInject}});var st=w("oaX6");Object.defineProperty(Z,"targetName",{enumerable:!0,get:function(){return st.targetName}});var tt=w("Sk89");Object.defineProperty(Z,"postConstruct",{enumerable:!0,get:function(){return tt.postConstruct}});var ut=w("wnjb");Object.defineProperty(Z,"MetadataReader",{enumerable:!0,get:function(){return ut.MetadataReader}});var ht=w("d9O0");Object.defineProperty(Z,"id",{enumerable:!0,get:function(){return ht.id}});var gt=w("Ztfv");Object.defineProperty(Z,"decorate",{enumerable:!0,get:function(){return gt.decorate}});var Be=w("RR/i");Object.defineProperty(Z,"traverseAncerstors",{enumerable:!0,get:function(){return Be.traverseAncerstors}}),Object.defineProperty(Z,"taggedConstraint",{enumerable:!0,get:function(){return Be.taggedConstraint}}),Object.defineProperty(Z,"namedConstraint",{enumerable:!0,get:function(){return Be.namedConstraint}}),Object.defineProperty(Z,"typeConstraint",{enumerable:!0,get:function(){return Be.typeConstraint}});var dt=w("ujMp");Object.defineProperty(Z,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return dt.getServiceIdentifierAsString}});var rt=w("78VC");Object.defineProperty(Z,"multiBindToService",{enumerable:!0,get:function(){return rt.multiBindToService}})},"4qC0":function(ae,Z,w){var N=w("NykK"),G=w("Z0cm"),H=w("ExA7"),B="[object String]";function h(z){return typeof z=="string"||!G(z)&&H(z)&&N(z)==B}ae.exports=h},"5Tg0":function(ae,Z,w){(function(N){var G=w("Kz5y"),H=Z&&!Z.nodeType&&Z,B=H&&typeof N=="object"&&N&&!N.nodeType&&N,h=B&&B.exports===H,z=h?G.Buffer:void 0,U=z?z.allocUnsafe:void 0;function Q(se,Ce){if(Ce)return se.slice();var be=se.length,st=U?U(be):new se.constructor(be);return se.copy(st),st}N.exports=Q}).call(this,w("hOG+")(ae))},"68d/":function(ae,Z,w){"use strict";w.d(Z,"b",function(){return y4}),w.d(Z,"c",function(){return CD}),w.d(Z,"a",function(){return AD});var N={};w.r(N),w.d(N,"getContainer",function(){return Zs}),w.d(N,"trim",function(){return Xl}),w.d(N,"splitWords",function(){return Il}),w.d(N,"create",function(){return Xs}),w.d(N,"remove",function(){return Cf}),w.d(N,"addClass",function(){return mn}),w.d(N,"removeClass",function(){return Rl}),w.d(N,"hasClass",function(){return bo}),w.d(N,"setClass",function(){return fc}),w.d(N,"getClass",function(){return Is}),w.d(N,"empty",function(){return Uo}),w.d(N,"setTransform",function(){return Kc}),w.d(N,"triggerResize",function(){return qs}),w.d(N,"printCanvas",function(){return cl}),w.d(N,"getViewPortScale",function(){return lh}),w.d(N,"DPR",function(){return $c});var G={};w.r(G),w.d(G,"sum",function(){return Oi}),w.d(G,"max",function(){return Rn}),w.d(G,"min",function(){return bi}),w.d(G,"mean",function(){return Qn}),w.d(G,"mode",function(){return Ri}),w.d(G,"statMap",function(){return si}),w.d(G,"getColumn",function(){return Di}),w.d(G,"getSatByColumn",function(){return $i});var H={};w.r(H),w.d(H,"create",function(){return vv}),w.d(H,"clone",function(){return _d}),w.d(H,"copy",function(){return mv}),w.d(H,"identity",function(){return gv}),w.d(H,"fromValues",function(){return vh}),w.d(H,"set",function(){return Pp}),w.d(H,"transpose",function(){return Op}),w.d(H,"invert",function(){return mh}),w.d(H,"adjoint",function(){return Na}),w.d(H,"determinant",function(){return xd}),w.d(H,"multiply",function(){return xl}),w.d(H,"rotate",function(){return jf}),w.d(H,"scale",function(){return K}),w.d(H,"fromRotation",function(){return ue}),w.d(H,"fromScaling",function(){return He}),w.d(H,"str",function(){return Ht}),w.d(H,"frob",function(){return hr}),w.d(H,"LDU",function(){return ar}),w.d(H,"add",function(){return Jt}),w.d(H,"subtract",function(){return Pr}),w.d(H,"exactEquals",function(){return jr}),w.d(H,"equals",function(){return Vr}),w.d(H,"multiplyScalar",function(){return Yr}),w.d(H,"multiplyScalarAndAdd",function(){return Wr}),w.d(H,"mul",function(){return pn}),w.d(H,"sub",function(){return on});var B={};w.r(B),w.d(B,"create",function(){return zr}),w.d(B,"clone",function(){return Gt}),w.d(B,"copy",function(){return Wt}),w.d(B,"fromValues",function(){return Br}),w.d(B,"set",function(){return Tn}),w.d(B,"identity",function(){return cr}),w.d(B,"transpose",function(){return kn}),w.d(B,"invert",function(){return Mn}),w.d(B,"adjoint",function(){return qr}),w.d(B,"determinant",function(){return yr}),w.d(B,"multiply",function(){return ir}),w.d(B,"translate",function(){return tn}),w.d(B,"scale",function(){return sn}),w.d(B,"rotate",function(){return Zr}),w.d(B,"rotateX",function(){return dn}),w.d(B,"rotateY",function(){return fn}),w.d(B,"rotateZ",function(){return Ii}),w.d(B,"fromTranslation",function(){return Si}),w.d(B,"fromScaling",function(){return gn}),w.d(B,"fromRotation",function(){return bn}),w.d(B,"fromXRotation",function(){return fi}),w.d(B,"fromYRotation",function(){return wi}),w.d(B,"fromZRotation",function(){return qi}),w.d(B,"fromRotationTranslation",function(){return $a}),w.d(B,"fromQuat2",function(){return yo}),w.d(B,"getTranslation",function(){return Qi}),w.d(B,"getScaling",function(){return es}),w.d(B,"getRotation",function(){return Ha}),w.d(B,"fromRotationTranslationScale",function(){return Ho}),w.d(B,"fromRotationTranslationScaleOrigin",function(){return Lo}),w.d(B,"fromQuat",function(){return cs}),w.d(B,"frustum",function(){return fs}),w.d(B,"perspectiveNO",function(){return hs}),w.d(B,"perspective",function(){return io}),w.d(B,"perspectiveZO",function(){return zi}),w.d(B,"perspectiveFromFieldOfView",function(){return Wo}),w.d(B,"orthoNO",function(){return da}),w.d(B,"ortho",function(){return Do}),w.d(B,"orthoZO",function(){return vi}),w.d(B,"lookAt",function(){return Fi}),w.d(B,"targetTo",function(){return ka}),w.d(B,"str",function(){return Ns}),w.d(B,"frob",function(){return Ss}),w.d(B,"add",function(){return Fe}),w.d(B,"subtract",function(){return er}),w.d(B,"multiplyScalar",function(){return Lt}),w.d(B,"multiplyScalarAndAdd",function(){return On}),w.d(B,"exactEquals",function(){return Vi}),w.d(B,"equals",function(){return Me}),w.d(B,"mul",function(){return ge}),w.d(B,"sub",function(){return qe});var h={};w.r(h),w.d(h,"create",function(){return At}),w.d(h,"clone",function(){return Yt}),w.d(h,"fromValues",function(){return it}),w.d(h,"copy",function(){return Qe}),w.d(h,"set",function(){return ft}),w.d(h,"add",function(){return ye}),w.d(h,"subtract",function(){return Ke}),w.d(h,"multiply",function(){return Pe}),w.d(h,"divide",function(){return bt}),w.d(h,"ceil",function(){return zt}),w.d(h,"floor",function(){return Or}),w.d(h,"min",function(){return un}),w.d(h,"max",function(){return ln}),w.d(h,"round",function(){return En}),w.d(h,"scale",function(){return rn}),w.d(h,"scaleAndAdd",function(){return Zn}),w.d(h,"distance",function(){return Pn}),w.d(h,"squaredDistance",function(){return zn}),w.d(h,"length",function(){return jn}),w.d(h,"squaredLength",function(){return Vn}),w.d(h,"negate",function(){return pi}),w.d(h,"inverse",function(){return ya}),w.d(h,"normalize",function(){return ts}),w.d(h,"dot",function(){return Su}),w.d(h,"cross",function(){return Fl}),w.d(h,"lerp",function(){return La}),w.d(h,"random",function(){return ra}),w.d(h,"transformMat2",function(){return bl}),w.d(h,"transformMat2d",function(){return Bu}),w.d(h,"transformMat3",function(){return Ip}),w.d(h,"transformMat4",function(){return el}),w.d(h,"rotate",function(){return Rp}),w.d(h,"angle",function(){return yv}),w.d(h,"zero",function(){return gh}),w.d(h,"str",function(){return yh}),w.d(h,"exactEquals",function(){return mm}),w.d(h,"equals",function(){return rs}),w.d(h,"len",function(){return kp}),w.d(h,"sub",function(){return lf}),w.d(h,"mul",function(){return bd}),w.d(h,"div",function(){return Ed}),w.d(h,"dist",function(){return _v}),w.d(h,"sqrDist",function(){return Wh}),w.d(h,"sqrLen",function(){return cf}),w.d(h,"forEach",function(){return gm});var z={};w.r(z),w.d(z,"create",function(){return xv}),w.d(z,"clone",function(){return $0}),w.d(z,"length",function(){return ps}),w.d(z,"fromValues",function(){return Vf}),w.d(z,"copy",function(){return ym}),w.d(z,"set",function(){return a}),w.d(z,"add",function(){return o}),w.d(z,"subtract",function(){return u}),w.d(z,"multiply",function(){return d}),w.d(z,"divide",function(){return y}),w.d(z,"ceil",function(){return b}),w.d(z,"floor",function(){return C}),w.d(z,"min",function(){return P}),w.d(z,"max",function(){return D}),w.d(z,"round",function(){return j}),w.d(z,"scale",function(){return X}),w.d(z,"scaleAndAdd",function(){return ee}),w.d(z,"distance",function(){return te}),w.d(z,"squaredDistance",function(){return Ee}),w.d(z,"squaredLength",function(){return Le}),w.d(z,"negate",function(){return Oe}),w.d(z,"inverse",function(){return We}),w.d(z,"normalize",function(){return Ze}),w.d(z,"dot",function(){return yt}),w.d(z,"cross",function(){return Dt}),w.d(z,"lerp",function(){return Xt}),w.d(z,"hermite",function(){return mr}),w.d(z,"bezier",function(){return sr}),w.d(z,"random",function(){return Qr}),w.d(z,"transformMat4",function(){return nn}),w.d(z,"transformMat3",function(){return Gn}),w.d(z,"transformQuat",function(){return ei}),w.d(z,"rotateX",function(){return $n}),w.d(z,"rotateY",function(){return Bn}),w.d(z,"rotateZ",function(){return Ti}),w.d(z,"angle",function(){return ui}),w.d(z,"zero",function(){return ti}),w.d(z,"str",function(){return na}),w.d(z,"exactEquals",function(){return ki}),w.d(z,"equals",function(){return xa}),w.d(z,"sub",function(){return gi}),w.d(z,"mul",function(){return ua}),w.d(z,"div",function(){return qa}),w.d(z,"dist",function(){return Xa}),w.d(z,"sqrDist",function(){return lo}),w.d(z,"len",function(){return co}),w.d(z,"sqrLen",function(){return Ao}),w.d(z,"forEach",function(){return zs});var U={};w.r(U),w.d(U,"create",function(){return Fo}),w.d(U,"clone",function(){return eu}),w.d(U,"fromValues",function(){return Cs}),w.d(U,"copy",function(){return tu}),w.d(U,"set",function(){return ds}),w.d(U,"add",function(){return ns}),w.d(U,"subtract",function(){return is}),w.d(U,"multiply",function(){return ca}),w.d(U,"divide",function(){return oa}),w.d(U,"ceil",function(){return za}),w.d(U,"floor",function(){return Ya}),w.d(U,"min",function(){return ru}),w.d(U,"max",function(){return Qa}),w.d(U,"round",function(){return fo}),w.d(U,"scale",function(){return Us}),w.d(U,"scaleAndAdd",function(){return fa}),w.d(U,"distance",function(){return wc}),w.d(U,"squaredDistance",function(){return tl}),w.d(U,"length",function(){return Bl}),w.d(U,"squaredLength",function(){return Nu}),w.d(U,"negate",function(){return js}),w.d(U,"inverse",function(){return ff}),w.d(U,"normalize",function(){return hf}),w.d(U,"dot",function(){return pf}),w.d(U,"cross",function(){return Lp}),w.d(U,"lerp",function(){return Tc}),w.d(U,"random",function(){return Dp}),w.d(U,"transformMat4",function(){return Zh}),w.d(U,"transformQuat",function(){return Xh}),w.d(U,"zero",function(){return Sd}),w.d(U,"str",function(){return Fp}),w.d(U,"exactEquals",function(){return Cd}),w.d(U,"equals",function(){return Gf}),w.d(U,"sub",function(){return Yh}),w.d(U,"mul",function(){return Ad}),w.d(U,"div",function(){return Kh}),w.d(U,"dist",function(){return Hf}),w.d(U,"sqrDist",function(){return Bp}),w.d(U,"len",function(){return wd}),w.d(U,"sqrLen",function(){return Td}),w.d(U,"forEach",function(){return $h});var Q=w("q1tI"),se=w.n(Q),Ce=Object(Q.createContext)({});function be(){return Object(Q.useContext)(Ce)}var st={},tt={},ut=function(r){return tt[r]},ht=function(r,t){tt[r]=t},gt=function(r){return st[r]},Be=function(r,t){st[r]=t},dt={},rt={},lt=34,$=10,Qt=13;function Ir(e){return new Function("d","return {"+e.map(function(r,t){return JSON.stringify(r)+": d["+t+'] || ""'}).join(",")+"}")}function br(e,r){var t=Ir(e);return function(n,i){return r(t(n),i,e)}}function Rt(e){var r=Object.create(null),t=[];return e.forEach(function(n){for(var i in n)i in r||t.push(r[i]=i)}),t}function ke(e,r){var t=e+"",n=t.length;return n<r?new Array(r-n+1).join(0)+t:t}function Mt(e){return e<0?"-"+ke(-e,6):e>9999?"+"+ke(e,6):ke(e,4)}function Nt(e){var r=e.getUTCHours(),t=e.getUTCMinutes(),n=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Mt(e.getUTCFullYear(),4)+"-"+ke(e.getUTCMonth()+1,2)+"-"+ke(e.getUTCDate(),2)+(i?"T"+ke(r,2)+":"+ke(t,2)+":"+ke(n,2)+"."+ke(i,3)+"Z":n?"T"+ke(r,2)+":"+ke(t,2)+":"+ke(n,2)+"Z":t||r?"T"+ke(r,2)+":"+ke(t,2)+"Z":"")}var nr=function(e){var r=new RegExp('["'+e+`
\r]`),t=e.charCodeAt(0);function n(M,R){var F,Y,ie=i(M,function(le,Ae){if(F)return F(le,Ae-1);Y=le,F=R?br(le,R):Ir(le)});return ie.columns=Y||[],ie}function i(M,R){var F=[],Y=M.length,ie=0,le=0,Ae,Xe=Y<=0,nt=!1;M.charCodeAt(Y-1)===$&&--Y,M.charCodeAt(Y-1)===Qt&&--Y;function at(){if(Xe)return rt;if(nt)return nt=!1,dt;var Ot,Ut=ie,$t;if(M.charCodeAt(Ut)===lt){for(;ie++<Y&&M.charCodeAt(ie)!==lt||M.charCodeAt(++ie)===lt;);return(Ot=ie)>=Y?Xe=!0:($t=M.charCodeAt(ie++))===$?nt=!0:$t===Qt&&(nt=!0,M.charCodeAt(ie)===$&&++ie),M.slice(Ut+1,Ot-1).replace(/""/g,'"')}for(;ie<Y;){if(($t=M.charCodeAt(Ot=ie++))===$)nt=!0;else if($t===Qt)nt=!0,M.charCodeAt(ie)===$&&++ie;else if($t!==t)continue;return M.slice(Ut,Ot)}return Xe=!0,M.slice(Ut,Y)}for(;(Ae=at())!==rt;){for(var It=[];Ae!==dt&&Ae!==rt;)It.push(Ae),Ae=at();R&&(It=R(It,le++))==null||F.push(It)}return F}function s(M,R){return M.map(function(F){return R.map(function(Y){return A(F[Y])}).join(e)})}function c(M,R){return R==null&&(R=Rt(M)),[R.map(A).join(e)].concat(s(M,R)).join(`
`)}function m(M,R){return R==null&&(R=Rt(M)),s(M,R).join(`
`)}function g(M){return M.map(x).join(`
`)}function x(M){return M.map(A).join(e)}function A(M){return M==null?"":M instanceof Date?Nt(M):r.test(M+="")?'"'+M.replace(/"/g,'""')+'"':M}return{parse:n,parseRows:i,format:c,formatBody:m,formatRows:g,formatRow:x,formatValue:A}},Mr=nr(","),Jr=Mr.parse,Er=Mr.parseRows,de=Mr.format,Ie=Mr.formatBody,we=Mr.formatRows,ct=Mr.formatRow,ot=Mr.formatValue,wt=w("lSNA"),S=w.n(wt),ur=w("RIqP"),Pt=w.n(ur),Ft=w("Aib3"),Et=w.n(Ft);function St(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Zt(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?St(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):St(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function dr(e,r){var t=r.x,n=r.y,i=r.x1,s=r.y1,c=r.coordinates,m=[];return e.forEach(function(g,x){var A=[];if(t&&n&&(A=[parseFloat(g[t]),parseFloat(g[n])]),t&&n&&i&&s){var M=[parseFloat(g[t]),parseFloat(g[n])],R=[parseFloat(g[i]),parseFloat(g[s])];A=[M,R]}if(c){var F="Polygon";Array.isArray(c[0])||(F="Point"),Array.isArray(c[0])&&!Array.isArray(c[0][0])&&(F="LineString");var Y={type:F,coordinates:Pt()(g[c])};Et()(Y,!0),A=Y.coordinates}var ie=Zt(Zt({},g),{},{_id:x,coordinates:A});m.push(ie)}),{dataArray:m}}var qt=[{lng1:100,lat1:30,lng2:130,lat2:30}],pr={parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}};function Ur(e,r){var t=Jr(e);return dr(t,r)}var gr=63710088e-1,or={centimeters:gr*100,centimetres:gr*100,degrees:gr/111325,feet:gr*3.28084,inches:gr*39.37,kilometers:gr/1e3,kilometres:gr/1e3,meters:gr,metres:gr,miles:gr/1609.344,millimeters:gr*1e3,millimetres:gr*1e3,nauticalmiles:gr/1852,radians:1,yards:gr*1.0936},Rr={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/gr,yards:1.0936133},Hn={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function en(e,r,t){t===void 0&&(t={});var n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=r||{},n.geometry=e,n}function _n(e,r,t){switch(t===void 0&&(t={}),e){case"Point":return qn(r).geometry;case"LineString":return yn(r).geometry;case"Polygon":return Xi(r).geometry;case"MultiPoint":return jt(r).geometry;case"MultiLineString":return os(r).geometry;case"MultiPolygon":return _r(r).geometry;default:throw new Error(e+" is invalid")}}function qn(e,r,t){if(t===void 0&&(t={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ma(e[0])||!Ma(e[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:e};return en(n,r,t)}function ii(e,r,t){return t===void 0&&(t={}),Mo(e.map(function(n){return qn(n,r)}),t)}function Xi(e,r,t){t===void 0&&(t={});for(var n=0,i=e;n<i.length;n++){var s=i[n];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var c=0;c<s[s.length-1].length;c++)if(s[s.length-1][c]!==s[0][c])throw new Error("First and last Position are not equivalent.")}var m={type:"Polygon",coordinates:e};return en(m,r,t)}function me(e,r,t){return t===void 0&&(t={}),Mo(e.map(function(n){return Xi(n,r)}),t)}function yn(e,r,t){if(t===void 0&&(t={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:e};return en(n,r,t)}function Bi(e,r,t){return t===void 0&&(t={}),Mo(e.map(function(n){return yn(n,r)}),t)}function Mo(e,r){r===void 0&&(r={});var t={type:"FeatureCollection"};return r.id&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.features=e,t}function os(e,r,t){t===void 0&&(t={});var n={type:"MultiLineString",coordinates:e};return en(n,r,t)}function jt(e,r,t){t===void 0&&(t={});var n={type:"MultiPoint",coordinates:e};return en(n,r,t)}function _r(e,r,t){t===void 0&&(t={});var n={type:"MultiPolygon",coordinates:e};return en(n,r,t)}function Xr(e,r,t){t===void 0&&(t={});var n={type:"GeometryCollection",geometries:e};return en(n,r,t)}function vn(e,r){if(r===void 0&&(r=0),r&&!(r>=0))throw new Error("precision must be a positive number");var t=Math.pow(10,r||0);return Math.round(e*t)/t}function Kr(e,r){r===void 0&&(r="kilometers");var t=or[r];if(!t)throw new Error(r+" units is invalid");return e*t}function ba(e,r){r===void 0&&(r="kilometers");var t=or[r];if(!t)throw new Error(r+" units is invalid");return e/t}function li(e,r){return ci(ba(e,r))}function Xn(e){var r=e%360;return r<0&&(r+=360),r}function ci(e){var r=e%(2*Math.PI);return r*180/Math.PI}function Hi(e){var r=e%360;return r*Math.PI/180}function Yi(e,r,t){if(r===void 0&&(r="kilometers"),t===void 0&&(t="kilometers"),!(e>=0))throw new Error("length must be a positive number");return Kr(ba(e,r),t)}function No(e,r,t){if(r===void 0&&(r="meters"),t===void 0&&(t="kilometers"),!(e>=0))throw new Error("area must be a positive number");var n=Hn[r];if(!n)throw new Error("invalid original units");var i=Hn[t];if(!i)throw new Error("invalid final units");return e/n*i}function Ma(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function ma(e){return!!e&&e.constructor===Object}function Hs(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(r){if(!Ma(r))throw new Error("bbox must only contain numbers")})}function il(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}function ja(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function re(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function J(e){if(e.length>1&&Ma(e[0])&&Ma(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return J(e[0]);throw new Error("coordinates must only contain numbers")}function pe(e,r,t){if(!r||!t)throw new Error("type and name required");if(!e||e.type!==r)throw new Error("Invalid input to "+t+": must be a "+r+", given "+e.type)}function Se(e,r,t){if(!e)throw new Error("No feature passed");if(!t)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!e.geometry||e.geometry.type!==r)throw new Error("Invalid input to "+t+": must be a "+r+", given "+e.geometry.type)}function De(e,r,t){if(!e)throw new Error("No featureCollection passed");if(!t)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+t+", FeatureCollection required");for(var n=0,i=e.features;n<i.length;n++){var s=i[n];if(!s||s.type!=="Feature"||!s.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!s.geometry||s.geometry.type!==r)throw new Error("Invalid input to "+t+": must be a "+r+", given "+s.geometry.type)}}function et(e){return e.type==="Feature"?e.geometry:e}function vt(e,r){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}function _e(e,r,t){if(e!==null)for(var n,i,s,c,m,g,x,A=0,M=0,R,F=e.type,Y=F==="FeatureCollection",ie=F==="Feature",le=Y?e.features.length:1,Ae=0;Ae<le;Ae++){x=Y?e.features[Ae].geometry:ie?e.geometry:e,R=x?x.type==="GeometryCollection":!1,m=R?x.geometries.length:1;for(var Xe=0;Xe<m;Xe++){var nt=0,at=0;if(c=R?x.geometries[Xe]:x,c!==null){g=c.coordinates;var It=c.type;switch(A=t&&(It==="Polygon"||It==="MultiPolygon")?1:0,It){case null:break;case"Point":if(r(g,M,Ae,nt,at)===!1)return!1;M++,nt++;break;case"LineString":case"MultiPoint":for(n=0;n<g.length;n++){if(r(g[n],M,Ae,nt,at)===!1)return!1;M++,It==="MultiPoint"&&nt++}It==="LineString"&&nt++;break;case"Polygon":case"MultiLineString":for(n=0;n<g.length;n++){for(i=0;i<g[n].length-A;i++){if(r(g[n][i],M,Ae,nt,at)===!1)return!1;M++}It==="MultiLineString"&&nt++,It==="Polygon"&&at++}It==="Polygon"&&nt++;break;case"MultiPolygon":for(n=0;n<g.length;n++){for(at=0,i=0;i<g[n].length;i++){for(s=0;s<g[n][i].length-A;s++){if(r(g[n][i][s],M,Ae,nt,at)===!1)return!1;M++}at++}nt++}break;case"GeometryCollection":for(n=0;n<c.geometries.length;n++)if(_e(c.geometries[n],r,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function je(e,r,t,n){var i=t;return _e(e,function(s,c,m,g,x){c===0&&t===void 0?i=s:i=r(i,s,c,m,g,x)},n),i}function $e(e,r){var t;switch(e.type){case"FeatureCollection":for(t=0;t<e.features.length&&r(e.features[t].properties,t)!==!1;t++);break;case"Feature":r(e.properties,0);break}}function Ar(e,r,t){var n=t;return $e(e,function(i,s){s===0&&t===void 0?n=i:n=r(n,i,s)}),n}function kr(e,r){if(e.type==="Feature")r(e,0);else if(e.type==="FeatureCollection")for(var t=0;t<e.features.length&&r(e.features[t],t)!==!1;t++);}function rr(e,r,t){var n=t;return kr(e,function(i,s){s===0&&t===void 0?n=i:n=r(n,i,s)}),n}function Lr(e){var r=[];return _e(e,function(t){r.push(t)}),r}function an(e,r){var t,n,i,s,c,m,g,x,A,M,R=0,F=e.type==="FeatureCollection",Y=e.type==="Feature",ie=F?e.features.length:1;for(t=0;t<ie;t++){for(m=F?e.features[t].geometry:Y?e.geometry:e,x=F?e.features[t].properties:Y?e.properties:{},A=F?e.features[t].bbox:Y?e.bbox:void 0,M=F?e.features[t].id:Y?e.id:void 0,g=m?m.type==="GeometryCollection":!1,c=g?m.geometries.length:1,i=0;i<c;i++){if(s=g?m.geometries[i]:m,s===null){if(r(null,R,x,A,M)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(r(s,R,x,A,M)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<s.geometries.length;n++)if(r(s.geometries[n],R,x,A,M)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}R++}}function An(e,r,t){var n=t;return an(e,function(i,s,c,m,g){s===0&&t===void 0?n=i:n=r(n,i,s,c,m,g)}),n}function tr(e,r){an(e,function(t,n,i,s,c){var m=t===null?null:t.type;switch(m){case null:case"Point":case"LineString":case"Polygon":return r(en(t,i,{bbox:s,id:c}),n,0)===!1?!1:void 0}var g;switch(m){case"MultiPoint":g="Point";break;case"MultiLineString":g="LineString";break;case"MultiPolygon":g="Polygon";break}for(var x=0;x<t.coordinates.length;x++){var A=t.coordinates[x],M={type:g,coordinates:A};if(r(en(M,i),n,x)===!1)return!1}})}function Cn(e,r,t){var n=t;return tr(e,function(i,s,c){s===0&&c===0&&t===void 0?n=i:n=r(n,i,s,c)}),n}function hn(e,r){tr(e,function(t,n,i){var s=0;if(!!t.geometry){var c=t.geometry.type;if(!(c==="Point"||c==="MultiPoint")){var m,g=0,x=0,A=0;if(_e(t,function(M,R,F,Y,ie){if(m===void 0||n>g||Y>x||ie>A){m=M,g=n,x=Y,A=ie,s=0;return}var le=yn([m,M],t.properties);if(r(le,n,i,ie,s)===!1)return!1;s++,m=M})===!1)return!1}}})}function xn(e,r,t){var n=t,i=!1;return hn(e,function(s,c,m,g,x){i===!1&&t===void 0?n=s:n=r(n,s,c,m,g,x),i=!0}),n}function _i(e,r){if(!e)throw new Error("geojson is required");tr(e,function(t,n,i){if(t.geometry!==null){var s=t.geometry.type,c=t.geometry.coordinates;switch(s){case"LineString":if(r(t,n,i,0,0)===!1)return!1;break;case"Polygon":for(var m=0;m<c.length;m++)if(r(yn(c[m],t.properties),n,i,m)===!1)return!1;break}}})}function wn(e,r,t){var n=t;return _i(e,function(i,s,c,m){s===0&&t===void 0?n=i:n=r(n,i,s,c,m)}),n}function Ni(e,r){if(r=r||{},!ma(r))throw new Error("options is invalid");var t=r.featureIndex||0,n=r.multiFeatureIndex||0,i=r.geometryIndex||0,s=r.segmentIndex||0,c=r.properties,m;switch(e.type){case"FeatureCollection":t<0&&(t=e.features.length+t),c=c||e.features[t].properties,m=e.features[t].geometry;break;case"Feature":c=c||e.properties,m=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":m=e;break;default:throw new Error("geojson is invalid")}if(m===null)return null;var g=m.coordinates;switch(m.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=g.length+s-1),yn([g[s],g[s+1]],c,r);case"Polygon":return i<0&&(i=g.length+i),s<0&&(s=g[i].length+s-1),yn([g[i][s],g[i][s+1]],c,r);case"MultiLineString":return n<0&&(n=g.length+n),s<0&&(s=g[n].length+s-1),yn([g[n][s],g[n][s+1]],c,r);case"MultiPolygon":return n<0&&(n=g.length+n),i<0&&(i=g[n].length+i),s<0&&(s=g[n][i].length-s-1),yn([g[n][i][s],g[n][i][s+1]],c,r)}throw new Error("geojson is invalid")}function Ki(e,r){if(r=r||{},!ma(r))throw new Error("options is invalid");var t=r.featureIndex||0,n=r.multiFeatureIndex||0,i=r.geometryIndex||0,s=r.coordIndex||0,c=r.properties,m;switch(e.type){case"FeatureCollection":t<0&&(t=e.features.length+t),c=c||e.features[t].properties,m=e.features[t].geometry;break;case"Feature":c=c||e.properties,m=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":m=e;break;default:throw new Error("geojson is invalid")}if(m===null)return null;var g=m.coordinates;switch(m.type){case"Point":return qn(g,c,r);case"MultiPoint":return n<0&&(n=g.length+n),qn(g[n],c,r);case"LineString":return s<0&&(s=g.length+s),qn(g[s],c,r);case"Polygon":return i<0&&(i=g.length+i),s<0&&(s=g[i].length+s),qn(g[i][s],c,r);case"MultiLineString":return n<0&&(n=g.length+n),s<0&&(s=g[n].length+s),qn(g[n][s],c,r);case"MultiPolygon":return n<0&&(n=g.length+n),i<0&&(i=g[n].length+i),s<0&&(s=g[n][i].length-s),qn(g[n][i][s],c,r)}throw new Error("geojson is invalid")}function Mi(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Fn(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Mi(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Mi(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Ui(e,r){var t=[],n={};if(e.features=e.features.filter(function(s){var c=s.geometry;return s!=null&&c&&c.type&&c.coordinates&&c.coordinates.length>0}),Et()(e,!0),e.features.length===0)return{dataArray:[],featureKeys:n};var i=0;return tr(e,function(s,c){var m=re(s),g=c,x=Fn(Fn({},s.properties),{},{coordinates:m,_id:g});t.push(x)}),{dataArray:t,featureKeys:n}}function zo(e){var r=131,t=137,n=0;e+="x";for(var i=Math.floor(9007199254740991/t),s=0;s<e.length;s++)n>i&&(n=Math.floor(n/t)),n=n*r+e.charCodeAt(s);return n}function ia(e){e=e.toString();for(var r=5381,t=e.length;t;)r=r*33^e.charCodeAt(--t);return r>>>0}var Ka=w("J4zp"),ri=w.n(Ka),Ai="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function xi(e){this.message=e}xi.prototype=new Error,xi.prototype.name="InvalidCharacterError";function to(e){var r=String(e).replace(/=+$/,"");if(r.length%4==1)throw new xi("'atob' failed: The string to be decoded is not correctly encoded.");for(var t="",n=0,i,s,c=0;s=r.charAt(c++);~s&&(i=n%4?i*64+s:s,n++%4)?t+=String.fromCharCode(255&i>>(-2*n&6)):0)s=Ai.indexOf(s);return t}function ao(e){e=String(e);for(var r,t,n,i,s="",c=0,m=e.length%3;c<e.length;){if((t=e.charCodeAt(c++))>255||(n=e.charCodeAt(c++))>255||(i=e.charCodeAt(c++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");r=t<<16|n<<8|i,s+=Ai.charAt(r>>18&63)+Ai.charAt(r>>12&63)+Ai.charAt(r>>6&63)+Ai.charAt(r&63)}return m?s.slice(0,m-3)+"===".substring(m):s}var Ea=w("lwsE"),Ct=w.n(Ea),ss=w("W8MJ"),Bt=w.n(ss),wa=function(){function e(r,t){Ct()(this,e),this.buffers=r,this.type=t}return Bt()(e,[{key:"arraybuffer",value:function(){return Promise.resolve(this.buffers[0])}},{key:"stream",value:function(){throw new Error("not implemented")}},{key:"text",value:function(){throw new Error("not implemented")}},{key:"slice",value:function(t,n,i){throw new Error("not implemented")}}]),e}(),ro;typeof window=="undefined"?ro={devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(r){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(r){return null},clearMeasures:function(r){return null},clearMarks:function(r){return null},measure:function(r,t,n){return{duration:0}},now:function(){return new Date().getTime()}},Blob:"",dispatchEvent:function(r){return!0},Event:function(r,t){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:ro=window;var Pa=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Ta=Pa?my.getSystemInfoSync().pixelRatio:ro.devicePixelRatio,Po=w("7W2i"),Nr=w.n(Po),Xo=w("a1gu"),$r=w.n(Xo),Oo=w("Nsbk"),mt=w.n(Oo),wu=Bt()(function e(r,t){Ct()(this,e),S()(this,"cancelBubble",void 0),S()(this,"cancelable",void 0),S()(this,"target",void 0),S()(this,"currentTarget",void 0),S()(this,"preventDefault",void 0),S()(this,"stopPropagation",void 0),S()(this,"type",void 0),S()(this,"timeStamp",void 0),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=r,this.timeStamp=Date.now()}),ms=w("PJYZ"),oe=w.n(ms);function Ws(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Io(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function Io(e,r){if(!!e){if(typeof e=="string")return xo(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xo(e,r)}}function xo(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Ve=new WeakMap,fe=function(){function e(){Ct()(this,e),Ve.set(this,{})}return Bt()(e,[{key:"addEventListener",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=Ve.get(this);s||(s={}),s[t]||(s[t]=[]),s[t].push(n),Ve.set(this,s),i.capture,i.once,i.passive}},{key:"removeEventListener",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=Ve.get(this);if(s){var c=s[t];if(c&&c.length>0){for(var m=c.length;m--;m>0)if(c[m]===n){c.splice(m,1);break}}}}},{key:"dispatchEvent",value:function(t){var n=Ve.get(this)[t.type];if(n){var i=Ws(n),s;try{for(i.s();!(s=i.n()).done;){var c=s.value;c(t)}}catch(m){i.e(m)}finally{i.f()}}}}]),e}();function Ue(e){var r=kt();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function kt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Gr=function(e){Nr()(t,e);var r=Ue(t);function t(){var n;return Ct()(this,t),n=r.call(this),S()(oe()(n),"childNodes",void 0),n.childNodes=[],n}return Bt()(t,[{key:"appendChild",value:function(i){this.childNodes.push(i)}},{key:"cloneNode",value:function(){var i=Object.create(this);return Object.assign(i,this),i}},{key:"removeChild",value:function(i){var s=this.childNodes.findIndex(function(c){return c===i});return s>-1?this.childNodes.splice(s,1):null}}]),t}(fe);function In(e){var r=Li();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Li(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Oa=function(e){Nr()(t,e);var r=In(t);function t(){var n;return Ct()(this,t),n=r.call(this),S()(oe()(n),"className",void 0),S()(oe()(n),"children",void 0),n.className="",n.children=[],n}return Bt()(t,[{key:"setAttribute",value:function(i,s){this[i]=s}},{key:"getAttribute",value:function(i){return this[i]}},{key:"setAttributeNS",value:function(i,s){this[i]=s}},{key:"getAttributeNS",value:function(i){return this[i]}}]),t}(Gr),Sa=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Ia,oo,Cl,gs;if(Sa){var ho=my.getSystemInfoSync();Ia=ho.screenWidth,oo=ho.screenHeight,Cl=ho.windowWidth,gs=ho.windowHeight}else{var us=ro.innerWidth,Ts=ro.innerHeight;Ia=us,oo=Ts,Cl=us,gs=Ts}var Ms={width:Ia,height:oo,availWidth:Cl,availHeight:gs,availLeft:0,availTop:0},Yo=Ms.availWidth,au=Ms.availHeight,Ps={style:[]};function Ca(e,r){if(!("parentNode"in e)){var t;r===0?t=function(){return null}:r===1?t=function(){return Ps}:t=function(){return null},Object.defineProperty(e,"parentNode",{enumerable:!0,get:t})}if(!("parentElement"in e)){var n;r===0?n=function(){return null}:r===1?n=function(){return Ps}:n=function(){return null},Object.defineProperty(e,"parentElement",{enumerable:!0,get:n})}}function Va(e){e.style=e.style||{},Object.assign(e.style,{top:"0px",left:"0px",width:Yo+"px",height:au+"px",margin:"0px",padding:"0px"})}function lu(e){"clientLeft"in e||(e.clientLeft=0,e.clientTop=0),"clientWidth"in e||(e.clientWidth=Yo,e.clientHeight=au),"getBoundingClientRect"in e||(e.getBoundingClientRect=function(){var r={x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight};return r})}function Tu(e){"offsetLeft"in e||(e.offsetLeft=0,e.offsetTop=0),"offsetWidth"in e||(e.offsetWidth=Yo,e.offsetHeight=au)}function rh(e){"scrollLeft"in e||(e.scrollLeft=0,e.scrollTop=0),"scrollWidth"in e||(e.scrollWidth=Yo,e.scrollHeight=au)}function Al(e){var r=function(){return!0};e.classList=[],e.classList.add=r,e.classList.remove=r,e.classList.contains=r,e.classList.toggle=r}function wl(e){var r=cu();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function cu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function fu(){}var _=function(e){Nr()(t,e);var r=wl(t);function t(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",s=arguments.length>1?arguments[1]:void 0;return Ct()(this,t),n=r.call(this),S()(oe()(n),"className",void 0),S()(oe()(n),"children",void 0),S()(oe()(n),"focus",void 0),S()(oe()(n),"blur",void 0),S()(oe()(n),"insertBefore",void 0),S()(oe()(n),"appendChild",void 0),S()(oe()(n),"removeChild",void 0),S()(oe()(n),"remove",void 0),S()(oe()(n),"innerHTML",void 0),S()(oe()(n),"tagName",void 0),n.className="",n.children=[],n.focus=fu,n.blur=fu,n.insertBefore=fu,n.appendChild=fu,n.removeChild=fu,n.remove=fu,n.innerHTML="",n.tagName=i.toUpperCase(),Ca(oe()(n),s),Va(oe()(n)),Al(oe()(n)),lu(oe()(n)),Tu(oe()(n)),rh(oe()(n)),n}return Bt()(t)}(Oa);function O(e){var r=V();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function V(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var L=function(e){Nr()(t,e);var r=O(t);function t(n){return Ct()(this,t),r.call(this,n)}return Bt()(t,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),t}(_);function ne(e){var r=Te();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Te(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Je=function(e){Nr()(t,e);var r=ne(t);function t(){return Ct()(this,t),r.call(this,"video")}return Bt()(t)}(L),pt={},Tt={};function wr(e,r){pt=e,pt.id=r,"tagName"in pt||(pt.tagName="CANVAS"),pt.type="canvas",Ca(pt),Va(pt),Al(pt),lu(pt),Tu(pt),pt.focus=function(){},pt.blur=function(){}}function Fr(e,r){var t=1024,n=1024;Tt={width:t,height:n,clientWidth:t/Ta,clientHeight:n/Ta,id:r,type:"canvas"},"tagName"in Tt||(Tt.tagName="CANVAS"),Ca(Tt),Va(Tt),Al(Tt),lu(Tt),Tu(Tt),Tt.getContext=function(i){if(i==="2d")return e},Tt.focus=function(){},Tt.blur=function(){}}function Wn(){return pt}function Ci(){return Tt}var di=Bt()(function e(){Ct()(this,e);var r=Wn(),t=r.createImage&&r.createImage()||{};return"tagName"in t||(t.tagName="IMG",t.__proto__=e.prototype),Ca(t),Al(t),Object.assign(t,{addEventListener:function(i,s){t["on".concat(i)]=s.bind(t)},removeEventListener:function(i){t["on".concat(i)]=null}}),t}),aa={href:"",protocol:"",host:""};function sa(e){var r=pa();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function pa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ou=function(e){Nr()(t,e);var r=sa(t);function t(){return Ct()(this,t),r.call(this,"body",0)}return Bt()(t,[{key:"addEventListener",value:function(i,s){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(i,s,c){}},{key:"dispatchEvent",value:function(i){}}]),t}(_),ys=function(e){Nr()(t,e);var r=sa(t);function t(){return Ct()(this,t),r.call(this,"html",0)}return Bt()(t,[{key:"addEventListener",value:function(i,s){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(i,s){}},{key:"dispatchEvent",value:function(i){}}]),t}(_),ea={},_s={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:aa,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(r){return r=r.toLowerCase(),r==="canvas"?my.createOffscreenCanvas(1024,128,"2d"):r==="img"?new di:r==="video"?new Je:new _(r)},createElementNS:function(r,t){return this.createElement(t)},createTextNode:function(r){return r},getElementById:function(r){return null},getElementsByTagName:function(r){return r=r.toLowerCase(),[]},getElementsByTagNameNS:function(r,t){return this.getElementsByTagName(t)},getElementsByName:function(r){return[]},querySelector:function(r){return null},querySelectorAll:function(r){return[]},addEventListener:function(r,t,n){ea[r]||(ea[r]=[]),ea[r].push(t)},removeEventListener:function(r,t){var n=ea[r];if(n&&n.length>0){for(var i=n.length;i--;i>0)if(n[i]===t){n.splice(i,1);break}}},dispatchEvent:function(r){var t=r.type,n=ea[t];if(n)for(var i=0;i<n.length;i++)n[i](r);r.target&&typeof r.target["on"+t]=="function"&&r.target["on"+t](r)},createEvent:function(r){return new wu(r)}};_s.documentElement=new ys,_s.head=new _("head"),_s.body=new ou;var ic=Object,Tl=w("cDf5"),jl=w.n(Tl),Dc=function(){function e(){Ct()(this,e),S()(this,"_w",void 0),S()(this,"_h",void 0),S()(this,"_data",void 0);var r=arguments.length;if(r===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){this._w=arguments[0],this._h=arguments[1],this._data=new Uint8ClampedArray(this._w*this._h*4);return}}else r===3&&jl()(arguments[0])==="object"&&typeof arguments[1]=="number"&&typeof arguments[2]=="number"&&(this._data=arguments[0],this._w=arguments[1],this._h=arguments[2]);throw new Error("ImageData: params error")}return Bt()(e,[{key:"width",get:function(){return this._w}},{key:"height",get:function(){return this._h}},{key:"data",get:function(){return this._data}}]),e}(),_f=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,hu,Ji,Mu;if(_f){var xf=my.getSystemInfoSync();hu=xf.system,Ji=xf.platform,Mu=xf.language}else{var po={versions:function(){var e=ro.navigator.userAgent;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")===-1,mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:e.indexOf("Safari")===-1,weixin:e.indexOf("MicroMessenger")>-1,qq:e.match(/\sQQ/i)===" qq"}}(),language:(ro.navigator.browserLanguage||ro.navigator.language).toLowerCase()};po.versions.android?Ji="android":po.versions.trident?Ji="IE":po.versions.presto?Ji="Opera":po.versions.webKit?Ji="webKit":po.versions.gecko?Ji="Firefox":po.versions.mobile?Ji="mobile":po.versions.ios?Ji="ios":po.versions.iPhone?Ji="iPhone":po.versions.iPad?Ji="ipad":po.versions.webApp?Ji="webApp":po.versions.weixin?Ji="weixin":po.versions.qq&&(Ji="qq"),hu=ro.navigator.userAgent,Mu=po.language}var Fc=hu.toLowerCase().indexOf("android")!==-1,Pu=Fc?"Android; CPU Android 6.0":"iPhone; CPU iPhone OS 10_3_1 like Mac OS X",Ml="Mozilla/5.0 (".concat(Pu,") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/").concat(Mu),al={platform:Ji,language:Mu,appVersion:"5.0 (".concat(Pu,") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"),userAgent:Ml},Wu={mark:function(r){return null},clearMeasures:function(r){return null},clearMarks:function(r){return null},measure:function(r,t,n){return{duration:0}},now:function(){}},Vl=0,ol=0;function Ra(e){var r=Date.now(),t=Math.max(Vl+23,r);return ol=setTimeout(function(){e(Vl=t)},t-r),ol}function ac(e){var r=Wn();return r.requestAnimationFrame?r.requestAnimationFrame(e):Ra(e)}function Dh(e){var r=Wn();return r.cancelAnimationFrame?r.cancelAnimationFrame(e):clearTimeout(e)}var oc=function(){function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(Ct()(this,e),S()(this,"href",void 0),r.indexOf("http://")==0||r.indexOf("https://")==0){this.href=r;return}this.href=t+r}return Bt()(e,null,[{key:"createObjectURL",value:function(t){var n=t.buffers[0],i=t.type,s=Fh(n),c="data:".concat(i,";base64, ");return c+s}}]),e}();function Fh(e){for(var r="",t=new Uint8Array(e),n=t.byteLength,i=0;i<n;i++)r+=String.fromCharCode(t[i]);return ao(r)}var mp={GCCSO_SHADER_BINARY_FJ:37472,_3DC_XY_AMD:34810,_3DC_X_AMD:34809,ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_PROGRAM_EXT:33369,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALL_COMPLETED_NV:34034,ALL_SHADER_BITS_EXT:4294967295,ALPHA:6406,ALPHA16F_EXT:34844,ALPHA32F_EXT:34838,ALPHA8_EXT:32828,ALPHA8_OES:32828,ALPHA_BITS:3413,ALPHA_TEST_FUNC_QCOM:3009,ALPHA_TEST_QCOM:3008,ALPHA_TEST_REF_QCOM:3010,ALREADY_SIGNALED_APPLE:37146,ALWAYS:519,AMD_compressed_3DC_texture:1,AMD_compressed_ATC_texture:1,AMD_performance_monitor:1,AMD_program_binary_Z400:1,ANGLE_depth_texture:1,ANGLE_framebuffer_blit:1,ANGLE_framebuffer_multisample:1,ANGLE_instanced_arrays:1,ANGLE_pack_reverse_row_order:1,ANGLE_program_binary:1,ANGLE_texture_compression_dxt3:1,ANGLE_texture_compression_dxt5:1,ANGLE_texture_usage:1,ANGLE_translated_shader_source:1,ANY_SAMPLES_PASSED_CONSERVATIVE_EXT:36202,ANY_SAMPLES_PASSED_EXT:35887,APPLE_copy_texture_levels:1,APPLE_framebuffer_multisample:1,APPLE_rgb_422:1,APPLE_sync:1,APPLE_texture_format_BGRA8888:1,APPLE_texture_max_level:1,ARM_mali_program_binary:1,ARM_mali_shader_binary:1,ARM_rgba8:1,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATC_RGBA_EXPLICIT_ALPHA_AMD:35987,ATC_RGBA_INTERPOLATED_ALPHA_AMD:34798,ATC_RGB_AMD:35986,ATTACHED_SHADERS:35717,BACK:1029,BGRA8_EXT:37793,BGRA_EXT:32993,BGRA_IMG:32993,BINNING_CONTROL_HINT_QCOM:36784,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER:33504,BUFFER_ACCESS_OES:35003,BUFFER_MAPPED_OES:35004,BUFFER_MAP_POINTER_OES:35005,BUFFER_OBJECT_EXT:37201,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_BORDER_NV:33069,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_ATTACHMENT0_NV:36064,COLOR_ATTACHMENT10_NV:36074,COLOR_ATTACHMENT11_NV:36075,COLOR_ATTACHMENT12_NV:36076,COLOR_ATTACHMENT13_NV:36077,COLOR_ATTACHMENT14_NV:36078,COLOR_ATTACHMENT15_NV:36079,COLOR_ATTACHMENT1_NV:36065,COLOR_ATTACHMENT2_NV:36066,COLOR_ATTACHMENT3_NV:36067,COLOR_ATTACHMENT4_NV:36068,COLOR_ATTACHMENT5_NV:36069,COLOR_ATTACHMENT6_NV:36070,COLOR_ATTACHMENT7_NV:36071,COLOR_ATTACHMENT8_NV:36072,COLOR_ATTACHMENT9_NV:36073,COLOR_ATTACHMENT_EXT:37104,COLOR_BUFFER_BIT:16384,COLOR_BUFFER_BIT0_QCOM:1,COLOR_BUFFER_BIT1_QCOM:2,COLOR_BUFFER_BIT2_QCOM:4,COLOR_BUFFER_BIT3_QCOM:8,COLOR_BUFFER_BIT4_QCOM:16,COLOR_BUFFER_BIT5_QCOM:32,COLOR_BUFFER_BIT6_QCOM:64,COLOR_BUFFER_BIT7_QCOM:128,COLOR_CLEAR_VALUE:3106,COLOR_EXT:6144,COLOR_WRITEMASK:3107,COMPARE_REF_TO_TEXTURE_EXT:34894,COMPILE_STATUS:35713,COMPRESSED_RGBA_ASTC_10x10_KHR:37819,COMPRESSED_RGBA_ASTC_10x5_KHR:37816,COMPRESSED_RGBA_ASTC_10x6_KHR:37817,COMPRESSED_RGBA_ASTC_10x8_KHR:37818,COMPRESSED_RGBA_ASTC_12x10_KHR:37820,COMPRESSED_RGBA_ASTC_12x12_KHR:37821,COMPRESSED_RGBA_ASTC_4x4_KHR:37808,COMPRESSED_RGBA_ASTC_5x4_KHR:37809,COMPRESSED_RGBA_ASTC_5x5_KHR:37810,COMPRESSED_RGBA_ASTC_6x5_KHR:37811,COMPRESSED_RGBA_ASTC_6x6_KHR:37812,COMPRESSED_RGBA_ASTC_8x5_KHR:37813,COMPRESSED_RGBA_ASTC_8x6_KHR:37814,COMPRESSED_RGBA_ASTC_8x8_KHR:37815,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_PVRTC_2BPPV2_IMG:37175,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_4BPPV2_IMG:37176,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_ANGLE:33778,COMPRESSED_RGBA_S3TC_DXT5_ANGLE:33779,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:37853,COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:37847,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_NV:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_NV:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_NV:35919,COMPRESSED_SRGB_S3TC_DXT1_NV:35916,COMPRESSED_TEXTURE_FORMATS:34467,CONDITION_SATISFIED_APPLE:37148,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_FLAG_DEBUG_BIT:2,CONTEXT_ROBUST_ACCESS_EXT:37107,COUNTER_RANGE_AMD:35777,COUNTER_TYPE_AMD:35776,COVERAGE_ALL_FRAGMENTS_NV:36565,COVERAGE_ATTACHMENT_NV:36562,COVERAGE_AUTOMATIC_NV:36567,COVERAGE_BUFFERS_NV:36563,COVERAGE_BUFFER_BIT_NV:32768,COVERAGE_COMPONENT4_NV:36561,COVERAGE_COMPONENT_NV:36560,COVERAGE_EDGE_FRAGMENTS_NV:36566,COVERAGE_SAMPLES_NV:36564,CPU_OPTIMIZED_QCOM:36785,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_QUERY_EXT:34917,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DEBUG_CALLBACK_FUNCTION:33348,DEBUG_CALLBACK_USER_PARAM:33349,DEBUG_GROUP_STACK_DEPTH:33389,DEBUG_LOGGED_MESSAGES:37189,DEBUG_NEXT_LOGGED_MESSAGE_LENGTH:33347,DEBUG_OUTPUT:37600,DEBUG_OUTPUT_SYNCHRONOUS:33346,DEBUG_SEVERITY_HIGH:37190,DEBUG_SEVERITY_LOW:37192,DEBUG_SEVERITY_MEDIUM:37191,DEBUG_SEVERITY_NOTIFICATION:33387,DEBUG_SOURCE_API:33350,DEBUG_SOURCE_APPLICATION:33354,DEBUG_SOURCE_OTHER:33355,DEBUG_SOURCE_SHADER_COMPILER:33352,DEBUG_SOURCE_THIRD_PARTY:33353,DEBUG_SOURCE_WINDOW_SYSTEM:33351,DEBUG_TYPE_DEPRECATED_BEHAVIOR:33357,DEBUG_TYPE_ERROR:33356,DEBUG_TYPE_MARKER:33384,DEBUG_TYPE_OTHER:33361,DEBUG_TYPE_PERFORMANCE:33360,DEBUG_TYPE_POP_GROUP:33386,DEBUG_TYPE_PORTABILITY:33359,DEBUG_TYPE_PUSH_GROUP:33385,DEBUG_TYPE_UNDEFINED_BEHAVIOR:33358,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH24_STENCIL8_OES:35056,DEPTH_ATTACHMENT:36096,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_BUFFER_BIT0_QCOM:256,DEPTH_BUFFER_BIT1_QCOM:512,DEPTH_BUFFER_BIT2_QCOM:1024,DEPTH_BUFFER_BIT3_QCOM:2048,DEPTH_BUFFER_BIT4_QCOM:4096,DEPTH_BUFFER_BIT5_QCOM:8192,DEPTH_BUFFER_BIT6_QCOM:16384,DEPTH_BUFFER_BIT7_QCOM:32768,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_COMPONENT16_NONLINEAR_NV:36396,DEPTH_COMPONENT16_OES:33189,DEPTH_COMPONENT24_OES:33190,DEPTH_COMPONENT32_OES:33191,DEPTH_EXT:6145,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_OES:34041,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DMP_shader_binary:1,DONT_CARE:4352,DRAW_BUFFER0_NV:34853,DRAW_BUFFER10_NV:34863,DRAW_BUFFER11_NV:34864,DRAW_BUFFER12_NV:34865,DRAW_BUFFER13_NV:34866,DRAW_BUFFER14_NV:34867,DRAW_BUFFER15_NV:34868,DRAW_BUFFER1_NV:34854,DRAW_BUFFER2_NV:34855,DRAW_BUFFER3_NV:34856,DRAW_BUFFER4_NV:34857,DRAW_BUFFER5_NV:34858,DRAW_BUFFER6_NV:34859,DRAW_BUFFER7_NV:34860,DRAW_BUFFER8_NV:34861,DRAW_BUFFER9_NV:34862,DRAW_BUFFER_EXT:3073,DRAW_FRAMEBUFFER_ANGLE:36009,DRAW_FRAMEBUFFER_APPLE:36009,DRAW_FRAMEBUFFER_BINDING_ANGLE:36006,DRAW_FRAMEBUFFER_BINDING_APPLE:36006,DRAW_FRAMEBUFFER_BINDING_NV:36006,DRAW_FRAMEBUFFER_NV:36009,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,ES_VERSION_2_0:1,ETC1_RGB8_OES:36196,ETC1_SRGB8_NV:35054,EXTENSIONS:7939,EXT_blend_minmax:1,EXT_color_buffer_half_float:1,EXT_debug_label:1,EXT_debug_marker:1,EXT_discard_framebuffer:1,EXT_map_buffer_range:1,EXT_multi_draw_arrays:1,EXT_multisampled_render_to_texture:1,EXT_multiview_draw_buffers:1,EXT_occlusion_query_boolean:1,EXT_read_format_bgra:1,EXT_robustness:1,EXT_sRGB:1,EXT_separate_shader_objects:1,EXT_shader_framebuffer_fetch:1,EXT_shader_texture_lod:1,EXT_shadow_samplers:1,EXT_texture_compression_dxt1:1,EXT_texture_filter_anisotropic:1,EXT_texture_format_BGRA8888:1,EXT_texture_rg:1,EXT_texture_storage:1,EXT_texture_type_2_10_10_10_REV:1,EXT_unpack_subimage:1,FALSE:0,FASTEST:4353,FENCE_CONDITION_NV:34036,FENCE_STATUS_NV:34035,FIXED:5132,FJ_shader_binary_GCCSO:1,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAGMENT_SHADER_BIT_EXT:2,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,FRAGMENT_SHADER_DISCARDS_SAMPLES_EXT:35410,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_ANGLE:37795,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_3D_ZOFFSET_OES:36052,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_SAMPLES_EXT:36204,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_ANGLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_APPLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_EXT:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_IMG:37172,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_NV:36182,FRAMEBUFFER_UNDEFINED_OES:33305,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GPU_OPTIMIZED_QCOM:36786,GREATER:516,GREEN_BITS:3411,GUILTY_CONTEXT_RESET_EXT:33363,HALF_FLOAT_OES:36193,HIGH_FLOAT:36338,HIGH_INT:36341,IMG_multisampled_render_to_texture:1,IMG_program_binary:1,IMG_read_format:1,IMG_shader_binary:1,IMG_texture_compression_pvrtc:1,IMG_texture_compression_pvrtc2:1,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INNOCENT_CONTEXT_RESET_EXT:33364,INT:5124,INT_10_10_10_2_OES:36343,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,KHR_debug:1,KHR_texture_compression_astc_ldr:1,LEFT:1030,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOSE_CONTEXT_ON_RESET_EXT:33362,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE16F_EXT:34846,LUMINANCE32F_EXT:34840,LUMINANCE4_ALPHA4_OES:32835,LUMINANCE8_ALPHA8_EXT:32837,LUMINANCE8_ALPHA8_OES:32837,LUMINANCE8_EXT:32832,LUMINANCE8_OES:32832,LUMINANCE_ALPHA:6410,LUMINANCE_ALPHA16F_EXT:34847,LUMINANCE_ALPHA32F_EXT:34841,MALI_PROGRAM_BINARY_ARM:36705,MALI_SHADER_BINARY_ARM:36704,MAP_FLUSH_EXPLICIT_BIT_EXT:16,MAP_INVALIDATE_BUFFER_BIT_EXT:8,MAP_INVALIDATE_RANGE_BIT_EXT:4,MAP_READ_BIT_EXT:1,MAP_UNSYNCHRONIZED_BIT_EXT:32,MAP_WRITE_BIT_EXT:2,MAX_3D_TEXTURE_SIZE_OES:32883,MAX_COLOR_ATTACHMENTS_NV:36063,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_DEBUG_GROUP_STACK_DEPTH:33388,MAX_DEBUG_LOGGED_MESSAGES:37188,MAX_DEBUG_MESSAGE_LENGTH:37187,MAX_DRAW_BUFFERS_NV:34852,MAX_EXT:32776,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_LABEL_LENGTH:33512,MAX_MULTIVIEW_BUFFERS_EXT:37106,MAX_RENDERBUFFER_SIZE:34024,MAX_SAMPLES_ANGLE:36183,MAX_SAMPLES_APPLE:36183,MAX_SAMPLES_EXT:36183,MAX_SAMPLES_IMG:37173,MAX_SAMPLES_NV:36183,MAX_SERVER_WAIT_TIMEOUT_APPLE:37137,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIN_EXT:32775,MIRRORED_REPEAT:33648,MULTISAMPLE_BUFFER_BIT0_QCOM:16777216,MULTISAMPLE_BUFFER_BIT1_QCOM:33554432,MULTISAMPLE_BUFFER_BIT2_QCOM:67108864,MULTISAMPLE_BUFFER_BIT3_QCOM:134217728,MULTISAMPLE_BUFFER_BIT4_QCOM:268435456,MULTISAMPLE_BUFFER_BIT5_QCOM:536870912,MULTISAMPLE_BUFFER_BIT6_QCOM:1073741824,MULTISAMPLE_BUFFER_BIT7_QCOM:2147483648,MULTIVIEW_EXT:37105,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NO_RESET_NOTIFICATION_EXT:33377,NUM_COMPRESSED_TEXTURE_FORMATS:34466,NUM_PROGRAM_BINARY_FORMATS_OES:34814,NUM_SHADER_BINARY_FORMATS:36345,NV_coverage_sample:1,NV_depth_nonlinear:1,NV_draw_buffers:1,NV_draw_instanced:1,NV_fbo_color_attachments:1,NV_fence:1,NV_framebuffer_blit:1,NV_framebuffer_multisample:1,NV_generate_mipmap_sRGB:1,NV_instanced_arrays:1,NV_read_buffer:1,NV_read_buffer_front:1,NV_read_depth:1,NV_read_depth_stencil:1,NV_read_stencil:1,NV_sRGB_formats:1,NV_shadow_samplers_array:1,NV_shadow_samplers_cube:1,NV_texture_border_clamp:1,NV_texture_compression_s3tc_update:1,NV_texture_npot_2D_mipmap:1,OBJECT_TYPE_APPLE:37138,OES_EGL_image:1,OES_EGL_image_external:1,OES_compressed_ETC1_RGB8_texture:1,OES_compressed_paletted_texture:1,OES_depth24:1,OES_depth32:1,OES_depth_texture:1,OES_element_index_uint:1,OES_fbo_render_mipmap:1,OES_fragment_precision_high:1,OES_get_program_binary:1,OES_mapbuffer:1,OES_packed_depth_stencil:1,OES_required_internalformat:1,OES_rgb8_rgba8:1,OES_standard_derivatives:1,OES_stencil1:1,OES_stencil4:1,OES_surfaceless_context:1,OES_texture_3D:1,OES_texture_float:1,OES_texture_float_linear:1,OES_texture_half_float:1,OES_texture_half_float_linear:1,OES_texture_npot:1,OES_vertex_array_object:1,OES_vertex_half_float:1,OES_vertex_type_10_10_10_2:1,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,PACK_REVERSE_ROW_ORDER_ANGLE:37796,PALETTE4_R5_G6_B5_OES:35730,PALETTE4_RGB5_A1_OES:35732,PALETTE4_RGB8_OES:35728,PALETTE4_RGBA4_OES:35731,PALETTE4_RGBA8_OES:35729,PALETTE8_R5_G6_B5_OES:35735,PALETTE8_RGB5_A1_OES:35737,PALETTE8_RGB8_OES:35733,PALETTE8_RGBA4_OES:35736,PALETTE8_RGBA8_OES:35734,PERCENTAGE_AMD:35779,PERFMON_GLOBAL_MODE_QCOM:36768,PERFMON_RESULT_AMD:35782,PERFMON_RESULT_AVAILABLE_AMD:35780,PERFMON_RESULT_SIZE_AMD:35781,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,PROGRAM:33506,PROGRAM_BINARY_ANGLE:37798,PROGRAM_BINARY_FORMATS_OES:34815,PROGRAM_BINARY_LENGTH_OES:34625,PROGRAM_OBJECT_EXT:35648,PROGRAM_PIPELINE_BINDING_EXT:33370,PROGRAM_PIPELINE_OBJECT_EXT:35407,PROGRAM_SEPARABLE_EXT:33368,QCOM_alpha_test:1,QCOM_binning_control:1,QCOM_driver_control:1,QCOM_extended_get:1,QCOM_extended_get2:1,QCOM_perfmon_global_mode:1,QCOM_tiled_rendering:1,QCOM_writeonly_rendering:1,QUERY:33507,QUERY_OBJECT_EXT:37203,QUERY_RESULT_AVAILABLE_EXT:34919,QUERY_RESULT_EXT:34918,R16F_EXT:33325,R32F_EXT:33326,R8_EXT:33321,READ_BUFFER_EXT:3074,READ_BUFFER_NV:3074,READ_FRAMEBUFFER_ANGLE:36008,READ_FRAMEBUFFER_APPLE:36008,READ_FRAMEBUFFER_BINDING_ANGLE:36010,READ_FRAMEBUFFER_BINDING_APPLE:36010,READ_FRAMEBUFFER_BINDING_NV:36010,READ_FRAMEBUFFER_NV:36008,RED_BITS:3410,RED_EXT:6403,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_SAMPLES_ANGLE:36011,RENDERBUFFER_SAMPLES_APPLE:36011,RENDERBUFFER_SAMPLES_EXT:36011,RENDERBUFFER_SAMPLES_IMG:37171,RENDERBUFFER_SAMPLES_NV:36011,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,RENDER_DIRECT_TO_FRAMEBUFFER_QCOM:36787,REPEAT:10497,REPLACE:7681,REQUIRED_TEXTURE_IMAGE_UNITS_OES:36200,RESET_NOTIFICATION_STRATEGY_EXT:33366,RG16F_EXT:33327,RG32F_EXT:33328,RG8_EXT:33323,RGB:6407,RGB10_A2_EXT:32857,RGB10_EXT:32850,RGB16F_EXT:34843,RGB32F_EXT:34837,RGB565:36194,RGB565_OES:36194,RGB5_A1:32855,RGB5_A1_OES:32855,RGB8_OES:32849,RGBA:6408,RGBA16F_EXT:34842,RGBA32F_EXT:34836,RGBA4:32854,RGBA4_OES:32854,RGBA8_OES:32856,RGB_422_APPLE:35359,RG_EXT:33319,RIGHT:1031,SAMPLER:33510,SAMPLER_2D:35678,SAMPLER_2D_ARRAY_SHADOW_NV:36292,SAMPLER_2D_SHADOW_EXT:35682,SAMPLER_3D_OES:35679,SAMPLER_CUBE:35680,SAMPLER_CUBE_SHADOW_NV:36293,SAMPLER_EXTERNAL_OES:36198,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SGX_BINARY_IMG:35850,SGX_PROGRAM_BINARY_IMG:37168,SHADER:33505,SHADER_BINARY_DMP:37456,SHADER_BINARY_FORMATS:36344,SHADER_BINARY_VIV:36804,SHADER_COMPILER:36346,SHADER_OBJECT_EXT:35656,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SIGNALED_APPLE:37145,SLUMINANCE8_ALPHA8_NV:35909,SLUMINANCE8_NV:35911,SLUMINANCE_ALPHA_NV:35908,SLUMINANCE_NV:35910,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,SRGB8_ALPHA8_EXT:35907,SRGB8_NV:35905,SRGB_ALPHA_EXT:35906,SRGB_EXT:35904,STACK_OVERFLOW:1283,STACK_UNDERFLOW:1284,STATE_RESTORE:35804,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_BUFFER_BIT0_QCOM:65536,STENCIL_BUFFER_BIT1_QCOM:131072,STENCIL_BUFFER_BIT2_QCOM:262144,STENCIL_BUFFER_BIT3_QCOM:524288,STENCIL_BUFFER_BIT4_QCOM:1048576,STENCIL_BUFFER_BIT5_QCOM:2097152,STENCIL_BUFFER_BIT6_QCOM:4194304,STENCIL_BUFFER_BIT7_QCOM:8388608,STENCIL_CLEAR_VALUE:2961,STENCIL_EXT:6146,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX1_OES:36166,STENCIL_INDEX4_OES:36167,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,SYNC_CONDITION_APPLE:37139,SYNC_FENCE_APPLE:37142,SYNC_FLAGS_APPLE:37141,SYNC_FLUSH_COMMANDS_BIT_APPLE:1,SYNC_GPU_COMMANDS_COMPLETE_APPLE:37143,SYNC_OBJECT_APPLE:35411,SYNC_STATUS_APPLE:37140,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_3D_OES:32879,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_3D_OES:32874,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_BINDING_EXTERNAL_OES:36199,TEXTURE_BORDER_COLOR_NV:4100,TEXTURE_COMPARE_FUNC_EXT:34893,TEXTURE_COMPARE_MODE_EXT:34892,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_DEPTH_QCOM:35796,TEXTURE_EXTERNAL_OES:36197,TEXTURE_FORMAT_QCOM:35798,TEXTURE_HEIGHT_QCOM:35795,TEXTURE_IMAGE_VALID_QCOM:35800,TEXTURE_IMMUTABLE_FORMAT_EXT:37167,TEXTURE_INTERNAL_FORMAT_QCOM:35797,TEXTURE_MAG_FILTER:10240,TEXTURE_MAX_ANISOTROPY_EXT:34046,TEXTURE_MAX_LEVEL_APPLE:33085,TEXTURE_MIN_FILTER:10241,TEXTURE_NUM_LEVELS_QCOM:35801,TEXTURE_OBJECT_VALID_QCOM:35803,TEXTURE_SAMPLES_IMG:37174,TEXTURE_TARGET_QCOM:35802,TEXTURE_TYPE_QCOM:35799,TEXTURE_USAGE_ANGLE:37794,TEXTURE_WIDTH_QCOM:35794,TEXTURE_WRAP_R_OES:32882,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TIMEOUT_EXPIRED_APPLE:37147,TIMEOUT_IGNORED_APPLE:18446744073709552e3,TRANSLATED_SHADER_SOURCE_LENGTH_ANGLE:37792,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRUE:1,UNKNOWN_CONTEXT_RESET_EXT:33365,UNPACK_ALIGNMENT:3317,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_PIXELS:3316,UNPACK_SKIP_ROWS:3315,UNSIGNALED_APPLE:37144,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_INT64_AMD:35778,UNSIGNED_INT_10_10_10_2_OES:36342,UNSIGNED_INT_24_8_OES:34042,UNSIGNED_INT_2_10_10_10_REV_EXT:33640,UNSIGNED_NORMALIZED_EXT:35863,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_1_5_5_5_REV_EXT:33638,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_4_4_4_4_REV_EXT:33637,UNSIGNED_SHORT_4_4_4_4_REV_IMG:33637,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_8_8_APPLE:34234,UNSIGNED_SHORT_8_8_REV_APPLE:34235,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ARRAY_BINDING_OES:34229,VERTEX_ARRAY_OBJECT_EXT:37204,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,VERTEX_ATTRIB_ARRAY_DIVISOR_NV:35070,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VERTEX_SHADER_BIT_EXT:1,VIEWPORT:2978,VIV_shader_binary:1,WAIT_FAILED_APPLE:37149,WRITEONLY_RENDERING_QCOM:34851,WRITE_ONLY_OES:35001,Z400_BINARY_AMD:34624,ZERO:0,RASTERIZER_DISCARD:35977,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444},Bh={};function sc(e){var r=sl();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function sl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ul=new Map,Gl=new Map,Zu=new Map,Hl={json:"application/json",text:"application/text",arraybuffer:"application/octet-stream"};function bf(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:this};typeof this["on".concat(e)]=="function"&&this["on".concat(e)].call(this,r)}function Wl(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{readyState:e};this.readyState=e,bf.call(this,"readystatechange",r)}var so=function(e){Nr()(t,e);var r=sc(t);function t(){var n;return Ct()(this,t),n=r.call(this),S()(oe()(n),"onabort",void 0),S()(oe()(n),"onerror",void 0),S()(oe()(n),"onload",void 0),S()(oe()(n),"onloadstart",void 0),S()(oe()(n),"onprogress",void 0),S()(oe()(n),"ontimeout",void 0),S()(oe()(n),"onloadend",void 0),S()(oe()(n),"onreadystatechange",void 0),S()(oe()(n),"readyState",void 0),S()(oe()(n),"response",void 0),S()(oe()(n),"responseText",void 0),S()(oe()(n),"_responseType",void 0),S()(oe()(n),"responseXML",void 0),S()(oe()(n),"status",void 0),S()(oe()(n),"statusText",void 0),S()(oe()(n),"upload",void 0),S()(oe()(n),"withCredentials",void 0),S()(oe()(n),"timeout",void 0),S()(oe()(n),"_url",void 0),S()(oe()(n),"_method",void 0),n.onabort=null,n.onerror=null,n.onload=null,n.onloadstart=null,n.onprogress=null,n.ontimeout=null,n.onloadend=null,n.onreadystatechange=null,n.readyState=0,n.response=null,n.responseText=null,n._responseType="text",n.responseXML=null,n.status=0,n.statusText="",n.upload={},n.withCredentials=!1,ul.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),n}return Bt()(t,[{key:"responseType",set:function(i){this._responseType=i}},{key:"abort",value:function(){var i=Zu.get("requestTask");i&&i.abort()}},{key:"getAllResponseHeaders",value:function(){var i=Gl.get("responseHeader");return Object.keys(i).map(function(s){return"".concat(s,": ").concat(i[s])}).join(`
`)}},{key:"getResponseHeader",value:function(i){return Gl.get("responseHeader")[i]}},{key:"open",value:function(i,s,c){this._method=i,this._url=s}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:""}},{key:"setRequestHeader",value:function(i,s){var c=ul.get("requestHeader");c[i]=s,ul.set("requestHeader",c)}},{key:"addEventListener",value:function(i,s){var c=this;typeof s=="function"&&(this["on"+i]=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m.target=m.target||c,s.call(c,m)})}},{key:"removeEventListener",value:function(i,s){this["on"+i]===s&&(this["on"+i]=null)}}]),t}(fe);S()(so,"UNSEND",void 0),S()(so,"OPENED",void 0),S()(so,"HEADERS_RECEIVED",void 0),S()(so,"LOADING",void 0),S()(so,"DONE",void 0),so.UNSEND=0,so.OPENED=1,so.HEADERS_RECEIVED=2,so.LOADING=3,so.DONE=4;function nh(e){var r=ih();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function ih(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ah=function(e){Nr()(t,e);var r=nh(t);function t(n){var i;return Ct()(this,t),i=r.call(this,n),S()(oe()(i),"touches",void 0),S()(oe()(i),"targetTouches",void 0),S()(oe()(i),"changedTouches",void 0),i.touches=[],i.targetTouches=[],i.changedTouches=[],i.target=Wn(),i.currentTarget=Wn(),i}return Bt()(t)}(wu);function Xu(e){var r=e||{},t=r.x,n=t===void 0?0:t,i=r.y,s=i===void 0?0:i,c=r.clientX,m=c===void 0?0:c,g=r.clientY,x=g===void 0?0:g;Object.keys(e).indexOf("x")!==-1?(e.pageX=e.clientX=n,e.pageY=e.clientY=s):(e.x=m,e.y=x)}function Pl(e){return function(r){var t=new ah(e);t.changedTouches=r.changedTouches,t.touches=r.touches,t.targetTouches=Array.prototype.slice.call(r.touches),t.timeStamp=r.timeStamp,t.changedTouches.forEach(function(n){return Xu(n)}),t.touches.forEach(function(n){return Xu(n)}),t.targetTouches.forEach(function(n){return Xu(n)}),_s.dispatchEvent(t)}}function Bc(e){return function(r){r.type=e,_s.dispatchEvent(r)}}var oh=Pl("touchstart"),Ef=Pl("touchmove"),Nc=Pl("touchend"),zc=Bc("mapCameaParams");function Uc(e){var r=uc();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function uc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Nh=function(e){Nr()(t,e);var r=Uc(t);function t(n){var i;return Ct()(this,t),i=r.call(this,n),S()(oe()(i),"buttons",void 0),S()(oe()(i),"which",void 0),S()(oe()(i),"pointerId",void 0),S()(oe()(i),"bubbles",void 0),S()(oe()(i),"button",void 0),S()(oe()(i),"width",void 0),S()(oe()(i),"height",void 0),S()(oe()(i),"pressure",void 0),S()(oe()(i),"isPrimary",void 0),S()(oe()(i),"pointerType",void 0),S()(oe()(i),"altKey",void 0),S()(oe()(i),"ctrlKey",void 0),S()(oe()(i),"metaKey",void 0),S()(oe()(i),"shiftKey",void 0),i.target=Wn(),i.currentTarget=Wn(),i}return Bt()(t)}(wu),jc=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","pageX","pageY","timeStamp"],sh=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,0,0,0],Vc="touch";function uh(e,r,t){for(var n=new Nh(e),i=0;i<jc.length;i++){var s=jc[i];n[s]=r[s]||sh[i]}return n.type=e,n.target=Wn(),n.currentTarget=Wn(),n.buttons=Gc(e),n.which=n.buttons,n.pointerId=(r.identifier||0)+2,n.bubbles=!0,n.cancelable=!0,n.button=0,n.width=(r.radiusX||.5)*2,n.height=(r.radiusY||.5)*2,n.pressure=r.force||.5,n.isPrimary=ll(r),n.pointerType=Vc,n.altKey=t.altKey,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,t.preventDefault&&(n.preventDefault=function(){t.preventDefault()}),n}function Gc(e){var r=0;return(e==="touchstart"||e==="touchmove"||e==="pointerdown"||e==="pointermove")&&(r=1),r}var lc=null;function ll(e){return lc===e.identifier}function Wa(e){lc===null&&(lc=e.identifier)}function cc(e){lc===e.identifier&&(lc=null)}function Yu(e){return function(r){for(var t=r.changedTouches,n=0;n<t.length;n++){var i=t[n];n===0&&e==="pointerdown"?Wa(i):(e==="pointerup"||e==="pointercancel")&&cc(i);var s=uh(e,i,r);_s.dispatchEvent(s)}}}var Ol=Yu("pointerdown"),ta=Yu("pointermove"),Ga=Yu("pointerup");function Os(e){var r=Hc();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Hc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Wc=function(e){Nr()(t,e);var r=Os(t);function t(n){return Ct()(this,t),r.call(this,n)}return Bt()(t)}(wu);function Zl(e){return function(r){r.type=e,_s.dispatchEvent(r)}}var fd=Zl("mousedown"),hd=Zl("mousemove"),Sf=Zl("mouseup"),Zc=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Ku=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),Pi=Zc||Ku,Xc={atob:to,btoa:ao,devicePixelRatio:Ta,Blob:wa,document:_s,Element:Oa,Event:wu,EventTarget:fe,HTMLCanvasElement:ic,HTMLElement:_,HTMLMediaElement:L,HTMLVideoElement:Je,Image:di,ImageData:Dc,navigator:al,Node:Gr,requestAnimationFrame:ac,cancelAnimationFrame:Dh,screen:Ms,XMLHttpRequest:so,performance:Wu,URL:oc,WebGLRenderingContext:mp,WebGL2RenderingContext:Bh,addEventListener:function(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};_s.addEventListener(r,t,n)},removeEventListener:function(r,t,n){_s.removeEventListener(r,t)},dispatchEvent:function(r){_s.dispatchEvent(r)},innerWidth:Ms.availWidth,innerHeight:Ms.availHeight,setTimeout,clearTimeout,setInterval,clearInterval},Kn=Pi?Xc:ro,_a=Pi?so:ro.XMLHttpRequest,Ln=Pi?aa:ro.location;function Zs(e){var r=e;return typeof e=="string"&&(r=Kn.document.getElementById(e)),r}function Xl(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Il(e){return Xl(e).split(/\s+/)}function pu(e){var r,t,n=Kn==null||(r=Kn.document)===null||r===void 0||(t=r.documentElement)===null||t===void 0?void 0:t.style;if(!n)return e[0];for(var i in e)if(e[i]&&e[i]in n)return e[i];return e[0]}function Xs(e,r,t){var n=Kn.document.createElement(e);return n.className=r||"",t&&t.appendChild(n),n}function Cf(e){var r=e.parentNode;r&&r.removeChild(e)}function mn(e,r){if(e.classList!==void 0)for(var t=Il(r),n=0,i=t.length;n<i;n++)e.classList.add(t[n]);else if(!bo(e,r)){var s=Is(e);fc(e,(s?s+" ":"")+r)}}function Rl(e,r){e.classList!==void 0?e.classList.remove(r):fc(e,Xl((" "+Is(e)+" ").replace(" "+r+" "," ")))}function bo(e,r){if(e.classList!==void 0)return e.classList.contains(r);var t=Is(e);return t.length>0&&new RegExp("(^|\\s)"+r+"(\\s|$)").test(t)}function fc(e,r){e instanceof HTMLElement?e.className=r:e.className.baseVal=r}function Is(e){return e instanceof SVGElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function Uo(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}var Yc=pu(["transform","WebkitTransform"]);function Kc(e,r){e.style[Yc]=r}function qs(){if(typeof Event=="function")Kn.dispatchEvent(new Event("resize"));else{var e=Kn.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,Kn,0),Kn.dispatchEvent(e)}}function cl(e){var r=["padding: "+(e.height/2-8)+"px "+e.width/2+"px;","line-height: "+e.height+"px;","background-image: url("+e.toDataURL()+");"];console.log(`%c
`,r.join(""))}function lh(){var e,r=Kn.document.querySelector('meta[name="viewport"]');if(!r)return 1;var t=(e=r.content)===null||e===void 0?void 0:e.split(","),n=t.find(function(i){var s=i.split("="),c=ri()(s,2),m=c[0],g=c[1];return m==="initial-scale"});return n?n.split("=")[1]*1:1}var $c=lh()<1?1:Kn.devicePixelRatio,qc=w("oShl"),Af=w.n(qc);function su(e){var r=Qs();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Qs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Wi=function(e){Nr()(t,e);var r=su(t);function t(n,i,s){var c;return Ct()(this,t),c=r.call(this,n),S()(oe()(c),"status",void 0),S()(oe()(c),"url",void 0),c.status=i,c.url=s,c.name=c.constructor.name,c.message=n,c}return Bt()(t,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),t}(Af()(Error));function du(e){var r=new _a;r.open("GET",e.url,!0);for(var t in e.headers)e.headers.hasOwnProperty(t)&&r.setRequestHeader(t,e.headers[t]);return r.withCredentials=e.credentials==="include",r}var vu=function(r,t){var n=du(r);return n.setRequestHeader("Accept","application/json"),n.onerror=function(){t(new Error(n.statusText))},n.onload=function(){if(n.status>=200&&n.status<300&&n.response){var i;try{i=JSON.parse(n.response)}catch(s){return t(s)}t(null,i)}else n.status===401?t(new Wi("".concat(n.statusText),n.status,r.url)):t(new Wi(n.statusText,n.status,r.url))},n.send(),n},ls=function(r,t){var n=du(r);return n.responseType="arraybuffer",n.onerror=function(){t(new Error(n.statusText))},n.onload=function(){var i=n.response;if(i.byteLength===0&&n.status===200)return t(new Error("http status 200 returned without content."));n.status>=200&&n.status<300&&n.response?t(null,{data:i,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")}):t(new Wi(n.statusText,n.status,r.url))},n.send(),n};function fl(e){var r=Kn.document.createElement("a");return r.href=e,r.protocol===Kn.document.location.protocol&&r.host===Kn.document.location.host}var kl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",Ko=function(r,t){return ls(r,function(n,i){if(n)t(n);else if(i){var s=new Kn.Image;s.crossOrigin="anonymous";var c=Kn.URL||Kn.webkitURL;s.onload=function(){t(null,s),c.revokeObjectURL(s.src)};var m=new Kn.Blob([new Uint8Array(i.data)],{type:"image/png"});s.src=i.data.byteLength?c.createObjectURL(m):kl}})},Eo=2*Math.PI*6378137/2;function hc(e){var r=[Infinity,Infinity,-Infinity,-Infinity];return e.forEach(function(t){var n=t.coordinates;ni(r,n)}),r}function ni(e,r){return Array.isArray(r[0])?r.forEach(function(t){ni(e,t)}):(e[0]>r[0]&&(e[0]=r[0]),e[1]>r[1]&&(e[1]=r[1]),e[2]<r[0]&&(e[2]=r[0]),e[3]<r[1]&&(e[3]=r[1])),e}function Yn(e,r){return pc(e,r)}function pc(e,r){return Array.isArray(e[0])?e.map(function(t){return pc(t,r)}):r(e)}function So(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};e=wf(e,r);var n=e[0],i=e[1],s=n*Eo/180,c=Math.log(Math.tan((90+i)*Math.PI/360))/(Math.PI/180);return c=c*Eo/180,t.enable&&(s=Number(s.toFixed(t.decimal)),c=Number(c.toFixed(t.decimal))),e.length===3?[s,c,e[2]]:[s,c]}function Ou(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,t=e[0],n=e[1],i=t/Eo*180,s=n/Eo*180;return s=180/Math.PI*(2*Math.atan(Math.exp(s*Math.PI/180))-Math.PI/2),r!=null&&(i=Number(i.toFixed(r)),s=Number(s.toFixed(r))),e.length===3?[i,s,e[2]]:[i,s]}function $o(e){if(e==null)throw new Error("lng is required");return(e>180||e<-180)&&(e=e%360,e>180&&(e=-360+e),e<-180&&(e=360+e),e===0&&(e=0)),e}function Iu(e){if(e==null)throw new Error("lat is required");return(e>90||e<-90)&&(e=e%180,e>90&&(e=-180+e),e<-90&&(e=180+e),e===0&&(e=0)),e}function wf(e,r){if(r===!1)return e;var t=$o(e[0]),n=Iu(e[1]);return n>85&&(n=85),n<-85&&(n=-85),e.length===3?[t,n,e[2]]:[t,n]}function vo(e){var r=85.0511287798,t=Math.max(Math.min(r,e[1]),-r),n=256<<20,i=Math.PI/180,s=e[0]*i,c=t*i;c=Math.log(Math.tan(Math.PI/4+c/2));var m=.5/Math.PI,g=.5,x=-.5/Math.PI;return i=.5,s=n*(m*s+g),c=n*(x*c+i),[Math.floor(s),Math.floor(c)]}function ga(e){var r=.5/Math.PI,t=.5,n=-.5/Math.PI,i=.5,s=256<<20,c=ri()(e,2),m=c[0],g=c[1];m=(m/s-t)/r,g=(g/s-i)/n,g=(Math.atan(Math.pow(Math.E,g))-Math.PI/4)*2,i=Math.PI/180;var x=g/i,A=m/i;return[A,x]}function qo(e,r,t){var n=Hi(r[1]-e[1]),i=Hi(r[0]-e[0]),s=Hi(e[1]),c=Hi(r[1]),m=Math.pow(Math.sin(n/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(s)*Math.cos(c);return Kr(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),t="meters")}function hl(e){var r=Math.PI/180,t=85.0511287798,n=6378137,i=Math.max(Math.min(t,e[1]),-t),s=Math.sin(i*r),c=n*e[0]*r,m=n*Math.log((1+s)/(1-s))/2;return[c,m]}function Ru(e,r){var t=Math.abs(e[1][1]-e[0][1])*r,n=Math.abs(e[1][0]-e[0][0])*r;return[[e[0][0]-n,e[0][1]-t],[e[1][0]+n,e[1][1]+t]]}function $u(e,r){return e[0][0]<=r[0][0]&&e[0][1]<=r[0][1]&&e[1][0]>=r[1][0]&&e[1][1]>=r[1][1]}function mu(e){return[[e[0],e[1]],[e[2],e[3]]]}function Ys(e,r){return Math.sqrt(Math.pow(e[0]-r[0],2)+Math.pow(e[1]-r[1],2))}function Yl(e,r){return e[0]*r[0]+e[1]*r[1]}function gu(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Tf(e,r){return Math.acos(Yl(e,r)/(gu(e)*gu(r)))*180/Math.PI}function Kl(e,r){return r[0]>0?r[1]>0?90-Math.atan(r[1]/r[0])*180/Math.PI:90+Math.atan(-r[1]/r[0])*180/Math.PI:r[1]<0?180+(90-Math.atan(r[1]/r[0])*180/Math.PI):270+Math.atan(r[1]/-r[0])*180/Math.PI}function Mf(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!e||e.length<2)){for(var t=[0,1],n=0,i=[],s=0;s<e.length-1;s++){var c=e[s],m=e[s+1],g=Ys(c,m);n+=g;var x=[c[0]-m[0],c[1]-m[1]],A=Kl(t,x);if(s>0){var M=i[s-1].rotation;M-A>360-M+A&&(A=A+360)}i.push({start:c,end:m,dis:g,rotation:A,duration:0})}return i.map(function(R){R.duration=r*(R.dis/n)}),i}}var ch=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,t=arguments.length>1?arguments[1]:void 0;Ct()(this,e),S()(this,"limit",void 0),S()(this,"cache",void 0),S()(this,"destroy",void 0),S()(this,"order",void 0),this.limit=r,this.destroy=t||this.defaultDestroy,this.order=[],this.clear()}return Bt()(e,[{key:"clear",value:function(){var t=this;this.order.forEach(function(n){t.delete(n)}),this.cache={},this.order=[]}},{key:"get",value:function(t){var n=this.cache[t];return n&&(this.deleteOrder(t),this.appendOrder(t)),n}},{key:"set",value:function(t,n){this.cache[t]?(this.delete(t),this.cache[t]=n,this.appendOrder(t)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[t]=n,this.appendOrder(t))}},{key:"delete",value:function(t){var n=this.cache[t];n&&(this.deleteCache(t),this.deleteOrder(t),this.destroy(n,t))}},{key:"deleteCache",value:function(t){delete this.cache[t]}},{key:"deleteOrder",value:function(t){var n=this.order.findIndex(function(i){return i===t});n>=0&&this.order.splice(n,1)}},{key:"appendOrder",value:function(t){this.order.push(t)}},{key:"defaultDestroy",value:function(t,n){return null}}]),e}();function ku(e,r){e.forEach(function(t){!r[t]||(r[t]=r[t].bind(r))})}var dc=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16;Ct()(this,e),S()(this,"duration",16),S()(this,"timestamp",new Date().getTime()),this.duration=r}return Bt()(e,[{key:"run",value:function(t){var n=new Date().getTime(),i=n-this.timestamp;this.timestamp=n,i>=this.duration&&t()}}]),e}(),Qc=function(e,r,t){e.prototype=r.prototype=t,t.constructor=e};function pl(e,r){var t=Object.create(e.prototype);for(var n in r)t[n]=r[n];return t}function yu(){}var dl=.7,_u=1/dl,xs="\\s*([+-]?\\d+)\\s*",$l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Rs="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vc=/^#([0-9a-f]{3,8})$/,Pf=new RegExp("^rgb\\("+[xs,xs,xs]+"\\)$"),p=new RegExp("^rgb\\("+[Rs,Rs,Rs]+"\\)$"),f=new RegExp("^rgba\\("+[xs,xs,xs,$l]+"\\)$"),l=new RegExp("^rgba\\("+[Rs,Rs,Rs,$l]+"\\)$"),v=new RegExp("^hsl\\("+[$l,Rs,Rs]+"\\)$"),E=new RegExp("^hsla\\("+[$l,Rs,Rs,$l]+"\\)$"),T={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Qc(yu,q,{copy:function(r){return Object.assign(new this.constructor,this,r)},displayable:function(){return this.rgb().displayable()},hex:I,formatHex:I,formatHsl:k,formatRgb:W,toString:W});function I(){return this.rgb().formatHex()}function k(){return _t(this).formatHsl()}function W(){return this.rgb().formatRgb()}function q(e){var r,t;return e=(e+"").trim().toLowerCase(),(r=vc.exec(e))?(t=r[1].length,r=parseInt(r[1],16),t===6?he(r):t===3?new Re(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):t===8?ve(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):t===4?ve(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=Pf.exec(e))?new Re(r[1],r[2],r[3],1):(r=p.exec(e))?new Re(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=f.exec(e))?ve(r[1],r[2],r[3],r[4]):(r=l.exec(e))?ve(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=v.exec(e))?xt(r[1],r[2]/100,r[3]/100,1):(r=E.exec(e))?xt(r[1],r[2]/100,r[3]/100,r[4]):T.hasOwnProperty(e)?he(T[e]):e==="transparent"?new Re(NaN,NaN,NaN,0):null}function he(e){return new Re(e>>16&255,e>>8&255,e&255,1)}function ve(e,r,t,n){return n<=0&&(e=r=t=NaN),new Re(e,r,t,n)}function xe(e){return e instanceof yu||(e=q(e)),e?(e=e.rgb(),new Re(e.r,e.g,e.b,e.opacity)):new Re}function Ne(e,r,t,n){return arguments.length===1?xe(e):new Re(e,r,t,n==null?1:n)}function Re(e,r,t,n){this.r=+e,this.g=+r,this.b=+t,this.opacity=+n}Qc(Re,Ne,pl(yu,{brighter:function(r){return r=r==null?_u:Math.pow(_u,r),new Re(this.r*r,this.g*r,this.b*r,this.opacity)},darker:function(r){return r=r==null?dl:Math.pow(dl,r),new Re(this.r*r,this.g*r,this.b*r,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ye,formatHex:Ye,formatRgb:ze,toString:ze}));function Ye(){return"#"+Ge(this.r)+Ge(this.g)+Ge(this.b)}function ze(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Ge(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function xt(e,r,t,n){return n<=0?e=r=t=NaN:t<=0||t>=1?e=r=NaN:r<=0&&(e=NaN),new Vt(e,r,t,n)}function _t(e){if(e instanceof Vt)return new Vt(e.h,e.s,e.l,e.opacity);if(e instanceof yu||(e=q(e)),!e)return new Vt;if(e instanceof Vt)return e;e=e.rgb();var r=e.r/255,t=e.g/255,n=e.b/255,i=Math.min(r,t,n),s=Math.max(r,t,n),c=NaN,m=s-i,g=(s+i)/2;return m?(r===s?c=(t-n)/m+(t<n)*6:t===s?c=(n-r)/m+2:c=(r-t)/m+4,m/=g<.5?s+i:2-s-i,c*=60):m=g>0&&g<1?0:c,new Vt(c,m,g,e.opacity)}function fr(e,r,t,n){return arguments.length===1?_t(e):new Vt(e,r,t,n==null?1:n)}function Vt(e,r,t,n){this.h=+e,this.s=+r,this.l=+t,this.opacity=+n}Qc(Vt,fr,pl(yu,{brighter:function(r){return r=r==null?_u:Math.pow(_u,r),new Vt(this.h,this.s,this.l*r,this.opacity)},darker:function(r){return r=r==null?dl:Math.pow(dl,r),new Vt(this.h,this.s,this.l*r,this.opacity)},rgb:function(){var r=this.h%360+(this.h<0)*360,t=isNaN(r)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,s=2*n-i;return new Re(lr(r>=240?r-240:r+120,s,i),lr(r,s,i),lr(r<120?r+240:r-120,s,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var r=this.opacity;return r=isNaN(r)?1:Math.max(0,Math.min(1,r)),(r===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(r===1?")":", "+r+")")}}));function lr(e,r,t){return(e<60?r+(t-r)*e/60:e<180?t:e<240?r+(t-r)*(240-e)/60:r)*255}function vr(e){return typeof e=="string"?!!q(e):!1}function xr(e){var r=q(e),t=[0,0,0,0];return r!=null&&(t[0]=r.r/255,t[1]=r.g/255,t[2]=r.b/255,t[3]=r.opacity),t}function Hr(e){var r=e&&e[0],t=e&&e[1],n=e&&e[2],i=r+t*256+n*65536-1;return i}function cn(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}function Un(e){var r=Kn.document.createElement("canvas"),t=r.getContext("2d");r.width=256,r.height=1;for(var n=t.createLinearGradient(0,0,256,1),i=null,s=e.positions[0],c=e.positions[e.positions.length-1],m=0;m<e.colors.length;++m){var g=(e.positions[m]-s)/(c-s);n.addColorStop(g,e.colors[m])}return t.fillStyle=n,t.fillRect(0,0,256,1),i=new Uint8ClampedArray(t.getImageData(0,0,256,1).data),Pi?{data:i,width:256,height:1}:new ImageData(i,256,1)}var Jn;(function(e){e.CENTER="center",e.TOP="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e.BOTTOM="bottom",e["BOTTOM-LEFT"]="bottom-left",e.LEFT="left",e.RIGHT="right"})(Jn||(Jn={}));var oi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ji(e,r,t){var n=e.classList;for(var i in oi)oi.hasOwnProperty(i)&&n.remove("l7-".concat(t,"-anchor-").concat(i));n.add("l7-".concat(t,"-anchor-").concat(r))}function hi(e,r){return{enable:e,mask:255,func:{cmp:514,ref:r?1:0,mask:255}}}function Rn(e){if(e.length===0)throw new Error("max requires at least one data point");for(var r=e[0],t=1;t<e.length;t++)e[t]>r&&(r=e[t]);return r*1}function bi(e){if(e.length===0)throw new Error("min requires at least one data point");for(var r=e[0],t=1;t<e.length;t++)e[t]<r&&(r=e[t]);return r*1}function Oi(e){if(e.length===0)return 0;for(var r=e[0]*1,t=1;t<e.length;t++)r+=e[t]*1;return r}function Qn(e){if(e.length===0)throw new Error("mean requires at least one data point");return Oi(e)/e.length}function Ri(e){if(e.length===0)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();for(var r=e[0],t=NaN,n=0,i=1,s=1;s<e.length+1;s++)e[s]!==r?(i>n&&(n=i,t=r),i=1,r=e[s]):i++;return t*1}var si={min:bi,max:Rn,mean:Qn,sum:Oi,mode:Ri};function Di(e,r){return e.map(function(t){return t[r]})}function $i(e,r){return si[e](r)}function mo(e,r){var t=r.extent,n=t===void 0?[121.168,30.2828,121.384,30.4219]:t,i=new Promise(function(c){uo(e,function(m){c(m)})}),s={originData:e,images:i,_id:1,dataArray:[{_id:0,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return s}function uo(e,r){var t=e,n=[];if(typeof t=="string")Ko({url:t},function(c,m){n.push(m),r(n)});else{var i=t.length,s=0;t.forEach(function(c){Ko({url:c},function(m,g){s++,n.push(g),s===i&&r(n)})})}return mo}function Ro(e,r){var t=r.extent,n=r.width,i=r.height,s=r.min,c=r.max,m={_id:1,dataArray:[{_id:1,data:Array.from(e),width:n,height:i,min:s,max:c,coordinates:[[t[0],t[1]],[t[2],t[3]]]}]};return m}var Za=w("JBE3"),no=w.n(Za),Ks=w("4qC0"),Ba=w.n(Ks),vl=w("lSCD"),ks=w.n(vl),bs=w("BkRI"),Es=w.n(bs),Co=w("xp6e"),Ls=w("uhBA"),qu=w.n(Ls),Ll=w("mpbz"),ml=w.n(Ll);function xu(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function ql(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?xu(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):xu(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function bu(e,r){var t=r.radius,n=t===void 0?40:t,i=r.maxZoom,s=i===void 0?18:i,c=r.minZoom,m=c===void 0?0:c,g=r.zoom,x=g===void 0?2:g;if(e.pointIndex){var A=e.pointIndex.getClusters(e.extent,Math.floor(x));return e.dataArray=ko(A),e}var M=new ml.a({radius:n,minZoom:m,maxZoom:s}),R={type:"FeatureCollection",features:[]};return R.features=e.dataArray.map(function(F){return{type:"Feature",geometry:{type:"Point",coordinates:F.coordinates},properties:ql({},F)}}),M.load(R.features),M}function ko(e){return e.map(function(r,t){return ql({coordinates:r.geometry.coordinates,_id:t+1},r.properties)})}function Lu(e){if(e.length===0)throw new Error("max requires at least one data point");for(var r=e[0],t=1;t<e.length;t++)e[t]>r&&(r=e[t]);return r}function Jc(e){if(e.length===0)throw new Error("min requires at least one data point");for(var r=e[0],t=1;t<e.length;t++)e[t]<r&&(r=e[t]);return r}function Qu(e){if(e.length===0)return 0;for(var r=e[0],t=0,n,i=1;i<e.length;i++)n=r+e[i]*1,Math.abs(r)>=Math.abs(e[i])?t+=r-n+e[i]:t+=e[i]-n+r,r=n;return r+t*1}function jo(e){if(e.length===0)throw new Error("mean requires at least one data point");return Qu(e)/e.length}var Ds={min:Jc,max:Lu,mean:jo,sum:Qu};function Vo(e,r){return e.map(function(t){return t[r]*1})}function Fs(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Go(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Fs(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Fs(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function $s(e){var r=ef();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function ef(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Dl(e,r){if(Array.isArray(r))return r}var mc=function(e){Nr()(t,e);var r=$s(t);function t(n,i){var s;return Ct()(this,t),s=r.call(this),S()(oe()(s),"data",void 0),S()(oe()(s),"extent",void 0),S()(oe()(s),"hooks",{init:new Co.c}),S()(oe()(s),"parser",{type:"geojson"}),S()(oe()(s),"transforms",[]),S()(oe()(s),"cluster",!1),S()(oe()(s),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),S()(oe()(s),"mapService",void 0),S()(oe()(s),"invalidExtent",!1),S()(oe()(s),"dataArrayChanged",!1),S()(oe()(s),"originData",void 0),S()(oe()(s),"rawData",void 0),S()(oe()(s),"cfg",{}),S()(oe()(s),"clusterIndex",void 0),s.originData=n,s.initCfg(i),s.hooks.init.tap("parser",function(){s.excuteParser()}),s.hooks.init.tap("cluster",function(){s.initCluster()}),s.hooks.init.tap("transform",function(){s.executeTrans()}),s.init(),s}return Bt()(t,[{key:"setData",value:function(i,s){this.originData=i,this.dataArrayChanged=!1,this.initCfg(s),this.init(),this.emit("update")}},{key:"getClusters",value:function(i){return this.clusterIndex.getClusters(this.caculClusterExtent(2),i)}},{key:"getClustersLeaves",value:function(i){return this.clusterIndex.getLeaves(i,Infinity)}},{key:"updateClusterData",value:function(i){var s=this,c=this.clusterOptions,m=c.method,g=m===void 0?"sum":m,x=c.field,A=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(i));this.clusterOptions.zoom=i,A.forEach(function(M){M.id||(M.properties.point_count=1)}),(x||ks()(g))&&(A=A.map(function(M){var R=M.id;if(R){var F=s.clusterIndex.getLeaves(R,Infinity),Y=F.map(function(Ae){return Ae.properties}),ie;if(Ba()(g)&&x){var le=Vo(Y,x);ie=Ds[g](le)}ks()(g)&&(ie=g(Y)),M.properties.stat=ie}else M.properties.point_count=1;return M})),this.data=ut("geojson")({type:"FeatureCollection",features:A}),this.executeTrans()}},{key:"getFeatureById",value:function(i){var s=this.parser.type,c=s===void 0?"geojson":s;if(c==="geojson"&&!this.cluster){var m=i<this.originData.features.length?this.originData.features[i]:"null",g=Es()(m);if(this.transforms.length!==0||this.dataArrayChanged){var x=this.data.dataArray.find(function(A){return A._id===i});g.properties=x}return g}else return i<this.data.dataArray.length?this.data.dataArray[i]:"null"}},{key:"updateFeaturePropertiesById",value:function(i,s){this.data.dataArray=this.data.dataArray.map(function(c){return c._id===i?Go(Go({},c),s):c}),this.dataArrayChanged=!0,this.emit("update")}},{key:"getFeatureId",value:function(i,s){var c=this.data.dataArray.find(function(m){return m[i]===s});return c==null?void 0:c._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"caculClusterExtent",value:function(i){var s=[[-Infinity,-Infinity],[Infinity,Infinity]];return this.invalidExtent||(s=Ru(mu(this.extent),i)),s[0].concat(s[1])}},{key:"initCfg",value:function(i){this.cfg=no()(this.cfg,i,Dl);var s=this.cfg;s&&(s.parser&&(this.parser=s.parser),s.transforms&&(this.transforms=s.transforms),this.cluster=s.cluster||!1,s.clusterOptions&&(this.cluster=!0,this.clusterOptions=Go(Go({},this.clusterOptions),s.clusterOptions)))}},{key:"excuteParser",value:function(){var i=this.parser,s=i.type||"geojson";if(s==="imagetile"){this.data={tileurl:this.originData,dataArray:[]};return}var c=ut(s);this.data=c(this.originData,i),this.extent=hc(this.data.dataArray),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3]}},{key:"executeTrans",value:function(){var i=this,s=this.transforms;s.forEach(function(c){var m=c.type,g=gt(m)(i.data,c);Object.assign(i.data,g)})}},{key:"initCluster",value:function(){if(!!this.cluster){var i=this.clusterOptions||{};this.clusterIndex=bu(this.data,i)}}},{key:"init",value:function(){this.hooks.init.call(this)}}]),t}(Ls.EventEmitter);function Ju(e,r){var t=r.callback;return t&&(e.dataArray=e.dataArray.filter(t)),e}function gl(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Eu(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function Eu(e,r){if(!!e){if(typeof e=="string")return Bs(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Bs(e,r)}}function Bs(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Qo=6378e3;function zh(e,r){var t=e.dataArray,n=r.size,i=n===void 0?10:n,s=i/(2*Math.PI*Qo)*(256<<20)/2,c=Of(t,i),m=c.gridHash,g=c.gridOffset,x=Rf(m,g,r);return{yOffset:s,xOffset:s,radius:s,type:"grid",dataArray:x}}function Of(e,r){var t=Infinity,n=-Infinity,i,s=gl(e),c;try{for(s.s();!(c=s.n()).done;){var m=c.value;i=m.coordinates[1],Number.isFinite(i)&&(t=i<t?i:t,n=i>n?i:n)}}catch(nt){s.e(nt)}finally{s.f()}var g=(t+n)/2,x=gp(r,g);if(x.xOffset<=0||x.yOffset<=0)return{gridHash:{},gridOffset:x};var A={},M=gl(e),R;try{for(M.s();!(R=M.n()).done;){var F=R.value,Y=F.coordinates[1],ie=F.coordinates[0];if(Number.isFinite(Y)&&Number.isFinite(ie)){var le=Math.floor((Y+90)/x.yOffset),Ae=Math.floor((ie+180)/x.xOffset),Xe="".concat(le,"-").concat(Ae);A[Xe]=A[Xe]||{count:0,points:[]},A[Xe].count+=1,A[Xe].points.push(F)}}}catch(nt){M.e(nt)}finally{M.f()}return{gridHash:A,gridOffset:x}}function gp(e,r){var t=yp(e),n=If(r,e);return{yOffset:t,xOffset:n}}function yp(e){return e/Qo*(180/Math.PI)}function If(e,r){return r/Qo*(180/Math.PI)/Math.cos(e*Math.PI/180)}function Rf(e,r,t){return Object.keys(e).reduce(function(n,i,s){var c=i.split("-"),m=parseInt(c[0],10),g=parseInt(c[1],10),x={};if(t.field&&t.method){var A=G.getColumn(e[i].points,t.field);x[t.method]=G.statMap[t.method](A)}return Object.assign(x,{_id:s,coordinates:vo([-180+r.xOffset*(g+.5),-90+r.yOffset*(m+.5)]),rawData:e[i].points,count:e[i].count}),n.push(x),n},[])}var gc=Math.PI/3,uv=[0,gc,2*gc,3*gc,4*gc,5*gc];function fh(e){return e[0]}function _p(e){return e[1]}var Ql=function(){var e=0,r=0,t=1,n=1,i=fh,s=_p,c,m,g;function x(M){var R={},F=[],Y,ie=M.length;for(Y=0;Y<ie;++Y)if(!(isNaN(Ae=+i.call(null,le=M[Y],Y,M))||isNaN(Xe=+s.call(null,le,Y,M)))){var le,Ae,Xe,nt=Math.round(Xe=Xe/g),at=Math.round(Ae=Ae/m-(nt&1)/2),It=Xe-nt;if(Math.abs(It)*3>1){var Ot=Ae-at,Ut=at+(Ae<at?-1:1)/2,$t=nt+(Xe<nt?-1:1),Tr=Ae-Ut,Dr=Xe-$t;Ot*Ot+It*It>Tr*Tr+Dr*Dr&&(at=Ut+(nt&1?1:-1)/2,nt=$t)}var Sr=at+"-"+nt,Sn=R[Sr];Sn?Sn.push(le):(F.push(Sn=R[Sr]=[le]),Sn.x=(at+(nt&1)/2)*m,Sn.y=nt*g)}return F}function A(M){var R=0,F=0;return uv.map(function(Y){var ie=Math.sin(Y)*M,le=-Math.cos(Y)*M,Ae=ie-R,Xe=le-F;return R=ie,F=le,[Ae,Xe]})}return x.hexagon=function(M){return"m"+A(M==null?c:+M).join("l")+"z"},x.centers=function(){for(var M=[],R=Math.round(r/g),F=Math.round(e/m),Y=R*g;Y<n+c;Y+=g,++R)for(var ie=F*m+(R&1)*m/2;ie<t+m/2;ie+=m)M.push([ie,Y]);return M},x.mesh=function(){var M=A(c).slice(0,4).join("l");return x.centers().map(function(R){return"M"+R+"m"+M}).join("")},x.x=function(M){return arguments.length?(i=M,x):i},x.y=function(M){return arguments.length?(s=M,x):s},x.radius=function(M){return arguments.length?(c=+M,m=c*2*Math.sin(gc),g=c*1.5,x):c},x.size=function(M){return arguments.length?(e=r=0,t=+M[0],n=+M[1],x):[t-e,n-r]},x.extent=function(M){return arguments.length?(e=+M[0][0],r=+M[0][1],t=+M[1][0],n=+M[1][1],x):[[e,r],[t,n]]},x.radius(1)};function kf(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function tf(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?kf(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):kf(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var xp=6378e3;function lv(e,r){var t=e.dataArray,n=r.size,i=n===void 0?10:n,s=r.method,c=s===void 0?"sum":s,m=i/(2*Math.PI*xp)*(256<<20)/2,g=t.map(function(R){var F=vo(R.coordinates),Y=ri()(F,2),ie=Y[0],le=Y[1];return tf(tf({},R),{},{coordinates:[ie,le]})}),x=Ql().radius(m).x(function(R){return R.coordinates[0]}).y(function(R){return R.coordinates[1]}),A=x(g),M={dataArray:A.map(function(R,F){var Y;if(r.field&&c){var ie=G.getColumn(R,r.field);R[c]=G.statMap[c](ie)}return Y={},S()(Y,r.method,R[c]),S()(Y,"count",R.length),S()(Y,"rawData",R),S()(Y,"coordinates",[R.x,R.y]),S()(Y,"_id",F),Y}),radius:m,xOffset:m,yOffset:m,type:"hexagon"};return M}function pd(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function bp(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?pd(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pd(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function cv(e,r){var t=r.sourceField,n=r.targetField,i=r.data,s={};return i.forEach(function(c){s[c[t]]=c}),e.dataArray=e.dataArray.map(function(c){var m=c[n];return bp(bp({},c),s[m])}),e}function fv(e,r){var t=r.callback;return t&&(e.dataArray=e.dataArray.map(t)),e}ht("geojson",Ui),ht("image",mo),ht("csv",Ur),ht("json",dr),ht("raster",Ro),Be("cluster",bu),Be("filter",Ju),Be("join",cv),Be("map",fv),Be("grid",zh),Be("hexagon",lv);var Ep=qt,hv=pr,Lf=mc,pm=w("mNvP"),Cr=w("4cb6"),Uh=w("APxj"),dd=w.n(Uh),Kt={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")},Df=w("TIQr"),yc=w.n(Df);function Ff(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Bf(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Ff(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ff(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function _c(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Nf(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function Nf(e,r){if(!!e){if(typeof e=="string")return rf(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return rf(e,r)}}function rf(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var xc=30;function nf(e){var r=e.characterSet,t=e.getFontWidth,n=e.fontHeight,i=e.buffer,s=e.maxCanvasWidth,c=e.mapping,m=c===void 0?{}:c,g=e.xOffset,x=g===void 0?0:g,A=e.yOffset,M=A===void 0?0:A,R=0,F=x;Array.from(r).forEach(function(ie,le){if(!m[ie]){var Ae=t(ie,le);F+xc>s&&(F=0,R++),m[ie]={x:F,y:M+R*xc,width:xc,height:xc,advance:Ae},F+=xc}});var Y=n+i*2;return{mapping:m,xOffset:F,yOffset:M+R*Y,canvasHeight:hh(M+(R+1)*Y)}}function jh(e,r,t){var n=0,i=0,s=0,c=[],m={},g=_c(e),x;try{for(g.s();!(x=g.n()).done;){var A=x.value;if(!m[A.id]){var M=A.size;n+M+r>t&&(af(m,c,i),n=0,i=s+i+r,s=0,c=[]),c.push({icon:A,xOffset:n}),n=n+M+r,s=Math.max(s,M)}}}catch(F){g.e(F)}finally{g.f()}c.length>0&&af(m,c,i);var R=hh(s+i+r);return{mapping:m,canvasHeight:R}}function af(e,r,t){var n=_c(r),i;try{for(n.s();!(i=n.n()).done;){var s=i.value,c=s.icon,m=s.xOffset;e[c.id]=Bf(Bf({},c),{},{x:m,y:t,image:c.image,width:c.width,height:c.height})}}catch(g){n.e(g)}finally{n.f()}}function hh(e){return Math.pow(2,Math.ceil(Math.log2(e)))}var bc,Ec;function Js(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=ph(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function ph(e,r){if(!!e){if(typeof e=="string")return zf(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zf(e,r)}}function zf(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Vh(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function of(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Vh(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Vh(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Sc=yl(),sf="sans-serif",Sp="normal",pv=24,vd=3,md=.25,Cc=8,Cp=1024,uf=1,Ap=1,wp=3,dh=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function yl(){for(var e=[],r=32;r<128;r++)e.push(String.fromCharCode(r));return e}function _l(e,r,t,n){e.font="".concat(n," ").concat(t,"px ").concat(r),e.fillStyle="black",e.textBaseline="middle"}function Tp(e,r){for(var t=0;t<e.length;t++)r.data[4*t+3]=e[t]}var Uf=(bc=Object(Cr.injectable)(),bc(Ec=function(){function e(){Ct()(this,e),S()(this,"fontAtlas",void 0),S()(this,"iconFontMap",void 0),S()(this,"iconFontGlyphs",{}),S()(this,"fontOptions",void 0),S()(this,"key",void 0),S()(this,"cache",new ch(wp))}return Bt()(e,[{key:"scale",get:function(){return Ap}},{key:"canvas",get:function(){var t=this.cache.get(this.key);return t&&t.data}},{key:"mapping",get:function(){var t=this.cache.get(this.key);return t&&t.mapping}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:sf,fontWeight:Sp,characterSet:Sc,fontSize:pv,buffer:vd,sdf:!0,cutoff:md,radius:Cc,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(t){var n=this;t.forEach(function(i){n.iconFontGlyphs[i.name]=i.unicode})}},{key:"addIconFont",value:function(t,n){this.iconFontMap.set(t,n)}},{key:"getIconFontKey",value:function(t){return this.iconFontMap.get(t)||t}},{key:"getGlyph",value:function(t){return this.iconFontGlyphs[t]?String.fromCharCode(parseInt(this.iconFontGlyphs[t],16)):""}},{key:"setFontOptions",value:function(t){this.fontOptions=of(of({},this.fontOptions),t),this.key=this.getKey();var n=this.getNewChars(this.key,this.fontOptions.characterSet),i=this.cache.get(this.key);if(!(i&&n.length===0)){var s=this.generateFontAtlas(this.key,n,i);this.fontAtlas=s,this.cache.set(this.key,s)}}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(t,n,i){var s=this.fontOptions,c=s.fontFamily,m=s.fontWeight,g=s.fontSize,x=s.buffer,A=s.sdf,M=s.radius,R=s.cutoff,F=s.iconfont,Y=i&&i.data;Y||(Y=Kn.document.createElement("canvas"),Y.width=Cp);var ie=Y.getContext("2d");_l(ie,c,g,m);var le=nf(of({getFontWidth:function(Gs){return ie.measureText(Gs).width},fontHeight:g*Ap,buffer:x,characterSet:n,maxCanvasWidth:Cp},i&&{mapping:i.mapping,xOffset:i.xOffset,yOffset:i.yOffset})),Ae=le.mapping,Xe=le.canvasHeight,nt=le.xOffset,at=le.yOffset,It=ie.getImageData(0,0,Y.width,Y.height);if(Y.height=Xe,ie.putImageData(It,0,0),_l(ie,c,g,m),A){var Ot=new yc.a(g,x,M,R,c,m),Ut=ie.getImageData(0,0,Ot.size,Ot.size),$t=Js(n),Tr;try{for($t.s();!(Tr=$t.n()).done;){var Dr=Tr.value;if(F){var Sr=String.fromCharCode(parseInt(Dr.replace("&#x","").replace(";",""),16)),Sn=Ot.draw(Sr);Tp(Sn,Ut)}else Tp(Ot.draw(Dr),Ut);ie.putImageData(Ut,Ae[Dr].x,Ae[Dr].y)}}catch(To){$t.e(To)}finally{$t.f()}}else{var Dn=Js(n),ai;try{for(Dn.s();!(ai=Dn.n()).done;){var Ua=ai.value;ie.fillText(Ua,Ae[Ua].x,Ae[Ua].y+g*uf)}}catch(To){Dn.e(To)}finally{Dn.f()}}return{xOffset:nt,yOffset:at,mapping:Ae,data:Y,width:Y.width,height:Y.height}}},{key:"getKey",value:function(){return"key";var t,n,i,s,c,m,g,x}},{key:"getNewChars",value:function(t,n){var i=this.cache.get(t);if(!i)return n;var s=[],c=i.mapping,m=new Set(Object.keys(c)),g=new Set(n);return g.forEach(function(x){m.has(x)||s.push(x)}),s}}]),e}())||Ec),Du,Gh;function Mp(e){var r=Hh();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Hh(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var gd=3,Jo=1024,Fu=64,va=(Du=Object(Cr.injectable)(),Du(Gh=function(e){Nr()(t,e);var r=Mp(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"canvasHeight",128),S()(oe()(n),"texture",void 0),S()(oe()(n),"canvas",void 0),S()(oe()(n),"iconData",void 0),S()(oe()(n),"iconMap",void 0),S()(oe()(n),"ctx",void 0),S()(oe()(n),"loadingImageCount",0),n}return Bt()(t,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=Kn.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(i,s){var c=this,m=new Image;if(this.loadingImageCount++,this.hasImage(i))throw new Error("Image Id already exists");this.iconData.push({id:i,size:Fu}),this.updateIconMap(),this.loadImage(s).then(function(g){m=g;var x=c.iconData.find(function(A){return A.id===i});x&&(x.image=m,x.width=m.width,x.height=m.height),c.update()})}},{key:"addImageMini",value:function(i,s,c){var m=this,g=c.getSceneConfig().canvas,x=g.createImage();if(this.loadingImageCount++,this.hasImage(i))throw new Error("Image Id already exists");this.iconData.push({id:i,size:Fu}),this.updateIconMap(),this.loadImageMini(s,g).then(function(A){x=A;var M=m.iconData.find(function(R){return R.id===i});M&&(M.image=x,M.width=x.width,M.height=x.height),m.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(i){return this.iconMap.hasOwnProperty(i)}},{key:"removeImage",value:function(i){this.hasImage(i)&&(this.iconData=this.iconData.filter(function(s){return s.id!==i}),delete this.iconMap[i],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var i=this;this.canvas.width=Jo,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(s){var c=i.iconMap[s],m=c.x,g=c.y,x=c.image,A=c.width,M=A===void 0?64:A,R=c.height,F=R===void 0?64:R,Y=Math.max(M,F),ie=Y/Fu,le=F/ie,Ae=M/ie;x&&i.ctx.drawImage(x,m+(Fu-Ae)/2,g+(Fu-le)/2,Ae,le)})}},{key:"updateIconMap",value:function(){var i=jh(this.iconData,gd,Jo),s=i.mapping,c=i.canvasHeight;this.iconMap=s,this.canvasHeight=c}},{key:"loadImage",value:function(i){return new Promise(function(s,c){if(i instanceof HTMLImageElement){s(i);return}var m=new Image;m.crossOrigin="anonymous",m.onload=function(){s(m)},m.onerror=function(){c(new Error("Could not load image at "+i))},m.src=i instanceof File?URL.createObjectURL(i):i})}},{key:"loadImageMini",value:function(i,s){return new Promise(function(c,m){var g=s.createImage();g.crossOrigin="anonymous",g.onload=function(){c(g)},g.onerror=function(){m(new Error("Could not load image at "+i))},g.src=i})}}]),t}(Ls.EventEmitter))||Gh),Zi=1e-6,go=typeof Float32Array!="undefined"?Float32Array:Array,Ac=Math.random;function dm(e){go=e}var yd=Math.PI/180;function vm(e){return e*yd}function dv(e,r){return Math.abs(e-r)<=Zi*Math.max(1,Math.abs(e),Math.abs(r))}Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});function vv(){var e=new go(4);return go!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function _d(e){var r=new go(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function mv(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function gv(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function vh(e,r,t,n){var i=new go(4);return i[0]=e,i[1]=r,i[2]=t,i[3]=n,i}function Pp(e,r,t,n,i){return e[0]=r,e[1]=t,e[2]=n,e[3]=i,e}function Op(e,r){if(e===r){var t=r[1];e[1]=r[2],e[2]=t}else e[0]=r[0],e[1]=r[2],e[2]=r[1],e[3]=r[3];return e}function mh(e,r){var t=r[0],n=r[1],i=r[2],s=r[3],c=t*s-i*n;return c?(c=1/c,e[0]=s*c,e[1]=-n*c,e[2]=-i*c,e[3]=t*c,e):null}function Na(e,r){var t=r[0];return e[0]=r[3],e[1]=-r[1],e[2]=-r[2],e[3]=t,e}function xd(e){return e[0]*e[3]-e[2]*e[1]}function xl(e,r,t){var n=r[0],i=r[1],s=r[2],c=r[3],m=t[0],g=t[1],x=t[2],A=t[3];return e[0]=n*m+s*g,e[1]=i*m+c*g,e[2]=n*x+s*A,e[3]=i*x+c*A,e}function jf(e,r,t){var n=r[0],i=r[1],s=r[2],c=r[3],m=Math.sin(t),g=Math.cos(t);return e[0]=n*g+s*m,e[1]=i*g+c*m,e[2]=n*-m+s*g,e[3]=i*-m+c*g,e}function K(e,r,t){var n=r[0],i=r[1],s=r[2],c=r[3],m=t[0],g=t[1];return e[0]=n*m,e[1]=i*m,e[2]=s*g,e[3]=c*g,e}function ue(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=-t,e[3]=n,e}function He(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=r[1],e}function Ht(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function hr(e){return Math.hypot(e[0],e[1],e[2],e[3])}function ar(e,r,t,n){return e[2]=n[2]/n[0],t[0]=n[0],t[1]=n[1],t[3]=n[3]-e[2]*t[1],[e,r,t]}function Jt(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e}function Pr(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e}function jr(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]}function Vr(e,r){var t=e[0],n=e[1],i=e[2],s=e[3],c=r[0],m=r[1],g=r[2],x=r[3];return Math.abs(t-c)<=Zi*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(n-m)<=Zi*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(i-g)<=Zi*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(s-x)<=Zi*Math.max(1,Math.abs(s),Math.abs(x))}function Yr(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e}function Wr(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e}var pn=xl,on=Pr;function zr(){var e=new go(16);return go!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Gt(e){var r=new go(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Wt(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Br(e,r,t,n,i,s,c,m,g,x,A,M,R,F,Y,ie){var le=new go(16);return le[0]=e,le[1]=r,le[2]=t,le[3]=n,le[4]=i,le[5]=s,le[6]=c,le[7]=m,le[8]=g,le[9]=x,le[10]=A,le[11]=M,le[12]=R,le[13]=F,le[14]=Y,le[15]=ie,le}function Tn(e,r,t,n,i,s,c,m,g,x,A,M,R,F,Y,ie,le){return e[0]=r,e[1]=t,e[2]=n,e[3]=i,e[4]=s,e[5]=c,e[6]=m,e[7]=g,e[8]=x,e[9]=A,e[10]=M,e[11]=R,e[12]=F,e[13]=Y,e[14]=ie,e[15]=le,e}function cr(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function kn(e,r){if(e===r){var t=r[1],n=r[2],i=r[3],s=r[6],c=r[7],m=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=t,e[6]=r[9],e[7]=r[13],e[8]=n,e[9]=s,e[11]=r[14],e[12]=i,e[13]=c,e[14]=m}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}function Mn(e,r){var t=r[0],n=r[1],i=r[2],s=r[3],c=r[4],m=r[5],g=r[6],x=r[7],A=r[8],M=r[9],R=r[10],F=r[11],Y=r[12],ie=r[13],le=r[14],Ae=r[15],Xe=t*m-n*c,nt=t*g-i*c,at=t*x-s*c,It=n*g-i*m,Ot=n*x-s*m,Ut=i*x-s*g,$t=A*ie-M*Y,Tr=A*le-R*Y,Dr=A*Ae-F*Y,Sr=M*le-R*ie,Sn=M*Ae-F*ie,Dn=R*Ae-F*le,ai=Xe*Dn-nt*Sn+at*Sr+It*Dr-Ot*Tr+Ut*$t;return ai?(ai=1/ai,e[0]=(m*Dn-g*Sn+x*Sr)*ai,e[1]=(i*Sn-n*Dn-s*Sr)*ai,e[2]=(ie*Ut-le*Ot+Ae*It)*ai,e[3]=(R*Ot-M*Ut-F*It)*ai,e[4]=(g*Dr-c*Dn-x*Tr)*ai,e[5]=(t*Dn-i*Dr+s*Tr)*ai,e[6]=(le*at-Y*Ut-Ae*nt)*ai,e[7]=(A*Ut-R*at+F*nt)*ai,e[8]=(c*Sn-m*Dr+x*$t)*ai,e[9]=(n*Dr-t*Sn-s*$t)*ai,e[10]=(Y*Ot-ie*at+Ae*Xe)*ai,e[11]=(M*at-A*Ot-F*Xe)*ai,e[12]=(m*Tr-c*Sr-g*$t)*ai,e[13]=(t*Sr-n*Tr+i*$t)*ai,e[14]=(ie*nt-Y*It-le*Xe)*ai,e[15]=(A*It-M*nt+R*Xe)*ai,e):null}function qr(e,r){var t=r[0],n=r[1],i=r[2],s=r[3],c=r[4],m=r[5],g=r[6],x=r[7],A=r[8],M=r[9],R=r[10],F=r[11],Y=r[12],ie=r[13],le=r[14],Ae=r[15];return e[0]=m*(R*Ae-F*le)-M*(g*Ae-x*le)+ie*(g*F-x*R),e[1]=-(n*(R*Ae-F*le)-M*(i*Ae-s*le)+ie*(i*F-s*R)),e[2]=n*(g*Ae-x*le)-m*(i*Ae-s*le)+ie*(i*x-s*g),e[3]=-(n*(g*F-x*R)-m*(i*F-s*R)+M*(i*x-s*g)),e[4]=-(c*(R*Ae-F*le)-A*(g*Ae-x*le)+Y*(g*F-x*R)),e[5]=t*(R*Ae-F*le)-A*(i*Ae-s*le)+Y*(i*F-s*R),e[6]=-(t*(g*Ae-x*le)-c*(i*Ae-s*le)+Y*(i*x-s*g)),e[7]=t*(g*F-x*R)-c*(i*F-s*R)+A*(i*x-s*g),e[8]=c*(M*Ae-F*ie)-A*(m*Ae-x*ie)+Y*(m*F-x*M),e[9]=-(t*(M*Ae-F*ie)-A*(n*Ae-s*ie)+Y*(n*F-s*M)),e[10]=t*(m*Ae-x*ie)-c*(n*Ae-s*ie)+Y*(n*x-s*m),e[11]=-(t*(m*F-x*M)-c*(n*F-s*M)+A*(n*x-s*m)),e[12]=-(c*(M*le-R*ie)-A*(m*le-g*ie)+Y*(m*R-g*M)),e[13]=t*(M*le-R*ie)-A*(n*le-i*ie)+Y*(n*R-i*M),e[14]=-(t*(m*le-g*ie)-c*(n*le-i*ie)+Y*(n*g-i*m)),e[15]=t*(m*R-g*M)-c*(n*R-i*M)+A*(n*g-i*m),e}function yr(e){var r=e[0],t=e[1],n=e[2],i=e[3],s=e[4],c=e[5],m=e[6],g=e[7],x=e[8],A=e[9],M=e[10],R=e[11],F=e[12],Y=e[13],ie=e[14],le=e[15],Ae=r*c-t*s,Xe=r*m-n*s,nt=r*g-i*s,at=t*m-n*c,It=t*g-i*c,Ot=n*g-i*m,Ut=x*Y-A*F,$t=x*ie-M*F,Tr=x*le-R*F,Dr=A*ie-M*Y,Sr=A*le-R*Y,Sn=M*le-R*ie;return Ae*Sn-Xe*Sr+nt*Dr+at*Tr-It*$t+Ot*Ut}function ir(e,r,t){var n=r[0],i=r[1],s=r[2],c=r[3],m=r[4],g=r[5],x=r[6],A=r[7],M=r[8],R=r[9],F=r[10],Y=r[11],ie=r[12],le=r[13],Ae=r[14],Xe=r[15],nt=t[0],at=t[1],It=t[2],Ot=t[3];return e[0]=nt*n+at*m+It*M+Ot*ie,e[1]=nt*i+at*g+It*R+Ot*le,e[2]=nt*s+at*x+It*F+Ot*Ae,e[3]=nt*c+at*A+It*Y+Ot*Xe,nt=t[4],at=t[5],It=t[6],Ot=t[7],e[4]=nt*n+at*m+It*M+Ot*ie,e[5]=nt*i+at*g+It*R+Ot*le,e[6]=nt*s+at*x+It*F+Ot*Ae,e[7]=nt*c+at*A+It*Y+Ot*Xe,nt=t[8],at=t[9],It=t[10],Ot=t[11],e[8]=nt*n+at*m+It*M+Ot*ie,e[9]=nt*i+at*g+It*R+Ot*le,e[10]=nt*s+at*x+It*F+Ot*Ae,e[11]=nt*c+at*A+It*Y+Ot*Xe,nt=t[12],at=t[13],It=t[14],Ot=t[15],e[12]=nt*n+at*m+It*M+Ot*ie,e[13]=nt*i+at*g+It*R+Ot*le,e[14]=nt*s+at*x+It*F+Ot*Ae,e[15]=nt*c+at*A+It*Y+Ot*Xe,e}function tn(e,r,t){var n=t[0],i=t[1],s=t[2],c,m,g,x,A,M,R,F,Y,ie,le,Ae;return r===e?(e[12]=r[0]*n+r[4]*i+r[8]*s+r[12],e[13]=r[1]*n+r[5]*i+r[9]*s+r[13],e[14]=r[2]*n+r[6]*i+r[10]*s+r[14],e[15]=r[3]*n+r[7]*i+r[11]*s+r[15]):(c=r[0],m=r[1],g=r[2],x=r[3],A=r[4],M=r[5],R=r[6],F=r[7],Y=r[8],ie=r[9],le=r[10],Ae=r[11],e[0]=c,e[1]=m,e[2]=g,e[3]=x,e[4]=A,e[5]=M,e[6]=R,e[7]=F,e[8]=Y,e[9]=ie,e[10]=le,e[11]=Ae,e[12]=c*n+A*i+Y*s+r[12],e[13]=m*n+M*i+ie*s+r[13],e[14]=g*n+R*i+le*s+r[14],e[15]=x*n+F*i+Ae*s+r[15]),e}function sn(e,r,t){var n=t[0],i=t[1],s=t[2];return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*i,e[5]=r[5]*i,e[6]=r[6]*i,e[7]=r[7]*i,e[8]=r[8]*s,e[9]=r[9]*s,e[10]=r[10]*s,e[11]=r[11]*s,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Zr(e,r,t,n){var i=n[0],s=n[1],c=n[2],m=Math.hypot(i,s,c),g,x,A,M,R,F,Y,ie,le,Ae,Xe,nt,at,It,Ot,Ut,$t,Tr,Dr,Sr,Sn,Dn,ai,Ua;return m<Zi?null:(m=1/m,i*=m,s*=m,c*=m,g=Math.sin(t),x=Math.cos(t),A=1-x,M=r[0],R=r[1],F=r[2],Y=r[3],ie=r[4],le=r[5],Ae=r[6],Xe=r[7],nt=r[8],at=r[9],It=r[10],Ot=r[11],Ut=i*i*A+x,$t=s*i*A+c*g,Tr=c*i*A-s*g,Dr=i*s*A-c*g,Sr=s*s*A+x,Sn=c*s*A+i*g,Dn=i*c*A+s*g,ai=s*c*A-i*g,Ua=c*c*A+x,e[0]=M*Ut+ie*$t+nt*Tr,e[1]=R*Ut+le*$t+at*Tr,e[2]=F*Ut+Ae*$t+It*Tr,e[3]=Y*Ut+Xe*$t+Ot*Tr,e[4]=M*Dr+ie*Sr+nt*Sn,e[5]=R*Dr+le*Sr+at*Sn,e[6]=F*Dr+Ae*Sr+It*Sn,e[7]=Y*Dr+Xe*Sr+Ot*Sn,e[8]=M*Dn+ie*ai+nt*Ua,e[9]=R*Dn+le*ai+at*Ua,e[10]=F*Dn+Ae*ai+It*Ua,e[11]=Y*Dn+Xe*ai+Ot*Ua,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}function dn(e,r,t){var n=Math.sin(t),i=Math.cos(t),s=r[4],c=r[5],m=r[6],g=r[7],x=r[8],A=r[9],M=r[10],R=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=s*i+x*n,e[5]=c*i+A*n,e[6]=m*i+M*n,e[7]=g*i+R*n,e[8]=x*i-s*n,e[9]=A*i-c*n,e[10]=M*i-m*n,e[11]=R*i-g*n,e}function fn(e,r,t){var n=Math.sin(t),i=Math.cos(t),s=r[0],c=r[1],m=r[2],g=r[3],x=r[8],A=r[9],M=r[10],R=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=s*i-x*n,e[1]=c*i-A*n,e[2]=m*i-M*n,e[3]=g*i-R*n,e[8]=s*n+x*i,e[9]=c*n+A*i,e[10]=m*n+M*i,e[11]=g*n+R*i,e}function Ii(e,r,t){var n=Math.sin(t),i=Math.cos(t),s=r[0],c=r[1],m=r[2],g=r[3],x=r[4],A=r[5],M=r[6],R=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=s*i+x*n,e[1]=c*i+A*n,e[2]=m*i+M*n,e[3]=g*i+R*n,e[4]=x*i-s*n,e[5]=A*i-c*n,e[6]=M*i-m*n,e[7]=R*i-g*n,e}function Si(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function gn(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=r[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function bn(e,r,t){var n=t[0],i=t[1],s=t[2],c=Math.hypot(n,i,s),m,g,x;return c<Zi?null:(c=1/c,n*=c,i*=c,s*=c,m=Math.sin(r),g=Math.cos(r),x=1-g,e[0]=n*n*x+g,e[1]=i*n*x+s*m,e[2]=s*n*x-i*m,e[3]=0,e[4]=n*i*x-s*m,e[5]=i*i*x+g,e[6]=s*i*x+n*m,e[7]=0,e[8]=n*s*x+i*m,e[9]=i*s*x-n*m,e[10]=s*s*x+g,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function fi(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function wi(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qi(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function $a(e,r,t){var n=r[0],i=r[1],s=r[2],c=r[3],m=n+n,g=i+i,x=s+s,A=n*m,M=n*g,R=n*x,F=i*g,Y=i*x,ie=s*x,le=c*m,Ae=c*g,Xe=c*x;return e[0]=1-(F+ie),e[1]=M+Xe,e[2]=R-Ae,e[3]=0,e[4]=M-Xe,e[5]=1-(A+ie),e[6]=Y+le,e[7]=0,e[8]=R+Ae,e[9]=Y-le,e[10]=1-(A+F),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function yo(e,r){var t=new go(3),n=-r[0],i=-r[1],s=-r[2],c=r[3],m=r[4],g=r[5],x=r[6],A=r[7],M=n*n+i*i+s*s+c*c;return M>0?(t[0]=(m*c+A*n+g*s-x*i)*2/M,t[1]=(g*c+A*i+x*n-m*s)*2/M,t[2]=(x*c+A*s+m*i-g*n)*2/M):(t[0]=(m*c+A*n+g*s-x*i)*2,t[1]=(g*c+A*i+x*n-m*s)*2,t[2]=(x*c+A*s+m*i-g*n)*2),$a(e,r,t),e}function Qi(e,r){return e[0]=r[12],e[1]=r[13],e[2]=r[14],e}function es(e,r){var t=r[0],n=r[1],i=r[2],s=r[4],c=r[5],m=r[6],g=r[8],x=r[9],A=r[10];return e[0]=Math.hypot(t,n,i),e[1]=Math.hypot(s,c,m),e[2]=Math.hypot(g,x,A),e}function Ha(e,r){var t=new go(3);es(t,r);var n=1/t[0],i=1/t[1],s=1/t[2],c=r[0]*n,m=r[1]*i,g=r[2]*s,x=r[4]*n,A=r[5]*i,M=r[6]*s,R=r[8]*n,F=r[9]*i,Y=r[10]*s,ie=c+A+Y,le=0;return ie>0?(le=Math.sqrt(ie+1)*2,e[3]=.25*le,e[0]=(M-F)/le,e[1]=(R-g)/le,e[2]=(m-x)/le):c>A&&c>Y?(le=Math.sqrt(1+c-A-Y)*2,e[3]=(M-F)/le,e[0]=.25*le,e[1]=(m+x)/le,e[2]=(R+g)/le):A>Y?(le=Math.sqrt(1+A-c-Y)*2,e[3]=(R-g)/le,e[0]=(m+x)/le,e[1]=.25*le,e[2]=(M+F)/le):(le=Math.sqrt(1+Y-c-A)*2,e[3]=(m-x)/le,e[0]=(R+g)/le,e[1]=(M+F)/le,e[2]=.25*le),e}function Ho(e,r,t,n){var i=r[0],s=r[1],c=r[2],m=r[3],g=i+i,x=s+s,A=c+c,M=i*g,R=i*x,F=i*A,Y=s*x,ie=s*A,le=c*A,Ae=m*g,Xe=m*x,nt=m*A,at=n[0],It=n[1],Ot=n[2];return e[0]=(1-(Y+le))*at,e[1]=(R+nt)*at,e[2]=(F-Xe)*at,e[3]=0,e[4]=(R-nt)*It,e[5]=(1-(M+le))*It,e[6]=(ie+Ae)*It,e[7]=0,e[8]=(F+Xe)*Ot,e[9]=(ie-Ae)*Ot,e[10]=(1-(M+Y))*Ot,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Lo(e,r,t,n,i){var s=r[0],c=r[1],m=r[2],g=r[3],x=s+s,A=c+c,M=m+m,R=s*x,F=s*A,Y=s*M,ie=c*A,le=c*M,Ae=m*M,Xe=g*x,nt=g*A,at=g*M,It=n[0],Ot=n[1],Ut=n[2],$t=i[0],Tr=i[1],Dr=i[2],Sr=(1-(ie+Ae))*It,Sn=(F+at)*It,Dn=(Y-nt)*It,ai=(F-at)*Ot,Ua=(1-(R+Ae))*Ot,To=(le+Xe)*Ot,Gs=(Y+nt)*Ut,Hu=(le-Xe)*Ut,ws=(1-(R+ie))*Ut;return e[0]=Sr,e[1]=Sn,e[2]=Dn,e[3]=0,e[4]=ai,e[5]=Ua,e[6]=To,e[7]=0,e[8]=Gs,e[9]=Hu,e[10]=ws,e[11]=0,e[12]=t[0]+$t-(Sr*$t+ai*Tr+Gs*Dr),e[13]=t[1]+Tr-(Sn*$t+Ua*Tr+Hu*Dr),e[14]=t[2]+Dr-(Dn*$t+To*Tr+ws*Dr),e[15]=1,e}function cs(e,r){var t=r[0],n=r[1],i=r[2],s=r[3],c=t+t,m=n+n,g=i+i,x=t*c,A=n*c,M=n*m,R=i*c,F=i*m,Y=i*g,ie=s*c,le=s*m,Ae=s*g;return e[0]=1-M-Y,e[1]=A+Ae,e[2]=R-le,e[3]=0,e[4]=A-Ae,e[5]=1-x-Y,e[6]=F+ie,e[7]=0,e[8]=R+le,e[9]=F-ie,e[10]=1-x-M,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fs(e,r,t,n,i,s,c){var m=1/(t-r),g=1/(i-n),x=1/(s-c);return e[0]=s*2*m,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*g,e[6]=0,e[7]=0,e[8]=(t+r)*m,e[9]=(i+n)*g,e[10]=(c+s)*x,e[11]=-1,e[12]=0,e[13]=0,e[14]=c*s*2*x,e[15]=0,e}function hs(e,r,t,n,i){var s=1/Math.tan(r/2),c;return e[0]=s/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(c=1/(n-i),e[10]=(i+n)*c,e[14]=2*i*n*c):(e[10]=-1,e[14]=-2*n),e}var io=hs;function zi(e,r,t,n,i){var s=1/Math.tan(r/2),c;return e[0]=s/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(c=1/(n-i),e[10]=i*c,e[14]=i*n*c):(e[10]=-1,e[14]=-n),e}function Wo(e,r,t,n){var i=Math.tan(r.upDegrees*Math.PI/180),s=Math.tan(r.downDegrees*Math.PI/180),c=Math.tan(r.leftDegrees*Math.PI/180),m=Math.tan(r.rightDegrees*Math.PI/180),g=2/(c+m),x=2/(i+s);return e[0]=g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=-((c-m)*g*.5),e[9]=(i-s)*x*.5,e[10]=n/(t-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*t/(t-n),e[15]=0,e}function da(e,r,t,n,i,s,c){var m=1/(r-t),g=1/(n-i),x=1/(s-c);return e[0]=-2*m,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*g,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*x,e[11]=0,e[12]=(r+t)*m,e[13]=(i+n)*g,e[14]=(c+s)*x,e[15]=1,e}var Do=da;function vi(e,r,t,n,i,s,c){var m=1/(r-t),g=1/(n-i),x=1/(s-c);return e[0]=-2*m,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*g,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=x,e[11]=0,e[12]=(r+t)*m,e[13]=(i+n)*g,e[14]=s*x,e[15]=1,e}function Fi(e,r,t,n){var i,s,c,m,g,x,A,M,R,F,Y=r[0],ie=r[1],le=r[2],Ae=n[0],Xe=n[1],nt=n[2],at=t[0],It=t[1],Ot=t[2];return Math.abs(Y-at)<Zi&&Math.abs(ie-It)<Zi&&Math.abs(le-Ot)<Zi?cr(e):(A=Y-at,M=ie-It,R=le-Ot,F=1/Math.hypot(A,M,R),A*=F,M*=F,R*=F,i=Xe*R-nt*M,s=nt*A-Ae*R,c=Ae*M-Xe*A,F=Math.hypot(i,s,c),F?(F=1/F,i*=F,s*=F,c*=F):(i=0,s=0,c=0),m=M*c-R*s,g=R*i-A*c,x=A*s-M*i,F=Math.hypot(m,g,x),F?(F=1/F,m*=F,g*=F,x*=F):(m=0,g=0,x=0),e[0]=i,e[1]=m,e[2]=A,e[3]=0,e[4]=s,e[5]=g,e[6]=M,e[7]=0,e[8]=c,e[9]=x,e[10]=R,e[11]=0,e[12]=-(i*Y+s*ie+c*le),e[13]=-(m*Y+g*ie+x*le),e[14]=-(A*Y+M*ie+R*le),e[15]=1,e)}function ka(e,r,t,n){var i=r[0],s=r[1],c=r[2],m=n[0],g=n[1],x=n[2],A=i-t[0],M=s-t[1],R=c-t[2],F=A*A+M*M+R*R;F>0&&(F=1/Math.sqrt(F),A*=F,M*=F,R*=F);var Y=g*R-x*M,ie=x*A-m*R,le=m*M-g*A;return F=Y*Y+ie*ie+le*le,F>0&&(F=1/Math.sqrt(F),Y*=F,ie*=F,le*=F),e[0]=Y,e[1]=ie,e[2]=le,e[3]=0,e[4]=M*le-R*ie,e[5]=R*Y-A*le,e[6]=A*ie-M*Y,e[7]=0,e[8]=A,e[9]=M,e[10]=R,e[11]=0,e[12]=i,e[13]=s,e[14]=c,e[15]=1,e}function Ns(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Ss(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Fe(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e[6]=r[6]+t[6],e[7]=r[7]+t[7],e[8]=r[8]+t[8],e[9]=r[9]+t[9],e[10]=r[10]+t[10],e[11]=r[11]+t[11],e[12]=r[12]+t[12],e[13]=r[13]+t[13],e[14]=r[14]+t[14],e[15]=r[15]+t[15],e}function er(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e[4]=r[4]-t[4],e[5]=r[5]-t[5],e[6]=r[6]-t[6],e[7]=r[7]-t[7],e[8]=r[8]-t[8],e[9]=r[9]-t[9],e[10]=r[10]-t[10],e[11]=r[11]-t[11],e[12]=r[12]-t[12],e[13]=r[13]-t[13],e[14]=r[14]-t[14],e[15]=r[15]-t[15],e}function Lt(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e[6]=r[6]*t,e[7]=r[7]*t,e[8]=r[8]*t,e[9]=r[9]*t,e[10]=r[10]*t,e[11]=r[11]*t,e[12]=r[12]*t,e[13]=r[13]*t,e[14]=r[14]*t,e[15]=r[15]*t,e}function On(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e[4]=r[4]+t[4]*n,e[5]=r[5]+t[5]*n,e[6]=r[6]+t[6]*n,e[7]=r[7]+t[7]*n,e[8]=r[8]+t[8]*n,e[9]=r[9]+t[9]*n,e[10]=r[10]+t[10]*n,e[11]=r[11]+t[11]*n,e[12]=r[12]+t[12]*n,e[13]=r[13]+t[13]*n,e[14]=r[14]+t[14]*n,e[15]=r[15]+t[15]*n,e}function Vi(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]&&e[8]===r[8]&&e[9]===r[9]&&e[10]===r[10]&&e[11]===r[11]&&e[12]===r[12]&&e[13]===r[13]&&e[14]===r[14]&&e[15]===r[15]}function Me(e,r){var t=e[0],n=e[1],i=e[2],s=e[3],c=e[4],m=e[5],g=e[6],x=e[7],A=e[8],M=e[9],R=e[10],F=e[11],Y=e[12],ie=e[13],le=e[14],Ae=e[15],Xe=r[0],nt=r[1],at=r[2],It=r[3],Ot=r[4],Ut=r[5],$t=r[6],Tr=r[7],Dr=r[8],Sr=r[9],Sn=r[10],Dn=r[11],ai=r[12],Ua=r[13],To=r[14],Gs=r[15];return Math.abs(t-Xe)<=Zi*Math.max(1,Math.abs(t),Math.abs(Xe))&&Math.abs(n-nt)<=Zi*Math.max(1,Math.abs(n),Math.abs(nt))&&Math.abs(i-at)<=Zi*Math.max(1,Math.abs(i),Math.abs(at))&&Math.abs(s-It)<=Zi*Math.max(1,Math.abs(s),Math.abs(It))&&Math.abs(c-Ot)<=Zi*Math.max(1,Math.abs(c),Math.abs(Ot))&&Math.abs(m-Ut)<=Zi*Math.max(1,Math.abs(m),Math.abs(Ut))&&Math.abs(g-$t)<=Zi*Math.max(1,Math.abs(g),Math.abs($t))&&Math.abs(x-Tr)<=Zi*Math.max(1,Math.abs(x),Math.abs(Tr))&&Math.abs(A-Dr)<=Zi*Math.max(1,Math.abs(A),Math.abs(Dr))&&Math.abs(M-Sr)<=Zi*Math.max(1,Math.abs(M),Math.abs(Sr))&&Math.abs(R-Sn)<=Zi*Math.max(1,Math.abs(R),Math.abs(Sn))&&Math.abs(F-Dn)<=Zi*Math.max(1,Math.abs(F),Math.abs(Dn))&&Math.abs(Y-ai)<=Zi*Math.max(1,Math.abs(Y),Math.abs(ai))&&Math.abs(ie-Ua)<=Zi*Math.max(1,Math.abs(ie),Math.abs(Ua))&&Math.abs(le-To)<=Zi*Math.max(1,Math.abs(le),Math.abs(To))&&Math.abs(Ae-Gs)<=Zi*Math.max(1,Math.abs(Ae),Math.abs(Gs))}var ge=ir,qe=er;function At(){var e=new go(2);return go!=Float32Array&&(e[0]=0,e[1]=0),e}function Yt(e){var r=new go(2);return r[0]=e[0],r[1]=e[1],r}function it(e,r){var t=new go(2);return t[0]=e,t[1]=r,t}function Qe(e,r){return e[0]=r[0],e[1]=r[1],e}function ft(e,r,t){return e[0]=r,e[1]=t,e}function ye(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e}function Ke(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e}function Pe(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e}function bt(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e}function zt(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e}function Or(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e}function un(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e}function ln(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e}function En(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e}function rn(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e}function Zn(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e}function Pn(e,r){var t=r[0]-e[0],n=r[1]-e[1];return Math.hypot(t,n)}function zn(e,r){var t=r[0]-e[0],n=r[1]-e[1];return t*t+n*n}function jn(e){var r=e[0],t=e[1];return Math.hypot(r,t)}function Vn(e){var r=e[0],t=e[1];return r*r+t*t}function pi(e,r){return e[0]=-r[0],e[1]=-r[1],e}function ya(e,r){return e[0]=1/r[0],e[1]=1/r[1],e}function ts(e,r){var t=r[0],n=r[1],i=t*t+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=r[0]*i,e[1]=r[1]*i,e}function Su(e,r){return e[0]*r[0]+e[1]*r[1]}function Fl(e,r,t){var n=r[0]*t[1]-r[1]*t[0];return e[0]=e[1]=0,e[2]=n,e}function La(e,r,t,n){var i=r[0],s=r[1];return e[0]=i+n*(t[0]-i),e[1]=s+n*(t[1]-s),e}function ra(e,r){r=r||1;var t=Ac()*2*Math.PI;return e[0]=Math.cos(t)*r,e[1]=Math.sin(t)*r,e}function bl(e,r,t){var n=r[0],i=r[1];return e[0]=t[0]*n+t[2]*i,e[1]=t[1]*n+t[3]*i,e}function Bu(e,r,t){var n=r[0],i=r[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}function Ip(e,r,t){var n=r[0],i=r[1];return e[0]=t[0]*n+t[3]*i+t[6],e[1]=t[1]*n+t[4]*i+t[7],e}function el(e,r,t){var n=r[0],i=r[1];return e[0]=t[0]*n+t[4]*i+t[12],e[1]=t[1]*n+t[5]*i+t[13],e}function Rp(e,r,t,n){var i=r[0]-t[0],s=r[1]-t[1],c=Math.sin(n),m=Math.cos(n);return e[0]=i*m-s*c+t[0],e[1]=i*c+s*m+t[1],e}function yv(e,r){var t=e[0],n=e[1],i=r[0],s=r[1],c=Math.sqrt(t*t+n*n)*Math.sqrt(i*i+s*s),m=c&&(t*i+n*s)/c;return Math.acos(Math.min(Math.max(m,-1),1))}function gh(e){return e[0]=0,e[1]=0,e}function yh(e){return"vec2("+e[0]+", "+e[1]+")"}function mm(e,r){return e[0]===r[0]&&e[1]===r[1]}function rs(e,r){var t=e[0],n=e[1],i=r[0],s=r[1];return Math.abs(t-i)<=Zi*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(n-s)<=Zi*Math.max(1,Math.abs(n),Math.abs(s))}var kp=jn,lf=Ke,bd=Pe,Ed=bt,_v=Pn,Wh=zn,cf=Vn,gm=function(){var e=At();return function(r,t,n,i,s,c){var m,g;for(t||(t=2),n||(n=0),i?g=Math.min(i*t+n,r.length):g=r.length,m=n;m<g;m+=t)e[0]=r[m],e[1]=r[m+1],s(e,e,c),r[m]=e[0],r[m+1]=e[1];return r}}();function xv(){var e=new go(3);return go!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function $0(e){var r=new go(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function ps(e){var r=e[0],t=e[1],n=e[2];return Math.hypot(r,t,n)}function Vf(e,r,t){var n=new go(3);return n[0]=e,n[1]=r,n[2]=t,n}function ym(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function a(e,r,t,n){return e[0]=r,e[1]=t,e[2]=n,e}function o(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e}function u(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e}function d(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e[2]=r[2]*t[2],e}function y(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e[2]=r[2]/t[2],e}function b(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e}function C(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e}function P(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e[2]=Math.min(r[2],t[2]),e}function D(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e[2]=Math.max(r[2],t[2]),e}function j(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e}function X(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e}function ee(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e}function te(e,r){var t=r[0]-e[0],n=r[1]-e[1],i=r[2]-e[2];return Math.hypot(t,n,i)}function Ee(e,r){var t=r[0]-e[0],n=r[1]-e[1],i=r[2]-e[2];return t*t+n*n+i*i}function Le(e){var r=e[0],t=e[1],n=e[2];return r*r+t*t+n*n}function Oe(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e}function We(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e}function Ze(e,r){var t=r[0],n=r[1],i=r[2],s=t*t+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=r[0]*s,e[1]=r[1]*s,e[2]=r[2]*s,e}function yt(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function Dt(e,r,t){var n=r[0],i=r[1],s=r[2],c=t[0],m=t[1],g=t[2];return e[0]=i*g-s*m,e[1]=s*c-n*g,e[2]=n*m-i*c,e}function Xt(e,r,t,n){var i=r[0],s=r[1],c=r[2];return e[0]=i+n*(t[0]-i),e[1]=s+n*(t[1]-s),e[2]=c+n*(t[2]-c),e}function mr(e,r,t,n,i,s){var c=s*s,m=c*(2*s-3)+1,g=c*(s-2)+s,x=c*(s-1),A=c*(3-2*s);return e[0]=r[0]*m+t[0]*g+n[0]*x+i[0]*A,e[1]=r[1]*m+t[1]*g+n[1]*x+i[1]*A,e[2]=r[2]*m+t[2]*g+n[2]*x+i[2]*A,e}function sr(e,r,t,n,i,s){var c=1-s,m=c*c,g=s*s,x=m*c,A=3*s*m,M=3*g*c,R=g*s;return e[0]=r[0]*x+t[0]*A+n[0]*M+i[0]*R,e[1]=r[1]*x+t[1]*A+n[1]*M+i[1]*R,e[2]=r[2]*x+t[2]*A+n[2]*M+i[2]*R,e}function Qr(e,r){r=r||1;var t=Ac()*2*Math.PI,n=Ac()*2-1,i=Math.sqrt(1-n*n)*r;return e[0]=Math.cos(t)*i,e[1]=Math.sin(t)*i,e[2]=n*r,e}function nn(e,r,t){var n=r[0],i=r[1],s=r[2],c=t[3]*n+t[7]*i+t[11]*s+t[15];return c=c||1,e[0]=(t[0]*n+t[4]*i+t[8]*s+t[12])/c,e[1]=(t[1]*n+t[5]*i+t[9]*s+t[13])/c,e[2]=(t[2]*n+t[6]*i+t[10]*s+t[14])/c,e}function Gn(e,r,t){var n=r[0],i=r[1],s=r[2];return e[0]=n*t[0]+i*t[3]+s*t[6],e[1]=n*t[1]+i*t[4]+s*t[7],e[2]=n*t[2]+i*t[5]+s*t[8],e}function ei(e,r,t){var n=t[0],i=t[1],s=t[2],c=t[3],m=r[0],g=r[1],x=r[2],A=i*x-s*g,M=s*m-n*x,R=n*g-i*m,F=i*R-s*M,Y=s*A-n*R,ie=n*M-i*A,le=c*2;return A*=le,M*=le,R*=le,F*=2,Y*=2,ie*=2,e[0]=m+A+F,e[1]=g+M+Y,e[2]=x+R+ie,e}function $n(e,r,t,n){var i=[],s=[];return i[0]=r[0]-t[0],i[1]=r[1]-t[1],i[2]=r[2]-t[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=s[0]+t[0],e[1]=s[1]+t[1],e[2]=s[2]+t[2],e}function Bn(e,r,t,n){var i=[],s=[];return i[0]=r[0]-t[0],i[1]=r[1]-t[1],i[2]=r[2]-t[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=s[0]+t[0],e[1]=s[1]+t[1],e[2]=s[2]+t[2],e}function Ti(e,r,t,n){var i=[],s=[];return i[0]=r[0]-t[0],i[1]=r[1]-t[1],i[2]=r[2]-t[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],e[0]=s[0]+t[0],e[1]=s[1]+t[1],e[2]=s[2]+t[2],e}function ui(e,r){var t=e[0],n=e[1],i=e[2],s=r[0],c=r[1],m=r[2],g=Math.sqrt(t*t+n*n+i*i),x=Math.sqrt(s*s+c*c+m*m),A=g*x,M=A&&yt(e,r)/A;return Math.acos(Math.min(Math.max(M,-1),1))}function ti(e){return e[0]=0,e[1]=0,e[2]=0,e}function na(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function ki(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]}function xa(e,r){var t=e[0],n=e[1],i=e[2],s=r[0],c=r[1],m=r[2];return Math.abs(t-s)<=Zi*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(n-c)<=Zi*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-m)<=Zi*Math.max(1,Math.abs(i),Math.abs(m))}var gi=u,ua=d,qa=y,Xa=te,lo=Ee,co=ps,Ao=Le,zs=function(){var e=xv();return function(r,t,n,i,s,c){var m,g;for(t||(t=3),n||(n=0),i?g=Math.min(i*t+n,r.length):g=r.length,m=n;m<g;m+=t)e[0]=r[m],e[1]=r[m+1],e[2]=r[m+2],s(e,e,c),r[m]=e[0],r[m+1]=e[1],r[m+2]=e[2];return r}}();function Fo(){var e=new go(4);return go!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function eu(e){var r=new go(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function Cs(e,r,t,n){var i=new go(4);return i[0]=e,i[1]=r,i[2]=t,i[3]=n,i}function tu(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function ds(e,r,t,n,i){return e[0]=r,e[1]=t,e[2]=n,e[3]=i,e}function ns(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e}function is(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e}function ca(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e[2]=r[2]*t[2],e[3]=r[3]*t[3],e}function oa(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e[2]=r[2]/t[2],e[3]=r[3]/t[3],e}function za(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e[3]=Math.ceil(r[3]),e}function Ya(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e[3]=Math.floor(r[3]),e}function ru(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e[2]=Math.min(r[2],t[2]),e[3]=Math.min(r[3],t[3]),e}function Qa(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e[2]=Math.max(r[2],t[2]),e[3]=Math.max(r[3],t[3]),e}function fo(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e[3]=Math.round(r[3]),e}function Us(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e}function fa(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e}function wc(e,r){var t=r[0]-e[0],n=r[1]-e[1],i=r[2]-e[2],s=r[3]-e[3];return Math.hypot(t,n,i,s)}function tl(e,r){var t=r[0]-e[0],n=r[1]-e[1],i=r[2]-e[2],s=r[3]-e[3];return t*t+n*n+i*i+s*s}function Bl(e){var r=e[0],t=e[1],n=e[2],i=e[3];return Math.hypot(r,t,n,i)}function Nu(e){var r=e[0],t=e[1],n=e[2],i=e[3];return r*r+t*t+n*n+i*i}function js(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=-r[3],e}function ff(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e[3]=1/r[3],e}function hf(e,r){var t=r[0],n=r[1],i=r[2],s=r[3],c=t*t+n*n+i*i+s*s;return c>0&&(c=1/Math.sqrt(c)),e[0]=t*c,e[1]=n*c,e[2]=i*c,e[3]=s*c,e}function pf(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]}function Lp(e,r,t,n){var i=t[0]*n[1]-t[1]*n[0],s=t[0]*n[2]-t[2]*n[0],c=t[0]*n[3]-t[3]*n[0],m=t[1]*n[2]-t[2]*n[1],g=t[1]*n[3]-t[3]*n[1],x=t[2]*n[3]-t[3]*n[2],A=r[0],M=r[1],R=r[2],F=r[3];return e[0]=M*x-R*g+F*m,e[1]=-(A*x)+R*c-F*s,e[2]=A*g-M*c+F*i,e[3]=-(A*m)+M*s-R*i,e}function Tc(e,r,t,n){var i=r[0],s=r[1],c=r[2],m=r[3];return e[0]=i+n*(t[0]-i),e[1]=s+n*(t[1]-s),e[2]=c+n*(t[2]-c),e[3]=m+n*(t[3]-m),e}function Dp(e,r){r=r||1;var t,n,i,s,c,m;do t=Ac()*2-1,n=Ac()*2-1,c=t*t+n*n;while(c>=1);do i=Ac()*2-1,s=Ac()*2-1,m=i*i+s*s;while(m>=1);var g=Math.sqrt((1-c)/m);return e[0]=r*t,e[1]=r*n,e[2]=r*i*g,e[3]=r*s*g,e}function Zh(e,r,t){var n=r[0],i=r[1],s=r[2],c=r[3];return e[0]=t[0]*n+t[4]*i+t[8]*s+t[12]*c,e[1]=t[1]*n+t[5]*i+t[9]*s+t[13]*c,e[2]=t[2]*n+t[6]*i+t[10]*s+t[14]*c,e[3]=t[3]*n+t[7]*i+t[11]*s+t[15]*c,e}function Xh(e,r,t){var n=r[0],i=r[1],s=r[2],c=t[0],m=t[1],g=t[2],x=t[3],A=x*n+m*s-g*i,M=x*i+g*n-c*s,R=x*s+c*i-m*n,F=-c*n-m*i-g*s;return e[0]=A*x+F*-c+M*-g-R*-m,e[1]=M*x+F*-m+R*-c-A*-g,e[2]=R*x+F*-g+A*-m-M*-c,e[3]=r[3],e}function Sd(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Fp(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Cd(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]}function Gf(e,r){var t=e[0],n=e[1],i=e[2],s=e[3],c=r[0],m=r[1],g=r[2],x=r[3];return Math.abs(t-c)<=Zi*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(n-m)<=Zi*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(i-g)<=Zi*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(s-x)<=Zi*Math.max(1,Math.abs(s),Math.abs(x))}var Yh=is,Ad=ca,Kh=oa,Hf=wc,Bp=tl,wd=Bl,Td=Nu,$h=function(){var e=Fo();return function(r,t,n,i,s,c){var m,g;for(t||(t=4),n||(n=0),i?g=Math.min(i*t+n,r.length):g=r.length,m=n;m<g;m+=t)e[0]=r[m],e[1]=r[m+1],e[2]=r[m+2],e[3]=r[m+3],s(e,e,c),r[m]=e[0],r[m+1]=e[1],r[m+2]=e[2],r[m+3]=e[3];return r}}(),Np,zp,qh=(Np=Object(Cr.injectable)(),Np(zp=function(){function e(){Ct()(this,e),S()(this,"viewport",void 0),S()(this,"overridedViewProjectionMatrix",void 0),S()(this,"jitteredViewProjectionMatrix",void 0),S()(this,"jitteredProjectionMatrix",void 0),S()(this,"viewMatrixInverse",void 0),S()(this,"cameraPosition",void 0)}return Bt()(e,[{key:"init",value:function(){}},{key:"update",value:function(t){this.viewport=t,this.viewMatrixInverse=B.create(),B.invert(this.viewMatrixInverse,t.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var t=this.viewport.getCenter(),n=ri()(t,2),i=n[0],s=n[1];return[i,s]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(t,n){return this.viewport.projectFlat(t,n)}},{key:"setViewProjectionMatrix",value:function(t){this.overridedViewProjectionMatrix=t}},{key:"jitterProjectionMatrix",value:function(t,n){var i=B.fromTranslation(B.create(),[t,n,0]);this.jitteredProjectionMatrix=B.multiply(B.create(),i,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=B.multiply(B.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),e}())||zp),Up,Qh;function jp(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Vp(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function Vp(e,r){if(!!e){if(typeof e=="string")return _h(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _h(e,r)}}function _h(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Gp=(Up=Object(Cr.injectable)(),Up(Qh=function(){function e(){Ct()(this,e),S()(this,"container",void 0),S()(this,"controlCorners",void 0),S()(this,"controlContainer",void 0),S()(this,"scene",void 0),S()(this,"mapsService",void 0),S()(this,"controls",[]),S()(this,"unAddControls",[])}return Bt()(e,[{key:"init",value:function(t,n){this.container=t.container,this.scene=n,this.mapsService=n.get(Kt.IMapService),this.initControlPos()}},{key:"addControl",value:function(t,n){var i=n.get(Kt.IMapService);i.map?(t.addTo(this.scene),this.controls.push(t)):this.unAddControls.push(t)}},{key:"getControlByName",value:function(t){return this.controls.find(function(n){return n.controlOption.name===t})}},{key:"removeControl",value:function(t){var n=this.controls.indexOf(t);return n>-1&&this.controls.splice(n,1),t.remove(),this}},{key:"addControls",value:function(){var t=this;this.unAddControls.forEach(function(n){n.addTo(t.scene),t.controls.push(n)}),this.unAddControls=[]}},{key:"destroy",value:function(){var t=jp(this.controls),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;i.remove()}}catch(s){t.e(s)}finally{t.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var t=this.controlCorners={},n="l7-",i=this.controlContainer=N.create("div",n+"control-container",this.container);function s(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],m=c.map(function(g){return n+g}).join(" ");t[c.join("")]=N.create("div",m,i)}s(["top","left"]),s(["top","right"]),s(["bottom","left"]),s(["bottom","right"]),s(["top","center"]),s(["right","center"]),s(["left","center"]),s(["bottom","center"])}},{key:"clearControlPos",value:function(){for(var t in this.controlCorners)this.controlCorners[t]&&N.remove(this.controlCorners[t]);this.controlContainer&&N.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),e}())||Qh),xh,bh,Hp=(xh=Object(Cr.injectable)(),xh(bh=function(){function e(){Ct()(this,e),S()(this,"container",void 0),S()(this,"scene",void 0),S()(this,"mapsService",void 0),S()(this,"markers",[]),S()(this,"markerLayers",[]),S()(this,"unAddMarkers",[]),S()(this,"unAddMarkerLayers",[])}return Bt()(e,[{key:"addMarkerLayer",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(t),t.addTo(this.scene)):this.unAddMarkerLayers.push(t)}},{key:"removeMarkerLayer",value:function(t){t.destroy(),this.markerLayers.indexOf(t);var n=this.markerLayers.indexOf(t);n>-1&&this.markerLayers.splice(n,1)}},{key:"addMarker",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(t),t.addTo(this.scene)):this.unAddMarkers.push(t)}},{key:"addMarkers",value:function(){var t=this;this.unAddMarkers.forEach(function(n){n.addTo(t.scene),t.markers.push(n)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var t=this;this.unAddMarkerLayers.forEach(function(n){t.markerLayers.push(n),n.addTo(t.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(t){t.remove(),this.markers.indexOf(t);var n=this.markers.indexOf(t);n>-1&&this.markers.splice(n,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(Kt.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(t){t.remove()}),this.markers=[],this.markerLayers.forEach(function(t){t.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(t){t.destroy()}}]),e}())||bh),Md,Pd,_m=(Md=Object(Cr.injectable)(),Md(Pd=function(){function e(){Ct()(this,e),S()(this,"scene",void 0),S()(this,"popup",void 0),S()(this,"mapsService",void 0),S()(this,"unAddPopup",void 0)}return Bt()(e,[{key:"removePopup",value:function(t){t.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(t){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(t.addTo(this.scene),this.popup=t):this.unAddPopup=t}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(Kt.IMapService)}}]),e}())||Pd),bv=w("QkVN"),_o=w.n(bv),Ev={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},_y=Ev,xm,Jh;function wo(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function El(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?wo(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):wo(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var q0={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},Wf={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},Sv=(xm=Object(Cr.injectable)(),xm(Jh=function(){function e(){Ct()(this,e),S()(this,"sceneConfigCache",{}),S()(this,"layerConfigCache",{})}return Bt()(e,[{key:"getSceneConfig",value:function(t){return this.sceneConfigCache[t]}},{key:"getSceneWarninfo",value:function(t){return _y[t]}},{key:"setSceneConfig",value:function(t,n){this.sceneConfigCache[t]=El(El({},q0),n)}},{key:"getLayerConfig",value:function(t){return this.layerConfigCache[t]}},{key:"setLayerConfig",value:function(t,n,i){this.layerConfigCache[n]=El({},_o()({},this.sceneConfigCache[t],Wf,i))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),e}())||Jh),bm=w("yG8O"),Ei=w.n(bm),Mc=w("U+yc"),yi=w.n(Mc),Od=w("1ABj"),ep=Math.PI/180,Id=512,Rd=4003e4;function Cv(e){var r=e.latitude,t=r===void 0?0:r,n=e.zoom,i=n===void 0?0:n,s=e.scale,c=e.highPrecision,m=c===void 0?!1:c,g=e.flipY,x=g===void 0?!1:g;s=s!==void 0?s:Math.pow(2,i);var A={},M=Id*s,R=Math.cos(t*ep),F=M/360,Y=F/R,ie=M/Rd/R;if(A.pixelsPerMeter=[ie,-ie,ie],A.metersPerPixel=[1/ie,-1/ie,1/ie],A.pixelsPerDegree=[F,-Y,ie],A.degreesPerPixel=[1/F,-1/Y,1/ie],m){var le=ep*Math.tan(t*ep)/R,Ae=F*le/2,Xe=M/Rd*le,nt=Xe/Y*ie;A.pixelsPerDegree2=[0,-Ae,Xe],A.pixelsPerMeter2=[nt,0,nt],x&&(A.pixelsPerDegree2[1]=-A.pixelsPerDegree2[1],A.pixelsPerMeter2[1]=-A.pixelsPerMeter2[1])}return x&&(A.pixelsPerMeter[1]=-A.pixelsPerMeter[1],A.metersPerPixel[1]=-A.metersPerPixel[1],A.pixelsPerDegree[1]=-A.pixelsPerDegree[1],A.degreesPerPixel[1]=-A.degreesPerPixel[1]),A}var Vs;(function(e){e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.P20=5]="P20",e[e.P20_OFFSET=6]="P20_OFFSET",e[e.METER_OFFSET=7]="METER_OFFSET",e[e.P20_2=8]="P20_2"})(Vs||(Vs={}));var Zf={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},Av,wv,Tv,kd,zu,Ld=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Em=(Av=Object(Cr.injectable)(),wv=Object(Cr.inject)(Kt.ICameraService),Av(Tv=(kd=function(){function e(){Ct()(this,e),S()(this,"needRefresh",!0),Ei()(this,"cameraService",zu,this),S()(this,"coordinateSystem",void 0),S()(this,"viewportCenter",void 0),S()(this,"viewportCenterProjection",void 0),S()(this,"pixelsPerDegree",void 0),S()(this,"pixelsPerDegree2",void 0),S()(this,"pixelsPerMeter",void 0)}return Bt()(e,[{key:"refresh",value:function(){var t=this.cameraService.getZoom(),n=this.cameraService.getZoomScale(),i=this.cameraService.getCenter(),s=Cv({latitude:i[1],zoom:t}),c=s.pixelsPerMeter,m=s.pixelsPerDegree;this.viewportCenter=i,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=c,this.pixelsPerDegree=m,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Vs.LNGLAT||this.coordinateSystem===Vs.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Vs.LNGLAT_OFFSET?this.calculateLnglatOffset(i,t):this.coordinateSystem===Vs.P20_OFFSET&&this.calculateLnglatOffset(i,t,n,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(t){this.coordinateSystem=t}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(t,n,i,s){var c=Cv({latitude:t[1],zoom:n,scale:i,flipY:s,highPrecision:!0}),m=c.pixelsPerMeter,g=c.pixelsPerDegree,x=c.pixelsPerDegree2,A=this.cameraService.getViewMatrix(),M=this.cameraService.getProjectionMatrix(),R=B.multiply([],M,A),F=this.cameraService.projectFlat([Math.fround(t[0]),Math.fround(t[1])],Math.pow(2,n));this.viewportCenterProjection=U.transformMat4([],[F[0],F[1],0,1],R),A=this.cameraService.getViewMatrixUncentered()||A,R=B.multiply([],M,A),R=B.multiply([],R,Ld),this.cameraService.setViewProjectionMatrix(R),this.pixelsPerMeter=m,this.pixelsPerDegree=g,this.pixelsPerDegree2=x}}]),e}(),zu=yi()(kd.prototype,"cameraService",[wv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kd))||Tv),Pc=w("AfwI"),Wp=w.n(Pc),nu;(function(e){e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag"})(nu||(nu={}));var Xf,Eh,Sh,Yf,Ch;function Sm(e){var r=Cm();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Cm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Am={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},wm=(Xf=Object(Cr.injectable)(),Eh=Object(Cr.inject)(Kt.IMapService),Xf(Sh=(Yf=function(e){Nr()(t,e);var r=Sm(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),Ei()(oe()(n),"mapService",Ch,oe()(n)),S()(oe()(n),"hammertime",void 0),S()(oe()(n),"lastClickTime",0),S()(oe()(n),"lastClickXY",[-1,-1]),S()(oe()(n),"clickTimer",void 0),S()(oe()(n),"$containter",void 0),S()(oe()(n),"onDrag",function(m){var g=n.interactionEvent(m);g.type=Am[g.type],n.emit(nu.Drag,g)}),S()(oe()(n),"onHammer",function(m){m.srcEvent.stopPropagation();var g=n.interactionEvent(m);n.emit(nu.Hover,g)}),S()(oe()(n),"onTouch",function(m){var g=m.touches[0];n.onHover({x:g.pageX,y:g.pageY,type:"touch"})}),S()(oe()(n),"onHover",function(m){var g=m.clientX,x=m.clientY,A=g,M=x,R=m.type,F=n.mapService.getMapContainer();if(F)if(Pi)A=A-F.left-0,M=M-F.top-0;else{var Y=F.getBoundingClientRect(),ie=Y.top,le=Y.left;A=A-le-F.clientLeft,M=M-ie-F.clientTop}var Ae=n.mapService.containerToLngLat([A,M]);if(R==="click"){if(!Pi&&"ontouchstart"in document.documentElement)return;n.isDoubleTap(A,M,Ae);return}if(R==="touch"){n.isDoubleTap(A,M,Ae);return}R!=="click"&&R!=="dblclick"&&n.emit(nu.Hover,{x:A,y:M,lngLat:Ae,type:R,target:m})}),n}return Bt()(t,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(nu.Hover)}},{key:"triggerHover",value:function(i){var s=i.x,c=i.y;this.emit(nu.Hover,{x:s,y:c})}},{key:"triggerSelect",value:function(i){this.emit(nu.Select,{featureId:i})}},{key:"triggerActive",value:function(i){this.emit(nu.Active,{featureId:i})}},{key:"handleMiniEvent",value:function(i){this.onHover({clientX:i.touches[0].pageX,clientY:i.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var i=this.mapService.getMapContainer();if(i)if(Pi)Kn.document.addEventListener("touchstart",this.handleMiniEvent.bind(this));else{var s=new Wp.a.Manager(i);s.add(new Wp.a.Tap({event:"dblclick",taps:2})),s.add(new Wp.a.Tap({event:"click"})),s.add(new Wp.a.Pan({threshold:0,pointers:0})),s.add(new Wp.a.Press({})),s.on("dblclick click",this.onHammer),s.on("panstart panmove panend pancancel",this.onDrag),i.addEventListener("mousemove",this.onHover),i.addEventListener("mousedown",this.onHover,!0),i.addEventListener("mouseup",this.onHover),i.addEventListener("contextmenu",this.onHover),this.hammertime=s}}},{key:"removeEventListenerOnMap",value:function(){if(Pi)Kn.document.removeEventListener("touchstart",this.handleMiniEvent.bind(this));else{var i=this.mapService.getMapContainer();i&&(i.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),i.removeEventListener("mousedown",this.onHover),i.removeEventListener("mouseup",this.onHover),i.removeEventListener("contextmenu",this.onHover))}}},{key:"interactionEvent",value:function(i){var s=i.type,c=i.pointerType,m,g;c==="touch"?(g=Math.floor(i.pointers[0].clientY),m=Math.floor(i.pointers[0].clientX)):(g=Math.floor(i.srcEvent.y),m=Math.floor(i.srcEvent.x));var x=this.mapService.getMapContainer();if(x){var A=x.getBoundingClientRect(),M=A.top,R=A.left;m-=R,g-=M}var F=this.mapService.containerToLngLat([m,g]);return{x:m,y:g,lngLat:F,type:s,target:i.srcEvent}}},{key:"isDoubleTap",value:function(i,s,c){var m=this,g=new Date().getTime(),x="click";g-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-i)<10&&Math.abs(this.lastClickXY[1]-s)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),x="dblclick",this.emit(nu.Hover,{x:i,y:s,lngLat:c,type:x})):(this.lastClickTime=g,this.lastClickXY=[i,s],this.clickTimer=setTimeout(function(){x="click",m.emit(nu.Hover,{x:i,y:s,lngLat:c,type:x})},400))}}]),t}(qu.a),Ch=yi()(Yf.prototype,"mapService",[Eh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yf))||Sh),Mv=w("yXPU"),as=w.n(Mv),df=w("o0o1"),la=w.n(df),Pv=0;function Ov(e){if(Pi)return null;var r=e;if(typeof e=="string"&&(r=document.getElementById(e)),r){var t=document.createElement("div");return t.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,t.id="l7-scene-".concat(Pv++),t.classList.add("l7-scene"),r.appendChild(t),t}return null}function Tm(e){var r,t,n=!0;return e==null||(r=e.target)===null||r===void 0||(t=r.path)===null||t===void 0||t.map(function(i){if(i!=null&&i.classList){var s;i==null||(s=i.classList)===null||s===void 0||s.forEach(function(c){(c==="l7-marker"||c==="l7-popup")&&(n=!1)})}}),n}var ce;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(ce||(ce={}));var Iv,Rv,Dd,kv,tp,Lv,vf,Mm,Dv,Pm,Om;function Im(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Fd(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Im(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Im(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Q0=(Iv=Object(Cr.injectable)(),Rv=Object(Cr.inject)(Kt.IRendererService),Dd=Object(Cr.inject)(Kt.IGlobalConfigService),kv=Object(Cr.inject)(Kt.IInteractionService),tp=Object(Cr.inject)(Kt.ILayerService),Iv(Lv=(vf=function(){function e(){var r=this;Ct()(this,e),Ei()(this,"rendererService",Mm,this),Ei()(this,"configService",Dv,this),Ei()(this,"interactionService",Pm,this),Ei()(this,"layerService",Om,this),S()(this,"pickingFBO",void 0),S()(this,"width",0),S()(this,"height",0),S()(this,"alreadyInPicking",!1),S()(this,"pickBufferScale",1),S()(this,"lastPickTime",new Date().getTime()),S()(this,"pickFromPickingFBO",function(t,n){var i,s=n.x,c=n.y,m=n.lngLat,g=n.type,x=n.target,A=!1,M=r.rendererService,R=M.getViewportSize,F=M.readPixels,Y=M.getContainer,ie=r.getContainerSize(Y()),le=ie.width,Ae=ie.height;le*=N.DPR,Ae*=N.DPR;var Xe=t.getLayerConfig(),nt=Xe.enableHighlight,at=Xe.enableSelect,It=s*N.DPR,Ot=c*N.DPR;if(It>le-1*N.DPR||It<0||Ot>Ae-1*N.DPR||Ot<0)return!1;var Ut;if(Ut=F({x:Math.floor(It/r.pickBufferScale),y:Math.floor((Ae-(c+1)*N.DPR)/r.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:r.pickingFBO}),Ut[0]!==0||Ut[1]!==0||Ut[2]!==0){var $t=Hr(Ut),Tr=t.getSource().getFeatureById($t);$t!==t.getCurrentPickId()&&g==="mousemove"&&(g="mouseenter");var Dr={x:s,y:c,type:g,lngLat:m,featureId:$t,feature:Tr,target:x};Tr&&(A=!0,t.setCurrentPickId($t),r.triggerHoverOnLayer(t,Dr))}else{var Sr={x:s,y:c,lngLat:m,type:t.getCurrentPickId()!==null&&g==="mousemove"?"mouseout":"un"+g,featureId:null,target:x,feature:null};r.triggerHoverOnLayer(t,Fd(Fd({},Sr),{},{type:"unpick"})),r.triggerHoverOnLayer(t,Sr),t.setCurrentPickId(null)}if(nt&&r.highlightPickedFeature(t,Ut),at&&g==="click"&&((i=Ut)===null||i===void 0?void 0:i.toString())!==[0,0,0,0].toString()){var Sn=Hr(Ut);t.getCurrentSelectedId()===null||Sn!==t.getCurrentSelectedId()?(r.selectFeature(t,Ut),t.setCurrentSelectedId(Sn)):(r.selectFeature(t,new Uint8Array([0,0,0,0])),t.setCurrentSelectedId(null))}return A})}return Bt()(e,[{key:"init",value:function(t){var n=this.rendererService,i=n.createTexture2D,s=n.createFramebuffer,c=n.getViewportSize,m=n.getContainer,g=this.getContainerSize(m()),x=g.width,A=g.height;x*=N.DPR,A*=N.DPR,this.pickBufferScale=this.configService.getSceneConfig(t).pickBufferScale||1,this.pickingFBO=s({color:i({width:Math.round(x/this.pickBufferScale),height:Math.round(A/this.pickBufferScale),wrapS:ce.CLAMP_TO_EDGE,wrapT:ce.CLAMP_TO_EDGE})}),this.interactionService.on(nu.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var r=as()(la.a.mark(function n(i,s,c){var m=this,g,x,A,M;return la.a.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:g=this.rendererService,x=g.useFramebuffer,A=g.clear,M=g.getContainer,this.resizePickingFBO(),x(this.pickingFBO,function(){A({framebuffer:m.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),i.hooks.beforePickingEncode.call(),i.renderModels(),i.hooks.afterPickingEncode.call();var Y=m.pickBox(i,s);c(Y)});case 3:case"end":return F.stop()}},n,this)}));function t(n,i,s){return r.apply(this,arguments)}return t}()},{key:"pickBox",value:function(t,n){var i=this,s=n.map(function(Sr){var Sn=Sr<0?0:Sr;return Math.floor(Sn*N.DPR/i.pickBufferScale)}),c=ri()(s,4),m=c[0],g=c[1],x=c[2],A=c[3],M=this.rendererService,R=M.getViewportSize,F=M.readPixels,Y=M.getContainer,ie=this.getContainerSize(Y()),le=ie.width,Ae=ie.height;if(le*=N.DPR,Ae*=N.DPR,m>(le-1)*N.DPR/this.pickBufferScale||x<0||g>(Ae-1)*N.DPR/this.pickBufferScale||A<0)return[];var Xe,nt=Math.min(le/this.pickBufferScale,x)-m,at=Math.min(Ae/this.pickBufferScale,A)-g;Xe=F({x:m,y:Math.floor(Ae/this.pickBufferScale-(A+1)),width:nt,height:at,data:new Uint8Array(nt*at*4),framebuffer:this.pickingFBO});for(var It=[],Ot={},Ut=0;Ut<Xe.length/4;Ut=Ut+1){var $t=Xe.slice(Ut*4,Ut*4+4),Tr=Hr($t);if(Tr!==-1&&!Ot[Tr]){var Dr=t.getSource().getFeatureById(Tr);It.push(Fd(Fd({},Dr),{},{pickedFeatureIdx:Tr})),Ot[Tr]=!0}}return It}},{key:"getContainerSize",value:function(t){return t.getContext?{width:t.width/N.DPR,height:t.height/N.DPR}:t.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var r=as()(la.a.mark(function n(i){var s;return la.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.layerService.isMapDragging()||!this.layerService.getShaderPickStat())){m.next=2;break}return m.abrupt("return");case 2:if(this.alreadyInPicking=!0,s=new Date().getTime(),!(s-this.lastPickTime>10||i.type==="contextmenu"||i.type==="click")){m.next=7;break}return m.next=7,this.pickingLayers(i);case 7:this.lastPickTime=s,this.layerService.renderLayers(),this.alreadyInPicking=!1;case 10:case"end":return m.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"resizePickingFBO",value:function(){var t=this.rendererService.getContainer,n=this.getContainerSize(t()),i=n.width,s=n.height;i*=N.DPR,s*=N.DPR,(this.width!==i||this.height!==s)&&(this.pickingFBO.resize({width:Math.round(i/this.pickBufferScale),height:Math.round(s/this.pickBufferScale)}),this.width=i,this.height=s)}},{key:"pickingLayers",value:function(){var r=as()(la.a.mark(function n(i){var s=this,c,m,g,x,A;return la.a.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:c=this.rendererService,m=c.getViewportSize,g=c.useFramebuffer,x=c.clear,A=c.getContainer,this.resizePickingFBO(),g(this.pickingFBO,function(){var F=s.layerService.getRenderList();F.filter(function(Y){return Y.needPick(i.type)}).reverse().some(function(Y){x({framebuffer:s.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Y.hooks.beforePickingEncode.call(),Y.renderModels(!0),Y.hooks.afterPickingEncode.call();var ie=s.pickFromPickingFBO(Y,i);return ie&&!Y.getLayerConfig().enablePropagation})});case 3:case"end":return R.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"triggerHoverOnLayer",value:function(t,n){Tm(n)&&t.emit(n.type,n)}},{key:"highlightPickedFeature",value:function(t,n){var i=ri()(n,3),s=i[0],c=i[1],m=i[2];t.hooks.beforeHighlight.call([s,c,m])}},{key:"selectFeature",value:function(t,n){var i=ri()(n,3),s=i[0],c=i[1],m=i[2];t.hooks.beforeSelect.call([s,c,m])}}]),e}(),Mm=yi()(vf.prototype,"rendererService",[Rv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dv=yi()(vf.prototype,"configService",[Dd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pm=yi()(vf.prototype,"interactionService",[kv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Om=yi()(vf.prototype,"layerService",[tp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vf))||Lv),J0=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;Ct()(this,e),S()(this,"autoStart",void 0),S()(this,"startTime",0),S()(this,"oldTime",0),S()(this,"running",!1),S()(this,"elapsedTime",0),this.autoStart=r}return Bt()(e,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=(typeof performance=="undefined"?Date:performance).now();t=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=t}return t}}]),e}(),Rm,km,Jl,Zp,Fv,rp,Bd,Bv,xy;function RC(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=kC(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function kC(e,r){if(!!e){if(typeof e=="string")return by(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return by(e,r)}}function by(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var LC=(Rm=Object(Cr.injectable)(),km=Object(Cr.inject)(Kt.IRendererService),Jl=Object(Cr.inject)(Kt.IMapService),Zp=Object(Cr.inject)(Kt.IGlobalConfigService),Rm(Fv=(rp=function(){function e(){Ct()(this,e),S()(this,"clock",new J0),S()(this,"alreadyInRendering",!1),S()(this,"layers",[]),S()(this,"layerList",[]),S()(this,"layerRenderID",void 0),S()(this,"sceneInited",!1),S()(this,"animateInstanceCount",0),S()(this,"shaderPicking",!0),S()(this,"enableRender",!0),Ei()(this,"renderService",Bd,this),Ei()(this,"mapService",Bv,this),Ei()(this,"configService",xy,this)}return Bt()(e,[{key:"add",value:function(t){this.sceneInited&&t.init(),this.layers.push(t),this.updateLayerRenderList()}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(t){t.inited||t.init()}),this.updateLayerRenderList()}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(t){return this.layers.find(function(n){return n.id===t})}},{key:"getLayerByName",value:function(t){return this.layers.find(function(n){return n.name===t})}},{key:"cleanRemove",value:function(t,n){if(n){var i=n.layerChildren.indexOf(t);i>-1&&n.layerChildren.splice(i,1)}else{var s=this.layers.indexOf(t);s>-1&&this.layers.splice(s,1)}this.updateLayerRenderList(),this.renderLayers()}},{key:"remove",value:function(t,n){if(n){var i=n.layerChildren.indexOf(t);i>-1&&n.layerChildren.splice(i,1)}else{var s=this.layers.indexOf(t);s>-1&&this.layers.splice(s,1)}this.updateLayerRenderList(),t.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"setEnableRender",value:function(t){this.enableRender=t}},{key:"renderLayers",value:function(){var r=as()(la.a.mark(function n(){var i,s,c;return la.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){g.next=2;break}return g.abrupt("return");case 2:this.alreadyInRendering=!0,this.clear(),i=RC(this.layerList),g.prev=5,i.s();case 7:if((s=i.n()).done){g.next=20;break}if(c=s.value,c.hooks.beforeRenderData.call(),c.hooks.beforeRender.call(),!c.getLayerConfig().enableMultiPassRenderer){g.next=16;break}return g.next=14,c.renderMultiPass();case 14:g.next=17;break;case 16:c.render();case 17:c.hooks.afterRender.call();case 18:g.next=7;break;case 20:g.next=25;break;case 22:g.prev=22,g.t0=g.catch(5),i.e(g.t0);case 25:return g.prev=25,i.f(),g.finish(25);case 28:this.alreadyInRendering=!1;case 29:case"end":return g.stop()}},n,this,[[5,22,25,28]])}));function t(){return r.apply(this,arguments)}return t}()},{key:"updateLayerRenderList",value:function(){var t=this;this.layerList=[],this.layers.filter(function(n){return n.inited}).filter(function(n){return n.isVisible()}).forEach(function(n){t.layerList.push(n),n.layerChildren.filter(function(i){return i.inited}).filter(function(i){return i.isVisible()}).forEach(function(i){t.layerList.push(i)})}),this.layerList.sort(function(n,i){return n.zIndex-i.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(t){t.layerChildren&&(t.layerChildren.forEach(function(n){return n.destroy()}),t.layerChildren=[]),t.destroy()}),this.layers=[],this.layerList=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++==0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount==0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"isMapDragging",value:function(){return this.mapService.dragging}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=Kn.requestAnimationFrame(this.runRender.bind(this))}},{key:"clear",value:function(){var t=xr(this.mapService.bgColor);this.renderService.clear({color:t,depth:1,stencil:0,framebuffer:null})}},{key:"stopRender",value:function(){Kn.cancelAnimationFrame(this.layerRenderID)}}]),e}(),Bd=yi()(rp.prototype,"renderService",[km],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bv=yi()(rp.prototype,"mapService",[Jl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xy=yi()(rp.prototype,"configService",[Zp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rp))||Fv),DC=w("QILm"),Ah=w.n(DC),FC=w("J2iB"),wh=w.n(FC),BC=function(){function e(r){var t=this;Ct()(this,e),S()(this,"name",void 0),S()(this,"type",void 0),S()(this,"scale",void 0),S()(this,"descriptor",void 0),S()(this,"featureBufferLayout",[]),S()(this,"needRescale",!1),S()(this,"needRemapping",!1),S()(this,"needRegenerateVertices",!1),S()(this,"featureRange",{startIndex:0,endIndex:Infinity}),S()(this,"vertexAttribute",void 0),S()(this,"defaultCallback",function(n){if(n.length===0){var i;return((i=t.scale)===null||i===void 0?void 0:i.defaultValues)||[]}return n.map(function(s,c){var m,g=(m=t.scale)===null||m===void 0?void 0:m.scalers[c].func,x=g(s);return x})}),this.setProps(r)}return Bt()(e,[{key:"setProps",value:function(t){Object.assign(this,t)}},{key:"mapping",value:function(t){var n;if((n=this.scale)!==null&&n!==void 0&&n.callback){var i,s=(i=this.scale)===null||i===void 0?void 0:i.callback.apply(i,Pt()(t));if(!wh()(s))return[s]}return this.defaultCallback(t)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),e}(),NC=["buffer","update","name"],Nv,Ey,Sy,Cy,eg,Ay;function wy(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function tg(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?wy(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):wy(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function WD(e){return new Promise(function(r){return setTimeout(r,e)})}var zC=(Nv={},S()(Nv,ce.FLOAT,4),S()(Nv,ce.UNSIGNED_BYTE,1),S()(Nv,ce.UNSIGNED_SHORT,2),Nv),UC=(Ey=Object(Cr.injectable)(),Sy=Object(Cr.inject)(Kt.IRendererService),Ey(Cy=(eg=function(){function e(){Ct()(this,e),S()(this,"attributesAndIndices",void 0),Ei()(this,"rendererService",Ay,this),S()(this,"attributes",[]),S()(this,"triangulation",void 0),S()(this,"featureLayout",{sizePerElement:0,elements:[]})}return Bt()(e,[{key:"registerStyleAttribute",value:function(t){var n=this.getLayerStyleAttribute(t.name||"");return n?n.setProps(t):(n=new BC(t),this.attributes.push(n)),n}},{key:"updateStyleAttribute",value:function(t,n,i){var s=this.getLayerStyleAttribute(t);s||(s=this.registerStyleAttribute(tg(tg({},n),{},{name:t})));var c=n.scale;c&&s&&(s.scale=c,s.needRescale=!0,s.needRemapping=!0,s.needRegenerateVertices=!0,i&&i.featureRange&&(s.featureRange=i.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(t){return this.attributes.find(function(n){return n.name===t})}},{key:"getLayerAttributeScale",value:function(t){var n,i=this.getLayerStyleAttribute(t),s=i==null||(n=i.scale)===null||n===void 0?void 0:n.scalers;return s&&s[0]?s[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3?arguments[3]:void 0,c=this.attributes.find(function(at){return at.name===t});if(c&&c.descriptor){var m=c.descriptor,g=m.update,x=m.buffer,A=m.size,M=A===void 0?0:A,R=zC[x.type||ce.FLOAT];if(g){var F=this.featureLayout,Y=F.elements,ie=F.sizePerElement,le=Y.slice(i,s);if(!le.length)return;var Ae=le[0].offset,Xe=Ae*M*R,nt=le.map(function(at,It){for(var Ot=at.featureIdx,Ut=at.vertices,$t=at.normals,Tr=Ut.length/ie,Dr=[],Sr=0;Sr<Tr;Sr++){var Sn=$t?$t.slice(Sr*3,Sr*3+3):[];Dr.push.apply(Dr,Pt()(g(n[Ot],Ot,Ut.slice(Sr*ie,Sr*ie+ie),It,Sn)))}return Dr}).reduce(function(at,It){return at.push.apply(at,Pt()(It)),at},[]);c.vertexAttribute.updateBuffer({data:nt,offset:Xe})}}}},{key:"createAttributesAndIndices",value:function(t,n,i){var s=this;this.featureLayout={sizePerElement:0,elements:[]},n&&(this.triangulation=n);var c=this.attributes.map(function(Xe){return Xe.resetDescriptor(),Xe.descriptor}),m=0,g=[],x=[],A=[],M=3;t.forEach(function(Xe,nt){var at=s.triangulation(Xe,i),It=at.indices,Ot=at.vertices,Ut=at.normals,$t=at.size;It.forEach(function(Sn){x.push(Sn+m)}),M=$t;var Tr=Ot.length/$t;s.featureLayout.sizePerElement=M,s.featureLayout.elements.push({featureIdx:nt,vertices:Ot,normals:Ut,offset:m}),m+=Tr;for(var Dr=function(Dn){var ai=(Ut==null?void 0:Ut.slice(Dn*3,Dn*3+3))||[],Ua=Ot.slice(Dn*$t,Dn*$t+$t);c.forEach(function(To,Gs){if(To&&To.update){var Hu;(Hu=To.buffer.data).push.apply(Hu,Pt()(To.update(Xe,nt,Ua,Dn,ai)))}})},Sr=0;Sr<Tr;Sr++)Dr(Sr)});var R=this.rendererService,F=R.createAttribute,Y=R.createBuffer,ie=R.createElements,le={};c.forEach(function(Xe,nt){if(Xe){var at=Xe.buffer,It=Xe.update,Ot=Xe.name,Ut=Ah()(Xe,NC),$t=F(tg({buffer:Y(at)},Ut));le[Xe.name||""]=$t,s.attributes[nt].vertexAttribute=$t}});var Ae=ie({data:x,type:ce.UNSIGNED_INT,count:x.length});return this.attributesAndIndices={attributes:le,elements:Ae},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var t;this.attributes.forEach(function(n){n.vertexAttribute&&n.vertexAttribute.destroy()}),(t=this.attributesAndIndices)===null||t===void 0||t.elements.destroy(),this.attributes=[]}}]),e}(),Ay=yi()(eg.prototype,"rendererService",[Sy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eg))||Cy),Ty=w("iegG"),jC=w.n(Ty),My,Py,Oy,Iy,Ry,ky,Ly,Dy,Fy,By,Ny,zy,Uy,jy,Vy,Gy,Hy,Uu,Wy,Zy,Xy,Yy,Ky,$y,qy,Qy,Jy,e_,t_,r_,n_,i_,a_;function VC(e){var r=GC();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function GC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var HC=(My=Object(Cr.injectable)(),Py=Object(Cr.inject)(Kt.SceneID),Oy=Object(Cr.inject)(Kt.IIconService),Iy=Object(Cr.inject)(Kt.IFontService),Ry=Object(Cr.inject)(Kt.IControlService),ky=Object(Cr.inject)(Kt.IGlobalConfigService),Ly=Object(Cr.inject)(Kt.IMapService),Dy=Object(Cr.inject)(Kt.ICoordinateSystemService),Fy=Object(Cr.inject)(Kt.IRendererService),By=Object(Cr.inject)(Kt.ILayerService),Ny=Object(Cr.inject)(Kt.ICameraService),zy=Object(Cr.inject)(Kt.IInteractionService),Uy=Object(Cr.inject)(Kt.IPickingService),jy=Object(Cr.inject)(Kt.IShaderModuleService),Vy=Object(Cr.inject)(Kt.IMarkerService),Gy=Object(Cr.inject)(Kt.IPopupService),My(Hy=(Uu=function(e){Nr()(t,e);var r=VC(t);function t(){var n;return Ct()(this,t),n=r.call(this),S()(oe()(n),"destroyed",!1),S()(oe()(n),"loaded",!1),S()(oe()(n),"loadFont",!1),S()(oe()(n),"fontFamily",""),Ei()(oe()(n),"id",Wy,oe()(n)),Ei()(oe()(n),"iconService",Zy,oe()(n)),Ei()(oe()(n),"fontService",Xy,oe()(n)),Ei()(oe()(n),"controlService",Yy,oe()(n)),Ei()(oe()(n),"configService",Ky,oe()(n)),Ei()(oe()(n),"map",$y,oe()(n)),Ei()(oe()(n),"coordinateSystemService",qy,oe()(n)),Ei()(oe()(n),"rendererService",Qy,oe()(n)),Ei()(oe()(n),"layerService",Jy,oe()(n)),Ei()(oe()(n),"cameraService",e_,oe()(n)),Ei()(oe()(n),"interactionService",t_,oe()(n)),Ei()(oe()(n),"pickingService",r_,oe()(n)),Ei()(oe()(n),"shaderModuleService",n_,oe()(n)),Ei()(oe()(n),"markerService",i_,oe()(n)),Ei()(oe()(n),"popupService",a_,oe()(n)),S()(oe()(n),"inited",!1),S()(oe()(n),"initPromise",void 0),S()(oe()(n),"rendering",!1),S()(oe()(n),"$container",void 0),S()(oe()(n),"canvas",void 0),S()(oe()(n),"markerContainer",void 0),S()(oe()(n),"hooks",void 0),S()(oe()(n),"handleWindowResized",function(){n.emit("resize"),n.$container&&(n.initContainer(),N.triggerResize(),n.coordinateSystemService.needRefresh=!0,n.render())}),S()(oe()(n),"handleMapCameraChanged",function(i){n.cameraService.update(i),n.render()}),n.hooks={init:new Co.a},n}return Bt()(t,[{key:"init",value:function(i){var s=this;this.configService.setSceneConfig(this.id,i),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return s.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",as()(la.a.mark(function c(){return la.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,new Promise(function(x){s.map.onCameraChanged(function(A){s.cameraService.init(),s.cameraService.update(A),s.map.version!=="GAODE2.x"&&x()}),s.map.version!=="GAODE2.x"?s.map.init():x()});case 2:if(!(s.map.version==="GAODE2.x"&&s.map.initViewPort)){g.next=6;break}return g.next=5,s.map.init();case 5:s.map.initViewPort();case 6:s.map.onCameraChanged(s.handleMapCameraChanged),s.map.addMarkerContainer(),s.markerService.addMarkers(),s.markerService.addMarkerLayers(),s.popupService.initPopup(),s.interactionService.init(),s.interactionService.on(nu.Drag,s.addSceneEvent.bind(s));case 13:case"end":return g.stop()}},c)}))),this.hooks.init.tapPromise("initRenderer",as()(la.a.mark(function c(){var m,g;return la.a.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(m=Ov(s.configService.getSceneConfig(s.id).id||""),s.$container=m,!m){A.next=11;break}return s.canvas=N.create("canvas","",m),s.setCanvas(),A.next=7,s.rendererService.init(s.canvas,s.configService.getSceneConfig(s.id));case 7:jC()(s.$container,s.handleWindowResized),Kn.matchMedia&&((g=Kn.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||g===void 0||g.addListener(s.handleWindowResized)),A.next=12;break;case 11:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:s.pickingService.init(s.id);case 13:case"end":return A.stop()}},c)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"initMiniScene",value:function(i){var s=this;this.configService.setSceneConfig(this.id,i),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return s.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",as()(la.a.mark(function c(){return la.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,new Promise(function(x){s.map.onCameraChanged(function(A){s.cameraService.init(),s.cameraService.update(A),s.map.version!=="GAODE2.x"&&x()}),s.map.initMiniMap()});case 2:s.map.onCameraChanged(s.handleMapCameraChanged),s.interactionService.init(),s.interactionService.on(nu.Drag,s.addSceneEvent.bind(s));case 5:case"end":return g.stop()}},c)}))),this.hooks.init.tapPromise("initRenderer",as()(la.a.mark(function c(){var m;return la.a.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(m=i.canvas,s.$container=m||null,!s.$container){x.next=7;break}return x.next=5,s.rendererService.init(i.canvas,s.configService.getSceneConfig(s.id));case 5:x.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:s.pickingService.init(s.id);case 9:case"end":return x.stop()}},c)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(i){this.layerService.sceneService=this,this.layerService.add(i),this.render()}},{key:"render",value:function(){var n=as()(la.a.mark(function s(){return la.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(this.rendering||this.destroyed)){m.next=2;break}return m.abrupt("return");case 2:if(this.rendering=!0,this.inited){m.next=15;break}return m.next=6,this.initPromise;case 6:if(this.destroyed&&this.destroy(),!(this.loadFont&&document.fonts)){m.next=10;break}return m.next=10,document.fonts.load("24px ".concat(this.fontFamily),"L7text");case 10:this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 15:this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this.rendering=!1;case 18:case"end":return m.stop()}},s,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"addFontFace",value:function(i,s){this.fontFamily=i;var c=document.createElement("style");c.type="text/css",c.innerText=`
        @font-face{
            font-family: '`.concat(i,`';
            src: url('`).concat(s,`') format('woff2'),
            url('`).concat(s,`') format('woff'),
            url('`).concat(s,`') format('truetype');
        }`),document.getElementsByTagName("head")[0].appendChild(c),this.loadFont=!0}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(i){var s,c=(s=this.$container)===null||s===void 0?void 0:s.getElementsByTagName("canvas")[0];this.render();var m=i==="jpg"?c==null?void 0:c.toDataURL("image/jpeg"):c==null?void 0:c.toDataURL("image/png");return m}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var i=this.$container.parentElement;i!==null&&(this.markerContainer=N.create("div","l7-marker-container",i))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var i=this,s,c;if(!this.inited){this.destroyed=!0;return}if(this.emit("destroy"),this.layerService.destroy(),setTimeout(function(){i.rendererService.destroy()}),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),(s=this.$container)===null||s===void 0||(c=s.parentNode)===null||c===void 0||c.removeChild(this.$container),this.removeAllListeners(),this.inited=!1,Object(Ty.unbind)(this.$container,this.handleWindowResized),Kn.matchMedia){var m;(m=Kn.matchMedia("screen and (min-resolution: 2dppx)"))===null||m===void 0||m.removeListener(this.handleWindowResized)}}},{key:"initContainer",value:function(){var i,s,c=N.DPR,m=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,g=((s=this.$container)===null||s===void 0?void 0:s.clientHeight)||300,x=this.canvas;x&&(x.width=m*c,x.height=g*c),this.rendererService.viewport({x:0,y:0,width:c*m,height:c*g})}},{key:"setCanvas",value:function(){var i,s,c=N.DPR,m=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,g=((s=this.$container)===null||s===void 0?void 0:s.clientHeight)||300,x=this.canvas;x.width=m*c,x.height=g*c,x.style.width="100%",x.style.height="100%"}},{key:"addSceneEvent",value:function(i){this.emit(i.type,i)}}]),t}(Ls.EventEmitter),Wy=yi()(Uu.prototype,"id",[Py],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zy=yi()(Uu.prototype,"iconService",[Oy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xy=yi()(Uu.prototype,"fontService",[Iy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yy=yi()(Uu.prototype,"controlService",[Ry],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ky=yi()(Uu.prototype,"configService",[ky],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$y=yi()(Uu.prototype,"map",[Ly],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qy=yi()(Uu.prototype,"coordinateSystemService",[Dy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qy=yi()(Uu.prototype,"rendererService",[Fy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jy=yi()(Uu.prototype,"layerService",[By],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e_=yi()(Uu.prototype,"cameraService",[Ny],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t_=yi()(Uu.prototype,"interactionService",[zy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r_=yi()(Uu.prototype,"pickingService",[Uy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n_=yi()(Uu.prototype,"shaderModuleService",[jy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i_=yi()(Uu.prototype,"markerService",[Vy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a_=yi()(Uu.prototype,"popupService",[Gy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uu))||Hy),WC=w("7tbW"),o_=w.n(WC);function ZC(e){var r=0;switch(e){case"vec2":case"ivec2":r=2;break;case"vec3":case"ivec3":r=3;break;case"vec4":case"ivec4":case"mat2":r=4;break;case"mat3":r=9;break;case"mat4":r=16;break;default:}return r}var XC=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function s_(e){var r={};return e=e.replace(XC,function(t,n,i){var s=i.split(":"),c=s[0].trim(),m="";switch(s.length>1&&(m=s[1].trim()),n){case"bool":m=m==="true";break;case"float":case"int":m=Number(m);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":m?m=m.replace("[","").replace("]","").split(",").reduce(function(g,x){return g.push(Number(x.trim())),g},[]):m=new Array(ZC(n)).fill(0);break;default:}return r[c]=m,"uniform ".concat(n," ").concat(c,`;
`)}),{content:e,uniforms:r}}var u_,l_;function c_(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function zv(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?c_(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var f_="#define PI 3.14159265359",YC=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,KC=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,$C=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,qC=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_shaderPick;

uniform float u_activeMix: 0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // TODO: \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

// TODO: \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
vec4 filterColorAnimate(vec4 color) {
  // TODO: \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, color.a));
  }
}

vec4 filterColorWithLight(vec4 color, float lightWeight) {
  // TODO: \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, lightWeight));
  }
}

`,QC=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec3 u_CurrentSelectedId : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;
uniform float u_shaderPick;
uniform float u_EnableSelect: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {
  //   // \u9009\u4E2D\u6001
  //   v_PickingResult.a = SELECT;
  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {
  //   // \u9AD8\u4EAE\u6001
  //   v_PickingResult.a = HIGHLIGHT;
  // } else {
  //   v_PickingResult.a = NORMAL;
  // }

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,JC=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,eA=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // return vec4(
    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), 
    //   project_scale(position.z), 
    //   position.w);

     return vec4(
      position.xy, 
      project_scale(position.z), 
      position.w);
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom));
  }
  return pixel * 2.0;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}`,tA=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,rA=`attribute float a_vertexId;

uniform mat4 u_cellTypeLayout;      // \u63CF\u8FF0\u6570\u636E\u7EB9\u7406 cell \u7ED3\u6784\u7684\u77E9\u9635
uniform sampler2D u_dataTexture;    // \u6570\u636E\u7EB9\u7406

bool hasOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 opacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeOpacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeWidth() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeWidth \u7684\u6570\u636E
  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStroke() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 stroke \u7684\u6570\u636E
  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasOffsets() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 offsets \u7684\u6570\u636E
  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasThetaOffset() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 thetaOffset \u7684\u6570\u636E
  return u_cellTypeLayout[2][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

// \u6839\u636E\u5750\u6807\u4F4D\u7F6E\u5148\u662F\u8BA1\u7B97 uv \uFF0C\u7136\u540E\u6839\u636E uv \u4ECE\u6570\u636E\u7EB9\u7406\u4E2D\u53D6\u503C
float pos2value(vec2 pos, float columnWidth, float rowHeight) {
  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;
  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);
  return texture2D(u_dataTexture, vec2(u, v)).r;
}

/*
  currentRow \u5F53\u524D\u884C
  currentColumn \u5F53\u524D\u5217
  columnCount \u6709\u591A\u5C11\u5217
  nextStep \u9700\u8981\u8BA1\u7B97\u5F53\u524D cell \u540E\u7684\u7B2C\u51E0\u4E2A cell \uFF08\u5F53\u524D cell \u5219 nextStep = 0\uFF09
*/
vec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {
  float nextColumn = currentColumn;
  float nextRow = currentRow;
  if(currentColumn + nextStep <= columnCount){
    nextColumn = currentColumn + nextStep;
  } else {
    nextColumn = mod(currentColumn + nextStep, columnCount); // \u4E0D\u4F1A\u51FA\u73B0\u8DE8\u4E24\u884C
    nextRow = currentRow + 1.0;
  }
  return vec2(nextColumn, nextRow);
}

// \u8BA1\u7B97\u5F53\u524D\u5355\u4E2A cell \u7684\u5927\u5C0F
float calCellCount() { 
  //   u_cellTypeLayout
  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - \u51E0\u884C\u51E0\u5217
  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 \u8868\u793A\u6709\u6570\u636E\u6620\u5C04\u30010.0 \u8868\u793A\u6CA1\u6709
  //   1.0, 1.0, 0.0, 0.0, // offsets thetaOffset
  //   0.0, 0.0, 0.0, 0.0
  
  return  u_cellTypeLayout[1][0] +        // opacity
          u_cellTypeLayout[1][1] +        // strokeOpacity
          u_cellTypeLayout[1][2] +        // strokeWidth
          u_cellTypeLayout[1][3] * 4.0 +  // stroke
          u_cellTypeLayout[2][0] * 2.0 +  // offsets
          u_cellTypeLayout[2][1];         // thetaOffset
}`,nA=`
// \u8BA1\u7B97 opacity \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasOpacity()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 opacity \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureOpacity, textureOffset + 1.0);
  }
}
`,iA=`
// \u8BA1\u7B97 strokeOpaicty \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeOpacity()) {
    return vec2(u_stroke_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeOpacity, textureOffset + 1.0);
  }
}
`,aA=`
// \u8BA1\u7B97 strokeWidth \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeWidth()) {
    return vec2(u_stroke_width, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeWidth, textureOffset + 1.0);
  }
}
`,oA=`
// \u8BA1\u7B97 thetaOffset \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calThetaOffsetAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasThetaOffset()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 thetaOffset \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_thetaOffset, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureThetaOffset = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureThetaOffset, textureOffset + 1.0);
  }
}
`,sA=/precision\s+(high|low|medium)p\s+float/,uA=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,lA=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,cA=(u_=Object(Cr.injectable)(),u_(l_=function(){function e(){Ct()(this,e),S()(this,"moduleCache",{}),S()(this,"rawContentCache",{})}return Bt()(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:f_,fs:f_}),this.registerModule("decode",{vs:YC,fs:""}),this.registerModule("projection",{vs:eA,fs:""}),this.registerModule("project",{vs:JC,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:tA}),this.registerModule("lighting",{vs:$C,fs:""}),this.registerModule("light",{vs:KC,fs:""}),this.registerModule("picking",{vs:QC,fs:qC}),this.registerModule("styleMapping",{vs:rA,fs:""}),this.registerModule("styleMappingCalThetaOffset",{vs:oA,fs:""}),this.registerModule("styleMappingCalOpacity",{vs:nA,fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:iA,fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:aA,fs:""})}},{key:"registerModule",value:function(t,n){if(!this.rawContentCache[t]){var i=n.vs,s=n.fs,c=n.uniforms,m=s_(i),g=m.content,x=m.uniforms,A=s_(s),M=A.content,R=A.uniforms;this.rawContentCache[t]={fs:M,uniforms:zv(zv(zv({},x),R),c),vs:g}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(t){var n=this;if(this.moduleCache[t])return this.moduleCache[t];var i=this.rawContentCache[t].vs,s=this.rawContentCache[t].fs,c=this.processModule(i,[],"vs"),m=c.content,g=c.includeList,x=this.processModule(s,[],"fs"),A=x.content,M=x.includeList,R=A,F=o_()(g.concat(M).concat(t)).reduce(function(Y,ie){return zv(zv({},Y),n.rawContentCache[ie].uniforms)},{});return sA.test(A)||(R=uA+A),this.moduleCache[t]={fs:R.trim(),uniforms:F,vs:m.trim()},this.moduleCache[t]}},{key:"processModule",value:function(t,n,i){var s=this,c=t.replace(lA,function(m,g){var x=g.split(" "),A=x[0].replace(/"/g,"");if(n.indexOf(A)>-1)return"";var M=s.rawContentCache[A][i];n.push(A);var R=s.processModule(M,n,i),F=R.content;return F});return{content:c,includeList:n}}}]),e}())||l_),fA=w("iWIM"),np=w.n(fA),ip;(function(e){e.Normal="normal",e.PostProcessing="post-processing"})(ip||(ip={}));var h_,p_,Lm=(h_=Object(Cr.injectable)(),h_(p_=function(){function e(){Ct()(this,e),S()(this,"shaderModuleService",void 0),S()(this,"rendererService",void 0),S()(this,"cameraService",void 0),S()(this,"mapService",void 0),S()(this,"interactionService",void 0),S()(this,"layerService",void 0),S()(this,"config",void 0)}return Bt()(e,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return ip.Normal}},{key:"init",value:function(t,n){this.config=n,this.rendererService=t.getContainer().get(Kt.IRendererService),this.cameraService=t.getContainer().get(Kt.ICameraService),this.mapService=t.getContainer().get(Kt.IMapService),this.interactionService=t.getContainer().get(Kt.IInteractionService),this.layerService=t.getContainer().get(Kt.ILayerService),this.shaderModuleService=t.getContainer().get(Kt.IShaderModuleService)}},{key:"render",value:function(t){}}]),e}())||p_),d_,v_;function hA(e){var r=pA();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function pA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var dA=(d_=Object(Cr.injectable)(),d_(v_=function(e){Nr()(t,e);var r=hA(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(i,s){np()(mt()(t.prototype),"init",this).call(this,i,s)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),t}(Lm))||v_),m_,g_,y_,rg,__;function vA(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=mA(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function mA(e,r){if(!!e){if(typeof e=="string")return x_(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return x_(e,r)}}function x_(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var gA=(m_=Object(Cr.injectable)(),g_=Object(Cr.inject)(Kt.IPostProcessor),m_(y_=(rg=function(){function e(){Ct()(this,e),S()(this,"passes",[]),Ei()(this,"postProcessor",__,this),S()(this,"layer",void 0),S()(this,"renderFlag",void 0),S()(this,"width",0),S()(this,"height",0)}return Bt()(e,[{key:"setLayer",value:function(t){this.layer=t}},{key:"setRenderFlag",value:function(t){this.renderFlag=t}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var r=as()(la.a.mark(function n(){var i,s,c;return la.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:i=vA(this.passes),g.prev=1,i.s();case 3:if((s=i.n()).done){g.next=9;break}return c=s.value,g.next=7,c.render(this.layer);case 7:g.next=3;break;case 9:g.next=14;break;case 11:g.prev=11,g.t0=g.catch(1),i.e(g.t0);case 14:return g.prev=14,i.f(),g.finish(14);case 17:return g.next=19,this.postProcessor.render(this.layer);case 19:case"end":return g.stop()}},n,this,[[1,11,14,17]])}));function t(){return r.apply(this,arguments)}return t}()},{key:"resize",value:function(t,n){(this.width!==t||this.height!==n)&&(this.postProcessor.resize(t,n),this.width=t,this.height=n)}},{key:"add",value:function(t,n){t.getType()===ip.PostProcessing?this.postProcessor.add(t,this.layer,n):(t.init(this.layer,n),this.passes.push(t))}},{key:"insert",value:function(t,n,i){t.init(this.layer,n),this.passes.splice(i,0,t)}},{key:"destroy",value:function(){this.passes.length=0}}]),e}(),__=yi()(rg.prototype,"postProcessor",[g_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rg))||y_),b_,E_;function S_(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function C_(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?S_(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function yA(e){var r=_A();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function _A(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var xA=(b_=Object(Cr.injectable)(),b_(E_=function(e){Nr()(t,e);var r=yA(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"pickingFBO",void 0),S()(oe()(n),"layer",void 0),S()(oe()(n),"width",0),S()(oe()(n),"height",0),S()(oe()(n),"alreadyInRendering",!1),S()(oe()(n),"pickFromPickingFBO",function(m){var g=m.x,x=m.y,A=m.lngLat,M=m.type;if(!(!n.layer.isVisible()||!n.layer.needPick(M))){var R=n.rendererService,F=R.getViewportSize,Y=R.readPixels,ie=R.useFramebuffer,le=F(),Ae=le.width,Xe=le.height,nt=n.layer.getLayerConfig(),at=nt.enableHighlight,It=nt.enableSelect,Ot=g*N.DPR,Ut=x*N.DPR;if(!(Ot>Ae||Ot<0||Ut>Xe||Ut<0)){var $t;ie(n.pickingFBO,function(){var Tr;if($t=Y({x:Math.round(Ot),y:Math.round(Xe-(x+1)*N.DPR),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:n.pickingFBO}),$t[0]!==0||$t[1]!==0||$t[2]!==0){var Dr=Hr($t),Sr=n.layer.getSource().getFeatureById(Dr),Sn={x:g,y:x,type:M,lngLat:A,featureId:Dr,feature:Sr};Sr&&(n.layer.setCurrentPickId(Dr),n.triggerHoverOnLayer(Sn))}else{var Dn={x:g,y:x,lngLat:A,type:n.layer.getCurrentPickId()===null?"un"+M:"mouseout",featureId:null,feature:null};n.triggerHoverOnLayer(C_(C_({},Dn),{},{type:"unpick"})),n.triggerHoverOnLayer(Dn),n.layer.setCurrentPickId(null)}at&&n.highlightPickedFeature($t),It&&M==="click"&&((Tr=$t)===null||Tr===void 0?void 0:Tr.toString())!==[0,0,0,0].toString()&&n.selectFeature($t)})}}}),n}return Bt()(t,[{key:"getType",value:function(){return ip.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(i,s){np()(mt()(t.prototype),"init",this).call(this,i,s),this.layer=i;var c=this.rendererService,m=c.createTexture2D,g=c.createFramebuffer,x=c.getViewportSize,A=x(),M=A.width,R=A.height;this.pickingFBO=g({color:m({width:M,height:R,wrapS:ce.CLAMP_TO_EDGE,wrapT:ce.CLAMP_TO_EDGE})}),this.interactionService.on(nu.Hover,this.pickFromPickingFBO),this.interactionService.on(nu.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(nu.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(i){var s=this;if(!this.alreadyInRendering){var c=this.rendererService,m=c.getViewportSize,g=c.useFramebuffer,x=c.clear,A=m(),M=A.width,R=A.height;this.alreadyInRendering=!0,(this.width!==M||this.height!==R)&&(this.pickingFBO.resize({width:M,height:R}),this.width=M,this.height=R),g(this.pickingFBO,function(){x({framebuffer:s.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var F=s.layer.multiPassRenderer.getRenderFlag();s.layer.multiPassRenderer.setRenderFlag(!1),i.hooks.beforePickingEncode.call(),i.render(),i.hooks.afterPickingEncode.call(),s.layer.multiPassRenderer.setRenderFlag(F),s.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(i){this.layer.emit(i.type,i)}},{key:"highlightPickedFeature",value:function(i){var s=ri()(i,3),c=s[0],m=s[1],g=s[2];this.layer.hooks.beforeHighlight.call([c,m,g]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(i){var s=ri()(i,3),c=s[0],m=s[1],g=s[2];this.layer.hooks.beforeSelect.call([c,m,g]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(i){var s=i.featureId,c=cn(s);this.selectFeature(new Uint8Array(c))}},{key:"highlightFeatureHandle",value:function(i){var s=i.featureId,c=cn(s);this.highlightPickedFeature(new Uint8Array(c))}}]),t}(Lm))||E_),bA=w("gQMU"),EA=w.n(bA),SA=w("u6S6"),CA=w.n(SA),A_,w_,T_,ng,M_;function P_(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Uv(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?P_(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var AA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Th=(A_=Object(Cr.injectable)(),w_=Object(Cr.inject)(Kt.IShaderModuleService),A_(T_=(ng=function(){function e(){Ct()(this,e),Ei()(this,"shaderModuleService",M_,this),S()(this,"rendererService",void 0),S()(this,"config",void 0),S()(this,"quad",AA),S()(this,"enabled",!0),S()(this,"renderToScreen",!1),S()(this,"model",void 0),S()(this,"name",void 0),S()(this,"optionsToUpdate",{})}return Bt()(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(t){this.name=t}},{key:"getType",value:function(){return ip.PostProcessing}},{key:"init",value:function(t,n){this.config=n,this.rendererService=t.getContainer().get(Kt.IRendererService),this.shaderModuleService=t.getContainer().get(Kt.IShaderModuleService);var i=this.rendererService,s=i.createAttribute,c=i.createBuffer,m=i.createModel,g=this.setupShaders(),x=g.vs,A=g.fs,M=g.uniforms;this.model=m({vs:x,fs:A,attributes:{a_Position:s({buffer:c({data:[-4,-4,4,-4,0,4],type:ce.FLOAT}),size:2})},uniforms:Uv(Uv({u_Texture:null},M),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(t,n){var i=this,s=t.multiPassRenderer.getPostProcessor(),c=this.rendererService,m=c.useFramebuffer,g=c.getViewportSize,x=c.clear,A=g(),M=A.width,R=A.height;m(this.renderToScreen?null:s.getWriteFBO(),function(){x({framebuffer:s.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var F=Uv({u_BloomFinal:0,u_Texture:s.getReadFBO(),u_ViewportSize:[M,R]},i.convertOptionsToUniforms(i.optionsToUpdate));n&&(F.u_BloomFinal=1,F.u_Texture2=n),i.model.draw({uniforms:F})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(t){this.enabled=t}},{key:"setRenderToScreen",value:function(t){this.renderToScreen=t}},{key:"updateOptions",value:function(t){this.optionsToUpdate=Uv(Uv({},this.optionsToUpdate),t)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(t){var n={};return Object.keys(t).forEach(function(i){wh()(t[i])||(n["u_".concat(EA()(CA()(i)))]=t[i])}),n}}]),e}(),M_=yi()(ng.prototype,"shaderModuleService",[w_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ng))||T_),O_,I_;function R_(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function k_(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?R_(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function wA(e){var r=TA();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function TA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var MA=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);
  // float lum = luminance(baseColor);
  // baseColor.a *= lum;

  // gl_FragColor = baseColor;

  // if(u_BloomFinal > 0.0) { // 
  //   gl_FragColor = baseColor; //-- 
  // }

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    // float lum = luminance(inbloomColor);
    // vec4 bloom = vec4(lum);
    // inbloomColor.a *= lum;
    // gl_FragColor = inbloomColor * u_intensity + texture2D(u_Texture2, v_UV);
    // gl_FragColor = inbloomColor * 0.5 + texture2D(u_Texture2, v_UV);
    // gl_FragColor = baseColor;
    // gl_FragColor = inbloomColor;
    // vec4 mixColor = mix(baseColor, inbloomColor, max(u_intensity - 0.3, 0.0));
    // mixColor.a = max(baseColor.a, mixColor.a);
    gl_FragColor = mix(inbloomColor, baseColor, max(1.0 - u_intensity, u_baseRadio));
    // gl_FragColor = mixColor;
    // gl_FragColor = baseColor;
    
    if(baselum <= 0.0) {
      // float lum = luminance(inbloomColor);
      // inbloomColor.rgb *= lum;
      gl_FragColor += inbloomColor * u_intensity;
    }
    // gl_FragColor = inbloomColor * baseColor + baseColor;
    // gl_FragColor = baseColor + bloom * 0.5;
  } else {
    gl_FragColor = inbloomColor;
  }
  // gl_FragColor = inbloomColor;

  // float h = 0.01;
  
  // vec4 color11 = texture2D( u_Texture, vec2( v_UV.x - 1.0 * h, v_UV.y + 1.0 * h) );
  // vec4 color12 = texture2D( u_Texture, vec2( v_UV.x - 0.0 * h, v_UV.y + 1.0 * h) );
  // vec4 color13 = texture2D( u_Texture, vec2( v_UV.x + 1.0 * h, v_UV.y + 1.0 * h) );

  // vec4 color21 = texture2D( u_Texture, vec2( v_UV.x - 1.0 * h, v_UV.y) );
  // vec4 color23 = texture2D( u_Texture, vec2( v_UV.x + 1.0 * h, v_UV.y) );

  // vec4 color31 = texture2D( u_Texture, vec2( v_UV.x - 1.0 * h, v_UV.y-1.0*h) );
  // vec4 color32 = texture2D( u_Texture, vec2( v_UV.x - 0.0 * h, v_UV.y-1.0*h) );
  // vec4 color33 = texture2D( u_Texture, vec2( v_UV.x + 1.0 * h, v_UV.y-1.0*h) );

  // vec4 bloomColor =
  //   color11 + 
  //   color12 + 
  //   color13 + 
  //   color21 + 
  //   color21 + 
  //   color23 + 
  //   color31 + 
  //   color32 + 
  //   color33;

  //   if(baseColor.a > 0.0) {
      
  //     gl_FragColor.r = min(bloomColor.r, baseColor.r);
  //     gl_FragColor.g = min(bloomColor.g, baseColor.g);
  //     gl_FragColor.b = min(bloomColor.b, baseColor.b);
  //     gl_FragColor.a = min(bloomColor.a, baseColor.a);

  //     gl_FragColor = mix(inbloomColor, gl_FragColor, 0.7);
  //   } else {
  //     gl_FragColor = bloomColor/9.0;
  //   } 
}`,PA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,OA=(O_=Object(Cr.injectable)(),O_(I_=function(e){Nr()(t,e);var r=wA(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:PA,fs:MA});var i=this.shaderModuleService.getModule("blur-pass"),s=i.vs,c=i.fs,m=i.uniforms,g=this.rendererService.getViewportSize(),x=g.width,A=g.height;return{vs:s,fs:c,uniforms:k_(k_({},m),{},{u_ViewportSize:[x,A]})}}},{key:"convertOptionsToUniforms",value:function(i){var s={};return wh()(i.bloomRadius)||(s.u_radius=i.bloomRadius),wh()(i.bloomIntensity)||(s.u_intensity=i.bloomIntensity),wh()(i.bloomBaseRadio)||(s.u_baseRadio=i.bloomBaseRadio),s}}]),t}(Th))||I_),L_,D_;function F_(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function B_(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?F_(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function IA(e){var r=RA();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function RA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var kA=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,LA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,DA=(L_=Object(Cr.injectable)(),L_(D_=function(e){Nr()(t,e);var r=IA(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:LA,fs:kA});var i=this.shaderModuleService.getModule("blur-pass"),s=i.vs,c=i.fs,m=i.uniforms,g=this.rendererService.getViewportSize(),x=g.width,A=g.height;return{vs:s,fs:c,uniforms:B_(B_({},m),{},{u_ViewportSize:[x,A]})}}},{key:"convertOptionsToUniforms",value:function(i){var s={};return wh()(i.blurRadius)||(s.u_BlurDir=[i.blurRadius,0]),s}}]),t}(Th))||D_),N_,z_;function U_(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function j_(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?U_(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):U_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function FA(e){var r=BA();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function BA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var NA=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,zA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,UA=(N_=Object(Cr.injectable)(),N_(z_=function(e){Nr()(t,e);var r=FA(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:zA,fs:NA});var i=this.shaderModuleService.getModule("blur-pass"),s=i.vs,c=i.fs,m=i.uniforms,g=this.rendererService.getViewportSize(),x=g.width,A=g.height;return{vs:s,fs:c,uniforms:j_(j_({},m),{},{u_ViewportSize:[x,A]})}}},{key:"convertOptionsToUniforms",value:function(i){var s={};return wh()(i.blurRadius)||(s.u_BlurDir=[0,i.blurRadius]),s}}]),t}(Th))||z_),V_,G_;function H_(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function W_(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?H_(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):H_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function jA(e){var r=VA();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function VA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var GA=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,HA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,WA=(V_=Object(Cr.injectable)(),V_(G_=function(e){Nr()(t,e);var r=jA(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:HA,fs:GA});var i=this.shaderModuleService.getModule("colorhalftone-pass"),s=i.vs,c=i.fs,m=i.uniforms,g=this.rendererService.getViewportSize(),x=g.width,A=g.height;return{vs:s,fs:c,uniforms:W_(W_({},m),{},{u_ViewportSize:[x,A]})}}}]),t}(Th))||G_),Z_,X_;function ZA(e){var r=XA();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function XA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var YA=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,KA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,$A=(Z_=Object(Cr.injectable)(),Z_(X_=function(e){Nr()(t,e);var r=ZA(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:KA,fs:YA}),this.shaderModuleService.getModule("copy-pass")}}]),t}(Th))||X_),Y_,K_;function $_(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function q_(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?$_(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function qA(e){var r=QA();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function QA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var JA=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,ew=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,tw=(Y_=Object(Cr.injectable)(),Y_(K_=function(e){Nr()(t,e);var r=qA(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:ew,fs:JA});var i=this.shaderModuleService.getModule("hexagonalpixelate-pass"),s=i.vs,c=i.fs,m=i.uniforms,g=this.rendererService.getViewportSize(),x=g.width,A=g.height;return{vs:s,fs:c,uniforms:q_(q_({},m),{},{u_ViewportSize:[x,A]})}}}]),t}(Th))||K_),Q_,J_;function e1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function t1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?e1(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):e1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function rw(e){var r=nw();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function nw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var iw=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,aw=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ow=(Q_=Object(Cr.injectable)(),Q_(J_=function(e){Nr()(t,e);var r=rw(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:aw,fs:iw});var i=this.shaderModuleService.getModule("ink-pass"),s=i.vs,c=i.fs,m=i.uniforms,g=this.rendererService.getViewportSize(),x=g.width,A=g.height;return{vs:s,fs:c,uniforms:t1(t1({},m),{},{u_ViewportSize:[x,A]})}}}]),t}(Th))||J_),r1,n1;function sw(e){var r=uw();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function uw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var lw=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,cw=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,fw=(r1=Object(Cr.injectable)(),r1(n1=function(e){Nr()(t,e);var r=sw(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:cw,fs:lw}),this.shaderModuleService.getModule("noise-pass")}}]),t}(Th))||n1),i1,a1;function hw(e){var r=pw();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function pw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var dw=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,vw=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,mw=(i1=Object(Cr.injectable)(),i1(a1=function(e){Nr()(t,e);var r=hw(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:dw,fs:vw}),this.shaderModuleService.getModule("sepia-pass")}}]),t}(Th))||a1),o1,s1,u1,l1,Nd,c1,gw=(o1=Object(Cr.injectable)(),s1=Object(Cr.inject)(Kt.IRendererService),u1=Object(Cr.postConstruct)(),o1(l1=(Nd=function(){function e(){Ct()(this,e),Ei()(this,"rendererService",c1,this),S()(this,"passes",[]),S()(this,"readFBO",void 0),S()(this,"writeFBO",void 0)}return Bt()(e,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var t=this.rendererService,n=t.getViewportSize,i=t.createTexture2D,s=n(),c=s.width,m=s.height;return i({x:0,y:0,width:c,height:m,copy:!0})}},{key:"getReadFBOTex",value:function(){var t=this,n=this.rendererService.useFramebuffer;return new Promise(function(i,s){n(t.readFBO,as()(la.a.mark(function c(){return la.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:i(t.getCurrentFBOTex());case 1:case"end":return g.stop()}},c)})))})}},{key:"renderBloomPass",value:function(){var r=as()(la.a.mark(function n(i,s){var c,m;return la.a.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,this.getReadFBOTex();case 2:c=x.sent,m=0;case 4:if(!(m<4)){x.next=11;break}return x.next=7,s.render(i,c);case 7:this.swap(),m++,x.next=4;break;case 11:case"end":return x.stop()}},n,this)}));function t(n,i){return r.apply(this,arguments)}return t}()},{key:"render",value:function(){var r=as()(la.a.mark(function n(i){var s,c;return la.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:s=0;case 1:if(!(s<this.passes.length)){g.next=15;break}if(c=this.passes[s],c.setRenderToScreen(this.isLastEnabledPass(s)),c.getName()!=="bloom"){g.next=9;break}return g.next=7,this.renderBloomPass(i,c);case 7:g.next=12;break;case 9:return g.next=11,c.render(i);case 11:s!==this.passes.length-1&&this.swap();case 12:s++,g.next=1;break;case 15:case"end":return g.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"resize",value:function(t,n){this.readFBO.resize({width:t,height:n}),this.writeFBO.resize({width:t,height:n})}},{key:"add",value:function(t,n,i){t.init(n,i),this.passes.push(t)}},{key:"insert",value:function(t,n,i,s){t.init(i,s),this.passes.splice(n,0,t)}},{key:"getPostProcessingPassByName",value:function(t){return this.passes.find(function(n){return n.getName()===t})}},{key:"init",value:function(){var t=this.rendererService,n=t.createFramebuffer,i=t.createTexture2D;this.readFBO=n({color:i({width:1,height:1,wrapS:ce.CLAMP_TO_EDGE,wrapT:ce.CLAMP_TO_EDGE})}),this.writeFBO=n({color:i({width:1,height:1,wrapS:ce.CLAMP_TO_EDGE,wrapT:ce.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(t){for(var n=t+1;n<this.passes.length;n++)if(this.passes[n].isEnabled())return!1;return!0}},{key:"swap",value:function(){var t=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=t}}]),e}(),c1=yi()(Nd.prototype,"rendererService",[s1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yi()(Nd.prototype,"init",[u1],Object.getOwnPropertyDescriptor(Nd.prototype,"init"),Nd.prototype),Nd))||l1),f1,h1;function yw(e){var r=_w();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function _w(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var xw=(f1=Object(Cr.injectable)(),f1(h1=function(e){Nr()(t,e);var r=yw(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getType",value:function(){return ip.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(i,s){np()(mt()(t.prototype),"init",this).call(this,i,s)}},{key:"render",value:function(i){var s=this.rendererService,c=s.useFramebuffer,m=s.clear,g=i.multiPassRenderer.getPostProcessor().getReadFBO();c(g,function(){m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:g}),i.multiPassRenderer.setRenderFlag(!1),i.models.forEach(function(x){x.draw({uniforms:i.layerModel.getUninforms()})}),i.multiPassRenderer.setRenderFlag(!0)})}}]),t}(Lm))||h1),p1,d1,v1,ig,m1;function g1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function y1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?g1(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function bw(e){var r=Ew();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Ew(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Sw=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,_1=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Cw=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function x1(e,r){for(var t=0,n=1/r,i=e;i>0;)t=t+n*(i%r),i=Math.floor(i/r),n=n/r;return t}var Aw=1,ww=(p1=Object(Cr.injectable)(),d1=Object(Cr.inject)(Kt.IShaderModuleService),p1(v1=(ig=function(e){Nr()(t,e);var r=bw(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),Ei()(oe()(n),"shaderModuleService",m1,oe()(n)),S()(oe()(n),"haltonSequence",[]),S()(oe()(n),"accumulatingId",0),S()(oe()(n),"frame",0),S()(oe()(n),"timer",void 0),S()(oe()(n),"sampleRenderTarget",void 0),S()(oe()(n),"prevRenderTarget",void 0),S()(oe()(n),"outputRenderTarget",void 0),S()(oe()(n),"copyRenderTarget",void 0),S()(oe()(n),"blendModel",void 0),S()(oe()(n),"outputModel",void 0),S()(oe()(n),"copyModel",void 0),n}return Bt()(t,[{key:"getType",value:function(){return ip.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(i,s){np()(mt()(t.prototype),"init",this).call(this,i,s);var c=this.rendererService,m=c.createFramebuffer,g=c.createTexture2D;this.sampleRenderTarget=m({color:g({width:1,height:1,wrapS:ce.CLAMP_TO_EDGE,wrapT:ce.CLAMP_TO_EDGE})}),this.prevRenderTarget=m({color:g({width:1,height:1,wrapS:ce.CLAMP_TO_EDGE,wrapT:ce.CLAMP_TO_EDGE})}),this.outputRenderTarget=m({color:g({width:1,height:1,wrapS:ce.CLAMP_TO_EDGE,wrapT:ce.CLAMP_TO_EDGE})}),this.copyRenderTarget=m({color:g({width:1,height:1,wrapS:ce.CLAMP_TO_EDGE,wrapT:ce.CLAMP_TO_EDGE})});for(var x=0;x<30;x++)this.haltonSequence.push([x1(x,2),x1(x,3)]);this.blendModel=this.createTriangleModel("blend-pass",Sw),this.outputModel=this.createTriangleModel("copy-pass",_1,{blend:{enable:!0,func:{srcRGB:ce.ONE,dstRGB:ce.ONE_MINUS_SRC_ALPHA,srcAlpha:ce.ONE,dstAlpha:ce.ONE_MINUS_SRC_ALPHA},equation:{rgb:ce.FUNC_ADD,alpha:ce.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",_1)}},{key:"render",value:function(i){var s=this,c=this.rendererService,m=c.clear,g=c.getViewportSize,x=c.useFramebuffer,A=g(),M=A.width,R=A.height;this.sampleRenderTarget.resize({width:M,height:R}),this.prevRenderTarget.resize({width:M,height:R}),this.outputRenderTarget.resize({width:M,height:R}),this.copyRenderTarget.resize({width:M,height:R}),this.resetFrame(),this.stopAccumulating();var F=i.multiPassRenderer.getPostProcessor().getReadFBO();x(F,function(){m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:F}),i.multiPassRenderer.setRenderFlag(!1),i.render(),i.multiPassRenderer.setRenderFlag(!0)});var Y=function ie(le){!s.accumulatingId||le!==s.accumulatingId||s.isFinished()||(s.doRender(i),Kn.requestAnimationFrame(function(){ie(le)}))};this.accumulatingId=Aw++,this.timer=Kn.setTimeout(function(){Y(s.accumulatingId)},50)}},{key:"doRender",value:function(i){var s=this,c=this.rendererService,m=c.clear,g=c.getViewportSize,x=c.useFramebuffer,A=g(),M=A.width,R=A.height,F=i.getLayerConfig(),Y=F.jitterScale,ie=Y===void 0?1:Y,le=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((le[0]*2-1)/M*ie,(le[1]*2-1)/R*ie),i.multiPassRenderer.setRenderFlag(!1),i.hooks.beforeRender.call(),x(this.sampleRenderTarget,function(){m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:s.sampleRenderTarget}),i.render()}),i.hooks.afterRender.call(),i.multiPassRenderer.setRenderFlag(!0);var Ae=i.getLayerConfig();x(this.outputRenderTarget,function(){s.blendModel.draw({uniforms:{u_opacity:Ae.opacity||1,u_MixRatio:s.frame===0?1:.9,u_Diffuse1:s.sampleRenderTarget,u_Diffuse2:s.frame===0?i.multiPassRenderer.getPostProcessor().getReadFBO():s.prevRenderTarget}})}),this.frame===0&&m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(x(this.copyRenderTarget,function(){s.outputModel.draw({uniforms:{u_Texture:s.outputRenderTarget}})}),x(i.multiPassRenderer.getPostProcessor().getReadFBO(),function(){s.copyModel.draw({uniforms:{u_Texture:s.copyRenderTarget}})}),i.multiPassRenderer.getPostProcessor().render(i));var Xe=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=Xe,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,Kn.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(i,s,c){this.shaderModuleService.registerModule(i,{vs:Cw,fs:s});var m=this.shaderModuleService.getModule(i),g=m.vs,x=m.fs,A=m.uniforms,M=this.rendererService,R=M.createAttribute,F=M.createBuffer,Y=M.createModel;return Y(y1({vs:g,fs:x,attributes:{a_Position:R({buffer:F({data:[-4,-4,4,-4,0,4],type:ce.FLOAT}),size:2})},uniforms:y1({},A),depth:{enable:!1},count:3},c))}}]),t}(Lm),m1=yi()(ig.prototype,"shaderModuleService",[d1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ig))||v1),jv=new Cr.Container;jv.bind(Kt.IGlobalConfigService).to(Sv).inSingletonScope(),Object(Cr.decorate)(Object(Cr.injectable)(),Ls.EventEmitter),jv.bind(Kt.IEventEmitter).to(Ls.EventEmitter);var b1=dd()(jv,!1),ag=function(r){var t=b1.lazyInject(r);return function(n,i,s){t.call(this,n,i),s&&(s.initializer=function(){return n[i]})}},ZD=function(r){var t=b1.lazyMultiInject(r);return function(n,i,s){t.call(this,n,i),s&&(s.initializer=function(){return n[i]})}},ec=jv,Tw=0;function Mw(){var e=new Cr.Container;return e.parent=jv,e.bind(Kt.SceneID).toConstantValue("".concat(Tw++)),e.bind(Kt.IShaderModuleService).to(cA).inSingletonScope(),e.bind(Kt.ILayerService).to(LC).inSingletonScope(),e.bind(Kt.ISceneService).to(HC).inSingletonScope(),e.bind(Kt.ICameraService).to(qh).inSingletonScope(),e.bind(Kt.ICoordinateSystemService).to(Em).inSingletonScope(),e.bind(Kt.IInteractionService).to(wm).inSingletonScope(),e.bind(Kt.IPickingService).to(Q0).inSingletonScope(),e.bind(Kt.IControlService).to(Gp).inSingletonScope(),e.bind(Kt.IMarkerService).to(Hp).inSingletonScope(),e.bind(Kt.IIconService).to(va).inSingletonScope(),e.bind(Kt.IFontService).to(Uf).inSingletonScope(),e.bind(Kt.IPopupService).to(_m).inSingletonScope(),e.bind(Kt.INormalPass).to(dA).whenTargetNamed("clear"),e.bind(Kt.INormalPass).to(xA).whenTargetNamed("pixelPicking"),e.bind(Kt.INormalPass).to(xw).whenTargetNamed("render"),e.bind(Kt.INormalPass).to(ww).whenTargetNamed("taa"),e.bind(Kt.IFactoryNormalPass).toFactory(function(r){return function(t){return r.container.getNamed(Kt.INormalPass,t)}}),e.bind(Kt.IPostProcessingPass).to($A).whenTargetNamed("copy"),e.bind(Kt.IPostProcessingPass).to(OA).whenTargetNamed("bloom"),e.bind(Kt.IPostProcessingPass).to(DA).whenTargetNamed("blurH"),e.bind(Kt.IPostProcessingPass).to(UA).whenTargetNamed("blurV"),e.bind(Kt.IPostProcessingPass).to(fw).whenTargetNamed("noise"),e.bind(Kt.IPostProcessingPass).to(mw).whenTargetNamed("sepia"),e.bind(Kt.IPostProcessingPass).to(WA).whenTargetNamed("colorHalftone"),e.bind(Kt.IPostProcessingPass).to(tw).whenTargetNamed("hexagonalPixelate"),e.bind(Kt.IPostProcessingPass).to(ow).whenTargetNamed("ink"),e.bind(Kt.IFactoryPostProcessingPass).toFactory(function(r){return function(t){var n=r.container.getNamed(Kt.IPostProcessingPass,t);return n.setName(t),n}}),e}function Pw(e){var r=new Cr.Container;return r.parent=e,r.bind(Kt.IStyleAttributeService).to(UC).inSingletonScope(),r.bind(Kt.IMultiPassRenderer).to(gA).inSingletonScope(),r.bind(Kt.IPostProcessor).to(gw).inSingletonScope(),r}var Ow=w("9nhX"),E1=w.n(Ow),Iw=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function Rw(e){return Iw.indexOf(e)}var kw=2,XD=4,Lw=64,YD=128,Dw=256,Fw=512,KD=8192,$D=16384,qD=32768,Bw=32768*2,S1=131072,QD=262144,Nw=524288,JD=1048576,zw=2097152,eF=4194304,Uw=8388608,jw=16777216,Vw=16777216*2;function Dm(e,r){return e=E1()(Math.floor(e),0,255),r=E1()(Math.floor(r),0,255),256*e+r}function tF(e){var r=e.color,t=e.radius,n=e.tileX,i=e.tileY,s=e.shape,c=e.opacity,m=e.stroke,g=e.strokeWidth,x=e.strokeOpacity,A=[],M=[],R=[],F=[Dm(r[0],r[1]),Dm(r[2],r[3])],Y=[Dm(m[0],m[1]),Dm(m[2],m[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ie){var le=ri()(ie,2),Ae=le[0],Xe=le[1];A.push([].concat(F,[(Ae+1)*Uw+(Xe+1)*zw+Rw(s)*S1+t,(n+512)*Nw+(i+512)*Lw])),M.push([].concat(Y,[g,x])),R.push([c,0,0,0])}),{packedBuffer:A,packedBuffer2:M,packedBuffer3:R}}function rF(e,r){if(e===0&&!r)return 0;if(e===1&&r)return 4294967295;var t=r?1:0,n=Math.floor(e*127);return n*Vw+t*jw+n*S1+t*Bw+n*Fw+t*Dw+n*kw+t}var Oc;(function(e){e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none"})(Oc||(Oc={}));var uu;(function(e){e.LINEAR="linear",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat"})(uu||(uu={}));var ap;(function(e){e.CONSTANT="constant",e.VARIABLE="variable"})(ap||(ap={}));var mi;(function(e){e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform"})(mi||(mi={}));var zd=["mapload","mapchange"],Xp={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},og=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],op;(function(e){e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft",e.TOPCENTER="topcenter",e.BOTTOMCENTER="bottomcenter",e.LEFTCENTER="leftcenter",e.RIGHTCENTER="rightcenter"})(op||(op={}));function C1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function A1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?C1(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Gw(e){var r=Hw();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Hw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ww=0,Vv=function(e){Nr()(t,e);var r=Gw(t);function t(n){var i;return Ct()(this,t),i=r.call(this),S()(oe()(i),"controlOption",void 0),S()(oe()(i),"container",void 0),S()(oe()(i),"sceneContainer",void 0),S()(oe()(i),"mapsService",void 0),S()(oe()(i),"renderService",void 0),S()(oe()(i),"layerService",void 0),S()(oe()(i),"controlService",void 0),S()(oe()(i),"isShow",void 0),i.controlOption=A1(A1({},i.getDefault()),n||{}),i}return Bt()(t,[{key:"getDefault",value:function(){return{position:op.TOPRIGHT,name:"".concat(Ww++)}}},{key:"setPosition",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:op.BOTTOMRIGHT,s=this.controlService;return s&&s.removeControl(this),this.controlOption.position=i,s&&s.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(i){this.mapsService=i.get(Kt.IMapService),this.renderService=i.get(Kt.IRendererService),this.layerService=i.get(Kt.ILayerService),this.controlService=i.get(Kt.IControlService),this.sceneContainer=i,this.isShow=!0,this.container=this.onAdd();var s=this.container,c=this.controlOption.position,m=this.controlService.controlCorners[c];return N.addClass(s,"l7-control"),c.indexOf("bottom")!==-1?m.insertBefore(s,m.firstChild):m.appendChild(s),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var i=this.container;N.addClass(i,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var i=this.container;N.removeClass(i,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;N.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(i){if(this.mapsService&&i&&i.screenX>0&&i.screenY>0){var s=this.mapsService.getContainer();s!==null&&s.focus()}}}]),t}(Ls.EventEmitter);function Zw(e){var r=Xw();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Xw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Yw=function(e){Nr()(t,e);var r=Zw(t);function t(n){var i;return Ct()(this,t),i=r.call(this,n),S()(oe()(i),"layerControlInputs",void 0),S()(oe()(i),"layers",void 0),S()(oe()(i),"lastZIndex",void 0),S()(oe()(i),"handlingClick",void 0),S()(oe()(i),"layersLink",void 0),S()(oe()(i),"baseLayersList",void 0),S()(oe()(i),"separator",void 0),S()(oe()(i),"overlaysList",void 0),S()(oe()(i),"form",void 0),i.layerControlInputs=[],i.layers=[],i.lastZIndex=0,i.handlingClick=!1,i.initLayers(),ku(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],oe()(i)),i}return Bt()(t,[{key:"getDefault",value:function(){return{collapsed:!0,position:op.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var i=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(s){s.layer.on("remove",i.onLayerChange),s.layer.on("add",i.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(i,s){return this.addLayer(i,s,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var i=this.renderService.getViewportSize(),s=i.height;N.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var c=s-(this.container.offsetTop+50);return c<this.form.clientHeight?(N.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=c+"px"):N.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return N.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var i=this;!this.mapsService||(this.mapsService.off("click",this.collapse),this.layers.forEach(function(s){s.layer.off("remove",i.onLayerChange),s.layer.off("add",i.onLayerChange)}))}},{key:"initLayout",value:function(){var i="l7-control-layers",s=this.container=N.create("div",i),c=this.controlOption.collapsed;s.setAttribute("aria-haspopup","true");var m=this.form=N.create("form",i+"-list");c&&(this.mapsService.on("click",this.collapse),s.addEventListener("mouseenter",this.expand),s.addEventListener("mouseleave",this.collapse)),this.layersLink=N.create("a",i+"-toggle",s);var g=this.layersLink;g.title="Layers",c||this.expand(),this.baseLayersList=N.create("div",i+"-base",m),this.separator=N.create("div",i+"-separator",m),this.overlaysList=N.create("div",i+"-overlays",m),s.appendChild(m)}},{key:"initLayers",value:function(){var i=this,s=this.controlOption,c=s.baseLayers,m=c===void 0?{}:c,g=s.overlayers,x=g===void 0?{}:g;Object.keys(m).forEach(function(A,M){i.addLayer(m[A],A,!1)}),Object.keys(x).forEach(function(A,M){i.addLayer(x[A],A,!0)})}},{key:"update",value:function(){if(!this.container)return this;N.empty(this.baseLayersList),N.empty(this.overlaysList),this.layerControlInputs=[];var i,s,c,m,g=0;for(c=0;c<this.layers.length;c++)m=this.layers[c],this.addItem(m),s=s||m.overlay,i=i||!m.overlay,g+=m.overlay?0:1;return this.controlOption.hideSingleBase&&(i=i&&g>1,this.baseLayersList.style.display=i?"":"none"),this.separator.style.display=s&&i?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var i=this.layerControlInputs,s,c,m=this.mapsService.getZoom(),g=i.length-1;g>=0;g--)if(s=i[g],c=this.layerService.getLayer(s.layerId),c&&c.inited){var x=c.getMinZoom(),A=c.getMaxZoom();s.disabled=m<x||m>A}}},{key:"addLayer",value:function(i,s,c){this.mapsService&&(i.on("add",this.onLayerChange),i.on("remove",this.onLayerChange)),this.layers.push({layer:i,name:s,overlay:c});var m=this.controlOption,g=m.sortLayers,x=m.sortFunction,A=m.autoZIndex;g&&this.layers.sort(function(M,R){return x(M.layer,R.layer,M.name,R.name)}),A&&i.setZIndex&&(this.lastZIndex++,i.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(i){this.handlingClick||this.update();var s=this.layerService.getLayer(i.target.layerId),c=s!=null&&s.overlay?i.type==="add"?"overlayadd":"overlayremove":i.type==="add"?"baselayerchange":null;c&&this.emit(c,s)}},{key:"createRadioElement",value:function(i,s){var c='<input type="radio" class="l7-control-layers-selector" name="'+i+'"'+(s?' checked="checked"':"")+"/>",m=document.createElement("div");return m.innerHTML=c,m.firstChild}},{key:"addItem",value:function(i){var s=document.createElement("label"),c=this.layerService.getLayer(i.layer.id),m=c&&c.inited&&i.layer.isVisible(),g;i.overlay?(g=document.createElement("input"),g.type="checkbox",g.className="l7-control-layers-selector",g.defaultChecked=m):g=this.createRadioElement("l7-base-layers",m),this.layerControlInputs.push(g),g.layerId=i.layer.id,g.addEventListener("click",this.onInputClick);var x=document.createElement("span");x.innerHTML=" "+i.name;var A=document.createElement("div");s.appendChild(A),A.appendChild(g),A.appendChild(x);var M=i.overlay?this.overlaysList:this.baseLayersList;return M.appendChild(s),this.checkDisabledLayers(),s}},{key:"onInputClick",value:function(){var i=this.layerControlInputs,s,c,m=[],g=[];this.handlingClick=!0;for(var x=i.length-1;x>=0;x--)s=i[x],c=this.layerService.getLayer(s.layerId),s.checked?m.push(c):s.checked||g.push(c);g.forEach(function(A){A.hide()}),m.forEach(function(A){A.show()}),this.handlingClick=!1}}]),t}(Vv);function Kw(e){var r=$w();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function $w(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var w1=function(e){Nr()(t,e);var r=Kw(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getDefault",value:function(){return{position:op.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var i="l7-control-logo",s=N.create("div",i),c=N.create("a","l7-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://antv.alipay.com/l7",c.setAttribute("aria-label","AntV logo"),c.setAttribute("rel","noopener nofollow"),s.appendChild(c),s}},{key:"onRemove",value:function(){return null}}]),t}(Vv);function qw(e){var r=Qw();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Qw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Jw=function(e){Nr()(t,e);var r=qw(t);function t(n){var i;return Ct()(this,t),i=r.call(this,n),S()(oe()(i),"mScale",void 0),S()(oe()(i),"iScale",void 0),ku(["update"],oe()(i)),i}return Bt()(t,[{key:"getDefault",value:function(){return{position:op.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var i="l7-control-scale",s=N.create("div",i);this.addScales(i+"-line",s);var c=this.controlOption.updateWhenIdle;return this.mapsService.on(c?"moveend":"mapmove",this.update),this.mapsService.on(c?"zoomend":"zoomchange",this.update),this.update(),s}},{key:"onRemove",value:function(){var i=this.controlOption.updateWhenIdle;this.mapsService.off(i?"zoomend":"zoomchange",this.update),this.mapsService.off(i?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var i=this.mapsService,s=this.controlOption.maxWidth,c=i.getSize()[1]/2,m=i.containerToLngLat([0,c]),g=i.containerToLngLat([s,c]),x=qo([m.lng,m.lat],[g.lng,g.lat]);this.updateScales(x)}},{key:"updateScales",value:function(i){var s=this.controlOption,c=s.metric,m=s.imperial;c&&i&&this.updateMetric(i),m&&i&&this.updateImperial(i)}},{key:"updateMetric",value:function(i){var s=this.getRoundNum(i),c=s<1e3?s+" m":s/1e3+" km";this.updateScale(this.mScale,c,s/i)}},{key:"updateImperial",value:function(i){var s=i*3.2808399,c,m,g;s>5280?(c=s/5280,m=this.getRoundNum(c),this.updateScale(this.iScale,m+" mi",m/c)):(g=this.getRoundNum(s),this.updateScale(this.iScale,g+" ft",g/s))}},{key:"updateScale",value:function(i,s,c){var m=this.controlOption.maxWidth;i.style.width=Math.round(m*c)+"px",i.innerHTML=s}},{key:"getRoundNum",value:function(i){var s=Math.pow(10,(Math.floor(i)+"").length-1),c=i/s;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,s*c}},{key:"addScales",value:function(i,s){var c=this.controlOption,m=c.metric,g=c.imperial;m&&(this.mScale=N.create("div",i,s)),g&&(this.iScale=N.create("div",i,s))}}]),t}(Vv);function eT(e){var r=tT();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function tT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var rT=function(e){Nr()(t,e);var r=eT(t);function t(n){var i;return Ct()(this,t),i=r.call(this,n),S()(oe()(i),"disabled",void 0),S()(oe()(i),"zoomInButton",void 0),S()(oe()(i),"zoomOutButton",void 0),ku(["updateDisabled","zoomIn","zoomOut"],oe()(i)),i}return Bt()(t,[{key:"getDefault",value:function(){return{position:op.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var i="l7-control-zoom",s=N.create("div",i+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,i+"-in",s,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,i+"-out",s,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),s}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(i,s,c,m,g){var x=N.create("a",c,m);return x.innerHTML=i,x.title=s,x.href="javascript:void(0)",x.addEventListener("click",g),x}},{key:"updateDisabled",value:function(){var i=this.mapsService,s="l7-disabled";N.removeClass(this.zoomInButton,s),N.removeClass(this.zoomOutButton,s),(this.disabled||i.getZoom()<=i.getMinZoom())&&N.addClass(this.zoomOutButton,s),(this.disabled||i.getZoom()>=i.getMaxZoom())&&N.addClass(this.zoomInButton,s)}}]),t}(Vv);function T1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function M1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?T1(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):T1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function nT(e){var r=iT();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function iT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var P1=function(e){Nr()(t,e);var r=nT(t);function t(n){var i;return Ct()(this,t),i=r.call(this),S()(oe()(i),"markerOption",void 0),S()(oe()(i),"defaultMarker",void 0),S()(oe()(i),"popup",void 0),S()(oe()(i),"mapsService",void 0),S()(oe()(i),"sceneSerive",void 0),S()(oe()(i),"lngLat",void 0),S()(oe()(i),"scene",void 0),S()(oe()(i),"added",!1),S()(oe()(i),"eventHandle",function(s){i.emit(s.type,{target:s,data:i.markerOption.extData,lngLat:i.lngLat})}),i.markerOption=M1(M1({},i.getDefault()),n),ku(["update","onMove","onUp","addDragHandler","onMapClick"],oe()(i)),i.init(),i}return Bt()(t,[{key:"getDefault",value:function(){return{element:void 0,anchor:Jn.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(i){this.scene=i,this.mapsService=i.get(Kt.IMapService),this.sceneSerive=i.get(Kt.ISceneService);var s=this.markerOption,c=s.element,m=s.draggable;return this.mapsService.getMarkerContainer().appendChild(c),this.registerMarkerEvent(c),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var i=this.markerOption.element;return i&&N.remove(i),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(i){return this.lngLat=i,Array.isArray(i)&&(this.lngLat={lng:i[0],lat:i[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(i){var s=this;if(!this.added)return this.once("added",function(){s.setElement(i)}),this;var c=this.markerOption.element;return c&&N.remove(c),this.markerOption.element=i,this.init(),this.mapsService.getMarkerContainer().appendChild(i),this.registerMarkerEvent(i),this.update(),this}},{key:"openPopup",value:function(){var i=this;if(!this.added)return this.once("added",function(){i.openPopup()}),this;var s=this.popup;return s?(s.isOpen()||s.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var i=this;this.added||this.once("added",function(){i.closePopup()});var s=this.popup;return s&&s.remove(),this}},{key:"setPopup",value:function(i){return this.popup=i,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var i=this.popup;if(i)i.isOpen()?i.remove():i.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(i){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(i){this.markerOption.extData=i}},{key:"update",value:function(){if(!!this.mapsService){var i=this.markerOption,s=i.element,c=i.anchor;this.updatePosition(),N.setTransform(s,"".concat(oi[c]))}}},{key:"onMapClick",value:function(i){var s=this.markerOption.element;this.popup&&s&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!!this.mapsService){var i=this.markerOption,s=i.element,c=i.offsets,m=this.lngLat,g=m.lng,x=m.lat,A=this.mapsService.getBounds(),M=this.mapsService.lngLatToContainer([g,x]);if(s){s.style.display="block",s.style.whiteSpace="nowrap";var R=this.mapsService.getContainer(),F=0,Y=0;if(R&&(F=R.scrollWidth,Y=R.scrollHeight),Math.abs(A[0][0])>180||Math.abs(A[1][0])>180){if(M.x>F){var ie=this.mapsService.lngLatToContainer([g-360,x]);M.x=ie.x}if(M.x<0){var le=this.mapsService.lngLatToContainer([g+360,x]);M.x=le.x}}(M.x>F||M.x<0||M.y>Y||M.y<0)&&(s.style.display="none"),s.style.left=M.x+c[0]+"px",s.style.top=M.y-c[1]+"px"}}}},{key:"init",value:function(){var i=this,s=this.markerOption.element,c=this.markerOption,m=c.color,g=c.anchor;if(!s){this.defaultMarker=!0,s=N.create("div"),this.markerOption.element=s;var x=document.createElementNS("http://www.w3.org/2000/svg","svg");x.setAttributeNS(null,"display","block"),x.setAttributeNS(null,"height","48px"),x.setAttributeNS(null,"width","48px"),x.setAttributeNS(null,"viewBox","0 0 1024 1024");var A=document.createElementNS("http://www.w3.org/2000/svg","path");A.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),A.setAttributeNS(null,"fill",m),x.appendChild(A),s.appendChild(x)}N.addClass(s,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(M){var R,F,Y=((R=i.markerOption)===null||R===void 0?void 0:R.style)&&((F=i.markerOption)===null||F===void 0?void 0:F.style[M]);s&&(s.style[M]=Y)}),s.addEventListener("click",function(M){i.onMapClick(M)}),s.addEventListener("click",this.eventHandle),ji(s,g,"marker")}},{key:"registerMarkerEvent",value:function(i){i.addEventListener("mousemove",this.eventHandle),i.addEventListener("click",this.eventHandle),i.addEventListener("mousedown",this.eventHandle),i.addEventListener("mouseup",this.eventHandle),i.addEventListener("dblclick",this.eventHandle),i.addEventListener("contextmenu",this.eventHandle),i.addEventListener("mouseover",this.eventHandle),i.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var i=this.getElement();i.removeEventListener("mousemove",this.eventHandle),i.removeEventListener("click",this.eventHandle),i.removeEventListener("mousedown",this.eventHandle),i.removeEventListener("mouseup",this.eventHandle),i.removeEventListener("dblclick",this.eventHandle),i.removeEventListener("contextmenu",this.eventHandle),i.removeEventListener("mouseover",this.eventHandle),i.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(i){throw new Error("Method not implemented.")}},{key:"onUp",value:function(i){throw new Error("Method not implemented.")}}]),t}(Ls.EventEmitter);function O1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function I1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?O1(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):O1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function aT(e){var r=oT();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function oT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var nF=function(e){Nr()(t,e);var r=aT(t);function t(n){var i,s;return Ct()(this,t),s=r.call(this),S()(oe()(s),"markers",[]),S()(oe()(s),"markerLayerOption",void 0),S()(oe()(s),"clusterIndex",void 0),S()(oe()(s),"points",[]),S()(oe()(s),"clusterMarkers",[]),S()(oe()(s),"mapsService",void 0),S()(oe()(s),"scene",void 0),S()(oe()(s),"zoom",void 0),S()(oe()(s),"bbox",void 0),s.markerLayerOption=_o()(s.getDefault(),n),ku(["update"],oe()(s)),s.zoom=((i=s.markerLayerOption.clusterOption)===null||i===void 0?void 0:i.zoom)||-99,s}return Bt()(t,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(i){return this.scene=i,this.mapsService=i.get(Kt.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(i){var s=this.markerLayerOption.cluster;s&&this.addPoint(i,this.markers.length),this.markers.push(i)}},{key:"removeMarker",value:function(i){this.markers.indexOf(i);var s=this.markers.indexOf(i);s>-1&&this.markers.splice(s,1)}},{key:"hide",value:function(){this.markers.map(function(i){i.getElement().style.opacity="0"}),this.clusterMarkers.map(function(i){i.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(i){i.getElement().style.opacity="1"}),this.clusterMarkers.map(function(i){i.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){var i=this.markerLayerOption.cluster;return i?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var i=this;this.getMarkers().forEach(function(s){s.addTo(i.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(i){i.remove()}),this.clusterMarkers.forEach(function(i){i.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(i,s){var c=i.getLnglat(),m=c.lng,g=c.lat,x={geometry:{type:"Point",coordinates:[m,g]},properties:I1(I1({},i.getExtData()),{},{marker_id:s})};this.points.push(x)}},{key:"initCluster",value:function(){if(!!this.markerLayerOption.cluster){var i=this.markerLayerOption.clusterOption,s=i.radius,c=i.minZoom,m=c===void 0?0:c,g=i.maxZoom;this.clusterIndex=new ml.a({radius:s,minZoom:m,maxZoom:g}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(i,s){var c=this,m=i[0].concat(i[1]),g=this.clusterIndex.getClusters(m,s);this.clusterMarkers.forEach(function(x){x.remove()}),this.clusterMarkers=[],g.forEach(function(x){var A,M=c.markerLayerOption.clusterOption,R=M.field,F=M.method;if(x.properties&&(A=x.properties)!==null&&A!==void 0&&A.cluster_id){var Y,ie=c.getLeaves((Y=x.properties)===null||Y===void 0?void 0:Y.cluster_id);if(x.properties.clusterData=ie,R&&F){var le=ie==null?void 0:ie.map(function(It){var Ot=S()({},R,It.properties[R]);return Ot}),Ae=G.getColumn(le,R),Xe=G.getSatByColumn(F,Ae),nt="point_"+F;x.properties[nt]=Xe.toFixed(2)}}var at=c.clusterMarker(x);c.clusterMarkers.push(at),at.addTo(c.scene)})}},{key:"getLeaves",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return i?this.clusterIndex.getLeaves(i,s,c):null}},{key:"clusterMarker",value:function(i){var s=this.markerLayerOption.clusterOption,c=s,m=c.element,g=m===void 0?this.generateElement.bind(this):m,x=new P1({element:g(i)}).setLnglat({lng:i.geometry.coordinates[0],lat:i.geometry.coordinates[1]});return x}},{key:"normalMarker",value:function(i){var s=i.properties.marker_id;return this.markers[s]}},{key:"update",value:function(){var i=this.mapsService.getZoom(),s=this.mapsService.getBounds();(!this.bbox||Math.abs(i-this.zoom)>=1||!$u(this.bbox,s))&&(this.bbox=Ru(s,.5),this.zoom=Math.floor(i),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(i){var s=N.create("div","l7-marker-cluster"),c=N.create("div","",s),m=N.create("span","",c),g=this.markerLayerOption.clusterOption,x=g.field,A=g.method;i.properties.point_count=i.properties.point_count||1;var M=x&&A?i.properties["point_"+A]||i.properties[x]:i.properties.point_count;return m.textContent=M,s}}]),t}(Ls.EventEmitter);function R1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function k1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?R1(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function sT(e){var r=uT();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function uT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var L1=function(e){Nr()(t,e);var r=sT(t);function t(n){var i;return Ct()(this,t),i=r.call(this),S()(oe()(i),"popupOption",void 0),S()(oe()(i),"mapsService",void 0),S()(oe()(i),"sceneSerive",void 0),S()(oe()(i),"lngLat",void 0),S()(oe()(i),"content",void 0),S()(oe()(i),"closeButton",void 0),S()(oe()(i),"timeoutInstance",void 0),S()(oe()(i),"container",void 0),S()(oe()(i),"tip",void 0),S()(oe()(i),"scene",void 0),i.popupOption=k1(k1({},i.getdefault()),n),ku(["update","onClickClose","remove"],oe()(i)),i}return Bt()(t,[{key:"addTo",value:function(i){var s=this;return this.mapsService=i.get(Kt.IMapService),this.sceneSerive=i.get(Kt.ISceneService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=i,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){s.mapsService.on("click",s.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(i){var s=window.document.createDocumentFragment(),c=window.document.createElement("body"),m;for(c.innerHTML=i;m=c.firstChild,!!m;)s.appendChild(m);return this.setDOMContent(s)}},{key:"setLnglat",value:function(i){return this.lngLat=i,Array.isArray(i)&&(this.lngLat={lng:i[0],lat:i[1]}),this.mapsService&&(this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(i){return this.setDOMContent(window.document.createTextNode(i))}},{key:"setMaxWidth",value:function(i){return this.popupOption.maxWidth=i,this.update(),this}},{key:"setDOMContent",value:function(i){return this.createContent(),this.content.appendChild(i),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&N.remove(this.content),this.content=N.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=N.create("button","l7-popup-close-button",this.content),this.popupOption.closeButtonOffsets&&(this.closeButton.style.right=this.popupOption.closeButtonOffsets[0]+"px",this.closeButton.style.top=this.popupOption.closeButtonOffsets[1]+"px"),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(i,s,c){var m=window.document.createElement(i);return s!==void 0&&(m.className=s),c&&c.appendChild(m),m}},{key:"removeDom",value:function(i){i.parentNode&&i.parentNode.removeChild(i)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:Jn.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(i){i.stopPropagation&&i.stopPropagation(),this.remove()}},{key:"update",value:function(){var i=this,s=this.lngLat,c=this.popupOption,m=c.className,g=c.maxWidth,x=c.anchor;if(!(!this.mapsService||!s||!this.content)){var A=this.mapsService.getMarkerContainer();if(!this.container&&A){this.container=this.creatDom("div","l7-popup",A),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),m&&m.split(" ").forEach(function(R){return i.container.classList.add(R)});var M=this.popupOption.stopPropagation;M&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(R){i.container.addEventListener(R,function(F){F.stopPropagation()})}),this.container.style.whiteSpace="nowrap"}g&&this.container.style.maxWidth!==g&&(this.container.style.maxWidth=g),this.updatePosition(),N.setTransform(this.container,"".concat(oi[x])),ji(this.container,x,"popup")}}},{key:"updatePosition",value:function(){if(!!this.mapsService){var i=this.lngLat,s=i.lng,c=i.lat,m=this.popupOption.offsets,g=this.mapsService.lngLatToContainer([s,c]);this.container.style.left=g.x+m[0]+"px",this.container.style.top=g.y-m[1]+"px"}}}]),t}(Ls.EventEmitter);function lT(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}lT(`.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
}

.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* layers control */

.l7-control-layers {
  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);
          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);
  background: #fff;
  border-radius: 5px;
}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}

.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}

.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-left: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-bottom: none;
  border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-bottom: none;
  border-left: none;
  border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-bottom: none;
  border-right: none;
  border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-left: none;
  border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  padding: 0;
  font-size: 25px;
  line-height: 20px;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
  display: none;
}

.l7-popup-track-pointer * {
  pointer-events: none;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}

.l7-map:active .l7-popup-track-pointer {
  display: none;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);
          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);
  border-radius: 4px;
}
.l7-bar a,
.l7-bar a:hover {
  background-color: #fff;
  width: 30px;
  height: 30px;
  font-size: 20px;
  display: block;
  text-align: center;
  text-decoration: none;
  color: #8e9dab;
}
.l7-bar a,
.l7-control-layers-toggle {
  background-position: 50% 50%;
  background-repeat: no-repeat;
  display: block;
}
.l7-bar a:hover {
  background-color: #f4f4f4;
}
.l7-bar a:first-child {
  border-top-left-radius: 2px;
  border-top-right-radius: 2px;
}
.l7-bar a:last-child {
  border-bottom-left-radius: 2px;
  border-bottom-right-radius: 2px;
  border-bottom: none;
}
.l7-bar a.l7-disabled {
  cursor: default;
  background-color: #f4f4f4;
  color: #bbb;
}

/* control positioning */

.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-hide {
  display: none;
}
.l7-control {
  position: relative;
  z-index: 800;
  pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control {
  float: left;
  clear: both;
}
.l7-top,
.l7-bottom {
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-top {
  top: 0;
}
.l7-right {
  right: 0;
}
.l7-bottom {
  bottom: 0;
}
.l7-left {
  left: 0;
}
.l7-center {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-bottom.l7-center,
.l7-top.l7-center {
  width: 100%;
}
.l7-right.l7-center,
.l7-left.l7-center {
  height: 100%;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}

.l7-top.l7-center,
.l7-left.l7-center {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}

.l7-bottom.l7-center,
.l7-right.l7-center {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}

.l7-center .l7-control {
  margin-right: 10px;
  margin-bottom: 10px;
}

.l7-control {
  float: left;
  clear: both;
}
.l7-right .l7-control {
  float: right;
}
.l7-top .l7-control {
  margin-top: 10px;
}
.l7-bottom .l7-control {
  margin-bottom: 10px;
}
.l7-left .l7-control {
  margin-left: 10px;
}
.l7-right .l7-control {
  margin-right: 10px;
}

/* attribution and scale controls */

.l7-control-container .l7-control-attribution {
  background: #fff;
  background: rgba(59, 58, 58, 0.7);
  margin: 0;
}
.l7-control-attribution,
.l7-control-scale-line {
  padding: 0 5px;
  color: #333;
}
.l7-control-attribution a {
  text-decoration: none;
}
.l7-control-attribution a:hover {
  text-decoration: underline;
}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
}
.l7-left .l7-control-scale {
  margin-left: 5px;
}
.l7-bottom .l7-control-scale {
  margin-bottom: 5px;
}
.l7-control-scale-line {
  border: 2px solid #000;
  border-top: none;
  color: #000;
  line-height: 1.1;
  padding: 2px 5px 1px;
  font-size: 11px;
  white-space: nowrap;
  overflow: hidden;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;

  background: #fff;
}
.l7-control-scale-line:not(:first-child) {
  border-top: 2px solid #777;
  border-bottom: none;
  margin-top: -2px;
}
.l7-control-scale-line:not(:first-child):not(:last-child) {
  border-bottom: 2px solid #777;
}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  border: 2px solid rgba(0, 0, 0, 0.2);
  background-clip: padding-box;
}
/*logo */

.l7-ctrl-logo {
  background-size: 100% 100%;
  width: 89px;
  height: 16px;
  margin: 0 0 -3px -3px;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  background-repeat: no-repeat;
  cursor: pointer;
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}

/* layers control */

.l7-control-layers {
  -webkit-box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);
          box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);
  background: #fff;
  border-radius: 2px;
}
.l7-control-layers-toggle {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
  width: 30px;
  height: 30px;
  background-size: 20px 20px;
}

.l7-touch .l7-control-layers-toggle {
  width: 44px;
  height: 44px;
}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
  display: none;
}
.l7-control-layers-expanded .l7-control-layers-list {
  display: block;
  position: relative;
}
.l7-control-layers-expanded {
  padding: 6px 10px 6px 6px;
  color: #59626b;
  background: #fff;
}
.l7-control-layers-scrollbar {
  overflow-y: scroll;
  overflow-x: hidden;
  padding-right: 5px;
}
.l7-control-layers-selector {
  margin-top: 2px;
  position: relative;
  top: 1px;
}
.l7-control-layers label {
  display: block;
  padding: 8px;
}
.l7-control-layers label input[type='radio'],
.l7-control-layers label input[type='checkbox'] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
  height: 0;
  border-top: 1px solid #d8d8d8;
  margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
}
.amap-logo {
  display: none !important;
}
`);var cT=w("SUU4"),fT=w.n(cT),hT=function(){function e(r,t){Ct()(this,e),S()(this,"attribute",void 0),S()(this,"buffer",void 0);var n=t.buffer,i=t.offset,s=t.stride,c=t.normalized,m=t.size,g=t.divisor;this.buffer=n,this.attribute={buffer:n.get(),offset:i||0,stride:s||0,normalized:c||!1,divisor:g||0},m&&(this.attribute.size=m)}return Bt()(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),Mh,Gv,Ph,Ic,Hv,sp,Wv,Fm,Kf,Yp,ju,$f,qf,Bm,pT=(Mh={},S()(Mh,ce.POINTS,"points"),S()(Mh,ce.LINES,"lines"),S()(Mh,ce.LINE_LOOP,"line loop"),S()(Mh,ce.LINE_STRIP,"line strip"),S()(Mh,ce.TRIANGLES,"triangles"),S()(Mh,ce.TRIANGLE_FAN,"triangle fan"),S()(Mh,ce.TRIANGLE_STRIP,"triangle strip"),Mh),D1=(Gv={},S()(Gv,ce.STATIC_DRAW,"static"),S()(Gv,ce.DYNAMIC_DRAW,"dynamic"),S()(Gv,ce.STREAM_DRAW,"stream"),Gv),sg=(Ph={},S()(Ph,ce.BYTE,"int8"),S()(Ph,ce.UNSIGNED_INT,"int16"),S()(Ph,ce.INT,"int32"),S()(Ph,ce.UNSIGNED_BYTE,"uint8"),S()(Ph,ce.UNSIGNED_SHORT,"uint16"),S()(Ph,ce.UNSIGNED_INT,"uint32"),S()(Ph,ce.FLOAT,"float"),Ph),dT=(Ic={},S()(Ic,ce.ALPHA,"alpha"),S()(Ic,ce.LUMINANCE,"luminance"),S()(Ic,ce.LUMINANCE_ALPHA,"luminance alpha"),S()(Ic,ce.RGB,"rgb"),S()(Ic,ce.RGBA,"rgba"),S()(Ic,ce.RGBA4,"rgba4"),S()(Ic,ce.RGB5_A1,"rgb5 a1"),S()(Ic,ce.RGB565,"rgb565"),S()(Ic,ce.DEPTH_COMPONENT,"depth"),S()(Ic,ce.DEPTH_STENCIL,"depth stencil"),Ic),vT=(Hv={},S()(Hv,ce.DONT_CARE,"dont care"),S()(Hv,ce.NICEST,"nice"),S()(Hv,ce.FASTEST,"fast"),Hv),F1=(sp={},S()(sp,ce.NEAREST,"nearest"),S()(sp,ce.LINEAR,"linear"),S()(sp,ce.LINEAR_MIPMAP_LINEAR,"mipmap"),S()(sp,ce.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),S()(sp,ce.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),S()(sp,ce.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),sp),B1=(Wv={},S()(Wv,ce.REPEAT,"repeat"),S()(Wv,ce.CLAMP_TO_EDGE,"clamp"),S()(Wv,ce.MIRRORED_REPEAT,"mirror"),Wv),mT=(Fm={},S()(Fm,ce.NONE,"none"),S()(Fm,ce.BROWSER_DEFAULT_WEBGL,"browser"),Fm),gT=(Kf={},S()(Kf,ce.NEVER,"never"),S()(Kf,ce.ALWAYS,"always"),S()(Kf,ce.LESS,"less"),S()(Kf,ce.LEQUAL,"lequal"),S()(Kf,ce.GREATER,"greater"),S()(Kf,ce.GEQUAL,"gequal"),S()(Kf,ce.EQUAL,"equal"),S()(Kf,ce.NOTEQUAL,"notequal"),Kf),N1=(Yp={},S()(Yp,ce.FUNC_ADD,"add"),S()(Yp,ce.MIN_EXT,"min"),S()(Yp,ce.MAX_EXT,"max"),S()(Yp,ce.FUNC_SUBTRACT,"subtract"),S()(Yp,ce.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Yp),Nm=(ju={},S()(ju,ce.ZERO,"zero"),S()(ju,ce.ONE,"one"),S()(ju,ce.SRC_COLOR,"src color"),S()(ju,ce.ONE_MINUS_SRC_COLOR,"one minus src color"),S()(ju,ce.SRC_ALPHA,"src alpha"),S()(ju,ce.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),S()(ju,ce.DST_COLOR,"dst color"),S()(ju,ce.ONE_MINUS_DST_COLOR,"one minus dst color"),S()(ju,ce.DST_ALPHA,"dst alpha"),S()(ju,ce.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),S()(ju,ce.CONSTANT_COLOR,"constant color"),S()(ju,ce.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),S()(ju,ce.CONSTANT_ALPHA,"constant alpha"),S()(ju,ce.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),S()(ju,ce.SRC_ALPHA_SATURATE,"src alpha saturate"),ju),yT=($f={},S()($f,ce.NEVER,"never"),S()($f,ce.ALWAYS,"always"),S()($f,ce.LESS,"less"),S()($f,ce.LEQUAL,"lequal"),S()($f,ce.GREATER,"greater"),S()($f,ce.GEQUAL,"gequal"),S()($f,ce.EQUAL,"equal"),S()($f,ce.NOTEQUAL,"notequal"),$f),Ud=(qf={},S()(qf,ce.ZERO,"zero"),S()(qf,ce.KEEP,"keep"),S()(qf,ce.REPLACE,"replace"),S()(qf,ce.INVERT,"invert"),S()(qf,ce.INCR,"increment"),S()(qf,ce.DECR,"decrement"),S()(qf,ce.INCR_WRAP,"increment wrap"),S()(qf,ce.DECR_WRAP,"decrement wrap"),qf),_T=(Bm={},S()(Bm,ce.FRONT,"front"),S()(Bm,ce.BACK,"back"),Bm),xT=function(){function e(r,t){Ct()(this,e),S()(this,"buffer",void 0);var n=t.data,i=t.usage,s=t.type;this.buffer=r.buffer({data:n,usage:D1[i||ce.STATIC_DRAW],type:sg[s||ce.UNSIGNED_BYTE]})}return Bt()(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(t){var n=t.data,i=t.offset;this.buffer.subdata(n,i)}}]),e}(),bT=function(){function e(r,t){Ct()(this,e),S()(this,"elements",void 0);var n=t.data,i=t.usage,s=t.type,c=t.count;this.elements=r.elements({data:n,usage:D1[i||ce.STATIC_DRAW],type:sg[s||ce.UNSIGNED_BYTE],count:c})}return Bt()(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(t){var n=t.data;this.elements.subdata(n)}},{key:"destroy",value:function(){}}]),e}(),ET=function(){function e(r,t){Ct()(this,e),S()(this,"framebuffer",void 0);var n=t.width,i=t.height,s=t.color,c=t.colors,m=t.depth,g=t.stencil,x={width:n,height:i};Array.isArray(c)&&(x.colors=c.map(function(A){return A.get()})),s&&typeof s!="boolean"&&(x.color=s.get()),this.framebuffer=r.framebuffer(x)}return Bt()(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(t){var n=t.width,i=t.height;this.framebuffer.resize(n,i)}}]),e}(),ST=w("c6wG"),CT=w.n(ST),AT=w("YO3V"),wT=w.n(AT);function z1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Qf(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?z1(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):z1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var TT=function(){function e(r,t){Ct()(this,e),S()(this,"reGl",void 0),S()(this,"destroyed",!1),S()(this,"drawCommand",void 0),S()(this,"drawPickCommand",void 0),S()(this,"drawParams",void 0),S()(this,"options",void 0),S()(this,"uniforms",{}),this.reGl=r;var n=t.vs,i=t.fs,s=t.attributes,c=t.uniforms,m=t.primitive,g=t.count,x=t.elements,A=t.depth,M=t.blend,R=t.stencil,F=t.cull,Y=t.instances,ie={};this.options=t,c&&(this.uniforms=this.extractUniforms(c),Object.keys(c).forEach(function(nt){ie[nt]=r.prop(nt)}));var le={};Object.keys(s).forEach(function(nt){le[nt]=s[nt].get()});var Ae={attributes:le,frag:i,uniforms:ie,vert:n,blend:{},primitive:pT[m===void 0?ce.TRIANGLES:m]};Y&&(Ae.instances=Y),g&&(Ae.count=g),x&&(Ae.elements=x.get()),this.initDepthDrawParams({depth:A},Ae),this.initBlendDrawParams({blend:M},Ae),this.initStencilDrawParams({stencil:R},Ae),this.initCullDrawParams({cull:F},Ae),this.drawCommand=r(Ae);var Xe=Es()(Ae);Xe.blend=Qf(Qf({},Xe.blend),{},{enable:!1}),Xe.stencil=Qf(Qf({},Xe.stencil),{},{enable:!1}),this.drawPickCommand=r(Xe),this.drawParams=Ae}return Bt()(e,[{key:"addUniforms",value:function(t){this.uniforms=Qf(Qf({},this.uniforms),this.extractUniforms(t))}},{key:"draw",value:function(t,n){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var i=Qf(Qf({},this.uniforms),this.extractUniforms(t.uniforms||{})),s={};Object.keys(i).forEach(function(c){var m=jl()(i[c]);m==="boolean"||m==="number"||Array.isArray(i[c])||i[c].BYTES_PER_ELEMENT?s[c]=i[c]:s[c]=i[c].get()}),n?this.drawPickCommand(s):this.drawCommand(s)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(t){t.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(t,n){var i=t.depth;i&&(n.depth={enable:i.enable===void 0?!0:!!i.enable,mask:i.mask===void 0?!0:!!i.mask,func:gT[i.func||ce.LESS],range:i.range||[0,1]})}},{key:"initBlendDrawParams",value:function(t,n){var i=t.blend;if(i){var s=i.enable,c=i.func,m=i.equation,g=i.color,x=g===void 0?[0,0,0,0]:g;n.blend={enable:!!s,func:{srcRGB:Nm[c&&c.srcRGB||ce.SRC_ALPHA],srcAlpha:Nm[c&&c.srcAlpha||ce.SRC_ALPHA],dstRGB:Nm[c&&c.dstRGB||ce.ONE_MINUS_SRC_ALPHA],dstAlpha:Nm[c&&c.dstAlpha||ce.ONE_MINUS_SRC_ALPHA]},equation:{rgb:N1[m&&m.rgb||ce.FUNC_ADD],alpha:N1[m&&m.alpha||ce.FUNC_ADD]},color:x}}}},{key:"initStencilDrawParams",value:function(t,n){var i=t.stencil;if(i){var s=i.enable,c=i.mask,m=c===void 0?-1:c,g=i.func,x=g===void 0?{cmp:ce.ALWAYS,ref:0,mask:-1}:g,A=i.opFront,M=A===void 0?{fail:ce.KEEP,zfail:ce.KEEP,zpass:ce.KEEP}:A,R=i.opBack,F=R===void 0?{fail:ce.KEEP,zfail:ce.KEEP,zpass:ce.KEEP}:R;n.stencil={enable:!!s,mask:m,func:Qf(Qf({},x),{},{cmp:yT[x.cmp]}),opFront:{fail:Ud[M.fail],zfail:Ud[M.zfail],zpass:Ud[M.zpass]},opBack:{fail:Ud[F.fail],zfail:Ud[F.zfail],zpass:Ud[F.zpass]}}}}},{key:"initCullDrawParams",value:function(t,n){var i=t.cull;if(i){var s=i.enable,c=i.face,m=c===void 0?ce.BACK:c;n.cull={enable:!!s,face:_T[m]}}}},{key:"extractUniforms",value:function(t){var n=this,i={};return Object.keys(t).forEach(function(s){n.extractUniformsRecursively(s,t[s],i,"")}),i}},{key:"extractUniformsRecursively",value:function(t,n,i,s){var c=this;if(n===null||typeof n=="number"||typeof n=="boolean"||Array.isArray(n)&&typeof n[0]=="number"||CT()(n)||n===""||"resize"in n){i["".concat(s&&s+".").concat(t)]=n;return}wT()(n)&&Object.keys(n).forEach(function(m){c.extractUniformsRecursively(m,n[m],i,"".concat(s&&s+".").concat(t))}),Array.isArray(n)&&n.forEach(function(m,g){Object.keys(m).forEach(function(x){c.extractUniformsRecursively(x,m[x],i,"".concat(s&&s+".").concat(t,"[").concat(g,"]"))})})}}]),e}(),MT=function(){function e(r,t){Ct()(this,e),S()(this,"texture",void 0),S()(this,"width",void 0),S()(this,"height",void 0),S()(this,"isDistroy",!1);var n=t.data,i=t.type,s=i===void 0?ce.UNSIGNED_BYTE:i,c=t.width,m=t.height,g=t.flipY,x=g===void 0?!1:g,A=t.format,M=A===void 0?ce.RGBA:A,R=t.mipmap,F=R===void 0?!1:R,Y=t.wrapS,ie=Y===void 0?ce.CLAMP_TO_EDGE:Y,le=t.wrapT,Ae=le===void 0?ce.CLAMP_TO_EDGE:le,Xe=t.aniso,nt=Xe===void 0?0:Xe,at=t.alignment,It=at===void 0?1:at,Ot=t.premultiplyAlpha,Ut=Ot===void 0?!1:Ot,$t=t.mag,Tr=$t===void 0?ce.NEAREST:$t,Dr=t.min,Sr=Dr===void 0?ce.NEAREST:Dr,Sn=t.colorSpace,Dn=Sn===void 0?ce.BROWSER_DEFAULT_WEBGL:Sn,ai=t.x,Ua=ai===void 0?0:ai,To=t.y,Gs=To===void 0?0:To,Hu=t.copy,ws=Hu===void 0?!1:Hu;this.width=c,this.height=m;var Lh={width:c,height:m,type:sg[s],format:dT[M],wrapS:B1[ie],wrapT:B1[Ae],mag:F1[Tr],min:F1[Sr],alignment:It,flipY:x,colorSpace:mT[Dn],premultiplyAlpha:Ut,aniso:nt,x:Ua,y:Gs,copy:ws};n&&(Lh.data=n),typeof F=="number"?Lh.mipmap=vT[F]:typeof F=="boolean"&&(Lh.mipmap=F),this.texture=r.texture(Lh)}return Bt()(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(t)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(t){var n=t.width,i=t.height;this.texture.resize(n,i),this.width=n,this.height=i}},{key:"destroy",value:function(){this.isDistroy||this.texture.destroy(),this.isDistroy=!0}}]),e}(),U1,j1,PT=(U1=Object(Cr.injectable)(),U1(j1=function(){function e(){var r=this;Ct()(this,e),S()(this,"extensionObject",void 0),S()(this,"gl",void 0),S()(this,"$container",void 0),S()(this,"canvas",void 0),S()(this,"width",void 0),S()(this,"height",void 0),S()(this,"isDirty",void 0),S()(this,"createModel",function(t){return new TT(r.gl,t)}),S()(this,"createAttribute",function(t){return new hT(r.gl,t)}),S()(this,"createBuffer",function(t){return new xT(r.gl,t)}),S()(this,"createElements",function(t){return new bT(r.gl,t)}),S()(this,"createTexture2D",function(t){return new MT(r.gl,t)}),S()(this,"createFramebuffer",function(t){return new ET(r.gl,t)}),S()(this,"useFramebuffer",function(t,n){r.gl({framebuffer:t?t.get():null})(n)}),S()(this,"clear",function(t){var n=t.color,i=t.depth,s=t.stencil,c=t.framebuffer,m=c===void 0?null:c,g={color:n,depth:i,stencil:s};g.framebuffer=m===null?m:m.get(),r.gl.clear(g)}),S()(this,"viewport",function(t){var n=t.x,i=t.y,s=t.width,c=t.height;r.gl._gl.viewport(n,i,s,c),r.width=s,r.height=c,r.gl._refresh()}),S()(this,"readPixels",function(t){var n=t.framebuffer,i=t.x,s=t.y,c=t.width,m=t.height,g={x:i,y:s,width:c,height:m};return n&&(g.framebuffer=n.get()),r.gl.read(g)}),S()(this,"getViewportSize",function(){return{width:r.gl._gl.drawingBufferWidth,height:r.gl._gl.drawingBufferHeight}}),S()(this,"getContainer",function(){if(Pi)return r.canvas;var t;return(t=r.canvas)===null||t===void 0?void 0:t.parentElement}),S()(this,"getCanvas",function(){return r.canvas}),S()(this,"getGLContext",function(){return r.gl._gl}),S()(this,"destroy",function(){r.gl.destroy()})}return Bt()(e,[{key:"init",value:function(){var r=as()(la.a.mark(function n(i,s){var c=this;return la.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.canvas=i,g.next=3,new Promise(function(x,A){fT()({canvas:c.canvas,attributes:{alpha:!0,antialias:s.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:s.preserveDrawingBuffer,stencil:s.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(R,F){(R||!F)&&A(R),x(F)}})});case 3:this.gl=g.sent,this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 5:case"end":return g.stop()}},n,this)}));function t(n,i){return r.apply(this,arguments)}return t}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(t){return!!this.getGLContext().getExtension(t)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var t=this.getGLContext();t.disable(t.CULL_FACE)}},{key:"setDirty",value:function(t){this.isDirty=t}},{key:"getDirty",value:function(){return this.isDirty}}]),e}())||j1);function V1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function G1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?V1(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):V1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Zv=function(){function e(r){Ct()(this,e),S()(this,"sceneService",void 0),S()(this,"mapService",void 0),S()(this,"controlService",void 0),S()(this,"layerService",void 0),S()(this,"iconService",void 0),S()(this,"markerService",void 0),S()(this,"popupService",void 0),S()(this,"fontService",void 0),S()(this,"interactionService",void 0),S()(this,"container",void 0);var t=r.id,n=r.map,i=r.canvas,s=r.hasBaseMap,c=Mw();this.container=c,n.setContainer(c,t,i,s),c.bind(Kt.IRendererService).to(PT).inSingletonScope(),this.sceneService=c.get(Kt.ISceneService),this.mapService=c.get(Kt.IMapService),this.iconService=c.get(Kt.IIconService),this.fontService=c.get(Kt.IFontService),this.controlService=c.get(Kt.IControlService),this.layerService=c.get(Kt.ILayerService),this.markerService=c.get(Kt.IMarkerService),this.interactionService=c.get(Kt.IInteractionService),this.popupService=c.get(Kt.IPopupService),Pi?this.sceneService.initMiniScene(r):(this.initComponent(t),this.sceneService.init(r),this.initControl())}return Bt()(e,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(t){return this.sceneService.exportPng(t)}},{key:"exportMap",value:function(t){return this.sceneService.exportPng(t)}},{key:"registerRenderService",value:function(t){var n=this;if(this.sceneService.loaded){var i=new t(this);i.init()}else this.on("loaded",function(){var s=new t(n);s.init()})}},{key:"setBgColor",value:function(t){this.mapService.setBgColor(t)}},{key:"addLayer",value:function(t){var n=Pw(this.container);t.setContainer(n,this.container),this.sceneService.addLayer(t)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(t){return this.layerService.getLayer(t)}},{key:"getLayerByName",value:function(t){return this.layerService.getLayerByName(t)}},{key:"removeLayer",value:function(t,n){this.layerService.remove(t,n)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(t){this.layerService.setEnableRender(t)}},{key:"addIconFont",value:function(t,n){this.fontService.addIconFont(t,n)}},{key:"addIconFonts",value:function(t){var n=this;t.forEach(function(i){var s=ri()(i,2),c=s[0],m=s[1];n.fontService.addIconFont(c,m)})}},{key:"addFontFace",value:function(t,n){this.sceneService.addFontFace(t,n)}},{key:"addImage",value:function(t,n){Pi?this.iconService.addImageMini(t,n,this.sceneService):this.iconService.addImage(t,n)}},{key:"hasImage",value:function(t){return this.iconService.hasImage(t)}},{key:"removeImage",value:function(t){this.iconService.removeImage(t)}},{key:"addIconFontGlyphs",value:function(t,n){this.fontService.addIconGlyphs(n)}},{key:"addControl",value:function(t){this.controlService.addControl(t,this.container)}},{key:"removeControl",value:function(t){this.controlService.removeControl(t)}},{key:"getControlByName",value:function(t){return this.controlService.getControlByName(t)}},{key:"addMarker",value:function(t){this.markerService.addMarker(t)}},{key:"addMarkerLayer",value:function(t){this.markerService.addMarkerLayer(t)}},{key:"removeMarkerLayer",value:function(t){this.markerService.removeMarkerLayer(t)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(t){this.popupService.addPopup(t)}},{key:"on",value:function(t,n){og.indexOf(t)===-1?this.mapService.on(t,n):this.sceneService.on(t,n)}},{key:"once",value:function(t,n){og.indexOf(t)===-1?this.mapService.once(t,n):this.sceneService.once(t,n)}},{key:"off",value:function(t,n){og.indexOf(t)===-1?this.mapService.off(t,n):this.sceneService.off(t,n)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(t){return this.mapService.getCenter(t)}},{key:"setCenter",value:function(t,n){return this.mapService.setCenter(t,n)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(t){return this.mapService.setPitch(t)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(t){this.mapService.setRotation(t)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(t){this.mapService.panTo(t)}},{key:"panBy",value:function(t,n){this.mapService.panBy(t,n)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(t){this.mapService.setZoom(t)}},{key:"fitBounds",value:function(t,n){var i=this.sceneService.getSceneConfig(),s=i.fitBoundsOptions,c=i.animate;this.mapService.fitBounds(t,n||G1(G1({},s),{},{animate:c}))}},{key:"setZoomAndCenter",value:function(t,n){this.mapService.setZoomAndCenter(t,n)}},{key:"setMapStyle",value:function(t){this.mapService.setMapStyle(t)}},{key:"setMapStatus",value:function(t){this.mapService.setMapStatus(t)}},{key:"pixelToLngLat",value:function(t){return this.mapService.pixelToLngLat(t)}},{key:"lngLatToPixel",value:function(t){return this.mapService.lngLatToPixel(t)}},{key:"containerToLngLat",value:function(t){return this.mapService.containerToLngLat(t)}},{key:"lngLatToContainer",value:function(t){return this.mapService.lngLatToContainer(t)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(t,n){this.container.bind(Kt.IPostProcessingPass).to(t).whenTargetNamed(n)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(t){this.controlService.init({container:N.getContainer(t)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var t=this.sceneService.getSceneConfig(),n=t.logoVisible,i=t.logoPosition;n&&this.addControl(new w1({position:i}))}}]),e}(),OT=w("GoyQ"),rl=w.n(OT),H1,W1,Z1,ug,X1;function Y1(e){return e.map(function(r){return typeof r=="string"&&(r=[r,{}]),r})}var IT=(H1=Object(Cr.injectable)(),W1=Object(Cr.inject)(Kt.IGlobalConfigService),H1(Z1=(ug=function(){function e(){Ct()(this,e),Ei()(this,"configService",X1,this),S()(this,"enabled",void 0)}return Bt()(e,[{key:"apply",value:function(t,n){var i=this,s=n.rendererService,c=n.postProcessingPassFactory,m=n.normalPassFactory;t.hooks.init.tap("MultiPassRendererPlugin",function(){var g=t.getLayerConfig(),x=g.enableMultiPassRenderer,A=g.passes,M=A===void 0?[]:A;i.enabled=!!x&&t.getLayerConfig().enableMultiPassRenderer!==!1,i.enabled&&(t.multiPassRenderer=i.createMultiPassRenderer(t,M,c,m),t.multiPassRenderer.setRenderFlag(!0))}),t.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(i.enabled){var g=s.getViewportSize(),x=g.width,A=g.height;t.multiPassRenderer.resize(x,A)}})}},{key:"createMultiPassRenderer",value:function(t,n,i,s){var c=t.multiPassRenderer,m=t.getLayerConfig(),g=m.enablePicking,x=m.enableTAA;return x?c.add(s("taa")):c.add(s("render")),Y1(n).forEach(function(A){var M=ri()(A,2),R=M[0],F=M[1];c.add(i(R),F)}),c.add(i("copy")),c}}]),e}(),X1=yi()(ug.prototype,"configService",[W1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ug))||Z1),up,K1=(up={},S()(up,Oc.additive,{enable:!0,func:{srcRGB:ce.ONE,dstRGB:ce.ONE,srcAlpha:1,dstAlpha:1}}),S()(up,Oc.none,{enable:!1}),S()(up,Oc.normal,{enable:!0,func:{srcRGB:ce.SRC_ALPHA,dstRGB:ce.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),S()(up,Oc.subtractive,{enable:!0,func:{srcRGB:ce.ONE,dstRGB:ce.ONE,srcAlpha:ce.ZERO,dstAlpha:ce.ONE_MINUS_SRC_COLOR},equation:{rgb:ce.FUNC_SUBTRACT,alpha:ce.FUNC_SUBTRACT}}),S()(up,Oc.max,{enable:!0,func:{srcRGB:ce.ONE,dstRGB:ce.ONE},equation:{rgb:ce.MAX_EXT}}),S()(up,Oc.min,{enable:!0,func:{srcRGB:ce.ONE,dstRGB:ce.ONE},equation:{rgb:ce.MIN_EXT}}),up),RT=w("UB5X"),Da=w.n(RT),kT=w("Z0cm"),Kp=w.n(kT),iF=1024;function Sl(e,r,t,n,i){r.updateStyleAttribute(e,t,n,i)}function LT(e,r){e.opacity&&zm("opacity",r,e.opacity),e.strokeWidth&&zm("strokeWidth",r,e.strokeWidth),e.strokeOpacity&&zm("strokeOpacity",r,e.strokeOpacity),e.stroke&&DT("stroke",r,e.stroke),e.offsets&&$1("offsets",r,e.offsets),e.textOffset&&$1("textOffset",r,e.textOffset),e.thetaOffset&&zm("thetaOffset",r,e.thetaOffset)}function zm(e,r,t){Ba()(t)?Sl(e,r,t,function(n){return n}):Da()(t)?Sl(e,r,[t],void 0):Kp()(t)&&t.length===2?Ba()(t[0])&&ks()(t[1])||Ba()(t[0])&&Kp()(t[1])&&Da()(t[1][0])&&Da()(t[1][1])?Sl(e,r,t[0],t[1]):Sl(e,r,[1],void 0):Sl(e,r,[1],void 0)}function $1(e,r,t){Ba()(t)?Sl(e,r,t,function(n){return n}):Kp()(t)&&t.length===2&&Ba()(t[0])&&ks()(t[1])?Sl(e,r,t[0],t[1]):Kp()(t)&&t.length===2&&Da()(t[0])&&Da()(t[1])?Sl(e,r,t,void 0):Sl(e,r,[0,0],void 0)}function DT(e,r,t){Ba()(t)?Sl(e,r,t,void 0):Kp()(t)&&t.length===2&&(Ba()(t[0])&&ks()(t[1])||Ba()(t[0])&&Kp()(t[1])&&t[1].length>0)?Sl(e,r,t[0],t[1]):Sl(e,r,"#fff",void 0)}var FT=[["circle","cylinder"],["square","cylinder"],["triangle","cylinder"],["pentagon","cylinder"],["hexagon","cylinder"],["octogon","cylinder"],["hexagram","cylinder"],["rhombus","cylinder"],["vesica","cylinder"]];function BT(e,r,t){typeof r=="string"&&typeof t=="string"&&r!==t&&FT.map(function(n){n.includes(r)&&n.includes(t)&&(e.dataState.dataSourceNeedUpdate=!0)})}var NT=["passes"],zT=["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber"],q1,lg,Q1;function UT(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=jT(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function jT(e,r){if(!!e){if(typeof e=="string")return J1(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return J1(e,r)}}function J1(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function ex(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function nl(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ex(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ex(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function VT(e){var r=GT();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function GT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tx=0,$p=(q1=ag(Kt.IGlobalConfigService),lg=function(e){Nr()(t,e);var r=VT(t);function t(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ct()(this,t),n=r.call(this),S()(oe()(n),"id","".concat(tx++)),S()(oe()(n),"name","".concat(tx)),S()(oe()(n),"type",void 0),S()(oe()(n),"visible",!0),S()(oe()(n),"zIndex",0),S()(oe()(n),"minZoom",void 0),S()(oe()(n),"maxZoom",void 0),S()(oe()(n),"inited",!1),S()(oe()(n),"layerModelNeedUpdate",!1),S()(oe()(n),"pickedFeatureID",null),S()(oe()(n),"selectedFeatureID",null),S()(oe()(n),"styleNeedUpdate",!1),S()(oe()(n),"rendering",void 0),S()(oe()(n),"clusterZoom",0),S()(oe()(n),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),S()(oe()(n),"hooks",{init:new Co.b,afterInit:new Co.b,beforeRender:new Co.b,beforeRenderData:new Co.d,afterRender:new Co.c,beforePickingEncode:new Co.c,afterPickingEncode:new Co.c,beforeHighlight:new Co.c(["pickedColor"]),afterHighlight:new Co.c,beforeSelect:new Co.c(["pickedColor"]),afterSelect:new Co.c,beforeDestroy:new Co.c,afterDestroy:new Co.c}),S()(oe()(n),"models",[]),S()(oe()(n),"multiPassRenderer",void 0),S()(oe()(n),"plugins",void 0),S()(oe()(n),"sourceOption",void 0),S()(oe()(n),"layerModel",void 0),S()(oe()(n),"sceneContainer",void 0),S()(oe()(n),"layerChildren",[]),Ei()(oe()(n),"configService",Q1,oe()(n)),S()(oe()(n),"shaderModuleService",void 0),S()(oe()(n),"cameraService",void 0),S()(oe()(n),"coordinateService",void 0),S()(oe()(n),"iconService",void 0),S()(oe()(n),"fontService",void 0),S()(oe()(n),"pickingService",void 0),S()(oe()(n),"rendererService",void 0),S()(oe()(n),"layerService",void 0),S()(oe()(n),"interactionService",void 0),S()(oe()(n),"mapService",void 0),S()(oe()(n),"styleAttributeService",void 0),S()(oe()(n),"layerSource",void 0),S()(oe()(n),"postProcessingPassFactory",void 0),S()(oe()(n),"normalPassFactory",void 0),S()(oe()(n),"animateOptions",{enable:!1}),S()(oe()(n),"container",void 0),S()(oe()(n),"encodedData",void 0),S()(oe()(n),"configSchema",void 0),S()(oe()(n),"currentPickId",null),S()(oe()(n),"rawConfig",void 0),S()(oe()(n),"needUpdateConfig",void 0),S()(oe()(n),"pendingStyleAttributes",[]),S()(oe()(n),"scaleOptions",{}),S()(oe()(n),"animateStartTime",void 0),S()(oe()(n),"aniamateStatus",!1),S()(oe()(n),"bottomColor","rgba(0, 0, 0, 0)"),S()(oe()(n),"isDestroied",!1),S()(oe()(n),"sourceEvent",function(){n.dataState.dataSourceNeedUpdate=!0;var s=n.getLayerConfig(),c=s.autoFit,m=s.fitBoundsOptions;c&&n.fitBounds(m),n.emit("dataUpdate"),n.reRender()}),n.name=i.name||n.id,n.zIndex=i.zIndex||0,n.rawConfig=i,n}return Bt()(t,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(i){if(!this.inited)this.needUpdateConfig=nl(nl({},this.needUpdateConfig),i);else{var s=this.container.get(Kt.SceneID);LT(i,this),this.configService.setLayerConfig(s,this.id,nl(nl(nl({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),i)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(i,s){this.container=i,this.sceneContainer=s}},{key:"getContainer",value:function(){return this.container}},{key:"setBottomColor",value:function(i){this.bottomColor=i}},{key:"getBottomColor",value:function(){return this.bottomColor}},{key:"addPlugin",value:function(i){return this.plugins.push(i),this}},{key:"init",value:function(){var i=this,s=this.container.get(Kt.SceneID);this.configService.setLayerConfig(s,this.id,this.rawConfig),this.iconService=this.container.get(Kt.IIconService),this.fontService=this.container.get(Kt.IFontService),this.rendererService=this.container.get(Kt.IRendererService),this.layerService=this.container.get(Kt.ILayerService),this.interactionService=this.container.get(Kt.IInteractionService),this.pickingService=this.container.get(Kt.IPickingService),this.mapService=this.container.get(Kt.IMapService),this.cameraService=this.container.get(Kt.ICameraService),this.coordinateService=this.container.get(Kt.ICoordinateSystemService),this.shaderModuleService=this.container.get(Kt.IShaderModuleService),this.postProcessingPassFactory=this.container.get(Kt.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Kt.IFactoryNormalPass),this.styleAttributeService=this.container.get(Kt.IStyleAttributeService),this.multiPassRenderer=this.container.get(Kt.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(x){var A=x.attributeName,M=x.attributeField,R=x.attributeValues,F=x.updateOptions;i.styleAttributeService.updateStyleAttribute(A,{scale:nl({field:M},i.splitValuesAndCallbackInAttribute(R,i.getLayerConfig()[A]))},F)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Kt.ILayerPlugin);var c=UT(this.plugins),m;try{for(c.s();!(m=c.n()).done;){var g=m.value;g.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(x){c.e(x)}finally{c.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(nl(nl({},this.getDefaultConfig()),this.rawConfig));var i=this.getLayerConfig(),s=i.animateOption;s!=null&&s.enable&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(i,s,c){return this.updateStyleAttribute("color",i,s,c),this}},{key:"texture",value:function(i,s,c){return this.updateStyleAttribute("texture",i,s,c),this}},{key:"rotate",value:function(i,s,c){return this.updateStyleAttribute("rotate",i,s,c),this}},{key:"size",value:function(i,s,c){return this.updateStyleAttribute("size",i,s,c),this}},{key:"filter",value:function(i,s,c){return this.updateStyleAttribute("filter",i,s,c),this}},{key:"shape",value:function(i,s,c){var m,g,x,A=(m=this.styleAttributeService)===null||m===void 0||(g=m.getLayerStyleAttribute("shape"))===null||g===void 0||(x=g.scale)===null||x===void 0?void 0:x.field,M=i;return this.updateStyleAttribute("shape",i,s,c),BT(this,A,M),this}},{key:"label",value:function(i,s,c){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:i,attributeValues:s,updateOptions:c}),this}},{key:"animate",value:function(i){var s={};return rl()(i)?(s.enable=!0,s=nl(nl({},s),i)):s.enable=i,this.updateLayerConfig({animateOption:s}),this}},{key:"source",value:function(i,s){return i!=null&&i.data?(this.setSource(i),this):(this.sourceOption={data:i,options:s},this.clusterZoom=0,this)}},{key:"setData",value:function(i,s){var c=this;return this.inited?this.layerSource.setData(i,s):this.on("inited",function(){c.layerSource.setData(i,s)}),this}},{key:"style",value:function(i){var s=this,c=i.passes,m=Ah()(i,NT);return c&&Y1(c).forEach(function(g){var x=s.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(g[0]);x&&x.updateOptions(g[1])}),this.rawConfig=nl(nl({},this.rawConfig),m),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(i,s){return rl()(i)?this.scaleOptions=nl(nl({},this.scaleOptions),i):this.scaleOptions[i]=s,this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return this.getEncodedData().length!==0&&this.renderModels(),this}},{key:"renderMultiPass",value:function(){var n=as()(la.a.mark(function s(){return la.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(this.getEncodedData().length===0){m.next=7;break}if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){m.next=6;break}return m.next=4,this.multiPassRenderer.render();case 4:m.next=7;break;case 6:this.multiPassRenderer?this.renderModels():this.renderModels();case 7:case"end":return m.stop()}},s,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"active",value:function(i){var s={};return s.enableHighlight=rl()(i)?!0:i,rl()(i)?(s.enableHighlight=!0,i.color&&(s.highlightColor=i.color),i.mix&&(s.activeMix=i.mix)):s.enableHighlight=!!i,this.updateLayerConfig(s),this}},{key:"setActive",value:function(i,s){var c=this;if(rl()(i)){var m=i.x,g=m===void 0?0:m,x=i.y,A=x===void 0?0:x;this.updateLayerConfig({highlightColor:rl()(s)?s.color:this.getLayerConfig().highlightColor,activeMix:rl()(s)?s.mix:this.getLayerConfig().activeMix}),this.pick({x:g,y:A})}else this.updateLayerConfig({pickedFeatureID:i,highlightColor:rl()(s)?s.color:this.getLayerConfig().highlightColor,activeMix:rl()(s)?s.mix:this.getLayerConfig().activeMix}),this.hooks.beforeSelect.call(cn(i)).then(function(){setTimeout(function(){c.reRender()},1)})}},{key:"select",value:function(i){var s={};return s.enableSelect=rl()(i)?!0:i,rl()(i)?(s.enableSelect=!0,i.color&&(s.selectColor=i.color),i.mix&&(s.selectMix=i.mix)):s.enableSelect=!!i,this.updateLayerConfig(s),this}},{key:"setSelect",value:function(i,s){var c=this;if(rl()(i)){var m=i.x,g=m===void 0?0:m,x=i.y,A=x===void 0?0:x;this.updateLayerConfig({selectColor:rl()(s)?s.color:this.getLayerConfig().selectColor,selectMix:rl()(s)?s.mix:this.getLayerConfig().selectMix}),this.pick({x:g,y:A})}else this.updateLayerConfig({pickedFeatureID:i,selectColor:rl()(s)?s.color:this.getLayerConfig().selectColor,selectMix:rl()(s)?s.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(cn(i)).then(function(){setTimeout(function(){c.reRender()},1)})}},{key:"setBlend",value:function(i){this.updateLayerConfig({blend:i}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(i){return this.zIndex=i,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(i){this.currentPickId=i}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(i){this.selectedFeatureID=i}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var i=this.mapService.getZoom(),s=this.getLayerConfig(),c=s.visible,m=s.minZoom,g=m===void 0?-Infinity:m,x=s.maxZoom,A=x===void 0?Infinity:x;return!!c&&i>=g&&i<=A}},{key:"setMinZoom",value:function(i){return this.updateLayerConfig({minZoom:i}),this}},{key:"getMinZoom",value:function(){var i=this.getLayerConfig(),s=i.minZoom;return s}},{key:"getMaxZoom",value:function(){var i=this.getLayerConfig(),s=i.maxZoom;return s}},{key:"get",value:function(i){var s=this.getLayerConfig();return s[i]}},{key:"setMaxZoom",value:function(i){return this.updateLayerConfig({maxZoom:i}),this}},{key:"fitBounds",value:function(i){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var s=this.getSource(),c=s.extent,m=c.some(function(g){return Math.abs(g)===Infinity});return m?this:(this.mapService.fitBounds([[c[0],c[1]],[c[2],c[3]]],i),this)}},{key:"destroy",value:function(){this.isDestroied||(this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.models=[],this.layerService.cleanRemove(this),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroied=!0)}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(i){return i.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(i){return i.needRescale||i.needRemapping||i.needRegenerateVertices}).length}},{key:"setSource",value:function(i){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=i,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var s=this.mapService.getZoom();this.layerSource.updateClusterData(s)}this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(i){this.encodedData=i}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(i){return this.styleAttributeService.getLayerAttributeScale(i)}},{key:"getLegendItems",value:function(i){var s=this.styleAttributeService.getLayerAttributeScale(i);if(s){if(s.ticks){var c=s.ticks().map(function(x){return S()({value:x},i,s(x))});return c}else if(s.invertExtent){var m=s.range().map(function(x){return S()({value:s.invertExtent(x)},i,x)});return m}else if(s!=null&&s.domain){var g=s.domain().map(function(x){return{value:x||"\u65E0",color:s(x)}});return g}}else return[]}},{key:"pick",value:function(i){var s=i.x,c=i.y;this.interactionService.triggerHover({x:s,y:c})}},{key:"boxSelect",value:function(i,s){this.pickingService.boxPickLayer(this,i,s)}},{key:"buildLayerModel",value:function(i){var s=i.moduleName,c=i.vertexShader,m=i.fragmentShader,g=i.triangulation,x=i.segmentNumber,A=Ah()(i,zT);this.shaderModuleService.registerModule(s,{vs:c,fs:m});var M=this.shaderModuleService.getModule(s),R=M.vs,F=M.fs,Y=M.uniforms,ie=this.rendererService.createModel,le=this.styleAttributeService.createAttributesAndIndices(this.encodedData,g,x),Ae=le.attributes,Xe=le.elements;return ie(nl({attributes:Ae,uniforms:Y,fs:F,vs:R,elements:Xe,blend:K1[Oc.normal]},A))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(i){var s=this.getLayerConfig(),c=s.enableHighlight,m=c===void 0?!0:c,g=s.enableSelect,x=g===void 0?!0:g,A=this.eventNames().indexOf(i)!==-1||this.eventNames().indexOf("un"+i)!==-1;return(i==="click"||i==="dblclick")&&x&&(A=!0),i==="mousemove"&&(m||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(A=!0),this.isVisible()&&A}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderMulPass",value:function(){var n=as()(la.a.mark(function s(c){return la.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,c.render();case 2:case"end":return g.stop()}},s)}));function i(s){return n.apply(this,arguments)}return i}()},{key:"renderModels",value:function(i){var s=this;return this.getEncodedData().length>0&&(this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(c){c.draw({uniforms:s.layerModel.getUninforms()},i)})),this}},{key:"updateStyleAttribute",value:function(i,s,c,m){this.inited?this.styleAttributeService.updateStyleAttribute(i,{scale:nl({field:s},this.splitValuesAndCallbackInAttribute(c,this.getLayerConfig()[s]))},m):this.pendingStyleAttributes.push({attributeName:i,attributeField:s,attributeValues:c,updateOptions:m})}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(i){console.warn("empty fn")}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&(this.layerService.updateLayerRenderList(),this.layerService.renderLayers())}},{key:"splitValuesAndCallbackInAttribute",value:function(i,s){return{values:ks()(i)?void 0:i||s,callback:ks()(i)?i:void 0}}}]),t}(Ls.EventEmitter),Q1=yi()(lg.prototype,"configService",[q1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lg),HT=w("Y+p1"),jd=w.n(HT),rx,cg,nx;function WT(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=ZT(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function ZT(e,r){if(!!e){if(typeof e=="string")return ix(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ix(e,r)}}function ix(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var As=(rx=ag(Kt.IGlobalConfigService),cg=function(){function e(r){Ct()(this,e),S()(this,"triangulation",void 0),S()(this,"createTexture2D",void 0),S()(this,"layer",void 0),S()(this,"dataTexture",void 0),S()(this,"DATA_TEXTURE_WIDTH",void 0),S()(this,"rowCount",void 0),S()(this,"cacheStyleProperties",void 0),S()(this,"cellLength",void 0),S()(this,"cellProperties",void 0),S()(this,"cellTypeLayout",void 0),S()(this,"stylePropertyesExist",void 0),S()(this,"dataTextureTest",void 0),Ei()(this,"configService",nx,this),S()(this,"shaderModuleService",void 0),S()(this,"rendererService",void 0),S()(this,"iconService",void 0),S()(this,"fontService",void 0),S()(this,"styleAttributeService",void 0),S()(this,"mapService",void 0),S()(this,"cameraService",void 0),S()(this,"layerService",void 0),this.layer=r,this.rendererService=r.getContainer().get(Kt.IRendererService),this.shaderModuleService=r.getContainer().get(Kt.IShaderModuleService),this.styleAttributeService=r.getContainer().get(Kt.IStyleAttributeService),this.mapService=r.getContainer().get(Kt.IMapService),this.iconService=r.getContainer().get(Kt.IIconService),this.fontService=r.getContainer().get(Kt.IFontService),this.cameraService=r.getContainer().get(Kt.ICameraService),this.layerService=r.getContainer().get(Kt.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate();var t=this.rendererService.createTexture2D;this.createTexture2D=t,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={thetaOffset:void 0,opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertyesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new Uint8ClampedArray(4),mag:ce.NEAREST,min:ce.NEAREST,width:1,height:1}))}return Bt()(e,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertyesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertyesExist.hasOpacity,this.stylePropertyesExist.hasStrokeOpacity,this.stylePropertyesExist.hasStrokeWidth,this.stylePropertyesExist.hasStroke,this.stylePropertyesExist.hasOffsets,this.stylePropertyesExist.hasThetaOffset,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(t){var n=!1;return jd()(t.thetaOffset,this.cacheStyleProperties.thetaOffset)||(n=!0,this.cacheStyleProperties.thetaOffset=t.thetaOffset),jd()(t.opacity,this.cacheStyleProperties.opacity)||(n=!0,this.cacheStyleProperties.opacity=t.opacity),jd()(t.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(n=!0,this.cacheStyleProperties.strokeOpacity=t.strokeOpacity),jd()(t.strokeWidth,this.cacheStyleProperties.strokeWidth)||(n=!0,this.cacheStyleProperties.strokeWidth=t.strokeWidth),jd()(t.stroke,this.cacheStyleProperties.stroke)||(n=!0,this.cacheStyleProperties.stroke=t.stroke),jd()(t.offsets,this.cacheStyleProperties.offsets)||(n=!0,this.cacheStyleProperties.offsets=t.offsets),this.dataTexture===void 0&&(n=!0),n}},{key:"judgeStyleAttributes",value:function(t){this.clearLastCalRes(),t.opacity!==void 0&&!Da()(t.opacity)&&(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertyesExist.hasOpacity=1,this.cellLength+=1),t.strokeOpacity!==void 0&&!Da()(t.strokeOpacity)&&(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertyesExist.hasStrokeOpacity=1,this.cellLength+=1),t.strokeWidth!==void 0&&!Da()(t.strokeWidth)&&(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertyesExist.hasStrokeWidth=1,this.cellLength+=1),t.stroke!==void 0&&!this.isStaticColor(t.stroke)&&(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertyesExist.hasStroke=1,this.cellLength+=4),t.offsets!==void 0&&!this.isOffsetStatic(t.offsets)&&(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertyesExist.hasOffsets=1,this.cellLength+=2),t.thetaOffset!==void 0&&!Da()(t.thetaOffset)&&(this.cellProperties.push({attr:"thetaOffset",count:1}),this.stylePropertyesExist.hasThetaOffset=1,this.cellLength+=1)}},{key:"isStaticColor",value:function(t){return Ba()(t)?!!q(t):!1}},{key:"getStrokeColor",value:function(t){if(this.isStaticColor(t)){var n=xr(t);return n[0]=n[0]?n[0]:0,n[1]=n[1]?n[1]:0,n[2]=n[2]?n[2]:0,n[3]=n[3]?n[3]:0,n}else return[0,0,0,0]}},{key:"isOffsetStatic",value:function(t){return!!(Kp()(t)&&t.length===2&&Da()(t[0])&&Da()(t[1]))}},{key:"patchMod",value:function(t,n){for(var i=0;i<n;i++)t.push(-1)}},{key:"patchData",value:function(t,n,i){var s=WT(i),c;try{for(s.s();!(c=s.n()).done;){var m=c.value,g=m.attr,x=m.count,A=n[g];A!==void 0?g==="stroke"?t.push.apply(t,Pt()(xr(A))):g==="offsets"?this.isOffsetStatic(A)?t.push(-A[0],A[1]):t.push(0,0):t.push(Da()(A)?A:1):this.patchMod(t,x)}}catch(M){s.e(M)}finally{s.f()}}},{key:"calDataFrame",value:function(t,n,i){for(var s=n.length,c=Math.ceil(s*t/this.DATA_TEXTURE_WIDTH),m=c*this.DATA_TEXTURE_WIDTH,g=[],x=0;x<s;x++){var A=n[x];this.patchData(g,A,i)}for(var M=g.length;M<m;M++)g.push(-1);return{data:g,width:this.DATA_TEXTURE_WIDTH,height:c}}},{key:"getBlend",value:function(){var t=this.layer.getLayerConfig(),n=t.blend,i=n===void 0?"normal":n;return K1[Oc[i]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.duration||4,t.interval||.2,t.trailLength||.1]}},{key:"startModelAnimate",value:function(){var t=this.layer.getLayerConfig(),n=t.animateOption;n.enable&&this.layer.setAnimateStartTime()}}]),e}(),nx=yi()(cg.prototype,"configService",[rx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cg),XT=w("VmRL"),Jf=w.n(XT),Um=100,ax=36,YT=40;function ox(e){return e/180*Math.acos(-1)}function sx(e){var r=ox(e[0])+Math.PI/2,t=ox(e[1]),n=Um+Math.random()*.4,i=n*Math.cos(t)*Math.cos(r),s=n*Math.cos(t)*Math.sin(r),c=n*Math.sin(t);return[s,c,i]}function ux(e,r){var t=B.create(),n=B.create(),i=z.fromValues(0,1,0),s=z.fromValues(0,0,0);r=r||{},e=typeof e!="undefined"?e:1;for(var c=typeof r.segments!="undefined"?r.segments:32,m=2+c,g=2*m,x=[],A=[],M=[],R=[],F=[],Y=[],ie=0;ie<=m;ie++){for(var le=ie/m,Ae=le*Math.PI,Xe=0;Xe<=g;Xe++){var nt=Xe/g,at=nt*Math.PI*2;B.identity(n),B.rotateZ(n,n,-Ae),B.identity(t),B.rotateY(t,t,at),z.transformMat4(s,i,n),z.transformMat4(s,s,t),z.scale(s,s,-e),M.push(s.slice()),R.push.apply(R,Pt()(s.slice())),z.normalize(s,s),F.push.apply(F,Pt()(s.slice())),Y.push([nt,1-le]),R.push(nt,1-le)}if(ie>0)for(var It=M.length,Ot=It-2*(g+1);Ot+g+2<It;Ot++)x.push([Ot,Ot+1,Ot+g+1]),A.push(Ot,Ot+1,Ot+g+1),x.push([Ot+g+1,Ot+1,Ot+g+2]),A.push(Ot+g+1,Ot+1,Ot+g+2)}return{cells:x,positions:M,uvs:Y,positionsArr:R,indicesArr:A,normalArr:F}}var jm=h.create(),aF=h.create(),iu=h.create(),lp=h.create(),Vd=h.create();function fg(e,r,t,n,i){h.add(e,t,n),h.normalize(e,e),r=h.fromValues(-e[1],e[0]);var s=h.fromValues(-t[1],t[0]);return[i/h.dot(r,s),r]}function cp(e,r){return h.set(e,-r[1],r[0])}function Gd(e,r,t){return h.sub(e,r,t),h.normalize(e,e),e}function hg(e,r){return e[0]===r[0]&&e[1]===r[1]}function oF(e){for(var r=new Map,t=0;t<e.length;t++){var n=e[0].toString()+"-"+e[1].toString();r.get(n)?(e.splice(t,1),t++):r.set(n,n)}return e}var lx=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ct()(this,e),S()(this,"complex",void 0),S()(this,"join",void 0),S()(this,"cap",void 0),S()(this,"miterLimit",void 0),S()(this,"thickness",void 0),S()(this,"normal",void 0),S()(this,"lastFlip",-1),S()(this,"miter",h.fromValues(0,0)),S()(this,"started",!1),S()(this,"dash",!1),S()(this,"totalDistance",0),this.join=r.join||"miter",this.cap=r.cap||"butt",this.miterLimit=r.miterLimit||10,this.thickness=r.thickness||1,this.dash=r.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return Bt()(e,[{key:"extrude_gaode2",value:function(t,n){var i=this.complex;if(t.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var s=t.length,c=i.startIndex,m=1;m<s;m++){var g,x,A,M=t[m-1];M.push((g=n[m-1][2])!==null&&g!==void 0?g:0);var R=n[m-1],F=t[m];F.push((x=n[m][2])!==null&&x!==void 0?x:0);var Y=n[m],ie=m<t.length-1?[].concat(Pt()(t[m+1]),[(A=n[m+1][2])!==null&&A!==void 0?A:0]):null,le=m<n.length-1?n[m+1]:null,Ae=this.segment_gaode2(i,c,M,F,ie,R,Y,le);c+=Ae}if(this.dash)for(var Xe=0;Xe<i.positions.length/6;Xe++)i.positions[Xe*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"simpleExtrude_gaode2",value:function(t,n){var i=this.complex;if(t.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var s=t.length,c=i.startIndex,m=1;m<s;m++){var g,x,A,M=t[m-1];M.push((g=n[m-1][2])!==null&&g!==void 0?g:0);var R=n[m-1],F=t[m];F.push((x=n[m][2])!==null&&x!==void 0?x:0);var Y=n[m],ie=m<t.length-1?[].concat(Pt()(t[m+1]),[(A=n[m+1][2])!==null&&A!==void 0?A:0]):null,le=m<n.length-1?n[m+1]:null,Ae=this.simpleSegment(i,c,M,F,ie,R,Y,le);c+=Ae}if(this.dash)for(var Xe=0;Xe<i.positions.length/6;Xe++)i.positions[Xe*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"extrude",value:function(t){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=t.length,s=n.startIndex,c=1;c<i;c++){var m=t[c-1],g=t[c],x=c<t.length-1?t[c+1]:null,A=this.segment(n,s,m,g,x);s+=A}if(this.dash)for(var M=0;M<n.positions.length/6;M++)n.positions[M*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude",value:function(t){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=t.length,s=n.startIndex,c=1;c<i;c++){var m=t[c-1],g=t[c],x=c<t.length-1?t[c+1]:null,A=this.simpleSegment(n,s,m,g,x);s+=A}if(this.dash)for(var M=0;M<n.positions.length/6;M++)n.positions[M*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"segment_gaode2",value:function(t,n,i,s,c,m,g,x){var A=0,M=t.indices,R=t.positions,F=t.normals,Y=this.cap==="square",ie=this.join==="bevel",le=vo([g[0],g[1]]),Ae=vo([m[0],m[1]]);Gd(iu,s,i);var Xe=0;if(this.dash&&(Xe=this.lineSegmentDistance(le,Ae),this.totalDistance+=Xe),this.normal||(this.normal=h.create(),cp(this.normal,iu)),!this.started)if(this.started=!0,Y){var nt=h.create(),at=h.create();h.add(nt,this.normal,iu),h.add(at,this.normal,iu),F.push(at[0],at[1],0),F.push(nt[0],nt[1],0),R.push(i[0],i[1],i[2]|0,this.totalDistance-Xe,-this.thickness,i[2]|0),R.push(i[0],i[1],i[2]|0,this.totalDistance-Xe,this.thickness,i[2]|0)}else this.extrusions(R,F,i,this.normal,this.thickness,this.totalDistance-Xe);if(M.push(n+0,n+1,n+2),c){hg(s,c)&&h.add(c,s,h.normalize(c,h.subtract(c,s,i))),Gd(lp,c,s);var Ut=fg(Vd,h.create(),iu,lp,this.thickness),$t=ri()(Ut,2),Tr=$t[0],Dr=$t[1],Sr=h.dot(Vd,this.normal)<0?-1:1,Sn=ie;if(!Sn&&this.join==="miter"){var Dn=Tr;Dn>this.miterLimit&&(Sn=!0)}Sn?(F.push(this.normal[0],this.normal[1],0),F.push(Dr[0],Dr[1],0),R.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*Sr,s[2]|0),R.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness*Sr,s[2]|0),M.push.apply(M,Pt()(this.lastFlip!==-Sr?[n,n+2,n+3]:[n+2,n+1,n+3])),M.push(n+2,n+3,n+4),cp(jm,lp),h.copy(this.normal,jm),F.push(this.normal[0],this.normal[1],0),R.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*Sr,s[2]|0),A+=3):(this.extrusions(R,F,s,Dr,Tr,this.totalDistance),M.push.apply(M,Pt()(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),Sr=-1,h.copy(this.normal,Dr),A+=2),this.lastFlip=Sr}else{if(cp(this.normal,iu),Y){var It=h.create(),Ot=h.create();h.sub(Ot,iu,this.normal),h.add(It,iu,this.normal),F.push(Ot[0],Ot[1],0),F.push(It[0],It[1],0),R.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0),R.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0)}else this.extrusions(R,F,s,this.normal,this.thickness,this.totalDistance);M.push.apply(M,Pt()(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),A+=2}return A}},{key:"simpleSegment",value:function(t,n,i,s,c){var m=0,g=t.indices,x=t.positions,A=t.normals,M=vo([s[0],s[1]]),R=vo([i[0],i[1]]);Gd(iu,M,R);var F=0;if(this.dash&&(F=this.lineSegmentDistance(M,R),this.totalDistance+=F),this.normal||(this.normal=h.create(),cp(this.normal,iu)),this.started||(this.started=!0,this.extrusions(x,A,i,this.normal,this.thickness,this.totalDistance-F)),g.push(n+0,n+1,n+2),!c)cp(this.normal,iu),this.extrusions(x,A,s,this.normal,this.thickness,this.totalDistance),g.push.apply(g,Pt()(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),m+=2;else{var Y=vo([c[0],c[1]]);hg(M,Y)&&h.add(Y,M,h.normalize(Y,h.subtract(Y,M,R))),Gd(lp,Y,M);var ie=fg(Vd,h.create(),iu,lp,this.thickness),le=ri()(ie,2),Ae=le[0],Xe=le[1],nt=h.dot(Vd,this.normal)<0?-1:1;this.extrusions(x,A,s,Xe,Ae,this.totalDistance),g.push.apply(g,Pt()(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),nt=-1,h.copy(this.normal,Xe),m+=2,this.lastFlip=nt}return m}},{key:"segment",value:function(t,n,i,s,c){var m=0,g=t.indices,x=t.positions,A=t.normals,M=this.cap==="square",R=this.join==="bevel",F=vo([s[0],s[1]]),Y=vo([i[0],i[1]]);Gd(iu,F,Y);var ie=0;if(this.dash&&(ie=this.lineSegmentDistance(F,Y),this.totalDistance+=ie),this.normal||(this.normal=h.create(),cp(this.normal,iu)),!this.started)if(this.started=!0,M){var le=h.create(),Ae=h.create();h.add(le,this.normal,iu),h.add(Ae,this.normal,iu),A.push(Ae[0],Ae[1],0),A.push(le[0],le[1],0),x.push(i[0],i[1],i[2]|0,this.totalDistance-ie,-this.thickness,i[2]|0),x.push(i[0],i[1],i[2]|0,this.totalDistance-ie,this.thickness,i[2]|0)}else this.extrusions(x,A,i,this.normal,this.thickness,this.totalDistance-ie);if(g.push(n+0,n+1,n+2),c){var at=vo([c[0],c[1]]);hg(F,at)&&h.add(at,F,h.normalize(at,h.subtract(at,F,Y))),Gd(lp,at,F);var It=fg(Vd,h.create(),iu,lp,this.thickness),Ot=ri()(It,2),Ut=Ot[0],$t=Ot[1],Tr=h.dot(Vd,this.normal)<0?-1:1,Dr=R;if(!Dr&&this.join==="miter"){var Sr=Ut;Sr>this.miterLimit&&(Dr=!0)}Dr?(A.push(this.normal[0],this.normal[1],0),A.push($t[0],$t[1],0),x.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*Tr,s[2]|0),x.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness*Tr,s[2]|0),g.push.apply(g,Pt()(this.lastFlip!==-Tr?[n,n+2,n+3]:[n+2,n+1,n+3])),g.push(n+2,n+3,n+4),cp(jm,lp),h.copy(this.normal,jm),A.push(this.normal[0],this.normal[1],0),x.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*Tr,s[2]|0),m+=3):(this.extrusions(x,A,s,$t,Ut,this.totalDistance),g.push.apply(g,Pt()(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),Tr=-1,h.copy(this.normal,$t),m+=2),this.lastFlip=Tr}else{if(cp(this.normal,iu),M){var Xe=h.create(),nt=h.create();h.sub(nt,iu,this.normal),h.add(Xe,iu,this.normal),A.push(nt[0],nt[1],0),A.push(Xe[0],Xe[1],0),x.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0),x.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0)}else this.extrusions(x,A,s,this.normal,this.thickness,this.totalDistance);g.push.apply(g,Pt()(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),m+=2}return m}},{key:"extrusions",value:function(t,n,i,s,c,m){n.push(s[0],s[1],0),n.push(s[0],s[1],0),t.push(i[0],i[1],i[2]|0,m,-c,i[2]|0),t.push(i[0],i[1],i[2]|0,m,c,i[2]|0)}},{key:"lineSegmentDistance",value:function(t,n){var i=n[0]-t[0],s=n[1]-t[1];return Math.sqrt(i*i+s*s)}}]),e}();function qp(e){if(Da()(e[0]))return e;if(Da()(e[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Da()(e[0][0][0])){var r=e,t=0,n=0,i=0;return r.forEach(function(s){s.forEach(function(c){t+=c[0],n+=c[1],i++})}),[t/i,n/i,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function KT(e){for(var r=e[0],t=e[1],n=e[0],i=e[1],s=0,c=0,m=0,g=0;g<e.length;g+=2){var x=e[g],A=e[g+1];x&&A&&(r=Math.max(x,r),t=Math.max(A,t),n=Math.min(x,n),i=Math.min(A,i),s+=x,c+=A,m++)}return{center:[s/m,c/m],radius:Math.sqrt(Math.pow(r-n,2)+Math.pow(t-i,2))/2}}function $T(e){var r=e[0][0],t=e[0][e[0].length-1];r[0]===t[0]&&r[1]===t[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var n=e[0].length,i=Jf.a.flatten(e),s=i.vertices,c=i.dimensions,m=[],g=[],x=0;x<s.length/c;x++)c===2?m.push(s[x*2],s[x*2+1],1):m.push(s[x*3],s[x*3+1],1);var A=Jf()(i.vertices,i.holes,i.dimensions);g.push.apply(g,Pt()(A));for(var M=function(Y){var ie=i.vertices.slice(Y*c,(Y+1)*c),le=i.vertices.slice((Y+1)*c,(Y+2)*c);le.length===0&&(le=i.vertices.slice(0,c));var Ae=m.length/3;m.push(ie[0],ie[1],1,le[0],le[1],1,ie[0],ie[1],0,le[0],le[1],0),g.push.apply(g,Pt()([0,2,1,2,3,1].map(function(Xe){return Xe+Ae})))},R=0;R<n;R++)M(R);return{positions:m,index:g}}function qT(e){var r=Jf.a.flatten(e),t=Jf()(r.vertices,r.holes,r.dimensions);return{positions:r.vertices,index:t}}function cx(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=e[0][0],n=e[0][e[0].length-1];t[0]===n[0]&&t[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var i=e[0].length,s=Jf.a.flatten(e),c=s.vertices,m=s.dimensions,g=[],x=[],A=[],M=0;M<c.length/m;M++)m===2?g.push(c[M*2],c[M*2+1],1,-1,-1):g.push(c[M*3],c[M*3+1],1,-1,-1),A.push(0,0,1);var R=Jf()(s.vertices,s.holes,s.dimensions);x.push.apply(x,Pt()(R));for(var F=function(le){var Ae=s.vertices.slice(le*m,(le+1)*m),Xe=s.vertices.slice((le+1)*m,(le+2)*m);Xe.length===0&&(Xe=s.vertices.slice(0,m));var nt=g.length/5;g.push(Ae[0],Ae[1],1,0,0,Xe[0],Xe[1],1,.1,0,Ae[0],Ae[1],0,0,.8,Xe[0],Xe[1],0,.1,.8);var at=QT([Xe[0],Xe[1],1],[Ae[0],Ae[1],0],[Ae[0],Ae[1],1],r);A.push.apply(A,Pt()(at).concat(Pt()(at),Pt()(at),Pt()(at))),x.push.apply(x,Pt()([1,2,0,3,2,1].map(function(It){return It+nt})))},Y=0;Y<i;Y++)F(Y);return{positions:g,index:x,normals:A}}function QT(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=z.create(),s=z.create(),c=z.create();n&&(e=So(e),r=So(r),t=So(t));var m=z.fromValues.apply(z,Pt()(e)),g=z.fromValues.apply(z,Pt()(r)),x=z.fromValues.apply(z,Pt()(t));z.sub(i,x,g),z.sub(s,m,g),z.cross(c,i,s);var A=z.create();return z.normalize(A,c),A}var Rc,Qp;(function(e){e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn"})(Qp||(Qp={}));var Jp;(function(e){e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon"})(Jp||(Jp={}));function Xv(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=Math.PI*2/e,n=[],i=0;i<e;i++)n.push(t*i+r*Math.PI/12);var s=n.map(function(c){var m=Math.sin(c+Math.PI/4),g=Math.cos(c+Math.PI/4);return[m,g,0]});return s}function fx(){return Xv(30)}function hx(){return Xv(4)}function px(){return Xv(3)}function dx(){return Xv(6,1)}function vx(){return Xv(5)}var Hd=(Rc={},S()(Rc,Jp.CIRCLE,fx),S()(Rc,Jp.HEXAGON,dx),S()(Rc,Jp.TRIANGLE,px),S()(Rc,Jp.SQUARE,hx),S()(Rc,Jp.PENTAGON,vx),S()(Rc,Qp.CYLINDER,fx),S()(Rc,Qp.HEXAGONCOLUMN,dx),S()(Rc,Qp.TRIANGLECOLUMN,px),S()(Rc,Qp.SQUARECOLUMN,hx),S()(Rc,Qp.PENTAGONCOLUMN,vx),Rc),Vm={};function mx(e){var r=qp(e.coordinates);return{vertices:[].concat(Pt()(r),Pt()(r),Pt()(r),Pt()(r)),indices:[0,1,2,2,3,0],size:r.length}}function JT(e){var r=qp(e.coordinates),t=sx(r);return{vertices:[].concat(Pt()(t),Pt()(t),Pt()(t),Pt()(t)),indices:[0,1,2,2,3,0],size:t.length}}function gx(e){var r=e.shape,t=aM(r,!1),n=t.positions,i=t.index,s=t.normals;return{vertices:n,indices:i,normals:s,size:5}}function yx(e){var r=qp(e.coordinates);return{vertices:Pt()(r),indices:[0],size:r.length}}function _x(e){var r=e.coordinates,t=e.originCoordinates,n=e.version,i=new lx({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var s=r;Array.isArray(s[0][0])||(s=[r]);var c=t;Array.isArray(c[0][0])||(c=[t]);for(var m=0;m<s.length;m++){var g=s[m],x=c[m];i.extrude_gaode2(g,x)}}else{var A=r;Array.isArray(A[0][0])||(A=[r]),A.forEach(function(R){i.extrude(R)})}var M=i.complex;return{vertices:M.positions,indices:M.indices,normals:M.normals,size:6}}function eM(e){var r=e.coordinates,t=e.originCoordinates,n=e.version,i=new lx({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var s=r;Array.isArray(s[0][0])||(s=[r]);var c=t;Array.isArray(c[0][0])||(c=[t]);for(var m=0;m<s.length;m++){var g=s[m],x=c[m];i.simpleExtrude_gaode2(g,x)}}else{var A=r;Array.isArray(A[0][0])||(A=[r]),A.forEach(function(R){i.simpleExtrude(R)})}var M=i.complex;return{vertices:M.positions,indices:M.indices,normals:M.normals,size:6}}function tM(e){var r=e.coordinates,t=Jf.a.flatten(r),n=t.vertices,i=t.dimensions,s=t.holes;return{indices:Jf()(n,s,i),vertices:n,size:i}}function rM(e){var r=e.coordinates,t=Jf.a.flatten(r),n=t.vertices,i=t.dimensions,s=t.holes;return{indices:Jf()(n,s,i),vertices:nM(n),size:i+4}}function nM(e){for(var r=[],t=KT(e),n=t.center,i=t.radius,s=0;s<e.length;s+=2){var c=e[s],m=e[s+1];r.push.apply(r,[c,m,0].concat(Pt()(n),[i]))}return r}function xx(e){var r=e.coordinates,t=cx(r,!0),n=t.positions,i=t.index,s=t.normals;return{vertices:n,indices:i,normals:s,size:5}}function bx(e){var r=e.shape,t=sM(r),n=t.positions,i=t.index;return{vertices:n,indices:i,size:3}}function Ex(e){var r=e.coordinates,t=[].concat(Pt()(r[0]),[0,0,1,r[1][0],r[0][1],0,1,1],Pt()(r[1]),[0,1,0],Pt()(r[0]),[0,0,1],Pt()(r[1]),[0,1,0,r[0][0],r[1][1],0,0,0]),n=[0,1,2,3,4,5];return{vertices:t,indices:n,size:5}}function Gm(e,r){for(var t=r||30,n=e.coordinates,i=[],s=[],c=function(x){i.push(x,1,x,n[0][0],n[0][1],n[1][0],n[1][1],x,-1,x,n[0][0],n[0][1],n[1][0],n[1][1]),x!==t-1&&s.push.apply(s,Pt()([0,1,2,1,3,2].map(function(A){return x*2+A})))},m=0;m<t;m++)c(m);return{vertices:i,indices:s,size:7}}function iM(e){var r=e.coordinates;r.length===2&&r.push(0);var t=e.size,n=Hm(-1,1),i=Hm(1,1),s=Hm(-1,-1),c=Hm(1,-1),m=[].concat(Pt()(r),Pt()(n),Pt()(r),Pt()(s),Pt()(r),Pt()(c),Pt()(r),Pt()(i)),g=[0,1,2,3,0,2];return{vertices:m,indices:g,size:5}}function aM(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Vm&&Vm[e])return Vm[e];var t=Hd[e]?Hd[e]():Hd.cylinder(),n=cx([t],r);return Vm[e]=n,n}function sF(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=new Float32Array(e.length/t*3),s,c,m,g=z.create(),x=z.create(),A=z.create(),M=0,R=r.length;M<R;M+=3){s=r[M+0]*3,c=r[M+1]*3,m=r[M+2]*3;var F=[e[s],e[s+1]],Y=[e[c],e[c+1]],ie=[e[m],e[m+1]];n&&(F=So(F),Y=So(Y),ie=So(ie));var le=F,Ae=ri()(le,2),Xe=Ae[0],nt=Ae[1],at=z.fromValues(Xe,nt,e[s+2]),It=Y,Ot=ri()(It,2),Ut=Ot[0],$t=Ot[1],Tr=z.fromValues(Ut,$t,e[c+2]),Dr=ie,Sr=ri()(Dr,2),Sn=Sr[0],Dn=Sr[1],ai=z.fromValues(Sn,Dn,e[m+2]);z.sub(g,ai,Tr),z.sub(x,at,Tr),z.cross(A,g,x),i[s]+=g[0],i[s+1]+=g[1],i[s+2]+=g[2],i[c]+=g[0],i[c+1]+=g[1],i[c+2]+=g[2],i[m]+=g[0],i[m+1]+=g[1],i[m+2]+=g[2]}return oM(i),i}function oM(e){for(var r=0,t=e.length;r<t;r+=3){var n=z.fromValues(e[r],e[r+1],e[r+2]),i=z.create();z.normalize(i,n),e.set(i,r)}}function uF(e){var r=e[0][0],t=e[0][e[0].length-1];return r[0]===t[0]&&r[1]===t[1]}function sM(e){var r=["cylinder","triangleColumn","hexagonColumn","squareColumn"],t=Hd[e]?Hd[e]():Hd.circle(),n=r.indexOf(e)===-1?qT([t]):$T([t]);return n}function Hm(e,r){var t=(e+1)/2,n=(r+1)/2;return[t,n]}function lF(){var e=ux(Um,{segments:ax}),r=e.positionsArr,t=e.indicesArr,n=e.normalArr;return{vertices:r,indices:t,size:5,normals:n}}function cF(){var e=ux(Um+YT,{segments:ax}),r=e.positionsArr,t=e.indicesArr,n=e.normalArr;return{vertices:r,indices:t,size:5,normals:n}}function uM(e){var r=lM();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function lM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var cM=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

uniform float u_circleSweep;
uniform float u_cityMinSize;
uniform vec3 u_circleSweepColor;
uniform float u_circleSweepSpeed;

varying float v_worldDis;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }


  if(u_circleSweep > 0.0 && v_worldDis < u_cityMinSize) {
    float r = fract(((v_worldDis/u_cityMinSize) - u_time * u_circleSweepSpeed) * 2.0);
    gl_FragColor.rgb += r * r * u_circleSweepColor;
  }
   
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,fM=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;
uniform mat4 u_Mvp;

uniform float u_circleSweep;
uniform vec2 u_cityCenter;

varying float v_worldDis;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"


void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

   v_texCoord = a_Uv;

  if(u_circleSweep > 0.0) {
     vec2 lnglatscale = vec2(0.0);
    if(u_CoordinateSystem != COORDINATE_SYSTEM_P20_2) {
      lnglatscale = (a_Position.xy - u_cityCenter) * vec2(0.0, 0.135);
    }
    v_worldDis = length(a_Position.xy + lnglatscale - u_cityCenter);
  }
 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,hM=function(e){Nr()(t,e);var r=uM(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"cityCenter",void 0),S()(oe()(n),"cityMinSize",void 0),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,m=i.baseColor,g=m===void 0?"rgb(16,16,16)":m,x=i.brightColor,A=x===void 0?"rgb(255,176,38)":x,M=i.windowColor,R=M===void 0?"rgb(30,60,89)":M,F=i.time,Y=F===void 0?0:F,ie=i.sweep,le=ie===void 0?{enable:!1,sweepRadius:1,sweepColor:"rgb(255, 255, 255)",sweepSpeed:.4,sweepCenter:this.cityCenter}:ie;return{u_cityCenter:le.sweepCenter||this.cityCenter,u_cityMinSize:this.cityMinSize*le.sweepRadius,u_circleSweep:le.enable?1:0,u_circleSweepColor:xr(le.sweepColor).slice(0,3),u_circleSweepSpeed:le.sweepSpeed,u_opacity:c,u_baseColor:xr(g),u_brightColor:xr(A),u_windowColor:xr(R),u_time:this.layer.getLayerAnimateTime()||Y}}},{key:"calCityGeo",value:function(){var i=ri()(this.layer.getSource().extent,4),s=i[0],c=i[1],m=i[2],g=i[3];if(this.mapService.version==="GAODE2.x"){this.cityCenter=this.mapService.lngLatToCoord([(m+s)/2,(g+c)/2]);var x=this.mapService.lngLatToCoord([m,g]),A=this.mapService.lngLatToCoord([s,c]);this.cityMinSize=Math.sqrt(Math.pow(x[0]-A[0],2)+Math.pow(x[1]-A[1],2))/4}else{var M=m-s,R=g-c;this.cityCenter=[(m+s)/2,(g+c)/2],this.cityMinSize=Math.sqrt(Math.pow(M,2)+Math.pow(R,2))/4}}},{key:"initModels",value:function(){return this.calCityGeo(),this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:fM,fragmentShader:cM,triangulation:xx})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:mi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(s,c,m,g,x){return x}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(s,c,m,g){var x=s.size,A=x===void 0?10:x;return Array.isArray(A)?[A[0]]:[A]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(s,c,m,g){var x=s.size;return[m[3],m[4]]}}})}}]),t}(As);function pM(e){var r=dM();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function dM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vM=function(e){Nr()(t,e);var r=pM(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"type","PolygonLayer"),n}return Bt()(t,[{key:"buildModels",value:function(){this.layerModel=new hM(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(i){this.updateLayerConfig({time:i})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),t}($p);function mM(e){var r=gM();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function gM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var yM=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
uniform mat4 u_Mvp;\r
varying vec4 v_color;\r
\r
uniform vec2 u_SceneCenterMKT;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  // vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  // gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\r
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807\r
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));\r
    gl_Position = u_Mvp * (project_pos);\r
  } else {\r
     vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
    gl_Position = project_common_position_to_clipspace(project_pos);\r
  }\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,_M=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,xM=function(e){Nr()(t,e);var r=mM(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.coverage,m=i.angle;return{u_opacity:s||1,u_coverage:c||.9,u_angle:m||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m;return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:yM,fragmentShader:_M,triangulation:bx,depth:{enable:!1},primitive:ce.TRIANGLES,blend:this.getBlend(),stencil:hi(c,g)})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:mi.Attribute,descriptor:{name:"a_Pos",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(s,c){var m=s.version==="GAODE2.x"?s.originCoordinates:s.coordinates;return[m[0],m[1],0]}}})}}]),t}(As);function bM(e){var r=EM();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function EM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var SM=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_SceneCenterMKT;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"


void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  // vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6
  // vec2 lnglat = (a_Pos.xy + offset); 
  // vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  // gl_Position = project_common_position_to_clipspace(project_pos);
  // float lightWeight = calc_lighting(project_pos);
  // v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // vec2 lnglat = (a_Pos.xy + offset); 
    // vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));

    // float lightWeight = calc_lighting(project_pos);
    // v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
  
    // gl_Position = u_Mvp * vec4(lnglat , a_Position.z * a_Size, 1.0);
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u7ECF\u7EAC\u5EA6
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807
    vec4 project_pos = project_position(vec4(customLnglat, a_Position.z * a_Size, 1.0));

    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
  
    gl_Position = u_Mvp * vec4(customLnglat , a_Position.z * a_Size, 1.0);
  } else {
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6
    vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
    
    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
    
    gl_Position = project_common_position_to_clipspace(project_pos);
  }



  setPickingColor(a_PickingColor);
}
`,CM=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,AM=function(e){Nr()(t,e);var r=bM(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.coverage,m=i.angle;return{u_opacity:s||1,u_coverage:c||1,u_angle:m||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m;return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:SM,fragmentShader:CM,triangulation:gx,depth:{enable:!0},blend:this.getBlend(),stencil:hi(c,g)})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(s,c,m,g){var x=s.size;return Array.isArray(x)?[x[0]]:[x]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(s,c,m,g,x){return x}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:mi.Attribute,descriptor:{name:"a_Pos",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(s,c){var m=s.version==="GAODE2.x"?s.originCoordinates:s.coordinates;return[m[0],m[1],0]}}})}}]),t}(As);function wM(e,r){for(var t=[],n=[],i=[],s=e+1,c=r+1,m=e/2,g=r/2,x=0;x<c;x++)for(var A=x-g,M=0;M<s;M++){var R=M-m;n.push(R/m,-A/g,0),i.push(M/e),i.push(1-x/r)}for(var F=0;F<r;F++)for(var Y=0;Y<e;Y++){var ie=Y+s*F,le=Y+s*(F+1),Ae=Y+1+s*(F+1),Xe=Y+1+s*F;t.push(ie,le,Xe),t.push(le,Ae,Xe)}return{vertices:n,indices:t,uvs:i}}var Sx,Cx;function Ax(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Tx(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Ax(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ax(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function TM(e){var r=MM();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function MM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var PM=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;
}
`,OM=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;


vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos = a_Uv * vec2(2.0) - vec2(1.0); // \u5C06\u539F\u672C 0 -> 1 \u7684 uv \u8F6C\u6362\u4E3A -1 -> 1 \u7684\u6807\u51C6\u5750\u6807\u7A7A\u95F4\uFF08NDC\uFF09

  vec4 p1 = vec4(pos, 0.0, 1.0); // x/y \u5E73\u9762\u4E0A\u7684\u70B9\uFF08z == 0\uFF09\u53EF\u4EE5\u8BA4\u4E3A\u662F\u4E09\u7EF4\u4E0A\u7684\u70B9\u88AB\u6295\u5F71\u5230\u5E73\u9762\u540E\u7684\u70B9
	vec4 p2 = vec4(pos, 1.0, 1.0); // \u5E73\u884C\u4E8Ex/y\u5E73\u9762\u3001z==1 \u7684\u5E73\u9762\u4E0A\u7684\u70B9

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1; // \u6839\u636E\u89C6\u56FE\u6295\u5F71\u77E9\u9635\u7684\u9006\u77E9\u9635\u5E73\u9762\u4E0A\u7684\u53CD\u7B97\u51FA\u4E09\u7EF4\u7A7A\u95F4\u4E2D\u7684\u70B9\uFF08p1\u5E73\u9762\u4E0A\u7684\u70B9\uFF09
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w; // \u5F52\u4E00\u5316\u64CD\u4F5C\uFF08\u5F52\u4E00\u5316\u540E\u4E3A\u4E16\u754C\u5750\u6807\uFF09
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z); // ??
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0.0, 1.0, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);
 
}
`,IM=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,RM=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,kM=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 2.5;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
        gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
    } else {
        gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
    }
}
`,LM=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,Mx=(Sx=Object(Cr.injectable)(),Sx(Cx=function(e){Nr()(t,e);var r=TM(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"texture",void 0),S()(oe()(n),"colorTexture",void 0),S()(oe()(n),"heatmapFramerBuffer",void 0),S()(oe()(n),"intensityModel",void 0),S()(oe()(n),"colorModel",void 0),S()(oe()(n),"shapeType",void 0),n}return Bt()(t,[{key:"render",value:function(){var i=this,s=this.rendererService,c=s.clear,m=s.useFramebuffer;m(this.heatmapFramerBuffer,function(){c({color:[0,0,0,0],depth:1,stencil:0,framebuffer:i.heatmapFramerBuffer}),i.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var i,s=this.rendererService,c=s.createFramebuffer,m=s.clear,g=s.getViewportSize,x=s.createTexture2D,A=s.useFramebuffer,M=this.styleAttributeService.getLayerStyleAttribute("shape"),R=(M==null||(i=M.scale)===null||i===void 0?void 0:i.field)||"heatmap";this.shapeType=R,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=R==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var F=g(),Y=F.width,ie=F.height;return this.heatmapFramerBuffer=c({color:x({width:Math.floor(Y/4),height:Math.floor(ie/4),wrapS:ce.CLAMP_TO_EDGE,wrapT:ce.CLAMP_TO_EDGE,min:ce.LINEAR,mag:ce.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:mi.Attribute,descriptor:{name:"a_Dir",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(s,c,m,g){return[m[3],m[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(s,c,m,g){var x=s.size,A=x===void 0?1:x;return[A]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:kM,fragmentShader:RM,triangulation:iM,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:ce.ONE,srcAlpha:1,dstRGB:ce.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m;this.shaderModuleService.registerModule("heatmapColor",{vs:LM,fs:IM});var x=this.shaderModuleService.getModule("heatmapColor"),A=x.vs,M=x.fs,R=x.uniforms,F=this.rendererService,Y=F.createAttribute,ie=F.createElements,le=F.createBuffer,Ae=F.createModel;return Ae({vs:A,fs:M,attributes:{a_Position:Y({buffer:le({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:ce.FLOAT}),size:3}),a_Uv:Y({buffer:le({data:[0,1,1,1,0,0,1,0],type:ce.FLOAT}),size:2})},uniforms:Tx({},R),depth:{enable:!1},blend:this.getBlend(),count:6,elements:ie({data:[0,2,1,2,3,1],type:ce.UNSIGNED_INT,count:6}),stencil:hi(c,g)})}},{key:"drawIntensityMode",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.intensity,m=c===void 0?10:c,g=i.radius,x=g===void 0?5:g;this.intensityModel.draw({uniforms:{u_opacity:s||1,u_radius:x,u_intensity:m}})}},{key:"drawColorMode",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity;this.colorModel.draw({uniforms:{u_opacity:s||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=B.create();B.invert(c,this.cameraService.getViewProjectionMatrixUncentered()),this.colorModel.draw({uniforms:{u_opacity:s||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:Pt()(c)}})}},{key:"build3dHeatMap",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m,x=this.rendererService.getViewportSize,A=x(),M=A.width,R=A.height,F=wM(M/4,R/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:OM,fs:PM});var Y=this.shaderModuleService.getModule("heatmap3dColor"),ie=Y.vs,le=Y.fs,Ae=Y.uniforms,Xe=this.rendererService,nt=Xe.createAttribute,at=Xe.createElements,It=Xe.createBuffer,Ot=Xe.createModel;return Ot({vs:ie,fs:le,attributes:{a_Position:nt({buffer:It({data:F.vertices,type:ce.FLOAT}),size:3}),a_Uv:nt({buffer:It({data:F.uvs,type:ce.FLOAT}),size:2})},primitive:ce.TRIANGLES,uniforms:Tx({},Ae),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:ce.SRC_ALPHA,srcAlpha:1,dstRGB:ce.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:at({data:F.indices,type:ce.UNSIGNED_INT,count:F.indices.length}),stencil:hi(c,g)})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var i=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var s=this.layer.getLayerConfig(),c=s.rampColors,m=Un(c);this.colorTexture=i({data:new Uint8Array(m.data),width:m.width,height:m.height,wrapS:ce.CLAMP_TO_EDGE,wrapT:ce.CLAMP_TO_EDGE,min:ce.NEAREST,mag:ce.NEAREST,flipY:!1})}}]),t}(As))||Cx);function DM(e){var r=FM();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function FM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var BM=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,NM=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_SceneCenterMKT;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
 
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xy, 0., 1.0));
    // gl_Position = u_Mvp * (vec4(a_Pos.xy + offset, 0., 1.0));
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT;
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));
    gl_Position = u_Mvp * vec4(project_pos.xy, 0.0, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,zM=function(e){Nr()(t,e);var r=DM(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.coverage,m=i.angle;return{u_opacity:s||1,u_coverage:c||.9,u_angle:m||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m;return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:NM,fragmentShader:BM,triangulation:bx,depth:{enable:!1},primitive:ce.TRIANGLES,blend:this.getBlend(),stencil:hi(c,g)})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:mi.Attribute,descriptor:{name:"a_Pos",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(s,c){var m=s.version==="GAODE2.x"?s.originCoordinates:s.coordinates;return[m[0],m[1],0]}}})}}]),t}(As),UM={heatmap:Mx,heatmap3d:Mx,grid:xM,grid3d:AM,hexagon:zM},jM=UM;function VM(e){var r=GM();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function GM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var HM=function(e){Nr()(t,e);var r=VM(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"type","HeatMapLayer"),n}return Bt()(t,[{key:"buildModels",value:function(){var i=this.getModelType();this.layerModel=new jM[i](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var i=this,s=this.getModelType();return s==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(c){return c.draw({uniforms:i.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var i,s=this.styleAttributeService.getLayerStyleAttribute("shape"),c=this.getLayerConfig(),m=c.shape3d,g=this.getSource(),x=g.data.type,A=(s==null||(i=s.scale)===null||i===void 0?void 0:i.field)||"heatmap";return A==="heatmap"||A==="heatmap3d"?"heatmap":x==="hexagon"?(m==null?void 0:m.indexOf(A))===-1?"hexagon":"grid3d":x==="grid"?(m==null?void 0:m.indexOf(A))===-1?"grid":"grid3d":"heatmap"}}]),t}($p);function WM(e){var r=ZM();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function ZM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var XM=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,YM=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,KM=function(e){Nr()(t,e);var r=WM(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"texture",void 0),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity;return{u_opacity:s||1,u_texture:this.texture}}},{key:"initModels",value:function(){var i=this,s=this.layer.getLayerConfig(),c=s.mask,m=c===void 0?!1:c,g=s.maskInside,x=g===void 0?!0:g,A=this.layer.getSource(),M=this.rendererService.createTexture2D;if(this.texture=M({height:0,width:0}),Pi){var R=this.layerService.sceneService.getSceneConfig().canvas,F=R.createImage();F.crossOrigin="anonymous",F.src=A.data.originData,F.onload=function(){i.texture=M({data:F,width:F.width,height:F.height}),i.layerService.updateLayerRenderList(),i.layerService.renderLayers()}}else A.data.images.then(function(Y){i.texture=M({data:Y[0],width:Y[0].width,height:Y[0].height}),i.layerService.updateLayerRenderList(),i.layerService.renderLayers()});return[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:YM,fragmentShader:XM,triangulation:Ex,primitive:ce.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:hi(m,x)})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:mi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(s,c,m,g){return[m[3],m[4]]}}})}}]),t}(As),$M={image:KM},qM=$M;function QM(e){var r=JM();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function JM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var eP=function(e){Nr()(t,e);var r=QM(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"type","ImageLayer"),n}return Bt()(t,[{key:"buildModels",value:function(){var i=this.getModelType();this.layerModel=new qM[i](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),s={image:{}};return s[i]}},{key:"getModelType",value:function(){return"image"}}]),t}($p);function tP(e){var r=rP();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function rP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var nP=`
uniform float u_opacity;

varying vec4 v_dash_array;
varying vec4 v_color;

uniform float segmentNumber;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;

  float flag = 0.;
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  }
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,iP=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  

   styleMappingMat[3].b = segmentIndex / segmentNumber;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,aP=`
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  
  gl_FragColor.a *= opacity;

  if(u_aimate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = styleMappingMat[3].g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_aimate.x == Animate) {
      time = u_time / u_aimate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = styleMappingMat[3].a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_aimate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_aimate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
  // gl_FragColor = filterColor(gl_FragColor);
}`,oP=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_aimate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
     styleMappingMat[3].g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
     styleMappingMat[3].a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,sP=`#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}`,uP=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,lP={solid:0,dash:1},cP=function(e){Nr()(t,e);var r=tP(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"texture",void 0),S()(oe()(n),"updateTexture",function(){var m=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=m({data:n.iconService.getCanvas(),mag:ce.NEAREST,min:ce.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,m=i.targetColor,g=i.textureBlend,x=g===void 0?"normal":g,A=i.lineType,M=A===void 0?"solid":A,R=i.dashArray,F=R===void 0?[10,5]:R,Y=i.forward,ie=Y===void 0?!0:Y,le=i.lineTexture,Ae=le===void 0?!1:le,Xe=i.iconStep,nt=Xe===void 0?100:Xe,at=i.segmentNumber,It=at===void 0?30:at,Ot=i.thetaOffset,Ut=Ot===void 0?.314:Ot;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s,thetaOffset:Ut})){this.judgeStyleAttributes({opacity:s,thetaOffset:Ut});var $t=this.layer.getEncodedData(),Tr=this.calDataFrame(this.cellLength,$t,this.cellProperties),Dr=Tr.data,Sr=Tr.width,Sn=Tr.height;this.rowCount=Sn,this.dataTexture=this.cellLength>0&&Dr.length>0?this.createTexture2D({flipY:!0,data:Dr,format:ce.LUMINANCE,type:ce.FLOAT,width:Sr,height:Sn}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}F.length===2&&F.push(0,0);var Dn=0,ai=[0,0,0,0],Ua=[0,0,0,0];return c&&m&&(ai=xr(c),Ua=xr(m),Dn=1),this.rendererService.getDirty()&&this.texture.bind(),{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_thetaOffset:Da()(Ut)?Ut:0,u_opacity:Da()(s)?s:1,u_textureBlend:x==="normal"?0:1,segmentNumber:It,u_line_type:lP[M||"solid"],u_dash_array:F,u_blur:.9,u_lineDir:ie?1:-1,u_texture:this.texture,u_line_texture:Ae?1:0,u_icon_step:nt,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Dn,u_sourceColor:ai,u_targetColor:Ua}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.dataTexture)===null||s===void 0||s.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),s=i.sourceColor,c=i.targetColor,m=i.lineType;return m==="dash"?{frag:nP,vert:iP,type:"dash"}:s&&c?{frag:sP,vert:uP,type:"linear"}:{frag:aP,vert:oP,type:"normal"}}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.segmentNumber,c=s===void 0?30:s,m=i.mask,g=m===void 0?!1:m,x=i.maskInside,A=x===void 0?!0:x,M=this.getShaders(),R=M.frag,F=M.vert,Y=M.type;return[this.layer.buildLayerModel({moduleName:"arc2dline"+Y,vertexShader:F,fragmentShader:R,triangulation:Gm,depth:{enable:!1},blend:this.getBlend(),segmentNumber:c,stencil:hi(g,A)})]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(c,m,g,x){var A=c.size,M=A===void 0?1:A;return Array.isArray(M)?[M[0]]:[M]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:4,update:function(c,m,g,x){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(c,m,g,x){var A=i.iconService.getIconMap(),M=c.texture,R=A[M]||{x:0,y:0},F=R.x,Y=R.y;return[F,Y]}}})}}]),t}(As);function fP(e){var r=hP();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function hP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var pP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);

      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_aimate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_aimate.x == Animate) {
      time = u_time / u_aimate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_aimate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_aimate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,dP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
// varying vec2 v_normal;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // TODO: + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // TODO: \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,vP=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;


uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);

      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_aimate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,mP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
// varying vec2 v_normal;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // TODO: + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // TODO: \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,gP={solid:0,dash:1},yP=function(e){Nr()(t,e);var r=fP(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"texture",void 0),S()(oe()(n),"updateTexture",function(){var m=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=m({data:n.iconService.getCanvas(),mag:ce.NEAREST,min:ce.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,m=i.targetColor,g=i.textureBlend,x=g===void 0?"normal":g,A=i.lineType,M=A===void 0?"solid":A,R=i.dashArray,F=R===void 0?[10,5]:R,Y=i.lineTexture,ie=Y===void 0?!1:Y,le=i.iconStep,Ae=le===void 0?100:le,Xe=i.segmentNumber,nt=Xe===void 0?30:Xe,at=i.globalArcHeight,It=at===void 0?10:at;F.length===2&&F.push(0,0);var Ot=0,Ut=[0,0,0,0],$t=[0,0,0,0];if(c&&m&&(Ut=xr(c),$t=xr(m),Ot=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var Tr=this.layer.getEncodedData(),Dr=this.calDataFrame(this.cellLength,Tr,this.cellProperties),Sr=Dr.data,Sn=Dr.width,Dn=Dr.height;this.rowCount=Dn,this.dataTexture=this.cellLength>0&&Sr.length>0?this.createTexture2D({flipY:!0,data:Sr,format:ce.LUMINANCE,type:ce.FLOAT,width:Sn,height:Dn}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}return{u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:Um,u_global_height:It,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Da()(s)?s:1,u_textureBlend:x==="normal"?0:1,segmentNumber:nt,u_line_type:gP[M]||0,u_dash_array:F,u_texture:this.texture,u_line_texture:ie?1:0,u_icon_step:Ae,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Ot,u_sourceColor:Ut,u_targetColor:$t}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.dataTexture)===null||s===void 0||s.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),s=i.sourceColor,c=i.targetColor,m=i.lineType;return s&&c?{frag:vP,vert:mP,type:"linear"}:{frag:pP,vert:dP,type:"normal"}}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.segmentNumber,c=s===void 0?30:s,m=i.mask,g=m===void 0?!1:m,x=i.maskInside,A=x===void 0?!0:x,M=this.getShaders(),R=M.frag,F=M.vert,Y=M.type;return[this.layer.buildLayerModel({moduleName:"arc3Dline"+Y,vertexShader:F,fragmentShader:R,triangulation:Gm,blend:this.getBlend(),segmentNumber:c,stencil:hi(g,A)})]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(c,m,g,x){var A=c.size,M=A===void 0?1:A;return Array.isArray(M)?[M[0]]:[M]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:4,update:function(c,m,g,x){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(c,m,g,x){var A=i.iconService.getIconMap(),M=c.texture,R=A[M]||{x:0,y:0},F=R.x,Y=R.y;return[F,Y]}}})}}]),t}(As);function _P(e){var r=xP();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function xP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var bP=`#define LineTypeSolid 0.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
// varying vec2 v_normal;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float segmentNumber;
varying float v_distance_ratio;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

void main() {

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v_distance_ratio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }
  
 
  gl_FragColor.a *= u_opacity;

  if(u_aimate.x == Animate) {
      float animateSpeed = u_time / u_aimate.y; // \u8FD0\u52A8\u901F\u5EA6
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }
}`,EP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
// varying vec2 v_normal;

uniform float u_lineDir: 1.0;

// \u504F\u79FB\u91CF
uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = u_thetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  v_distance_ratio = segmentIndex / segmentNumber;
  
  if(u_aimate.x == Animate && u_lineDir != 1.0) {
      v_distance_ratio = 1.0 - v_distance_ratio;
  }

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
}
`,SP=function(e){Nr()(t,e);var r=_P(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,m=i.targetColor,g=i.forward,x=g===void 0?!0:g,A=i.segmentNumber,M=A===void 0?30:A,R=i.thetaOffset,F=R===void 0?.314:R,Y=0,ie=[0,0,0,0],le=[0,0,0,0];return c&&m&&(ie=xr(c),le=xr(m),Y=1),{u_thetaOffset:F,u_opacity:Da()(s)?s:1,segmentNumber:M,u_blur:.9,u_lineDir:x?1:-1,u_linearColor:Y,u_sourceColor:ie,u_targetColor:le}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.segmentNumber,c=s===void 0?30:s;return[this.layer.buildLayerModel({moduleName:"arc2dminiline",vertexShader:EP,fragmentShader:bP,triangulation:Gm,depth:{enable:!1},blend:this.getBlend(),segmentNumber:c})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(s,c,m,g){var x=s.size,A=x===void 0?1:x;return Array.isArray(A)?[A[0]]:[A]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:4,update:function(s,c,m,g){return[m[3],m[4],m[5],m[6]]}}})}}]),t}(As);function CP(e){var r=AP();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function AP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var wP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0;
  float d_segmentIndex = styleMappingMat[3].g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- smoothstep(0.0, 1.0, v_distance_ratio), u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_aimate.x == Animate) {
      u = gl_FragColor.a/opacity;
    }

    float v = styleMappingMat[3].a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,TP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
// varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*8.0;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  styleMappingMat[3].g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
    styleMappingMat[3].b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  }
  setPickingColor(a_PickingColor);
}

`,MP={solid:0,dash:1},PP=function(e){Nr()(t,e);var r=CP(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"texture",void 0),S()(oe()(n),"updateTexture",function(){var m=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=m({data:n.iconService.getCanvas(),mag:ce.NEAREST,min:ce.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,m=i.targetColor,g=i.textureBlend,x=g===void 0?"normal":g,A=i.lineType,M=A===void 0?"solid":A,R=i.dashArray,F=R===void 0?[10,5]:R,Y=i.lineTexture,ie=Y===void 0?!1:Y,le=i.iconStep,Ae=le===void 0?100:le,Xe=i.segmentNumber,nt=Xe===void 0?30:Xe;F.length===2&&F.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var at=0,It=[0,0,0,0],Ot=[0,0,0,0];if(c&&m&&(It=xr(c),Ot=xr(m),at=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var Ut=this.layer.getEncodedData(),$t=this.calDataFrame(this.cellLength,Ut,this.cellProperties),Tr=$t.data,Dr=$t.width,Sr=$t.height;this.rowCount=Sr,this.dataTexture=this.cellLength>0&&Tr.length>0?this.createTexture2D({flipY:!0,data:Tr,format:ce.LUMINANCE,type:ce.FLOAT,width:Dr,height:Sr}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Da()(s)?s:1,u_textureBlend:x==="normal"?0:1,segmentNumber:nt,u_line_type:MP[M]||0,u_dash_array:F,u_texture:this.texture,u_line_texture:ie?1:0,u_icon_step:Ae,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:at,u_sourceColor:It,u_targetColor:Ot}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.dataTexture)===null||s===void 0||s.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m;return[this.layer.buildLayerModel({moduleName:"greatcircleline",vertexShader:TP,fragmentShader:wP,triangulation:Gm,depth:{enable:!1},blend:this.getBlend(),stencil:hi(c,g)})]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(c,m,g,x){var A=c.size,M=A===void 0?1:A;return Array.isArray(M)?[M[0]]:[M]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:4,update:function(c,m,g,x){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(c,m,g,x){var A=i.iconService.getIconMap(),M=c.texture,R=A[M]||{x:0,y:0},F=R.x,Y=R.y;return[F,Y]}}})}}]),t}(As);function OP(e){var r=IP();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function IP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var RP=`#define LineTypeSolid 0.0
uniform float u_opacity : 1.0;

varying vec4 v_color;

// dash
varying vec4 v_dash_array;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
 // dash line
 
  float flag = 0.;
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  }
  gl_FragColor.a *=flag;

  gl_FragColor = filterColor(gl_FragColor);
}
`,kP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = a_Distance / a_Total_Distance; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y), 1.0));
  } else {
    float lineHeight = a_Size.y;
 
    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,LP=`#define Animate 0.0
#define LineTexture 1.0
uniform float u_blur : 0.99;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;

uniform float u_borderWidth: 0.0;
uniform vec4 u_borderColor;
varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying vec2 v_iconMapUV;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + animateSpeed);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = styleMappingMat[3].g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = styleMappingMat[3].b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = styleMappingMat[3].a;
  float borderWidth = min(0.5, u_borderWidth);
  // \u7ED8\u5236 border
  if(borderWidth > 0.01) {
    float borderOuterWidth = borderWidth/2.0;

    if(v >= 1.0 - borderWidth || v <= borderWidth) {
      if(v > borderWidth) {
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, u_borderColor.rgb, linear);
      } else if(v <= borderWidth) {
        float linear = smoothstep(0.0, 1.0, v/borderWidth);
        gl_FragColor.rgb = mix(u_borderColor.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Px=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);

  vec2 offset = project_pixel(size.xy);

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = a_Distance / a_Total_Distance;; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  styleMappingMat[3][2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,DP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;

varying vec4 v_color;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"


varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,FP={solid:0,dash:1},Ox=function(e){Nr()(t,e);var r=OP(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"texture",void 0),S()(oe()(n),"updateTexture",function(){var m=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=m({data:n.iconService.getCanvas(),mag:ce.NEAREST,min:ce.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,m=i.targetColor,g=i.textureBlend,x=g===void 0?"normal":g,A=i.lineType,M=A===void 0?"solid":A,R=i.dashArray,F=R===void 0?[10,5,0,0]:R,Y=i.lineTexture,ie=Y===void 0?!1:Y,le=i.iconStep,Ae=le===void 0?100:le,Xe=i.vertexHeightScale,nt=Xe===void 0?20:Xe,at=i.borderWidth,It=at===void 0?0:at,Ot=i.borderColor,Ut=Ot===void 0?"#ccc":Ot;F.length===2&&F.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var $t=0,Tr=[0,0,0,0],Dr=[0,0,0,0];if(c&&m&&(Tr=xr(c),Dr=xr(m),$t=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var Sr=this.layer.getEncodedData(),Sn=this.calDataFrame(this.cellLength,Sr,this.cellProperties),Dn=Sn.data,ai=Sn.width,Ua=Sn.height;this.rowCount=Ua,this.dataTexture=this.cellLength>0&&Dn.length>0?this.createTexture2D({flipY:!0,data:Dn,format:ce.LUMINANCE,type:ce.FLOAT,width:ai,height:Ua}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Da()(s)?s:1,u_textureBlend:x==="normal"?0:1,u_line_type:FP[M],u_dash_array:F,u_texture:this.texture,u_line_texture:ie?1:0,u_icon_step:Ae,u_textSize:[1024,this.iconService.canvasHeight||128],u_borderWidth:It,u_borderColor:xr(Ut),u_linearColor:$t,u_sourceColor:Tr,u_targetColor:Dr,u_vertexScale:nt}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.dataTexture)===null||s===void 0||s.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m,x=this.getShaders(),A=x.frag,M=x.vert,R=x.type;return[this.layer.buildLayerModel({moduleName:"line"+R,vertexShader:M,fragmentShader:A,triangulation:_x,primitive:ce.TRIANGLES,blend:this.getBlend(),depth:{enable:!1},stencil:hi(c,g)})]}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),s=i.sourceColor,c=i.targetColor,m=i.lineType;return m==="dash"?{frag:RP,vert:kP,type:"dash"}:s&&c?{frag:DP,vert:Px,type:"linear"}:{frag:LP,vert:Px,type:"normal"}}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:mi.Attribute,descriptor:{name:"a_Distance",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(c,m,g,x){return[g[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:mi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(c,m,g,x){return[g[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(c,m,g,x){var A=c.size,M=A===void 0?1:A;return Array.isArray(M)?[M[0],M[1]]:[M,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(c,m,g,x,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:mi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(c,m,g,x){return[g[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(c,m,g,x){var A=i.iconService.getIconMap(),M=c.texture,R=A[M]||{x:0,y:0},F=R.x,Y=R.y;return[F,Y]}}})}}]),t}(As);function BP(e){var r=NP();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function NP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var zP=`

uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,UP=`
varying vec4 v_color;
varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,Ix=`
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;


// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_vertexScale: 1.0;

#pragma include "projection"

varying vec4 v_color;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_color = a_Color;  

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
  }
}
`,jP=function(e){Nr()(t,e);var r=BP(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,m=i.targetColor,g=i.vertexHeightScale,x=g===void 0?20:g,A=0,M=[0,0,0,0],R=[0,0,0,0];if(c&&m&&(M=xr(c),R=xr(m),A=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var F=this.layer.getEncodedData(),Y=this.calDataFrame(this.cellLength,F,this.cellProperties),ie=Y.data,le=Y.width,Ae=Y.height;this.rowCount=Ae,this.dataTexture=this.cellLength>0&&ie.length>0?this.createTexture2D({flipY:!0,data:ie,format:ce.LUMINANCE,type:ce.FLOAT,width:le,height:Ae}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Da()(s)?s:1,u_linearColor:A,u_sourceColor:M,u_targetColor:R,u_vertexScale:x}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),s=i.sourceColor,c=i.targetColor;return s&&c?{frag:zP,vert:Ix,type:"linear"}:{frag:UP,vert:Ix,type:"normal"}}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m,x=this.getShaders(),A=x.frag,M=x.vert,R=x.type;return[this.layer.buildLayerModel({moduleName:"simpleline"+R,vertexShader:M,fragmentShader:A,triangulation:eM,primitive:ce.LINES,blend:this.getBlend(),depth:{enable:!1},stencil:hi(c,g)})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:mi.Attribute,descriptor:{name:"a_Distance",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(s,c,m,g){return[m[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:mi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(s,c,m,g){return[m[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(s,c,m,g){var x=s.size,A=x===void 0?1:x;return Array.isArray(A)?[A[0],A[1]]:[A,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(s,c,m,g,x){return x}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:mi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(s,c,m,g){return[m[4]]}}})}}]),t}(As);function VP(e){var r=GP();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function GP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var HP=`#define LineTypeSolid 0.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;

varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;

varying vec2 v_iconMapUV;
varying float v_blur;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = styleMappingMat[3].a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + animateSpeed);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = styleMappingMat[3].g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = styleMappingMat[3].b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);

    
  
  
}
`,WP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

varying vec4 v_color;
varying float v_blur;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "light"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_aimate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  styleMappingMat[3][2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  styleMappingMat[3][3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);

  // v_lightWeight = lightWeight;
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);
  // v_color = a_Color;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,ZP=function(e){Nr()(t,e);var r=VP(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"texture",void 0),S()(oe()(n),"updateTexture",function(){var m=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=m({data:n.iconService.getCanvas(),mag:ce.NEAREST,min:ce.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,m=i.targetColor,g=i.textureBlend,x=g===void 0?"normal":g,A=i.heightfixed,M=A===void 0?!1:A,R=i.lineTexture,F=R===void 0?!1:R,Y=i.iconStep,ie=Y===void 0?100:Y,le=i.iconStepCount,Ae=le===void 0?1:le;this.rendererService.getDirty()&&this.texture.bind();var Xe=0,nt=[0,0,0,0],at=[0,0,0,0];if(c&&m&&(nt=xr(c),at=xr(m),Xe=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var It=this.layer.getEncodedData(),Ot=this.calDataFrame(this.cellLength,It,this.cellProperties),Ut=Ot.data,$t=Ot.width,Tr=Ot.height;this.rowCount=Tr,this.dataTexture=this.cellLength>0&&Ut.length>0?this.createTexture2D({flipY:!0,data:Ut,format:ce.LUMINANCE,type:ce.FLOAT,width:$t,height:Tr}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}return{u_heightfixed:Number(M),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Da()(s)?s:1,u_textureBlend:x==="normal"?0:1,u_texture:this.texture,u_line_texture:F?1:0,u_iconStepCount:Ae,u_icon_step:ie,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Xe,u_sourceColor:nt,u_targetColor:at}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.dataTexture)===null||s===void 0||s.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"linewall",vertexShader:WP,fragmentShader:HP,triangulation:_x,primitive:ce.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var i=this,s=this.layer.getLayerConfig(),c=s.lineType,m=c===void 0?"solid":c;this.styleAttributeService.registerStyleAttribute({name:"distance",type:mi.Attribute,descriptor:{name:"a_Distance",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(x,A,M,R){return[M[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:mi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(x,A,M,R){return[M[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(x,A,M,R){var F=x.size,Y=F===void 0?1:F;return Array.isArray(Y)?[Y[0],Y[1]]:[Y,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(x,A,M,R,F){return F}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:mi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(x,A,M,R){return[M[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(x,A,M,R){var F=i.iconService.getIconMap(),Y=x.texture,ie=F[Y]||{x:0,y:0},le=ie.x,Ae=ie.y;return[le,Ae]}}})}}]),t}(As),XP={arc:cP,arcmini:SP,arc3d:yP,greatcircle:PP,wall:ZP,line:Ox,simple:jP},YP=XP;function KP(e){var r=$P();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function $P(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var qP=function(e){Nr()(t,e);var r=KP(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"type","LineLayer"),n}return Bt()(t,[{key:"buildModels",value:function(){var i=this.getModelType();this.layerModel=new YP[i](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),s={line:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},arcmini:{blend:"additive"},greatcircle:{blend:"additive"}};return s[i]}},{key:"getModelType",value:function(){var i,s=this.styleAttributeService.getLayerStyleAttribute("shape"),c=s==null||(i=s.scale)===null||i===void 0?void 0:i.field;return c||"line"}}]),t}($p);function QP(e){var r=JP();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function JP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var eO=`varying vec4 v_color;
uniform float u_opacity: 1.0;

varying float v_z;
varying float v_lightWeight;
uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v_z);
    gl_FragColor.rgb *= v_lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_z): v_z;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorWithLight(gl_FragColor, v_lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,tO=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

varying float v_z;
varying float v_lightWeight;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_z = a_Position.z;

 

  // vec2 offset = project_pixel(size.xy);
  // vec2 offset = (size.xy);

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    offset = project_pixel(offset);
  }

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z) * u_r, 1.0);
  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  // float lightWeight = u_lightEnable > 0.0 ? calc_lighting(pos): 1.0;
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  // gl_Position = project_common_position_to_clipspace(pos);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * pos;
  } else {
    gl_Position = project_common_position_to_clipspace(pos);
  }
  
  if(u_globel > 0.0) {
    // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
    //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
    float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
    float xRadian = getXRadian(a_Pos.y, r);
    float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
    float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
    mat4 mx = mat4(
      1,0,0,0,  
      0,xcos,-xsin,0,  
      0,xsin,xcos,0,  
      0,0,0,1);

    //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
    float yRadian = getYRadian(a_Pos.x, a_Pos.z);
    float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
    float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
    mat4 my = mat4(
      ycos,0,-ysin,0,  
      0,1,0,0,  
      ysin,0,ycos,0,  
      0,0,0,1);

    gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  }

  setPickingColor(a_PickingColor);
}
`,Rx=function(e){Nr()(t,e);var r=QP(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"raiseCount",0),S()(oe()(n),"raiserepeat",0),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption,c=s===void 0?{enable:!1,speed:.01,repeat:!1}:s,m=i.opacity,g=m===void 0?1:m,x=i.sourceColor,A=i.targetColor,M=i.pickLight,R=M===void 0?!1:M,F=i.heightfixed,Y=F===void 0?!1:F,ie=i.opacityLinear,le=ie===void 0?{enable:!1,dir:"up"}:ie,Ae=i.lightEnable,Xe=Ae===void 0?!0:Ae;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:g})){this.judgeStyleAttributes({opacity:g});var nt=this.layer.getEncodedData(),at=this.calDataFrame(this.cellLength,nt,this.cellProperties),It=at.data,Ot=at.width,Ut=at.height;this.rowCount=Ut,this.dataTexture=this.cellLength>0&&It.length>0?this.createTexture2D({flipY:!0,data:It,format:ce.LUMINANCE,type:ce.FLOAT,width:Ot,height:Ut}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}var $t=0,Tr=[0,0,0,0],Dr=[0,0,0,0];if(x&&A&&(Tr=xr(x),Dr=xr(A),$t=1),this.raiseCount<1&&this.raiserepeat>0&&c.enable){var Sr=c.speed,Sn=Sr===void 0?.01:Sr,Dn=c.repeat,ai=Dn===void 0?!1:Dn;this.raiseCount+=Sn,this.raiseCount>=1&&(this.raiserepeat>1?(this.raiseCount=0,this.raiserepeat--):this.raiseCount=1)}return{u_pickLight:Number(R),u_heightfixed:Number(Y),u_r:c.enable&&this.raiserepeat>0?this.raiseCount:1,u_globel:this.mapService.version==="GLOBEL"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Da()(g)?g:1,u_linearColor:$t,u_sourceColor:Tr,u_targetColor:Dr,u_opacitylinear:Number(le.enable),u_opacitylinear_dir:le.dir==="up"?1:0,u_lightEnable:Number(Xe)}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.depth,c=s===void 0?!0:s,m=i.animateOption.repeat,g=m===void 0?1:m;return this.raiserepeat=g,[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:tO,fragmentShader:eO,triangulation:gx,blend:this.getBlend(),cull:{enable:!0,face:this.mapService.version==="MAPBOX"?ce.FRONT:ce.BACK},depth:{enable:c}})]}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.mapService.version==="GLOBEL";this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(c,m,g,x){var A=c.size;if(A){var M=[];return Array.isArray(A)&&(M=A.length===2?[A[0],A[0],A[1]]:A),Array.isArray(A)||(M=[A,A,A]),M}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(c,m,g,x,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:mi.Attribute,descriptor:{name:"a_Pos",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(c,m){var g=qp(c.coordinates);return i?sx([g[0],g[1]]):[g[0],g[1],0]}}})}}]),t}(As),eh;(function(e){e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.L7MAP="L7MAP",e.GLOBEL="GLOBEL"})(eh||(eh={}));function rO(e){var r=nO();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function nO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var kx=`
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"


void main() {

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  float r = v_radius / (v_radius + strokeWidth);

  // 'circle'
  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);
 
  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float PI = 3.14159;
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);

  // TODO: \u6839\u636E\u53E0\u52A0\u6C34\u6CE2\u6548\u679C
  gl_FragColor = vec4(v_color.xyz, v_color.a * opacity * intensity);

  // TODO: \u4F18\u5316\u5728\u6C34\u6CE2\u7EB9\u60C5\u51B5\u4E0B\u7684\u62FE\u53D6
  if(d < 0.5) {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,iO=`
uniform float u_globel;
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(u_globel > 0.0) {
    // TODO: \u5730\u7403\u6A21\u5F0F\u4E0B\u907F\u514D\u591A\u4F59\u7247\u5143\u7ED8\u5236\uFF0C\u540C\u65F6\u4E5F\u80FD\u907F\u514D\u6709\u7528\u7247\u5143\u5728\u900F\u660E\u4E14\u91CD\u53E0\u7684\u60C5\u51B5\u4E0B\u65E0\u6CD5\u5199\u5165
    // \u4ED8\u51FA\u7684\u4EE3\u4EF7\u662F\u8FB9\u7F18\u4F1A\u6709\u4E00\u4E9B\u952F\u9F7F
    if(outer_df > antialiasblur + 0.018) discard;
  }
  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,pg=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_globel;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_isMeter;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  float newSize = setPickingSize(a_Size);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // TODO: billboard
  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, u_blur);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    antialiasblur *= pow(19.0 - u_Zoom, 2.0);
    antialiasblur = max(antialiasblur, -0.01);
    // offset *= 0.5;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }

  if(u_globel > 0.0) {
    gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,Lx=function(e){Nr()(t,e);var r=rO(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"meter2coord",1),S()(oe()(n),"isMeter",!1),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,m=i.strokeOpacity,g=m===void 0?1:m,x=i.strokeWidth,A=x===void 0?0:x,M=i.stroke,R=M===void 0?"rgba(0,0,0,0)":M,F=i.offsets,Y=F===void 0?[0,0]:F,ie=i.blend;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:c,strokeOpacity:g,strokeWidth:A,stroke:R,offsets:Y})){this.judgeStyleAttributes({opacity:c,strokeOpacity:g,strokeWidth:A,stroke:R,offsets:Y});var le=this.layer.getEncodedData(),Ae=this.calDataFrame(this.cellLength,le,this.cellProperties),Xe=Ae.data,nt=Ae.width,at=Ae.height;this.rowCount=at,this.dataTexture=this.cellLength>0&&Xe.length>0?this.createTexture2D({flipY:!0,data:Xe,format:ce.LUMINANCE,type:ce.FLOAT,width:nt,height:at}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}return{u_isMeter:Number(this.isMeter),u_additive:ie==="additive"?1:0,u_globel:this.mapService.version===eh.GLOBEL?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Da()(c)?c:1,u_stroke_opacity:Da()(g)?g:1,u_stroke_width:Da()(A)?A:0,u_stroke_color:this.getStrokeColor(R),u_offsets:this.isOffsetStatic(Y)?Y:[0,0]}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption,c=s===void 0?{enable:!1}:s;return{u_aimate:this.animateOption2Array(c),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),mx)}},{key:"initModels",value:function(){var i=this.layer.getLayerConfig(),s=i.unit,c=s===void 0?"l7size":s,m=this.mapService.version;return c==="meter"&&m!==eh.L7MAP&&m!==eh.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),this.buildModels()}},{key:"calMeter2Coord",value:function(){var i=ri()(this.layer.getSource().extent,4),s=i[0],c=i[1],m=i[2],g=i[3],x=[(s+m)/2,(c+g)/2],A=this.mapService.version;if(A===eh.MAPBOX&&window.mapboxgl.MercatorCoordinate){var M=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:x[0],lat:x[1]},0),R=1,F=R*M.meterInMercatorCoordinateUnits(),Y=new window.mapboxgl.MercatorCoordinate(M.x-F,M.y,M.z),ie=Y.toLngLat();this.meter2coord=x[0]-ie.lng;return}var le=this.mapService.meterToCoord(x,[s,c]),Ae=this.mapService.meterToCoord(x,[m===s?m+.1:m,g===c?c+.1:g]);this.meter2coord=(le+Ae)/2,Boolean(this.meter2coord)||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m,x=i.animateOption,A=x===void 0?{enable:!1}:x,M=this.getShaders(A),R=M.frag,F=M.vert,Y=M.type,ie=this.mapService.version==="GLOBEL";return[this.layer.buildLayerModel({moduleName:"pointfill-"+Y,vertexShader:F,fragmentShader:R,triangulation:ie?JT:mx,depth:{enable:ie},blend:this.getBlend(),stencil:hi(c,g)})]}},{key:"getShaders",value:function(i){if(i.enable)switch(i.type){case"wave":return{frag:kx,vert:pg,type:"wave"};default:return{frag:kx,vert:pg,type:"wave"}}else return{frag:iO,vert:pg,type:"normal"}}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var i=this,s=this.mapService.version==="GLOBEL";this.styleAttributeService.registerStyleAttribute({name:"extrude",type:mi.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(m,g,x,A){var M;if(s){var R=ri()(x,3),F=R[0],Y=R[1],ie=R[2],le=z.fromValues(0,0,1),Ae=z.fromValues(F,0,ie),Xe=F>=0?z.angle(le,Ae):Math.PI*2-z.angle(le,Ae),nt=Math.PI*2-Math.asin(Y/100),at=B.create();B.rotateY(at,at,Xe),B.rotateX(at,at,nt);var It=z.fromValues(1,1,0);z.transformMat4(It,It,at),z.normalize(It,It);var Ot=z.fromValues(-1,1,0);z.transformMat4(Ot,Ot,at),z.normalize(Ot,Ot);var Ut=z.fromValues(-1,-1,0);z.transformMat4(Ut,Ut,at),z.normalize(Ut,Ut);var $t=z.fromValues(1,-1,0);z.transformMat4($t,$t,at),z.normalize($t,$t),M=[].concat(Pt()(It),Pt()(Ot),Pt()(Ut),Pt()($t))}else M=[1,1,0,-1,1,0,-1,-1,0,1,-1,0];var Tr=A%4*3;return[M[Tr],M[Tr+1],M[Tr+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(m,g,x,A){var M=m.size,R=M===void 0?5:M;return Array.isArray(R)?[R[0]*i.meter2coord]:[R*i.meter2coord]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:mi.Attribute,descriptor:{name:"a_Shape",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(m,g,x,A){var M=m.shape,R=M===void 0?2:M,F=i.layer.getLayerConfig().shape2d,Y=F.indexOf(R);return[Y]}}})}}]),t}(As);function aO(e){var r=oO();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function oO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var sO=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main(){
      float opacity = styleMappingMat[0][0];
      float size = styleMappingMat[1][0];
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,uO=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;

uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  styleMappingMat[1][0] = a_Size;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  //  vec2 offset = project_pixel(u_offsets);
  vec2 offset = project_pixel(textrueOffsets);

  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
    }
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,lO=function(e){Nr()(t,e);var r=aO(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"texture",void 0),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity;return{u_opacity:s||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var i=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){i.updateTexture(),i.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:uO,fragmentShader:sO,triangulation:yx,primitive:ce.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(c,m,g,x){var A=c.size;return Array.isArray(A)?[A[0]]:[A]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(c,m,g,x){var A=i.fontService.mapping,M=c.shape,R=i.fontService.getGlyph(M),F=A[R],Y=F.x,ie=F.y;return[Y,ie]}}})}},{key:"updateTexture",value:function(){var i=this.rendererService.createTexture2D,s=this.fontService.canvas;this.texture=i({data:s,mag:ce.LINEAR,min:ce.LINEAR,width:s.width,height:s.height})}},{key:"initIconFontGlyphs",value:function(){var i=this,s=this.layer.getLayerConfig(),c=s.fontWeight,m=c===void 0?"normal":c,g=s.fontFamily,x=g===void 0?"sans-serif":g,A=this.layer.getEncodedData(),M=[];A.forEach(function(R){var F=R.shape,Y=F===void 0?"":F;Y=Y.toString();var ie=i.fontService.getGlyph(Y);M.indexOf(ie)===-1&&M.push(ie)}),this.fontService.setFontOptions({characterSet:M,fontWeight:m,fontFamily:x,fontSize:48})}}]),t}(As);function cO(e){var r=fO();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function fO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var hO=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main(){
      float opacity = styleMappingMat[0][0];
      float size = styleMappingMat[1][0];
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,pO=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;

uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  styleMappingMat[1][0] = a_Size;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  //  vec2 offset = project_pixel(u_offsets);
  vec2 offset = project_pixel(textrueOffsets);

  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
    }
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Dx=function(e){Nr()(t,e);var r=cO(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"texture",void 0),S()(oe()(n),"updateTexture",function(){var m=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),n.layer.renderLayers();return}n.texture=m({data:n.iconService.getCanvas(),mag:ce.LINEAR,min:ce.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128,mipmap:!0})}),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.offsets,m=c===void 0?[0,0]:c;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s,offsets:m})){this.judgeStyleAttributes({opacity:s,offsets:m});var g=this.layer.getEncodedData(),x=this.calDataFrame(this.cellLength,g,this.cellProperties),A=x.data,M=x.width,R=x.height;this.rowCount=R,this.dataTexture=this.cellLength>0&&A.length>0?this.createTexture2D({flipY:!0,data:A,format:ce.LUMINANCE,type:ce.FLOAT,width:M,height:R}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:Da()(s)?s:1,u_offsets:this.isOffsetStatic(m)?m:[0,0]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.dataTexture)===null||s===void 0||s.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m;return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:pO,fragmentShader:hO,triangulation:yx,primitive:ce.POINTS,depth:{enable:!1},blend:this.getBlend(),stencil:hi(c,g)})]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(c,m,g,x){var A=c.size,M=A===void 0?5:A;return Array.isArray(M)?[M[0]]:[M]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(c,m,g,x){var A=i.iconService.getIconMap(),M=c.shape,R=A[M]||{x:0,y:0},F=R.x,Y=R.y;return[F,Y]}}})}}]),t}(As);function dO(e){var r=vO();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function vO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var mO=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
void main() {
  float opacity = styleMappingMat[0][0];

  gl_FragColor = v_color;
  // gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor.a =gl_FragColor.a * opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,gO=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping
  
  // vec2 offset = project_pixel(u_offsets);
  vec2 offset = project_pixel(textrueOffsets);
  // vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  // gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\\
  // 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // vec2 offset = project_pixel((u_offsets));
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    // vec2 offset = project_pixel(u_offsets);
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function yO(e){var r=e.coordinates;return{vertices:Pt()(r),indices:[0],size:r.length}}var Fx=function(e){Nr()(t,e);var r=dO(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,m=i.offsets,g=m===void 0?[0,0]:m;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:c,offsets:g})){this.judgeStyleAttributes({opacity:c,offsets:g});var x=this.layer.getEncodedData(),A=this.calDataFrame(this.cellLength,x,this.cellProperties),M=A.data,R=A.width,F=A.height;this.rowCount=F,this.dataTexture=this.cellLength>0&&M.length>0?this.createTexture2D({flipY:!0,data:M,format:ce.LUMINANCE,type:ce.FLOAT,width:R,height:F}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Da()(c)?c:1,u_offsets:this.isOffsetStatic(g)?g:[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m;return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:gO,fragmentShader:mO,triangulation:yO,depth:{enable:!1},primitive:ce.POINTS,blend:this.getBlend(),stencil:hi(c,g)})]}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(s,c,m,g){var x=s.size,A=x===void 0?1:x;return Array.isArray(A)?[A[0]]:[A]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:Oc.additive}}}]),t}(As);function _O(e){var r=xO();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function xO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var bO=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_additive;

uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  float opacity = styleMappingMat[0][0];
  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);

  

  
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,EO=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143
varying float v_blur;
varying float v_innerRadius;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = a_Color;
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping
  
  // vec2 offset = project_pixel(u_offsets);
  vec2 offset = project_pixel(textrueOffsets);
  // vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  // gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\\
  // 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // vec2 offset = project_pixel((u_offsets));
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    // vec2 offset = project_pixel(u_offsets);
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function SO(e){var r=e.coordinates;return{vertices:Pt()(r),indices:[0],size:r.length}}var CO=function(e){Nr()(t,e);var r=_O(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,m=i.offsets,g=m===void 0?[0,0]:m,x=i.blend,A=i.strokeOpacity,M=A===void 0?1:A,R=i.strokeWidth,F=R===void 0?0:R,Y=i.stroke,ie=Y===void 0?"#fff":Y;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:c,offsets:g})){this.judgeStyleAttributes({opacity:c,offsets:g});var le=this.layer.getEncodedData(),Ae=this.calDataFrame(this.cellLength,le,this.cellProperties),Xe=Ae.data,nt=Ae.width,at=Ae.height;this.rowCount=at,this.dataTexture=this.cellLength>0&&Xe.length>0?this.createTexture2D({flipY:!0,data:Xe,format:ce.LUMINANCE,type:ce.FLOAT,width:nt,height:at}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}return{u_additive:x==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Da()(c)?c:1,u_offsets:this.isOffsetStatic(g)?g:[0,0],u_stroke_opacity:Da()(M)?M:1,u_stroke_width:Da()(F)?F:0,u_stroke_color:this.getStrokeColor(ie)}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m;return[this.layer.buildLayerModel({moduleName:"simplepoint",vertexShader:EO,fragmentShader:bO,triangulation:SO,depth:{enable:!1},primitive:ce.POINTS,blend:this.getBlend(),stencil:hi(c,g)})]}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(s,c,m,g){var x=s.size,A=x===void 0?1:x;return Array.isArray(A)?[A[0]]:[A]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:Oc.additive}}}]),t}(As);function AO(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=wO(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function wO(e,r){if(!!e){if(typeof e=="string")return Bx(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Bx(e,r)}}function Bx(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var TO=function(){function e(r,t,n){Ct()(this,e),S()(this,"boxCells",[]),S()(this,"xCellCount",void 0),S()(this,"yCellCount",void 0),S()(this,"boxKeys",void 0),S()(this,"bboxes",void 0),S()(this,"width",void 0),S()(this,"height",void 0),S()(this,"xScale",void 0),S()(this,"yScale",void 0),S()(this,"boxUid",void 0);var i=this.boxCells;this.xCellCount=Math.ceil(r/n),this.yCellCount=Math.ceil(t/n);for(var s=0;s<this.xCellCount*this.yCellCount;s++)i.push([]);this.boxKeys=[],this.bboxes=[],this.width=r,this.height=t,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/t,this.boxUid=0}return Bt()(e,[{key:"insert",value:function(t,n,i,s,c){this.forEachCell(n,i,s,c,this.insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(c)}},{key:"query",value:function(t,n,i,s,c){return this.queryHitTest(t,n,i,s,!1,c)}},{key:"hitTest",value:function(t,n,i,s,c){return this.queryHitTest(t,n,i,s,!0,c)}},{key:"insertBoxCell",value:function(t,n,i,s,c,m){this.boxCells[c].push(m)}},{key:"queryHitTest",value:function(t,n,i,s,c,m){if(i<0||t>this.width||s<0||n>this.height)return c?!1:[];var g=[];if(t<=0&&n<=0&&this.width<=i&&this.height<=s){if(c)return!0;for(var x=0;x<this.boxKeys.length;x++)g.push({key:this.boxKeys[x],x1:this.bboxes[x*4],y1:this.bboxes[x*4+1],x2:this.bboxes[x*4+2],y2:this.bboxes[x*4+3]});return m?g.filter(m):g}var A={hitTest:c,seenUids:{box:{},circle:{}}};return this.forEachCell(t,n,i,s,this.queryCell,g,A,m),c?g.length>0:g}},{key:"queryCell",value:function(t,n,i,s,c,m,g,x){var A=g.seenUids,M=this.boxCells[c];if(M!==null){var R=this.bboxes,F=AO(M),Y;try{for(F.s();!(Y=F.n()).done;){var ie=Y.value;if(!A.box[ie]){A.box[ie]=!0;var le=ie*4;if(t<=R[le+2]&&n<=R[le+3]&&i>=R[le+0]&&s>=R[le+1]&&(!x||x(this.boxKeys[ie]))){if(g.hitTest)return m.push(!0),!0;m.push({key:this.boxKeys[ie],x1:R[le],y1:R[le+1],x2:R[le+2],y2:R[le+3]})}}}}catch(Ae){F.e(Ae)}finally{F.f()}}return!1}},{key:"forEachCell",value:function(t,n,i,s,c,m,g,x){for(var A=this.convertToXCellCoord(t),M=this.convertToYCellCoord(n),R=this.convertToXCellCoord(i),F=this.convertToYCellCoord(s),Y=A;Y<=R;Y++)for(var ie=M;ie<=F;ie++){var le=this.xCellCount*ie+Y;if(c.call(this,t,n,i,s,le,m,g,x))return}}},{key:"convertToXCellCoord",value:function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}},{key:"convertToYCellCoord",value:function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}}]),e}(),MO=TO,PO=function(){function e(r,t){Ct()(this,e),S()(this,"width",void 0),S()(this,"height",void 0),S()(this,"grid",void 0),S()(this,"viewportPadding",100),S()(this,"screenRightBoundary",void 0),S()(this,"screenBottomBoundary",void 0),S()(this,"gridRightBoundary",void 0),S()(this,"gridBottomBoundary",void 0),this.width=r,this.height=t,this.viewportPadding=Math.max(r,t),this.grid=new MO(r+this.viewportPadding,t+this.viewportPadding,25),this.screenRightBoundary=r+this.viewportPadding,this.screenBottomBoundary=t+this.viewportPadding,this.gridRightBoundary=r+2*this.viewportPadding,this.gridBottomBoundary=t+2*this.viewportPadding}return Bt()(e,[{key:"placeCollisionBox",value:function(t){var n=t.x1+t.anchorPointX+this.viewportPadding,i=t.y1+t.anchorPointY+this.viewportPadding,s=t.x2+t.anchorPointX+this.viewportPadding,c=t.y2+t.anchorPointY+this.viewportPadding;return!this.isInsideGrid(n,i,s,c)||this.grid.hitTest(n,i,s,c)?{box:[]}:{box:[n,i,s,c]}}},{key:"insertCollisionBox",value:function(t,n){var i={featureIndex:n};this.grid.insert(i,t[0],t[1],t[2],t[3])}},{key:"project",value:function(t,n,i){var s=U.fromValues(n,i,0,1),c=U.create(),m=B.fromValues.apply(B,Pt()(t));return U.transformMat4(c,s,m),{x:(c[0]/c[3]+1)/2*this.width+this.viewportPadding,y:(-c[1]/c[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(t,n,i,s){return i>=0&&t<this.gridRightBoundary&&s>=0&&n<this.gridBottomBoundary}}]),e}();function Nx(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=OO(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function OO(e,r){if(!!e){if(typeof e=="string")return zx(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zx(e,r)}}function zx(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Ux(e){var r=.5,t=.5;switch(e){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0;break;default:r=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":t=1;break;case"top":case"top-right":case"top-left":t=0;break;default:t=.5}return{horizontalAlign:r,verticalAlign:t}}function jx(e,r,t,n,i){if(!!i){var s=e[n],c=s.glyph;if(c)for(var m=r[c].advance*s.scale,g=(e[n].x+m)*i,x=t;x<=n;x++)e[x].x-=g}}function Vx(e,r,t,n,i,s,c){var m=(r-t)*i,g=(-n*c+.5)*s,x=Nx(e),A;try{for(x.s();!(A=x.n()).done;){var M=A.value;M.x+=m,M.y+=g}}catch(R){x.e(R)}finally{x.f()}}function IO(e,r,t,n,i,s,c){var m=-8,g=0,x=m,A=0,M=e.positionedGlyphs,R=s==="right"?1:s==="left"?0:.5,F=M.length;t.forEach(function(Xe){if(Xe.split("").forEach(function(at){var It=r[at],Ot=0;It&&(M.push({glyph:at,x:g,y:x+Ot,vertical:!1,scale:1,metrics:It}),g+=It.advance+c)}),M.length!==F){var nt=g-c;A=Math.max(nt,A),jx(M,r,F,M.length-1,R)}g=0,x-=n+5});var Y=Ux(i),ie=Y.horizontalAlign,le=Y.verticalAlign;Vx(M,R,ie,le,A,n,t.length);var Ae=x-m;e.top+=-le*Ae,e.bottom=e.top-Ae,e.left+=-ie*A,e.right=e.left+A}function RO(e,r,t,n,i,s,c){var m=-8,g=0,x=m,A=0,M=e.positionedGlyphs,R=s==="right"?1:s==="left"?0:.5,F=M.length;t.forEach(function(Xe){var nt=r[Xe],at=0;if(nt&&(M.push({glyph:Xe,x:g,y:x+at,vertical:!1,scale:1,metrics:nt}),g+=nt.advance+c),M.length!==F){var It=g-c;A=Math.max(It,A),jx(M,r,F,M.length-1,R)}g=0,x-=n+5});var Y=Ux(i),ie=Y.horizontalAlign,le=Y.verticalAlign;Vx(M,R,ie,le,A,n,t.length);var Ae=x-m;e.top+=-le*Ae,e.bottom=e.top-Ae,e.left+=-ie*A,e.right=e.left+A}function kO(e,r,t,n,i,s){var c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],m=arguments.length>7?arguments[7]:void 0,g=e.split(`
`),x=[],A={positionedGlyphs:x,top:c[1],bottom:c[1],left:c[0],right:c[0],lineCount:g.length,text:e};return m?RO(A,r,g,t,n,i,s):IO(A,r,g,t,n,i,s),x.length?A:!1}function LO(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],t=arguments.length>2?arguments[2]:void 0,n=e.positionedGlyphs,i=n===void 0?[]:n,s=[],c=Nx(i),m;try{for(c.s();!(m=c.n()).done;){var g=m.value,x=g.metrics,A=4,M=x.advance*g.scale/2,R=t?[g.x+M,g.y]:[0,0],F=t?[0,0]:[g.x+M+r[0],g.y+r[1]],Y=(0-A)*g.scale-M+F[0],ie=(0-A)*g.scale+F[1],le=Y+x.width*g.scale,Ae=ie+x.height*g.scale,Xe={x:Y,y:ie},nt={x:le,y:ie},at={x:Y,y:Ae},It={x:le,y:Ae};s.push({tl:Xe,tr:nt,bl:at,br:It,tex:x,glyphOffset:R})}}catch(Ot){c.e(Ot)}finally{c.f()}return s}function DO(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=FO(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function FO(e,r){if(!!e){if(typeof e=="string")return Gx(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Gx(e,r)}}function Gx(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function BO(e){var r=NO();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function NO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Hx=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
void main() {
  // get style data mapping
  float opacity = styleMappingMat[0][0];
  float strokeWidth = styleMappingMat[0][2];
  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Wx=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Zx(e){var r=this,t=e.id,n=[],i=[];if(!r.glyphInfoMap||!r.glyphInfoMap[t])return{vertices:[],indices:[],size:7};var s=r.glyphInfoMap[t].centroid,c=s.length===2?[s[0],s[1],0]:s;return r.glyphInfoMap[t].glyphQuads.forEach(function(m,g){n.push.apply(n,Pt()(c).concat([m.tex.x,m.tex.y+m.tex.height,m.tl.x,m.tl.y],Pt()(c),[m.tex.x+m.tex.width,m.tex.y+m.tex.height,m.tr.x,m.tr.y],Pt()(c),[m.tex.x+m.tex.width,m.tex.y,m.br.x,m.br.y],Pt()(c),[m.tex.x,m.tex.y,m.bl.x,m.bl.y])),i.push(0+g*4,1+g*4,2+g*4,2+g*4,3+g*4,0+g*4)}),{vertices:n,indices:i,size:7}}var Xx=function(e){Nr()(t,e);var r=BO(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"glyphInfo",void 0),S()(oe()(n),"glyphInfoMap",{}),S()(oe()(n),"texture",void 0),S()(oe()(n),"currentZoom",-1),S()(oe()(n),"extent",void 0),S()(oe()(n),"textureHeight",0),S()(oe()(n),"textCount",0),S()(oe()(n),"preTextStyle",{}),S()(oe()(n),"buildModels",function(){var m=n.layer.getLayerConfig(),g=m.mask,x=g===void 0?!1:g,A=m.maskInside,M=A===void 0?!0:A;return n.initGlyph(),n.updateTexture(),n.filterGlyphs(),n.reBuildModel(),[n.layer.buildLayerModel({moduleName:"pointText",vertexShader:Wx,fragmentShader:Hx,triangulation:Zx.bind(oe()(n)),depth:{enable:!1},blend:n.getBlend(),stencil:hi(x,M)})]}),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,m=i.stroke,g=m===void 0?"#fff":m,x=i.strokeWidth,A=x===void 0?0:x,M=i.textAnchor,R=M===void 0?"center":M,F=i.textAllowOverlap,Y=F===void 0?!1:F,ie=i.halo,le=ie===void 0?.5:ie,Ae=i.gamma,Xe=Ae===void 0?2:Ae,nt=this.fontService,at=nt.canvas,It=nt.mapping;if(Object.keys(It).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(It).length),this.preTextStyle={textAnchor:R,textAllowOverlap:Y},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:c,strokeWidth:A,stroke:g})){this.judgeStyleAttributes({opacity:c,strokeWidth:A,stroke:g});var Ot=this.layer.getEncodedData(),Ut=this.calDataFrame(this.cellLength,Ot,this.cellProperties),$t=Ut.data,Tr=Ut.width,Dr=Ut.height;this.rowCount=Dr,this.dataTexture=this.cellLength>0&&$t.length>0?this.createTexture2D({flipY:!0,data:$t,format:ce.LUMINANCE,type:ce.FLOAT,width:Tr,height:Dr}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Da()(c)?c:1,u_stroke_width:Da()(A)?A:0,u_stroke_color:this.getStrokeColor(g),u_sdf_map:this.texture,u_halo_blur:le,u_gamma_scale:Xe,u_sdf_map_size:[at.width,at.height]}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var i=this.layer.getLayerConfig(),s=i.textAnchor,c=s===void 0?"center":s,m=i.textAllowOverlap,g=m===void 0?!0:m;return this.preTextStyle={textAnchor:c,textAllowOverlap:g},this.buildModels()}},{key:"needUpdate",value:function(){var i=this.layer.getLayerConfig(),s=i.textAllowOverlap,c=s===void 0?!1:s,m=this.mapService.getZoom(),g=this.mapService.getBounds(),x=$u(this.extent,g);return!c&&(Math.abs(this.currentZoom-m)>1||!x)||c!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy(),this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:mi.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(s,c,m,g){var x=s.rotate,A=x===void 0?0:x;return Array.isArray(A)?[A[0]]:[A]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:mi.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(s,c,m,g){return[m[5],m[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(s,c,m,g){var x=s.size,A=x===void 0?12:x;return Array.isArray(A)?[A[0]]:[A]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:mi.Attribute,descriptor:{name:"a_tex",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(s,c,m,g){return[m[3],m[4]]}}})}},{key:"textExtent",value:function(){var i=this.mapService.getBounds();return Ru(i,.5)}},{key:"initTextFont",value:function(){var i=this.layer.getLayerConfig(),s=i.fontWeight,c=s===void 0?"400":s,m=i.fontFamily,g=m===void 0?"sans-serif":m,x=this.layer.getEncodedData(),A=[];x.forEach(function(M){var R=M.shape,F=R===void 0?"":R;F=F.toString();var Y=DO(F),ie;try{for(Y.s();!(ie=Y.n()).done;){var le=ie.value;A.indexOf(le)===-1&&A.push(le)}}catch(Ae){Y.e(Ae)}finally{Y.f()}}),this.fontService.setFontOptions({characterSet:A,fontWeight:c,fontFamily:g,iconfont:!1})}},{key:"initIconFontTex",value:function(){var i=this.layer.getLayerConfig(),s=i.fontWeight,c=s===void 0?"400":s,m=i.fontFamily,g=m===void 0?"sans-serif":m,x=this.layer.getEncodedData(),A=[];x.forEach(function(M){var R=M.shape,F=R===void 0?"":R;F="".concat(F),A.indexOf(F)===-1&&A.push(F)}),this.fontService.setFontOptions({characterSet:A,fontWeight:c,fontFamily:g,iconfont:!0})}},{key:"generateGlyphLayout",value:function(i){var s=this,c=this.fontService.mapping,m=this.layer.getLayerConfig(),g=m.spacing,x=g===void 0?2:g,A=m.textAnchor,M=A===void 0?"center":A,R=this.layer.getEncodedData();this.glyphInfo=R.map(function(F){var Y=F.shape,ie=Y===void 0?"":Y,le=F.id,Ae=F.size,Xe=Ae===void 0?1:Ae,nt=F.textOffset,at=nt===void 0?[0,0]:nt,It=kO(ie.toString(),c,Xe,M,"left",x,at,i),Ot=LO(It,at,!1);return F.shaping=It,F.glyphQuads=Ot,F.centroid=qp(F.coordinates),F.originCentroid=F.version==="GAODE2.x"?qp(F.originCoordinates):F.originCentroid=F.centroid,s.glyphInfoMap[le]={shaping:It,glyphQuads:Ot,centroid:qp(F.coordinates)},F})}},{key:"filterGlyphs",value:function(){var i=this,s=this.layer.getLayerConfig(),c=s.padding,m=c===void 0?[4,4]:c,g=s.textAllowOverlap,x=g===void 0?!1:g;if(!x){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var A=this.rendererService.getViewportSize(),M=A.width,R=A.height,F=new PO(M,R),Y=this.glyphInfo.filter(function(ie){var le=ie.shaping,Ae=ie.id,Xe=Ae===void 0?0:Ae,nt=ie.version==="GAODE2.x"?ie.originCentroid:ie.centroid,at=ie.size,It=at/24,Ot=i.mapService.lngLatToContainer(nt),Ut=F.placeCollisionBox({x1:le.left*It-m[0],x2:le.right*It+m[0],y1:le.top*It-m[1],y2:le.bottom*It+m[1],anchorPointX:Ot.x,anchorPointY:Ot.y}),$t=Ut.box;return $t&&$t.length?(F.insertCollisionBox($t,Xe),!0):!1});Y.forEach(function(ie){i.glyphInfoMap[ie.id]=ie})}}},{key:"initGlyph",value:function(){var i=this.layer.getLayerConfig(),s=i.iconfont,c=s===void 0?!1:s;c?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(c)}},{key:"updateTexture",value:function(){var i=this.rendererService.createTexture2D,s=this.fontService.canvas;this.textureHeight=s.height,this.texture&&this.texture.destroy(),this.texture=i({data:s,mag:ce.LINEAR,min:ce.LINEAR,width:s.width,height:s.height})}},{key:"reBuildModel",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m;this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Wx,fragmentShader:Hx,triangulation:Zx.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:hi(c,g)})]}}]),t}(As),zO={fill:Lx,image:Dx,normal:Fx,simplePoint:CO,extrude:Rx,text:Xx,icon:lO},UO=zO;function jO(e){var r=VO();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function VO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var GO=function(e){Nr()(t,e);var r=jO(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"type","PointLayer"),n}return Bt()(t,[{key:"buildModels",value:function(){var i=this.getModelType();this.layerModel=new UO[i](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),s={normal:{blend:"additive"},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return s[i]}},{key:"getModelType",value:function(){var i=this.getEncodedData(),s=this.getLayerConfig(),c=s.shape2d,m=s.shape3d,g=this.iconService.getIconMap(),x=i.find(function(M){return M.hasOwnProperty("shape")});if(x){var A=x.shape;return A==="dot"?"normal":A==="simple"?"simplePoint":(c==null?void 0:c.indexOf(A))!==-1?"fill":(m==null?void 0:m.indexOf(A))!==-1?"extrude":g.hasOwnProperty(A)?"image":this.fontService.getGlyph(A)!==""?"icon":"text"}else return"normal"}}]),t}($p);function HO(e){var r=WO();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function WO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ZO=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  // gl_FragColor.a *= u_opacity;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,XO=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"
varying float v_lightWeight;

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  // gl_FragColor.a *= u_opacity;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorWithLight(gl_FragColor, v_lightWeight);
}
`,YO=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

varying float v_lightWeight;

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      project_pos.z *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  v_lightWeight = lightWeight;
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,KO=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      project_pos.z *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,$O=function(e){Nr()(t,e);var r=HO(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,m=i.heightfixed,g=m===void 0?!1:m;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:c})){this.judgeStyleAttributes({opacity:c});var x=this.layer.getEncodedData(),A=this.calDataFrame(this.cellLength,x,this.cellProperties),M=A.data,R=A.width,F=A.height;this.rowCount=F,this.dataTexture=this.cellLength>0&&M.length>0?this.createTexture2D({flipY:!0,data:M,format:ce.LUMINANCE,type:ce.FLOAT,width:R,height:F}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}return{u_heightfixed:Number(g),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Da()(c)?c:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.pickLight,c=s===void 0?!1:s,m=i.mask,g=m===void 0?!1:m,x=i.maskInside,A=x===void 0?!0:x;return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:c?YO:KO,fragmentShader:c?XO:ZO,triangulation:xx,stencil:hi(g,A)})]}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:mi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(s,c,m,g,x){return x}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(s,c,m,g){var x=s.size,A=x===void 0?10:x;return Array.isArray(A)?[A[0]]:[A]}}})}}]),t}(As);function qO(e){var r=QO();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function QO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var JO=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,e5=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;


void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,t5=`attribute vec4 a_Color;
attribute vec3 a_Position;



uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}`,r5=`attribute vec4 a_Color;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,n5=function(e){Nr()(t,e);var r=qO(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,m=i.opacityLinear,g=m===void 0?{enable:!1,dir:"in"}:m;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:c})){this.judgeStyleAttributes({opacity:c});var x=this.layer.getEncodedData(),A=this.calDataFrame(this.cellLength,x,this.cellProperties),M=A.data,R=A.width,F=A.height;this.rowCount=F,this.dataTexture=this.cellLength>0&&M.length>0?this.createTexture2D({flipY:!0,data:M,format:ce.LUMINANCE,type:ce.FLOAT,width:R,height:F}):this.createTexture2D({flipY:!0,data:[1],format:ce.LUMINANCE,type:ce.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Da()(c)?c:1,u_opacitylinear:Number(g.enable),u_dir:g.dir==="in"?1:0}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.opacityLinear,c=s===void 0?{enable:!1,dir:"in"}:s,m=i.mask,g=m===void 0?!1:m,x=i.maskInside,A=x===void 0?!0:x;return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:c.enable?t5:r5,fragmentShader:c.enable?e5:JO,triangulation:c.enable?rM:tM,blend:this.getBlend(),depth:{enable:!1},stencil:hi(g,A)})]}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getLayerConfig(),s=i.opacityLinear,c=s===void 0?{enable:!1,dir:"in"}:s;c.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:mi.Attribute,descriptor:{name:"a_linear",buffer:{usage:ce.STATIC_DRAW,data:[],type:ce.FLOAT},size:3,update:function(g,x,A,M,R){return[A[3],A[4],A[5]]}}})}}]),t}(As),i5={fill:n5,line:Ox,extrude:$O,text:Xx,point_fill:Lx,point_image:Dx,point_normal:Fx,point_extrude:Rx},a5=i5;function o5(e){var r=s5();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function s5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Yx=function(e){Nr()(t,e);var r=o5(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"type","PolygonLayer"),n}return Bt()(t,[{key:"buildModels",value:function(){var i=this.getModelType();this.layerModel=new a5[i](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var i,s=this.styleAttributeService.getLayerStyleAttribute("shape"),c=s==null||(i=s.scale)===null||i===void 0?void 0:i.field;return c==="fill"?"fill":c==="extrude"?"extrude":c==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var i=this.getEncodedData(),s=this.getLayerConfig(),c=s.shape2d,m=s.shape3d,g=this.iconService.getIconMap(),x=i.find(function(M){return M.hasOwnProperty("shape")});if(x){var A=x.shape;return A==="dot"?"point_normal":(c==null?void 0:c.indexOf(A))!==-1?"point_fill":(m==null?void 0:m.indexOf(A))!==-1?"point_extrude":g.hasOwnProperty(A)?"point_image":"text"}else return"fill"}}]),t}($p);function u5(e){var r=l5();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function l5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var c5=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,f5=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,Kx=function(e){Nr()(t,e);var r=u5(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"texture",void 0),S()(oe()(n),"colorTexture",void 0),n}return Bt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,m=i.clampLow,g=m===void 0?!0:m,x=i.clampHigh,A=x===void 0?!0:x,M=i.noDataValue,R=M===void 0?-9999999:M,F=i.domain,Y=F===void 0?[0,1]:F;return this.updateColorTexure(),{u_opacity:c||1,u_texture:this.texture,u_domain:Y,u_clampLow:g,u_clampHigh:typeof A!="undefined"?A:g,u_noDataValue:R,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,m=i.maskInside,g=m===void 0?!0:m,x=this.layer.getSource(),A=this.rendererService.createTexture2D,M=x.data.dataArray[0];this.texture=A({data:M.data,width:M.width,height:M.height,format:ce.LUMINANCE,type:ce.FLOAT});var R=this.layer.getLayerConfig(),F=R.rampColors,Y=Un(F);return this.colorTexture=A({data:Y.data,width:Y.width,height:Y.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:f5,fragmentShader:c5,triangulation:Ex,primitive:ce.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:hi(c,g)})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:mi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:2,update:function(s,c,m,g){return[m[3],m[4]]}}})}},{key:"updateColorTexure",value:function(){var i=this.rendererService.createTexture2D,s=this.layer.getLayerConfig(),c=s.rampColors,m=Un(c);this.colorTexture=i({data:m.data,width:m.width,height:m.height,flipY:!1})}}]),t}(As),h5={raster:Kx,raster3d:Kx},p5=h5;function d5(e){var r=v5();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function v5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var m5=function(e){Nr()(t,e);var r=d5(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"type","RasterLayer"),n}return Bt()(t,[{key:"buildModels",value:function(){var i=this.getModelType();this.layerModel=new p5[i](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),s={raster:{},raster3d:{}};return s[i]}},{key:"getModelType",value:function(){return"raster"}}]),t}($p),$x,qx,Qx,Jx,eb,Yv,tb,rb,nb;function ib(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function g5(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ib(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ib(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var y5=($x=Object(Cr.injectable)(),qx=Object(Cr.inject)(Kt.IGlobalConfigService),Qx=Object(Cr.inject)(Kt.IMapService),Jx=Object(Cr.inject)(Kt.IFontService),$x(eb=(Yv=function(){function e(){Ct()(this,e),Ei()(this,"configService",tb,this),Ei()(this,"mapService",rb,this),Ei()(this,"fontService",nb,this)}return Bt()(e,[{key:"apply",value:function(t,n){var i=this,s=n.styleAttributeService;t.hooks.init.tap("DataMappingPlugin",function(){i.generateMaping(t,{styleAttributeService:s})}),t.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return t.dataState.dataMappingNeedUpdate=!1,i.generateMaping(t,{styleAttributeService:s}),!0}),t.hooks.beforeRender.tap("DataMappingPlugin",function(){if(!t.layerModelNeedUpdate){var c=t.getBottomColor(),m=s.getLayerStyleAttributes()||[],g=s.getLayerStyleAttribute("filter"),x=t.getSource().data.dataArray,A=m.filter(function(R){return R.needRemapping}),M=x;g!=null&&g.needRemapping&&g!==null&&g!==void 0&&g.scale&&(M=x.filter(function(R){return i.applyAttributeMapping(g,R,c)[0]})),A.length&&(g!=null&&g.needRemapping?(t.setEncodedData(i.mapping(m,M,void 0,c)),g.needRemapping=!1):t.setEncodedData(i.mapping(A,M,t.getEncodedData(),c)),t.emit("remapping",null))}})}},{key:"generateMaping",value:function(t,n){var i=this,s=n.styleAttributeService,c=t.getBottomColor(),m=s.getLayerStyleAttributes()||[],g=s.getLayerStyleAttribute("filter"),x=t.getSource().data.dataArray,A=x;g!=null&&g.scale&&(A=x.filter(function(M){return i.applyAttributeMapping(g,M,c)[0]})),t.setEncodedData(this.mapping(m,A,void 0,c))}},{key:"mapping",value:function(t,n,i,s){var c=this,m=n.map(function(g,x){var A=i?i[x]:{},M=g5({id:g._id,coordinates:g.coordinates},A);return t.filter(function(R){return R.scale!==void 0}).forEach(function(R){var F=c.applyAttributeMapping(R,g,s);R.needRemapping=!1,R.name==="color"&&(F=F.map(function(Y){return xr(Y)})),M[R.name]=Array.isArray(F)&&F.length===1?F[0]:F,R.name==="shape"&&(M.shape=c.fontService.getIconFontKey(M[R.name]))}),M});return m.length>0&&this.mapService.version==="GAODE2.x"&&(typeof m[0].coordinates[0]=="number"?m.filter(function(g){return!g.originCoordinates}).map(function(g){g.version="GAODE2.x",g.originCoordinates=Es()(g.coordinates),g.coordinates=c.mapService.lngLatToCoord(g.coordinates)}):m.filter(function(g){return!g.originCoordinates}).map(function(g){g.version="GAODE2.x",g.originCoordinates=Es()(g.coordinates),g.coordinates=c.mapService.lngLatToCoords(g.coordinates)})),m}},{key:"applyAttributeMapping",value:function(t,n,i){var s;if(!t.scale)return[];var c=(t==null||(s=t.scale)===null||s===void 0?void 0:s.scalers)||[],m=[];c.forEach(function(x){var A,M=x.field;(n.hasOwnProperty(M)||((A=t.scale)===null||A===void 0?void 0:A.type)==="variable")&&m.push(n[M])});var g=t.mapping?t.mapping(m):[];return t.name==="color"&&!vr(g[0])?[i]:g}}]),e}(),tb=yi()(Yv.prototype,"configService",[qx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rb=yi()(Yv.prototype,"mapService",[Qx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nb=yi()(Yv.prototype,"fontService",[Jx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yv))||eb),ab,ob,_5=(ab=Object(Cr.injectable)(),ab(ob=function(){function e(){Ct()(this,e),S()(this,"mapService",void 0)}return Bt()(e,[{key:"apply",value:function(t){var n=this;this.mapService=t.getContainer().get(Kt.IMapService),t.hooks.init.tap("DataSourcePlugin",function(){var i=t.getSource();if(!i){var s=t.sourceOption||{data:Ep,options:hv},c=s.data,m=s.options;t.setSource(new Lf(c,m))}n.updateClusterData(t)}),t.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var i=n.updateClusterData(t),s=t.dataState.dataSourceNeedUpdate;return t.dataState.dataSourceNeedUpdate=!1,i||s})}},{key:"updateClusterData",value:function(t){var n=t.getSource(),i=n.cluster,s=n.clusterOptions,c=s.zoom,m=c===void 0?0:c,g=s.maxZoom,x=g===void 0?16:g,A=this.mapService.getZoom()-1,M=t.dataState.dataSourceNeedUpdate;return i&&(M||Math.abs(t.clusterZoom-A)>=1)?(m!==Math.floor(A)&&n.updateClusterData(Math.floor(A)),t.clusterZoom=A,!0):!1}}]),e}())||ob),Kv=function(e,r){return e<r?-1:e>r?1:e>=r?0:NaN},x5=function(e){return e.length===1&&(e=b5(e)),{left:function(t,n,i,s){for(i==null&&(i=0),s==null&&(s=t.length);i<s;){var c=i+s>>>1;e(t[c],n)<0?i=c+1:s=c}return i},right:function(t,n,i,s){for(i==null&&(i=0),s==null&&(s=t.length);i<s;){var c=i+s>>>1;e(t[c],n)>0?s=c:i=c+1}return i}}};function b5(e){return function(r,t){return Kv(e(r),t)}}var sb=x5(Kv),E5=sb.right,fF=sb.left,S5=E5,hF=function(e,r){r==null&&(r=ub);for(var t=0,n=e.length-1,i=e[0],s=new Array(n<0?0:n);t<n;)s[t]=r(i,i=e[++t]);return s};function ub(e,r){return[e,r]}var pF=function(e,r,t){var n=e.length,i=r.length,s=new Array(n*i),c,m,g,x;for(t==null&&(t=ub),c=g=0;c<n;++c)for(x=e[c],m=0;m<i;++m,++g)s[g]=t(x,r[m]);return s},dF=function(e,r){return r<e?-1:r>e?1:r>=e?0:NaN},fp=function(e){return e===null?NaN:+e},C5=function(e,r){var t=e.length,n=0,i=-1,s=0,c,m,g=0;if(r==null)for(;++i<t;)isNaN(c=fp(e[i]))||(m=c-s,s+=m/++n,g+=m*(c-s));else for(;++i<t;)isNaN(c=fp(r(e[i],i,e)))||(m=c-s,s+=m/++n,g+=m*(c-s));if(n>1)return g/(n-1)},A5=function(e,r){var t=C5(e,r);return t&&Math.sqrt(t)},lb=function(e,r){var t=e.length,n=-1,i,s,c;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(s=c=i;++n<t;)(i=e[n])!=null&&(s>i&&(s=i),c<i&&(c=i))}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(s=c=i;++n<t;)(i=r(e[n],n,e))!=null&&(s>i&&(s=i),c<i&&(c=i));return[s,c]},cb=Array.prototype,w5=cb.slice,T5=cb.map,Wm=function(e){return function(){return e}},M5=function(e){return e},P5=function(e,r,t){e=+e,r=+r,t=(i=arguments.length)<2?(r=e,e=0,1):i<3?1:+t;for(var n=-1,i=Math.max(0,Math.ceil((r-e)/t))|0,s=new Array(i);++n<i;)s[n]=e+n*t;return s},dg=Math.sqrt(50),vg=Math.sqrt(10),mg=Math.sqrt(2),vF=function(e,r,t){var n,i=-1,s,c,m;if(r=+r,e=+e,t=+t,e===r&&t>0)return[e];if((n=r<e)&&(s=e,e=r,r=s),(m=O5(e,r,t))===0||!isFinite(m))return[];if(m>0)for(e=Math.ceil(e/m),r=Math.floor(r/m),c=new Array(s=Math.ceil(r-e+1));++i<s;)c[i]=(e+i)*m;else for(e=Math.floor(e*m),r=Math.ceil(r*m),c=new Array(s=Math.ceil(e-r+1));++i<s;)c[i]=(e-i)/m;return n&&c.reverse(),c};function O5(e,r,t){var n=(r-e)/Math.max(0,t),i=Math.floor(Math.log(n)/Math.LN10),s=n/Math.pow(10,i);return i>=0?(s>=dg?10:s>=vg?5:s>=mg?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=dg?10:s>=vg?5:s>=mg?2:1)}function I5(e,r,t){var n=Math.abs(r-e)/Math.max(0,t),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),s=n/i;return s>=dg?i*=10:s>=vg?i*=5:s>=mg&&(i*=2),r<e?-i:i}var R5=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1},mF=function(){var e=M5,r=lb,t=R5;function n(i){var s,c=i.length,m,g=new Array(c);for(s=0;s<c;++s)g[s]=e(i[s],s,i);var x=r(g),A=x[0],M=x[1],R=t(g,A,M);Array.isArray(R)||(R=I5(A,M,R),R=P5(Math.ceil(A/R)*R,M,R));for(var F=R.length;R[0]<=A;)R.shift(),--F;for(;R[F-1]>M;)R.pop(),--F;var Y=new Array(F+1),ie;for(s=0;s<=F;++s)ie=Y[s]=[],ie.x0=s>0?R[s-1]:A,ie.x1=s<F?R[s]:M;for(s=0;s<c;++s)m=g[s],A<=m&&m<=M&&Y[S5(R,m,0,F)].push(i[s]);return Y}return n.value=function(i){return arguments.length?(e=typeof i=="function"?i:Wm(i),n):e},n.domain=function(i){return arguments.length?(r=typeof i=="function"?i:Wm([i[0],i[1]]),n):r},n.thresholds=function(i){return arguments.length?(t=typeof i=="function"?i:Array.isArray(i)?Wm(w5.call(i)):Wm(i),n):t},n},gg=function(e,r,t){if(t==null&&(t=fp),!!(n=e.length)){if((r=+r)<=0||n<2)return+t(e[0],0,e);if(r>=1)return+t(e[n-1],n-1,e);var n,i=(n-1)*r,s=Math.floor(i),c=+t(e[s],s,e),m=+t(e[s+1],s+1,e);return c+(m-c)*(i-s)}},gF=function(e,r,t){return e=T5.call(e,fp).sort(Kv),Math.ceil((t-r)/(2*(gg(e,.75)-gg(e,.25))*Math.pow(e.length,-1/3)))},yF=function(e,r,t){return Math.ceil((t-r)/(3.5*A5(e)*Math.pow(e.length,-1/3)))},_F=function(e,r){var t=e.length,n=-1,i,s;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(s=i;++n<t;)(i=e[n])!=null&&i>s&&(s=i)}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(s=i;++n<t;)(i=r(e[n],n,e))!=null&&i>s&&(s=i);return s},xF=function(e,r){var t=e.length,n=t,i=-1,s,c=0;if(r==null)for(;++i<t;)isNaN(s=fp(e[i]))?--n:c+=s;else for(;++i<t;)isNaN(s=fp(r(e[i],i,e)))?--n:c+=s;if(n)return c/n},bF=function(e,r){var t=e.length,n=-1,i,s=[];if(r==null)for(;++n<t;)isNaN(i=fp(e[n]))||s.push(i);else for(;++n<t;)isNaN(i=fp(r(e[n],n,e)))||s.push(i);return gg(s.sort(Kv),.5)},EF=function(e){for(var r=e.length,t,n=-1,i=0,s,c;++n<r;)i+=e[n].length;for(s=new Array(i);--r>=0;)for(c=e[r],t=c.length;--t>=0;)s[--i]=c[t];return s},k5=function(e,r){var t=e.length,n=-1,i,s;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(s=i;++n<t;)(i=e[n])!=null&&s>i&&(s=i)}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(s=i;++n<t;)(i=r(e[n],n,e))!=null&&s>i&&(s=i);return s},SF=function(e,r){for(var t=r.length,n=new Array(t);t--;)n[t]=e[r[t]];return n},CF=function(e,r){if(!!(t=e.length)){var t,n=0,i=0,s,c=e[i];for(r==null&&(r=Kv);++n<t;)(r(s=e[n],c)<0||r(c,c)!==0)&&(c=s,i=n);if(r(c,c)===0)return i}},AF=function(e,r,t){for(var n=(t==null?e.length:t)-(r=r==null?0:+r),i,s;n;)s=Math.random()*n--|0,i=e[n+r],e[n+r]=e[s+r],e[s+r]=i;return e},wF=function(e,r){var t=e.length,n=-1,i,s=0;if(r==null)for(;++n<t;)(i=+e[n])&&(s+=i);else for(;++n<t;)(i=+r(e[n],n,e))&&(s+=i);return s},L5=function(e){if(!(s=e.length))return[];for(var r=-1,t=k5(e,D5),n=new Array(t);++r<t;)for(var i=-1,s,c=n[r]=new Array(s);++i<s;)c[i]=e[i][r];return n};function D5(e){return e.length}var TF=function(){return L5(arguments)},ed=function(e,r){return e<r?-1:e>r?1:e>=r?0:NaN},fb=function(e){return e.length===1&&(e=F5(e)),{left:function(t,n,i,s){for(i==null&&(i=0),s==null&&(s=t.length);i<s;){var c=i+s>>>1;e(t[c],n)<0?i=c+1:s=c}return i},right:function(t,n,i,s){for(i==null&&(i=0),s==null&&(s=t.length);i<s;){var c=i+s>>>1;e(t[c],n)>0?s=c:i=c+1}return i}}};function F5(e){return function(r,t){return ed(e(r),t)}}var hb=fb(ed),B5=hb.right,MF=hb.left,Wd=B5,PF=function(e,r){r==null&&(r=pb);for(var t=0,n=e.length-1,i=e[0],s=new Array(n<0?0:n);t<n;)s[t]=r(i,i=e[++t]);return s};function pb(e,r){return[e,r]}var OF=function(e,r,t){var n=e.length,i=r.length,s=new Array(n*i),c,m,g,x;for(t==null&&(t=pb),c=g=0;c<n;++c)for(x=e[c],m=0;m<i;++m,++g)s[g]=t(x,r[m]);return s},IF=function(e,r){return r<e?-1:r>e?1:r>=e?0:NaN},hp=function(e){return e===null?NaN:+e},N5=function(e,r){var t=e.length,n=0,i=-1,s=0,c,m,g=0;if(r==null)for(;++i<t;)isNaN(c=hp(e[i]))||(m=c-s,s+=m/++n,g+=m*(c-s));else for(;++i<t;)isNaN(c=hp(r(e[i],i,e)))||(m=c-s,s+=m/++n,g+=m*(c-s));if(n>1)return g/(n-1)},z5=function(e,r){var t=N5(e,r);return t&&Math.sqrt(t)},U5=function(e,r){var t=e.length,n=-1,i,s,c;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(s=c=i;++n<t;)(i=e[n])!=null&&(s>i&&(s=i),c<i&&(c=i))}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(s=c=i;++n<t;)(i=r(e[n],n,e))!=null&&(s>i&&(s=i),c<i&&(c=i));return[s,c]},db=Array.prototype,j5=db.slice,V5=db.map,Zm=function(e){return function(){return e}},G5=function(e){return e},vb=function(e,r,t){e=+e,r=+r,t=(i=arguments.length)<2?(r=e,e=0,1):i<3?1:+t;for(var n=-1,i=Math.max(0,Math.ceil((r-e)/t))|0,s=new Array(i);++n<i;)s[n]=e+n*t;return s},yg=Math.sqrt(50),_g=Math.sqrt(10),xg=Math.sqrt(2),mb=function(e,r,t){var n,i=-1,s,c,m;if(r=+r,e=+e,t=+t,e===r&&t>0)return[e];if((n=r<e)&&(s=e,e=r,r=s),(m=Xm(e,r,t))===0||!isFinite(m))return[];if(m>0)for(e=Math.ceil(e/m),r=Math.floor(r/m),c=new Array(s=Math.ceil(r-e+1));++i<s;)c[i]=(e+i)*m;else for(e=Math.floor(e*m),r=Math.ceil(r*m),c=new Array(s=Math.ceil(e-r+1));++i<s;)c[i]=(e-i)/m;return n&&c.reverse(),c};function Xm(e,r,t){var n=(r-e)/Math.max(0,t),i=Math.floor(Math.log(n)/Math.LN10),s=n/Math.pow(10,i);return i>=0?(s>=yg?10:s>=_g?5:s>=xg?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=yg?10:s>=_g?5:s>=xg?2:1)}function Ym(e,r,t){var n=Math.abs(r-e)/Math.max(0,t),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),s=n/i;return s>=yg?i*=10:s>=_g?i*=5:s>=xg&&(i*=2),r<e?-i:i}var H5=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1},RF=function(){var e=G5,r=U5,t=H5;function n(i){var s,c=i.length,m,g=new Array(c);for(s=0;s<c;++s)g[s]=e(i[s],s,i);var x=r(g),A=x[0],M=x[1],R=t(g,A,M);Array.isArray(R)||(R=Ym(A,M,R),R=vb(Math.ceil(A/R)*R,M,R));for(var F=R.length;R[0]<=A;)R.shift(),--F;for(;R[F-1]>M;)R.pop(),--F;var Y=new Array(F+1),ie;for(s=0;s<=F;++s)ie=Y[s]=[],ie.x0=s>0?R[s-1]:A,ie.x1=s<F?R[s]:M;for(s=0;s<c;++s)m=g[s],A<=m&&m<=M&&Y[Wd(R,m,0,F)].push(i[s]);return Y}return n.value=function(i){return arguments.length?(e=typeof i=="function"?i:Zm(i),n):e},n.domain=function(i){return arguments.length?(r=typeof i=="function"?i:Zm([i[0],i[1]]),n):r},n.thresholds=function(i){return arguments.length?(t=typeof i=="function"?i:Array.isArray(i)?Zm(j5.call(i)):Zm(i),n):t},n},Km=function(e,r,t){if(t==null&&(t=hp),!!(n=e.length)){if((r=+r)<=0||n<2)return+t(e[0],0,e);if(r>=1)return+t(e[n-1],n-1,e);var n,i=(n-1)*r,s=Math.floor(i),c=+t(e[s],s,e),m=+t(e[s+1],s+1,e);return c+(m-c)*(i-s)}},kF=function(e,r,t){return e=V5.call(e,hp).sort(ed),Math.ceil((t-r)/(2*(Km(e,.75)-Km(e,.25))*Math.pow(e.length,-1/3)))},LF=function(e,r,t){return Math.ceil((t-r)/(3.5*z5(e)*Math.pow(e.length,-1/3)))},DF=function(e,r){var t=e.length,n=-1,i,s;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(s=i;++n<t;)(i=e[n])!=null&&i>s&&(s=i)}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(s=i;++n<t;)(i=r(e[n],n,e))!=null&&i>s&&(s=i);return s},FF=function(e,r){var t=e.length,n=t,i=-1,s,c=0;if(r==null)for(;++i<t;)isNaN(s=hp(e[i]))?--n:c+=s;else for(;++i<t;)isNaN(s=hp(r(e[i],i,e)))?--n:c+=s;if(n)return c/n},BF=function(e,r){var t=e.length,n=-1,i,s=[];if(r==null)for(;++n<t;)isNaN(i=hp(e[n]))||s.push(i);else for(;++n<t;)isNaN(i=hp(r(e[n],n,e)))||s.push(i);return Km(s.sort(ed),.5)},NF=function(e){for(var r=e.length,t,n=-1,i=0,s,c;++n<r;)i+=e[n].length;for(s=new Array(i);--r>=0;)for(c=e[r],t=c.length;--t>=0;)s[--i]=c[t];return s},W5=function(e,r){var t=e.length,n=-1,i,s;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(s=i;++n<t;)(i=e[n])!=null&&s>i&&(s=i)}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(s=i;++n<t;)(i=r(e[n],n,e))!=null&&s>i&&(s=i);return s},zF=function(e,r){for(var t=r.length,n=new Array(t);t--;)n[t]=e[r[t]];return n},UF=function(e,r){if(!!(t=e.length)){var t,n=0,i=0,s,c=e[i];for(r==null&&(r=ed);++n<t;)(r(s=e[n],c)<0||r(c,c)!==0)&&(c=s,i=n);if(r(c,c)===0)return i}},jF=function(e,r,t){for(var n=(t==null?e.length:t)-(r=r==null?0:+r),i,s;n;)s=Math.random()*n--|0,i=e[n+r],e[n+r]=e[s+r],e[s+r]=i;return e},VF=function(e,r){var t=e.length,n=-1,i,s=0;if(r==null)for(;++n<t;)(i=+e[n])&&(s+=i);else for(;++n<t;)(i=+r(e[n],n,e))&&(s+=i);return s},Z5=function(e){if(!(s=e.length))return[];for(var r=-1,t=W5(e,X5),n=new Array(t);++r<t;)for(var i=-1,s,c=n[r]=new Array(s);++i<s;)c[i]=e[i][r];return n};function X5(e){return e.length}var GF=function(){return Z5(arguments)};function mf(e,r){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(r).domain(e);break}return this}function Oh(e,r){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(r).domain(e);break}return this}var kc="$";function $m(){}$m.prototype=gb.prototype={constructor:$m,has:function(r){return kc+r in this},get:function(r){return this[kc+r]},set:function(r,t){return this[kc+r]=t,this},remove:function(r){var t=kc+r;return t in this&&delete this[t]},clear:function(){for(var r in this)r[0]===kc&&delete this[r]},keys:function(){var r=[];for(var t in this)t[0]===kc&&r.push(t.slice(1));return r},values:function(){var r=[];for(var t in this)t[0]===kc&&r.push(this[t]);return r},entries:function(){var r=[];for(var t in this)t[0]===kc&&r.push({key:t.slice(1),value:this[t]});return r},size:function(){var r=0;for(var t in this)t[0]===kc&&++r;return r},empty:function(){for(var r in this)if(r[0]===kc)return!1;return!0},each:function(r){for(var t in this)t[0]===kc&&r(this[t],t.slice(1),this)}};function gb(e,r){var t=new $m;if(e instanceof $m)e.each(function(m,g){t.set(g,m)});else if(Array.isArray(e)){var n=-1,i=e.length,s;if(r==null)for(;++n<i;)t.set(n,e[n]);else for(;++n<i;)t.set(r(s=e[n],n,e),s)}else if(e)for(var c in e)t.set(c,e[c]);return t}var $v=gb,HF=function(){var e=[],r=[],t,n,i;function s(m,g,x,A){if(g>=e.length)return t!=null&&m.sort(t),n!=null?n(m):m;for(var M=-1,R=m.length,F=e[g++],Y,ie,le=$v(),Ae,Xe=x();++M<R;)(Ae=le.get(Y=F(ie=m[M])+""))?Ae.push(ie):le.set(Y,[ie]);return le.each(function(nt,at){A(Xe,at,s(nt,g,x,A))}),Xe}function c(m,g){if(++g>e.length)return m;var x,A=r[g-1];return n!=null&&g>=e.length?x=m.entries():(x=[],m.each(function(M,R){x.push({key:R,values:c(M,g)})})),A!=null?x.sort(function(M,R){return A(M.key,R.key)}):x}return i={object:function(g){return s(g,0,Y5,K5)},map:function(g){return s(g,0,yb,_b)},entries:function(g){return c(s(g,0,yb,_b),0)},key:function(g){return e.push(g),i},sortKeys:function(g){return r[e.length-1]=g,i},sortValues:function(g){return t=g,i},rollup:function(g){return n=g,i}}};function Y5(){return{}}function K5(e,r,t){e[r]=t}function yb(){return $v()}function _b(e,r,t){e.set(r,t)}function qm(){}var td=$v.prototype;qm.prototype=xb.prototype={constructor:qm,has:td.has,add:function(r){return r+="",this[kc+r]=r,this},remove:td.remove,clear:td.clear,values:td.keys,size:td.size,empty:td.empty,each:td.each};function xb(e,r){var t=new qm;if(e instanceof qm)e.each(function(s){t.add(s)});else if(e){var n=-1,i=e.length;if(r==null)for(;++n<i;)t.add(e[n]);else for(;++n<i;)t.add(r(e[n],n,e))}return t}var WF=xb,ZF=function(e){var r=[];for(var t in e)r.push(t);return r},XF=function(e){var r=[];for(var t in e)r.push(e[t]);return r},YF=function(e){var r=[];for(var t in e)r.push({key:t,value:e[t]});return r},bb=Array.prototype,Qm=bb.map,rd=bb.slice,Eb={name:"implicit"};function qv(){var e=$v(),r=[],t=[],n=Eb;function i(s){var c=s+"",m=e.get(c);if(!m){if(n!==Eb)return n;e.set(c,m=r.push(s))}return t[(m-1)%t.length]}return i.domain=function(s){if(!arguments.length)return r.slice();r=[],e=$v();for(var c=-1,m=s.length,g,x;++c<m;)e.has(x=(g=s[c])+"")||e.set(x,r.push(g));return i},i.range=function(s){return arguments.length?(t=rd.call(s),i):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return qv(r,t).unknown(n)},mf.apply(i,arguments),i}function Sb(){var e=qv().unknown(void 0),r=e.domain,t=e.range,n=[0,1],i,s,c=!1,m=0,g=0,x=.5;delete e.unknown;function A(){var M=r().length,R=n[1]<n[0],F=n[R-0],Y=n[1-R];i=(Y-F)/Math.max(1,M-m+g*2),c&&(i=Math.floor(i)),F+=(Y-F-i*(M-m))*x,s=i*(1-m),c&&(F=Math.round(F),s=Math.round(s));var ie=vb(M).map(function(le){return F+i*le});return t(R?ie.reverse():ie)}return e.domain=function(M){return arguments.length?(r(M),A()):r()},e.range=function(M){return arguments.length?(n=[+M[0],+M[1]],A()):n.slice()},e.rangeRound=function(M){return n=[+M[0],+M[1]],c=!0,A()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(M){return arguments.length?(c=!!M,A()):c},e.padding=function(M){return arguments.length?(m=Math.min(1,g=+M),A()):m},e.paddingInner=function(M){return arguments.length?(m=Math.min(1,M),A()):m},e.paddingOuter=function(M){return arguments.length?(g=+M,A()):g},e.align=function(M){return arguments.length?(x=Math.max(0,Math.min(1,M)),A()):x},e.copy=function(){return Sb(r(),n).round(c).paddingInner(m).paddingOuter(g).align(x)},mf.apply(A(),arguments)}function Cb(e){var r=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Cb(r())},e}function KF(){return Cb(Sb.apply(null,arguments).paddingInner(1))}function Ab(e,r,t,n,i){var s=e*e,c=s*e;return((1-3*e+3*s-c)*r+(4-6*s+3*c)*t+(1+3*e+3*s-3*c)*n+c*i)/6}var $5=function(e){var r=e.length-1;return function(t){var n=t<=0?t=0:t>=1?(t=1,r-1):Math.floor(t*r),i=e[n],s=e[n+1],c=n>0?e[n-1]:2*i-s,m=n<r-1?e[n+2]:2*s-i;return Ab((t-n/r)*r,c,i,s,m)}},q5=function(e){var r=e.length;return function(t){var n=Math.floor(((t%=1)<0?++t:t)*r),i=e[(n+r-1)%r],s=e[n%r],c=e[(n+1)%r],m=e[(n+2)%r];return Ab((t-n/r)*r,i,s,c,m)}},Jm=function(e){return function(){return e}};function wb(e,r){return function(t){return e+t*r}}function Q5(e,r,t){return e=Math.pow(e,t),r=Math.pow(r,t)-e,t=1/t,function(n){return Math.pow(e+n*r,t)}}function $F(e,r){var t=r-e;return t?wb(e,t>180||t<-180?t-360*Math.round(t/360):t):Jm(isNaN(e)?r:e)}function J5(e){return(e=+e)==1?Tb:function(r,t){return t-r?Q5(r,t,e):Jm(isNaN(r)?t:r)}}function Tb(e,r){var t=r-e;return t?wb(e,t):Jm(isNaN(e)?r:e)}var Mb=function e(r){var t=J5(r);function n(i,s){var c=t((i=Ne(i)).r,(s=Ne(s)).r),m=t(i.g,s.g),g=t(i.b,s.b),x=Tb(i.opacity,s.opacity);return function(A){return i.r=c(A),i.g=m(A),i.b=g(A),i.opacity=x(A),i+""}}return n.gamma=e,n}(1);function Pb(e){return function(r){var t=r.length,n=new Array(t),i=new Array(t),s=new Array(t),c,m;for(c=0;c<t;++c)m=Ne(r[c]),n[c]=m.r||0,i[c]=m.g||0,s[c]=m.b||0;return n=e(n),i=e(i),s=e(s),m.opacity=1,function(g){return m.r=n(g),m.g=i(g),m.b=s(g),m+""}}}var qF=Pb($5),QF=Pb(q5),Ob=function(e,r){r||(r=[]);var t=e?Math.min(r.length,e.length):0,n=r.slice(),i;return function(s){for(i=0;i<t;++i)n[i]=e[i]*(1-s)+r[i]*s;return n}};function Ib(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var JF=function(e,r){return(Ib(r)?Ob:Rb)(e,r)};function Rb(e,r){var t=r?r.length:0,n=e?Math.min(t,e.length):0,i=new Array(n),s=new Array(t),c;for(c=0;c<n;++c)i[c]=Sg(e[c],r[c]);for(;c<t;++c)s[c]=r[c];return function(m){for(c=0;c<n;++c)s[c]=i[c](m);return s}}var eI=function(e,r){var t=new Date;return e=+e,r=+r,function(n){return t.setTime(e*(1-n)+r*n),t}},e0=function(e,r){return e=+e,r=+r,function(t){return e*(1-t)+r*t}},tI=function(e,r){var t={},n={},i;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(i in r)i in e?t[i]=Sg(e[i],r[i]):n[i]=r[i];return function(s){for(i in t)n[i]=t[i](s);return n}},bg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Eg=new RegExp(bg.source,"g");function rI(e){return function(){return e}}function nI(e){return function(r){return e(r)+""}}var iI=function(e,r){var t=bg.lastIndex=Eg.lastIndex=0,n,i,s,c=-1,m=[],g=[];for(e=e+"",r=r+"";(n=bg.exec(e))&&(i=Eg.exec(r));)(s=i.index)>t&&(s=r.slice(t,s),m[c]?m[c]+=s:m[++c]=s),(n=n[0])===(i=i[0])?m[c]?m[c]+=i:m[++c]=i:(m[++c]=null,g.push({i:c,x:e0(n,i)})),t=Eg.lastIndex;return t<r.length&&(s=r.slice(t),m[c]?m[c]+=s:m[++c]=s),m.length<2?g[0]?nI(g[0].x):rI(r):(r=g.length,function(x){for(var A=0,M;A<r;++A)m[(M=g[A]).i]=M.x(x);return m.join("")})},Sg=function(e,r){var t=typeof r,n;return r==null||t==="boolean"?Jm(r):(t==="number"?e0:t==="string"?(n=q(r))?(r=n,Mb):iI:r instanceof q?Mb:r instanceof Date?eI:Ib(r)?Ob:Array.isArray(r)?Rb:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?tI:e0)(e,r)},aI=function(e,r){return e=+e,r=+r,function(t){return Math.round(e*(1-t)+r*t)}},oI=function(e){return function(){return e}},Cg=function(e){return+e},kb=[0,1];function Vu(e){return e}function Ag(e,r){return(r-=e=+e)?function(t){return(t-e)/r}:oI(isNaN(r)?NaN:.5)}function Lb(e){var r=e[0],t=e[e.length-1],n;return r>t&&(n=r,r=t,t=n),function(i){return Math.max(r,Math.min(t,i))}}function sI(e,r,t){var n=e[0],i=e[1],s=r[0],c=r[1];return i<n?(n=Ag(i,n),s=t(c,s)):(n=Ag(n,i),s=t(s,c)),function(m){return s(n(m))}}function uI(e,r,t){var n=Math.min(e.length,r.length)-1,i=new Array(n),s=new Array(n),c=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),r=r.slice().reverse());++c<n;)i[c]=Ag(e[c],e[c+1]),s[c]=t(r[c],r[c+1]);return function(m){var g=Wd(e,m,1,n)-1;return s[g](i[g](m))}}function Qv(e,r){return r.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function t0(){var e=kb,r=kb,t=Sg,n,i,s,c=Vu,m,g,x;function A(){return m=Math.min(e.length,r.length)>2?uI:sI,g=x=null,M}function M(R){return isNaN(R=+R)?s:(g||(g=m(e.map(n),r,t)))(n(c(R)))}return M.invert=function(R){return c(i((x||(x=m(r,e.map(n),e0)))(R)))},M.domain=function(R){return arguments.length?(e=Qm.call(R,Cg),c===Vu||(c=Lb(e)),A()):e.slice()},M.range=function(R){return arguments.length?(r=rd.call(R),A()):r.slice()},M.rangeRound=function(R){return r=rd.call(R),t=aI,A()},M.clamp=function(R){return arguments.length?(c=R?Lb(e):Vu,M):c!==Vu},M.interpolate=function(R){return arguments.length?(t=R,A()):t},M.unknown=function(R){return arguments.length?(s=R,M):s},function(R,F){return n=R,i=F,A()}}function Db(e,r){return t0()(e,r)}var lI=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r0(e){if(!(r=lI.exec(e)))throw new Error("invalid format: "+e);var r;return new wg({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}r0.prototype=wg.prototype;function wg(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}wg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var cI=function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)};function n0(e,r){if((t=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"))<0)return null;var t,n=e.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+e.slice(t+1)]}var Zd=function(e){return e=n0(Math.abs(e)),e?e[1]:NaN},fI=function(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Zd(r)/3)))*3-Zd(Math.abs(e)))},hI=function(e,r){return function(t,n){for(var i=t.length,s=[],c=0,m=e[0],g=0;i>0&&m>0&&(g+m+1>n&&(m=Math.max(1,n-g)),s.push(t.substring(i-=m,i+m)),!((g+=m+1)>n));)m=e[c=(c+1)%e.length];return s.reverse().join(r)}},pI=function(e){return function(r){return r.replace(/[0-9]/g,function(t){return e[+t]})}},dI=function(e){e:for(var r=e.length,t=1,n=-1,i;t<r;++t)switch(e[t]){case".":n=i=t;break;case"0":n===0&&(n=t),i=t;break;default:if(!+e[t])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e},Fb,vI=function(e,r){var t=n0(e,r);if(!t)return e+"";var n=t[0],i=t[1],s=i-(Fb=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,c=n.length;return s===c?n:s>c?n+new Array(s-c+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+n0(e,Math.max(0,r+s-1))[0]},Bb=function(e,r){var t=n0(e,r);if(!t)return e+"";var n=t[0],i=t[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")},Nb={"%":function(r,t){return(r*100).toFixed(t)},b:function(r){return Math.round(r).toString(2)},c:function(r){return r+""},d:cI,e:function(r,t){return r.toExponential(t)},f:function(r,t){return r.toFixed(t)},g:function(r,t){return r.toPrecision(t)},o:function(r){return Math.round(r).toString(8)},p:function(r,t){return Bb(r*100,t)},r:Bb,s:vI,X:function(r){return Math.round(r).toString(16).toUpperCase()},x:function(r){return Math.round(r).toString(16)}},zb=function(e){return e},Ub=Array.prototype.map,jb=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],mI=function(e){var r=e.grouping===void 0||e.thousands===void 0?zb:hI(Ub.call(e.grouping,Number),e.thousands+""),t=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?zb:pI(Ub.call(e.numerals,String)),c=e.percent===void 0?"%":e.percent+"",m=e.minus===void 0?"-":e.minus+"",g=e.nan===void 0?"NaN":e.nan+"";function x(M){M=r0(M);var R=M.fill,F=M.align,Y=M.sign,ie=M.symbol,le=M.zero,Ae=M.width,Xe=M.comma,nt=M.precision,at=M.trim,It=M.type;It==="n"?(Xe=!0,It="g"):Nb[It]||(nt===void 0&&(nt=12),at=!0,It="g"),(le||R==="0"&&F==="=")&&(le=!0,R="0",F="=");var Ot=ie==="$"?t:ie==="#"&&/[boxX]/.test(It)?"0"+It.toLowerCase():"",Ut=ie==="$"?n:/[%p]/.test(It)?c:"",$t=Nb[It],Tr=/[defgprs%]/.test(It);nt=nt===void 0?6:/[gprs]/.test(It)?Math.max(1,Math.min(21,nt)):Math.max(0,Math.min(20,nt));function Dr(Sr){var Sn=Ot,Dn=Ut,ai,Ua,To;if(It==="c")Dn=$t(Sr)+Dn,Sr="";else{Sr=+Sr;var Gs=Sr<0||1/Sr<0;if(Sr=isNaN(Sr)?g:$t(Math.abs(Sr),nt),at&&(Sr=dI(Sr)),Gs&&+Sr==0&&Y!=="+"&&(Gs=!1),Sn=(Gs?Y==="("?Y:m:Y==="-"||Y==="("?"":Y)+Sn,Dn=(It==="s"?jb[8+Fb/3]:"")+Dn+(Gs&&Y==="("?")":""),Tr){for(ai=-1,Ua=Sr.length;++ai<Ua;)if(To=Sr.charCodeAt(ai),48>To||To>57){Dn=(To===46?i+Sr.slice(ai+1):Sr.slice(ai))+Dn,Sr=Sr.slice(0,ai);break}}}Xe&&!le&&(Sr=r(Sr,Infinity));var Hu=Sn.length+Sr.length+Dn.length,ws=Hu<Ae?new Array(Ae-Hu+1).join(R):"";switch(Xe&&le&&(Sr=r(ws+Sr,ws.length?Ae-Dn.length:Infinity),ws=""),F){case"<":Sr=Sn+Sr+Dn+ws;break;case"=":Sr=Sn+ws+Sr+Dn;break;case"^":Sr=ws.slice(0,Hu=ws.length>>1)+Sn+Sr+Dn+ws.slice(Hu);break;default:Sr=ws+Sn+Sr+Dn;break}return s(Sr)}return Dr.toString=function(){return M+""},Dr}function A(M,R){var F=x((M=r0(M),M.type="f",M)),Y=Math.max(-8,Math.min(8,Math.floor(Zd(R)/3)))*3,ie=Math.pow(10,-Y),le=jb[8+Y/3];return function(Ae){return F(ie*Ae)+le}}return{format:x,formatPrefix:A}},i0,Tg,Vb;gI({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function gI(e){return i0=mI(e),Tg=i0.format,Vb=i0.formatPrefix,i0}var yI=function(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,Zd(r)-Zd(e))+1},_I=function(e){return Math.max(0,-Zd(Math.abs(e)))},xI=function(e,r,t,n){var i=Ym(e,r,t),s;switch(n=r0(n==null?",f":n),n.type){case"s":{var c=Math.max(Math.abs(e),Math.abs(r));return n.precision==null&&!isNaN(s=fI(i,c))&&(n.precision=s),Vb(n,c)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=yI(i,Math.max(Math.abs(e),Math.abs(r))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=_I(i))&&(n.precision=s-(n.type==="%")*2);break}}return Tg(n)};function nd(e){var r=e.domain;return e.ticks=function(t){var n=r();return mb(n[0],n[n.length-1],t==null?10:t)},e.tickFormat=function(t,n){var i=r();return xI(i[0],i[i.length-1],t==null?10:t,n)},e.nice=function(t){t==null&&(t=10);var n=r(),i=0,s=n.length-1,c=n[i],m=n[s],g;return m<c&&(g=c,c=m,m=g,g=i,i=s,s=g),g=Xm(c,m,t),g>0?(c=Math.floor(c/g)*g,m=Math.ceil(m/g)*g,g=Xm(c,m,t)):g<0&&(c=Math.ceil(c*g)/g,m=Math.floor(m*g)/g,g=Xm(c,m,t)),g>0?(n[i]=Math.floor(c/g)*g,n[s]=Math.ceil(m/g)*g,r(n)):g<0&&(n[i]=Math.ceil(c*g)/g,n[s]=Math.floor(m*g)/g,r(n)),e},e}function Gb(){var e=Db(Vu,Vu);return e.copy=function(){return Qv(e,Gb())},mf.apply(e,arguments),nd(e)}function Hb(e){var r;function t(n){return isNaN(n=+n)?r:n}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=Qm.call(n,Cg),t):e.slice()},t.unknown=function(n){return arguments.length?(r=n,t):r},t.copy=function(){return Hb(e).unknown(r)},e=arguments.length?Qm.call(e,Cg):[0,1],nd(t)}var Wb=function(e,r){e=e.slice();var t=0,n=e.length-1,i=e[t],s=e[n],c;return s<i&&(c=t,t=n,n=c,c=i,i=s,s=c),e[t]=r.floor(i),e[n]=r.ceil(s),e};function Zb(e){return Math.log(e)}function Xb(e){return Math.exp(e)}function bI(e){return-Math.log(-e)}function EI(e){return-Math.exp(-e)}function SI(e){return isFinite(e)?+("1e"+e):e<0?0:e}function CI(e){return e===10?SI:e===Math.E?Math.exp:function(r){return Math.pow(e,r)}}function AI(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(r){return Math.log(r)/e})}function Yb(e){return function(r){return-e(-r)}}function Mg(e){var r=e(Zb,Xb),t=r.domain,n=10,i,s;function c(){return i=AI(n),s=CI(n),t()[0]<0?(i=Yb(i),s=Yb(s),e(bI,EI)):e(Zb,Xb),r}return r.base=function(m){return arguments.length?(n=+m,c()):n},r.domain=function(m){return arguments.length?(t(m),c()):t()},r.ticks=function(m){var g=t(),x=g[0],A=g[g.length-1],M;(M=A<x)&&(R=x,x=A,A=R);var R=i(x),F=i(A),Y,ie,le,Ae=m==null?10:+m,Xe=[];if(!(n%1)&&F-R<Ae){if(R=Math.round(R)-1,F=Math.round(F)+1,x>0){for(;R<F;++R)for(ie=1,Y=s(R);ie<n;++ie)if(le=Y*ie,!(le<x)){if(le>A)break;Xe.push(le)}}else for(;R<F;++R)for(ie=n-1,Y=s(R);ie>=1;--ie)if(le=Y*ie,!(le<x)){if(le>A)break;Xe.push(le)}}else Xe=mb(R,F,Math.min(F-R,Ae)).map(s);return M?Xe.reverse():Xe},r.tickFormat=function(m,g){if(g==null&&(g=n===10?".0e":","),typeof g!="function"&&(g=Tg(g)),m===Infinity)return g;m==null&&(m=10);var x=Math.max(1,n*m/r.ticks().length);return function(A){var M=A/s(Math.round(i(A)));return M*n<n-.5&&(M*=n),M<=x?g(A):""}},r.nice=function(){return t(Wb(t(),{floor:function(g){return s(Math.floor(i(g)))},ceil:function(g){return s(Math.ceil(i(g)))}}))},r}function Kb(){var e=Mg(t0()).domain([1,10]);return e.copy=function(){return Qv(e,Kb()).base(e.base())},mf.apply(e,arguments),e}function $b(e){return function(r){return Math.sign(r)*Math.log1p(Math.abs(r/e))}}function qb(e){return function(r){return Math.sign(r)*Math.expm1(Math.abs(r))*e}}function Pg(e){var r=1,t=e($b(r),qb(r));return t.constant=function(n){return arguments.length?e($b(r=+n),qb(r)):r},nd(t)}function wI(){var e=Pg(t0());return e.copy=function(){return Qv(e,wI()).constant(e.constant())},mf.apply(e,arguments)}function Qb(e){return function(r){return r<0?-Math.pow(-r,e):Math.pow(r,e)}}function TI(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function MI(e){return e<0?-e*e:e*e}function Og(e){var r=e(Vu,Vu),t=1;function n(){return t===1?e(Vu,Vu):t===.5?e(TI,MI):e(Qb(t),Qb(1/t))}return r.exponent=function(i){return arguments.length?(t=+i,n()):t},nd(r)}function Ig(){var e=Og(t0());return e.copy=function(){return Qv(e,Ig()).exponent(e.exponent())},mf.apply(e,arguments),e}function e6(){return Ig.apply(null,arguments).exponent(.5)}function Jb(){var e=[],r=[],t=[],n;function i(){var c=0,m=Math.max(1,r.length);for(t=new Array(m-1);++c<m;)t[c-1]=Km(e,c/m);return s}function s(c){return isNaN(c=+c)?n:r[Wd(t,c)]}return s.invertExtent=function(c){var m=r.indexOf(c);return m<0?[NaN,NaN]:[m>0?t[m-1]:e[0],m<t.length?t[m]:e[e.length-1]]},s.domain=function(c){if(!arguments.length)return e.slice();e=[];for(var m=0,g=c.length,x;m<g;++m)x=c[m],x!=null&&!isNaN(x=+x)&&e.push(x);return e.sort(ed),i()},s.range=function(c){return arguments.length?(r=rd.call(c),i()):r.slice()},s.unknown=function(c){return arguments.length?(n=c,s):n},s.quantiles=function(){return t.slice()},s.copy=function(){return Jb().domain(e).range(r).unknown(n)},mf.apply(s,arguments)}function eE(){var e=0,r=1,t=1,n=[.5],i=[0,1],s;function c(g){return g<=g?i[Wd(n,g,0,t)]:s}function m(){var g=-1;for(n=new Array(t);++g<t;)n[g]=((g+1)*r-(g-t)*e)/(t+1);return c}return c.domain=function(g){return arguments.length?(e=+g[0],r=+g[1],m()):[e,r]},c.range=function(g){return arguments.length?(t=(i=rd.call(g)).length-1,m()):i.slice()},c.invertExtent=function(g){var x=i.indexOf(g);return x<0?[NaN,NaN]:x<1?[e,n[0]]:x>=t?[n[t-1],r]:[n[x-1],n[x]]},c.unknown=function(g){return arguments.length&&(s=g),c},c.thresholds=function(){return n.slice()},c.copy=function(){return eE().domain([e,r]).range(i).unknown(s)},mf.apply(nd(c),arguments)}function tE(){var e=[.5],r=[0,1],t,n=1;function i(s){return s<=s?r[Wd(e,s,0,n)]:t}return i.domain=function(s){return arguments.length?(e=rd.call(s),n=Math.min(e.length,r.length-1),i):e.slice()},i.range=function(s){return arguments.length?(r=rd.call(s),n=Math.min(e.length,r.length-1),i):r.slice()},i.invertExtent=function(s){var c=r.indexOf(s);return[e[c-1],e[c]]},i.unknown=function(s){return arguments.length?(t=s,i):t},i.copy=function(){return tE().domain(e).range(r).unknown(t)},mf.apply(i,arguments)}var Rg=new Date,kg=new Date;function Cu(e,r,t,n){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=function(s){return e(s=new Date(+s)),s},i.ceil=function(s){return e(s=new Date(s-1)),r(s,1),e(s),s},i.round=function(s){var c=i(s),m=i.ceil(s);return s-c<m-s?c:m},i.offset=function(s,c){return r(s=new Date(+s),c==null?1:Math.floor(c)),s},i.range=function(s,c,m){var g=[],x;if(s=i.ceil(s),m=m==null?1:Math.floor(m),!(s<c)||!(m>0))return g;do g.push(x=new Date(+s)),r(s,m),e(s);while(x<s&&s<c);return g},i.filter=function(s){return Cu(function(c){if(c>=c)for(;e(c),!s(c);)c.setTime(c-1)},function(c,m){if(c>=c)if(m<0)for(;++m<=0;)for(;r(c,-1),!s(c););else for(;--m>=0;)for(;r(c,1),!s(c););})},t&&(i.count=function(s,c){return Rg.setTime(+s),kg.setTime(+c),e(Rg),e(kg),Math.floor(t(Rg,kg))},i.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(n?function(c){return n(c)%s==0}:function(c){return i.count(0,c)%s==0}):i}),i}var Lg=Cu(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,r){e.setFullYear(e.getFullYear()+r)},function(e,r){return r.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Lg.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Cu(function(r){r.setFullYear(Math.floor(r.getFullYear()/e)*e),r.setMonth(0,1),r.setHours(0,0,0,0)},function(r,t){r.setFullYear(r.getFullYear()+t*e)})};var Xd=Lg,t6=Lg.range,rE=Cu(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,r){e.setMonth(e.getMonth()+r)},function(e,r){return r.getMonth()-e.getMonth()+(r.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),PI=rE,r6=rE.range,a0=1e3,id=6e4,o0=36e5,nE=864e5,iE=6048e5;function ad(e){return Cu(function(r){r.setDate(r.getDate()-(r.getDay()+7-e)%7),r.setHours(0,0,0,0)},function(r,t){r.setDate(r.getDate()+t*7)},function(r,t){return(t-r-(t.getTimezoneOffset()-r.getTimezoneOffset())*id)/iE})}var Dg=ad(0),s0=ad(1),OI=ad(2),II=ad(3),Yd=ad(4),RI=ad(5),kI=ad(6),n6=Dg.range,i6=s0.range,a6=OI.range,o6=II.range,s6=Yd.range,u6=RI.range,l6=kI.range,aE=Cu(function(e){e.setHours(0,0,0,0)},function(e,r){e.setDate(e.getDate()+r)},function(e,r){return(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*id)/nE},function(e){return e.getDate()-1}),Fg=aE,c6=aE.range,oE=Cu(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*a0-e.getMinutes()*id)},function(e,r){e.setTime(+e+r*o0)},function(e,r){return(r-e)/o0},function(e){return e.getHours()}),LI=oE,f6=oE.range,sE=Cu(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*a0)},function(e,r){e.setTime(+e+r*id)},function(e,r){return(r-e)/id},function(e){return e.getMinutes()}),DI=sE,h6=sE.range,uE=Cu(function(e){e.setTime(e-e.getMilliseconds())},function(e,r){e.setTime(+e+r*a0)},function(e,r){return(r-e)/a0},function(e){return e.getUTCSeconds()}),lE=uE,p6=uE.range,u0=Cu(function(){},function(e,r){e.setTime(+e+r)},function(e,r){return r-e});u0.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Cu(function(r){r.setTime(Math.floor(r/e)*e)},function(r,t){r.setTime(+r+t*e)},function(r,t){return(t-r)/e}):u0};var cE=u0,d6=u0.range;function od(e){return Cu(function(r){r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-e)%7),r.setUTCHours(0,0,0,0)},function(r,t){r.setUTCDate(r.getUTCDate()+t*7)},function(r,t){return(t-r)/iE})}var Bg=od(0),l0=od(1),FI=od(2),BI=od(3),Kd=od(4),NI=od(5),zI=od(6),v6=Bg.range,m6=l0.range,g6=FI.range,y6=BI.range,_6=Kd.range,x6=NI.range,b6=zI.range,fE=Cu(function(e){e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCDate(e.getUTCDate()+r)},function(e,r){return(r-e)/nE},function(e){return e.getUTCDate()-1}),Ng=fE,E6=fE.range,zg=Cu(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCFullYear(e.getUTCFullYear()+r)},function(e,r){return r.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});zg.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Cu(function(r){r.setUTCFullYear(Math.floor(r.getUTCFullYear()/e)*e),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},function(r,t){r.setUTCFullYear(r.getUTCFullYear()+t*e)})};var $d=zg,S6=zg.range;function Ug(e){if(0<=e.y&&e.y<100){var r=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return r.setFullYear(e.y),r}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function jg(e){if(0<=e.y&&e.y<100){var r=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return r.setUTCFullYear(e.y),r}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Jv(e,r,t){return{y:e,m:r,d:t,H:0,M:0,S:0,L:0}}function UI(e){var r=e.dateTime,t=e.date,n=e.time,i=e.periods,s=e.days,c=e.shortDays,m=e.months,g=e.shortMonths,x=em(i),A=tm(i),M=em(s),R=tm(s),F=em(c),Y=tm(c),ie=em(m),le=tm(m),Ae=em(g),Xe=tm(g),nt={a:Gs,A:Hu,b:ws,B:Lh,c:null,d:gE,e:gE,f:l3,g:_3,G:b3,H:o3,I:s3,j:u3,L:yE,m:c3,M:f3,p:X0,q:sv,Q:CE,s:AE,S:h3,u:p3,U:d3,V:v3,w:m3,W:g3,x:null,X:null,y:y3,Y:x3,Z:E3,"%":SE},at={a:gy,A:yy,b:vs,B:zl,c:null,d:xE,e:xE,f:w3,g:F3,G:N3,H:S3,I:C3,j:A3,L:bE,m:T3,M:M3,p:Y0,q:K0,Q:CE,s:AE,S:P3,u:O3,U:I3,V:R3,w:k3,W:L3,x:null,X:null,y:D3,Y:B3,Z:z3,"%":SE},It={a:Dr,A:Sr,b:Sn,B:Dn,c:ai,d:vE,e:vE,f:r3,g:dE,G:pE,H:mE,I:mE,j:QI,L:t3,m:qI,M:JI,p:Tr,q:$I,Q:i3,s:a3,S:e3,u:WI,U:ZI,V:XI,w:HI,W:YI,x:Ua,X:To,y:dE,Y:pE,Z:KI,"%":n3};nt.x=Ot(t,nt),nt.X=Ot(n,nt),nt.c=Ot(r,nt),at.x=Ot(t,at),at.X=Ot(n,at),at.c=Ot(r,at);function Ot(Gi,Fa){return function(ha){var Nn=[],Ul=-1,Zo=0,rc=Gi.length,nc,cd,IC;for(ha instanceof Date||(ha=new Date(+ha));++Ul<rc;)Gi.charCodeAt(Ul)===37&&(Nn.push(Gi.slice(Zo,Ul)),(cd=hE[nc=Gi.charAt(++Ul)])!=null?nc=Gi.charAt(++Ul):cd=nc==="e"?" ":"0",(IC=Fa[nc])&&(nc=IC(ha,cd)),Nn.push(nc),Zo=Ul+1);return Nn.push(Gi.slice(Zo,Ul)),Nn.join("")}}function Ut(Gi,Fa){return function(ha){var Nn=Jv(1900,void 0,1),Ul=$t(Nn,Gi,ha+="",0),Zo,rc;if(Ul!=ha.length)return null;if("Q"in Nn)return new Date(Nn.Q);if("s"in Nn)return new Date(Nn.s*1e3+("L"in Nn?Nn.L:0));if(Fa&&!("Z"in Nn)&&(Nn.Z=0),"p"in Nn&&(Nn.H=Nn.H%12+Nn.p*12),Nn.m===void 0&&(Nn.m="q"in Nn?Nn.q:0),"V"in Nn){if(Nn.V<1||Nn.V>53)return null;"w"in Nn||(Nn.w=1),"Z"in Nn?(Zo=jg(Jv(Nn.y,0,1)),rc=Zo.getUTCDay(),Zo=rc>4||rc===0?l0.ceil(Zo):l0(Zo),Zo=Ng.offset(Zo,(Nn.V-1)*7),Nn.y=Zo.getUTCFullYear(),Nn.m=Zo.getUTCMonth(),Nn.d=Zo.getUTCDate()+(Nn.w+6)%7):(Zo=Ug(Jv(Nn.y,0,1)),rc=Zo.getDay(),Zo=rc>4||rc===0?s0.ceil(Zo):s0(Zo),Zo=Fg.offset(Zo,(Nn.V-1)*7),Nn.y=Zo.getFullYear(),Nn.m=Zo.getMonth(),Nn.d=Zo.getDate()+(Nn.w+6)%7)}else("W"in Nn||"U"in Nn)&&("w"in Nn||(Nn.w="u"in Nn?Nn.u%7:"W"in Nn?1:0),rc="Z"in Nn?jg(Jv(Nn.y,0,1)).getUTCDay():Ug(Jv(Nn.y,0,1)).getDay(),Nn.m=0,Nn.d="W"in Nn?(Nn.w+6)%7+Nn.W*7-(rc+5)%7:Nn.w+Nn.U*7-(rc+6)%7);return"Z"in Nn?(Nn.H+=Nn.Z/100|0,Nn.M+=Nn.Z%100,jg(Nn)):Ug(Nn)}}function $t(Gi,Fa,ha,Nn){for(var Ul=0,Zo=Fa.length,rc=ha.length,nc,cd;Ul<Zo;){if(Nn>=rc)return-1;if(nc=Fa.charCodeAt(Ul++),nc===37){if(nc=Fa.charAt(Ul++),cd=It[nc in hE?Fa.charAt(Ul++):nc],!cd||(Nn=cd(Gi,ha,Nn))<0)return-1}else if(nc!=ha.charCodeAt(Nn++))return-1}return Nn}function Tr(Gi,Fa,ha){var Nn=x.exec(Fa.slice(ha));return Nn?(Gi.p=A[Nn[0].toLowerCase()],ha+Nn[0].length):-1}function Dr(Gi,Fa,ha){var Nn=F.exec(Fa.slice(ha));return Nn?(Gi.w=Y[Nn[0].toLowerCase()],ha+Nn[0].length):-1}function Sr(Gi,Fa,ha){var Nn=M.exec(Fa.slice(ha));return Nn?(Gi.w=R[Nn[0].toLowerCase()],ha+Nn[0].length):-1}function Sn(Gi,Fa,ha){var Nn=Ae.exec(Fa.slice(ha));return Nn?(Gi.m=Xe[Nn[0].toLowerCase()],ha+Nn[0].length):-1}function Dn(Gi,Fa,ha){var Nn=ie.exec(Fa.slice(ha));return Nn?(Gi.m=le[Nn[0].toLowerCase()],ha+Nn[0].length):-1}function ai(Gi,Fa,ha){return $t(Gi,r,Fa,ha)}function Ua(Gi,Fa,ha){return $t(Gi,t,Fa,ha)}function To(Gi,Fa,ha){return $t(Gi,n,Fa,ha)}function Gs(Gi){return c[Gi.getDay()]}function Hu(Gi){return s[Gi.getDay()]}function ws(Gi){return g[Gi.getMonth()]}function Lh(Gi){return m[Gi.getMonth()]}function X0(Gi){return i[+(Gi.getHours()>=12)]}function sv(Gi){return 1+~~(Gi.getMonth()/3)}function gy(Gi){return c[Gi.getUTCDay()]}function yy(Gi){return s[Gi.getUTCDay()]}function vs(Gi){return g[Gi.getUTCMonth()]}function zl(Gi){return m[Gi.getUTCMonth()]}function Y0(Gi){return i[+(Gi.getUTCHours()>=12)]}function K0(Gi){return 1+~~(Gi.getUTCMonth()/3)}return{format:function(Fa){var ha=Ot(Fa+="",nt);return ha.toString=function(){return Fa},ha},parse:function(Fa){var ha=Ut(Fa+="",!1);return ha.toString=function(){return Fa},ha},utcFormat:function(Fa){var ha=Ot(Fa+="",at);return ha.toString=function(){return Fa},ha},utcParse:function(Fa){var ha=Ut(Fa+="",!0);return ha.toString=function(){return Fa},ha}}}var hE={"-":"",_:" ","0":"0"},Au=/^\s*\d+/,jI=/^%/,VI=/[\\^$*+?|[\]().{}]/g;function Ja(e,r,t){var n=e<0?"-":"",i=(n?-e:e)+"",s=i.length;return n+(s<t?new Array(t-s+1).join(r)+i:i)}function GI(e){return e.replace(VI,"\\$&")}function em(e){return new RegExp("^(?:"+e.map(GI).join("|")+")","i")}function tm(e){for(var r={},t=-1,n=e.length;++t<n;)r[e[t].toLowerCase()]=t;return r}function HI(e,r,t){var n=Au.exec(r.slice(t,t+1));return n?(e.w=+n[0],t+n[0].length):-1}function WI(e,r,t){var n=Au.exec(r.slice(t,t+1));return n?(e.u=+n[0],t+n[0].length):-1}function ZI(e,r,t){var n=Au.exec(r.slice(t,t+2));return n?(e.U=+n[0],t+n[0].length):-1}function XI(e,r,t){var n=Au.exec(r.slice(t,t+2));return n?(e.V=+n[0],t+n[0].length):-1}function YI(e,r,t){var n=Au.exec(r.slice(t,t+2));return n?(e.W=+n[0],t+n[0].length):-1}function pE(e,r,t){var n=Au.exec(r.slice(t,t+4));return n?(e.y=+n[0],t+n[0].length):-1}function dE(e,r,t){var n=Au.exec(r.slice(t,t+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),t+n[0].length):-1}function KI(e,r,t){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(t,t+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),t+n[0].length):-1}function $I(e,r,t){var n=Au.exec(r.slice(t,t+1));return n?(e.q=n[0]*3-3,t+n[0].length):-1}function qI(e,r,t){var n=Au.exec(r.slice(t,t+2));return n?(e.m=n[0]-1,t+n[0].length):-1}function vE(e,r,t){var n=Au.exec(r.slice(t,t+2));return n?(e.d=+n[0],t+n[0].length):-1}function QI(e,r,t){var n=Au.exec(r.slice(t,t+3));return n?(e.m=0,e.d=+n[0],t+n[0].length):-1}function mE(e,r,t){var n=Au.exec(r.slice(t,t+2));return n?(e.H=+n[0],t+n[0].length):-1}function JI(e,r,t){var n=Au.exec(r.slice(t,t+2));return n?(e.M=+n[0],t+n[0].length):-1}function e3(e,r,t){var n=Au.exec(r.slice(t,t+2));return n?(e.S=+n[0],t+n[0].length):-1}function t3(e,r,t){var n=Au.exec(r.slice(t,t+3));return n?(e.L=+n[0],t+n[0].length):-1}function r3(e,r,t){var n=Au.exec(r.slice(t,t+6));return n?(e.L=Math.floor(n[0]/1e3),t+n[0].length):-1}function n3(e,r,t){var n=jI.exec(r.slice(t,t+1));return n?t+n[0].length:-1}function i3(e,r,t){var n=Au.exec(r.slice(t));return n?(e.Q=+n[0],t+n[0].length):-1}function a3(e,r,t){var n=Au.exec(r.slice(t));return n?(e.s=+n[0],t+n[0].length):-1}function gE(e,r){return Ja(e.getDate(),r,2)}function o3(e,r){return Ja(e.getHours(),r,2)}function s3(e,r){return Ja(e.getHours()%12||12,r,2)}function u3(e,r){return Ja(1+Fg.count(Xd(e),e),r,3)}function yE(e,r){return Ja(e.getMilliseconds(),r,3)}function l3(e,r){return yE(e,r)+"000"}function c3(e,r){return Ja(e.getMonth()+1,r,2)}function f3(e,r){return Ja(e.getMinutes(),r,2)}function h3(e,r){return Ja(e.getSeconds(),r,2)}function p3(e){var r=e.getDay();return r===0?7:r}function d3(e,r){return Ja(Dg.count(Xd(e)-1,e),r,2)}function _E(e){var r=e.getDay();return r>=4||r===0?Yd(e):Yd.ceil(e)}function v3(e,r){return e=_E(e),Ja(Yd.count(Xd(e),e)+(Xd(e).getDay()===4),r,2)}function m3(e){return e.getDay()}function g3(e,r){return Ja(s0.count(Xd(e)-1,e),r,2)}function y3(e,r){return Ja(e.getFullYear()%100,r,2)}function _3(e,r){return e=_E(e),Ja(e.getFullYear()%100,r,2)}function x3(e,r){return Ja(e.getFullYear()%1e4,r,4)}function b3(e,r){var t=e.getDay();return e=t>=4||t===0?Yd(e):Yd.ceil(e),Ja(e.getFullYear()%1e4,r,4)}function E3(e){var r=e.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+Ja(r/60|0,"0",2)+Ja(r%60,"0",2)}function xE(e,r){return Ja(e.getUTCDate(),r,2)}function S3(e,r){return Ja(e.getUTCHours(),r,2)}function C3(e,r){return Ja(e.getUTCHours()%12||12,r,2)}function A3(e,r){return Ja(1+Ng.count($d(e),e),r,3)}function bE(e,r){return Ja(e.getUTCMilliseconds(),r,3)}function w3(e,r){return bE(e,r)+"000"}function T3(e,r){return Ja(e.getUTCMonth()+1,r,2)}function M3(e,r){return Ja(e.getUTCMinutes(),r,2)}function P3(e,r){return Ja(e.getUTCSeconds(),r,2)}function O3(e){var r=e.getUTCDay();return r===0?7:r}function I3(e,r){return Ja(Bg.count($d(e)-1,e),r,2)}function EE(e){var r=e.getUTCDay();return r>=4||r===0?Kd(e):Kd.ceil(e)}function R3(e,r){return e=EE(e),Ja(Kd.count($d(e),e)+($d(e).getUTCDay()===4),r,2)}function k3(e){return e.getUTCDay()}function L3(e,r){return Ja(l0.count($d(e)-1,e),r,2)}function D3(e,r){return Ja(e.getUTCFullYear()%100,r,2)}function F3(e,r){return e=EE(e),Ja(e.getUTCFullYear()%100,r,2)}function B3(e,r){return Ja(e.getUTCFullYear()%1e4,r,4)}function N3(e,r){var t=e.getUTCDay();return e=t>=4||t===0?Kd(e):Kd.ceil(e),Ja(e.getUTCFullYear()%1e4,r,4)}function z3(){return"+0000"}function SE(){return"%"}function CE(e){return+e}function AE(e){return Math.floor(+e/1e3)}var qd,wE,U3,TE,j3;V3({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function V3(e){return qd=UI(e),wE=qd.format,U3=qd.parse,TE=qd.utcFormat,j3=qd.utcParse,qd}var rm=1e3,nm=rm*60,im=nm*60,am=im*24,G3=am*7,ME=am*30,Vg=am*365;function H3(e){return new Date(e)}function W3(e){return e instanceof Date?+e:+new Date(+e)}function Gg(e,r,t,n,i,s,c,m,g){var x=Db(Vu,Vu),A=x.invert,M=x.domain,R=g(".%L"),F=g(":%S"),Y=g("%I:%M"),ie=g("%I %p"),le=g("%a %d"),Ae=g("%b %d"),Xe=g("%B"),nt=g("%Y"),at=[[c,1,rm],[c,5,5*rm],[c,15,15*rm],[c,30,30*rm],[s,1,nm],[s,5,5*nm],[s,15,15*nm],[s,30,30*nm],[i,1,im],[i,3,3*im],[i,6,6*im],[i,12,12*im],[n,1,am],[n,2,2*am],[t,1,G3],[r,1,ME],[r,3,3*ME],[e,1,Vg]];function It(Ut){return(c(Ut)<Ut?R:s(Ut)<Ut?F:i(Ut)<Ut?Y:n(Ut)<Ut?ie:r(Ut)<Ut?t(Ut)<Ut?le:Ae:e(Ut)<Ut?Xe:nt)(Ut)}function Ot(Ut,$t,Tr,Dr){if(Ut==null&&(Ut=10),typeof Ut=="number"){var Sr=Math.abs(Tr-$t)/Ut,Sn=fb(function(Dn){return Dn[2]}).right(at,Sr);Sn===at.length?(Dr=Ym($t/Vg,Tr/Vg,Ut),Ut=e):Sn?(Sn=at[Sr/at[Sn-1][2]<at[Sn][2]/Sr?Sn-1:Sn],Dr=Sn[1],Ut=Sn[0]):(Dr=Math.max(Ym($t,Tr,Ut),1),Ut=m)}return Dr==null?Ut:Ut.every(Dr)}return x.invert=function(Ut){return new Date(A(Ut))},x.domain=function(Ut){return arguments.length?M(Qm.call(Ut,W3)):M().map(H3)},x.ticks=function(Ut,$t){var Tr=M(),Dr=Tr[0],Sr=Tr[Tr.length-1],Sn=Sr<Dr,Dn;return Sn&&(Dn=Dr,Dr=Sr,Sr=Dn),Dn=Ot(Ut,Dr,Sr,$t),Dn=Dn?Dn.range(Dr,Sr+1):[],Sn?Dn.reverse():Dn},x.tickFormat=function(Ut,$t){return $t==null?It:g($t)},x.nice=function(Ut,$t){var Tr=M();return(Ut=Ot(Ut,Tr[0],Tr[Tr.length-1],$t))?M(Wb(Tr,Ut)):x},x.copy=function(){return Qv(x,Gg(e,r,t,n,i,s,c,m,g))},x}var Z3=function(){return mf.apply(Gg(Xd,PI,Dg,Fg,LI,DI,lE,cE,wE).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},PE=Cu(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCMonth(e.getUTCMonth()+r)},function(e,r){return r.getUTCMonth()-e.getUTCMonth()+(r.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),X3=PE,C6=PE.range,OE=Cu(function(e){e.setUTCMinutes(0,0,0)},function(e,r){e.setTime(+e+r*o0)},function(e,r){return(r-e)/o0},function(e){return e.getUTCHours()}),Y3=OE,A6=OE.range,IE=Cu(function(e){e.setUTCSeconds(0,0)},function(e,r){e.setTime(+e+r*id)},function(e,r){return(r-e)/id},function(e){return e.getUTCMinutes()}),K3=IE,w6=IE.range,T6=function(){return mf.apply(Gg($d,X3,Bg,Ng,Y3,K3,lE,cE,TE).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function c0(){var e=0,r=1,t,n,i,s,c=Vu,m=!1,g;function x(A){return isNaN(A=+A)?g:c(i===0?.5:(A=(s(A)-t)*i,m?Math.max(0,Math.min(1,A)):A))}return x.domain=function(A){return arguments.length?(t=s(e=+A[0]),n=s(r=+A[1]),i=t===n?0:1/(n-t),x):[e,r]},x.clamp=function(A){return arguments.length?(m=!!A,x):m},x.interpolator=function(A){return arguments.length?(c=A,x):c},x.unknown=function(A){return arguments.length?(g=A,x):g},function(A){return s=A,t=A(e),n=A(r),i=t===n?0:1/(n-t),x}}function pp(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function $3(){var e=nd(c0()(Vu));return e.copy=function(){return pp(e,$3())},Oh.apply(e,arguments)}function q3(){var e=Mg(c0()).domain([1,10]);return e.copy=function(){return pp(e,q3()).base(e.base())},Oh.apply(e,arguments)}function Q3(){var e=Pg(c0());return e.copy=function(){return pp(e,Q3()).constant(e.constant())},Oh.apply(e,arguments)}function RE(){var e=Og(c0());return e.copy=function(){return pp(e,RE()).exponent(e.exponent())},Oh.apply(e,arguments)}function M6(){return RE.apply(null,arguments).exponent(.5)}function J3(){var e=[],r=Vu;function t(n){if(!isNaN(n=+n))return r((Wd(e,n)-1)/(e.length-1))}return t.domain=function(n){if(!arguments.length)return e.slice();e=[];for(var i=0,s=n.length,c;i<s;++i)c=n[i],c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(ed),t},t.interpolator=function(n){return arguments.length?(r=n,t):r},t.copy=function(){return J3(r).domain(e)},Oh.apply(t,arguments)}function f0(){var e=0,r=.5,t=1,n,i,s,c,m,g=Vu,x,A=!1,M;function R(F){return isNaN(F=+F)?M:(F=.5+((F=+x(F))-i)*(F<i?c:m),g(A?Math.max(0,Math.min(1,F)):F))}return R.domain=function(F){return arguments.length?(n=x(e=+F[0]),i=x(r=+F[1]),s=x(t=+F[2]),c=n===i?0:.5/(i-n),m=i===s?0:.5/(s-i),R):[e,r,t]},R.clamp=function(F){return arguments.length?(A=!!F,R):A},R.interpolator=function(F){return arguments.length?(g=F,R):g},R.unknown=function(F){return arguments.length?(M=F,R):M},function(F){return x=F,n=F(e),i=F(r),s=F(t),c=n===i?0:.5/(i-n),m=i===s?0:.5/(s-i),R}}function eR(){var e=nd(f0()(Vu));return e.copy=function(){return pp(e,eR())},Oh.apply(e,arguments)}function tR(){var e=Mg(f0()).domain([.1,1,10]);return e.copy=function(){return pp(e,tR()).base(e.base())},Oh.apply(e,arguments)}function rR(){var e=Pg(f0());return e.copy=function(){return pp(e,rR()).constant(e.constant())},Oh.apply(e,arguments)}function kE(){var e=Og(f0());return e.copy=function(){return pp(e,kE()).exponent(e.exponent())},Oh.apply(e,arguments)}function P6(){return kE.apply(null,arguments).exponent(.5)}var gf,LE,DE,FE,Hg,BE,nR=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,iR=(gf={},S()(gf,uu.LINEAR,Gb),S()(gf,uu.POWER,Ig),S()(gf,uu.LOG,Kb),S()(gf,uu.IDENTITY,Hb),S()(gf,uu.TIME,Z3),S()(gf,uu.QUANTILE,Jb),S()(gf,uu.QUANTIZE,eE),S()(gf,uu.THRESHOLD,tE),S()(gf,uu.CAT,qv),gf),aR=(LE=Object(Cr.injectable)(),DE=Object(Cr.inject)(Kt.IGlobalConfigService),LE(FE=(Hg=function(){function e(){Ct()(this,e),Ei()(this,"configService",BE,this),S()(this,"scaleCache",{}),S()(this,"scaleOptions",{})}return Bt()(e,[{key:"apply",value:function(t,n){var i=this,s=n.styleAttributeService;t.hooks.init.tap("FeatureScalePlugin",function(){i.scaleOptions=t.getScaleOptions();var c=s.getLayerStyleAttributes(),m=t.getSource().data.dataArray;m.length!==0&&i.caculateScalesForAttributes(c||[],m)}),t.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){i.scaleOptions=t.getScaleOptions();var c=s.getLayerStyleAttributes(),m=t.getSource().data.dataArray;return i.caculateScalesForAttributes(c||[],m),t.layerModelNeedUpdate=!0,!0}),t.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!t.layerModelNeedUpdate){i.scaleOptions=t.getScaleOptions();var c=s.getLayerStyleAttributes();if(c){var m=t.getSource().data.dataArray;if(m.length===0)return;var g=c.filter(function(x){return x.needRescale});g.length&&i.caculateScalesForAttributes(g,m)}}})}},{key:"isNumber",value:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},{key:"caculateScalesForAttributes",value:function(t,n){var i=this;this.scaleCache={},t.forEach(function(s){if(s.scale){var c=s.scale,m=s.name;c.names=i.parseFields(s.scale.field||[]);var g=[];c.names.forEach(function(x){g.push(i.getOrCreateScale(x,s,n))}),g.some(function(x){return x.type===ap.VARIABLE})?(c.type=ap.VARIABLE,g.forEach(function(x){if(!c.callback){var A;if(c.values&&c.values!=="text"){var M;if(((M=x.option)===null||M===void 0?void 0:M.type)==="linear"&&c.values.length>2){var R=x.scale.ticks(c.values.length);m==="color"&&x.scale.domain(R)}x.scale.range(c.values)}else((A=x.option)===null||A===void 0?void 0:A.type)==="cat"&&x.scale.range(x.option.domain)}})):(c.type=ap.CONSTANT,c.defaultValues=g.map(function(x,A){return x.scale(c.names[A])})),c.scalers=g.map(function(x){return{field:x.field,func:x.scale,option:x.option}}),s.needRescale=!1}})}},{key:"getOrCreateScale",value:function(t,n,i){var s,c=[t,n.name].join("_"),m=(s=n.scale)===null||s===void 0?void 0:s.values,g=this.createScale(t,n.name,m,i);return g}},{key:"parseFields",value:function(t){return Array.isArray(t)?t:Ba()(t)?t.split("*"):[t]}},{key:"createScale",value:function(t,n,i,s){var c,m,g=this.scaleOptions[n]&&((c=this.scaleOptions[n])===null||c===void 0?void 0:c.field)===t?this.scaleOptions[n]:this.scaleOptions[t],x={field:t,scale:void 0,type:ap.VARIABLE,option:g};if(!s||!s.length)return g&&g.type?x.scale=this.createDefaultScale(g):(x.scale=qv([t]),x.type=ap.CONSTANT),x;var A=(m=s.find(function(F){return!wh()(F[t])}))===null||m===void 0?void 0:m[t];if(this.isNumber(t)||wh()(A)&&!g)x.scale=qv([t]),x.type=ap.CONSTANT;else{var M=g&&g.type||this.getDefaultType(A);i==="text"&&(M=uu.CAT);var R=this.createDefaultScaleConfig(M,t,s);Object.assign(R,g),x.scale=this.createDefaultScale(R),x.option=R}return x}},{key:"getDefaultType",value:function(t){var n=uu.LINEAR;return typeof t=="string"&&(n=nR.test(t)?uu.TIME:uu.CAT),n}},{key:"createDefaultScaleConfig",value:function(t,n,i){var s={type:t},c=(i==null?void 0:i.map(function(m){return m[n]}))||[];return t!==uu.CAT&&t!==uu.QUANTILE?s.domain=lb(c):t===uu.CAT?s.domain=o_()(c):t===uu.QUANTILE&&(s.domain=c),s}},{key:"createDefaultScale",value:function(t){var n=t.type,i=t.domain,s=iR[n]();return i&&s.domain(i),s}}]),e}(),BE=yi()(Hg.prototype,"configService",[DE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hg))||FE),NE,zE,UE,jE,h0,VE,GE;function HE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function oR(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?HE(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):HE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var sR=(NE=Object(Cr.injectable)(),zE=Object(Cr.inject)(Kt.ICameraService),UE=Object(Cr.inject)(Kt.IRendererService),NE(jE=(h0=function(){function e(){Ct()(this,e),Ei()(this,"cameraService",VE,this),Ei()(this,"rendererService",GE,this)}return Bt()(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){t.models.forEach(function(n){n.addUniforms(oR({},t.layerModel.getAnimateUniforms()))})})}}]),e}(),VE=yi()(h0.prototype,"cameraService",[zE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GE=yi()(h0.prototype,"rendererService",[UE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h0))||jE),WE,ZE,uR=(WE=Object(Cr.injectable)(),WE(ZE=function(){function e(){Ct()(this,e)}return Bt()(e,[{key:"apply",value:function(t){t.hooks.init.tap("LayerModelPlugin",function(){t.prepareBuildModel(),t.buildModels(),t.styleNeedUpdate=!1}),t.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return t.prepareBuildModel(),t.clearModels(),t.buildModels(),t.layerModelNeedUpdate=!1,!1})}}]),e}())||ZE),XE,YE,lR=(XE=Object(Cr.injectable)(),XE(YE=function(){function e(){Ct()(this,e)}return Bt()(e,[{key:"apply",value:function(t){t.hooks.afterInit.tap("LayerStylePlugin",function(){t.updateLayerConfig({});var n=t.getLayerConfig(),i=n.autoFit,s=n.fitBoundsOptions;i&&setTimeout(function(){t.fitBounds(s)},100)})}}]),e}())||YE),KE,$E,cR=["type"];function qE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function om(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?qE(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):qE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var QE={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},fR={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},hR={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},pR={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},O6=["ambient","diffuse","specular"];function dR(e){var r={u_DirectionalLights:new Array(3).fill(om({},hR)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(om({},pR)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[fR]),e.forEach(function(t,n){var i=t.type,s=i===void 0?"directional":i,c=Ah()(t,cR),m=QE[s].lights,g=QE[s].num,x=r[g];r[m][x]=om(om({},r[m][x]),c),r[g]++}),r}var vR=(KE=Object(Cr.injectable)(),KE($E=function(){function e(){Ct()(this,e)}return Bt()(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LightingPlugin",function(){var n=t.getLayerConfig(),i=n.enableLighting;i&&t.models.forEach(function(s){return s.addUniforms(om({},dR()))})})}}]),e}())||$E),JE,e2,p0={NONE:0,ENCODE:1,HIGHLIGHT:2},mR=(JE=Object(Cr.injectable)(),JE(e2=function(){function e(){Ct()(this,e)}return Bt()(e,[{key:"apply",value:function(t,n){var i=n.rendererService,s=n.styleAttributeService;t.hooks.init.tap("PixelPickingPlugin",function(){var c=!0;s.registerStyleAttribute({name:"pickingColor",type:mi.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:ce.FLOAT},size:3,update:function(g,x){var A=g.id;return c?cn(A):[0,0,0]}}})}),t.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var c=t.getLayerConfig(),m=c.enablePicking;m&&t.isVisible()&&t.models.forEach(function(g){return g.addUniforms({u_PickingStage:p0.ENCODE})})}),t.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var c=t.getLayerConfig(),m=c.enablePicking;m&&t.isVisible()&&t.models.forEach(function(g){return g.addUniforms({u_PickingStage:p0.HIGHLIGHT})})}),t.hooks.beforeHighlight.tap("PixelPickingPlugin",function(c){var m=t.getLayerConfig(),g=m.highlightColor,x=m.activeMix,A=x===void 0?0:x,M=typeof g=="string"?xr(g):g||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:Hr(new Uint8Array(c))}),t.models.forEach(function(R){return R.addUniforms({u_PickingStage:p0.HIGHLIGHT,u_PickingColor:c,u_HighlightColor:M.map(function(F){return F*255}),u_activeMix:A})})}),t.hooks.beforeSelect.tap("PixelPickingPlugin",function(c){var m=t.getLayerConfig(),g=m.selectColor,x=m.selectMix,A=x===void 0?0:x,M=typeof g=="string"?xr(g):g||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:Hr(new Uint8Array(c))}),t.models.forEach(function(R){return R.addUniforms({u_PickingStage:p0.HIGHLIGHT,u_PickingColor:c,u_HighlightColor:M.map(function(F){return F*255}),u_activeMix:A,u_CurrentSelectedId:c,u_SelectColor:M.map(function(F){return F*255}),u_EnableSelect:1})})})}}]),e}())||e2),t2,r2,gR=(t2=Object(Cr.injectable)(),t2(r2=function(){function e(){Ct()(this,e)}return Bt()(e,[{key:"apply",value:function(t,n){var i=this,s=n.styleAttributeService;t.hooks.init.tap("RegisterStyleAttributePlugin",function(){i.registerBuiltinAttributes(s)})}},{key:"registerBuiltinAttributes",value:function(t){t.registerStyleAttribute({name:"position",type:mi.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:ce.FLOAT},size:3,update:function(i,s,c){return c.length===2?[c[0],c[1],0]:[c[0],c[1],c[2]]}}}),t.registerStyleAttribute({name:"filter",type:mi.Attribute,descriptor:{name:"filter",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(i,s){var c=i.filter;return c?[1]:[0]}}}),t.registerStyleAttribute({name:"color",type:mi.Attribute,descriptor:{name:"a_Color",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:4,update:function(i,s){var c=i.color;return!c||!c.length?[1,1,1,1]:c}}}),t.registerStyleAttribute({name:"vertexId",type:mi.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:ce.DYNAMIC_DRAW,data:[],type:ce.FLOAT},size:1,update:function(i,s,c,m){return[s]}}})}}]),e}())||r2),n2,i2,a2,o2,s2,u2,Qd,l2,c2,f2,h2,yR=(n2=Object(Cr.injectable)(),i2=Object(Cr.inject)(Kt.ICameraService),a2=Object(Cr.inject)(Kt.ICoordinateSystemService),o2=Object(Cr.inject)(Kt.IRendererService),s2=Object(Cr.inject)(Kt.IMapService),n2(u2=(Qd=function(){function e(){Ct()(this,e),Ei()(this,"cameraService",l2,this),Ei()(this,"coordinateSystemService",c2,this),Ei()(this,"rendererService",f2,this),Ei()(this,"mapService",h2,this)}return Bt()(e,[{key:"apply",value:function(t){var n=this,i=this.mapService.version,s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],c=[0,0];t.hooks.beforeRender.tap("ShaderUniformPlugin",function(){n.coordinateSystemService.refresh(),i==="GAODE2.x"&&(s=n.mapService.map.customCoords.getMVPMatrix(),c=n.mapService.getCustomCoordCenter());var m=n.rendererService.getViewportSize(),g=m.width,x=m.height;t.models.forEach(function(A){var M;A.addUniforms((M={},S()(M,Xp.ProjectionMatrix,n.cameraService.getProjectionMatrix()),S()(M,Xp.ViewMatrix,n.cameraService.getViewMatrix()),S()(M,Xp.ViewProjectionMatrix,n.cameraService.getViewProjectionMatrix()),S()(M,Xp.Zoom,n.cameraService.getZoom()),S()(M,Xp.ZoomScale,n.cameraService.getZoomScale()),S()(M,Xp.FocalDistance,n.cameraService.getFocalDistance()),S()(M,Xp.CameraPosition,n.cameraService.getCameraPosition()),S()(M,Zf.CoordinateSystem,n.coordinateSystemService.getCoordinateSystem()),S()(M,Zf.ViewportCenter,n.coordinateSystemService.getViewportCenter()),S()(M,Zf.ViewportCenterProjection,n.coordinateSystemService.getViewportCenterProjection()),S()(M,Zf.PixelsPerDegree,n.coordinateSystemService.getPixelsPerDegree()),S()(M,Zf.PixelsPerDegree2,n.coordinateSystemService.getPixelsPerDegree2()),S()(M,Zf.PixelsPerMeter,n.coordinateSystemService.getPixelsPerMeter()),S()(M,Zf.Mvp,s),S()(M,"u_SceneCenterMKT",c),S()(M,"u_ViewportSize",[g,x]),S()(M,"u_ModelMatrix",n.cameraService.getModelMatrix()),S()(M,"u_DevicePixelRatio",Kn.devicePixelRatio),S()(M,"u_PickingBuffer",t.getLayerConfig().pickingBuffer||0),S()(M,"u_shaderPick",Number(t.getShaderPickStat())),M))})})}}]),e}(),l2=yi()(Qd.prototype,"cameraService",[i2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c2=yi()(Qd.prototype,"coordinateSystemService",[a2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f2=yi()(Qd.prototype,"rendererService",[o2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h2=yi()(Qd.prototype,"mapService",[s2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qd))||u2),p2,d2,_R=(p2=Object(Cr.injectable)(),p2(d2=function(){function e(){Ct()(this,e)}return Bt()(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("UpdateModelPlugin",function(){t.layerModel&&t.layerModel.needUpdate()})}}]),e}())||d2),v2,m2,xR=(v2=Object(Cr.injectable)(),v2(m2=function(){function e(){Ct()(this,e)}return Bt()(e,[{key:"apply",value:function(t,n){var i=this,s=n.styleAttributeService;t.hooks.init.tap("UpdateStyleAttributePlugin",function(){i.initStyleAttribute(t,{styleAttributeService:s})}),t.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){t.layerModelNeedUpdate||i.updateStyleAtrribute(t,{styleAttributeService:s})})}},{key:"updateStyleAtrribute",value:function(t,n){var i=n.styleAttributeService,s=i.getLayerStyleAttributes()||[],c=i.getLayerStyleAttribute("filter"),m=i.getLayerStyleAttribute("shape");if(c&&c.needRegenerateVertices){t.layerModelNeedUpdate=!0,s.forEach(function(g){return g.needRegenerateVertices=!1});return}s.filter(function(g){return g.needRegenerateVertices}).forEach(function(g){i.updateAttributeByFeatureRange(g.name,t.getEncodedData(),g.featureRange.startIndex,g.featureRange.endIndex),g.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(t,n){var i=n.styleAttributeService,s=i.getLayerStyleAttributes()||[];s.filter(function(c){return c.needRegenerateVertices}).forEach(function(c){i.updateAttributeByFeatureRange(c.name,t.getEncodedData(),c.featureRange.startIndex,c.featureRange.endIndex),c.needRegenerateVertices=!1})}}]),e}())||m2);ec.bind(Kt.ILayerPlugin).to(_5).inRequestScope(),ec.bind(Kt.ILayerPlugin).to(gR).inRequestScope(),ec.bind(Kt.ILayerPlugin).to(aR).inRequestScope(),ec.bind(Kt.ILayerPlugin).to(y5).inRequestScope(),ec.bind(Kt.ILayerPlugin).to(lR).inRequestScope(),ec.bind(Kt.ILayerPlugin).to(xR).inRequestScope(),ec.bind(Kt.ILayerPlugin).to(_R).inRequestScope(),ec.bind(Kt.ILayerPlugin).to(IT).inRequestScope(),ec.bind(Kt.ILayerPlugin).to(yR).inRequestScope(),ec.bind(Kt.ILayerPlugin).to(sR).inRequestScope(),ec.bind(Kt.ILayerPlugin).to(vR).inRequestScope(),ec.bind(Kt.ILayerPlugin).to(mR).inRequestScope(),ec.bind(Kt.ILayerPlugin).to(uR).inRequestScope();var I6="2.7.18",g2,Wg,y2;function _2(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function x2(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?_2(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_2(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var d0=(g2=ag(Kt.IGlobalConfigService),Wg=function(){function e(r){Ct()(this,e),Ei()(this,"configService",y2,this),S()(this,"config",void 0),this.config=r}return Bt()(e,[{key:"setContainer",value:function(t,n,i,s){t.bind(Kt.MapConfig).toConstantValue(x2(x2({},this.config),{},{id:n,canvas:i,hasBaseMap:s})),t.bind(Kt.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),e}(),y2=yi()(Wg.prototype,"configService",[g2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wg),bR=w("sXyB"),v0=w.n(bR),ER=w("hi0z"),b2=w.n(ER);function E2(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function S2(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?E2(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):E2(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function m0(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r={top:0,right:0,bottom:0,left:0};if(typeof e=="number")return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(e.length===4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]}}return S2(S2({},r),e)}var C2={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},A2=Math.PI/180,SR=function(){function e(){Ct()(this,e),S()(this,"projectionMatrix",B.create()),S()(this,"viewMatrix",B.create()),S()(this,"viewProjectionMatrix",B.create()),S()(this,"ViewProjectionMatrixUncentered",B.create()),S()(this,"viewUncenteredMatrix",B.create()),S()(this,"zoom",void 0),S()(this,"center",void 0)}return Bt()(e,[{key:"syncWithMapCamera",value:function(t){var n=t.zoom,i=n===void 0?1:n,s=t.pitch,c=s===void 0?0:s,m=t.bearing,g=m===void 0?0:m,x=t.center,A=x===void 0?[0,0]:x,M=t.offsetOrigin,R=M===void 0?[0,0]:M,F=t.cameraHeight,Y=F===void 0?1:F,ie=t.aspect,le=ie===void 0?1:ie,Ae=t.near,Xe=Ae===void 0?.1:Ae,nt=t.far,at=nt===void 0?1e3:nt,It=t.fov,Ot=It===void 0?0:It;this.zoom=i,this.center=A;var Ut=c*A2,$t=(360-g)*A2;B.perspective(this.projectionMatrix,Ot,le,Xe,at);var Tr=z.fromValues(Y*Math.sin(Ut)*Math.sin($t),-Y*Math.sin(Ut)*Math.cos($t),Y*Math.cos(Ut)),Dr=z.fromValues(-Math.cos(Ut)*Math.sin($t),Math.cos(Ut)*Math.cos($t),Math.sin(Ut));B.lookAt(this.viewMatrix,Tr,z.fromValues(0,0,0),Dr),this.viewUncenteredMatrix=B.clone(this.viewMatrix),B.translate(this.viewMatrix,this.viewMatrix,z.fromValues(-R[0],R[1],0)),B.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),B.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var t=ri()(this.center,2),n=t[0],i=t[1];return[n,i]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,n){var i=85.0511287798,s=Math.max(Math.min(i,t[1]),-i),c=256<<20,m=Math.PI/180,g=t[0]*m,x=s*m;x=Math.log(Math.tan(Math.PI/4+x/2));var A=.5/Math.PI,M=.5,R=-.5/Math.PI;return m=.5,g=c*(A*g+M)-215440491,x=-(c*(R*x+m)-106744817),[g,x]}}]),e}(),CR=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],w2,T2,M2,P2,O2,I2,Jd,R2,k2,L2,D2;function F2(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function AR(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?F2(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F2(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function wR(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}wR(`.amap-logo{
 display: none !important;
}
`);var TR=0;window.forceWebGL=!0;var B2="15cd8a57710d40c9b7c0e3cc120f1200",MR="1.4.15",PR="amap-script",Zg=!1,g0=[],OR=12,IR=(w2=Object(Cr.injectable)(),T2=Object(Cr.inject)(Kt.IGlobalConfigService),M2=Object(Cr.inject)(Kt.MapConfig),P2=Object(Cr.inject)(Kt.ICoordinateSystemService),O2=Object(Cr.inject)(Kt.IEventEmitter),w2(I2=(Jd=function(){function e(){var r=this;Ct()(this,e),S()(this,"version",eh["GAODE1.x"]),S()(this,"map",void 0),S()(this,"dragging",!1),S()(this,"bgColor","rgba(0, 0, 0, 0)"),Ei()(this,"configService",R2,this),Ei()(this,"config",k2,this),Ei()(this,"coordinateSystemService",L2,this),Ei()(this,"eventEmitter",D2,this),S()(this,"markerContainer",void 0),S()(this,"$mapContainer",void 0),S()(this,"viewport",void 0),S()(this,"cameraChangedCallback",void 0),S()(this,"handleCameraChanged",function(t){var n=t.camera,i=n.fov,s=n.near,c=n.far,m=n.height,g=n.pitch,x=n.rotation,A=n.aspect,M=n.position,R=r.getCenter(),F=R.lng,Y=R.lat;if(r.emit("mapchange"),r.cameraChangedCallback){r.viewport.syncWithMapCamera({aspect:A,bearing:360-x,far:c,fov:i,cameraHeight:m,near:s,pitch:g,zoom:r.map.getZoom()-1,center:[F,Y],offsetOrigin:[M.x,M.y]});var ie=r.config.offsetZoom,le=ie===void 0?OR:ie;r.viewport.getZoom()>le?r.coordinateSystemService.setCoordinateSystem(Vs.P20_OFFSET):r.coordinateSystemService.setCoordinateSystem(Vs.P20),r.cameraChangedCallback(r.viewport)}})}return Bt()(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"addMarkerContainer",value:function(){var t=this.map.getContainer();if(t!==null){var n=t.getElementsByClassName("amap-maps")[0];this.markerContainer=N.create("div","l7-marker-container",n)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,n){zd.indexOf(t)!==-1?this.eventEmitter.on(t,n):this.map.on(t,n)}},{key:"off",value:function(t,n){zd.indexOf(t)!==-1?this.eventEmitter.off(t,n):this.map.off(t,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var t;return(t=this.map.getContainer())===null||t===void 0?void 0:t.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var t=this.map.getSize();return[t.getWidth(),t.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(t){return this.map.setZoom(t+1)}},{key:"getCenter",value:function(t){if(t!=null&&t.padding){var n=this.getCenter(),i=this.getSize(),s=ri()(i,2),c=s[0],m=s[1],g=m0(t.padding),x=this.lngLatToPixel([n.lng,n.lat]),A=[(g.right-g.left)/2,(g.bottom-g.top)/2],M=this.pixelToLngLat([x.x-A[0],x.y-A[1]]);return M}var R=this.map.getCenter();return{lng:R.getLng(),lat:R.getLat()}}},{key:"setCenter",value:function(t,n){if(n!=null&&n.padding){var i=m0(n.padding),s=this.lngLatToPixel(t),c=[(i.right-i.left)/2,(i.bottom-i.top)/2],m=this.pixelToLngLat([s.x+c[0],s.y+c[1]]);this.map.setCenter([m.lng,m.lat])}else this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var t=this.map.getBounds().toBounds(),n=t.getNorthEast(),i=t.getSouthWest(),s=this.getCenter(),c=s.lng>n.getLng()||s.lng<i.getLng()?180-n.getLng():n.getLng(),m=s.lng<i.getLng()?i.getLng()-180:i.getLng();return[[m,i.getLat()],[c,n.getLat()]]}},{key:"getMinZoom",value:function(){var t=this.map.get("zooms");return t[0]-1}},{key:"getMaxZoom",value:function(){var t=this.map.get("zooms");return t[1]-1}},{key:"setRotation",value:function(t){return this.map.setRotation(t)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(t,n)}},{key:"fitBounds",value:function(t){this.map.setBounds(new AMap.Bounds([t[0][0],t[0][1],t[1][0],t[1][1]]))}},{key:"setZoomAndCenter",value:function(t,n){this.map.setZoomAndCenter(t,n)}},{key:"setMapStyle",value:function(t){this.map.setMapStyle(this.getMapStyle(t))}},{key:"setMapStatus",value:function(t){this.map.setStatus(t)}},{key:"pixelToLngLat",value:function(t){var n=this.map.pixelToLngLat(new AMap.Pixel(t[0],t[1]));return{lng:n.getLng(),lat:n.getLat()}}},{key:"lngLatToPixel",value:function(t){var n=this.map.lnglatToPixel(new AMap.LngLat(t[0],t[1]));return{x:n.getX(),y:n.getY()}}},{key:"containerToLngLat",value:function(t){var n=new AMap.Pixel(t[0],t[1]),i=this.map.containerToLngLat(n);return{lng:i==null?void 0:i.getLng(),lat:i==null?void 0:i.getLat()}}},{key:"lngLatToContainer",value:function(t){var n=new AMap.LngLat(t[0],t[1]),i=this.map.lngLatToContainer(n);return{x:i.getX(),y:i.getY()}}},{key:"lngLatToCoord",value:function(t){var n=this.map.lngLatToGeodeticCoord(t),i=n.x,s=n.y;return[i,-s]}},{key:"lngLatToMercator",value:function(t,n){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},m=this.viewport.projectFlat(t),g=B.create();return B.translate(g,g,z.fromValues(m[0],m[1],n)),B.scale(g,g,z.fromValues(s[0],s[1],s[2])),B.rotateX(g,g,i[0]),B.rotateY(g,g,i[1]),B.rotateZ(g,g,i[2]),g}},{key:"init",value:function(){var r=as()(la.a.mark(function n(){var i=this,s,c,m,g,x,A,M,R,F,Y,ie,le,Ae,Xe;return la.a.wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return s=this.config,c=s.id,m=s.style,g=m===void 0?"light":m,x=s.minZoom,A=x===void 0?0:x,M=s.maxZoom,R=M===void 0?18:M,F=s.token,Y=F===void 0?B2:F,ie=s.mapInstance,le=s.plugin,Ae=le===void 0?[]:le,Xe=Ah()(s,CR),at.next=3,new Promise(function(It){var Ot=function(){if(ie)i.map=ie,i.$mapContainer=i.map.getContainer(),setTimeout(function(){i.map.on("camerachange",i.handleCameraChanged),It()},30);else{i.$mapContainer=i.creatAmapContainer(c);var $t=AR({mapStyle:i.getMapStyle(g),zooms:[A,R],viewMode:"3D"},Xe);$t.zoom&&($t.zoom+=1);var Tr=new AMap.Map(i.$mapContainer,$t);Tr.on("camerachange",i.handleCameraChanged),i.map=Tr,setTimeout(function(){It()},10)}};!Zg&&!ie?(Y===B2&&console.warn(i.configService.getSceneWarninfo("MapToken")),Zg=!0,Ae.push("Map3D"),b2.a.load({key:Y,version:MR,plugins:Ae}).then(function(Ut){Ot(),g0.length&&(g0.forEach(function($t){return $t()}),g0=[])}).catch(function(Ut){throw new Error(Ut)})):Zg&&window.AMap||ie?Ot():g0.push(Ot)});case 3:this.map.on("dragstart",function(){return i.dragging=!0,""}),this.map.on("dragend",function(){return i.dragging=!1,""}),this.viewport=new SR;case 6:case"end":return at.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"meterToCoord",value:function(t,n){var i=AMap.GeometryUtil.distance(v0()(AMap.LngLat,Pt()(t)),v0()(AMap.LngLat,Pt()(n))),s=this.lngLatToCoord(t),c=ri()(s,2),m=c[0],g=c[1],x=this.lngLatToCoord(n),A=ri()(x,2),M=A[0],R=A[1],F=Math.sqrt(Math.pow(m-M,2)+Math.pow(g-R,2));return F/i}},{key:"exportMap",value:function(t){var n,i=(n=this.getContainer())===null||n===void 0?void 0:n.getElementsByClassName("amap-layer")[0],s=t==="jpg"?i==null?void 0:i.toDataURL("image/jpeg"):i==null?void 0:i.toDataURL("image/png");return s}},{key:"emit",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).emit.apply(n,[t].concat(s))}},{key:"once",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).once.apply(n,[t].concat(s))}},{key:"destroy",value:function(){var t,n;this.map.destroy(),(t=this.$mapContainer)===null||t===void 0||(n=t.parentNode)===null||n===void 0||n.removeChild(this.$mapContainer),delete window.initAMap;var i=document.getElementById(PR);i&&document.head.removeChild(i)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"getMapStyle",value:function(t){return C2[t]?C2[t]:t}},{key:"creatAmapContainer",value:function(t){var n=t;typeof t=="string"&&(n=document.getElementById(t));var i=document.createElement("div");return i.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,i.id="l7_amap_div"+TR++,n.appendChild(i),i}}]),e}(),R2=yi()(Jd.prototype,"configService",[T2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k2=yi()(Jd.prototype,"config",[M2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L2=yi()(Jd.prototype,"coordinateSystemService",[P2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D2=yi()(Jd.prototype,"eventEmitter",[O2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jd))||I2);function RR(e){var r=kR();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function kR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var LR=function(e){Nr()(t,e);var r=RR(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getServiceConstructor",value:function(){return IR}}]),t}(d0);function N2(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function z2(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?N2(Object(t),!0).forEach(function(n){DR(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N2(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function DR(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function FR(e,r){return UR(e)||zR(e,r)||NR(e,r)||BR()}function BR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NR(e,r){if(!!e){if(typeof e=="string")return U2(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return U2(e,r)}}function U2(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function zR(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,m;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(g){s=!0,m=g}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw m}}return n}}function UR(e){if(Array.isArray(e))return e}var jR=se.a.memo(function(e){var r=e.style,t=e.className,n=e.map,i=e.option,s=e.onSceneLoaded,c=e.children,m=Object(Q.useRef)(null),g=Object(Q.useState)(),x=FR(g,2),A=x[0],M=x[1];return Object(Q.useEffect)(function(){var R=new Zv(z2(z2({id:m.current},i),{},{map:new LR(n)}));return R.on("loaded",function(){M(R),s&&s(R)}),function(){R.destroy()}},[]),Object(Q.useEffect)(function(){A&&n.style&&A.setMapStyle(n.style)},[JSON.stringify(n.style)]),Object(Q.useEffect)(function(){A&&n.zoom&&A.setZoom(n.zoom)},[n.zoom]),Object(Q.useEffect)(function(){A&&n.center&&A.setCenter(n.center)},[JSON.stringify(n.center)]),Object(Q.useEffect)(function(){A&&n.pitch&&A.setPitch(n.pitch)},[n.pitch]),Object(Q.useEffect)(function(){A&&n.rotation&&A.setRotation(n.rotation)},[n.rotation]),se.a.createElement(Ce.Provider,{value:A},se.a.createElement("div",{ref:m,className:t,style:r},A&&c))}),R6=jR,VR=w("4ZJM"),sm=w.n(VR),j2=w("1OyB"),V2=w("vuIU"),GR=w("md7G"),HR=w("foSv"),WR=w("Ji7U"),y0=w("JX7q"),Nl=w("ODXe");function um(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function _0(e,r){var t=Zh([],r,e);return Us(t,t,1/t[3]),t}function k6(e,r){var t=e%r;return t<0?r+t:t}function L6(e,r,t){return t*r+(1-t)*e}function dp(e,r){if(!e)throw new Error(r||"viewport-mercator-project: assertion failed.")}var yf=Math.PI,G2=yf/4,Ih=yf/180,H2=180/yf,Xg=512,Yg=4003e4,ZR=1.5;function W2(e){return Math.pow(2,e)}function XR(e){return Math.log2(e)}function x0(e,r){var t=Object(Nl.a)(e,2),n=t[0],i=t[1];dp(Number.isFinite(n)&&Number.isFinite(r)),dp(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude"),r*=Xg;var s=n*Ih,c=i*Ih,m=r*(s+yf)/(2*yf),g=r*(yf-Math.log(Math.tan(G2+c*.5)))/(2*yf);return[m,g]}function Kg(e,r){var t=Object(Nl.a)(e,2),n=t[0],i=t[1];r*=Xg;var s=n/r*(2*yf)-yf,c=2*(Math.atan(Math.exp(yf-i/r*(2*yf)))-G2);return[s*H2,c*H2]}function D6(e){var r=e.latitude;dp(Number.isFinite(r));var t=Math.cos(r*Ih);return XR(Yg*t)-9}function Z2(e){var r=e.latitude,t=e.longitude,n=e.zoom,i=e.scale,s=e.highPrecision,c=s===void 0?!1:s;i=i!==void 0?i:W2(n),dp(Number.isFinite(r)&&Number.isFinite(t)&&Number.isFinite(i));var m={},g=Xg*i,x=Math.cos(r*Ih),A=g/360,M=A/x,R=g/Yg/x;if(m.pixelsPerMeter=[R,-R,R],m.metersPerPixel=[1/R,-1/R,1/R],m.pixelsPerDegree=[A,-M,R],m.degreesPerPixel=[1/A,-1/M,1/R],c){var F=Ih*Math.tan(r*Ih)/x,Y=A*F/2,ie=g/Yg*F,le=ie/M*R;m.pixelsPerDegree2=[0,-Y,ie],m.pixelsPerMeter2=[le,0,le]}return m}function F6(e,r){var t=Object(Nl.a)(e,3),n=t[0],i=t[1],s=t[2],c=Object(Nl.a)(r,3),m=c[0],g=c[1],x=c[2],A=1,M=Z2({longitude:n,latitude:i,scale:A,highPrecision:!0}),R=M.pixelsPerMeter,F=M.pixelsPerMeter2,Y=x0(e,A);Y[0]+=m*(R[0]+F[0]*g),Y[1]+=g*(R[1]+F[1]*g);var ie=Kg(Y,A),le=(s||0)+(x||0);return Number.isFinite(s)||Number.isFinite(x)?[ie[0],ie[1],le]:ie}function YR(e){var r=e.height,t=e.pitch,n=e.bearing,i=e.altitude,s=e.center,c=s===void 0?null:s,m=e.flipY,g=m===void 0?!1:m,x=um();return tn(x,x,[0,0,-i]),sn(x,x,[1,1,1/r]),dn(x,x,-t*Ih),Ii(x,x,n*Ih),g&&sn(x,x,[1,-1,1]),c&&tn(x,x,Oe([],c)),x}function KR(e){var r=e.width,t=e.height,n=e.altitude,i=n===void 0?ZR:n,s=e.pitch,c=s===void 0?0:s,m=e.nearZMultiplier,g=m===void 0?1:m,x=e.farZMultiplier,A=x===void 0?1:x,M=c*Ih,R=Math.atan(.5/i),F=Math.sin(R)*i/Math.sin(Math.PI/2-M-R),Y=Math.cos(Math.PI/2-M)*F+i;return{fov:2*Math.atan(t/2/i),aspect:r/t,focalDistance:i,near:g,far:Y*A}}function $R(e){var r=e.width,t=e.height,n=e.pitch,i=e.altitude,s=e.nearZMultiplier,c=e.farZMultiplier,m=KR({width:r,height:t,altitude:i,pitch:n,nearZMultiplier:s,farZMultiplier:c}),g=m.fov,x=m.aspect,A=m.near,M=m.far,R=io([],g,x,A,M);return R}function qR(e,r){var t=Object(Nl.a)(e,3),n=t[0],i=t[1],s=t[2],c=s===void 0?0:s;return dp(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(c)),_0(r,[n,i,c,1])}function X2(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=Object(Nl.a)(e,3),i=n[0],s=n[1],c=n[2];if(dp(Number.isFinite(i)&&Number.isFinite(s),"invalid pixel coordinate"),Number.isFinite(c)){var m=_0(r,[i,s,c,1]);return m}var g=_0(r,[i,s,0,1]),x=_0(r,[i,s,1,1]),A=g[2],M=x[2],R=A===M?0:((t||0)-A)/(M-A);return La([],g,x,R)}var Y2=um(),QR=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=r.width,n=r.height,i=r.viewMatrix,s=i===void 0?Y2:i,c=r.projectionMatrix,m=c===void 0?Y2:c;Object(j2.a)(this,e),this.width=t||1,this.height=n||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=s,this.projectionMatrix=m;var g=um();ir(g,g,this.projectionMatrix),ir(g,g,this.viewMatrix),this.viewProjectionMatrix=g;var x=um();sn(x,x,[this.width/2,-this.height/2,1]),tn(x,x,[1,-1,0]),ir(x,x,this.viewProjectionMatrix);var A=Mn(um(),x);if(!A)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=x,this.pixelUnprojectionMatrix=A,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(V2.a)(e,[{key:"equals",value:function(t){return t instanceof e?t.width===this.width&&t.height===this.height&&Me(t.projectionMatrix,this.projectionMatrix)&&Me(t.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,s=i===void 0?!0:i,c=this.projectPosition(t),m=qR(c,this.pixelProjectionMatrix),g=Object(Nl.a)(m,2),x=g[0],A=g[1],M=s?A:this.height-A;return t.length===2?[x,M]:[x,M,m[2]]}},{key:"unproject",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,s=i===void 0?!0:i,c=n.targetZ,m=Object(Nl.a)(t,3),g=m[0],x=m[1],A=m[2],M=s?x:this.height-x,R=c&&c*this.pixelsPerMeter,F=X2([g,M,A],this.pixelUnprojectionMatrix,R),Y=this.unprojectPosition(F),ie=Object(Nl.a)(Y,3),le=ie[0],Ae=ie[1],Xe=ie[2];return Number.isFinite(A)?[le,Ae,Xe]:Number.isFinite(c)?[le,Ae,c]:[le,Ae]}},{key:"projectPosition",value:function(t){var n=this.projectFlat(t),i=Object(Nl.a)(n,2),s=i[0],c=i[1],m=(t[2]||0)*this.pixelsPerMeter;return[s,c,m]}},{key:"unprojectPosition",value:function(t){var n=this.unprojectFlat(t),i=Object(Nl.a)(n,2),s=i[0],c=i[1],m=(t[2]||0)/this.pixelsPerMeter;return[s,c,m]}},{key:"projectFlat",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return t}},{key:"unprojectFlat",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return t}}]),e}();function JR(e){var r=e.width,t=e.height,n=e.bounds,i=e.minExtent,s=i===void 0?0:i,c=e.maxZoom,m=c===void 0?24:c,g=e.padding,x=g===void 0?0:g,A=e.offset,M=A===void 0?[0,0]:A,R=Object(Nl.a)(n,2),F=Object(Nl.a)(R[0],2),Y=F[0],ie=F[1],le=Object(Nl.a)(R[1],2),Ae=le[0],Xe=le[1];if(Number.isFinite(x)){var nt=x;x={top:nt,bottom:nt,left:nt,right:nt}}else dp(Number.isFinite(x.top)&&Number.isFinite(x.bottom)&&Number.isFinite(x.left)&&Number.isFinite(x.right));var at=new $g({width:r,height:t,longitude:0,latitude:0,zoom:0}),It=at.project([Y,Xe]),Ot=at.project([Ae,ie]),Ut=[Math.max(Math.abs(Ot[0]-It[0]),s),Math.max(Math.abs(Ot[1]-It[1]),s)],$t=[r-x.left-x.right-Math.abs(M[0])*2,t-x.top-x.bottom-Math.abs(M[1])*2];dp($t[0]>0&&$t[1]>0);var Tr=$t[0]/Ut[0],Dr=$t[1]/Ut[1],Sr=(x.right-x.left)/2/Tr,Sn=(x.bottom-x.top)/2/Dr,Dn=[(Ot[0]+It[0])/2+Sr,(Ot[1]+It[1])/2+Sn],ai=at.unproject(Dn),Ua=at.zoom+Math.log2(Math.abs(Math.min(Tr,Dr)));return{longitude:ai[0],latitude:ai[1],zoom:Math.min(Ua,m)}}var $g=function(e){Object(WR.a)(r,e);function r(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.width,s=n.height,c=n.latitude,m=c===void 0?0:c,g=n.longitude,x=g===void 0?0:g,A=n.zoom,M=A===void 0?0:A,R=n.pitch,F=R===void 0?0:R,Y=n.bearing,ie=Y===void 0?0:Y,le=n.altitude,Ae=le===void 0?1.5:le,Xe=n.nearZMultiplier,nt=n.farZMultiplier;Object(j2.a)(this,r),i=i||1,s=s||1;var at=W2(M);Ae=Math.max(.75,Ae);var It=x0([x,m],at);It[2]=0;var Ot=$R({width:i,height:s,pitch:F,bearing:ie,altitude:Ae,nearZMultiplier:Xe||1/s,farZMultiplier:nt||1.01}),Ut=YR({height:s,center:It,pitch:F,bearing:ie,altitude:Ae,flipY:!0});return t=Object(GR.a)(this,Object(HR.a)(r).call(this,{width:i,height:s,viewMatrix:Ut,projectionMatrix:Ot})),t.latitude=m,t.longitude=x,t.zoom=M,t.pitch=F,t.bearing=ie,t.altitude=Ae,t.scale=at,t.center=It,t.pixelsPerMeter=Z2(Object(y0.a)(Object(y0.a)(t))).pixelsPerMeter[2],Object.freeze(Object(y0.a)(Object(y0.a)(t))),t}return Object(V2.a)(r,[{key:"projectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return x0(n,i)}},{key:"unprojectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Kg(n,i)}},{key:"getMapCenterByLngLatPosition",value:function(n){var i=n.lngLat,s=n.pos,c=X2(s,this.pixelUnprojectionMatrix),m=x0(i,this.scale),g=ye([],m,pi([],c)),x=ye([],this.center,g);return Kg(x,this.scale)}},{key:"getLocationAtPoint",value:function(n){var i=n.lngLat,s=n.pos;return this.getMapCenterByLngLatPosition({lngLat:i,pos:s})}},{key:"fitBounds",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=this.width,c=this.height,m=JR(Object.assign({width:s,height:c,bounds:n},i)),g=m.longitude,x=m.latitude,A=m.zoom;return new r({width:s,height:c,longitude:g,latitude:x,zoom:A})}}]),r}(QR),e4=function(){function e(){Ct()(this,e),S()(this,"viewport",void 0)}return Bt()(e,[{key:"syncWithMapCamera",value:function(t){var n=t.center,i=t.zoom,s=t.pitch,c=t.bearing,m=t.viewportHeight,g=t.viewportWidth;this.viewport=new $g({width:g,height:m,longitude:n&&n[0],latitude:n&&n[1],zoom:i,pitch:s,bearing:c})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,n){return this.viewport.projectFlat(t,n)}}]),e}(),K2={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},t4=["id","attributionControl","style","token","rotation","mapInstance"],$2,q2,Q2,J2,eS,tS,ev,rS,nS,iS,aS;function oS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function r4(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?oS(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):oS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function n4(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}n4(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=sm.a;var sS={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},i4=0,a4=12,uS="pk.eyJ1IjoibHp4dWUiLCJhIjoiY2tvaWZuM2s4MWZuYjJ1dHI5ZGduYTlrdiJ9.DQCfMRbZzx0VSwecQ69McA",o4=($2=Object(Cr.injectable)(),q2=Object(Cr.inject)(Kt.MapConfig),Q2=Object(Cr.inject)(Kt.IGlobalConfigService),J2=Object(Cr.inject)(Kt.ICoordinateSystemService),eS=Object(Cr.inject)(Kt.IEventEmitter),$2(tS=(ev=function(){function e(){var r=this;Ct()(this,e),S()(this,"version",eh.MAPBOX),S()(this,"map",void 0),S()(this,"dragging",!1),S()(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),Ei()(this,"config",rS,this),Ei()(this,"configService",nS,this),Ei()(this,"coordinateSystemService",iS,this),Ei()(this,"eventEmitter",aS,this),S()(this,"viewport",void 0),S()(this,"markerContainer",void 0),S()(this,"cameraChangedCallback",void 0),S()(this,"$mapContainer",void 0),S()(this,"handleCameraChanged",function(){var t=r.map.getCenter().wrap(),n=t.lat,i=t.lng;r.emit("mapchange"),r.viewport.syncWithMapCamera({bearing:r.map.getBearing(),center:[i,n],viewportHeight:r.map.transform.height,pitch:r.map.getPitch(),viewportWidth:r.map.transform.width,zoom:r.map.getZoom(),cameraHeight:0});var s=r.config.offsetZoom,c=s===void 0?a4:s;r.viewport.getZoom()>c?r.coordinateSystemService.setCoordinateSystem(Vs.LNGLAT_OFFSET):r.coordinateSystemService.setCoordinateSystem(Vs.LNGLAT),r.cameraChangedCallback(r.viewport)})}return Bt()(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"addMarkerContainer",value:function(){var t=this.map.getCanvasContainer();this.markerContainer=N.create("div","l7-marker-container",t),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,n){zd.indexOf(t)!==-1?this.eventEmitter.on(t,n):this.map.on(sS[t]||t,n)}},{key:"off",value:function(t,n){this.map.off(sS[t]||t,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var t=this.map.transform;return[t.width,t.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(t){return this.map.setZoom(t)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(t){this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(t){this.map.setBearing(t)}},{key:"zoomIn",value:function(t,n){this.map.zoomIn(t,n)}},{key:"zoomOut",value:function(t,n){this.map.zoomOut(t,n)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(t,n){this.panTo([t,n])}},{key:"fitBounds",value:function(t,n){this.map.fitBounds(t,n)}},{key:"setMaxZoom",value:function(t){this.map.setMaxZoom(t)}},{key:"setMinZoom",value:function(t){this.map.setMinZoom(t)}},{key:"setMapStatus",value:function(t){t.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),t.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),t.dragEnable===!1&&this.map.dragPan.disable(),t.dragEnable===!0&&this.map.dragPan.enable(),t.rotateEnable===!1&&this.map.dragRotate.disable(),t.rotateEnable===!0&&this.map.dragRotate.enable(),t.keyboardEnable===!1&&this.map.keyboard.disable(),t.keyboardEnable===!0&&this.map.keyboard.enable(),t.zoomEnable===!1&&this.map.scrollZoom.disable(),t.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(t,n){this.map.flyTo({zoom:t,center:n})}},{key:"setMapStyle",value:function(t){this.map.setStyle(this.getMapStyle(t))}},{key:"pixelToLngLat",value:function(t){return this.map.unproject(t)}},{key:"lngLatToPixel",value:function(t){return this.map.project(t)}},{key:"containerToLngLat",value:function(t){return this.map.unproject(t)}},{key:"lngLatToContainer",value:function(t){return this.map.project(t)}},{key:"lngLatToCoord",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{x:0,y:0,z:0},i=this.lngLatToMercator(t,0),s=i.x,c=i.y;return[s-n.x,c-n.y]}},{key:"lngLatToMercator",value:function(t,n){var i=window.mapboxgl.MercatorCoordinate.fromLngLat(t,n),s=i.x,c=s===void 0?0:s,m=i.y,g=m===void 0?0:m,x=i.z,A=x===void 0?0:x;return{x:c,y:g,z:A}}},{key:"getModelMatrix",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},m=window.mapboxgl.MercatorCoordinate.fromLngLat(t,n),g=m.meterInMercatorCoordinateUnits(),x=B.create();return B.translate(x,x,z.fromValues(m.x-c.x,m.y-c.y,m.z||0-c.z)),B.scale(x,x,z.fromValues(g*s[0],-g*s[1],g*s[2])),B.rotateX(x,x,i[0]),B.rotateY(x,x,i[1]),B.rotateZ(x,x,i[2]),x}},{key:"init",value:function(){var r=as()(la.a.mark(function n(){var i=this,s,c,m,g,x,A,M,R,F,Y,ie,le,Ae;return la.a.wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:s=this.config,c=s.id,m=c===void 0?"map":c,g=s.attributionControl,x=g===void 0?!1:g,A=s.style,M=A===void 0?"light":A,R=s.token,F=R===void 0?uS:R,Y=s.rotation,ie=Y===void 0?0:Y,le=s.mapInstance,Ae=Ah()(s,t4),this.viewport=new e4,!le&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),F===uS&&M!=="blank"&&!window.mapboxgl.accessToken&&!le&&console.warn(this.configService.getSceneWarninfo("MapToken")),!le&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=F),le?(this.map=le,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(m),this.map=new window.mapboxgl.Map(r4({container:this.$mapContainer,style:this.getMapStyle(M),attributionControl:x,bearing:ie},Ae))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.map.on("dragstart",function(){return i.dragging=!0,""}),this.map.on("dragend",function(){return i.dragging=!1,""}),this.handleCameraChanged();case 11:case"end":return nt.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"destroy",value:function(){var t,n;(t=this.$mapContainer)===null||t===void 0||(n=t.parentNode)===null||n===void 0||n.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).emit.apply(n,[t].concat(s))}},{key:"once",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).once.apply(n,[t].concat(s))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"meterToCoord",value:function(t,n){var i=new sm.a.LngLat(t[0],t[1]),s=new sm.a.LngLat(n[0],n[1]),c=i.distanceTo(s),m=sm.a.MercatorCoordinate.fromLngLat({lng:t[0],lat:t[1]}),g=sm.a.MercatorCoordinate.fromLngLat({lng:n[0],lat:n[1]}),x=m.x,A=m.y,M=g.x,R=g.y,F=Math.sqrt(Math.pow(x-M,2)+Math.pow(A-R,2))*4194304*2;return F/c}},{key:"exportMap",value:function(t){var n=this.map.getCanvas(),i=t==="jpg"?n==null?void 0:n.toDataURL("image/jpeg"):n==null?void 0:n.toDataURL("image/png");return i}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"creatAmapContainer",value:function(t){var n=t;typeof t=="string"&&(n=document.getElementById(t));var i=document.createElement("div");return i.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,i.id="l7_mapbox_div"+i4++,n.appendChild(i),i}},{key:"getMapStyle",value:function(t){return typeof t!="string"?t:K2[t]?K2[t]:t}}]),e}(),rS=yi()(ev.prototype,"config",[q2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nS=yi()(ev.prototype,"configService",[Q2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iS=yi()(ev.prototype,"coordinateSystemService",[J2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aS=yi()(ev.prototype,"eventEmitter",[eS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ev))||tS);function s4(e){var r=u4();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function u4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function l4(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}l4(`.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var c4=function(e){Nr()(t,e);var r=s4(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getServiceConstructor",value:function(){return o4}}]),t}(d0);function lS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function cS(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?lS(Object(t),!0).forEach(function(n){f4(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):lS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function f4(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function h4(e,r){return m4(e)||v4(e,r)||d4(e,r)||p4()}function p4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d4(e,r){if(!!e){if(typeof e=="string")return fS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return fS(e,r)}}function fS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function v4(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,m;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(g){s=!0,m=g}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw m}}return n}}function m4(e){if(Array.isArray(e))return e}var g4=se.a.memo(function(e){var r=e.style,t=e.className,n=e.map,i=e.option,s=e.onSceneLoaded,c=Object(Q.createRef)(),m=Object(Q.useState)(),g=h4(m,2),x=g[0],A=g[1];return Object(Q.useEffect)(function(){var M=new Zv(cS(cS({id:c.current},i),{},{map:new c4(n)}));return M.on("loaded",function(){A(M),s&&s(M)}),function(){M.destroy()}},[]),Object(Q.useEffect)(function(){x&&n.style&&x.setMapStyle(n.style)},[JSON.stringify(n.style)]),Object(Q.useEffect)(function(){x&&n.zoom&&x.setZoom(n.zoom)},[n.zoom]),Object(Q.useEffect)(function(){x&&n.center&&x.setCenter(n.center)},[JSON.stringify(n.center)]),Object(Q.useEffect)(function(){x&&n.pitch!==void 0&&x.setPitch(n.pitch||0)},[n.pitch]),Object(Q.useEffect)(function(){x&&n.rotation&&x.setRotation(n.rotation)},[n.rotation]),se.a.createElement(Ce.Provider,{value:x},Object(Q.createElement)("div",{ref:c,style:r,className:t},x&&e.children))}),y4=g4,hS={dark:"amap://styles/dark",light:"amap://styles/light",normal:"amap://styles/normal",blank:"amap://styles/1a91e7ec761981d85b35f3099ff781a3"},_4=function(){function e(){Ct()(this,e),S()(this,"projectionMatrix",B.create()),S()(this,"viewMatrix",B.create()),S()(this,"viewProjectionMatrix",B.create()),S()(this,"ViewProjectionMatrixUncentered",B.create()),S()(this,"viewUncenteredMatrix",B.create()),S()(this,"zoom",void 0),S()(this,"center",void 0)}return Bt()(e,[{key:"syncWithMapCamera",value:function(t){var n=t.zoom,i=n===void 0?1:n,s=t.center,c=s===void 0?[0,0]:s,m=t.offsetOrigin,g=m===void 0?[0,0]:m,x=t.cameraPosition,A=x===void 0?[0,0,0]:x,M=t.up,R=M===void 0?[0,1,0]:M,F=t.lookAt,Y=F===void 0?[0,0,0]:F,ie=t.aspect,le=ie===void 0?1:ie,Ae=t.near,Xe=Ae===void 0?.1:Ae,nt=t.far,at=nt===void 0?1e3:nt,It=t.fov,Ot=It===void 0?45:It;this.zoom=i,this.center=c,B.perspective(this.projectionMatrix,Ot/180*Math.PI,le,Xe,at);var Ut=z.fromValues.apply(z,Pt()(A)),$t=z.fromValues.apply(z,Pt()(Y)),Tr=z.fromValues.apply(z,Pt()(R));B.lookAt(this.viewMatrix,Ut,$t,Tr),this.viewUncenteredMatrix=B.clone(this.viewMatrix),B.translate(this.viewMatrix,this.viewMatrix,z.fromValues(-g[0],g[1],0)),B.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),B.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var t=ri()(this.center,2),n=t[0],i=t[1];return[n,i]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,n){var i=85.0511287798,s=Math.max(Math.min(i,t[1]),-i),c=256<<20,m=Math.PI/180,g=t[0]*m,x=s*m;x=Math.log(Math.tan(Math.PI/4+x/2));var A=.5/Math.PI,M=.5,R=-.5/Math.PI;return m=.5,g=c*(A*g+M)-215440491,x=-(c*(R*x+m)-106744817),[g,x]}}]),e}(),x4=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],pS,dS,vS,mS,gS,yS,tv,_S,xS,bS,ES;function SS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function b4(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?SS(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):SS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function E4(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}E4(`.amap-logo{
 display: none !important;
}
`);var S4=0;window.forceWebGL=!0;var CS="ff533602d57df6f8ab3b0fea226ae52f",C4="2.0",A4="amap-script",qg=!1,b0=[],w4=(pS=Object(Cr.injectable)(),dS=Object(Cr.inject)(Kt.IGlobalConfigService),vS=Object(Cr.inject)(Kt.MapConfig),mS=Object(Cr.inject)(Kt.ICoordinateSystemService),gS=Object(Cr.inject)(Kt.IEventEmitter),pS(yS=(tv=function(){function e(){var r=this;Ct()(this,e),S()(this,"version",eh["GAODE2.x"]),S()(this,"map",void 0),S()(this,"dragging",!1),S()(this,"sceneCenter",void 0),S()(this,"sceneCenterMKT",void 0),S()(this,"bgColor","rgba(0, 0, 0, 0)"),Ei()(this,"configService",_S,this),Ei()(this,"config",xS,this),Ei()(this,"coordinateSystemService",bS,this),Ei()(this,"eventEmitter",ES,this),S()(this,"markerContainer",void 0),S()(this,"$mapContainer",void 0),S()(this,"viewport",void 0),S()(this,"cameraChangedCallback",void 0),S()(this,"handleViewChanged",function(t){var n=r.map.customCoords.getCameraParams(),i=n.fov,s=n.near,c=n.far,m=n.aspect,g=n.position,x=n.lookAt,A=n.up;r.emit("mapchange");var M=t.zoom,R=r.map.customCoords.getCenter();r.cameraChangedCallback&&(r.viewport.syncWithMapCamera({aspect:m,far:c,fov:i,cameraPosition:g,lookAt:x,up:A,near:s,zoom:M-1,center:R,offsetOrigin:[g[0],g[1]]}),r.coordinateSystemService.setCoordinateSystem(Vs.P20_2),r.cameraChangedCallback(r.viewport))})}return Bt()(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"setCustomCoordCenter",value:function(t){var n;this.sceneCenter=t,this.sceneCenterMKT=(n=this.map.getProjection()).project.apply(n,Pt()(this.sceneCenter))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMKT}},{key:"lngLatToCoord",value:function(t){var n=this.map.getProjection(),i=n.project;return this.sceneCenter||(this.map.customCoords.setCenter(t),this.setCustomCoordCenter(t)),this._sub(i(t[0],t[1]),this.sceneCenterMKT)}},{key:"lngLatToCoords",value:function(t){var n=this;return t.map(function(i){return typeof i[0]=="number"?n.lngLatToCoord(i):i.map(function(s){return n.lngLatToCoord(s)})})}},{key:"addMarkerContainer",value:function(){if(!!this.map){var t=this.map.getContainer();if(t!==null){var n=t.getElementsByClassName("amap-maps")[0];n.style.zIndex="auto",this.markerContainer=N.create("div","l7-marker-container2",n)}}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,n){zd.indexOf(t)!==-1?this.eventEmitter.on(t,n):this.map.on(t,n)}},{key:"off",value:function(t,n){zd.indexOf(t)!==-1?this.eventEmitter.off(t,n):this.map.off(t,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var t;return(t=this.map.getContainer())===null||t===void 0?void 0:t.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var t=this.map.getSize();return[t.getWidth(),t.getHeight()]}},{key:"getType",value:function(){return"amap2"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(t){return this.map.setZoom(t+1)}},{key:"getCenter",value:function(t){if(t!=null&&t.padding){var n=this.getCenter(),i=this.getSize(),s=ri()(i,2),c=s[0],m=s[1],g=m0(t.padding),x=this.lngLatToPixel([n.lng,n.lat]),A=[(g.right-g.left)/2,(g.bottom-g.top)/2],M=this.pixelToLngLat([x.x-A[0],x.y-A[1]]);return M}var R=this.map.getCenter();return{lng:R.getLng(),lat:R.getLat()}}},{key:"setCenter",value:function(t,n){if(n!=null&&n.padding){var i=m0(n.padding),s=this.lngLatToPixel(t),c=[(i.right-i.left)/2,(i.bottom-i.top)/2],m=this.pixelToLngLat([s.x+c[0],s.y+c[1]]);this.map.setCenter([m.lng,m.lat])}else this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var t=this.map.getBounds(),n=t.getNorthEast(),i=t.getSouthWest(),s=this.getCenter(),c=s.lng>n.getLng()||s.lng<i.getLng()?180-n.getLng():n.getLng(),m=s.lng<i.getLng()?i.getLng()-180:i.getLng();return[[m,i.getLat()],[c,n.getLat()]]}},{key:"getMinZoom",value:function(){var t=this.map.getZooms();return t[0]-1}},{key:"getMaxZoom",value:function(){var t=this.map.getZooms();return t[1]-1}},{key:"setRotation",value:function(t){return this.map.setRotation(t)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(t,n)}},{key:"fitBounds",value:function(t){this.map.setBounds(new AMap.Bounds([t[0][0],t[0][1],t[1][0],t[1][1]]))}},{key:"setZoomAndCenter",value:function(t,n){this.map.setZoomAndCenter(t,n)}},{key:"setMapStyle",value:function(t){this.map.setMapStyle(this.getMapStyle(t))}},{key:"setMapStatus",value:function(t){this.map.setStatus(t)}},{key:"pixelToLngLat",value:function(t){var n=this.map.pixelToLngLat(new AMap.Pixel(t[0],t[1]));return{lng:n.getLng(),lat:n.getLat()}}},{key:"lngLatToPixel",value:function(t){var n=this.map.lnglatToPixel(new AMap.LngLat(t[0],t[1]));return{x:n.getX(),y:n.getY()}}},{key:"containerToLngLat",value:function(t){var n=new AMap.Pixel(t[0],t[1]),i=this.map.containerToLngLat(n);return{lng:i==null?void 0:i.getLng(),lat:i==null?void 0:i.getLat()}}},{key:"lngLatToContainer",value:function(t){var n=new AMap.LngLat(t[0],t[1]),i=this.map.lngLatToContainer(n);return{x:i.getX(),y:i.getY()}}},{key:"lngLatToMercator",value:function(t,n){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},m=this.map.customCoords.lngLatToCoord(t),g=B.create();return B.translate(g,g,z.fromValues(m[0],m[1],n)),B.scale(g,g,z.fromValues(s[0],s[1],s[2])),B.rotateX(g,g,i[0]),B.rotateY(g,g,i[1]),B.rotateZ(g,g,i[2]),g}},{key:"init",value:function(){var r=as()(la.a.mark(function n(){var i=this,s,c,m,g,x,A,M,R,F,Y,ie,le,Ae,Xe,nt,at;return la.a.wrap(function(Ot){for(;;)switch(Ot.prev=Ot.next){case 0:return s=this.config,c=s.id,m=s.style,g=m===void 0?"light":m,x=s.minZoom,A=x===void 0?0:x,M=s.maxZoom,R=M===void 0?18:M,F=s.token,Y=F===void 0?CS:F,ie=s.mapInstance,le=s.plugin,Ae=le===void 0?[]:le,Xe=s.version,nt=Xe===void 0?C4:Xe,at=Ah()(s,x4),Ot.next=3,new Promise(function(Ut){var $t=function(){if(ie){var Dr;i.map=ie,i.$mapContainer=i.map.getContainer();var Sr=i.map.getCenter();(Dr=i.map.customCoords)===null||Dr===void 0||Dr.setCenter([Sr.lng,Sr.lat]),i.setCustomCoordCenter([Sr.lng,Sr.lat]),setTimeout(function(){i.map.on("viewchange",i.handleViewChanged),Ut()},30)}else{i.$mapContainer=i.creatAmapContainer(c);var Sn=b4({mapStyle:i.getMapStyle(g),zooms:[A,R],viewMode:"3D"},at);Sn.zoom&&(Sn.zoom+=1);var Dn=new AMap.Map(i.$mapContainer,Sn);i.map=Dn;var ai=Dn.getCenter();Dn.customCoords.setCenter([ai.lng,ai.lat]),i.setCustomCoordCenter([ai.lng,ai.lat]),Dn.on("viewchange",i.handleViewChanged),setTimeout(function(){Ut()},10)}};i.viewport=new _4,!qg&&!ie?(Y===CS&&console.warn(i.configService.getSceneWarninfo("MapToken")),qg=!0,Ae.push("Map3D"),b2.a.load({key:Y,version:nt,plugins:Ae}).then(function(Tr){$t(),b0.length&&(b0.forEach(function(Dr){return Dr()}),b0=[])}).catch(function(Tr){throw new Error(Tr)})):qg&&window.AMap||ie?$t():b0.push($t)});case 3:this.map.on("dragstart",function(){return i.dragging=!0,""}),this.map.on("dragend",function(){return i.dragging=!1,""});case 5:case"end":return Ot.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"meterToCoord",value:function(t,n){var i=AMap.GeometryUtil.distance(v0()(AMap.LngLat,Pt()(t)),v0()(AMap.LngLat,Pt()(n))),s=this.lngLatToCoord(t),c=ri()(s,2),m=c[0],g=c[1],x=this.lngLatToCoord(n),A=ri()(x,2),M=A[0],R=A[1],F=Math.sqrt(Math.pow(m-M,2)+Math.pow(g-R,2));return F/i}},{key:"exportMap",value:function(t){var n,i=(n=this.getContainer())===null||n===void 0?void 0:n.getElementsByClassName("amap-layer")[0],s=t==="jpg"?i==null?void 0:i.toDataURL("image/jpeg"):i==null?void 0:i.toDataURL("image/png");return s}},{key:"emit",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).emit.apply(n,[t].concat(s))}},{key:"once",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).once.apply(n,[t].concat(s))}},{key:"destroy",value:function(){var t,n;this.map.destroy(),(t=this.$mapContainer)===null||t===void 0||(n=t.parentNode)===null||n===void 0||n.removeChild(this.$mapContainer),delete window.initAMap;var i=document.getElementById(A4);i&&document.head.removeChild(i)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"initViewPort",value:function(){var t,n=(t=this.map.customCoords)===null||t===void 0?void 0:t.getCameraParams(),i=n.fov,s=n.near,c=n.far,m=n.aspect,g=n.position,x=n.lookAt,A=n.up;this.emit("mapchange");var M=this.map.customCoords.getCenter(),R=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:m,far:c,fov:i,cameraPosition:g,lookAt:x,near:s,up:A,zoom:R-1,center:M,offsetOrigin:[g[0],g[1]]}),this.coordinateSystemService.setCoordinateSystem(Vs.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(t,n){var i=[0,0];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i}},{key:"getMapStyle",value:function(t){return hS[t]?hS[t]:t}},{key:"creatAmapContainer",value:function(t){var n=t;typeof t=="string"&&(n=document.getElementById(t));var i=document.createElement("div");return i.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,i.id="l7_amap_div"+S4++,n.appendChild(i),i}}]),e}(),_S=yi()(tv.prototype,"configService",[dS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xS=yi()(tv.prototype,"config",[vS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bS=yi()(tv.prototype,"coordinateSystemService",[mS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ES=yi()(tv.prototype,"eventEmitter",[gS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tv))||yS);function T4(e){var r=M4();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function M4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var P4=function(e){Nr()(t,e);var r=T4(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getServiceConstructor",value:function(){return w4}}]),t}(d0);function AS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function wS(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?AS(Object(t),!0).forEach(function(n){O4(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):AS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function O4(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function I4(e,r){return D4(e)||L4(e,r)||k4(e,r)||R4()}function R4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k4(e,r){if(!!e){if(typeof e=="string")return TS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return TS(e,r)}}function TS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function L4(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,m;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(g){s=!0,m=g}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw m}}return n}}function D4(e){if(Array.isArray(e))return e}var F4=se.a.memo(function(e){var r=e.style,t=e.className,n=e.map,i=e.option,s=e.onSceneLoaded,c=e.children,m=Object(Q.useRef)(null),g=Object(Q.useState)(),x=I4(g,2),A=x[0],M=x[1];return Object(Q.useEffect)(function(){var R=new Zv(wS(wS({id:m.current},i),{},{map:new P4(n)}));return R.on("loaded",function(){M(R),s&&s(R)}),function(){R.destroy()}},[]),Object(Q.useEffect)(function(){A&&n.style&&A.setMapStyle(n.style)},[JSON.stringify(n.style)]),Object(Q.useEffect)(function(){A&&n.zoom&&A.setZoom(n.zoom)},[n.zoom]),Object(Q.useEffect)(function(){A&&n.center&&A.setCenter(n.center)},[JSON.stringify(n.center)]),Object(Q.useEffect)(function(){A&&n.pitch&&A.setPitch(n.pitch)},[n.pitch]),Object(Q.useEffect)(function(){A&&n.rotation&&A.setRotation(n.rotation)},[n.rotation]),se.a.createElement(Ce.Provider,{value:A},se.a.createElement("div",{ref:m,className:t,style:r},A&&c))}),B6=F4,B4=w("zvhG"),N4=w.n(B4);function z4(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=U4(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function U4(e,r){if(!!e){if(typeof e=="string")return MS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return MS(e,r)}}function MS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Qg;function Jg(e,r,t){var n=t-r,i=((e-r)%n+n)%n+r;return i===r?t:i}function Rh(e,r,t){return Math.min(t,Math.max(r,e))}function Lc(e,r,t){return e*(1-t)+r*t}function ey(e,r,t,n){var i=new N4.a(e,r,t,n);return function(s){return i.solve(s)}}var ty=ey(.25,.1,.25,1);function PS(){return Pi||!Kn.matchMedia?!1:(Qg==null&&(Qg=Kn.matchMedia("(prefers-reduced-motion: reduce)")),Qg.matches)}function j4(e,r){var t={},n=z4(r),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;s in e&&(t[s]=e[s])}}catch(c){n.e(c)}finally{n.f()}return t}var vp=Pi?Date.now.bind(Date):Kn.performance&&Kn.performance.now?Kn.performance.now.bind(Kn.performance):Date.now.bind(Date),V4=Kn.requestAnimationFrame||Kn.mozRequestAnimationFrame||Kn.webkitRequestAnimationFrame||Kn.msRequestAnimationFrame,G4=Kn.cancelAnimationFrame||Kn.mozCancelAnimationFrame||Kn.webkitCancelAnimationFrame||Kn.msCancelAnimationFrame;function E0(e){var r=V4(e);return{cancel:function(){return G4(r)}}}var OS=63710088e-1,Bo=function(){function e(r,t){if(Ct()(this,e),S()(this,"lng",void 0),S()(this,"lat",void 0),isNaN(r)||isNaN(t))throw new Error("Invalid LngLat object: (".concat(r,", ").concat(t,")"));if(this.lng=+r,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return Bt()(e,[{key:"wrap",value:function(){return new e(Jg(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(t){var n=Math.PI/180,i=this.lat*n,s=t.lat*n,c=Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos((t.lng-this.lng)*n),m=OS*Math.acos(Math.min(c,1));return m}}],[{key:"convert",value:function(t){if(t instanceof e)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new e(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&jl()(t)==="object"&&t!==null){var n="lng"in t?t.lng:t.lon;return new e(Number(n),Number(t.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]),e}(),lm=function(){function e(r,t){Ct()(this,e),S()(this,"ne",void 0),S()(this,"sw",void 0),r&&(t?this.setSouthWest(r).setNorthEast(t):r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}return Bt()(e,[{key:"setNorthEast",value:function(t){return this.ne=t instanceof Bo?new Bo(t.lng,t.lat):Bo.convert(t),this}},{key:"setSouthWest",value:function(t){return this.sw=t instanceof Bo?new Bo(t.lng,t.lat):Bo.convert(t),this}},{key:"extend",value:function(t){var n=this.sw,i=this.ne,s,c;if(t instanceof Bo)s=t,c=t;else if(t instanceof e){if(s=t.sw,c=t.ne,!s||!c)return this}else{if(Array.isArray(t))if(t.length===4||t.every(Array.isArray)){var m=t;return this.extend(e.convert(m))}else{var g=t;return this.extend(Bo.convert(g))}return this}return!n&&!i?(this.sw=new Bo(s.lng,s.lat),this.ne=new Bo(c.lng,c.lat)):(n.lng=Math.min(s.lng,n.lng),n.lat=Math.min(s.lat,n.lat),i.lng=Math.max(c.lng,i.lng),i.lat=Math.max(c.lat,i.lat)),this}},{key:"getCenter",value:function(){return new Bo((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new Bo(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new Bo(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(t){var n=Bo.convert(t),i=n.lng,s=n.lat,c=this.sw.lat<=s&&s<=this.ne.lat,m=this.sw.lng<=i&&i<=this.ne.lng;return this.sw.lng>this.ne.lng&&(m=this.sw.lng>=i&&i>=this.ne.lng),c&&m}}],[{key:"convert",value:function(t){return t instanceof e?t:new e(t)}}]),e}(),Aa=function(){function e(r,t){Ct()(this,e),S()(this,"x",void 0),S()(this,"y",void 0),this.x=r,this.y=t}return Bt()(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"_add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"add",value:function(t){return this.clone()._add(t)}},{key:"_sub",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"sub",value:function(t){return this.clone()._sub(t)}},{key:"_multByPoint",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"multByPoint",value:function(t){return this.clone()._multByPoint(t)}},{key:"_divByPoint",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"divByPoint",value:function(t){return this.clone()._divByPoint(t)}},{key:"_mult",value:function(t){return this.x*=t,this.y*=t,this}},{key:"mult",value:function(t){return this.clone()._mult(t)}},{key:"_div",value:function(t){return this.x/=t,this.y/=t,this}},{key:"div",value:function(t){return this.clone()._div(t)}},{key:"_rotate",value:function(t){var n=Math.cos(t),i=Math.sin(t),s=n*this.x-i*this.y,c=i*this.x+n*this.y;return this.x=s,this.y=c,this}},{key:"rotate",value:function(t){return this.clone()._rotate(t)}},{key:"_rotateAround",value:function(t,n){var i=Math.cos(t),s=Math.sin(t),c=n.x+i*(this.x-n.x)-s*(this.y-n.y),m=n.y+s*(this.x-n.x)+i*(this.y-n.y);return this.x=c,this.y=m,this}},{key:"roateAround",value:function(t,n){return this.clone()._rotateAround(t,n)}},{key:"_matMult",value:function(t){var n=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=n,this.y=i,this}},{key:"matMult",value:function(t){return this.clone()._matMult(t)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var t=this.y;return this.y=this.x,this.x=-t,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"dist",value:function(t){return Math.sqrt(this.distSqr(t))}},{key:"distSqr",value:function(t){var n=t.x-this.x,i=t.y-this.y;return n*n+i*i}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(t){return Math.atan2(this.y-t.y,this.x-t.x)}},{key:"angleWith",value:function(t){return this.angleWithSep(t.x,t.y)}},{key:"angleWithSep",value:function(t,n){return Math.atan2(this.x*n-this.y*t,this.x*t+this.y*n)}}],[{key:"convert",value:function(t){return t instanceof e?t:Array.isArray(t)?new e(t[0],t[1]):t}}]),e}(),H4=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(Ct()(this,e),S()(this,"top",void 0),S()(this,"bottom",void 0),S()(this,"left",void 0),S()(this,"right",void 0),isNaN(r)||r<0||isNaN(t)||t<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=t,this.left=n,this.right=i}return Bt()(e,[{key:"interpolate",value:function(t,n,i){return n.top!=null&&t.top!=null&&(this.top=Lc(t.top,n.top,i)),n.bottom!=null&&t.bottom!=null&&(this.bottom=Lc(t.bottom,n.bottom,i)),n.left!=null&&t.left!=null&&(this.left=Lc(t.left,n.left,i)),n.right!=null&&t.right!=null&&(this.right=Lc(t.right,n.right,i)),this}},{key:"getCenter",value:function(t,n){var i=Rh((this.left+t-this.right)/2,0,t),s=Rh((this.top+n-this.bottom)/2,0,n);return new Aa(i,s)}},{key:"equals",value:function(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}},{key:"clone",value:function(){return new e(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),e}(),IS=2*Math.PI*OS;function RS(e){return IS*Math.cos(e*Math.PI/180)}function S0(e){return(180+e)/360}function C0(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function kS(e,r){return e/RS(r)}function W4(e){return e*360-180}function ry(e){var r=180-e*360;return 360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90}function Z4(e,r){return e*RS(ry(r))}function X4(e){return 1/Math.cos(e*Math.PI/180)}var A0=function(){function e(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;Ct()(this,e),S()(this,"x",void 0),S()(this,"y",void 0),S()(this,"z",void 0),this.x=+r,this.y=+t,this.z=+n}return Bt()(e,[{key:"toLngLat",value:function(){return new Bo(W4(this.x),ry(this.y))}},{key:"toAltitude",value:function(){return Z4(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/IS*X4(ry(this.y))}}],[{key:"fromLngLat",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Bo.convert(t);return new e(S0(i.lng),C0(i.lat),kS(n,i.lat))}}]),e}();function Y4(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=K4(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function K4(e,r){if(!!e){if(typeof e=="string")return LS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return LS(e,r)}}function LS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var N6=8192,$4=function(){function e(r,t,n,i,s){Ct()(this,e),S()(this,"tileSize",void 0),S()(this,"tileZoom",void 0),S()(this,"lngRange",void 0),S()(this,"latRange",void 0),S()(this,"maxValidLatitude",void 0),S()(this,"scale",void 0),S()(this,"width",void 0),S()(this,"height",void 0),S()(this,"angle",void 0),S()(this,"rotationMatrix",void 0),S()(this,"pixelsToGLUnits",void 0),S()(this,"cameraToCenterDistance",void 0),S()(this,"mercatorMatrix",void 0),S()(this,"projMatrix",void 0),S()(this,"invProjMatrix",void 0),S()(this,"alignedProjMatrix",void 0),S()(this,"pixelMatrix",void 0),S()(this,"pixelMatrixInverse",void 0),S()(this,"glCoordMatrix",void 0),S()(this,"labelPlaneMatrix",void 0),S()(this,"_fov",void 0),S()(this,"_pitch",void 0),S()(this,"_zoom",void 0),S()(this,"_renderWorldCopies",void 0),S()(this,"_minZoom",void 0),S()(this,"_maxZoom",void 0),S()(this,"_minPitch",void 0),S()(this,"_maxPitch",void 0),S()(this,"_center",void 0),S()(this,"zoomFraction",void 0),S()(this,"unmodified",void 0),S()(this,"edgeInsets",void 0),S()(this,"constraining",void 0),S()(this,"posMatrixCache",void 0),S()(this,"alignedPosMatrixCache",void 0),this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=s===void 0?!0:s,this._minZoom=r||0,this._maxZoom=t||22,this._minPitch=n==null?0:n,this._maxPitch=i==null?60:i,this.setMaxBounds(),this.width=0,this.height=0,this._center=new Bo(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new H4,this.posMatrixCache={},this.alignedPosMatrixCache={}}return Bt()(e,[{key:"minZoom",get:function(){return this._minZoom},set:function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}},{key:"minPitch",get:function(){return this._minPitch},set:function(t){this._minPitch!==t&&(this._minPitch=t,this._pitch=Math.max(this._pitch,t))}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(t){this._maxPitch!==t&&(this._maxPitch=t,this._pitch=Math.min(this._pitch,t))}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new Aa(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(t){var n=-Jg(t,-180,180)*Math.PI/180;this.angle!==n&&(this.unmodified=!1,this.angle=n,this.calcMatrices(),this.rotationMatrix=H.create(),H.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(t){var n=Rh(t,this._minPitch,this._maxPitch)/180*Math.PI;this._pitch!==n&&(this.unmodified=!1,this._pitch=n,this.calcMatrices())}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this.unmodified=!1,this._fov=t/180*Math.PI,this.calcMatrices())}},{key:"zoom",get:function(){return this._zoom},set:function(t){var n=Math.min(Math.max(t,this._minZoom),this._maxZoom);this._zoom!==n&&(this.unmodified=!1,this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom,this.constrain(),this.calcMatrices())}},{key:"center",get:function(){return this._center},set:function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this.unmodified=!1,this._center=t,this.constrain(),this.calcMatrices())}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(t){this.edgeInsets.equals(t)||(this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,t,1),this.calcMatrices())}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}},{key:"clone",value:function(){var t=new e(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t.center=this._center,t.zoom=this.zoom,t.angle=this.angle,t.fov=this._fov,t.pitch=this._pitch,t.unmodified=this.unmodified,t.edgeInsets=this.edgeInsets.clone(),t.calcMatrices(),t}},{key:"isPaddingEqual",value:function(t){return this.edgeInsets.equals(t)}},{key:"interpolatePadding",value:function(t,n,i){this.unmodified=!1,this.edgeInsets.interpolate(t,n,i),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(t){var n=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,n)}},{key:"resize",value:function(t,n){this.width=t,this.height=n,this.pixelsToGLUnits=[2/t,-2/n],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(t){return Math.pow(2,t)}},{key:"scaleZoom",value:function(t){return Math.log(t)/Math.LN2}},{key:"project",value:function(t){var n=Rh(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new Aa(S0(t.lng)*this.worldSize,C0(n)*this.worldSize)}},{key:"unproject",value:function(t){return new A0(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(t,n){var i=this.pointCoordinate(n),s=this.pointCoordinate(this.centerPoint),c=this.locationCoordinate(t),m=new A0(c.x-(i.x-s.x),c.y-(i.y-s.y));this.center=this.coordinateLocation(m),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(t){var n=0,i=new Float64Array([t.x,t.y,0,1]),s=new Float64Array([t.x,t.y,1,1]);U.transformMat4(i,i,this.pixelMatrixInverse),U.transformMat4(s,s,this.pixelMatrixInverse);var c=i[3],m=s[3],g=i[0]/c,x=s[0]/m,A=i[1]/c,M=s[1]/m,R=i[2]/c,F=s[2]/m,Y=R===F?0:(n-R)/(F-R);return new A0(Lc(g,x,Y)/this.worldSize,Lc(A,M,Y)/this.worldSize)}},{key:"getBounds",value:function(){return new lm().extend(this.pointLocation(new Aa(0,0))).extend(this.pointLocation(new Aa(this.width,0))).extend(this.pointLocation(new Aa(this.width,this.height))).extend(this.pointLocation(new Aa(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new lm([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new Aa(0,0)),n=new Float32Array([t.x*this.worldSize,t.y*this.worldSize,0,1]),i=U.transformMat4(n,n,this.pixelMatrix);return i[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var t=this._pitch,n=Math.tan(t)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Aa(0,n))}},{key:"getCameraQueryGeometry",value:function(t){var n=this.getCameraPoint();if(t.length===1)return[t[0],n];var i=n.x,s=n.y,c=n.x,m=n.y,g=Y4(t),x;try{for(g.s();!(x=g.n()).done;){var A=x.value;i=Math.min(i,A.x),s=Math.min(s,A.y),c=Math.max(c,A.x),m=Math.max(m,A.y)}}catch(M){g.e(M)}finally{g.f()}return[new Aa(i,s),new Aa(c,s),new Aa(c,m),new Aa(i,m),new Aa(i,s)]}},{key:"coordinatePoint",value:function(t){var n=U.fromValues(t.x*this.worldSize,t.y*this.worldSize,0,1);return U.transformMat4(n,n,this.pixelMatrix),new Aa(n[0]/n[3],n[1]/n[3])}},{key:"locationPoint",value:function(t){return this.coordinatePoint(this.locationCoordinate(t))}},{key:"pointLocation",value:function(t){return this.coordinateLocation(this.pointCoordinate(t))}},{key:"locationCoordinate",value:function(t){return A0.fromLngLat(t)}},{key:"coordinateLocation",value:function(t){return t.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!(!this.center||!this.width||!this.height||this.constraining)){this.constraining=!0;var t=-90,n=90,i=-180,s=180,c,m,g,x,A=this.size,M=this.unmodified;if(this.latRange){var R=this.latRange;t=C0(R[1])*this.worldSize,n=C0(R[0])*this.worldSize,c=n-t<A.y?A.y/(n-t):0}if(this.lngRange){var F=this.lngRange;i=S0(F[0])*this.worldSize,s=S0(F[1])*this.worldSize,m=s-i<A.x?A.x/(s-i):0}var Y=this.point,ie=Math.max(m||0,c||0);if(ie){this.center=this.unproject(new Aa(m?(s+i)/2:Y.x,c?(n+t)/2:Y.y)),Pi?this.zoom=Math.max(this.zoom,Math.max(-1,this.minZoom)):this.zoom+=this.scaleZoom(ie),this.unmodified=M,this.constraining=!1;return}if(this.latRange){var le=Y.y,Ae=A.y/2;le-Ae<t&&(x=t+Ae),le+Ae>n&&(x=n-Ae)}if(this.lngRange){var Xe=Y.x,nt=A.x/2;Xe-nt<i&&(g=i+nt),Xe+nt>s&&(g=s-nt)}(g!==void 0||x!==void 0)&&(this.center=this.unproject(new Aa(g!==void 0?g:Y.x,x!==void 0?x:Y.y))),this.unmodified=M,this.constraining=!1}}},{key:"calcMatrices",value:function(){if(!!this.height){var t=this._fov/2,n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(t)*this.height;var i=Math.PI/2+this._pitch,s=this._fov*(.5+n.y/this.height),c=Math.sin(s)*this.cameraToCenterDistance/Math.sin(Rh(Math.PI-i-s,.01,Math.PI-.01)),m=this.point,g=m.x,x=m.y,A=Math.cos(Math.PI/2-this._pitch)*c+this.cameraToCenterDistance,M=A*1.01,R=this.height/50,F=new Float64Array(16);B.perspective(F,this._fov,this.width/this.height,R,M),F[8]=-n.x*2/this.width,F[9]=n.y*2/this.height,B.scale(F,F,[1,-1,1]),B.translate(F,F,[0,0,-this.cameraToCenterDistance]),B.rotateX(F,F,this._pitch),B.rotateZ(F,F,this.angle),B.translate(F,F,[-g,-x,0]),this.mercatorMatrix=B.scale([],F,[this.worldSize,this.worldSize,this.worldSize]),B.scale(F,F,[1,1,kS(1,this.center.lat)*this.worldSize,1]),this.projMatrix=F,this.invProjMatrix=B.invert([],this.projMatrix);var Y=this.width%2/2,ie=this.height%2/2,le=Math.cos(this.angle),Ae=Math.sin(this.angle),Xe=g-Math.round(g)+le*Y+Ae*ie,nt=x-Math.round(x)+le*ie+Ae*Y,at=new Float64Array(F);if(B.translate(at,at,[Xe>.5?Xe-1:Xe,nt>.5?nt-1:nt,0]),this.alignedProjMatrix=at,F=B.create(),B.scale(F,F,[this.width/2,-this.height/2,1]),B.translate(F,F,[1,-1,0]),this.labelPlaneMatrix=F,F=B.create(),B.scale(F,F,[1,-1,1]),B.translate(F,F,[-1,-1,0]),B.scale(F,F,[2/this.width,2/this.height,1]),this.glCoordMatrix=F,this.pixelMatrix=B.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),F=B.invert(new Float64Array(16),this.pixelMatrix),!F)throw new Error("failed to invert matrix");this.pixelMatrixInverse=F,this.posMatrixCache={},this.alignedPosMatrixCache={}}}}]),e}(),eo=Bt()(function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ct()(this,e),S()(this,"type",void 0),_o()(this,t),this.type=r});function q4(e){var r=Q4();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Q4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var DS=function(e){Nr()(t,e);var r=q4(t);function t(n){var i;Ct()(this,t),i=r.call(this),S()(oe()(i),"transform",void 0),S()(oe()(i),"options",void 0),S()(oe()(i),"moving",void 0),S()(oe()(i),"zooming",void 0),S()(oe()(i),"rotating",void 0),S()(oe()(i),"pitching",void 0),S()(oe()(i),"padding",void 0),S()(oe()(i),"bearingSnap",void 0),S()(oe()(i),"easeEndTimeoutID",void 0),S()(oe()(i),"easeStart",void 0),S()(oe()(i),"easeOptions",void 0),S()(oe()(i),"easeId",void 0),S()(oe()(i),"onEaseFrame",void 0),S()(oe()(i),"onEaseEnd",void 0),S()(oe()(i),"easeFrameId",void 0),S()(oe()(i),"renderFrameCallback",function(){var A=Math.min((vp()-i.easeStart)/i.easeOptions.duration,1);i.onEaseFrame(i.easeOptions.easing(A)),A<1?i.easeFrameId=i.requestRenderFrame(i.renderFrameCallback):i.stop()}),i.options=n;var s=n.minZoom,c=n.maxZoom,m=n.minPitch,g=n.maxPitch,x=n.renderWorldCopies;return i.moving=!1,i.zooming=!1,i.bearingSnap=n.bearingSnap,i.transform=new $4(s,c,m,g,x),i}return Bt()(t,[{key:"requestRenderFrame",value:function(i){return 0}},{key:"cancelRenderFrame",value:function(i){}},{key:"getCenter",value:function(){var i=this.transform.center,s=i.lng,c=i.lat;return new Bo(s,c)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(i,s){return this.jumpTo({center:i},s)}},{key:"setPitch",value:function(i,s){return this.jumpTo({pitch:i},s),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(i,s,c){return this.easeTo(_o()({center:i},s),c)}},{key:"zoomOut",value:function(i,s){return this.zoomTo(this.getZoom()-1,i,s),this}},{key:"setBearing",value:function(i,s){return this.jumpTo({bearing:i},s),this}},{key:"setZoom",value:function(i,s){return this.jumpTo({zoom:i},s),this}},{key:"zoomIn",value:function(i,s){return this.zoomTo(this.getZoom()+1,i,s),this}},{key:"zoomTo",value:function(i,s,c){return this.easeTo(_o()({zoom:i},s),c)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(i,s){return this.jumpTo({padding:i},s),this}},{key:"rotateTo",value:function(i,s,c){return this.easeTo(_o()({bearing:i},s),c)}},{key:"resetNorth",value:function(i,s){return this.rotateTo(0,_o()({duration:1e3},i),s),this}},{key:"resetNorthPitch",value:function(i,s){return this.easeTo(_o()({bearing:0,pitch:0,duration:1e3},i),s),this}},{key:"fitBounds",value:function(i,s,c){return this.fitInternal(this.cameraForBounds(i,s),s,c)}},{key:"cameraForBounds",value:function(i,s){return i=lm.convert(i),this.cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),0,s)}},{key:"snapToNorth",value:function(i,s){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(i,s):this}},{key:"jumpTo",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;this.stop();var c=this.transform,m=!1,g=!1,x=!1;return i.zoom&&c.zoom!==+i.zoom&&(m=!0,c.zoom=+i.zoom),i.center!==void 0&&(c.center=Bo.convert(i.center)),i.bearing&&c.bearing!==+i.bearing&&(g=!0,c.bearing=+i.bearing),i.pitch&&c.pitch!==+i.pitch&&(x=!0,c.pitch=+i.pitch),i.padding!=null&&!c.isPaddingEqual(i.padding)&&(c.padding=i.padding),this.emit("movestart",new eo("movestart",s)),this.emit("move",new eo("move",s)),m&&(this.emit("zoomstart",new eo("zoomstart",s)),this.emit("zoom",new eo("zoom",s)),this.emit("zoomend",new eo("zoomend",s))),g&&(this.emit("rotatestart",new eo("rotatestart",s)),this.emit("rotate",new eo("rotate",s)),this.emit("rotateend",new eo("rotateend",s))),x&&(this.emit("pitchstart",new eo("pitchstart",s)),this.emit("pitch",new eo("pitch",s)),this.emit("pitchend",new eo("pitchend",s))),this.emit("moveend",new eo("moveend",s))}},{key:"easeTo",value:function(){var i=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;s=_o()({offset:[0,0],duration:500,easing:ty},s),(s.animate===!1||!s.essential&&PS())&&(s.duration=0);var m=this.transform,g=this.getZoom(),x=this.getBearing(),A=this.getPitch(),M=this.getPadding(),R=s.zoom?+s.zoom:g,F=s.bearing?this.normalizeBearing(s.bearing,x):x,Y=s.pitch?+s.pitch:A,ie=s.padding?s.padding:m.padding,le=Aa.convert(s.offset),Ae=m.centerPoint.add(le),Xe=m.pointLocation(Ae),nt=Bo.convert(s.center||Xe);this.normalizeCenter(nt);var at=m.project(Xe),It=m.project(nt).sub(at),Ot=m.zoomScale(R-g),Ut,$t;s.around&&(Ut=Bo.convert(s.around),$t=m.locationPoint(Ut));var Tr={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||R!==g,this.rotating=this.rotating||x!==F,this.pitching=this.pitching||Y!==A,this.padding=!m.isPaddingEqual(ie),this.easeId=s.easeId,this.prepareEase(c,s.noMoveStart,Tr),clearTimeout(this.easeEndTimeoutID),this.ease(function(Dr){if(i.zooming&&(m.zoom=Lc(g,R,Dr)),i.rotating&&(m.bearing=Lc(x,F,Dr)),i.pitching&&(m.pitch=Lc(A,Y,Dr)),i.padding&&(m.interpolatePadding(M,ie,Dr),Ae=m.centerPoint.add(le)),Ut)m.setLocationAtPoint(Ut,$t);else{var Sr=m.zoomScale(m.zoom-g),Sn=R>g?Math.min(2,Ot):Math.max(.5,Ot),Dn=Math.pow(Sn,1-Dr),ai=m.unproject(at.add(It.mult(Dr*Dn)).mult(Sr));m.setLocationAtPoint(m.renderWorldCopies?ai.wrap():ai,Ae)}i.fireMoveEvents(c)},function(Dr){i.afterEase(c,Dr)},s),this}},{key:"flyTo",value:function(){var i=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;if(!s.essential&&PS()){var m=j4(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(m,c)}this.stop(),s=_o()({offset:[0,0],speed:1.2,curve:1.42,easing:ty},s);var g=this.transform,x=this.getZoom(),A=this.getBearing(),M=this.getPitch(),R=this.getPadding(),F=s.zoom?Rh(+s.zoom,g.minZoom,g.maxZoom):x,Y=s.bearing?this.normalizeBearing(s.bearing,A):A,ie=s.pitch?+s.pitch:M,le="padding"in s?s.padding:g.padding,Ae=g.zoomScale(F-x),Xe=Aa.convert(s.offset),nt=g.centerPoint.add(Xe),at=g.pointLocation(nt),It=Bo.convert(s.center||at);this.normalizeCenter(It);var Ot=g.project(at),Ut=g.project(It).sub(Ot),$t=s.curve,Tr=Math.max(g.width,g.height),Dr=Tr/Ae,Sr=Ut.mag();if("minZoom"in s){var Sn=Rh(Math.min(s.minZoom,x,F),g.minZoom,g.maxZoom),Dn=Tr/g.zoomScale(Sn-x);$t=Math.sqrt(Dn/Sr*2)}var ai=$t*$t;function Ua(vs){var zl=(Dr*Dr-Tr*Tr+(vs?-1:1)*ai*ai*Sr*Sr)/(2*(vs?Dr:Tr)*ai*Sr);return Math.log(Math.sqrt(zl*zl+1)-zl)}function To(vs){return(Math.exp(vs)-Math.exp(-vs))/2}function Gs(vs){return(Math.exp(vs)+Math.exp(-vs))/2}function Hu(vs){return To(vs)/Gs(vs)}var ws=Ua(0),Lh=function(zl){return Gs(ws)/Gs(ws+$t*zl)},X0=function(zl){return Tr*((Gs(ws)*Hu(ws+$t*zl)-To(ws))/ai)/Sr},sv=(Ua(1)-ws)/$t;if(Math.abs(Sr)<1e-6||!isFinite(sv)){if(Math.abs(Tr-Dr)<1e-6)return this.easeTo(s,c);var gy=Dr<Tr?-1:1;sv=Math.abs(Math.log(Dr/Tr))/$t,X0=function(){return 0},Lh=function(zl){return Math.exp(gy*$t*zl)}}if("duration"in s)s.duration=+s.duration;else{var yy="screenSpeed"in s?+s.screenSpeed/$t:+s.speed;s.duration=1e3*sv/yy}return s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this.zooming=!0,this.rotating=A!==Y,this.pitching=ie!==M,this.padding=!g.isPaddingEqual(le),this.prepareEase(c,!1),this.ease(function(vs){var zl=vs*sv,Y0=1/Lh(zl);g.zoom=vs===1?F:x+g.scaleZoom(Y0),i.rotating&&(g.bearing=Lc(A,Y,vs)),i.pitching&&(g.pitch=Lc(M,ie,vs)),i.padding&&(g.interpolatePadding(R,le,vs),nt=g.centerPoint.add(Xe));var K0=vs===1?It:g.unproject(Ot.add(Ut.mult(X0(zl))).mult(Y0));g.setLocationAtPoint(g.renderWorldCopies?K0.wrap():K0,nt),i.fireMoveEvents(c)},function(){return i.afterEase(c)},s),this}},{key:"fitScreenCoordinates",value:function(i,s,c,m,g){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(Aa.convert(i)),this.transform.pointLocation(Aa.convert(s)),c,m),m,g)}},{key:"stop",value:function(i,s){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var c=this.onEaseEnd;delete this.onEaseEnd,c.call(this,s)}return this}},{key:"normalizeBearing",value:function(i,s){i=Jg(i,-180,180);var c=Math.abs(i-s);return Math.abs(i-360-s)<c&&(i-=360),Math.abs(i+360-s)<c&&(i+=360),i}},{key:"normalizeCenter",value:function(i){var s=this.transform;if(!(!s.renderWorldCopies||s.lngRange)){var c=i.lng-s.center.lng;i.lng+=c>180?-360:c<-180?360:0}}},{key:"fireMoveEvents",value:function(i){this.emit("move",new eo("move",i)),this.zooming&&this.emit("zoom",new eo("zoom",i)),this.rotating&&this.emit("rotate",new eo("rotate",i)),this.pitching&&this.emit("rotate",new eo("pitch",i))}},{key:"prepareEase",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!s&&!c.moving&&this.emit("movestart",new eo("movestart",i)),this.zooming&&!c.zooming&&this.emit("zoomstart",new eo("zoomstart",i)),this.rotating&&!c.rotating&&this.emit("rotatestart",new eo("rotatestart",i)),this.pitching&&!c.pitching&&this.emit("pitchstart",new eo("pitchstart",i))}},{key:"afterEase",value:function(i,s){if(!(this.easeId&&s&&this.easeId===s)){delete this.easeId;var c=this.zooming,m=this.rotating,g=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,c&&this.emit("zoomend",new eo("zoomend",i)),m&&this.emit("rotateend",new eo("rotateend",i)),g&&this.emit("pitchend",new eo("pitchend",i)),this.emit("moveend",new eo("moveend",i))}}},{key:"ease",value:function(i,s,c){c.animate===!1||c.duration===0?(i(1),s()):(this.easeStart=vp(),this.easeOptions=c,this.onEaseFrame=i,this.onEaseEnd=s,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(i,s,c,m){var g={top:0,bottom:0,right:0,left:0};if(m=_o()({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},m),typeof m.padding=="number"){var x=m.padding;m.padding={top:x,bottom:x,right:x,left:x}}m.padding=_o()(g,m.padding);var A=this.transform,M=A.padding,R=A.project(Bo.convert(i)),F=A.project(Bo.convert(s)),Y=R.rotate(-c*Math.PI/180),ie=F.rotate(-c*Math.PI/180),le=new Aa(Math.max(Y.x,ie.x),Math.max(Y.y,ie.y)),Ae=new Aa(Math.min(Y.x,ie.x),Math.min(Y.y,ie.y)),Xe=le.sub(Ae),nt=(A.width-(M.left+M.right+m.padding.left+m.padding.right))/Xe.x,at=(A.height-(M.top+M.bottom+m.padding.top+m.padding.bottom))/Xe.y;if(!(at<0||nt<0)){var It=Math.min(A.scaleZoom(A.scale*Math.min(nt,at)),m.maxZoom),Ot=Aa.convert(m.offset),Ut=(m.padding.left-m.padding.right)/2,$t=(m.padding.top-m.padding.bottom)/2,Tr=new Aa(Ot.x+Ut,Ot.y+$t),Dr=Tr.mult(A.scale/A.zoomScale(It)),Sr=A.unproject(R.add(F).div(2).sub(Dr));return{center:Sr,zoom:It,bearing:c}}}},{key:"fitInternal",value:function(i,s,c){return i?(s=_o()(i,s),delete s.padding,s.linear?this.easeTo(s,c):this.flyTo(s,c)):this}}]),t}(Ls.EventEmitter);function ny(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=J4(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function J4(e,r){if(!!e){if(typeof e=="string")return FS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return FS(e,r)}}function FS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var tc={},Gu=tc;tc.create=function(e,r,t){var n=Kn.document.createElement(e);return r!==void 0&&(n.className=r),t&&t.appendChild(n),n},tc.createNS=function(e,r){var t=Kn.document.createElementNS(e,r);return t};var sd=Kn.document&&Kn.document.documentElement.style;function BS(e){if(!sd)return e[0];var r=ny(e),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n in sd)return n}}catch(i){r.e(i)}finally{r.f()}return e[0]}var cm=BS(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),NS;tc.disableDrag=function(){sd&&cm&&(NS=sd[cm],sd[cm]="none")},tc.enableDrag=function(){sd&&cm&&(sd[cm]=NS)};var ek=BS(["transform","WebkitTransform"]);tc.setTransform=function(e,r){e.style[ek]=r};var w0=!1;try{var T0=Object.defineProperty({},"passive",{get:function(){w0=!0}});Kn.addEventListener("test",T0,T0),Kn.removeEventListener("test",T0,T0)}catch(e){w0=!1}tc.addEventListener=function(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in n&&w0?e.addEventListener(r,t,n):e.addEventListener(r,t,n.capture)},tc.removeEventListener=function(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in n&&w0?e.removeEventListener(r,t,n):e.removeEventListener(r,t,n.capture)};var zS=function e(r){r.preventDefault(),r.stopPropagation(),Kn.removeEventListener("click",e,!0)};tc.suppressClick=function(){Pi||(Kn.addEventListener("click",zS,!0),setTimeout(function(){Kn.removeEventListener("click",zS,!0)},0))},tc.mousePos=function(e,r){if(Pi)return new Aa(r.clientX-e.left-0,r.clientY-e.top-0);var t=e.getBoundingClientRect();return new Aa(r.clientX-t.left-e.clientLeft,r.clientY-t.top-e.clientTop)},tc.touchPos=function(e,r){if(Pi){var m=[],g=ny(r),x;try{for(g.s();!(x=g.n()).done;){var A=x.value;m.push(new Aa(A.clientX-e.left,A.clientY-e.top))}}catch(M){g.e(M)}finally{g.f()}return m}else{var t=e.getBoundingClientRect(),n=[],i=ny(r),s;try{for(i.s();!(s=i.n()).done;){var c=s.value;n.push(new Aa(c.clientX-t.left-e.clientLeft,c.clientY-t.top-e.clientTop))}}catch(M){i.e(M)}finally{i.f()}return n}},tc.mouseButton=function(e){return Pi&&typeof Kn.InstallTrigger!="undefined"&&e.button===2&&e.ctrlKey&&Kn.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},tc.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};function tk(e){var r=rk();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function rk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var kh=function(e){Nr()(t,e);var r=tk(t);function t(n,i,s){var c,m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Ct()(this,t);var g=Gu.mousePos(i.getCanvasContainer(),s),x=i.unproject(g);return c=r.call(this,n,_o()({point:g,lngLat:x,originalEvent:s},m)),S()(oe()(c),"type",void 0),S()(oe()(c),"target",void 0),S()(oe()(c),"originalEvent",void 0),S()(oe()(c),"point",void 0),S()(oe()(c),"lngLat",void 0),S()(oe()(c),"defaultPrevented",void 0),c.defaultPrevented=!1,c.target=i,c}return Bt()(t,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),t}(eo);function nk(e){var r=ik();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function ik(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var M0=function(e){Nr()(t,e);var r=nk(t);function t(n,i,s){var c;Ct()(this,t);var m=n==="touchend"?s.changedTouches:s.touches,g=Gu.touchPos(i.getCanvasContainer(),m),x=g.map(function(R){return i.unproject(R)}),A=g.reduce(function(R,F,Y,ie){return R.add(F.div(ie.length))},new Aa(0,0)),M=i.unproject(A);return c=r.call(this,n,{points:g,point:A,lngLats:x,lngLat:M,originalEvent:s}),S()(oe()(c),"type",void 0),S()(oe()(c),"target",void 0),S()(oe()(c),"originalEvent",void 0),S()(oe()(c),"lngLat",void 0),S()(oe()(c),"point",void 0),S()(oe()(c),"points",void 0),S()(oe()(c),"lngLats",void 0),S()(oe()(c),"defaultPrevented",void 0),c.defaultPrevented=!1,c}return Bt()(t,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),t}(eo);function ak(e){var r=ok();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function ok(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var sk=function(e){Nr()(t,e);var r=ak(t);function t(n,i,s){var c;return Ct()(this,t),c=r.call(this,n,{originalEvent:s}),S()(oe()(c),"type",void 0),S()(oe()(c),"originalEvent",void 0),S()(oe()(c),"defaultPrevented",void 0),S()(oe()(c),"target",void 0),c.defaultPrevented=!1,c}return Bt()(t,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),t}(eo),uk=function(){function e(r){Ct()(this,e),S()(this,"map",void 0),S()(this,"delayContextMenu",void 0),S()(this,"contextMenuEvent",void 0),this.map=r}return Bt()(e,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(t){this.map.emit(t.type,new kh(t.type,this.map,t))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new kh("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(t){this.delayContextMenu?this.contextMenuEvent=t:this.map.emit(t.type,new kh(t.type,this.map,t)),this.map.listeners("contextmenu")&&t.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),e}(),lk=function(){function e(r,t){Ct()(this,e),S()(this,"map",void 0),S()(this,"el",void 0),S()(this,"container",void 0),S()(this,"enabled",void 0),S()(this,"active",void 0),S()(this,"startPos",void 0),S()(this,"lastPos",void 0),S()(this,"box",void 0),S()(this,"clickTolerance",void 0),this.map=r,this.el=r.getCanvasContainer(),this.container=r.getContainer(),this.clickTolerance=t.clickTolerance||1}return Bt()(e,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){this.isEnabled()||(this.enabled=!0)}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"mousedown",value:function(t,n){!this.isEnabled()||!(t.shiftKey&&t.button===0)||(Gu.disableDrag(),this.startPos=this.lastPos=n,this.active=!0)}},{key:"mousemoveWindow",value:function(t,n){if(!!this.active){var i=n;if(!(this.lastPos.equals(i)||!this.box&&i.dist(this.startPos)<this.clickTolerance)){var s=this.startPos;this.lastPos=i,this.box||(this.box=Gu.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",t));var c=Math.min(s.x,i.x),m=Math.max(s.x,i.x),g=Math.min(s.y,i.y),x=Math.max(s.y,i.y);Gu.setTransform(this.box,"translate(".concat(c,"px,").concat(g,"px)")),this.box&&(this.box.style.width="".concat(m-c,"px"),this.box.style.height="".concat(x-g,"px"))}}}},{key:"mouseupWindow",value:function(t,n){var i=this;if(!!this.active&&t.button===0){var s=this.startPos,c=n;if(this.reset(),Gu.suppressClick(),s.x===c.x&&s.y===c.y)this.fireEvent("boxzoomcancel",t);else return this.map.emit("boxzoomend",new eo("boxzoomend",{originalEvent:t})),{cameraAnimation:function(g){return g.fitScreenCoordinates(s,c,i.map.getBearing(),{linear:!0})}}}}},{key:"keydown",value:function(t){!this.active||t.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",t))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&(Gu.remove(this.box),this.box=null),Gu.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(t,n){return this.map.emit(t,new eo(t,{originalEvent:n}))}}]),e}(),ck=lk,fk=function(){function e(){Ct()(this,e),S()(this,"enabled",void 0),S()(this,"active",void 0),this.reset()}return Bt()(e,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(t,n){return t.preventDefault(),{cameraAnimation:function(s){s.easeTo({duration:300,zoom:s.getZoom()+(t.shiftKey?-1:1),around:s.unproject(n)},{originalEvent:t})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}();function hk(e){var r=pk();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function pk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var dk=function(e){Nr()(t,e);var r=hk(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"type","renderFrame"),S()(oe()(n),"timeStamp",void 0),n}return Bt()(t)}(eo);function vk(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=mk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function mk(e,r){if(!!e){if(typeof e=="string")return US(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return US(e,r)}}function US(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var P0={linearity:.3,easing:ey(0,0,.3,1)},gk=_o()({deceleration:2500,maxSpeed:1400},P0),yk=_o()({deceleration:20,maxSpeed:1400},P0),_k=_o()({deceleration:1e3,maxSpeed:360},P0),xk=_o()({deceleration:1e3,maxSpeed:90},P0),bk=function(){function e(r){Ct()(this,e),S()(this,"map",void 0),S()(this,"inertiaBuffer",void 0),this.map=r,this.clear()}return Bt()(e,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(t){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:vp(),settings:t})}},{key:"drainInertiaBuffer",value:function(){for(var t=this.inertiaBuffer,n=vp(),i=160;t.length>0&&n-t[0].time>i;)t.shift()}},{key:"onMoveEnd",value:function(t){if(this.drainInertiaBuffer(),!(this.inertiaBuffer.length<2)){var n={zoom:0,bearing:0,pitch:0,pan:new Aa(0,0),pinchAround:void 0,around:void 0},i=vk(this.inertiaBuffer),s;try{for(i.s();!(s=i.n()).done;){var c=s.value.settings;n.zoom+=c.zoomDelta||0,n.bearing+=c.bearingDelta||0,n.pitch+=c.pitchDelta||0,c.panDelta&&n.pan._add(c.panDelta),c.around&&(n.around=c.around),c.pinchAround&&(n.pinchAround=c.pinchAround)}}catch(ie){i.e(ie)}finally{i.f()}var m=this.inertiaBuffer[this.inertiaBuffer.length-1],g=m.time-this.inertiaBuffer[0].time,x={};if(n.pan.mag()){var A=I0(n.pan.mag(),g,_o()({},gk,t||{}));x.offset=n.pan.mult(A.amount/n.pan.mag()),x.center=this.map.transform.center,O0(x,A)}if(n.zoom){var M=I0(n.zoom,g,yk);x.zoom=this.map.transform.zoom+M.amount,O0(x,M)}if(n.bearing){var R=I0(n.bearing,g,_k);x.bearing=this.map.transform.bearing+Rh(R.amount,-179,179),O0(x,R)}if(n.pitch){var F=I0(n.pitch,g,xk);x.pitch=this.map.transform.pitch+F.amount,O0(x,F)}if(x.zoom||x.bearing){var Y=n.pinchAround===void 0?n.around:n.pinchAround;x.around=Y?this.map.unproject(Y):this.map.getCenter()}return this.clear(),_o()(x,{noMoveStart:!0})}}}]),e}();function O0(e,r){(!e.duration||e.duration<r.duration)&&(e.duration=r.duration,e.easing=r.easing)}function I0(e,r,t){var n=t.maxSpeed,i=t.linearity,s=t.deceleration,c=Rh(e*i/(r/1e3),-n,n),m=Math.abs(c)/(s*i);return{easing:t.easing,duration:m*1e3,amount:c*(m/2)}}var Ek={panStep:100,bearingStep:15,pitchStep:10},Sk=function(){function e(){Ct()(this,e),S()(this,"enabled",void 0),S()(this,"active",void 0),S()(this,"panStep",void 0),S()(this,"bearingStep",void 0),S()(this,"pitchStep",void 0);var r=Ek;this.panStep=r.panStep,this.bearingStep=r.bearingStep,this.pitchStep=r.pitchStep}return Bt()(e,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(t){var n=this;if(!(t.altKey||t.ctrlKey||t.metaKey)){var i=0,s=0,c=0,m=0,g=0;switch(t.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:t.shiftKey?s=-1:(t.preventDefault(),m=-1);break;case 39:t.shiftKey?s=1:(t.preventDefault(),m=1);break;case 38:t.shiftKey?c=1:(t.preventDefault(),g=-1);break;case 40:t.shiftKey?c=-1:(t.preventDefault(),g=1);break;default:return}return{cameraAnimation:function(A){var M=A.getZoom();A.easeTo({duration:300,easeId:"keyboardHandler",easing:Ck,zoom:i?Math.round(M)+i*(t.shiftKey?2:1):M,bearing:A.getBearing()+s*n.bearingStep,pitch:A.getPitch()+c*n.pitchStep,offset:[-m*n.panStep,-g*n.panStep],center:A.getCenter()},{originalEvent:t})}}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}();function Ck(e){return e*(2-e)}var Ak=Sk,wk=function(){function e(r,t){Ct()(this,e),S()(this,"mousedownPos",void 0),S()(this,"clickTolerance",void 0),S()(this,"map",void 0),this.map=r,this.clickTolerance=t.clickTolerance}return Bt()(e,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(t){return this.firePreventable(new sk(t.type,this.map,t))}},{key:"mousedown",value:function(t,n){return this.mousedownPos=n,this.firePreventable(new kh(t.type,this.map,t))}},{key:"mouseup",value:function(t){this.map.emit(t.type,new kh(t.type,this.map,t))}},{key:"click",value:function(t,n){this.mousedownPos&&this.mousedownPos.dist(n)>=this.clickTolerance||this.map.emit(t.type,new kh(t.type,this.map,t))}},{key:"dblclick",value:function(t){return this.firePreventable(new kh(t.type,this.map,t))}},{key:"mouseover",value:function(t){this.map.emit(t.type,new kh(t.type,this.map,t))}},{key:"mouseout",value:function(t){this.map.emit(t.type,new kh(t.type,this.map,t))}},{key:"touchstart",value:function(t){return this.firePreventable(new M0(t.type,this.map,t))}},{key:"touchmove",value:function(t){this.map.emit(t.type,new M0(t.type,this.map,t))}},{key:"touchend",value:function(t){this.map.emit(t.type,new M0(t.type,this.map,t))}},{key:"touchcancel",value:function(t){this.map.emit(t.type,new M0(t.type,this.map,t))}},{key:"firePreventable",value:function(t){if(this.map.emit(t.type,t),t.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),e}(),R0,k0=0,iy=2,Tk=(R0={},S()(R0,k0,1),S()(R0,iy,2),R0);function Mk(e,r){var t=Tk[r];return e.buttons===void 0||(e.buttons&t)!==t}var ay=function(){function e(r){Ct()(this,e),S()(this,"enabled",void 0),S()(this,"active",void 0),S()(this,"lastPoint",void 0),S()(this,"eventButton",void 0),S()(this,"moved",void 0),S()(this,"clickTolerance",void 0),this.reset(),this.clickTolerance=r.clickTolerance||1}return Bt()(e,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(t,n){if(!this.lastPoint){var i=Gu.mouseButton(t);!this.correctButton(t,i)||(this.lastPoint=n,this.eventButton=i)}}},{key:"mousemoveWindow",value:function(t,n){var i=this.lastPoint;if(!!i){if(t.preventDefault(),Mk(t,this.eventButton)){this.reset();return}if(!(!this.moved&&n.dist(i)<this.clickTolerance))return this.moved=!0,this.lastPoint=n,this.move(i,n)}}},{key:"mouseupWindow",value:function(t){if(!!this.lastPoint){var n=Gu.mouseButton(t);n===this.eventButton&&(this.moved&&Gu.suppressClick(),this.reset())}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(t,n){return!1}},{key:"move",value:function(t,n){}}]),e}();function Pk(e){var r=Ok();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Ok(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ik=function(e){Nr()(t,e);var r=Pk(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"mousedown",value:function(i,s){np()(mt()(t.prototype),"mousedown",this).call(this,i,s),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(i,s){return{around:s,panDelta:s.sub(i)}}},{key:"correctButton",value:function(i,s){return s===k0&&!i.ctrlKey}}]),t}(ay);function Rk(e){var r=kk();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function kk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Lk=function(e){Nr()(t,e);var r=Rk(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"correctButton",value:function(i,s){return s===k0&&i.ctrlKey||s===iy}},{key:"move",value:function(i,s){var c=-.5,m=(s.y-i.y)*c;if(m)return this.active=!0,{pitchDelta:m}}},{key:"contextmenu",value:function(i){i.preventDefault()}}]),t}(ay);function Dk(e){var r=Fk();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function Fk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Bk=function(e){Nr()(t,e);var r=Dk(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"contextmenu",value:function(i){i.preventDefault()}},{key:"correctButton",value:function(i,s){return s===k0&&i.ctrlKey||s===iy}},{key:"move",value:function(i,s){var c=.8,m=(s.x-i.x)*c;if(m)return this.active=!0,{bearingDelta:m}}}]),t}(ay),jS=4.000244140625,Nk=1/100,zk=1/450,Uk=2,jk=function(){function e(r,t){var n=this;Ct()(this,e),S()(this,"map",void 0),S()(this,"el",void 0),S()(this,"enabled",void 0),S()(this,"active",void 0),S()(this,"zooming",void 0),S()(this,"aroundCenter",void 0),S()(this,"around",void 0),S()(this,"aroundPoint",void 0),S()(this,"type",void 0),S()(this,"lastValue",void 0),S()(this,"timeout",void 0),S()(this,"finishTimeout",void 0),S()(this,"lastWheelEvent",void 0),S()(this,"lastWheelEventTime",void 0),S()(this,"startZoom",void 0),S()(this,"targetZoom",void 0),S()(this,"delta",void 0),S()(this,"easing",void 0),S()(this,"prevEase",void 0),S()(this,"frameId",void 0),S()(this,"handler",void 0),S()(this,"defaultZoomRate",void 0),S()(this,"wheelZoomRate",void 0),S()(this,"onScrollFrame",function(){if(!!n.frameId&&(n.frameId=null,!!n.isActive())){var i=n.map.transform;if(n.delta!==0){var s=n.type==="wheel"&&Math.abs(n.delta)>jS?n.wheelZoomRate:n.defaultZoomRate,c=Uk/(1+Math.exp(-Math.abs(n.delta*s)));n.delta<0&&c!==0&&(c=1/c);var m=typeof n.targetZoom=="number"?i.zoomScale(n.targetZoom):i.scale;n.targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(m*c))),n.type==="wheel"&&(n.startZoom=i.zoom,n.easing=n.smoothOutEasing(200)),n.delta=0}var g=typeof n.targetZoom=="number"?n.targetZoom:i.zoom,x=n.startZoom,A=n.easing,M=!1,R;if(n.type==="wheel"&&x&&A){var F=Math.min((vp()-n.lastWheelEventTime)/200,1),Y=A(F);R=Lc(x,g,Y),F<1?n.frameId||(n.frameId=!0):M=!0}else R=g,M=!0;return n.active=!0,M&&(n.active=!1,n.finishTimeout=setTimeout(function(){n.zooming=!1,n.handler.triggerRenderFrame(),delete n.targetZoom,delete n.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!M,zoomDelta:R-i.zoom,around:n.aroundPoint,originalEvent:n.lastWheelEvent}}}),this.map=r,this.el=r.getCanvasContainer(),this.handler=t,this.delta=0,this.defaultZoomRate=Nk,this.wheelZoomRate=zk}return Bt()(e,[{key:"setZoomRate",value:function(t){this.defaultZoomRate=t}},{key:"setWheelZoomRate",value:function(t){this.wheelZoomRate=t}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(t){this.isEnabled()||(this.enabled=!0,this.aroundCenter=t&&t.around==="center")}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"wheel",value:function(t){if(!!this.isEnabled()){var n=t.deltaMode===window.WheelEvent.DOM_DELTA_LINE?t.deltaY*40:t.deltaY,i=vp(),s=i-(this.lastWheelEventTime||0);this.lastWheelEventTime=i,n!==0&&n%jS==0?this.type="wheel":n!==0&&Math.abs(n)<4?this.type="trackpad":s>400?(this.type=null,this.lastValue=n,this.timeout=setTimeout(this.onTimeout,40,t)):this.type||(this.type=Math.abs(s*n)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,n+=this.lastValue)),t.shiftKey&&n&&(n=n/4),this.type&&(this.lastWheelEvent=t,this.delta-=n,this.active||this.start(t)),t.preventDefault()}}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(t){this.type="wheel",this.delta-=this.lastValue,!this.active&&this.start&&this.start(t)}},{key:"start",value:function(t){if(!!this.delta){this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var n=Gu.mousePos(this.el,t);this.around=Bo.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(n)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}}},{key:"smoothOutEasing",value:function(t){var n=ty;if(this.prevEase){var i=this.prevEase,s=(vp()-i.start)/i.duration,c=i.easing(s+.01)-i.easing(s),m=.27/Math.sqrt(c*c+1e-4)*.01,g=Math.sqrt(.27*.27-m*m);n=ey(m,g,.25,1)}return this.prevEase={start:vp(),duration:t,easing:n},n}}]),e}(),Vk=jk,Gk=function(){function e(r,t){Ct()(this,e),S()(this,"clickZoom",void 0),S()(this,"tapZoom",void 0),this.clickZoom=r,this.tapZoom=t}return Bt()(e,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),e}(),Hk=function(){function e(r,t,n){Ct()(this,e),S()(this,"inertiaOptions",void 0),S()(this,"el",void 0),S()(this,"mousePan",void 0),S()(this,"touchPan",void 0),this.el=r,this.mousePan=t,this.touchPan=n}return Bt()(e,[{key:"enable",value:function(t){this.inertiaOptions=t||{},this.mousePan.enable(),this.touchPan.enable(),Pi||this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),Pi||this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),e}(),Wk=function(){function e(r,t,n){Ct()(this,e),S()(this,"mouseRotate",void 0),S()(this,"mousePitch",void 0),S()(this,"pitchWithRotate",void 0),this.pitchWithRotate=r.pitchWithRotate,this.mouseRotate=t,this.mousePitch=n}return Bt()(e,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),e}(),Zk=function(){function e(r,t,n,i){Ct()(this,e),S()(this,"el",void 0),S()(this,"touchZoom",void 0),S()(this,"touchRotate",void 0),S()(this,"tapDragZoom",void 0),S()(this,"rotationDisabled",void 0),S()(this,"enabled",void 0),this.el=r,this.touchZoom=t,this.touchRotate=n,this.tapDragZoom=i,this.rotationDisabled=!1,this.enabled=!0}return Bt()(e,[{key:"enable",value:function(t){this.touchZoom.enable(t),this.rotationDisabled||this.touchRotate.enable(t),this.tapDragZoom.enable(),Pi||this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),Pi||this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),e}();function oy(e,r){for(var t={},n=0;n<e.length;n++)t[e[n].identifier]=r[n];return t}function Xk(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Yk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function Yk(e,r){if(!!e){if(typeof e=="string")return VS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return VS(e,r)}}function VS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Kk(e){var r=new Aa(0,0),t=Xk(e),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;r._add(i)}}catch(s){t.e(s)}finally{t.f()}return r.div(e.length)}var GS=500,$k=500,HS=30,qk=function(){function e(r){Ct()(this,e),S()(this,"numTouches",void 0),S()(this,"centroid",void 0),S()(this,"startTime",void 0),S()(this,"aborted",void 0),S()(this,"touches",void 0),this.reset(),this.numTouches=r.numTouches}return Bt()(e,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(t,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=t.timeStamp),i.length===this.numTouches&&(this.centroid=Kk(n),this.touches=oy(i,n)))}},{key:"touchmove",value:function(t,n,i){if(!(this.aborted||!this.centroid)){var s=oy(i,n);for(var c in this.touches)if(this.touches[c]){var m=this.touches[c],g=s[c];(!g||g.dist(m)>HS)&&(this.aborted=!0)}}}},{key:"touchend",value:function(t,n,i){if((!this.centroid||t.timeStamp-this.startTime>$k)&&(this.aborted=!0),i.length===0){var s=!this.aborted&&this.centroid;if(this.reset(),s)return s}}}]),e}(),sy=function(){function e(r){Ct()(this,e),S()(this,"singleTap",void 0),S()(this,"numTaps",void 0),S()(this,"lastTime",void 0),S()(this,"lastTap",void 0),S()(this,"count",void 0),this.singleTap=new qk(r),this.numTaps=r.numTaps,this.reset()}return Bt()(e,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(t,n,i){this.singleTap.touchstart(t,n,i)}},{key:"touchmove",value:function(t,n,i){this.singleTap.touchmove(t,n,i)}},{key:"touchend",value:function(t,n,i){var s=this.singleTap.touchend(t,n,i);if(s){var c=t.timeStamp-this.lastTime<GS,m=!this.lastTap||this.lastTap.dist(s)<HS;if((!c||!m)&&this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=s,this.count===this.numTaps)return this.reset(),s}}}]),e}(),Qk=function(){function e(){Ct()(this,e),S()(this,"enabled",void 0),S()(this,"active",void 0),S()(this,"swipePoint",void 0),S()(this,"swipeTouch",void 0),S()(this,"tapTime",void 0),S()(this,"tap",void 0),this.tap=new sy({numTouches:1,numTaps:1}),this.reset()}return Bt()(e,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(t,n,i){this.swipePoint||(this.tapTime&&t.timeStamp-this.tapTime>GS&&this.reset(),this.tapTime?i.length>0&&(this.swipePoint=n[0],this.swipeTouch=i[0].identifier):this.tap.touchstart(t,n,i))}},{key:"touchmove",value:function(t,n,i){if(!this.tapTime)this.tap.touchmove(t,n,i);else if(this.swipePoint){if(i[0].identifier!==this.swipeTouch)return;var s=n[0],c=s.y-this.swipePoint.y;return this.swipePoint=s,t.preventDefault(),this.active=!0,{zoomDelta:c/128}}}},{key:"touchend",value:function(t,n,i){if(this.tapTime)this.swipePoint&&i.length===0&&this.reset();else{var s=this.tap.touchend(t,n,i);s&&(this.tapTime=t.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}(),Jk=function(){function e(){Ct()(this,e),S()(this,"enabled",void 0),S()(this,"active",void 0),S()(this,"zoomIn",void 0),S()(this,"zoomOut",void 0),this.zoomIn=new sy({numTouches:1,numTaps:2}),this.zoomOut=new sy({numTouches:2,numTaps:1}),this.reset()}return Bt()(e,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(t,n,i){this.zoomIn.touchstart(t,n,i),this.zoomOut.touchstart(t,n,i)}},{key:"touchmove",value:function(t,n,i){this.zoomIn.touchmove(t,n,i),this.zoomOut.touchmove(t,n,i)}},{key:"touchend",value:function(t,n,i){var s=this,c=this.zoomIn.touchend(t,n,i),m=this.zoomOut.touchend(t,n,i);if(c)return this.active=!0,t.preventDefault(),setTimeout(function(){return s.reset()},0),{cameraAnimation:function(x){return x.easeTo({duration:300,zoom:x.getZoom()+1,around:x.unproject(c)},{originalEvent:t})}};if(m)return this.active=!0,t.preventDefault(),setTimeout(function(){return s.reset()},0),{cameraAnimation:function(x){return x.easeTo({duration:300,zoom:x.getZoom()-1,around:x.unproject(m)},{originalEvent:t})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}(),eL=function(){function e(r){Ct()(this,e),S()(this,"enabled",void 0),S()(this,"active",void 0),S()(this,"touches",void 0),S()(this,"minTouches",void 0),S()(this,"clickTolerance",void 0),S()(this,"sum",void 0),this.minTouches=1,this.clickTolerance=r.clickTolerance||1,this.reset()}return Bt()(e,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new Aa(0,0)}},{key:"touchstart",value:function(t,n,i){return this.calculateTransform(t,n,i)}},{key:"touchmove",value:function(t,n,i){if(!!this.active)return t.preventDefault(),this.calculateTransform(t,n,i)}},{key:"touchend",value:function(t,n,i){this.calculateTransform(t,n,i),this.active&&i.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(t,n,i){i.length>0&&(this.active=!0);var s=oy(i,n),c=new Aa(0,0),m=new Aa(0,0),g=0;for(var x in s)if(s[x]){var A=s[x],M=this.touches[x];M&&(c._add(A),m._add(A.sub(M)),g++,s[x]=A)}if(this.touches=s,!(g<this.minTouches||!m.mag())){var R=m.div(g);if(this.sum._add(R),!(this.sum.mag()<this.clickTolerance)){var F=c.div(g);return{around:F,panDelta:R}}}}}]),e}(),uy=function(){function e(){Ct()(this,e),S()(this,"enabled",void 0),S()(this,"active",void 0),S()(this,"firstTwoTouches",void 0),S()(this,"vector",void 0),S()(this,"startVector",void 0),S()(this,"aroundCenter",void 0),this.reset()}return Bt()(e,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(t){}},{key:"move",value:function(t,n,i){}},{key:"touchstart",value:function(t,n,i){this.firstTwoTouches||i.length<2||(this.firstTwoTouches=[i[0].identifier,i[1].identifier],this.start([n[0],n[1]]))}},{key:"touchmove",value:function(t,n,i){if(!!this.firstTwoTouches){t.preventDefault();var s=ri()(this.firstTwoTouches,2),c=s[0],m=s[1],g=L0(i,n,c),x=L0(i,n,m);if(!(!g||!x)){var A=this.aroundCenter?null:g.add(x).div(2);return this.move([g,x],A,t)}}}},{key:"touchend",value:function(t,n,i){if(!!this.firstTwoTouches){var s=ri()(this.firstTwoTouches,2),c=s[0],m=s[1],g=L0(i,n,c),x=L0(i,n,m);g&&x||(this.active&&Gu.suppressClick(),this.reset())}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(t){this.enabled=!0,this.aroundCenter=!!t&&t.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}();function L0(e,r,t){for(var n=0;n<e.length;n++)if(e[n].identifier===t)return r[n]}function tL(e){var r=rL();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function rL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function ly(e){return Math.abs(e.y)>Math.abs(e.x)}var nL=100,iL=function(e){Nr()(t,e);var r=tL(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"valid",void 0),S()(oe()(n),"firstMove",void 0),S()(oe()(n),"lastPoints",void 0),n}return Bt()(t,[{key:"reset",value:function(){np()(mt()(t.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(i){this.lastPoints=i,ly(i[0].sub(i[1]))&&(this.valid=!1)}},{key:"move",value:function(i,s,c){var m=i[0].sub(this.lastPoints[0]),g=i[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(m,g,c.timeStamp),!!this.valid){this.lastPoints=i,this.active=!0;var x=(m.y+g.y)/2,A=-.5;return{pitchDelta:x*A}}}},{key:"gestureBeginsVertically",value:function(i,s,c){if(this.valid!==void 0)return this.valid;var m=2,g=i.mag()>=m,x=s.mag()>=m;if(!(!g&&!x)){if(!g||!x)return this.firstMove===void 0&&(this.firstMove=c),c-this.firstMove<nL?void 0:!1;var A=i.y>0==s.y>0;return ly(i)&&ly(s)&&A}}}]),t}(uy);function aL(e){var r=oL();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function oL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var sL=25;function WS(e,r){return e.angleWith(r)*180/Math.PI}var uL=function(e){Nr()(t,e);var r=aL(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"minDiameter",void 0),n}return Bt()(t,[{key:"reset",value:function(){np()(mt()(t.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(i){this.startVector=this.vector=i[0].sub(i[1]),this.minDiameter=i[0].dist(i[1])}},{key:"move",value:function(i,s){var c=this.vector;if(this.vector=i[0].sub(i[1]),!(!this.active&&this.isBelowThreshold(this.vector)))return this.active=!0,{bearingDelta:WS(this.vector,c),pinchAround:s}}},{key:"isBelowThreshold",value:function(i){this.minDiameter=Math.min(this.minDiameter,i.mag());var s=Math.PI*this.minDiameter,c=sL/s*360,m=WS(i,this.startVector);return Math.abs(m)<c}}]),t}(uy);function lL(e){var r=cL();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function cL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fL=.1;function ZS(e,r){return Math.log(e/r)/Math.LN2}var hL=function(e){Nr()(t,e);var r=lL(t);function t(){var n;Ct()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),S()(oe()(n),"distance",void 0),S()(oe()(n),"startDistance",void 0),n}return Bt()(t,[{key:"reset",value:function(){np()(mt()(t.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(i){this.startDistance=this.distance=i[0].dist(i[1])}},{key:"move",value:function(i,s){var c=this.distance;if(this.distance=i[0].dist(i[1]),!(!this.active&&Math.abs(ZS(this.distance,this.startDistance))<fL))return this.active=!0,{zoomDelta:ZS(this.distance,c),pinchAround:s}}}]),t}(uy);function ud(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=pL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function pL(e,r){if(!!e){if(typeof e=="string")return XS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return XS(e,r)}}function XS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var D0=function(r){return r.zoom||r.drag||r.pitch||r.rotate};function cy(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}var dL=function(){function e(r,t){var n=this;Ct()(this,e),S()(this,"map",void 0),S()(this,"el",void 0),S()(this,"handlers",void 0),S()(this,"eventsInProgress",void 0),S()(this,"frameId",void 0),S()(this,"inertia",void 0),S()(this,"bearingSnap",void 0),S()(this,"handlersById",void 0),S()(this,"updatingCamera",void 0),S()(this,"changes",void 0),S()(this,"previousActiveHandlers",void 0),S()(this,"bearingChanged",void 0),S()(this,"listeners",void 0),S()(this,"handleWindowEvent",function(M){n.handleEvent(M,"".concat(M.type,"Window"))}),S()(this,"handleEvent",function(M,R){if(M.type==="blur"){n.stop();return}n.updatingCamera=!0;var F=M.type==="renderFrame"?void 0:M,Y={needsRenderFrame:!1},ie={},le={},Ae=M.touches?n.getMapTouches(M.touches):void 0,Xe=Ae?Gu.touchPos(n.el,Ae):Gu.mousePos(n.el,M),nt=ud(n.handlers),at;try{for(nt.s();!(at=nt.n()).done;){var It=at.value,Ot=It.handlerName,Ut=It.handler,$t=It.allowed;if(!!Ut.isEnabled()){var Tr=void 0;if(n.blockedByActive(le,$t,Ot))Ut.reset();else{var Dr=R||M.type;Ut&&Ut[Dr]&&(Tr=Ut[Dr](M,Xe,Ae),n.mergeIHandlerResult(Y,ie,Tr,Ot,F),Tr&&Tr.needsRenderFrame&&n.triggerRenderFrame())}(Tr||Ut.isActive())&&(le[Ot]=Ut)}}}catch(ai){nt.e(ai)}finally{nt.f()}var Sr={};for(var Sn in n.previousActiveHandlers)le[Sn]||(Sr[Sn]=F);n.previousActiveHandlers=le,(Object.keys(Sr).length||cy(Y))&&(n.changes.push([Y,ie,Sr]),n.triggerRenderFrame()),(Object.keys(le).length||cy(Y))&&n.map.stop(!0),n.updatingCamera=!1;var Dn=Y.cameraAnimation;Dn&&(n.inertia.clear(),n.fireEvents({},{}),n.changes=[],Dn(n.map))}),this.map=r,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new bk(r),this.bearingSnap=t.bearingSnap,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(t);var i=this.el;if(this.listeners=[],Pi)Kn.document.addEventListener("touchstart",function(M){n.handleEvent(M)},{}),Kn.document.addEventListener("touchmove",function(M){n.handleEvent(M)},{}),Kn.document.addEventListener("touchend",function(M){n.handleEvent(M)},{}),Kn.document.addEventListener("touchcancel",function(M){n.handleEvent(M)},{});else{this.listeners=[[i,"touchstart",{passive:!1}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[window,"blur",void 0]];var s=ud(this.listeners),c;try{for(s.s();!(c=s.n()).done;){var m=ri()(c.value,3),g=m[0],x=m[1],A=m[2];Gu.addEventListener(g,x,g===window.document?this.handleWindowEvent:this.handleEvent,A)}}catch(M){s.e(M)}finally{s.f()}}}return Bt()(e,[{key:"destroy",value:function(){var t=ud(this.listeners),n;try{for(t.s();!(n=t.n()).done;){var i=ri()(n.value,3),s=i[0],c=i[1],m=i[2];Gu.removeEventListener(s,c,s===window.document?this.handleWindowEvent:this.handleEvent,m)}}catch(g){t.e(g)}finally{t.f()}}},{key:"stop",value:function(){if(!this.updatingCamera){var t=ud(this.handlers),n;try{for(t.s();!(n=t.n()).done;){var i=n.value.handler;i.reset()}}catch(s){t.e(s)}finally{t.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}}},{key:"isActive",value:function(){var t=ud(this.handlers),n;try{for(t.s();!(n=t.n()).done;){var i=n.value.handler;if(i.isActive())return!0}}catch(s){t.e(s)}finally{t.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(D0(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(t,n,i,s,c){if(!!i){_o()(t,i);var m={handlerName:s,originalEvent:i.originalEvent||c};i.zoomDelta!==void 0&&(n.zoom=m),i.panDelta!==void 0&&(n.drag=m),i.pitchDelta!==void 0&&(n.pitch=m),i.bearingDelta!==void 0&&(n.rotate=m)}}},{key:"triggerRenderFrame",value:function(){var t=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(n){delete t.frameId,t.handleEvent(new dk("renderFrame",{timeStamp:n})),t.applyChanges()}))}},{key:"addDefaultHandlers",value:function(t){var n=this.map,i=n.getCanvasContainer();this.add("mapEvent",new wk(n,t));var s=n.boxZoom=new ck(n,t);this.add("boxZoom",s);var c=new Jk,m=new fk;n.doubleClickZoom=new Gk(m,c),this.add("tapZoom",c),this.add("clickZoom",m);var g=new Qk;this.add("tapDragZoom",g);var x=n.touchPitch=new iL;this.add("touchPitch",x);var A=new Lk(t),M=new Bk(t);n.dragRotate=new Wk(t,A,M),this.add("mouseRotate",A,["mousePitch"]),this.add("mousePitch",M,["mouseRotate"]);var R=new Ik(t),F=new eL(t);n.dragPan=new Hk(i,R,F),this.add("mousePan",R),this.add("touchPan",F,["touchZoom","touchRotate"]);var Y=new uL,ie=new hL;n.touchZoomRotate=new Zk(i,ie,Y,g),this.add("touchRotate",Y,["touchPan","touchZoom"]),this.add("touchZoom",ie,["touchPan","touchRotate"]);var le=n.scrollZoom=new Vk(n,this);this.add("scrollZoom",le,["mousePan"]);var Ae=n.keyboard=new Ak;this.add("keyboard",Ae),this.add("blockableMapEvent",new uk(n));for(var Xe=0,nt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Xe<nt.length;Xe++){var at=nt[Xe];t.interactive&&t[at]&&n[at].enable(t[at])}}},{key:"add",value:function(t,n,i){this.handlers.push({handlerName:t,handler:n,allowed:i}),this.handlersById[t]=n}},{key:"blockedByActive",value:function(t,n,i){for(var s in t)if(s!==i&&(!n||n.indexOf(s)<0))return!0;return!1}},{key:"getMapTouches",value:function(t){var n=[],i=ud(t),s;try{for(i.s();!(s=i.n()).done;){var c=s.value,m=c.target;(Pi||this.el.contains(m))&&n.push(c)}}catch(g){i.e(g)}finally{i.f()}return n}},{key:"applyChanges",value:function(){var t={},n={},i={},s=ud(this.changes),c;try{for(s.s();!(c=s.n()).done;){var m=ri()(c.value,3),g=m[0],x=m[1],A=m[2];g.panDelta&&(t.panDelta=(t.panDelta||new Aa(0,0))._add(g.panDelta)),g.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+g.pitchDelta),g.around!==void 0&&(t.around=g.around),g.pinchAround!==void 0&&(t.pinchAround=g.pinchAround),g.noInertia&&(t.noInertia=g.noInertia),_o()(n,x),_o()(i,A)}}catch(M){s.e(M)}finally{s.f()}this.updateMapTransform(t,n,i),this.changes=[]}},{key:"updateMapTransform",value:function(t,n,i){var s=this.map,c=s.transform;if(!cy(t))return this.fireEvents(n,i);var m=t.panDelta,g=t.zoomDelta,x=t.bearingDelta,A=t.pitchDelta,M=t.pinchAround,R=t.around;M!==void 0&&(R=M),s.stop(!0),R=R||s.transform.centerPoint;var F=c.pointLocation(m?R.sub(m):R);x&&(c.bearing+=x),A&&(c.pitch+=A),g&&(c.zoom+=g),c.setLocationAtPoint(F,R),this.map.update(),t.noInertia||this.inertia.record(t),this.fireEvents(n,i)}},{key:"fireEvents",value:function(t,n){var i=this,s=D0(this.eventsInProgress),c=D0(t),m={};for(var g in t)if(t[g]){var x=t[g].originalEvent;this.eventsInProgress[g]||(m["".concat(g,"start")]=x),this.eventsInProgress[g]=t[g]}!s&&c&&this.fireEvent("movestart",c.originalEvent);for(var A in m)m[A]&&this.fireEvent(A,m[A]);t.rotate&&(this.bearingChanged=!0),c&&this.fireEvent("move",c.originalEvent);for(var M in t)if(t[M]){var R=t[M].originalEvent;this.fireEvent(M,R)}var F={},Y;for(var ie in this.eventsInProgress)if(this.eventsInProgress[ie]){var le=this.eventsInProgress[ie],Ae=le.handlerName,Xe=le.originalEvent;this.handlersById[Ae].isActive()||(delete this.eventsInProgress[ie],Y=n[Ae]||Xe,F["".concat(ie,"end")]=Y)}for(var nt in F)F[nt]&&this.fireEvent(nt,F[nt]);var at=D0(this.eventsInProgress);if((s||c)&&!at){this.updatingCamera=!0;var It=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),Ot=function($t){return $t!==0&&-i.bearingSnap<$t&&$t<i.bearingSnap};It?(Ot(It.bearing||this.map.getBearing())&&(It.bearing=0),this.map.easeTo(It,{originalEvent:Y})):(this.map.emit("moveend",new eo("moveend",{originalEvent:Y})),Ot(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(t,n){this.map.emit(t,new eo(t,n?{originalEvent:n}:{}))}}]),e}(),YS=dL,vL=w("DzJC"),mL=w.n(vL),gL=function(){function e(r){var t=this;Ct()(this,e),S()(this,"map",void 0),S()(this,"updateHash",void 0),S()(this,"hashName",void 0),S()(this,"onHashChange",function(){var n=t.getCurrentHash();if(n.length>=3&&!n.some(function(s){return isNaN(+s)})){var i=t.map.dragRotate.isEnabled()&&t.map.touchZoomRotate.isEnabled()?+(n[3]||0):t.map.getBearing();return t.map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:i,pitch:+(n[4]||0)}),!0}return!1}),S()(this,"getCurrentHash",function(){var n=window.location.hash.replace("#","");if(t.hashName){var i;return n.split("&").map(function(s){return s.split("=")}).forEach(function(s){s[0]===t.hashName&&(i=s)}),(i&&i[1]||"").split("/")}return n.split("/")}),S()(this,"updateHashUnthrottled",function(){var n=t.getHashString();try{window.history.replaceState(window.history.state,"",n)}catch(i){}}),this.hashName=r&&encodeURIComponent(r),this.updateHash=mL()(this.updateHashUnthrottled,30*1e3/100)}return Bt()(e,[{key:"addTo",value:function(t){return this.map=t,Kn.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return Kn.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(t){var n=this.map.getCenter(),i=Math.round(this.map.getZoom()*100)/100,s=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),c=Math.pow(10,s),m=Math.round(n.lng*c)/c,g=Math.round(n.lat*c)/c,x=this.map.getBearing(),A=this.map.getPitch(),M="";if(t?M+="/".concat(m,"/").concat(g,"/").concat(i):M+="".concat(i,"/").concat(g,"/").concat(m),(x||A)&&(M+="/".concat(Math.round(x*10)/10)),A&&(M+="/".concat(Math.round(A))),this.hashName){var R=this.hashName,F=!1,Y=window.location.hash.slice(1).split("&").map(function(ie){var le=ie.split("=")[0];return le===R?(F=!0,"".concat(le,"=").concat(M)):ie}).filter(function(ie){return ie});return F||Y.push("".concat(R,"=").concat(M)),"#".concat(Y.join("&"))}return"#".concat(M)}}]),e}(),yL=gL,F0=null,fm=[],_L=30,fy=1e3/_L,rv=Kn.performance,nv={create:"create",load:"load",fullLoad:"fullLoad"},B0={mark:function(r){rv.mark(r)},frame:function(r){var t=r;if(F0!=null){var n=t-F0;fm.push(n)}F0=t},clearMetrics:function(){F0=null,fm=[],rv.clearMeasures("loadTime"),rv.clearMeasures("fullLoadTime");for(var r in nv)rv.clearMarks(nv[r])},getPerformanceMetrics:function(){var r=rv.measure("loadTime",nv.create,nv.load).duration,t=rv.measure("fullLoadTime",nv.create,nv.fullLoad).duration,n=fm.length,i=fm.reduce(function(g,x){return g+x},0)/n/1e3,s=1/i,c=fm.filter(function(g){return g>fy}).reduce(function(g,x){return g+(x-fy)/fy},0),m=c/(n+c)*100;return{loadTime:r,fullLoadTime:t,fps:s,percentDroppedFrames:m}}};function KS(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=xL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,m;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return s=x.done,x},e:function(x){c=!0,m=x},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw m}}}}function xL(e,r){if(!!e){if(typeof e=="string")return $S(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return $S(e,r)}}function $S(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var bL=function(){function e(){Ct()(this,e),S()(this,"queue",void 0),S()(this,"id",void 0),S()(this,"cleared",void 0),S()(this,"currentlyRunning",void 0),this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return Bt()(e,[{key:"add",value:function(t){var n=++this.id,i=this.queue;return i.push({callback:t,id:n,cancelled:!1}),n}},{key:"remove",value:function(t){var n=this.currentlyRunning,i=n?this.queue.concat(n):this.queue,s=KS(i),c;try{for(s.s();!(c=s.n()).done;){var m=c.value;if(m.id===t){m.cancelled=!0;return}}}catch(g){s.e(g)}finally{s.f()}}},{key:"run",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=this.currentlyRunning=this.queue;this.queue=[];var i=KS(n),s;try{for(i.s();!(s=i.n()).done;){var c=s.value;if(!c.cancelled&&(c.callback(t),this.cleared))break}}catch(m){i.e(m)}finally{i.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),e}(),qS=bL;function EL(e){var r=SL();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function SL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function CL(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}CL(`.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var N0=-2,QS=22,iv=0,z0=60,AL={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:N0,maxZoom:QS,minPitch:iv,maxPitch:z0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},JS=function(e){Nr()(t,e);var r=EL(t);function t(n){var i;if(Ct()(this,t),i=r.call(this,_o()({},AL,n)),S()(oe()(i),"doubleClickZoom",void 0),S()(oe()(i),"dragRotate",void 0),S()(oe()(i),"dragPan",void 0),S()(oe()(i),"touchZoomRotate",void 0),S()(oe()(i),"scrollZoom",void 0),S()(oe()(i),"keyboard",void 0),S()(oe()(i),"touchPitch",void 0),S()(oe()(i),"boxZoom",void 0),S()(oe()(i),"handlers",void 0),S()(oe()(i),"container",void 0),S()(oe()(i),"canvas",void 0),S()(oe()(i),"canvasContainer",void 0),S()(oe()(i),"renderTaskQueue",new qS),S()(oe()(i),"frame",void 0),S()(oe()(i),"trackResize",!0),S()(oe()(i),"hash",void 0),S()(oe()(i),"onWindowOnline",function(){i.update()}),S()(oe()(i),"onWindowResize",function(c){i.trackResize&&i.resize({originalEvent:c}).update()}),Pi?i.initMiniContainer():i.initContainer(),i.resize(),i.handlers=new YS(oe()(i),i.options),typeof window!="undefined"&&(window.addEventListener("online",i.onWindowOnline,!1),window.addEventListener("resize",i.onWindowResize,!1),window.addEventListener("orientationchange",i.onWindowResize,!1)),!Pi){var s=typeof n.hash=="string"&&n.hash||void 0;n.hash&&(i.hash=new yL(s).addTo(oe()(i)))}return(!i.hash||!i.hash.onHashChange())&&(i.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(i.resize(),i.fitBounds(n.bounds,_o()({},n.fitBoundsOptions,{duration:0})))),i}return Bt()(t,[{key:"resize",value:function(i){var s=this.containerDimensions(),c=s[0],m=s[1];if(this.transform.resize(c,m),Pi)return this;var g=!this.moving;return g&&(this.stop(),this.emit("movestart",new Kn.Event("movestart",i)),this.emit("move",new Kn.Event("move",i))),this.emit("resize",new Kn.Event("resize",i)),g&&this.emit("moveend",new Kn.Event("moveend",i)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(i){return this.transform.locationPoint(Bo.convert(i))}},{key:"unproject",value:function(i){return this.transform.pointLocation(Aa.convert(i))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(i){this.transform.setMaxBounds(lm.convert(i))}},{key:"setStyle",value:function(i){}},{key:"setMinZoom",value:function(i){if(i=i==null?N0:i,i>=N0&&i<=this.transform.maxZoom)return this.transform.minZoom=i,this.getZoom()<i&&this.setZoom(i),this;throw new Error("minZoom must be between ".concat(N0," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(i){if(i=i==null?QS:i,i>=this.transform.minZoom)return this.transform.maxZoom=i,this.getZoom()>i&&this.setZoom(i),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(i){if(i=i==null?iv:i,i<iv)throw new Error("minPitch must be greater than or equal to ".concat(iv));if(i>=iv&&i<=this.transform.maxPitch)return this.transform.minPitch=i,this.getPitch()<i&&this.setPitch(i),this;throw new Error("minPitch must be between ".concat(iv," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(i){if(i=i==null?z0:i,i>z0)throw new Error("maxPitch must be less than or equal to ".concat(z0));if(i>=this.transform.minPitch)return this.transform.maxPitch=i,this.getPitch()>i&&this.setPitch(i),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(i){this.transform.renderWorldCopies=!!i}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(i){return this.update(),this.renderTaskQueue.add(i)}},{key:"cancelRenderFrame",value:function(i){return this.renderTaskQueue.remove(i)}},{key:"triggerRepaint",value:function(){var i=this;this.frame||(this.frame=E0(function(s){B0.frame(s),i.frame=null,i.update(s)}))}},{key:"update",value:function(i){var s=this;this.frame||(this.frame=E0(function(c){B0.frame(c),s.frame=null,s.renderTaskQueue.run(i)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var i=this.container;i.classList.add("l7-map");var s=this.canvasContainer=N.create("div","l7-canvas-container",i);this.options.interactive&&s.classList.add("l7-interactive")}},{key:"initMiniContainer",value:function(){this.container=this.options.canvas,this.canvasContainer=this.container}},{key:"containerDimensions",value:function(){var i=0,s=0;return this.container&&(Pi?(i=this.container.width/Kn.devicePixelRatio,s=this.container.height/Kn.devicePixelRatio):(i=this.container.clientWidth,s=this.container.clientHeight)),[i,s]}}]),t}(DS);function wL(e){var r=TL();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function TL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function ML(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}ML(`.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var U0=-2,eC=22,av=0,j0=60,PL={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:U0,maxZoom:eC,minPitch:av,maxPitch:j0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},z6=function(e){Nr()(t,e);var r=wL(t);function t(n){var i;return Ct()(this,t),i=r.call(this,_o()({},PL,n)),S()(oe()(i),"doubleClickZoom",void 0),S()(oe()(i),"dragRotate",void 0),S()(oe()(i),"dragPan",void 0),S()(oe()(i),"touchZoomRotate",void 0),S()(oe()(i),"scrollZoom",void 0),S()(oe()(i),"keyboard",void 0),S()(oe()(i),"touchPitch",void 0),S()(oe()(i),"boxZoom",void 0),S()(oe()(i),"handlers",void 0),S()(oe()(i),"container",void 0),S()(oe()(i),"canvas",void 0),S()(oe()(i),"canvasContainer",void 0),S()(oe()(i),"renderTaskQueue",new qS),S()(oe()(i),"frame",void 0),S()(oe()(i),"trackResize",!0),S()(oe()(i),"onWindowOnline",function(){i.update()}),S()(oe()(i),"onWindowResize",function(s){i.trackResize&&i.resize({originalEvent:s}).update()}),i.initContainer(),i.resize(),i.handlers=new YS(oe()(i),i.options),typeof window!="undefined"&&(window.addEventListener("online",i.onWindowOnline,!1),window.addEventListener("resize",i.onWindowResize,!1),window.addEventListener("orientationchange",i.onWindowResize,!1)),i}return Bt()(t,[{key:"resize",value:function(i){var s=this.containerDimensions(),c=s[0],m=s[1];this.transform.resize(c,m);var g=!this.moving;return g&&(this.stop(),this.emit("movestart",new Event("movestart",i)),this.emit("move",new Event("move",i))),this.emit("resize",new Event("resize",i)),g&&this.emit("moveend",new Event("moveend",i)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(i){return this.transform.locationPoint(Bo.convert(i))}},{key:"unproject",value:function(i){return this.transform.pointLocation(Aa.convert(i))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(i){this.transform.setMaxBounds(lm.convert(i))}},{key:"setStyle",value:function(i){}},{key:"setMinZoom",value:function(i){if(i=i==null?U0:i,i>=U0&&i<=this.transform.maxZoom)return this.transform.minZoom=i,this.getZoom()<i&&this.setZoom(i),this;throw new Error("minZoom must be between ".concat(U0," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(i){if(i=i==null?eC:i,i>=this.transform.minZoom)return this.transform.maxZoom=i,this.getZoom()>i&&this.setZoom(i),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(i){if(i=i==null?av:i,i<av)throw new Error("minPitch must be greater than or equal to ".concat(av));if(i>=av&&i<=this.transform.maxPitch)return this.transform.minPitch=i,this.getPitch()<i&&this.setPitch(i),this;throw new Error("minPitch must be between ".concat(av," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(i){if(i=i==null?j0:i,i>j0)throw new Error("maxPitch must be less than or equal to ".concat(j0));if(i>=this.transform.minPitch)return this.transform.maxPitch=i,this.getPitch()>i&&this.setPitch(i),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(i){this.transform.renderWorldCopies=!!i}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(i){return this.update(),this.renderTaskQueue.add(i)}},{key:"cancelRenderFrame",value:function(i){return this.renderTaskQueue.remove(i)}},{key:"triggerRepaint",value:function(){var i=this;this.frame||(this.frame=E0(function(s){B0.frame(s),i.frame=null,i.update(s)}))}},{key:"update",value:function(i){var s=this;this.frame||(this.frame=E0(function(c){B0.frame(c),s.frame=null,s.renderTaskQueue.run(i)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var i=this.container;i.classList.add("l7-map");var s=this.canvasContainer=N.create("div","l7-canvas-container",i);this.options.interactive&&s.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var i=0,s=0;return this.container&&(i=this.container.clientWidth||400,s=this.container.clientHeight||300),[i,s]}},{key:"resizeCanvas",value:function(i,s){var c=N.DPR||1;this.canvas.width=c*i,this.canvas.height=c*s,this.canvas.style.width="".concat(i,"px"),this.canvas.style.height="".concat(s,"px")}}]),t}(DS),tC=function(){function e(){Ct()(this,e),S()(this,"viewport",void 0)}return Bt()(e,[{key:"syncWithMapCamera",value:function(t){var n=t.center,i=t.zoom,s=t.pitch,c=t.bearing,m=t.viewportHeight,g=t.viewportWidth;this.viewport=new $g({width:g,height:m,longitude:n&&n[0],latitude:n&&n[1],zoom:i,pitch:s,bearing:c})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,n){return this.viewport.projectFlat(t,n)}}]),e}(),rC={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},OL=["id","attributionControl","style","rotation","mapInstance"],IL=["id","attributionControl","style","rotation","mapInstance","canvas","hasBaseMap"],nC,iC,aC,oC,sC,uC,ov,lC,cC,fC,hC;function pC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function dC(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?pC(Object(t),!0).forEach(function(n){S()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var vC={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},mC=12,RL=(nC=Object(Cr.injectable)(),iC=Object(Cr.inject)(Kt.MapConfig),aC=Object(Cr.inject)(Kt.IGlobalConfigService),oC=Object(Cr.inject)(Kt.ICoordinateSystemService),sC=Object(Cr.inject)(Kt.IEventEmitter),nC(uC=(ov=function(){function e(){var r=this;Ct()(this,e),S()(this,"version",eh.L7MAP),S()(this,"map",void 0),S()(this,"dragging",!1),S()(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),Ei()(this,"config",lC,this),Ei()(this,"configService",cC,this),Ei()(this,"coordinateSystemService",fC,this),Ei()(this,"eventEmitter",hC,this),S()(this,"viewport",void 0),S()(this,"markerContainer",void 0),S()(this,"cameraChangedCallback",void 0),S()(this,"$mapContainer",void 0),S()(this,"handleMiniCameraChanged",function(t,n,i,s,c){var m=r.config.offsetCoordinate,g=m===void 0?!0:m;r.viewport.syncWithMapCamera({bearing:s,center:[t,n],viewportHeight:r.map.transform.height,pitch:c,viewportWidth:r.map.transform.width,zoom:i,cameraHeight:0}),r.viewport.getZoom()>mC&&g?r.coordinateSystemService.setCoordinateSystem(Vs.LNGLAT_OFFSET):r.coordinateSystemService.setCoordinateSystem(Vs.LNGLAT),r.cameraChangedCallback(r.viewport)}),S()(this,"handleCameraChanged",function(){var t=r.map.getCenter(),n=t.lat,i=t.lng,s=r.config.offsetCoordinate,c=s===void 0?!0:s;r.emit("mapchange"),r.viewport.syncWithMapCamera({bearing:r.map.getBearing(),center:[i,n],viewportHeight:r.map.transform.height,pitch:r.map.getPitch(),viewportWidth:r.map.transform.width,zoom:r.map.getZoom(),cameraHeight:0}),r.viewport.getZoom()>mC&&c?r.coordinateSystemService.setCoordinateSystem(Vs.LNGLAT_OFFSET):r.coordinateSystemService.setCoordinateSystem(Vs.LNGLAT),r.cameraChangedCallback(r.viewport)})}return Bt()(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"addMarkerContainer",value:function(){var t=this.map.getCanvasContainer();this.markerContainer=N.create("div","l7-marker-container",t),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,n){zd.indexOf(t)!==-1?this.eventEmitter.on(t,n):this.map.on(vC[t]||t,n)}},{key:"off",value:function(t,n){this.map.off(vC[t]||t,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var t=this.map.transform;return[t.width,t.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(t){return this.map.setZoom(t)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(t){this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(t){this.map.setBearing(t)}},{key:"zoomIn",value:function(t,n){this.map.zoomIn(t,n)}},{key:"zoomOut",value:function(t,n){this.map.zoomOut(t,n)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.panTo([t,n])}},{key:"fitBounds",value:function(t,n){this.map.fitBounds(t,n)}},{key:"setMaxZoom",value:function(t){this.map.setMaxZoom(t)}},{key:"setMinZoom",value:function(t){this.map.setMinZoom(t)}},{key:"setMapStatus",value:function(t){t.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),t.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),t.dragEnable===!1&&this.map.dragPan.disable(),t.dragEnable===!0&&this.map.dragPan.enable(),t.rotateEnable===!1&&this.map.dragRotate.disable(),t.dragEnable===!0&&this.map.dragRotate.enable(),t.keyboardEnable===!1&&this.map.keyboard.disable(),t.keyboardEnable===!0&&this.map.keyboard.enable(),t.zoomEnable===!1&&this.map.scrollZoom.disable(),t.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(t,n){this.map.flyTo({zoom:t,center:n})}},{key:"setMapStyle",value:function(t){this.map.setStyle(this.getMapStyle(t))}},{key:"pixelToLngLat",value:function(t){return this.map.unproject(t)}},{key:"lngLatToPixel",value:function(t){return this.map.project(t)}},{key:"containerToLngLat",value:function(t){return this.map.unproject(t)}},{key:"lngLatToContainer",value:function(t){return this.map.project(t)}},{key:"lngLatToMercator",value:function(t,n){throw new Error("not implement")}},{key:"getModelMatrix",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var r=as()(la.a.mark(function n(){var i=this,s,c,m,g,x,A,M,R,F,Y,ie;return la.a.wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:s=this.config,c=s.id,m=c===void 0?"map":c,g=s.attributionControl,x=g===void 0?!1:g,A=s.style,M=A===void 0?"light":A,R=s.rotation,F=R===void 0?0:R,Y=s.mapInstance,ie=Ah()(s,OL),this.viewport=new tC,Y?(this.map=Y,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(m),this.map=new JS(dC({container:this.$mapContainer,style:this.getMapStyle(M),bearing:F},ie))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.map.on("dragstart",function(){return i.dragging=!0,""}),this.map.on("dragend",function(){return i.dragging=!1,""}),this.handleCameraChanged();case 8:case"end":return Ae.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"initMiniMap",value:function(){var r=as()(la.a.mark(function n(){var i=this,s,c,m,g,x,A,M,R,F,Y,ie,le,Ae,Xe,nt,at;return la.a.wrap(function(Ot){for(;;)switch(Ot.prev=Ot.next){case 0:s=this.config,c=s.id,m=c===void 0?"map":c,g=s.attributionControl,x=g===void 0?!1:g,A=s.style,M=A===void 0?"light":A,R=s.rotation,F=R===void 0?0:R,Y=s.mapInstance,ie=s.canvas,le=ie===void 0?null:ie,Ae=s.hasBaseMap,Xe=Ae===void 0?!1:Ae,nt=Ah()(s,IL),this.viewport=new tC,this.$mapContainer=le,this.map=new JS(dC({container:this.$mapContainer,style:this.getMapStyle(M),bearing:F,canvas:le},nt)),Xe?(at=this.map.getCenter(),this.handleMiniCameraChanged(at.lng,at.lat,this.map.getZoom(),this.map.getBearing(),this.map.getPitch()),Kn.document.addEventListener("mapCameaParams",function(Ut){var $t=Ut.e,Tr=$t.longitude,Dr=$t.latitude,Sr=$t.scale,Sn=$t.bearing,Dn=$t.pitch;i.handleMiniCameraChanged(Tr,Dr,Sr-1.25,Sn,Dn)})):(this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged());case 5:case"end":return Ot.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"destroy",value:function(){var t,n;(t=this.$mapContainer)===null||t===void 0||(n=t.parentNode)===null||n===void 0||n.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).emit.apply(n,[t].concat(s))}},{key:"once",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).once.apply(n,[t].concat(s))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(t){var n=this.map.getCanvas(),i=t==="jpg"?n==null?void 0:n.toDataURL("image/jpeg"):n==null?void 0:n.toDataURL("image/png");return i}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"creatAmapContainer",value:function(t){var n=t;return typeof t=="string"&&(n=document.getElementById(t)),n}},{key:"getMapStyle",value:function(t){return typeof t!="string"?t:rC[t]?rC[t]:t}}]),e}(),lC=yi()(ov.prototype,"config",[iC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cC=yi()(ov.prototype,"configService",[aC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fC=yi()(ov.prototype,"coordinateSystemService",[oC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hC=yi()(ov.prototype,"eventEmitter",[sC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ov))||uC);function kL(e){var r=LL();return function(){var n=mt()(e),i;if(r){var s=mt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $r()(this,i)}}function LL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var DL=function(e){Nr()(t,e);var r=kL(t);function t(){return Ct()(this,t),r.apply(this,arguments)}return Bt()(t,[{key:"getServiceConstructor",value:function(){return RL}}]),t}(d0);function gC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function yC(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?gC(Object(t),!0).forEach(function(n){FL(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):gC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function FL(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function BL(e,r){return jL(e)||UL(e,r)||zL(e,r)||NL()}function NL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zL(e,r){if(!!e){if(typeof e=="string")return _C(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _C(e,r)}}function _C(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function UL(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,m;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(g){s=!0,m=g}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw m}}return n}}function jL(e){if(Array.isArray(e))return e}var VL=se.a.memo(function(e){var r=e.style,t=e.className,n=e.map,i=e.option,s=e.onSceneLoaded,c=e.children,m=Object(Q.useRef)(null),g=Object(Q.useState)(),x=BL(g,2),A=x[0],M=x[1];return Object(Q.useEffect)(function(){var R=new Zv(yC(yC({id:m.current},i),{},{map:new DL(n)}));return R.on("loaded",function(){M(R),s&&s(R)}),function(){R.destroy()}},[]),Object(Q.useEffect)(function(){A&&n.style&&A.setMapStyle(n.style)},[JSON.stringify(n.style)]),Object(Q.useEffect)(function(){A&&n.zoom&&A.setZoom(n.zoom)},[n.zoom]),Object(Q.useEffect)(function(){A&&n.center&&A.setCenter(n.center)},[JSON.stringify(n.center)]),Object(Q.useEffect)(function(){A&&n.pitch&&A.setPitch(n.pitch)},[n.pitch]),Object(Q.useEffect)(function(){A&&n.rotation&&A.setRotation(n.rotation)},[n.rotation]),se.a.createElement(Ce.Provider,{value:A},se.a.createElement("div",{ref:m,className:t,style:r},A&&c))}),U6=VL;function GL(e,r){return XL(e)||ZL(e,r)||WL(e,r)||HL()}function HL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WL(e,r){if(!!e){if(typeof e=="string")return xC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xC(e,r)}}function xC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function ZL(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,m;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(g){s=!0,m=g}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw m}}return n}}function XL(e){if(Array.isArray(e))return e}var j6=se.a.memo(function(e){var r=e.style,t=e.className,n=e.map,i=e.children,s=Object(Q.useRef)(null),c=Object(Q.useState)(),m=GL(c,2),g=m[0],x=m[1];return Object(Q.useEffect)(function(){var A=new Zv({id:s.current,map:n});return A.on("loaded",function(){x(A)}),function(){A.destroy()}},[]),se.a.createElement(Ce.Provider,{value:g},se.a.createElement("div",{ref:s,className:t,style:r},g&&i))}),YL=["type","position"];function bC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function hy(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?bC(Object(t),!0).forEach(function(n){KL(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):bC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function KL(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function $L(e,r){if(e==null)return{};var t=qL(e,r),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(t[n]=e[n]))}return t}function qL(e,r){if(e==null)return{};var t={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(r.indexOf(i)>=0)&&(t[i]=e[i]);return t}var V6=se.a.memo(function(r){var t=be(),n=Object(Q.useRef)(),i=r.type,s=r.position,c=$L(r,YL);return Object(Q.useEffect)(function(){var m;switch(i){case"scale":m=new Jw({position:s||"bottomright"});break;case"zoom":m=new rT(hy({position:s||"topright"},c));break;case"logo":m=new w1(hy({position:s||"bottomleft"},c));case"layer":m=new Yw(hy({position:s||"bottomleft"},c))}return n.current=m,t.addControl(m),function(){n.current=void 0,t.removeControl(m)}},[i]),Object(Q.useEffect)(function(){n.current&&n.current.setPosition(s||"bottomleft")},[s]),null}),py=w("i8i4");function EC(e,r){return tD(e)||eD(e,r)||JL(e,r)||QL()}function QL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JL(e,r){if(!!e){if(typeof e=="string")return SC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return SC(e,r)}}function SC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function eD(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,m;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(g){s=!0,m=g}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw m}}return n}}function tD(e){if(Array.isArray(e))return e}var CC=Q.useEffect,AC=Q.useState,rD=/\B([A-Z])/g,nD=function(r){return r.replace(rD,"-$1").toLowerCase()};function G6(e){var r=e.className,t=e.style,n=e.children,i=e.position,s=AC(),c=EC(s,2),m=c[0],g=c[1],x=be(),A=AC(function(){return document.createElement("div")}),M=EC(A,1),R=M[0];return CC(function(){var F=new Vv({position:i});return F.onAdd=function(){if(r&&(R.className=r),t){var Y=Object.keys(t).map(function(ie){return"".concat(nD(ie),":").concat(t[ie])}).join(";");R.style.cssText=Y}return R},F.onRemove=function(){},g(F),x.addControl(F),function(){x.removeControl(F)}},[]),CC(function(){m&&m.setPosition(i||"bottomleft")},[i]),Object(py.createPortal)(n,R)}var wC=Object(Q.createContext)({});function iD(){return Object(Q.useContext)(wC)}var th=w("LvDl"),H6=Q.useEffect,aD=Q.memo(function(r){var t=r.layer,n=r.active;return t.active(n.option),null},th.isEqual),W6=Q.useEffect,oD=Q.memo(function(r){var t=r.layer,n=r.animate;return t.animate(n),null},th.isEqual),Z6=Q.useEffect,sD=Q.memo(function(r){var t=r.layer,n=r.color;return n.field?t.color(n.field,n.values):t.color(n.values),null},th.isEqual),uD=Q.memo(function(r){var t=r.layer,n=r.filter;return n.field&&t.filter(n.field,n.values),null},th.isEqual),lD=Q.memo(function(r){var t=r.layer,n=r.scale;return t.scale(n.values),null},th.isEqual),X6=Q.useEffect,cD=Q.memo(function(r){var t=r.layer,n=r.select;return t.select(n.option),null},th.isEqual),fD=Q.memo(function(r){var t=r.layer,n=r.shape;return n.field?t.shape(n.field,n.values):t.shape(n.values),null},th.isEqual),hD=Q.memo(function(r){var t=r.layer,n=r.size;return n.field?t.size(n.field,n.values):t.size(n.values),null},th.isEqual),pD=["data"];function dD(e,r){if(e==null)return{};var t=vD(e,r),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(t[n]=e[n]))}return t}function vD(e,r){if(e==null)return{};var t={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(r.indexOf(i)>=0)&&(t[i]=e[i]);return t}var mD=Q.memo(function(r){var t=r.layer,n=r.source,i=n.data,s=dD(n,pD);return t.inited?t.setData(i,s):t.source(i,s),s.autoFit&&t.fitBounds(s&&s.fitBoundsOptions),null},th.isEqual),Y6=Q.useEffect,gD=Q.memo(function(r){var t=r.layer,n=r.style;return t.style(n),null},th.isEqual);function yD(e,r){return ED(e)||bD(e,r)||xD(e,r)||_D()}function _D(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xD(e,r){if(!!e){if(typeof e=="string")return TC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return TC(e,r)}}function TC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function bD(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,m;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(g){s=!0,m=g}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw m}}return n}}function ED(e){if(Array.isArray(e))return e}var hm=Q.useEffect,SD=Q.useState;function ld(e,r){var t=r.source,n=r.color,i=r.shape,s=r.style,c=r.size,m=r.scale,g=r.active,x=r.select,A=r.filter,M=r.animate,R=r.options,F=r.onLayerLoaded,Y=be(),ie=SD(function(){var Xe;switch(e){case"polygonLayer":Xe=new Yx(R);break;case"lineLayer":Xe=new qP(R);break;case"pointLayer":Xe=new GO(R);break;case"heatmapLayer":Xe=new HM(R);break;case"rasterLayer":Xe=new m5(R);break;case"imageLayer":Xe=new eP(R);break;case"citybuildingLayer":Xe=new vM(R);break;default:Xe=new Yx(R)}return Xe.on("inited",function(){F&&F(Xe,Y)}),Xe}),le=yD(ie,1),Ae=le[0];return hm(function(){return Y.addLayer(Ae),function(){Y.removeLayer(Ae)}},[]),hm(function(){Ae.inited&&R&&Ae.updateLayerConfig(R)},[R==null?void 0:R.minZoom,R==null?void 0:R.maxZoom,R==null?void 0:R.visible]),hm(function(){Ae.inited&&(R==null?void 0:R.zIndex)&&Ae.setIndex(R.zIndex)},[R==null?void 0:R.zIndex]),hm(function(){Ae.inited&&(R==null?void 0:R.blend)&&Ae.setBlend(R.blend)},[R==null?void 0:R.blend]),hm(function(){Y.render()}),Q.createElement(wC.Provider,{value:Ae},Q.createElement(mD,{layer:Ae,source:t}),m&&Q.createElement(lD,{layer:Ae,scale:m}),n&&Q.createElement(sD,{layer:Ae,color:n}),c&&Q.createElement(hD,{layer:Ae,size:c}),i&&Q.createElement(fD,{layer:Ae,shape:i}),s&&Q.createElement(gD,{layer:Ae,style:s}),g&&Q.createElement(aD,{layer:Ae,active:g}),x&&Q.createElement(cD,{layer:Ae,select:x}),A&&Q.createElement(uD,{layer:Ae,filter:A}),M&&Q.createElement(oD,{layer:Ae,animate:M}),r.children)}var K6=Q.memo(function(r){return ld("polygonLayer",r)}),$6=Q.memo(function(r){return ld("lineLayer",r)}),CD=Q.memo(function(r){return ld("pointLayer",r)}),AD=Q.memo(function(r){return ld("heatmapLayer",r)}),q6=Q.memo(function(r){return ld("rasterLayer",r)}),Q6=Q.memo(function(r){return ld("imageLayer",r)}),J6=Q.memo(function(r){return ld("citybuildingLayer",r)}),wD=Q.useEffect,eB=Q.memo(function(e){var r=e.type,t=e.handler,n=iD();return wD(function(){return n.off(r,t),n.on(r,t),function(){n.off(r,t)}},[r,t]),null}),tB=Q.memo(function(e){var r=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}],t=e.items,n=t===void 0?r:t;return Q.createElement("div",null,Q.createElement("div",null,n.map(function(i,s){return Q.createElement("div",{key:s,style:{background:i.color,height:"100%",display:"inline-block",cursor:"pointer",width:""+(100-n.length)/n.length+"%",marginRight:"1%",padding:5}})})),Q.createElement("div",null,n.map(function(i,s){return Q.createElement("div",{key:s,style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:""+(100-n.length)/n.length+"%",marginRight:"1%"}},i.title)})))});function V0(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?V0=function(t){return typeof t}:V0=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V0(e)}function MC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function G0(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?MC(Object(t),!0).forEach(function(n){TD(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):MC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function TD(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function MD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function PC(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function PD(e,r,t){return r&&PC(e.prototype,r),t&&PC(e,t),e}function OD(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&dy(e,r)}function dy(e,r){return dy=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},dy(e,r)}function ID(e){var r=LD();return function(){var n=H0(e),i;if(r){var s=H0(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return RD(this,i)}}function RD(e,r){if(r&&(V0(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kD(e)}function kD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LD(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function H0(e){return H0=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},H0(e)}var rB=function(e){OD(t,e);var r=ID(t);function t(n){var i;return MD(this,t),i=r.call(this,n),i.el=void 0,i.scene=void 0,i.popup=void 0,i.el=document.createElement("div"),i}return PD(t,[{key:"componentDidMount",value:function(){var i,s=this.props,c=s.lnglat,m=s.children,g=s.option,x=s.lngLat,A=new L1(G0(G0({},g),{},{stopPropagation:(i=this.props.option)===null||i===void 0?void 0:i.stopPropagation}));c&&A.setLnglat(c),x&&A.setLnglat(x),m&&A.setDOMContent(this.el),this.popup=A,this.scene.addPopup(A)}},{key:"componentDidUpdate",value:function(i){var s,c,m,g,x,A,M=Array.isArray(i.lnglat)?i.lnglat:[i==null||(s=i.lnglat)===null||s===void 0?void 0:s.lng,i==null||(c=i.lnglat)===null||c===void 0?void 0:c.lat],R=Array.isArray(this.props.lnglat)?this.props.lnglat:[(m=this.props)===null||m===void 0||(g=m.lnglat)===null||g===void 0?void 0:g.lng,(x=this.props)===null||x===void 0||(A=x.lnglat)===null||A===void 0?void 0:A.lat],F=M.toString()!==R.toString();if(F){var Y;this.popup.remove(),this.popup=new L1(G0(G0({},this.props.option),{},{stopPropagation:(Y=this.props.option)===null||Y===void 0?void 0:Y.stopPropagation})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup)}}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var i=this;return Q.createElement(Ce.Consumer,{},function(s){return s&&(i.scene=s),Object(py.createPortal)(i.props.children,i.el)})}}]),t}(Q.PureComponent);function W0(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?W0=function(t){return typeof t}:W0=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W0(e)}function DD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function OC(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function FD(e,r,t){return r&&OC(e.prototype,r),t&&OC(e,t),e}function BD(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&vy(e,r)}function vy(e,r){return vy=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},vy(e,r)}function ND(e){var r=jD();return function(){var n=Z0(e),i;if(r){var s=Z0(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return zD(this,i)}}function zD(e,r){if(r&&(W0(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UD(e)}function UD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jD(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Z0(e){return Z0=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Z0(e)}var nB=function(e){BD(t,e);var r=ND(t);function t(n){var i;return DD(this,t),i=r.call(this,n),i.el=void 0,i.scene=void 0,i.marker=void 0,i.el=document.createElement("div"),i}return FD(t,[{key:"componentDidMount",value:function(){var i=this.props,s=i.lnglat,c=i.children,m=i.option,g=i.onMarkerLoaded,x=new P1(m);s&&x.setLnglat(s),c&&x.setElement(this.el),this.marker=x,g&&g(x),this.scene.addMarker(x)}},{key:"componentDidUpdate",value:function(i){var s,c=(i==null?void 0:i.lnglat.toString())!==((s=this.props)===null||s===void 0?void 0:s.lnglat.toString());c&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var i=this;return Q.createElement(Ce.Consumer,{},function(s){return s&&(i.scene=s),Object(py.createPortal)(i.props.children,i.el)})}}]),t}(Q.PureComponent),VD=Q.useEffect,GD=Q.memo(function(e){var r=e.type,t=e.handler,n=be();return VD(function(){return n.on(r,t),function(){n.off(r,t)}},[r]),null}),iB=GD,HD=Q.useEffect,aB=Q.memo(function(r){var t=r.name,n=r.url,i=be();return HD(function(){i.addImage(t,n)},[t,n]),null})},"6AGu":function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.BindingInSyntax=void 0;var N=w("FV85"),G=w("LKzl"),H=function(){function B(h){this._binding=h}return B.prototype.inRequestScope=function(){return this._binding.scope=N.BindingScopeEnum.Request,new G.BindingWhenOnSyntax(this._binding)},B.prototype.inSingletonScope=function(){return this._binding.scope=N.BindingScopeEnum.Singleton,new G.BindingWhenOnSyntax(this._binding)},B.prototype.inTransientScope=function(){return this._binding.scope=N.BindingScopeEnum.Transient,new G.BindingWhenOnSyntax(this._binding)},B}();Z.BindingInSyntax=H},"6D9b":function(ae,Z,w){},"6acW":function(ae,Z,w){var N=w("dt0z"),G=w("gQMU");function H(B){return G(N(B).toLowerCase())}ae.exports=H},"6nK8":function(ae,Z,w){var N=w("dVn5"),G=w("fo6e"),H=w("dt0z"),B=w("9NmV");function h(z,U,Q){return z=H(z),U=Q?void 0:U,U===void 0?G(z)?B(z):N(z):z.match(U)||[]}ae.exports=h},"711d":function(ae,Z){function w(N){return function(G){return G==null?void 0:G[N]}}ae.exports=w},"78VC":function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.multiBindToService=void 0;var N=function(H){return function(B){return function(){for(var h=[],z=0;z<arguments.length;z++)h[z]=arguments[z];return h.forEach(function(U){return H.bind(U).toService(B)})}}};Z.multiBindToService=N},"7Ix3":function(ae,Z){function w(N){var G=[];if(N!=null)for(var H in Object(N))G.push(H);return G}ae.exports=w},"7W2i":function(ae,Z,w){var N=w("SksO");function G(H,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function");H.prototype=Object.create(B&&B.prototype,{constructor:{value:H,writable:!0,configurable:!0}}),Object.defineProperty(H,"prototype",{writable:!1}),B&&N(H,B)}ae.exports=G,ae.exports.__esModule=!0,ae.exports.default=ae.exports},"7tbW":function(ae,Z,w){var N=w("LGYb");function G(H){return H&&H.length?N(H):[]}ae.exports=G},"88Gu":function(ae,Z){var w=800,N=16,G=Date.now;function H(B){var h=0,z=0;return function(){var U=G(),Q=N-(U-z);if(z=U,Q>0){if(++h>=w)return arguments[0]}else h=0;return B.apply(void 0,arguments)}}ae.exports=H},"9Fde":function(ae,Z,w){"use strict";var N=this&&this.__awaiter||function(Be,dt,rt,lt){function $(Qt){return Qt instanceof rt?Qt:new rt(function(Ir){Ir(Qt)})}return new(rt||(rt=Promise))(function(Qt,Ir){function br(Mt){try{ke(lt.next(Mt))}catch(Nt){Ir(Nt)}}function Rt(Mt){try{ke(lt.throw(Mt))}catch(Nt){Ir(Nt)}}function ke(Mt){Mt.done?Qt(Mt.value):$(Mt.value).then(br,Rt)}ke((lt=lt.apply(Be,dt||[])).next())})},G=this&&this.__generator||function(Be,dt){var rt={label:0,sent:function(){if(Qt[0]&1)throw Qt[1];return Qt[1]},trys:[],ops:[]},lt,$,Qt,Ir;return Ir={next:br(0),throw:br(1),return:br(2)},typeof Symbol=="function"&&(Ir[Symbol.iterator]=function(){return this}),Ir;function br(ke){return function(Mt){return Rt([ke,Mt])}}function Rt(ke){if(lt)throw new TypeError("Generator is already executing.");for(;rt;)try{if(lt=1,$&&(Qt=ke[0]&2?$.return:ke[0]?$.throw||((Qt=$.return)&&Qt.call($),0):$.next)&&!(Qt=Qt.call($,ke[1])).done)return Qt;switch($=0,Qt&&(ke=[ke[0]&2,Qt.value]),ke[0]){case 0:case 1:Qt=ke;break;case 4:return rt.label++,{value:ke[1],done:!1};case 5:rt.label++,$=ke[1],ke=[0];continue;case 7:ke=rt.ops.pop(),rt.trys.pop();continue;default:if(Qt=rt.trys,!(Qt=Qt.length>0&&Qt[Qt.length-1])&&(ke[0]===6||ke[0]===2)){rt=0;continue}if(ke[0]===3&&(!Qt||ke[1]>Qt[0]&&ke[1]<Qt[3])){rt.label=ke[1];break}if(ke[0]===6&&rt.label<Qt[1]){rt.label=Qt[1],Qt=ke;break}if(Qt&&rt.label<Qt[2]){rt.label=Qt[2],rt.ops.push(ke);break}Qt[2]&&rt.ops.pop(),rt.trys.pop();continue}ke=dt.call(Be,rt)}catch(Mt){ke=[6,Mt],$=0}finally{lt=Qt=0}if(ke[0]&5)throw ke[1];return{value:ke[0]?ke[1]:void 0,done:!0}}},H=this&&this.__spreadArray||function(Be,dt){for(var rt=0,lt=dt.length,$=Be.length;rt<lt;rt++,$++)Be[$]=dt[rt];return Be};Object.defineProperty(Z,"__esModule",{value:!0}),Z.Container=void 0;var B=w("LgvC"),h=w("MON2"),z=w("FV85"),U=w("xfSm"),Q=w("wnjb"),se=w("h7MG"),Ce=w("aPG5"),be=w("gzZq"),st=w("d9O0"),tt=w("ujMp"),ut=w("HpQ9"),ht=w("AwBQ"),gt=function(){function Be(dt){this._appliedMiddleware=[];var rt=dt||{};if(typeof rt!="object")throw new Error(""+h.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(rt.defaultScope===void 0)rt.defaultScope=z.BindingScopeEnum.Transient;else if(rt.defaultScope!==z.BindingScopeEnum.Singleton&&rt.defaultScope!==z.BindingScopeEnum.Transient&&rt.defaultScope!==z.BindingScopeEnum.Request)throw new Error(""+h.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(rt.autoBindInjectable===void 0)rt.autoBindInjectable=!1;else if(typeof rt.autoBindInjectable!="boolean")throw new Error(""+h.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(rt.skipBaseClassChecks===void 0)rt.skipBaseClassChecks=!1;else if(typeof rt.skipBaseClassChecks!="boolean")throw new Error(""+h.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:rt.autoBindInjectable,defaultScope:rt.defaultScope,skipBaseClassChecks:rt.skipBaseClassChecks},this.id=st.id(),this._bindingDictionary=new ht.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new Q.MetadataReader}return Be.merge=function(dt,rt){for(var lt=[],$=2;$<arguments.length;$++)lt[$-2]=arguments[$];var Qt=new Be,Ir=H([dt,rt],lt).map(function(ke){return se.getBindingDictionary(ke)}),br=se.getBindingDictionary(Qt);function Rt(ke,Mt){ke.traverse(function(Nt,nr){nr.forEach(function(Mr){Mt.add(Mr.serviceIdentifier,Mr.clone())})})}return Ir.forEach(function(ke){Rt(ke,br)}),Qt},Be.prototype.load=function(){for(var dt=[],rt=0;rt<arguments.length;rt++)dt[rt]=arguments[rt];for(var lt=this._getContainerModuleHelpersFactory(),$=0,Qt=dt;$<Qt.length;$++){var Ir=Qt[$],br=lt(Ir.id);Ir.registry(br.bindFunction,br.unbindFunction,br.isboundFunction,br.rebindFunction)}},Be.prototype.loadAsync=function(){for(var dt=[],rt=0;rt<arguments.length;rt++)dt[rt]=arguments[rt];return N(this,void 0,void 0,function(){var lt,$,Qt,Ir,br;return G(this,function(Rt){switch(Rt.label){case 0:lt=this._getContainerModuleHelpersFactory(),$=0,Qt=dt,Rt.label=1;case 1:return $<Qt.length?(Ir=Qt[$],br=lt(Ir.id),[4,Ir.registry(br.bindFunction,br.unbindFunction,br.isboundFunction,br.rebindFunction)]):[3,4];case 2:Rt.sent(),Rt.label=3;case 3:return $++,[3,1];case 4:return[2]}})})},Be.prototype.unload=function(){for(var dt=this,rt=[],lt=0;lt<arguments.length;lt++)rt[lt]=arguments[lt];var $=function(Ir){return function(br){return br.moduleId===Ir}};rt.forEach(function(Qt){var Ir=$(Qt.id);dt._bindingDictionary.removeByCondition(Ir)})},Be.prototype.bind=function(dt){var rt=this.options.defaultScope||z.BindingScopeEnum.Transient,lt=new B.Binding(dt,rt);return this._bindingDictionary.add(dt,lt),new be.BindingToSyntax(lt)},Be.prototype.rebind=function(dt){return this.unbind(dt),this.bind(dt)},Be.prototype.unbind=function(dt){try{this._bindingDictionary.remove(dt)}catch(rt){throw new Error(h.CANNOT_UNBIND+" "+tt.getServiceIdentifierAsString(dt))}},Be.prototype.unbindAll=function(){this._bindingDictionary=new ht.Lookup},Be.prototype.isBound=function(dt){var rt=this._bindingDictionary.hasKey(dt);return!rt&&this.parent&&(rt=this.parent.isBound(dt)),rt},Be.prototype.isBoundNamed=function(dt,rt){return this.isBoundTagged(dt,U.NAMED_TAG,rt)},Be.prototype.isBoundTagged=function(dt,rt,lt){var $=!1;if(this._bindingDictionary.hasKey(dt)){var Qt=this._bindingDictionary.get(dt),Ir=se.createMockRequest(this,dt,rt,lt);$=Qt.some(function(br){return br.constraint(Ir)})}return!$&&this.parent&&($=this.parent.isBoundTagged(dt,rt,lt)),$},Be.prototype.snapshot=function(){this._snapshots.push(ut.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},Be.prototype.restore=function(){var dt=this._snapshots.pop();if(dt===void 0)throw new Error(h.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=dt.bindings,this._middleware=dt.middleware},Be.prototype.createChild=function(dt){var rt=new Be(dt||this.options);return rt.parent=this,rt},Be.prototype.applyMiddleware=function(){for(var dt=[],rt=0;rt<arguments.length;rt++)dt[rt]=arguments[rt];this._appliedMiddleware=this._appliedMiddleware.concat(dt);var lt=this._middleware?this._middleware:this._planAndResolve();this._middleware=dt.reduce(function($,Qt){return Qt($)},lt)},Be.prototype.applyCustomMetadataReader=function(dt){this._metadataReader=dt},Be.prototype.get=function(dt){return this._get(!1,!1,z.TargetTypeEnum.Variable,dt)},Be.prototype.getTagged=function(dt,rt,lt){return this._get(!1,!1,z.TargetTypeEnum.Variable,dt,rt,lt)},Be.prototype.getNamed=function(dt,rt){return this.getTagged(dt,U.NAMED_TAG,rt)},Be.prototype.getAll=function(dt){return this._get(!0,!0,z.TargetTypeEnum.Variable,dt)},Be.prototype.getAllTagged=function(dt,rt,lt){return this._get(!1,!0,z.TargetTypeEnum.Variable,dt,rt,lt)},Be.prototype.getAllNamed=function(dt,rt){return this.getAllTagged(dt,U.NAMED_TAG,rt)},Be.prototype.resolve=function(dt){var rt=this.createChild();return rt.bind(dt).toSelf(),this._appliedMiddleware.forEach(function(lt){rt.applyMiddleware(lt)}),rt.get(dt)},Be.prototype._getContainerModuleHelpersFactory=function(){var dt=this,rt=function(Rt,ke){Rt._binding.moduleId=ke},lt=function(Rt){return function(ke){var Mt=dt.bind.bind(dt),Nt=Mt(ke);return rt(Nt,Rt),Nt}},$=function(Rt){return function(ke){var Mt=dt.unbind.bind(dt);Mt(ke)}},Qt=function(Rt){return function(ke){var Mt=dt.isBound.bind(dt);return Mt(ke)}},Ir=function(Rt){return function(ke){var Mt=dt.rebind.bind(dt),Nt=Mt(ke);return rt(Nt,Rt),Nt}};return function(br){return{bindFunction:lt(br),isboundFunction:Qt(br),rebindFunction:Ir(br),unbindFunction:$(br)}}},Be.prototype._get=function(dt,rt,lt,$,Qt,Ir){var br=null,Rt={avoidConstraints:dt,contextInterceptor:function(Mt){return Mt},isMultiInject:rt,key:Qt,serviceIdentifier:$,targetType:lt,value:Ir};if(this._middleware){if(br=this._middleware(Rt),br==null)throw new Error(h.INVALID_MIDDLEWARE_RETURN)}else br=this._planAndResolve()(Rt);return br},Be.prototype._planAndResolve=function(){var dt=this;return function(rt){var lt=se.plan(dt._metadataReader,dt,rt.isMultiInject,rt.targetType,rt.serviceIdentifier,rt.key,rt.value,rt.avoidConstraints);lt=rt.contextInterceptor(lt);var $=Ce.resolve(lt);return $}},Be}();Z.Container=gt},"9NmV":function(ae,Z){var w="\\ud800-\\udfff",N="\\u0300-\\u036f",G="\\ufe20-\\ufe2f",H="\\u20d0-\\u20ff",B=N+G+H,h="\\u2700-\\u27bf",z="a-z\\xdf-\\xf6\\xf8-\\xff",U="\\xac\\xb1\\xd7\\xf7",Q="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",se="\\u2000-\\u206f",Ce=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",be="A-Z\\xc0-\\xd6\\xd8-\\xde",st="\\ufe0e\\ufe0f",tt=U+Q+se+Ce,ut="['\u2019]",ht="["+tt+"]",gt="["+B+"]",Be="\\d+",dt="["+h+"]",rt="["+z+"]",lt="[^"+w+tt+Be+h+z+be+"]",$="\\ud83c[\\udffb-\\udfff]",Qt="(?:"+gt+"|"+$+")",Ir="[^"+w+"]",br="(?:\\ud83c[\\udde6-\\uddff]){2}",Rt="[\\ud800-\\udbff][\\udc00-\\udfff]",ke="["+be+"]",Mt="\\u200d",Nt="(?:"+rt+"|"+lt+")",nr="(?:"+ke+"|"+lt+")",Mr="(?:"+ut+"(?:d|ll|m|re|s|t|ve))?",Jr="(?:"+ut+"(?:D|LL|M|RE|S|T|VE))?",Er=Qt+"?",de="["+st+"]?",Ie="(?:"+Mt+"(?:"+[Ir,br,Rt].join("|")+")"+de+Er+")*",we="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ct="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ot=de+Er+Ie,wt="(?:"+[dt,br,Rt].join("|")+")"+ot,S=RegExp([ke+"?"+rt+"+"+Mr+"(?="+[ht,ke,"$"].join("|")+")",nr+"+"+Jr+"(?="+[ht,ke+Nt,"$"].join("|")+")",ke+"?"+Nt+"+"+Mr,ke+"+"+Jr,ct,we,Be,wt].join("|"),"g");function ur(Pt){return Pt.match(S)||[]}ae.exports=ur},"9nhX":function(ae,Z,w){var N=w("g4R6"),G=w("tLB3");function H(B,h,z){return z===void 0&&(z=h,h=void 0),z!==void 0&&(z=G(z),z=z===z?z:0),h!==void 0&&(h=G(h),h=h===h?h:0),N(G(B),h,z)}ae.exports=H},APxj:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0});var N=w("Ucsi");function G(H,B){B===void 0&&(B=!0);var h=N.makePropertyInjectDecorator(H,B),z=N.makePropertyInjectNamedDecorator(H,B),U=N.makePropertyInjectTaggedDecorator(H,B),Q=N.makePropertyMultiInjectDecorator(H,B);return{lazyInject:h,lazyInjectNamed:z,lazyInjectTagged:U,lazyMultiInject:Q}}Z.default=G},AfwI:function(ae,Z,w){var N;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(G,H,B,h){"use strict";var z=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,U=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),Q=z||U,se=["","webkit","Moz","MS","ms","o"],Ce=Q?"":H.createElement("div"),be="function",st=Math.round,tt=Math.abs,ut=Date.now;function ht(Ve,fe,Ue){return setTimeout(Ir(Ve,Ue),fe)}function gt(Ve,fe,Ue){return Array.isArray(Ve)?(Be(Ve,Ue[fe],Ue),!0):!1}function Be(Ve,fe,Ue){var kt;if(!!Ve)if(Ve.forEach)Ve.forEach(fe,Ue);else if(Ve.length!==h)for(kt=0;kt<Ve.length;)fe.call(Ue,Ve[kt],kt,Ve),kt++;else for(kt in Ve)Ve.hasOwnProperty(kt)&&fe.call(Ue,Ve[kt],kt,Ve)}function dt(Ve,fe,Ue){var kt="DEPRECATED METHOD: "+fe+`
`+Ue+` AT 
`;return function(){var Gr=new Error("get-stack-trace"),In=Gr&&Gr.stack?Gr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Li=G.console&&(G.console.warn||G.console.log);return Li&&Li.call(G.console,kt,In),Ve.apply(this,arguments)}}var rt;typeof Object.assign!="function"?rt=function(fe){if(fe===h||fe===null)throw new TypeError("Cannot convert undefined or null to object");for(var Ue=Object(fe),kt=1;kt<arguments.length;kt++){var Gr=arguments[kt];if(Gr!==h&&Gr!==null)for(var In in Gr)Gr.hasOwnProperty(In)&&(Ue[In]=Gr[In])}return Ue}:rt=Object.assign;var lt=dt(function(fe,Ue,kt){for(var Gr=Object.keys(Ue),In=0;In<Gr.length;)(!kt||kt&&fe[Gr[In]]===h)&&(fe[Gr[In]]=Ue[Gr[In]]),In++;return fe},"extend","Use `assign`."),$=dt(function(fe,Ue){return lt(fe,Ue,!0)},"merge","Use `assign`.");function Qt(Ve,fe,Ue){var kt=fe.prototype,Gr;Gr=Ve.prototype=Object.create(kt),Gr.constructor=Ve,Gr._super=kt,Ue&&rt(Gr,Ue)}function Ir(Ve,fe){return function(){return Ve.apply(fe,arguments)}}function br(Ve,fe){return typeof Ve==be?Ve.apply(fe&&fe[0]||h,fe):Ve}function Rt(Ve,fe){return Ve===h?fe:Ve}function ke(Ve,fe,Ue){Be(Mr(fe),function(kt){Ve.addEventListener(kt,Ue,!1)})}function Mt(Ve,fe,Ue){Be(Mr(fe),function(kt){Ve.removeEventListener(kt,Ue,!1)})}function Nt(Ve,fe){for(;Ve;){if(Ve==fe)return!0;Ve=Ve.parentNode}return!1}function nr(Ve,fe){return Ve.indexOf(fe)>-1}function Mr(Ve){return Ve.trim().split(/\s+/g)}function Jr(Ve,fe,Ue){if(Ve.indexOf&&!Ue)return Ve.indexOf(fe);for(var kt=0;kt<Ve.length;){if(Ue&&Ve[kt][Ue]==fe||!Ue&&Ve[kt]===fe)return kt;kt++}return-1}function Er(Ve){return Array.prototype.slice.call(Ve,0)}function de(Ve,fe,Ue){for(var kt=[],Gr=[],In=0;In<Ve.length;){var Li=fe?Ve[In][fe]:Ve[In];Jr(Gr,Li)<0&&kt.push(Ve[In]),Gr[In]=Li,In++}return Ue&&(fe?kt=kt.sort(function(Sa,Ia){return Sa[fe]>Ia[fe]}):kt=kt.sort()),kt}function Ie(Ve,fe){for(var Ue,kt,Gr=fe[0].toUpperCase()+fe.slice(1),In=0;In<se.length;){if(Ue=se[In],kt=Ue?Ue+Gr:fe,kt in Ve)return kt;In++}return h}var we=1;function ct(){return we++}function ot(Ve){var fe=Ve.ownerDocument||Ve;return fe.defaultView||fe.parentWindow||G}var wt=/mobile|tablet|ip(ad|hone|od)|android/i,S="ontouchstart"in G,ur=Ie(G,"PointerEvent")!==h,Pt=S&&wt.test(navigator.userAgent),Ft="touch",Et="pen",St="mouse",Zt="kinect",dr=25,qt=1,pr=2,Ur=4,gr=8,or=1,Rr=2,Hn=4,en=8,_n=16,qn=Rr|Hn,ii=en|_n,Xi=qn|ii,me=["x","y"],yn=["clientX","clientY"];function Bi(Ve,fe){var Ue=this;this.manager=Ve,this.callback=fe,this.element=Ve.element,this.target=Ve.options.inputTarget,this.domHandler=function(kt){br(Ve.options.enable,[Ve])&&Ue.handler(kt)},this.init()}Bi.prototype={handler:function(){},init:function(){this.evEl&&ke(this.element,this.evEl,this.domHandler),this.evTarget&&ke(this.target,this.evTarget,this.domHandler),this.evWin&&ke(ot(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Mt(this.element,this.evEl,this.domHandler),this.evTarget&&Mt(this.target,this.evTarget,this.domHandler),this.evWin&&Mt(ot(this.element),this.evWin,this.domHandler)}};function Mo(Ve){var fe,Ue=Ve.options.inputClass;return Ue?fe=Ue:ur?fe=pe:Pt?fe=Ar:S?fe=an:fe=Hs,new fe(Ve,os)}function os(Ve,fe,Ue){var kt=Ue.pointers.length,Gr=Ue.changedPointers.length,In=fe&qt&&kt-Gr==0,Li=fe&(Ur|gr)&&kt-Gr==0;Ue.isFirst=!!In,Ue.isFinal=!!Li,In&&(Ve.session={}),Ue.eventType=fe,jt(Ve,Ue),Ve.emit("hammer.input",Ue),Ve.recognize(Ue),Ve.session.prevInput=Ue}function jt(Ve,fe){var Ue=Ve.session,kt=fe.pointers,Gr=kt.length;Ue.firstInput||(Ue.firstInput=vn(fe)),Gr>1&&!Ue.firstMultiple?Ue.firstMultiple=vn(fe):Gr===1&&(Ue.firstMultiple=!1);var In=Ue.firstInput,Li=Ue.firstMultiple,Oa=Li?Li.center:In.center,Sa=fe.center=Kr(kt);fe.timeStamp=ut(),fe.deltaTime=fe.timeStamp-In.timeStamp,fe.angle=ci(Oa,Sa),fe.distance=Xn(Oa,Sa),_r(Ue,fe),fe.offsetDirection=li(fe.deltaX,fe.deltaY);var Ia=ba(fe.deltaTime,fe.deltaX,fe.deltaY);fe.overallVelocityX=Ia.x,fe.overallVelocityY=Ia.y,fe.overallVelocity=tt(Ia.x)>tt(Ia.y)?Ia.x:Ia.y,fe.scale=Li?Yi(Li.pointers,kt):1,fe.rotation=Li?Hi(Li.pointers,kt):0,fe.maxPointers=Ue.prevInput?fe.pointers.length>Ue.prevInput.maxPointers?fe.pointers.length:Ue.prevInput.maxPointers:fe.pointers.length,Xr(Ue,fe);var oo=Ve.element;Nt(fe.srcEvent.target,oo)&&(oo=fe.srcEvent.target),fe.target=oo}function _r(Ve,fe){var Ue=fe.center,kt=Ve.offsetDelta||{},Gr=Ve.prevDelta||{},In=Ve.prevInput||{};(fe.eventType===qt||In.eventType===Ur)&&(Gr=Ve.prevDelta={x:In.deltaX||0,y:In.deltaY||0},kt=Ve.offsetDelta={x:Ue.x,y:Ue.y}),fe.deltaX=Gr.x+(Ue.x-kt.x),fe.deltaY=Gr.y+(Ue.y-kt.y)}function Xr(Ve,fe){var Ue=Ve.lastInterval||fe,kt=fe.timeStamp-Ue.timeStamp,Gr,In,Li,Oa;if(fe.eventType!=gr&&(kt>dr||Ue.velocity===h)){var Sa=fe.deltaX-Ue.deltaX,Ia=fe.deltaY-Ue.deltaY,oo=ba(kt,Sa,Ia);In=oo.x,Li=oo.y,Gr=tt(oo.x)>tt(oo.y)?oo.x:oo.y,Oa=li(Sa,Ia),Ve.lastInterval=fe}else Gr=Ue.velocity,In=Ue.velocityX,Li=Ue.velocityY,Oa=Ue.direction;fe.velocity=Gr,fe.velocityX=In,fe.velocityY=Li,fe.direction=Oa}function vn(Ve){for(var fe=[],Ue=0;Ue<Ve.pointers.length;)fe[Ue]={clientX:st(Ve.pointers[Ue].clientX),clientY:st(Ve.pointers[Ue].clientY)},Ue++;return{timeStamp:ut(),pointers:fe,center:Kr(fe),deltaX:Ve.deltaX,deltaY:Ve.deltaY}}function Kr(Ve){var fe=Ve.length;if(fe===1)return{x:st(Ve[0].clientX),y:st(Ve[0].clientY)};for(var Ue=0,kt=0,Gr=0;Gr<fe;)Ue+=Ve[Gr].clientX,kt+=Ve[Gr].clientY,Gr++;return{x:st(Ue/fe),y:st(kt/fe)}}function ba(Ve,fe,Ue){return{x:fe/Ve||0,y:Ue/Ve||0}}function li(Ve,fe){return Ve===fe?or:tt(Ve)>=tt(fe)?Ve<0?Rr:Hn:fe<0?en:_n}function Xn(Ve,fe,Ue){Ue||(Ue=me);var kt=fe[Ue[0]]-Ve[Ue[0]],Gr=fe[Ue[1]]-Ve[Ue[1]];return Math.sqrt(kt*kt+Gr*Gr)}function ci(Ve,fe,Ue){Ue||(Ue=me);var kt=fe[Ue[0]]-Ve[Ue[0]],Gr=fe[Ue[1]]-Ve[Ue[1]];return Math.atan2(Gr,kt)*180/Math.PI}function Hi(Ve,fe){return ci(fe[1],fe[0],yn)+ci(Ve[1],Ve[0],yn)}function Yi(Ve,fe){return Xn(fe[0],fe[1],yn)/Xn(Ve[0],Ve[1],yn)}var No={mousedown:qt,mousemove:pr,mouseup:Ur},Ma="mousedown",ma="mousemove mouseup";function Hs(){this.evEl=Ma,this.evWin=ma,this.pressed=!1,Bi.apply(this,arguments)}Qt(Hs,Bi,{handler:function(fe){var Ue=No[fe.type];Ue&qt&&fe.button===0&&(this.pressed=!0),Ue&pr&&fe.which!==1&&(Ue=Ur),!!this.pressed&&(Ue&Ur&&(this.pressed=!1),this.callback(this.manager,Ue,{pointers:[fe],changedPointers:[fe],pointerType:St,srcEvent:fe}))}});var il={pointerdown:qt,pointermove:pr,pointerup:Ur,pointercancel:gr,pointerout:gr},ja={2:Ft,3:Et,4:St,5:Zt},re="pointerdown",J="pointermove pointerup pointercancel";!Q&&G.MSPointerEvent&&!G.PointerEvent&&(re="MSPointerDown",J="MSPointerMove MSPointerUp MSPointerCancel");function pe(){this.evEl=re,this.evWin=J,Bi.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Qt(pe,Bi,{handler:function(fe){var Ue=this.store,kt=!1,Gr=fe.type.toLowerCase().replace("ms",""),In=il[Gr],Li=ja[fe.pointerType]||fe.pointerType,Oa=Li==Ft,Sa=Jr(Ue,fe.pointerId,"pointerId");In&qt&&(fe.button===0||Oa)?Sa<0&&(Ue.push(fe),Sa=Ue.length-1):In&(Ur|gr)&&(kt=!0),!(Sa<0)&&(Ue[Sa]=fe,this.callback(this.manager,In,{pointers:Ue,changedPointers:[fe],pointerType:Li,srcEvent:fe}),kt&&Ue.splice(Sa,1))}});var Se={touchstart:qt,touchmove:pr,touchend:Ur,touchcancel:gr},De="touchstart",et="touchstart touchmove touchend touchcancel";function vt(){this.evTarget=De,this.evWin=et,this.started=!1,Bi.apply(this,arguments)}Qt(vt,Bi,{handler:function(fe){var Ue=Se[fe.type];if(Ue===qt&&(this.started=!0),!!this.started){var kt=_e.call(this,fe,Ue);Ue&(Ur|gr)&&kt[0].length-kt[1].length==0&&(this.started=!1),this.callback(this.manager,Ue,{pointers:kt[0],changedPointers:kt[1],pointerType:Ft,srcEvent:fe})}}});function _e(Ve,fe){var Ue=Er(Ve.touches),kt=Er(Ve.changedTouches);return fe&(Ur|gr)&&(Ue=de(Ue.concat(kt),"identifier",!0)),[Ue,kt]}var je={touchstart:qt,touchmove:pr,touchend:Ur,touchcancel:gr},$e="touchstart touchmove touchend touchcancel";function Ar(){this.evTarget=$e,this.targetIds={},Bi.apply(this,arguments)}Qt(Ar,Bi,{handler:function(fe){var Ue=je[fe.type],kt=kr.call(this,fe,Ue);!kt||this.callback(this.manager,Ue,{pointers:kt[0],changedPointers:kt[1],pointerType:Ft,srcEvent:fe})}});function kr(Ve,fe){var Ue=Er(Ve.touches),kt=this.targetIds;if(fe&(qt|pr)&&Ue.length===1)return kt[Ue[0].identifier]=!0,[Ue,Ue];var Gr,In,Li=Er(Ve.changedTouches),Oa=[],Sa=this.target;if(In=Ue.filter(function(Ia){return Nt(Ia.target,Sa)}),fe===qt)for(Gr=0;Gr<In.length;)kt[In[Gr].identifier]=!0,Gr++;for(Gr=0;Gr<Li.length;)kt[Li[Gr].identifier]&&Oa.push(Li[Gr]),fe&(Ur|gr)&&delete kt[Li[Gr].identifier],Gr++;if(!!Oa.length)return[de(In.concat(Oa),"identifier",!0),Oa]}var rr=2500,Lr=25;function an(){Bi.apply(this,arguments);var Ve=Ir(this.handler,this);this.touch=new Ar(this.manager,Ve),this.mouse=new Hs(this.manager,Ve),this.primaryTouch=null,this.lastTouches=[]}Qt(an,Bi,{handler:function(fe,Ue,kt){var Gr=kt.pointerType==Ft,In=kt.pointerType==St;if(!(In&&kt.sourceCapabilities&&kt.sourceCapabilities.firesTouchEvents)){if(Gr)An.call(this,Ue,kt);else if(In&&Cn.call(this,kt))return;this.callback(fe,Ue,kt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function An(Ve,fe){Ve&qt?(this.primaryTouch=fe.changedPointers[0].identifier,tr.call(this,fe)):Ve&(Ur|gr)&&tr.call(this,fe)}function tr(Ve){var fe=Ve.changedPointers[0];if(fe.identifier===this.primaryTouch){var Ue={x:fe.clientX,y:fe.clientY};this.lastTouches.push(Ue);var kt=this.lastTouches,Gr=function(){var Li=kt.indexOf(Ue);Li>-1&&kt.splice(Li,1)};setTimeout(Gr,rr)}}function Cn(Ve){for(var fe=Ve.srcEvent.clientX,Ue=Ve.srcEvent.clientY,kt=0;kt<this.lastTouches.length;kt++){var Gr=this.lastTouches[kt],In=Math.abs(fe-Gr.x),Li=Math.abs(Ue-Gr.y);if(In<=Lr&&Li<=Lr)return!0}return!1}var hn=Q?h:Ie(Ce.style,"touchAction"),xn=hn!==h,_i="compute",wn="auto",Ni="manipulation",Ki="none",Mi="pan-x",Fn="pan-y",Ui=Ka();function zo(Ve,fe){this.manager=Ve,this.set(fe)}zo.prototype={set:function(fe){fe==_i&&(fe=this.compute()),xn&&this.manager.element.style&&Ui[fe]&&(this.manager.element.style[hn]=fe),this.actions=fe.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var fe=[];return Be(this.manager.recognizers,function(Ue){br(Ue.options.enable,[Ue])&&(fe=fe.concat(Ue.getTouchAction()))}),ia(fe.join(" "))},preventDefaults:function(fe){var Ue=fe.srcEvent,kt=fe.offsetDirection;if(this.manager.session.prevented){Ue.preventDefault();return}var Gr=this.actions,In=nr(Gr,Ki)&&!Ui[Ki],Li=nr(Gr,Fn)&&!Ui[Fn],Oa=nr(Gr,Mi)&&!Ui[Mi];if(In){var Sa=fe.pointers.length===1,Ia=fe.distance<2,oo=fe.deltaTime<250;if(Sa&&Ia&&oo)return}if(!(Oa&&Li)&&(In||Li&&kt&qn||Oa&&kt&ii))return this.preventSrc(Ue)},preventSrc:function(fe){this.manager.session.prevented=!0,fe.preventDefault()}};function ia(Ve){if(nr(Ve,Ki))return Ki;var fe=nr(Ve,Mi),Ue=nr(Ve,Fn);return fe&&Ue?Ki:fe||Ue?fe?Mi:Fn:nr(Ve,Ni)?Ni:wn}function Ka(){if(!xn)return!1;var Ve={};if(Q)return Ve;var fe=G.CSS&&G.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ue){Ve[Ue]=fe?G.CSS.supports("touch-action",Ue):!0}),Ve}var ri=1,Ai=2,xi=4,to=8,ao=to,Ea=16,Ct=32;function ss(Ve){this.options=rt({},this.defaults,Ve||{}),this.id=ct(),this.manager=null,this.options.enable=Rt(this.options.enable,!0),this.state=ri,this.simultaneous={},this.requireFail=[]}ss.prototype={defaults:{},set:function(fe){return rt(this.options,fe),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(fe){if(gt(fe,"recognizeWith",this))return this;var Ue=this.simultaneous;return fe=ro(fe,this),Ue[fe.id]||(Ue[fe.id]=fe,fe.recognizeWith(this)),this},dropRecognizeWith:function(fe){return gt(fe,"dropRecognizeWith",this)?this:(fe=ro(fe,this),delete this.simultaneous[fe.id],this)},requireFailure:function(fe){if(gt(fe,"requireFailure",this))return this;var Ue=this.requireFail;return fe=ro(fe,this),Jr(Ue,fe)===-1&&(Ue.push(fe),fe.requireFailure(this)),this},dropRequireFailure:function(fe){if(gt(fe,"dropRequireFailure",this))return this;fe=ro(fe,this);var Ue=Jr(this.requireFail,fe);return Ue>-1&&this.requireFail.splice(Ue,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(fe){return!!this.simultaneous[fe.id]},emit:function(fe){var Ue=this,kt=this.state;function Gr(In){Ue.manager.emit(In,fe)}kt<to&&Gr(Ue.options.event+Bt(kt)),Gr(Ue.options.event),fe.additionalEvent&&Gr(fe.additionalEvent),kt>=to&&Gr(Ue.options.event+Bt(kt))},tryEmit:function(fe){if(this.canEmit())return this.emit(fe);this.state=Ct},canEmit:function(){for(var fe=0;fe<this.requireFail.length;){if(!(this.requireFail[fe].state&(Ct|ri)))return!1;fe++}return!0},recognize:function(fe){var Ue=rt({},fe);if(!br(this.options.enable,[this,Ue])){this.reset(),this.state=Ct;return}this.state&(ao|Ea|Ct)&&(this.state=ri),this.state=this.process(Ue),this.state&(Ai|xi|to|Ea)&&this.tryEmit(Ue)},process:function(fe){},getTouchAction:function(){},reset:function(){}};function Bt(Ve){return Ve&Ea?"cancel":Ve&to?"end":Ve&xi?"move":Ve&Ai?"start":""}function wa(Ve){return Ve==_n?"down":Ve==en?"up":Ve==Rr?"left":Ve==Hn?"right":""}function ro(Ve,fe){var Ue=fe.manager;return Ue?Ue.get(Ve):Ve}function Pa(){ss.apply(this,arguments)}Qt(Pa,ss,{defaults:{pointers:1},attrTest:function(fe){var Ue=this.options.pointers;return Ue===0||fe.pointers.length===Ue},process:function(fe){var Ue=this.state,kt=fe.eventType,Gr=Ue&(Ai|xi),In=this.attrTest(fe);return Gr&&(kt&gr||!In)?Ue|Ea:Gr||In?kt&Ur?Ue|to:Ue&Ai?Ue|xi:Ai:Ct}});function Ta(){Pa.apply(this,arguments),this.pX=null,this.pY=null}Qt(Ta,Pa,{defaults:{event:"pan",threshold:10,pointers:1,direction:Xi},getTouchAction:function(){var fe=this.options.direction,Ue=[];return fe&qn&&Ue.push(Fn),fe&ii&&Ue.push(Mi),Ue},directionTest:function(fe){var Ue=this.options,kt=!0,Gr=fe.distance,In=fe.direction,Li=fe.deltaX,Oa=fe.deltaY;return In&Ue.direction||(Ue.direction&qn?(In=Li===0?or:Li<0?Rr:Hn,kt=Li!=this.pX,Gr=Math.abs(fe.deltaX)):(In=Oa===0?or:Oa<0?en:_n,kt=Oa!=this.pY,Gr=Math.abs(fe.deltaY))),fe.direction=In,kt&&Gr>Ue.threshold&&In&Ue.direction},attrTest:function(fe){return Pa.prototype.attrTest.call(this,fe)&&(this.state&Ai||!(this.state&Ai)&&this.directionTest(fe))},emit:function(fe){this.pX=fe.deltaX,this.pY=fe.deltaY;var Ue=wa(fe.direction);Ue&&(fe.additionalEvent=this.options.event+Ue),this._super.emit.call(this,fe)}});function Po(){Pa.apply(this,arguments)}Qt(Po,Pa,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ki]},attrTest:function(fe){return this._super.attrTest.call(this,fe)&&(Math.abs(fe.scale-1)>this.options.threshold||this.state&Ai)},emit:function(fe){if(fe.scale!==1){var Ue=fe.scale<1?"in":"out";fe.additionalEvent=this.options.event+Ue}this._super.emit.call(this,fe)}});function Nr(){ss.apply(this,arguments),this._timer=null,this._input=null}Qt(Nr,ss,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[wn]},process:function(fe){var Ue=this.options,kt=fe.pointers.length===Ue.pointers,Gr=fe.distance<Ue.threshold,In=fe.deltaTime>Ue.time;if(this._input=fe,!Gr||!kt||fe.eventType&(Ur|gr)&&!In)this.reset();else if(fe.eventType&qt)this.reset(),this._timer=ht(function(){this.state=ao,this.tryEmit()},Ue.time,this);else if(fe.eventType&Ur)return ao;return Ct},reset:function(){clearTimeout(this._timer)},emit:function(fe){this.state===ao&&(fe&&fe.eventType&Ur?this.manager.emit(this.options.event+"up",fe):(this._input.timeStamp=ut(),this.manager.emit(this.options.event,this._input)))}});function Xo(){Pa.apply(this,arguments)}Qt(Xo,Pa,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ki]},attrTest:function(fe){return this._super.attrTest.call(this,fe)&&(Math.abs(fe.rotation)>this.options.threshold||this.state&Ai)}});function $r(){Pa.apply(this,arguments)}Qt($r,Pa,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:qn|ii,pointers:1},getTouchAction:function(){return Ta.prototype.getTouchAction.call(this)},attrTest:function(fe){var Ue=this.options.direction,kt;return Ue&(qn|ii)?kt=fe.overallVelocity:Ue&qn?kt=fe.overallVelocityX:Ue&ii&&(kt=fe.overallVelocityY),this._super.attrTest.call(this,fe)&&Ue&fe.offsetDirection&&fe.distance>this.options.threshold&&fe.maxPointers==this.options.pointers&&tt(kt)>this.options.velocity&&fe.eventType&Ur},emit:function(fe){var Ue=wa(fe.offsetDirection);Ue&&this.manager.emit(this.options.event+Ue,fe),this.manager.emit(this.options.event,fe)}});function Oo(){ss.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Qt(Oo,ss,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ni]},process:function(fe){var Ue=this.options,kt=fe.pointers.length===Ue.pointers,Gr=fe.distance<Ue.threshold,In=fe.deltaTime<Ue.time;if(this.reset(),fe.eventType&qt&&this.count===0)return this.failTimeout();if(Gr&&In&&kt){if(fe.eventType!=Ur)return this.failTimeout();var Li=this.pTime?fe.timeStamp-this.pTime<Ue.interval:!0,Oa=!this.pCenter||Xn(this.pCenter,fe.center)<Ue.posThreshold;this.pTime=fe.timeStamp,this.pCenter=fe.center,!Oa||!Li?this.count=1:this.count+=1,this._input=fe;var Sa=this.count%Ue.taps;if(Sa===0)return this.hasRequireFailures()?(this._timer=ht(function(){this.state=ao,this.tryEmit()},Ue.interval,this),Ai):ao}return Ct},failTimeout:function(){return this._timer=ht(function(){this.state=Ct},this.options.interval,this),Ct},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ao&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function mt(Ve,fe){return fe=fe||{},fe.recognizers=Rt(fe.recognizers,mt.defaults.preset),new oe(Ve,fe)}mt.VERSION="2.0.7",mt.defaults={domEvents:!1,touchAction:_i,enable:!0,inputTarget:null,inputClass:null,preset:[[Xo,{enable:!1}],[Po,{enable:!1},["rotate"]],[$r,{direction:qn}],[Ta,{direction:qn},["swipe"]],[Oo],[Oo,{event:"doubletap",taps:2},["tap"]],[Nr]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var wu=1,ms=2;function oe(Ve,fe){this.options=rt({},mt.defaults,fe||{}),this.options.inputTarget=this.options.inputTarget||Ve,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ve,this.input=Mo(this),this.touchAction=new zo(this,this.options.touchAction),Ws(this,!0),Be(this.options.recognizers,function(Ue){var kt=this.add(new Ue[0](Ue[1]));Ue[2]&&kt.recognizeWith(Ue[2]),Ue[3]&&kt.requireFailure(Ue[3])},this)}oe.prototype={set:function(fe){return rt(this.options,fe),fe.touchAction&&this.touchAction.update(),fe.inputTarget&&(this.input.destroy(),this.input.target=fe.inputTarget,this.input.init()),this},stop:function(fe){this.session.stopped=fe?ms:wu},recognize:function(fe){var Ue=this.session;if(!Ue.stopped){this.touchAction.preventDefaults(fe);var kt,Gr=this.recognizers,In=Ue.curRecognizer;(!In||In&&In.state&ao)&&(In=Ue.curRecognizer=null);for(var Li=0;Li<Gr.length;)kt=Gr[Li],Ue.stopped!==ms&&(!In||kt==In||kt.canRecognizeWith(In))?kt.recognize(fe):kt.reset(),!In&&kt.state&(Ai|xi|to)&&(In=Ue.curRecognizer=kt),Li++}},get:function(fe){if(fe instanceof ss)return fe;for(var Ue=this.recognizers,kt=0;kt<Ue.length;kt++)if(Ue[kt].options.event==fe)return Ue[kt];return null},add:function(fe){if(gt(fe,"add",this))return this;var Ue=this.get(fe.options.event);return Ue&&this.remove(Ue),this.recognizers.push(fe),fe.manager=this,this.touchAction.update(),fe},remove:function(fe){if(gt(fe,"remove",this))return this;if(fe=this.get(fe),fe){var Ue=this.recognizers,kt=Jr(Ue,fe);kt!==-1&&(Ue.splice(kt,1),this.touchAction.update())}return this},on:function(fe,Ue){if(fe!==h&&Ue!==h){var kt=this.handlers;return Be(Mr(fe),function(Gr){kt[Gr]=kt[Gr]||[],kt[Gr].push(Ue)}),this}},off:function(fe,Ue){if(fe!==h){var kt=this.handlers;return Be(Mr(fe),function(Gr){Ue?kt[Gr]&&kt[Gr].splice(Jr(kt[Gr],Ue),1):delete kt[Gr]}),this}},emit:function(fe,Ue){this.options.domEvents&&Io(fe,Ue);var kt=this.handlers[fe]&&this.handlers[fe].slice();if(!(!kt||!kt.length)){Ue.type=fe,Ue.preventDefault=function(){Ue.srcEvent.preventDefault()};for(var Gr=0;Gr<kt.length;)kt[Gr](Ue),Gr++}},destroy:function(){this.element&&Ws(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Ws(Ve,fe){var Ue=Ve.element;if(!!Ue.style){var kt;Be(Ve.options.cssProps,function(Gr,In){kt=Ie(Ue.style,In),fe?(Ve.oldCssProps[kt]=Ue.style[kt],Ue.style[kt]=Gr):Ue.style[kt]=Ve.oldCssProps[kt]||""}),fe||(Ve.oldCssProps={})}}function Io(Ve,fe){if(!Q){var Ue=H.createEvent("Event");Ue.initEvent(Ve,!0,!0),Ue.gesture=fe,fe.target.dispatchEvent(Ue)}}if(!Q){rt(mt,{INPUT_START:qt,INPUT_MOVE:pr,INPUT_END:Ur,INPUT_CANCEL:gr,STATE_POSSIBLE:ri,STATE_BEGAN:Ai,STATE_CHANGED:xi,STATE_ENDED:to,STATE_RECOGNIZED:ao,STATE_CANCELLED:Ea,STATE_FAILED:Ct,DIRECTION_NONE:or,DIRECTION_LEFT:Rr,DIRECTION_RIGHT:Hn,DIRECTION_UP:en,DIRECTION_DOWN:_n,DIRECTION_HORIZONTAL:qn,DIRECTION_VERTICAL:ii,DIRECTION_ALL:Xi,Manager:oe,Input:Bi,TouchAction:zo,TouchInput:Ar,MouseInput:Hs,PointerEventInput:pe,TouchMouseInput:an,SingleTouchInput:vt,Recognizer:ss,AttrRecognizer:Pa,Tap:Oo,Pan:Ta,Swipe:$r,Pinch:Po,Rotate:Xo,Press:Nr,on:ke,off:Mt,each:Be,merge:$,extend:lt,assign:rt,inherit:Qt,bindFn:Ir,prefixed:Ie});var xo=typeof window!="undefined"?window:typeof self!="undefined"?self:{};xo.Hammer=mt,N=function(){return mt}.call(Z,w,Z,ae),N!==h&&(ae.exports=N)}})(typeof window!="undefined"?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document,"Hammer")},Aib3:function(ae,Z,w){var N=w("mhV4");ae.exports=G;function G(Q,se){switch(Q&&Q.type||null){case"FeatureCollection":return Q.features=Q.features.map(H(G,se)),Q;case"GeometryCollection":return Q.geometries=Q.geometries.map(H(G,se)),Q;case"Feature":return Q.geometry=G(Q.geometry,se),Q;case"Polygon":case"MultiPolygon":return B(Q,se);default:return Q}}function H(Q,se){return function(Ce){return Q(Ce,se)}}function B(Q,se){return Q.type==="Polygon"?Q.coordinates=h(Q.coordinates,se):Q.type==="MultiPolygon"&&(Q.coordinates=Q.coordinates.map(H(h,se))),Q}function h(Q,se){se=!!se,Q[0]=z(Q[0],se);for(var Ce=1;Ce<Q.length;Ce++)Q[Ce]=z(Q[Ce],!se);return Q}function z(Q,se){return U(Q)===se?Q:Q.reverse()}function U(Q){return N.ring(Q)>=0}},AwBQ:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.Lookup=void 0;var N=w("MON2"),G=function(){function H(){this._map=new Map}return H.prototype.getMap=function(){return this._map},H.prototype.add=function(B,h){if(B==null)throw new Error(N.NULL_ARGUMENT);if(h==null)throw new Error(N.NULL_ARGUMENT);var z=this._map.get(B);z!==void 0?(z.push(h),this._map.set(B,z)):this._map.set(B,[h])},H.prototype.get=function(B){if(B==null)throw new Error(N.NULL_ARGUMENT);var h=this._map.get(B);if(h!==void 0)return h;throw new Error(N.KEY_NOT_FOUND)},H.prototype.remove=function(B){if(B==null)throw new Error(N.NULL_ARGUMENT);if(!this._map.delete(B))throw new Error(N.KEY_NOT_FOUND)},H.prototype.removeByCondition=function(B){var h=this;this._map.forEach(function(z,U){var Q=z.filter(function(se){return!B(se)});Q.length>0?h._map.set(U,Q):h._map.delete(U)})},H.prototype.hasKey=function(B){if(B==null)throw new Error(N.NULL_ARGUMENT);return this._map.has(B)},H.prototype.clone=function(){var B=new H;return this._map.forEach(function(h,z){h.forEach(function(U){return B.add(z,U.clone())})}),B},H.prototype.traverse=function(B){this._map.forEach(function(h,z){B(z,h)})},H}();Z.Lookup=G},"B6l+":function(ae,Z,w){var N=w("Sq3C"),G=w("Z1HP"),H=w("Sxd8"),B=w("dt0z");function h(z,U,Q){z=B(z),U=H(U);var se=U?G(z):0;return U&&se<U?z+N(U-se,Q):z}ae.exports=h},BkRI:function(ae,Z,w){var N=w("OBhP"),G=1,H=4;function B(h){return N(h,G|H)}ae.exports=B},Bnag:function(ae,Z){function w(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}ae.exports=w,ae.exports.__esModule=!0,ae.exports.default=ae.exports},CZoQ:function(ae,Z){function w(N,G,H){for(var B=H-1,h=N.length;++B<h;)if(N[B]===G)return B;return-1}ae.exports=w},D9lx:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.BindingInWhenOnSyntax=void 0;var N=w("6AGu"),G=w("406g"),H=w("z4Hk"),B=function(){function h(z){this._binding=z,this._bindingWhenSyntax=new H.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new G.BindingOnSyntax(this._binding),this._bindingInSyntax=new N.BindingInSyntax(z)}return h.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},h.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},h.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},h.prototype.when=function(z){return this._bindingWhenSyntax.when(z)},h.prototype.whenTargetNamed=function(z){return this._bindingWhenSyntax.whenTargetNamed(z)},h.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},h.prototype.whenTargetTagged=function(z,U){return this._bindingWhenSyntax.whenTargetTagged(z,U)},h.prototype.whenInjectedInto=function(z){return this._bindingWhenSyntax.whenInjectedInto(z)},h.prototype.whenParentNamed=function(z){return this._bindingWhenSyntax.whenParentNamed(z)},h.prototype.whenParentTagged=function(z,U){return this._bindingWhenSyntax.whenParentTagged(z,U)},h.prototype.whenAnyAncestorIs=function(z){return this._bindingWhenSyntax.whenAnyAncestorIs(z)},h.prototype.whenNoAncestorIs=function(z){return this._bindingWhenSyntax.whenNoAncestorIs(z)},h.prototype.whenAnyAncestorNamed=function(z){return this._bindingWhenSyntax.whenAnyAncestorNamed(z)},h.prototype.whenAnyAncestorTagged=function(z,U){return this._bindingWhenSyntax.whenAnyAncestorTagged(z,U)},h.prototype.whenNoAncestorNamed=function(z){return this._bindingWhenSyntax.whenNoAncestorNamed(z)},h.prototype.whenNoAncestorTagged=function(z,U){return this._bindingWhenSyntax.whenNoAncestorTagged(z,U)},h.prototype.whenAnyAncestorMatches=function(z){return this._bindingWhenSyntax.whenAnyAncestorMatches(z)},h.prototype.whenNoAncestorMatches=function(z){return this._bindingWhenSyntax.whenNoAncestorMatches(z)},h.prototype.onActivation=function(z){return this._bindingOnSyntax.onActivation(z)},h}();Z.BindingInWhenOnSyntax=B},DnfT:function(ae,Z,w){},"Dw+G":function(ae,Z,w){var N=w("juv8"),G=w("mTTR");function H(B,h){return B&&N(h,G(h),B)}ae.exports=H},DzJC:function(ae,Z,w){var N=w("sEfC"),G=w("GoyQ"),H="Expected a function";function B(h,z,U){var Q=!0,se=!0;if(typeof h!="function")throw new TypeError(H);return G(U)&&(Q="leading"in U?!!U.leading:Q,se="trailing"in U?!!U.trailing:se),N(h,z,{leading:Q,maxWait:z,trailing:se})}ae.exports=B},EA7m:function(ae,Z,w){var N=w("zZ0H"),G=w("Ioao"),H=w("wclG");function B(h,z){return H(G(h,z,N),h+"")}ae.exports=B},EEGq:function(ae,Z,w){var N=w("juv8"),G=w("oCl/");function H(B,h){return N(B,G(B),h)}ae.exports=H},EbDI:function(ae,Z){function w(N){if(typeof Symbol!="undefined"&&N[Symbol.iterator]!=null||N["@@iterator"]!=null)return Array.from(N)}ae.exports=w,ae.exports.__esModule=!0,ae.exports.default=ae.exports},Em2t:function(ae,Z,w){var N=w("bahg"),G=w("quyA"),H=w("0JQy");function B(h){return G(h)?H(h):N(h)}ae.exports=B},FRQA:function(ae,Z,w){"use strict";var N=w("GNNt"),G=w("wEI+"),H=w("DnfT"),B=w.n(H),h=w("q1tI"),z=w.n(h),U=w("TSYQ"),Q=w.n(U),se=w("jYQm"),Ce=function(st){var tt=Object(h.useContext)(se.a),ut=st.children,ht=st.contentWidth,gt=st.className,Be=st.style,dt=Object(h.useContext)(G.a.ConfigContext),rt=dt.getPrefixCls,lt=st.prefixCls||rt("pro"),$=ht||tt.contentWidth,Qt="".concat(lt,"-grid-content");return z.a.createElement("div",{className:Q()(Qt,gt,{wide:$==="Fixed"}),style:Be},z.a.createElement("div",{className:"".concat(lt,"-grid-content-children")},ut))};Z.a=Ce},FV85:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.TargetTypeEnum=Z.BindingTypeEnum=Z.BindingScopeEnum=void 0;var N={Request:"Request",Singleton:"Singleton",Transient:"Transient"};Z.BindingScopeEnum=N;var G={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};Z.BindingTypeEnum=G;var H={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};Z.TargetTypeEnum=H},G6z8:function(ae,Z,w){var N=w("fR/l"),G=w("oCl/"),H=w("mTTR");function B(h){return N(h,H,G)}ae.exports=B},GXnB:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.Metadata=void 0;var N=w("xfSm"),G=function(){function H(B,h){this.key=B,this.value=h}return H.prototype.toString=function(){return this.key===N.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},H}();Z.Metadata=G},Gi0A:function(ae,Z,w){var N=w("QqLw"),G=w("ExA7"),H="[object Map]";function B(h){return G(h)&&N(h)==H}ae.exports=B},HpQ9:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.ContainerSnapshot=void 0;var N=function(){function G(){}return G.of=function(H,B){var h=new G;return h.bindings=H,h.middleware=B,h},G}();Z.ContainerSnapshot=N},Ijbi:function(ae,Z,w){var N=w("WkPL");function G(H){if(Array.isArray(H))return N(H)}ae.exports=G,ae.exports.__esModule=!0,ae.exports.default=ae.exports},Ioao:function(ae,Z,w){var N=w("heNW"),G=Math.max;function H(B,h,z){return h=G(h===void 0?B.length-1:h,0),function(){for(var U=arguments,Q=-1,se=G(U.length-h,0),Ce=Array(se);++Q<se;)Ce[Q]=U[h+Q];Q=-1;for(var be=Array(h+1);++Q<h;)be[Q]=U[Q];return be[h]=z(Ce),N(B,this,be)}}ae.exports=H},J2iB:function(ae,Z){function w(N){return N==null}ae.exports=w},JBE3:function(ae,Z,w){var N=w("+Qka"),G=w("LsHQ"),H=G(function(B,h,z,U){N(B,h,z,U)});ae.exports=H},KwMD:function(ae,Z){function w(N,G,H,B){for(var h=N.length,z=H+(B?1:-1);B?z--:++z<h;)if(G(N[z],z,N))return z;return-1}ae.exports=w},KxBF:function(ae,Z){function w(N,G,H){var B=-1,h=N.length;G<0&&(G=-G>h?0:h+G),H=H>h?h:H,H<0&&(H+=h),h=G>H?0:H-G>>>0,G>>>=0;for(var z=Array(h);++B<h;)z[B]=N[B+G];return z}ae.exports=w},LGYb:function(ae,Z,w){var N=w("1hJj"),G=w("jbM+"),H=w("Xt/L"),B=w("xYSL"),h=w("dQpi"),z=w("rEGp"),U=200;function Q(se,Ce,be){var st=-1,tt=G,ut=se.length,ht=!0,gt=[],Be=gt;if(be)ht=!1,tt=H;else if(ut>=U){var dt=Ce?null:h(se);if(dt)return z(dt);ht=!1,tt=B,Be=new N}else Be=Ce?[]:gt;e:for(;++st<ut;){var rt=se[st],lt=Ce?Ce(rt):rt;if(rt=be||rt!==0?rt:0,ht&&lt===lt){for(var $=Be.length;$--;)if(Be[$]===lt)continue e;Ce&&Be.push(lt),gt.push(rt)}else tt(Be,lt,be)||(Be!==gt&&Be.push(lt),gt.push(rt))}return gt}ae.exports=Q},LKzl:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.BindingWhenOnSyntax=void 0;var N=w("406g"),G=w("z4Hk"),H=function(){function B(h){this._binding=h,this._bindingWhenSyntax=new G.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new N.BindingOnSyntax(this._binding)}return B.prototype.when=function(h){return this._bindingWhenSyntax.when(h)},B.prototype.whenTargetNamed=function(h){return this._bindingWhenSyntax.whenTargetNamed(h)},B.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},B.prototype.whenTargetTagged=function(h,z){return this._bindingWhenSyntax.whenTargetTagged(h,z)},B.prototype.whenInjectedInto=function(h){return this._bindingWhenSyntax.whenInjectedInto(h)},B.prototype.whenParentNamed=function(h){return this._bindingWhenSyntax.whenParentNamed(h)},B.prototype.whenParentTagged=function(h,z){return this._bindingWhenSyntax.whenParentTagged(h,z)},B.prototype.whenAnyAncestorIs=function(h){return this._bindingWhenSyntax.whenAnyAncestorIs(h)},B.prototype.whenNoAncestorIs=function(h){return this._bindingWhenSyntax.whenNoAncestorIs(h)},B.prototype.whenAnyAncestorNamed=function(h){return this._bindingWhenSyntax.whenAnyAncestorNamed(h)},B.prototype.whenAnyAncestorTagged=function(h,z){return this._bindingWhenSyntax.whenAnyAncestorTagged(h,z)},B.prototype.whenNoAncestorNamed=function(h){return this._bindingWhenSyntax.whenNoAncestorNamed(h)},B.prototype.whenNoAncestorTagged=function(h,z){return this._bindingWhenSyntax.whenNoAncestorTagged(h,z)},B.prototype.whenAnyAncestorMatches=function(h){return this._bindingWhenSyntax.whenAnyAncestorMatches(h)},B.prototype.whenNoAncestorMatches=function(h){return this._bindingWhenSyntax.whenNoAncestorMatches(h)},B.prototype.onActivation=function(h){return this._bindingOnSyntax.onActivation(h)},B}();Z.BindingWhenOnSyntax=H},LcsW:function(ae,Z,w){var N=w("kekF"),G=N(Object.getPrototypeOf,Object);ae.exports=G},LgvC:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.Binding=void 0;var N=w("FV85"),G=w("d9O0"),H=function(){function B(h,z){this.id=G.id(),this.activated=!1,this.serviceIdentifier=h,this.scope=z,this.type=N.BindingTypeEnum.Invalid,this.constraint=function(U){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return B.prototype.clone=function(){var h=new B(this.serviceIdentifier,this.scope);return h.activated=h.scope===N.BindingScopeEnum.Singleton?this.activated:!1,h.implementationType=this.implementationType,h.dynamicValue=this.dynamicValue,h.scope=this.scope,h.type=this.type,h.factory=this.factory,h.provider=this.provider,h.constraint=this.constraint,h.onActivation=this.onActivation,h.cache=this.cache,h},B}();Z.Binding=H},LsHQ:function(ae,Z,w){var N=w("EA7m"),G=w("mv/X");function H(B){return N(function(h,z){var U=-1,Q=z.length,se=Q>1?z[Q-1]:void 0,Ce=Q>2?z[2]:void 0;for(se=B.length>3&&typeof se=="function"?(Q--,se):void 0,Ce&&G(z[0],z[1],Ce)&&(se=Q<3?void 0:se,Q=1),h=Object(h);++U<Q;){var be=z[U];be&&B(h,be,U,se)}return h})}ae.exports=H},MON2:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.STACK_OVERFLOW=Z.CIRCULAR_DEPENDENCY_IN_FACTORY=Z.POST_CONSTRUCT_ERROR=Z.MULTIPLE_POST_CONSTRUCT_METHODS=Z.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=Z.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=Z.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=Z.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=Z.ARGUMENTS_LENGTH_MISMATCH=Z.INVALID_DECORATOR_OPERATION=Z.INVALID_TO_SELF_VALUE=Z.INVALID_FUNCTION_BINDING=Z.INVALID_MIDDLEWARE_RETURN=Z.NO_MORE_SNAPSHOTS_AVAILABLE=Z.INVALID_BINDING_TYPE=Z.NOT_IMPLEMENTED=Z.CIRCULAR_DEPENDENCY=Z.UNDEFINED_INJECT_ANNOTATION=Z.MISSING_INJECT_ANNOTATION=Z.MISSING_INJECTABLE_ANNOTATION=Z.NOT_REGISTERED=Z.CANNOT_UNBIND=Z.AMBIGUOUS_MATCH=Z.KEY_NOT_FOUND=Z.NULL_ARGUMENT=Z.DUPLICATED_METADATA=Z.DUPLICATED_INJECTABLE_DECORATOR=void 0,Z.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",Z.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",Z.NULL_ARGUMENT="NULL argument",Z.KEY_NOT_FOUND="Key Not Found",Z.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",Z.CANNOT_UNBIND="Could not unbind serviceIdentifier:",Z.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",Z.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",Z.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var N=function(z){return"@inject called with undefined this could mean that the class "+z+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};Z.UNDEFINED_INJECT_ANNOTATION=N,Z.CIRCULAR_DEPENDENCY="Circular dependency found:",Z.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",Z.INVALID_BINDING_TYPE="Invalid binding type:",Z.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",Z.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",Z.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",Z.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",Z.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var G=function(){for(var z=[],U=0;U<arguments.length;U++)z[U]=arguments[U];return"The number of constructor arguments in the derived class "+(z[0]+" must be >= than the number of constructor arguments of its base class.")};Z.ARGUMENTS_LENGTH_MISMATCH=G,Z.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",Z.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",Z.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",Z.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",Z.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var H=function(){for(var z=[],U=0;U<arguments.length;U++)z[U]=arguments[U];return"@postConstruct error in class "+z[0]+": "+z[1]};Z.POST_CONSTRUCT_ERROR=H;var B=function(){for(var z=[],U=0;U<arguments.length;U++)z[U]=arguments[U];return"It looks like there is a circular dependency "+("in one of the '"+z[0]+"' bindings. Please investigate bindings with")+("service identifier '"+z[1]+"'.")};Z.CIRCULAR_DEPENDENCY_IN_FACTORY=B,Z.STACK_OVERFLOW="Maximum call stack size exceeded"},MrPd:function(ae,Z,w){var N=w("hypo"),G=w("ljhN"),H=Object.prototype,B=H.hasOwnProperty;function h(z,U,Q){var se=z[U];(!(B.call(z,U)&&G(se,Q))||Q===void 0&&!(U in z))&&N(z,U,Q)}ae.exports=h},Nsbk:function(ae,Z){function w(N){return ae.exports=w=Object.setPrototypeOf?Object.getPrototypeOf:function(H){return H.__proto__||Object.getPrototypeOf(H)},ae.exports.__esModule=!0,ae.exports.default=ae.exports,w(N)}ae.exports=w,ae.exports.__esModule=!0,ae.exports.default=ae.exports},O0oS:function(ae,Z,w){var N=w("Cwc5"),G=function(){try{var H=N(Object,"defineProperty");return H({},"",{}),H}catch(B){}}();ae.exports=G},OBhP:function(ae,Z,w){var N=w("fmRc"),G=w("gFfm"),H=w("MrPd"),B=w("WwFo"),h=w("Dw+G"),z=w("5Tg0"),U=w("Q1l4"),Q=w("VOtZ"),se=w("EEGq"),Ce=w("qZTm"),be=w("G6z8"),st=w("QqLw"),tt=w("yHx3"),ut=w("wrZu"),ht=w("+iFO"),gt=w("Z0cm"),Be=w("DSRE"),dt=w("zEVN"),rt=w("GoyQ"),lt=w("1+5i"),$=w("7GkX"),Qt=w("mTTR"),Ir=1,br=2,Rt=4,ke="[object Arguments]",Mt="[object Array]",Nt="[object Boolean]",nr="[object Date]",Mr="[object Error]",Jr="[object Function]",Er="[object GeneratorFunction]",de="[object Map]",Ie="[object Number]",we="[object Object]",ct="[object RegExp]",ot="[object Set]",wt="[object String]",S="[object Symbol]",ur="[object WeakMap]",Pt="[object ArrayBuffer]",Ft="[object DataView]",Et="[object Float32Array]",St="[object Float64Array]",Zt="[object Int8Array]",dr="[object Int16Array]",qt="[object Int32Array]",pr="[object Uint8Array]",Ur="[object Uint8ClampedArray]",gr="[object Uint16Array]",or="[object Uint32Array]",Rr={};Rr[ke]=Rr[Mt]=Rr[Pt]=Rr[Ft]=Rr[Nt]=Rr[nr]=Rr[Et]=Rr[St]=Rr[Zt]=Rr[dr]=Rr[qt]=Rr[de]=Rr[Ie]=Rr[we]=Rr[ct]=Rr[ot]=Rr[wt]=Rr[S]=Rr[pr]=Rr[Ur]=Rr[gr]=Rr[or]=!0,Rr[Mr]=Rr[Jr]=Rr[ur]=!1;function Hn(en,_n,qn,ii,Xi,me){var yn,Bi=_n&Ir,Mo=_n&br,os=_n&Rt;if(qn&&(yn=Xi?qn(en,ii,Xi,me):qn(en)),yn!==void 0)return yn;if(!rt(en))return en;var jt=gt(en);if(jt){if(yn=tt(en),!Bi)return U(en,yn)}else{var _r=st(en),Xr=_r==Jr||_r==Er;if(Be(en))return z(en,Bi);if(_r==we||_r==ke||Xr&&!Xi){if(yn=Mo||Xr?{}:ht(en),!Bi)return Mo?se(en,h(yn,en)):Q(en,B(yn,en))}else{if(!Rr[_r])return Xi?en:{};yn=ut(en,_r,Bi)}}me||(me=new N);var vn=me.get(en);if(vn)return vn;me.set(en,yn),lt(en)?en.forEach(function(li){yn.add(Hn(li,_n,qn,li,en,me))}):dt(en)&&en.forEach(function(li,Xn){yn.set(Xn,Hn(li,_n,qn,Xn,en,me))});var Kr=os?Mo?be:Ce:Mo?Qt:$,ba=jt?void 0:Kr(en);return G(ba||en,function(li,Xn){ba&&(Xn=li,li=en[Xn]),H(yn,Xn,Hn(li,_n,qn,Xn,en,me))}),yn}ae.exports=Hn},PJYZ:function(ae,Z){function w(N){if(N===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N}ae.exports=w,ae.exports.__esModule=!0,ae.exports.default=ae.exports},Q1l4:function(ae,Z){function w(N,G){var H=-1,B=N.length;for(G||(G=Array(B));++H<B;)G[H]=N[H];return G}ae.exports=w},"QQZ/":function(ae,Z,w){var N=w("Sq3C"),G=w("Z1HP"),H=w("Sxd8"),B=w("dt0z");function h(z,U,Q){z=B(z),U=H(U);var se=U?G(z):0;return U&&se<U?N(U-se,Q)+z:z}ae.exports=h},QcOe:function(ae,Z,w){var N=w("GoyQ"),G=w("6sVZ"),H=w("7Ix3"),B=Object.prototype,h=B.hasOwnProperty;function z(U){if(!N(U))return H(U);var Q=G(U),se=[];for(var Ce in U)Ce=="constructor"&&(Q||!h.call(U,Ce))||se.push(Ce);return se}ae.exports=z},QkVN:function(ae,Z,w){var N=w("+Qka"),G=w("LsHQ"),H=G(function(B,h,z){N(B,h,z)});ae.exports=H},"R/W3":function(ae,Z,w){var N=w("KwMD"),G=w("2ajD"),H=w("CZoQ");function B(h,z,U){return z===z?H(h,z,U):N(h,G,U)}ae.exports=B},RIqP:function(ae,Z,w){var N=w("Ijbi"),G=w("EbDI"),H=w("ZhPi"),B=w("Bnag");function h(z){return N(z)||G(z)||H(z)||B()}ae.exports=h,ae.exports.__esModule=!0,ae.exports.default=ae.exports},"RR/i":function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.typeConstraint=Z.namedConstraint=Z.taggedConstraint=Z.traverseAncerstors=void 0;var N=w("xfSm"),G=w("GXnB"),H=function U(Q,se){var Ce=Q.parentRequest;return Ce!==null?se(Ce)?!0:U(Ce,se):!1};Z.traverseAncerstors=H;var B=function(Q){return function(se){var Ce=function(st){return st!==null&&st.target!==null&&st.target.matchesTag(Q)(se)};return Ce.metaData=new G.Metadata(Q,se),Ce}};Z.taggedConstraint=B;var h=B(N.NAMED_TAG);Z.namedConstraint=h;var z=function(Q){return function(se){var Ce=null;if(se!==null)if(Ce=se.bindings[0],typeof Q=="string"){var be=Ce.serviceIdentifier;return be===Q}else{var st=se.bindings[0].implementationType;return Q===st}return!1}};Z.typeConstraint=z},SUU4:function(ae,Z,w){(function(N,G){ae.exports=G(w("szb8"))})(this,function(N){"use strict";var G=function(ue){return ue instanceof Uint8Array||ue instanceof Uint16Array||ue instanceof Uint32Array||ue instanceof Int8Array||ue instanceof Int16Array||ue instanceof Int32Array||ue instanceof Float32Array||ue instanceof Float64Array||ue instanceof Uint8ClampedArray},H=function(ue,He){for(var Ht=Object.keys(He),hr=0;hr<Ht.length;++hr)ue[Ht[hr]]=He[Ht[hr]];return ue},B=`
`;function h(K){return typeof atob!="undefined"?atob(K):"base64:"+K}function z(K){var ue=new Error("(regl) "+K);throw console.error(ue),ue}function U(K,ue){K||z(ue)}function Q(K){return K?": "+K:""}function se(K,ue,He){K in ue||z("unknown parameter ("+K+")"+Q(He)+". possible values: "+Object.keys(ue).join())}function Ce(K,ue){G(K)||z("invalid parameter type"+Q(ue)+". must be a typed array")}function be(K,ue){switch(ue){case"number":return typeof K=="number";case"object":return typeof K=="object";case"string":return typeof K=="string";case"boolean":return typeof K=="boolean";case"function":return typeof K=="function";case"undefined":return typeof K=="undefined";case"symbol":return typeof K=="symbol"}}function st(K,ue,He){be(K,ue)||z("invalid parameter type"+Q(He)+". expected "+ue+", got "+typeof K)}function tt(K,ue){K>=0&&(K|0)===K||z("invalid parameter type, ("+K+")"+Q(ue)+". must be a nonnegative integer")}function ut(K,ue,He){ue.indexOf(K)<0&&z("invalid value"+Q(He)+". must be one of: "+ue)}var ht=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function gt(K){Object.keys(K).forEach(function(ue){ht.indexOf(ue)<0&&z('invalid regl constructor argument "'+ue+'". must be one of '+ht)})}function Be(K,ue){for(K=K+"";K.length<ue;)K=" "+K;return K}function dt(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function rt(K,ue){this.number=K,this.line=ue,this.errors=[]}function lt(K,ue,He){this.file=K,this.line=ue,this.message=He}function $(){var K=new Error,ue=(K.stack||K).toString(),He=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(ue);if(He)return He[1];var Ht=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(ue);return Ht?Ht[1]:"unknown"}function Qt(){var K=new Error,ue=(K.stack||K).toString(),He=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(ue);if(He)return He[1];var Ht=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(ue);return Ht?Ht[1]:"unknown"}function Ir(K,ue){var He=K.split(`
`),Ht=1,hr=0,ar={unknown:new dt,0:new dt};ar.unknown.name=ar[0].name=ue||$(),ar.unknown.lines.push(new rt(0,""));for(var Jt=0;Jt<He.length;++Jt){var Pr=He[Jt],jr=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Pr);if(jr)switch(jr[1]){case"line":var Vr=/(\d+)(\s+\d+)?/.exec(jr[2]);Vr&&(Ht=Vr[1]|0,Vr[2]&&(hr=Vr[2]|0,hr in ar||(ar[hr]=new dt)));break;case"define":var Yr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(jr[2]);Yr&&(ar[hr].name=Yr[1]?h(Yr[2]):Yr[2]);break}ar[hr].lines.push(new rt(Ht++,Pr))}return Object.keys(ar).forEach(function(Wr){var pn=ar[Wr];pn.lines.forEach(function(on){pn.index[on.number]=on})}),ar}function br(K){var ue=[];return K.split(`
`).forEach(function(He){if(!(He.length<5)){var Ht=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(He);Ht?ue.push(new lt(Ht[1]|0,Ht[2]|0,Ht[3].trim())):He.length>0&&ue.push(new lt("unknown",0,He))}}),ue}function Rt(K,ue){ue.forEach(function(He){var Ht=K[He.file];if(Ht){var hr=Ht.index[He.line];if(hr){hr.errors.push(He),Ht.hasErrors=!0;return}}K.unknown.hasErrors=!0,K.unknown.lines[0].errors.push(He)})}function ke(K,ue,He,Ht,hr){if(!K.getShaderParameter(ue,K.COMPILE_STATUS)){var ar=K.getShaderInfoLog(ue),Jt=Ht===K.FRAGMENT_SHADER?"fragment":"vertex";de(He,"string",Jt+" shader source must be a string",hr);var Pr=Ir(He,hr),jr=br(ar);Rt(Pr,jr),Object.keys(Pr).forEach(function(Vr){var Yr=Pr[Vr];if(!Yr.hasErrors)return;var Wr=[""],pn=[""];function on(zr,Gt){Wr.push(zr),pn.push(Gt||"")}on("file number "+Vr+": "+Yr.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Yr.lines.forEach(function(zr){if(zr.errors.length>0){on(Be(zr.number,4)+"|  ","background-color:yellow; font-weight:bold"),on(zr.line+B,"color:red; background-color:yellow; font-weight:bold");var Gt=0;zr.errors.forEach(function(Wt){var Br=Wt.message,Tn=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Br);if(Tn){var cr=Tn[1];switch(Br=Tn[2],cr){case"assign":cr="=";break}Gt=Math.max(zr.line.indexOf(cr,Gt),0)}else Gt=0;on(Be("| ",6)),on(Be("^^^",Gt+3)+B,"font-weight:bold"),on(Be("| ",6)),on(Br+B,"font-weight:bold")}),on(Be("| ",6)+B)}else on(Be(zr.number,4)+"|  "),on(zr.line+B,"color:red")}),typeof document!="undefined"&&!window.chrome?(pn[0]=Wr.join("%c"),console.log.apply(console,pn)):console.log(Wr.join(""))}),U.raise("Error compiling "+Jt+" shader, "+Pr[0].name)}}function Mt(K,ue,He,Ht,hr){if(!K.getProgramParameter(ue,K.LINK_STATUS)){var ar=K.getProgramInfoLog(ue),Jt=Ir(He,hr),Pr=Ir(Ht,hr),jr='Error linking program with vertex shader, "'+Pr[0].name+'", and fragment shader "'+Jt[0].name+'"';typeof document!="undefined"?console.log("%c"+jr+B+"%c"+ar,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(jr+B+ar),U.raise(jr)}}function Nt(K){K._commandRef=$()}function nr(K,ue,He,Ht){Nt(K);function hr(jr){return jr?Ht.id(jr):0}K._fragId=hr(K.static.frag),K._vertId=hr(K.static.vert);function ar(jr,Vr){Object.keys(Vr).forEach(function(Yr){jr[Ht.id(Yr)]=!0})}var Jt=K._uniformSet={};ar(Jt,ue.static),ar(Jt,ue.dynamic);var Pr=K._attributeSet={};ar(Pr,He.static),ar(Pr,He.dynamic),K._hasCount="count"in K.static||"count"in K.dynamic||"elements"in K.static||"elements"in K.dynamic}function Mr(K,ue){var He=Qt();z(K+" in command "+(ue||$())+(He==="unknown"?"":" called from "+He))}function Jr(K,ue,He){K||Mr(ue,He||$())}function Er(K,ue,He,Ht){K in ue||Mr("unknown parameter ("+K+")"+Q(He)+". possible values: "+Object.keys(ue).join(),Ht||$())}function de(K,ue,He,Ht){be(K,ue)||Mr("invalid parameter type"+Q(He)+". expected "+ue+", got "+typeof K,Ht||$())}function Ie(K){K()}function we(K,ue,He){K.texture?ut(K.texture._texture.internalformat,ue,"unsupported texture format for attachment"):ut(K.renderbuffer._renderbuffer.format,He,"unsupported renderbuffer format for attachment")}var ct=33071,ot=9728,wt=9984,S=9985,ur=9986,Pt=9987,Ft=5120,Et=5121,St=5122,Zt=5123,dr=5124,qt=5125,pr=5126,Ur=32819,gr=32820,or=33635,Rr=34042,Hn=36193,en={};en[Ft]=en[Et]=1,en[St]=en[Zt]=en[Hn]=en[or]=en[Ur]=en[gr]=2,en[dr]=en[qt]=en[pr]=en[Rr]=4;function _n(K,ue){return K===gr||K===Ur||K===or?2:K===Rr?4:en[K]*ue}function qn(K){return!(K&K-1)&&!!K}function ii(K,ue,He){var Ht,hr=ue.width,ar=ue.height,Jt=ue.channels;U(hr>0&&hr<=He.maxTextureSize&&ar>0&&ar<=He.maxTextureSize,"invalid texture shape"),(K.wrapS!==ct||K.wrapT!==ct)&&U(qn(hr)&&qn(ar),"incompatible wrap mode for texture, both width and height must be power of 2"),ue.mipmask===1?hr!==1&&ar!==1&&U(K.minFilter!==wt&&K.minFilter!==ur&&K.minFilter!==S&&K.minFilter!==Pt,"min filter requires mipmap"):(U(qn(hr)&&qn(ar),"texture must be a square power of 2 to support mipmapping"),U(ue.mipmask===(hr<<1)-1,"missing or incomplete mipmap data")),ue.type===pr&&(He.extensions.indexOf("oes_texture_float_linear")<0&&U(K.minFilter===ot&&K.magFilter===ot,"filter not supported, must enable oes_texture_float_linear"),U(!K.genMipmaps,"mipmap generation not supported with float textures"));var Pr=ue.images;for(Ht=0;Ht<16;++Ht)if(Pr[Ht]){var jr=hr>>Ht,Vr=ar>>Ht;U(ue.mipmask&1<<Ht,"missing mipmap data");var Yr=Pr[Ht];if(U(Yr.width===jr&&Yr.height===Vr,"invalid shape for mip images"),U(Yr.format===ue.format&&Yr.internalformat===ue.internalformat&&Yr.type===ue.type,"incompatible type for mip image"),!Yr.compressed)if(Yr.data){var Wr=Math.ceil(_n(Yr.type,Jt)*jr/Yr.unpackAlignment)*Yr.unpackAlignment;U(Yr.data.byteLength===Wr*Vr,"invalid data for image, buffer size is inconsistent with image format")}else Yr.element||Yr.copy}else K.genMipmaps||U((ue.mipmask&1<<Ht)==0,"extra mipmap data");ue.compressed&&U(!K.genMipmaps,"mipmap generation for compressed images not supported")}function Xi(K,ue,He,Ht){var hr=K.width,ar=K.height,Jt=K.channels;U(hr>0&&hr<=Ht.maxTextureSize&&ar>0&&ar<=Ht.maxTextureSize,"invalid texture shape"),U(hr===ar,"cube map must be square"),U(ue.wrapS===ct&&ue.wrapT===ct,"wrap mode not supported by cube map");for(var Pr=0;Pr<He.length;++Pr){var jr=He[Pr];U(jr.width===hr&&jr.height===ar,"inconsistent cube map face shape"),ue.genMipmaps&&(U(!jr.compressed,"can not generate mipmap for compressed textures"),U(jr.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Vr=jr.images,Yr=0;Yr<16;++Yr){var Wr=Vr[Yr];if(Wr){var pn=hr>>Yr,on=ar>>Yr;U(jr.mipmask&1<<Yr,"missing mipmap data"),U(Wr.width===pn&&Wr.height===on,"invalid shape for mip images"),U(Wr.format===K.format&&Wr.internalformat===K.internalformat&&Wr.type===K.type,"incompatible type for mip image"),Wr.compressed||(Wr.data?U(Wr.data.byteLength===pn*on*Math.max(_n(Wr.type,Jt),Wr.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Wr.element||Wr.copy)}}}}var me=H(U,{optional:Ie,raise:z,commandRaise:Mr,command:Jr,parameter:se,commandParameter:Er,constructor:gt,type:st,commandType:de,isTypedArray:Ce,nni:tt,oneOf:ut,shaderError:ke,linkError:Mt,callSite:Qt,saveCommandRef:Nt,saveDrawInfo:nr,framebufferFormat:we,guessCommand:$,texture2D:ii,textureCube:Xi}),yn=0,Bi=0,Mo=5,os=6;function jt(K,ue){this.id=yn++,this.type=K,this.data=ue}function _r(K){return K.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Xr(K){if(K.length===0)return[];var ue=K.charAt(0),He=K.charAt(K.length-1);if(K.length>1&&ue===He&&(ue==='"'||ue==="'"))return['"'+_r(K.substr(1,K.length-2))+'"'];var Ht=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(K);if(Ht)return Xr(K.substr(0,Ht.index)).concat(Xr(Ht[1])).concat(Xr(K.substr(Ht.index+Ht[0].length)));var hr=K.split(".");if(hr.length===1)return['"'+_r(K)+'"'];for(var ar=[],Jt=0;Jt<hr.length;++Jt)ar=ar.concat(Xr(hr[Jt]));return ar}function vn(K){return"["+Xr(K).join("][")+"]"}function Kr(K,ue){return new jt(K,vn(ue+""))}function ba(K){return typeof K=="function"&&!K._reglType||K instanceof jt}function li(K,ue){if(typeof K=="function")return new jt(Bi,K);if(typeof K=="number"||typeof K=="boolean")return new jt(Mo,K);if(Array.isArray(K))return new jt(os,K.map(function(He,Ht){return li(He,ue+"["+Ht+"]")}));if(K instanceof jt)return K;me(!1,"invalid option type in uniform "+ue)}var Xn={DynamicVariable:jt,define:Kr,isDynamic:ba,unbox:li,accessor:vn},ci={next:typeof requestAnimationFrame=="function"?function(K){return requestAnimationFrame(K)}:function(K){return setTimeout(K,16)},cancel:typeof cancelAnimationFrame=="function"?function(K){return cancelAnimationFrame(K)}:clearTimeout},Hi=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Yi=Hi?function(){return+new Date}:typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function No(){var K={"":0},ue=[""];return{id:function(Ht){var hr=K[Ht];return hr||(hr=K[Ht]=ue.length,ue.push(Ht),hr)},str:function(Ht){return ue[Ht]}}}function Ma(K,ue,He){var Ht=document.createElement("canvas");H(Ht.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),K.appendChild(Ht),K===document.body&&(Ht.style.position="absolute",H(K.style,{margin:0,padding:0}));function hr(){var Pr=window.innerWidth,jr=window.innerHeight;if(K!==document.body){var Vr=Ht.getBoundingClientRect();Pr=Vr.right-Vr.left,jr=Vr.bottom-Vr.top}Ht.width=He*Pr,Ht.height=He*jr}var ar;K!==document.body&&typeof ResizeObserver=="function"?(ar=new ResizeObserver(function(){setTimeout(hr)}),ar.observe(K)):window.addEventListener("resize",hr,!1);function Jt(){ar?ar.disconnect():window.removeEventListener("resize",hr),K.removeChild(Ht)}return hr(),{canvas:Ht,onDestroy:Jt}}function ma(K,ue){function He(Ht){try{return K.getContext(Ht,ue)}catch(hr){return null}}return He("webgl")||He("experimental-webgl")||He("webgl-experimental")}function Hs(K){return typeof K.nodeName=="string"&&typeof K.appendChild=="function"&&typeof K.getBoundingClientRect=="function"}function il(K){return typeof K.drawArrays=="function"||typeof K.drawElements=="function"}function ja(K){return typeof K=="string"?K.split():(me(Array.isArray(K),"invalid extension array"),K)}function re(K){return typeof K=="string"?(me(typeof document!="undefined","not supported outside of DOM"),document.querySelector(K)):K}function J(K){var ue=K||{},He,Ht,hr,ar,Jt={},Pr=[],jr=[],Vr=typeof window=="undefined"?1:window.devicePixelRatio,Yr=!1,Wr=function(Gt){Gt&&me.raise(Gt)},pn=function(){};if(typeof ue=="string"?(me(typeof document!="undefined","selector queries only supported in DOM environments"),He=document.querySelector(ue),me(He,"invalid query string for element")):typeof ue=="object"?Hs(ue)?He=ue:il(ue)?(ar=ue,hr=ar.canvas):(me.constructor(ue),"gl"in ue?ar=ue.gl:"canvas"in ue?hr=re(ue.canvas):"container"in ue&&(Ht=re(ue.container)),"attributes"in ue&&(Jt=ue.attributes,me.type(Jt,"object","invalid context attributes")),"extensions"in ue&&(Pr=ja(ue.extensions)),"optionalExtensions"in ue&&(jr=ja(ue.optionalExtensions)),"onDone"in ue&&(me.type(ue.onDone,"function","invalid or missing onDone callback"),Wr=ue.onDone),"profile"in ue&&(Yr=!!ue.profile),"pixelRatio"in ue&&(Vr=+ue.pixelRatio,me(Vr>0,"invalid pixel ratio"))):me.raise("invalid arguments to regl"),He&&(He.nodeName.toLowerCase()==="canvas"?hr=He:Ht=He),!ar){if(!hr){me(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var on=Ma(Ht||document.body,Wr,Vr);if(!on)return null;hr=on.canvas,pn=on.onDestroy}Jt.premultipliedAlpha===void 0&&(Jt.premultipliedAlpha=!0),ar=ma(hr,Jt)}return ar?{gl:ar,canvas:hr,container:Ht,extensions:Pr,optionalExtensions:jr,pixelRatio:Vr,profile:Yr,onDone:Wr,onDestroy:pn}:(pn(),Wr("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function pe(K,ue){var He={};function Ht(Pr){me.type(Pr,"string","extension name must be string");var jr=Pr.toLowerCase(),Vr;try{Vr=He[jr]=hr(Pr)}catch(Yr){}return!!Vr}function hr(Pr){return K.getExtension(Pr)?K.getExtension(Pr):K.getExtension(Pr.toLowerCase())?K.getExtension(Pr.toLowerCase()):null}for(var ar=0;ar<ue.extensions.length;++ar){var Jt=ue.extensions[ar];if(!Ht(Jt))return ue.onDestroy(),ue.onDone('"'+Jt+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return ue.optionalExtensions.forEach(Ht),{extensions:He,restore:function(){Object.keys(He).forEach(function(jr){if(He[jr]&&!Ht(jr))throw new Error("(regl): error restoring extension "+jr)})}}}function Se(K,ue){for(var He=Array(K),Ht=0;Ht<K;++Ht)He[Ht]=ue(Ht);return He}var De=5120,et=5121,vt=5122,_e=5123,je=5124,$e=5125,Ar=5126;function kr(K){for(var ue=16;ue<=1<<28;ue*=16)if(K<=ue)return ue;return 0}function rr(K){var ue,He;return ue=(K>65535)<<4,K>>>=ue,He=(K>255)<<3,K>>>=He,ue|=He,He=(K>15)<<2,K>>>=He,ue|=He,He=(K>3)<<1,K>>>=He,ue|=He,ue|K>>1}function Lr(){var K=Se(8,function(){return[]});function ue(ar){var Jt=kr(ar),Pr=K[rr(Jt)>>2];return Pr.length>0?Pr.pop():new ArrayBuffer(Jt)}function He(ar){K[rr(ar.byteLength)>>2].push(ar)}function Ht(ar,Jt){var Pr=null;switch(ar){case De:Pr=new Int8Array(ue(Jt),0,Jt);break;case et:Pr=new Uint8Array(ue(Jt),0,Jt);break;case vt:Pr=new Int16Array(ue(2*Jt),0,Jt);break;case _e:Pr=new Uint16Array(ue(2*Jt),0,Jt);break;case je:Pr=new Int32Array(ue(4*Jt),0,Jt);break;case $e:Pr=new Uint32Array(ue(4*Jt),0,Jt);break;case Ar:Pr=new Float32Array(ue(4*Jt),0,Jt);break;default:return null}return Pr.length!==Jt?Pr.subarray(0,Jt):Pr}function hr(ar){He(ar.buffer)}return{alloc:ue,free:He,allocType:Ht,freeType:hr}}var an=Lr();an.zero=Lr();var An=3408,tr=3410,Cn=3411,hn=3412,xn=3413,_i=3414,wn=3415,Ni=33901,Ki=33902,Mi=3379,Fn=3386,Ui=34921,zo=36347,ia=36348,Ka=35661,ri=35660,Ai=34930,xi=36349,to=34076,ao=34024,Ea=7936,Ct=7937,ss=7938,Bt=35724,wa=34047,ro=36063,Pa=34852,Ta=3553,Po=34067,Nr=34069,Xo=33984,$r=6408,Oo=5126,mt=5121,wu=36160,ms=36053,oe=36064,Ws=16384,Io=function(ue,He){var Ht=1;He.ext_texture_filter_anisotropic&&(Ht=ue.getParameter(wa));var hr=1,ar=1;He.webgl_draw_buffers&&(hr=ue.getParameter(Pa),ar=ue.getParameter(ro));var Jt=!!He.oes_texture_float;if(Jt){var Pr=ue.createTexture();ue.bindTexture(Ta,Pr),ue.texImage2D(Ta,0,$r,1,1,0,$r,Oo,null);var jr=ue.createFramebuffer();if(ue.bindFramebuffer(wu,jr),ue.framebufferTexture2D(wu,oe,Ta,Pr,0),ue.bindTexture(Ta,null),ue.checkFramebufferStatus(wu)!==ms)Jt=!1;else{ue.viewport(0,0,1,1),ue.clearColor(1,0,0,1),ue.clear(Ws);var Vr=an.allocType(Oo,4);ue.readPixels(0,0,1,1,$r,Oo,Vr),ue.getError()?Jt=!1:(ue.deleteFramebuffer(jr),ue.deleteTexture(Pr),Jt=Vr[0]===1),an.freeType(Vr)}}var Yr=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Wr=!0;if(!Yr){var pn=ue.createTexture(),on=an.allocType(mt,36);ue.activeTexture(Xo),ue.bindTexture(Po,pn),ue.texImage2D(Nr,0,$r,3,3,0,$r,mt,on),an.freeType(on),ue.bindTexture(Po,null),ue.deleteTexture(pn),Wr=!ue.getError()}return{colorBits:[ue.getParameter(tr),ue.getParameter(Cn),ue.getParameter(hn),ue.getParameter(xn)],depthBits:ue.getParameter(_i),stencilBits:ue.getParameter(wn),subpixelBits:ue.getParameter(An),extensions:Object.keys(He).filter(function(zr){return!!He[zr]}),maxAnisotropic:Ht,maxDrawbuffers:hr,maxColorAttachments:ar,pointSizeDims:ue.getParameter(Ni),lineWidthDims:ue.getParameter(Ki),maxViewportDims:ue.getParameter(Fn),maxCombinedTextureUnits:ue.getParameter(Ka),maxCubeMapSize:ue.getParameter(to),maxRenderbufferSize:ue.getParameter(ao),maxTextureUnits:ue.getParameter(Ai),maxTextureSize:ue.getParameter(Mi),maxAttributes:ue.getParameter(Ui),maxVertexUniforms:ue.getParameter(zo),maxVertexTextureUnits:ue.getParameter(ri),maxVaryingVectors:ue.getParameter(ia),maxFragmentUniforms:ue.getParameter(xi),glsl:ue.getParameter(Bt),renderer:ue.getParameter(Ct),vendor:ue.getParameter(Ea),version:ue.getParameter(ss),readFloat:Jt,npotTextureCube:Wr}};function xo(K){return!!K&&typeof K=="object"&&Array.isArray(K.shape)&&Array.isArray(K.stride)&&typeof K.offset=="number"&&K.shape.length===K.stride.length&&(Array.isArray(K.data)||G(K.data))}var Ve=function(ue){return Object.keys(ue).map(function(He){return ue[He]})},fe={shape:Oa,flatten:Li};function Ue(K,ue,He){for(var Ht=0;Ht<ue;++Ht)He[Ht]=K[Ht]}function kt(K,ue,He,Ht){for(var hr=0,ar=0;ar<ue;++ar)for(var Jt=K[ar],Pr=0;Pr<He;++Pr)Ht[hr++]=Jt[Pr]}function Gr(K,ue,He,Ht,hr,ar){for(var Jt=ar,Pr=0;Pr<ue;++Pr)for(var jr=K[Pr],Vr=0;Vr<He;++Vr)for(var Yr=jr[Vr],Wr=0;Wr<Ht;++Wr)hr[Jt++]=Yr[Wr]}function In(K,ue,He,Ht,hr){for(var ar=1,Jt=He+1;Jt<ue.length;++Jt)ar*=ue[Jt];var Pr=ue[He];if(ue.length-He==4){var jr=ue[He+1],Vr=ue[He+2],Yr=ue[He+3];for(Jt=0;Jt<Pr;++Jt)Gr(K[Jt],jr,Vr,Yr,Ht,hr),hr+=ar}else for(Jt=0;Jt<Pr;++Jt)In(K[Jt],ue,He+1,Ht,hr),hr+=ar}function Li(K,ue,He,Ht){var hr=1;if(ue.length)for(var ar=0;ar<ue.length;++ar)hr*=ue[ar];else hr=0;var Jt=Ht||an.allocType(He,hr);switch(ue.length){case 0:break;case 1:Ue(K,ue[0],Jt);break;case 2:kt(K,ue[0],ue[1],Jt);break;case 3:Gr(K,ue[0],ue[1],ue[2],Jt,0);break;default:In(K,ue,0,Jt,0)}return Jt}function Oa(K){for(var ue=[],He=K;He.length;He=He[0])ue.push(He.length);return ue}var Sa={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ia=5120,oo=5122,Cl=5124,gs=5121,ho=5123,us=5125,Ts=5126,Ms=5126,Yo={int8:Ia,int16:oo,int32:Cl,uint8:gs,uint16:ho,uint32:us,float:Ts,float32:Ms},au=35048,Ps=35040,Ca={dynamic:au,stream:Ps,static:35044},Va=fe.flatten,lu=fe.shape,Tu=35044,rh=35040,Al=5121,wl=5126,cu=[];cu[5120]=1,cu[5122]=2,cu[5124]=4,cu[5121]=1,cu[5123]=2,cu[5125]=4,cu[5126]=4;function fu(K){return Sa[Object.prototype.toString.call(K)]|0}function _(K,ue){for(var He=0;He<ue.length;++He)K[He]=ue[He]}function O(K,ue,He,Ht,hr,ar,Jt){for(var Pr=0,jr=0;jr<He;++jr)for(var Vr=0;Vr<Ht;++Vr)K[Pr++]=ue[hr*jr+ar*Vr+Jt]}function V(K,ue,He,Ht){var hr=0,ar={};function Jt(Gt){this.id=hr++,this.buffer=K.createBuffer(),this.type=Gt,this.usage=Tu,this.byteLength=0,this.dimension=1,this.dtype=Al,this.persistentData=null,He.profile&&(this.stats={size:0})}Jt.prototype.bind=function(){K.bindBuffer(this.type,this.buffer)},Jt.prototype.destroy=function(){pn(this)};var Pr=[];function jr(Gt,Wt){var Br=Pr.pop();return Br||(Br=new Jt(Gt)),Br.bind(),Wr(Br,Wt,rh,0,1,!1),Br}function Vr(Gt){Pr.push(Gt)}function Yr(Gt,Wt,Br){Gt.byteLength=Wt.byteLength,K.bufferData(Gt.type,Wt,Br)}function Wr(Gt,Wt,Br,Tn,cr,kn){var Mn;if(Gt.usage=Br,Array.isArray(Wt)){if(Gt.dtype=Tn||wl,Wt.length>0){var qr;if(Array.isArray(Wt[0])){Mn=lu(Wt);for(var yr=1,ir=1;ir<Mn.length;++ir)yr*=Mn[ir];Gt.dimension=yr,qr=Va(Wt,Mn,Gt.dtype),Yr(Gt,qr,Br),kn?Gt.persistentData=qr:an.freeType(qr)}else if(typeof Wt[0]=="number"){Gt.dimension=cr;var tn=an.allocType(Gt.dtype,Wt.length);_(tn,Wt),Yr(Gt,tn,Br),kn?Gt.persistentData=tn:an.freeType(tn)}else G(Wt[0])?(Gt.dimension=Wt[0].length,Gt.dtype=Tn||fu(Wt[0])||wl,qr=Va(Wt,[Wt.length,Wt[0].length],Gt.dtype),Yr(Gt,qr,Br),kn?Gt.persistentData=qr:an.freeType(qr)):me.raise("invalid buffer data")}}else if(G(Wt))Gt.dtype=Tn||fu(Wt),Gt.dimension=cr,Yr(Gt,Wt,Br),kn&&(Gt.persistentData=new Uint8Array(new Uint8Array(Wt.buffer)));else if(xo(Wt)){Mn=Wt.shape;var sn=Wt.stride,Zr=Wt.offset,dn=0,fn=0,Ii=0,Si=0;Mn.length===1?(dn=Mn[0],fn=1,Ii=sn[0],Si=0):Mn.length===2?(dn=Mn[0],fn=Mn[1],Ii=sn[0],Si=sn[1]):me.raise("invalid shape"),Gt.dtype=Tn||fu(Wt.data)||wl,Gt.dimension=fn;var gn=an.allocType(Gt.dtype,dn*fn);O(gn,Wt.data,dn,fn,Ii,Si,Zr),Yr(Gt,gn,Br),kn?Gt.persistentData=gn:an.freeType(gn)}else Wt instanceof ArrayBuffer?(Gt.dtype=Al,Gt.dimension=cr,Yr(Gt,Wt,Br),kn&&(Gt.persistentData=new Uint8Array(new Uint8Array(Wt)))):me.raise("invalid buffer data")}function pn(Gt){ue.bufferCount--,Ht(Gt);var Wt=Gt.buffer;me(Wt,"buffer must not be deleted already"),K.deleteBuffer(Wt),Gt.buffer=null,delete ar[Gt.id]}function on(Gt,Wt,Br,Tn){ue.bufferCount++;var cr=new Jt(Wt);ar[cr.id]=cr;function kn(yr){var ir=Tu,tn=null,sn=0,Zr=0,dn=1;return Array.isArray(yr)||G(yr)||xo(yr)||yr instanceof ArrayBuffer?tn=yr:typeof yr=="number"?sn=yr|0:yr&&(me.type(yr,"object","buffer arguments must be an object, a number or an array"),"data"in yr&&(me(tn===null||Array.isArray(tn)||G(tn)||xo(tn),"invalid data for buffer"),tn=yr.data),"usage"in yr&&(me.parameter(yr.usage,Ca,"invalid buffer usage"),ir=Ca[yr.usage]),"type"in yr&&(me.parameter(yr.type,Yo,"invalid buffer type"),Zr=Yo[yr.type]),"dimension"in yr&&(me.type(yr.dimension,"number","invalid dimension"),dn=yr.dimension|0),"length"in yr&&(me.nni(sn,"buffer length must be a nonnegative integer"),sn=yr.length|0)),cr.bind(),tn?Wr(cr,tn,ir,Zr,dn,Tn):(sn&&K.bufferData(cr.type,sn,ir),cr.dtype=Zr||Al,cr.usage=ir,cr.dimension=dn,cr.byteLength=sn),He.profile&&(cr.stats.size=cr.byteLength*cu[cr.dtype]),kn}function Mn(yr,ir){me(ir+yr.byteLength<=cr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+yr.byteLength+" starting from offset "+ir+" to a buffer of size "+cr.byteLength),K.bufferSubData(cr.type,ir,yr)}function qr(yr,ir){var tn=(ir||0)|0,sn;if(cr.bind(),G(yr)||yr instanceof ArrayBuffer)Mn(yr,tn);else if(Array.isArray(yr)){if(yr.length>0)if(typeof yr[0]=="number"){var Zr=an.allocType(cr.dtype,yr.length);_(Zr,yr),Mn(Zr,tn),an.freeType(Zr)}else if(Array.isArray(yr[0])||G(yr[0])){sn=lu(yr);var dn=Va(yr,sn,cr.dtype);Mn(dn,tn),an.freeType(dn)}else me.raise("invalid buffer data")}else if(xo(yr)){sn=yr.shape;var fn=yr.stride,Ii=0,Si=0,gn=0,bn=0;sn.length===1?(Ii=sn[0],Si=1,gn=fn[0],bn=0):sn.length===2?(Ii=sn[0],Si=sn[1],gn=fn[0],bn=fn[1]):me.raise("invalid shape");var fi=Array.isArray(yr.data)?cr.dtype:fu(yr.data),wi=an.allocType(fi,Ii*Si);O(wi,yr.data,Ii,Si,gn,bn,yr.offset),Mn(wi,tn),an.freeType(wi)}else me.raise("invalid data for buffer subdata");return kn}return Br||kn(Gt),kn._reglType="buffer",kn._buffer=cr,kn.subdata=qr,He.profile&&(kn.stats=cr.stats),kn.destroy=function(){pn(cr)},kn}function zr(){Ve(ar).forEach(function(Gt){Gt.buffer=K.createBuffer(),K.bindBuffer(Gt.type,Gt.buffer),K.bufferData(Gt.type,Gt.persistentData||Gt.byteLength,Gt.usage)})}return He.profile&&(ue.getTotalBufferSize=function(){var Gt=0;return Object.keys(ar).forEach(function(Wt){Gt+=ar[Wt].stats.size}),Gt}),{create:on,createStream:jr,destroyStream:Vr,clear:function(){Ve(ar).forEach(pn),Pr.forEach(pn)},getBuffer:function(Wt){return Wt&&Wt._buffer instanceof Jt?Wt._buffer:null},restore:zr,_initBuffer:Wr}}var L=0,ne=0,Te=1,Je=1,pt=4,Tt=4,wr={points:L,point:ne,lines:Te,line:Je,triangles:pt,triangle:Tt,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Fr=0,Wn=1,Ci=4,di=5120,aa=5121,sa=5122,pa=5123,ou=5124,ys=5125,ea=34963,_s=35040,ic=35044;function Tl(K,ue,He,Ht){var hr={},ar=0,Jt={uint8:aa,uint16:pa};ue.oes_element_index_uint&&(Jt.uint32=ys);function Pr(zr){this.id=ar++,hr[this.id]=this,this.buffer=zr,this.primType=Ci,this.vertCount=0,this.type=0}Pr.prototype.bind=function(){this.buffer.bind()};var jr=[];function Vr(zr){var Gt=jr.pop();return Gt||(Gt=new Pr(He.create(null,ea,!0,!1)._buffer)),Wr(Gt,zr,_s,-1,-1,0,0),Gt}function Yr(zr){jr.push(zr)}function Wr(zr,Gt,Wt,Br,Tn,cr,kn){zr.buffer.bind();var Mn;if(Gt){var qr=kn;!kn&&(!G(Gt)||xo(Gt)&&!G(Gt.data))&&(qr=ue.oes_element_index_uint?ys:pa),He._initBuffer(zr.buffer,Gt,Wt,qr,3)}else K.bufferData(ea,cr,Wt),zr.buffer.dtype=Mn||aa,zr.buffer.usage=Wt,zr.buffer.dimension=3,zr.buffer.byteLength=cr;if(Mn=kn,!kn){switch(zr.buffer.dtype){case aa:case di:Mn=aa;break;case pa:case sa:Mn=pa;break;case ys:case ou:Mn=ys;break;default:me.raise("unsupported type for element array")}zr.buffer.dtype=Mn}zr.type=Mn,me(Mn!==ys||!!ue.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var yr=Tn;yr<0&&(yr=zr.buffer.byteLength,Mn===pa?yr>>=1:Mn===ys&&(yr>>=2)),zr.vertCount=yr;var ir=Br;if(Br<0){ir=Ci;var tn=zr.buffer.dimension;tn===1&&(ir=Fr),tn===2&&(ir=Wn),tn===3&&(ir=Ci)}zr.primType=ir}function pn(zr){Ht.elementsCount--,me(zr.buffer!==null,"must not double destroy elements"),delete hr[zr.id],zr.buffer.destroy(),zr.buffer=null}function on(zr,Gt){var Wt=He.create(null,ea,!0),Br=new Pr(Wt._buffer);Ht.elementsCount++;function Tn(cr){if(!cr)Wt(),Br.primType=Ci,Br.vertCount=0,Br.type=aa;else if(typeof cr=="number")Wt(cr),Br.primType=Ci,Br.vertCount=cr|0,Br.type=aa;else{var kn=null,Mn=ic,qr=-1,yr=-1,ir=0,tn=0;Array.isArray(cr)||G(cr)||xo(cr)?kn=cr:(me.type(cr,"object","invalid arguments for elements"),"data"in cr&&(kn=cr.data,me(Array.isArray(kn)||G(kn)||xo(kn),"invalid data for element buffer")),"usage"in cr&&(me.parameter(cr.usage,Ca,"invalid element buffer usage"),Mn=Ca[cr.usage]),"primitive"in cr&&(me.parameter(cr.primitive,wr,"invalid element buffer primitive"),qr=wr[cr.primitive]),"count"in cr&&(me(typeof cr.count=="number"&&cr.count>=0,"invalid vertex count for elements"),yr=cr.count|0),"type"in cr&&(me.parameter(cr.type,Jt,"invalid buffer type"),tn=Jt[cr.type]),"length"in cr?ir=cr.length|0:(ir=yr,tn===pa||tn===sa?ir*=2:(tn===ys||tn===ou)&&(ir*=4))),Wr(Br,kn,Mn,qr,yr,ir,tn)}return Tn}return Tn(zr),Tn._reglType="elements",Tn._elements=Br,Tn.subdata=function(cr,kn){return Wt.subdata(cr,kn),Tn},Tn.destroy=function(){pn(Br)},Tn}return{create:on,createStream:Vr,destroyStream:Yr,getElements:function(Gt){return typeof Gt=="function"&&Gt._elements instanceof Pr?Gt._elements:null},clear:function(){Ve(hr).forEach(pn)}}}var jl=new Float32Array(1),Dc=new Uint32Array(jl.buffer),_f=5123;function hu(K){for(var ue=an.allocType(_f,K.length),He=0;He<K.length;++He)if(isNaN(K[He]))ue[He]=65535;else if(K[He]===Infinity)ue[He]=31744;else if(K[He]===-Infinity)ue[He]=64512;else{jl[0]=K[He];var Ht=Dc[0],hr=Ht>>>31<<15,ar=(Ht<<1>>>24)-127,Jt=Ht>>13&(1<<10)-1;if(ar<-24)ue[He]=hr;else if(ar<-14){var Pr=-14-ar;ue[He]=hr+(Jt+(1<<10)>>Pr)}else ar>15?ue[He]=hr+31744:ue[He]=hr+(ar+15<<10)+Jt}return ue}function Ji(K){return Array.isArray(K)||G(K)}var Mu=function(ue){return!(ue&ue-1)&&!!ue},xf=34467,po=3553,Fc=34067,Pu=34069,Ml=6408,al=6406,Wu=6407,Vl=6409,ol=6410,Ra=32854,ac=32855,Dh=36194,oc=32819,Fh=32820,mp=33635,Bh=34042,sc=6402,sl=34041,ul=35904,Gl=35906,Zu=36193,Hl=33776,bf=33777,Wl=33778,so=33779,nh=35986,ih=35987,ah=34798,Xu=35840,Pl=35841,Bc=35842,oh=35843,Ef=36196,Nc=5121,zc=5123,Uc=5125,uc=5126,Nh=10242,jc=10243,sh=10497,Vc=33071,uh=33648,Gc=10240,lc=10241,ll=9728,Wa=9729,cc=9984,Yu=9985,Ol=9986,ta=9987,Ga=33170,Os=4352,Hc=4353,Wc=4354,Zl=34046,fd=3317,hd=37440,Sf=37441,Zc=37443,Ku=37444,Pi=33984,Xc=[cc,Ol,Yu,ta],Kn=[0,Vl,ol,Wu,Ml],_a={};_a[Vl]=_a[al]=_a[sc]=1,_a[sl]=_a[ol]=2,_a[Wu]=_a[ul]=3,_a[Ml]=_a[Gl]=4;function Ln(K){return"[object "+K+"]"}var Zs=Ln("HTMLCanvasElement"),Xl=Ln("OffscreenCanvas"),Il=Ln("CanvasRenderingContext2D"),pu=Ln("ImageBitmap"),Xs=Ln("HTMLImageElement"),Cf=Ln("HTMLVideoElement"),mn=Object.keys(Sa).concat([Zs,Xl,Il,pu,Xs,Cf]),Rl=[];Rl[Nc]=1,Rl[uc]=4,Rl[Zu]=2,Rl[zc]=2,Rl[Uc]=4;var bo=[];bo[Ra]=2,bo[ac]=2,bo[Dh]=2,bo[sl]=4,bo[Hl]=.5,bo[bf]=.5,bo[Wl]=1,bo[so]=1,bo[nh]=.5,bo[ih]=1,bo[ah]=1,bo[Xu]=.5,bo[Pl]=.25,bo[Bc]=.5,bo[oh]=.25,bo[Ef]=.5;function fc(K){return Array.isArray(K)&&(K.length===0||typeof K[0]=="number")}function Is(K){if(!Array.isArray(K))return!1;var ue=K.length;return!(ue===0||!Ji(K[0]))}function Uo(K){return Object.prototype.toString.call(K)}function Yc(K){return Uo(K)===Zs}function Kc(K){return Uo(K)===Xl}function qs(K){return Uo(K)===Il}function cl(K){return Uo(K)===pu}function lh(K){return Uo(K)===Xs}function $c(K){return Uo(K)===Cf}function qc(K){var ue=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(ue&&K&&K.getContext)}function Af(K){var ue=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(ue&&K&&"src"in K&&"crossOrigin"in K)}function su(K){if(!K)return!1;if(qc(K)||Af(K))return!0;var ue=Uo(K);return mn.indexOf(ue)>=0?!0:fc(K)||Is(K)||xo(K)}function Qs(K){return Sa[Object.prototype.toString.call(K)]|0}function Wi(K,ue){var He=ue.length;switch(K.type){case Nc:case zc:case Uc:case uc:var Ht=an.allocType(K.type,He);Ht.set(ue),K.data=Ht;break;case Zu:K.data=hu(ue);break;default:me.raise("unsupported texture type, must specify a typed array")}}function du(K,ue){return an.allocType(K.type===Zu?uc:K.type,ue)}function vu(K,ue){K.type===Zu?(K.data=hu(ue),an.freeType(ue)):K.data=ue}function ls(K,ue,He,Ht,hr,ar){for(var Jt=K.width,Pr=K.height,jr=K.channels,Vr=Jt*Pr*jr,Yr=du(K,Vr),Wr=0,pn=0;pn<Pr;++pn)for(var on=0;on<Jt;++on)for(var zr=0;zr<jr;++zr)Yr[Wr++]=ue[He*on+Ht*pn+hr*zr+ar];vu(K,Yr)}function fl(K,ue,He,Ht,hr,ar){var Jt;if(typeof bo[K]!="undefined"?Jt=bo[K]:Jt=_a[K]*Rl[ue],ar&&(Jt*=6),hr){for(var Pr=0,jr=He;jr>=1;)Pr+=Jt*jr*jr,jr/=2;return Pr}else return Jt*He*Ht}function kl(K,ue,He,Ht,hr,ar,Jt){var Pr={"don't care":Os,"dont care":Os,nice:Wc,fast:Hc},jr={repeat:sh,clamp:Vc,mirror:uh},Vr={nearest:ll,linear:Wa},Yr=H({mipmap:ta,"nearest mipmap nearest":cc,"linear mipmap nearest":Yu,"nearest mipmap linear":Ol,"linear mipmap linear":ta},Vr),Wr={none:0,browser:Ku},pn={uint8:Nc,rgba4:oc,rgb565:mp,"rgb5 a1":Fh},on={alpha:al,luminance:Vl,"luminance alpha":ol,rgb:Wu,rgba:Ml,rgba4:Ra,"rgb5 a1":ac,rgb565:Dh},zr={};ue.ext_srgb&&(on.srgb=ul,on.srgba=Gl),ue.oes_texture_float&&(pn.float32=pn.float=uc),ue.oes_texture_half_float&&(pn.float16=pn["half float"]=Zu),ue.webgl_depth_texture&&(H(on,{depth:sc,"depth stencil":sl}),H(pn,{uint16:zc,uint32:Uc,"depth stencil":Bh})),ue.webgl_compressed_texture_s3tc&&H(zr,{"rgb s3tc dxt1":Hl,"rgba s3tc dxt1":bf,"rgba s3tc dxt3":Wl,"rgba s3tc dxt5":so}),ue.webgl_compressed_texture_atc&&H(zr,{"rgb atc":nh,"rgba atc explicit alpha":ih,"rgba atc interpolated alpha":ah}),ue.webgl_compressed_texture_pvrtc&&H(zr,{"rgb pvrtc 4bppv1":Xu,"rgb pvrtc 2bppv1":Pl,"rgba pvrtc 4bppv1":Bc,"rgba pvrtc 2bppv1":oh}),ue.webgl_compressed_texture_etc1&&(zr["rgb etc1"]=Ef);var Gt=Array.prototype.slice.call(K.getParameter(xf)||new Uint32Array(0));Object.keys(zr).forEach(function(Fe){var er=zr[Fe];Gt.indexOf(er)>=0&&(on[Fe]=er)});var Wt=Object.keys(on);He.textureFormats=Wt;var Br=[];Object.keys(on).forEach(function(Fe){var er=on[Fe];Br[er]=Fe});var Tn=[];Object.keys(pn).forEach(function(Fe){var er=pn[Fe];Tn[er]=Fe});var cr=[];Object.keys(Vr).forEach(function(Fe){var er=Vr[Fe];cr[er]=Fe});var kn=[];Object.keys(Yr).forEach(function(Fe){var er=Yr[Fe];kn[er]=Fe});var Mn=[];Object.keys(jr).forEach(function(Fe){var er=jr[Fe];Mn[er]=Fe});var qr=Wt.reduce(function(Fe,er){var Lt=on[er];return Lt===Vl||Lt===al||Lt===Vl||Lt===ol||Lt===sc||Lt===sl||ue.ext_srgb&&(Lt===ul||Lt===Gl)?Fe[Lt]=Lt:Lt===ac||er.indexOf("rgba")>=0?Fe[Lt]=Ml:Fe[Lt]=Wu,Fe},{});function yr(){this.internalformat=Ml,this.format=Ml,this.type=Nc,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Ku,this.width=0,this.height=0,this.channels=0}function ir(Fe,er){Fe.internalformat=er.internalformat,Fe.format=er.format,Fe.type=er.type,Fe.compressed=er.compressed,Fe.premultiplyAlpha=er.premultiplyAlpha,Fe.flipY=er.flipY,Fe.unpackAlignment=er.unpackAlignment,Fe.colorSpace=er.colorSpace,Fe.width=er.width,Fe.height=er.height,Fe.channels=er.channels}function tn(Fe,er){if(!(typeof er!="object"||!er)){if("premultiplyAlpha"in er&&(me.type(er.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Fe.premultiplyAlpha=er.premultiplyAlpha),"flipY"in er&&(me.type(er.flipY,"boolean","invalid texture flip"),Fe.flipY=er.flipY),"alignment"in er&&(me.oneOf(er.alignment,[1,2,4,8],"invalid texture unpack alignment"),Fe.unpackAlignment=er.alignment),"colorSpace"in er&&(me.parameter(er.colorSpace,Wr,"invalid colorSpace"),Fe.colorSpace=Wr[er.colorSpace]),"type"in er){var Lt=er.type;me(ue.oes_texture_float||!(Lt==="float"||Lt==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),me(ue.oes_texture_half_float||!(Lt==="half float"||Lt==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),me(ue.webgl_depth_texture||!(Lt==="uint16"||Lt==="uint32"||Lt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),me.parameter(Lt,pn,"invalid texture type"),Fe.type=pn[Lt]}var On=Fe.width,Vi=Fe.height,Me=Fe.channels,ge=!1;"shape"in er?(me(Array.isArray(er.shape)&&er.shape.length>=2,"shape must be an array"),On=er.shape[0],Vi=er.shape[1],er.shape.length===3&&(Me=er.shape[2],me(Me>0&&Me<=4,"invalid number of channels"),ge=!0),me(On>=0&&On<=He.maxTextureSize,"invalid width"),me(Vi>=0&&Vi<=He.maxTextureSize,"invalid height")):("radius"in er&&(On=Vi=er.radius,me(On>=0&&On<=He.maxTextureSize,"invalid radius")),"width"in er&&(On=er.width,me(On>=0&&On<=He.maxTextureSize,"invalid width")),"height"in er&&(Vi=er.height,me(Vi>=0&&Vi<=He.maxTextureSize,"invalid height")),"channels"in er&&(Me=er.channels,me(Me>0&&Me<=4,"invalid number of channels"),ge=!0)),Fe.width=On|0,Fe.height=Vi|0,Fe.channels=Me|0;var qe=!1;if("format"in er){var At=er.format;me(ue.webgl_depth_texture||!(At==="depth"||At==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),me.parameter(At,on,"invalid texture format");var Yt=Fe.internalformat=on[At];Fe.format=qr[Yt],At in pn&&("type"in er||(Fe.type=pn[At])),At in zr&&(Fe.compressed=!0),qe=!0}!ge&&qe?Fe.channels=_a[Fe.format]:ge&&!qe?Fe.channels!==Kn[Fe.format]&&(Fe.format=Fe.internalformat=Kn[Fe.channels]):qe&&ge&&me(Fe.channels===_a[Fe.format],"number of channels inconsistent with specified format")}}function sn(Fe){K.pixelStorei(hd,Fe.flipY),K.pixelStorei(Sf,Fe.premultiplyAlpha),K.pixelStorei(Zc,Fe.colorSpace),K.pixelStorei(fd,Fe.unpackAlignment)}function Zr(){yr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function dn(Fe,er){var Lt=null;if(su(er)?Lt=er:er&&(me.type(er,"object","invalid pixel data type"),tn(Fe,er),"x"in er&&(Fe.xOffset=er.x|0),"y"in er&&(Fe.yOffset=er.y|0),su(er.data)&&(Lt=er.data)),me(!Fe.compressed||Lt instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),er.copy){me(!Lt,"can not specify copy and data field for the same texture");var On=hr.viewportWidth,Vi=hr.viewportHeight;Fe.width=Fe.width||On-Fe.xOffset,Fe.height=Fe.height||Vi-Fe.yOffset,Fe.needsCopy=!0,me(Fe.xOffset>=0&&Fe.xOffset<On&&Fe.yOffset>=0&&Fe.yOffset<Vi&&Fe.width>0&&Fe.width<=On&&Fe.height>0&&Fe.height<=Vi,"copy texture read out of bounds")}else if(!Lt)Fe.width=Fe.width||1,Fe.height=Fe.height||1,Fe.channels=Fe.channels||4;else if(G(Lt))Fe.channels=Fe.channels||4,Fe.data=Lt,!("type"in er)&&Fe.type===Nc&&(Fe.type=Qs(Lt));else if(fc(Lt))Fe.channels=Fe.channels||4,Wi(Fe,Lt),Fe.alignment=1,Fe.needsFree=!0;else if(xo(Lt)){var Me=Lt.data;!Array.isArray(Me)&&Fe.type===Nc&&(Fe.type=Qs(Me));var ge=Lt.shape,qe=Lt.stride,At,Yt,it,Qe,ft,ye;ge.length===3?(it=ge[2],ye=qe[2]):(me(ge.length===2,"invalid ndarray pixel data, must be 2 or 3D"),it=1,ye=1),At=ge[0],Yt=ge[1],Qe=qe[0],ft=qe[1],Fe.alignment=1,Fe.width=At,Fe.height=Yt,Fe.channels=it,Fe.format=Fe.internalformat=Kn[it],Fe.needsFree=!0,ls(Fe,Me,Qe,ft,ye,Lt.offset)}else if(qc(Lt)||Yc(Lt)||Kc(Lt)||qs(Lt))qc(Lt)||Yc(Lt)||Kc(Lt)?Fe.element=Lt:Fe.element=Lt.canvas,Fe.width=Fe.element.width,Fe.height=Fe.element.height,Fe.channels=4;else if(cl(Lt))Fe.element=Lt,Fe.width=Lt.width,Fe.height=Lt.height,Fe.channels=4;else if(lh(Lt))Fe.element=Lt,Fe.width=Lt.naturalWidth,Fe.height=Lt.naturalHeight,Fe.channels=4;else if(Af(Lt))Fe.element=Lt,Fe.width=Lt.width,Fe.height=Lt.height,Fe.channels=4;else if($c(Lt))Fe.element=Lt,Fe.width=Lt.videoWidth,Fe.height=Lt.videoHeight,Fe.channels=4;else if(Is(Lt)){var Ke=Fe.width||Lt[0].length,Pe=Fe.height||Lt.length,bt=Fe.channels;Ji(Lt[0][0])?bt=bt||Lt[0][0].length:bt=bt||1;for(var zt=fe.shape(Lt),Or=1,un=0;un<zt.length;++un)Or*=zt[un];var ln=du(Fe,Or);fe.flatten(Lt,zt,"",ln),vu(Fe,ln),Fe.alignment=1,Fe.width=Ke,Fe.height=Pe,Fe.channels=bt,Fe.format=Fe.internalformat=Kn[bt],Fe.needsFree=!0}Fe.type===uc?me(He.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Fe.type===Zu&&me(He.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function fn(Fe,er,Lt){var On=Fe.element,Vi=Fe.data,Me=Fe.internalformat,ge=Fe.format,qe=Fe.type,At=Fe.width,Yt=Fe.height;sn(Fe),On?K.texImage2D(er,Lt,ge,ge,qe,On):Fe.compressed?K.compressedTexImage2D(er,Lt,Me,At,Yt,0,Vi):Fe.needsCopy?(Ht(),K.copyTexImage2D(er,Lt,ge,Fe.xOffset,Fe.yOffset,At,Yt,0)):K.texImage2D(er,Lt,ge,At,Yt,0,ge,qe,Vi||null)}function Ii(Fe,er,Lt,On,Vi){var Me=Fe.element,ge=Fe.data,qe=Fe.internalformat,At=Fe.format,Yt=Fe.type,it=Fe.width,Qe=Fe.height;sn(Fe),Me?K.texSubImage2D(er,Vi,Lt,On,At,Yt,Me):Fe.compressed?K.compressedTexSubImage2D(er,Vi,Lt,On,qe,it,Qe,ge):Fe.needsCopy?(Ht(),K.copyTexSubImage2D(er,Vi,Lt,On,Fe.xOffset,Fe.yOffset,it,Qe)):K.texSubImage2D(er,Vi,Lt,On,it,Qe,At,Yt,ge)}var Si=[];function gn(){return Si.pop()||new Zr}function bn(Fe){Fe.needsFree&&an.freeType(Fe.data),Zr.call(Fe),Si.push(Fe)}function fi(){yr.call(this),this.genMipmaps=!1,this.mipmapHint=Os,this.mipmask=0,this.images=Array(16)}function wi(Fe,er,Lt){var On=Fe.images[0]=gn();Fe.mipmask=1,On.width=Fe.width=er,On.height=Fe.height=Lt,On.channels=Fe.channels=4}function qi(Fe,er){var Lt=null;if(su(er))Lt=Fe.images[0]=gn(),ir(Lt,Fe),dn(Lt,er),Fe.mipmask=1;else if(tn(Fe,er),Array.isArray(er.mipmap))for(var On=er.mipmap,Vi=0;Vi<On.length;++Vi)Lt=Fe.images[Vi]=gn(),ir(Lt,Fe),Lt.width>>=Vi,Lt.height>>=Vi,dn(Lt,On[Vi]),Fe.mipmask|=1<<Vi;else Lt=Fe.images[0]=gn(),ir(Lt,Fe),dn(Lt,er),Fe.mipmask=1;ir(Fe,Fe.images[0]),Fe.compressed&&(Fe.internalformat===Hl||Fe.internalformat===bf||Fe.internalformat===Wl||Fe.internalformat===so)&&me(Fe.width%4==0&&Fe.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function $a(Fe,er){for(var Lt=Fe.images,On=0;On<Lt.length;++On){if(!Lt[On])return;fn(Lt[On],er,On)}}var yo=[];function Qi(){var Fe=yo.pop()||new fi;yr.call(Fe),Fe.mipmask=0;for(var er=0;er<16;++er)Fe.images[er]=null;return Fe}function es(Fe){for(var er=Fe.images,Lt=0;Lt<er.length;++Lt)er[Lt]&&bn(er[Lt]),er[Lt]=null;yo.push(Fe)}function Ha(){this.minFilter=ll,this.magFilter=ll,this.wrapS=Vc,this.wrapT=Vc,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Os}function Ho(Fe,er){if("min"in er){var Lt=er.min;me.parameter(Lt,Yr),Fe.minFilter=Yr[Lt],Xc.indexOf(Fe.minFilter)>=0&&!("faces"in er)&&(Fe.genMipmaps=!0)}if("mag"in er){var On=er.mag;me.parameter(On,Vr),Fe.magFilter=Vr[On]}var Vi=Fe.wrapS,Me=Fe.wrapT;if("wrap"in er){var ge=er.wrap;typeof ge=="string"?(me.parameter(ge,jr),Vi=Me=jr[ge]):Array.isArray(ge)&&(me.parameter(ge[0],jr),me.parameter(ge[1],jr),Vi=jr[ge[0]],Me=jr[ge[1]])}else{if("wrapS"in er){var qe=er.wrapS;me.parameter(qe,jr),Vi=jr[qe]}if("wrapT"in er){var At=er.wrapT;me.parameter(At,jr),Me=jr[At]}}if(Fe.wrapS=Vi,Fe.wrapT=Me,"anisotropic"in er){var Yt=er.anisotropic;me(typeof Yt=="number"&&Yt>=1&&Yt<=He.maxAnisotropic,"aniso samples must be between 1 and "),Fe.anisotropic=er.anisotropic}if("mipmap"in er){var it=!1;switch(typeof er.mipmap){case"string":me.parameter(er.mipmap,Pr,"invalid mipmap hint"),Fe.mipmapHint=Pr[er.mipmap],Fe.genMipmaps=!0,it=!0;break;case"boolean":it=Fe.genMipmaps=er.mipmap;break;case"object":me(Array.isArray(er.mipmap),"invalid mipmap type"),Fe.genMipmaps=!1,it=!0;break;default:me.raise("invalid mipmap type")}it&&!("min"in er)&&(Fe.minFilter=cc)}}function Lo(Fe,er){K.texParameteri(er,lc,Fe.minFilter),K.texParameteri(er,Gc,Fe.magFilter),K.texParameteri(er,Nh,Fe.wrapS),K.texParameteri(er,jc,Fe.wrapT),ue.ext_texture_filter_anisotropic&&K.texParameteri(er,Zl,Fe.anisotropic),Fe.genMipmaps&&(K.hint(Ga,Fe.mipmapHint),K.generateMipmap(er))}var cs=0,fs={},hs=He.maxTextureUnits,io=Array(hs).map(function(){return null});function zi(Fe){yr.call(this),this.mipmask=0,this.internalformat=Ml,this.id=cs++,this.refCount=1,this.target=Fe,this.texture=K.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ha,Jt.profile&&(this.stats={size:0})}function Wo(Fe){K.activeTexture(Pi),K.bindTexture(Fe.target,Fe.texture)}function da(){var Fe=io[0];Fe?K.bindTexture(Fe.target,Fe.texture):K.bindTexture(po,null)}function Do(Fe){var er=Fe.texture;me(er,"must not double destroy texture");var Lt=Fe.unit,On=Fe.target;Lt>=0&&(K.activeTexture(Pi+Lt),K.bindTexture(On,null),io[Lt]=null),K.deleteTexture(er),Fe.texture=null,Fe.params=null,Fe.pixels=null,Fe.refCount=0,delete fs[Fe.id],ar.textureCount--}H(zi.prototype,{bind:function(){var er=this;er.bindCount+=1;var Lt=er.unit;if(Lt<0){for(var On=0;On<hs;++On){var Vi=io[On];if(Vi){if(Vi.bindCount>0)continue;Vi.unit=-1}io[On]=er,Lt=On;break}Lt>=hs&&me.raise("insufficient number of texture units"),Jt.profile&&ar.maxTextureUnits<Lt+1&&(ar.maxTextureUnits=Lt+1),er.unit=Lt,K.activeTexture(Pi+Lt),K.bindTexture(er.target,er.texture)}return Lt},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Do(this)}});function vi(Fe,er){var Lt=new zi(po);fs[Lt.id]=Lt,ar.textureCount++;function On(ge,qe){var At=Lt.texInfo;Ha.call(At);var Yt=Qi();return typeof ge=="number"?typeof qe=="number"?wi(Yt,ge|0,qe|0):wi(Yt,ge|0,ge|0):ge?(me.type(ge,"object","invalid arguments to regl.texture"),Ho(At,ge),qi(Yt,ge)):wi(Yt,1,1),At.genMipmaps&&(Yt.mipmask=(Yt.width<<1)-1),Lt.mipmask=Yt.mipmask,ir(Lt,Yt),me.texture2D(At,Yt,He),Lt.internalformat=Yt.internalformat,On.width=Yt.width,On.height=Yt.height,Wo(Lt),$a(Yt,po),Lo(At,po),da(),es(Yt),Jt.profile&&(Lt.stats.size=fl(Lt.internalformat,Lt.type,Yt.width,Yt.height,At.genMipmaps,!1)),On.format=Br[Lt.internalformat],On.type=Tn[Lt.type],On.mag=cr[At.magFilter],On.min=kn[At.minFilter],On.wrapS=Mn[At.wrapS],On.wrapT=Mn[At.wrapT],On}function Vi(ge,qe,At,Yt){me(!!ge,"must specify image data");var it=qe|0,Qe=At|0,ft=Yt|0,ye=gn();return ir(ye,Lt),ye.width=0,ye.height=0,dn(ye,ge),ye.width=ye.width||(Lt.width>>ft)-it,ye.height=ye.height||(Lt.height>>ft)-Qe,me(Lt.type===ye.type&&Lt.format===ye.format&&Lt.internalformat===ye.internalformat,"incompatible format for texture.subimage"),me(it>=0&&Qe>=0&&it+ye.width<=Lt.width&&Qe+ye.height<=Lt.height,"texture.subimage write out of bounds"),me(Lt.mipmask&1<<ft,"missing mipmap data"),me(ye.data||ye.element||ye.needsCopy,"missing image data"),Wo(Lt),Ii(ye,po,it,Qe,ft),da(),bn(ye),On}function Me(ge,qe){var At=ge|0,Yt=qe|0||At;if(At===Lt.width&&Yt===Lt.height)return On;On.width=Lt.width=At,On.height=Lt.height=Yt,Wo(Lt);for(var it=0;Lt.mipmask>>it;++it){var Qe=At>>it,ft=Yt>>it;if(!Qe||!ft)break;K.texImage2D(po,it,Lt.format,Qe,ft,0,Lt.format,Lt.type,null)}return da(),Jt.profile&&(Lt.stats.size=fl(Lt.internalformat,Lt.type,At,Yt,!1,!1)),On}return On(Fe,er),On.subimage=Vi,On.resize=Me,On._reglType="texture2d",On._texture=Lt,Jt.profile&&(On.stats=Lt.stats),On.destroy=function(){Lt.decRef()},On}function Fi(Fe,er,Lt,On,Vi,Me){var ge=new zi(Fc);fs[ge.id]=ge,ar.cubeCount++;var qe=new Array(6);function At(Qe,ft,ye,Ke,Pe,bt){var zt,Or=ge.texInfo;for(Ha.call(Or),zt=0;zt<6;++zt)qe[zt]=Qi();if(typeof Qe=="number"||!Qe){var un=Qe|0||1;for(zt=0;zt<6;++zt)wi(qe[zt],un,un)}else if(typeof Qe=="object")if(ft)qi(qe[0],Qe),qi(qe[1],ft),qi(qe[2],ye),qi(qe[3],Ke),qi(qe[4],Pe),qi(qe[5],bt);else if(Ho(Or,Qe),tn(ge,Qe),"faces"in Qe){var ln=Qe.faces;for(me(Array.isArray(ln)&&ln.length===6,"cube faces must be a length 6 array"),zt=0;zt<6;++zt)me(typeof ln[zt]=="object"&&!!ln[zt],"invalid input for cube map face"),ir(qe[zt],ge),qi(qe[zt],ln[zt])}else for(zt=0;zt<6;++zt)qi(qe[zt],Qe);else me.raise("invalid arguments to cube map");for(ir(ge,qe[0]),me.optional(function(){He.npotTextureCube||me(Mu(ge.width)&&Mu(ge.height),"your browser does not support non power or two texture dimensions")}),Or.genMipmaps?ge.mipmask=(qe[0].width<<1)-1:ge.mipmask=qe[0].mipmask,me.textureCube(ge,Or,qe,He),ge.internalformat=qe[0].internalformat,At.width=qe[0].width,At.height=qe[0].height,Wo(ge),zt=0;zt<6;++zt)$a(qe[zt],Pu+zt);for(Lo(Or,Fc),da(),Jt.profile&&(ge.stats.size=fl(ge.internalformat,ge.type,At.width,At.height,Or.genMipmaps,!0)),At.format=Br[ge.internalformat],At.type=Tn[ge.type],At.mag=cr[Or.magFilter],At.min=kn[Or.minFilter],At.wrapS=Mn[Or.wrapS],At.wrapT=Mn[Or.wrapT],zt=0;zt<6;++zt)es(qe[zt]);return At}function Yt(Qe,ft,ye,Ke,Pe){me(!!ft,"must specify image data"),me(typeof Qe=="number"&&Qe===(Qe|0)&&Qe>=0&&Qe<6,"invalid face");var bt=ye|0,zt=Ke|0,Or=Pe|0,un=gn();return ir(un,ge),un.width=0,un.height=0,dn(un,ft),un.width=un.width||(ge.width>>Or)-bt,un.height=un.height||(ge.height>>Or)-zt,me(ge.type===un.type&&ge.format===un.format&&ge.internalformat===un.internalformat,"incompatible format for texture.subimage"),me(bt>=0&&zt>=0&&bt+un.width<=ge.width&&zt+un.height<=ge.height,"texture.subimage write out of bounds"),me(ge.mipmask&1<<Or,"missing mipmap data"),me(un.data||un.element||un.needsCopy,"missing image data"),Wo(ge),Ii(un,Pu+Qe,bt,zt,Or),da(),bn(un),At}function it(Qe){var ft=Qe|0;if(ft!==ge.width){At.width=ge.width=ft,At.height=ge.height=ft,Wo(ge);for(var ye=0;ye<6;++ye)for(var Ke=0;ge.mipmask>>Ke;++Ke)K.texImage2D(Pu+ye,Ke,ge.format,ft>>Ke,ft>>Ke,0,ge.format,ge.type,null);return da(),Jt.profile&&(ge.stats.size=fl(ge.internalformat,ge.type,At.width,At.height,!1,!0)),At}}return At(Fe,er,Lt,On,Vi,Me),At.subimage=Yt,At.resize=it,At._reglType="textureCube",At._texture=ge,Jt.profile&&(At.stats=ge.stats),At.destroy=function(){ge.decRef()},At}function ka(){for(var Fe=0;Fe<hs;++Fe)K.activeTexture(Pi+Fe),K.bindTexture(po,null),io[Fe]=null;Ve(fs).forEach(Do),ar.cubeCount=0,ar.textureCount=0}Jt.profile&&(ar.getTotalTextureSize=function(){var Fe=0;return Object.keys(fs).forEach(function(er){Fe+=fs[er].stats.size}),Fe});function Ns(){for(var Fe=0;Fe<hs;++Fe){var er=io[Fe];er&&(er.bindCount=0,er.unit=-1,io[Fe]=null)}Ve(fs).forEach(function(Lt){Lt.texture=K.createTexture(),K.bindTexture(Lt.target,Lt.texture);for(var On=0;On<32;++On)if((Lt.mipmask&1<<On)!=0)if(Lt.target===po)K.texImage2D(po,On,Lt.internalformat,Lt.width>>On,Lt.height>>On,0,Lt.internalformat,Lt.type,null);else for(var Vi=0;Vi<6;++Vi)K.texImage2D(Pu+Vi,On,Lt.internalformat,Lt.width>>On,Lt.height>>On,0,Lt.internalformat,Lt.type,null);Lo(Lt.texInfo,Lt.target)})}function Ss(){for(var Fe=0;Fe<hs;++Fe){var er=io[Fe];er&&(er.bindCount=0,er.unit=-1,io[Fe]=null),K.activeTexture(Pi+Fe),K.bindTexture(po,null),K.bindTexture(Fc,null)}}return{create2D:vi,createCube:Fi,clear:ka,getTexture:function(er){return null},restore:Ns,refresh:Ss}}var Ko=36161,Eo=32854,hc=32855,ni=36194,Yn=33189,pc=36168,So=34041,Ou=35907,$o=34836,Iu=34842,wf=34843,vo=[];vo[Eo]=2,vo[hc]=2,vo[ni]=2,vo[Yn]=2,vo[pc]=1,vo[So]=4,vo[Ou]=4,vo[$o]=16,vo[Iu]=8,vo[wf]=6;function ga(K,ue,He){return vo[K]*ue*He}var qo=function(ue,He,Ht,hr,ar){var Jt={rgba4:Eo,rgb565:ni,"rgb5 a1":hc,depth:Yn,stencil:pc,"depth stencil":So};He.ext_srgb&&(Jt.srgba=Ou),He.ext_color_buffer_half_float&&(Jt.rgba16f=Iu,Jt.rgb16f=wf),He.webgl_color_buffer_float&&(Jt.rgba32f=$o);var Pr=[];Object.keys(Jt).forEach(function(zr){var Gt=Jt[zr];Pr[Gt]=zr});var jr=0,Vr={};function Yr(zr){this.id=jr++,this.refCount=1,this.renderbuffer=zr,this.format=Eo,this.width=0,this.height=0,ar.profile&&(this.stats={size:0})}Yr.prototype.decRef=function(){--this.refCount<=0&&Wr(this)};function Wr(zr){var Gt=zr.renderbuffer;me(Gt,"must not double destroy renderbuffer"),ue.bindRenderbuffer(Ko,null),ue.deleteRenderbuffer(Gt),zr.renderbuffer=null,zr.refCount=0,delete Vr[zr.id],hr.renderbufferCount--}function pn(zr,Gt){var Wt=new Yr(ue.createRenderbuffer());Vr[Wt.id]=Wt,hr.renderbufferCount++;function Br(cr,kn){var Mn=0,qr=0,yr=Eo;if(typeof cr=="object"&&cr){var ir=cr;if("shape"in ir){var tn=ir.shape;me(Array.isArray(tn)&&tn.length>=2,"invalid renderbuffer shape"),Mn=tn[0]|0,qr=tn[1]|0}else"radius"in ir&&(Mn=qr=ir.radius|0),"width"in ir&&(Mn=ir.width|0),"height"in ir&&(qr=ir.height|0);"format"in ir&&(me.parameter(ir.format,Jt,"invalid renderbuffer format"),yr=Jt[ir.format])}else typeof cr=="number"?(Mn=cr|0,typeof kn=="number"?qr=kn|0:qr=Mn):cr?me.raise("invalid arguments to renderbuffer constructor"):Mn=qr=1;if(me(Mn>0&&qr>0&&Mn<=Ht.maxRenderbufferSize&&qr<=Ht.maxRenderbufferSize,"invalid renderbuffer size"),!(Mn===Wt.width&&qr===Wt.height&&yr===Wt.format))return Br.width=Wt.width=Mn,Br.height=Wt.height=qr,Wt.format=yr,ue.bindRenderbuffer(Ko,Wt.renderbuffer),ue.renderbufferStorage(Ko,yr,Mn,qr),me(ue.getError()===0,"invalid render buffer format"),ar.profile&&(Wt.stats.size=ga(Wt.format,Wt.width,Wt.height)),Br.format=Pr[Wt.format],Br}function Tn(cr,kn){var Mn=cr|0,qr=kn|0||Mn;return Mn===Wt.width&&qr===Wt.height||(me(Mn>0&&qr>0&&Mn<=Ht.maxRenderbufferSize&&qr<=Ht.maxRenderbufferSize,"invalid renderbuffer size"),Br.width=Wt.width=Mn,Br.height=Wt.height=qr,ue.bindRenderbuffer(Ko,Wt.renderbuffer),ue.renderbufferStorage(Ko,Wt.format,Mn,qr),me(ue.getError()===0,"invalid render buffer format"),ar.profile&&(Wt.stats.size=ga(Wt.format,Wt.width,Wt.height))),Br}return Br(zr,Gt),Br.resize=Tn,Br._reglType="renderbuffer",Br._renderbuffer=Wt,ar.profile&&(Br.stats=Wt.stats),Br.destroy=function(){Wt.decRef()},Br}ar.profile&&(hr.getTotalRenderbufferSize=function(){var zr=0;return Object.keys(Vr).forEach(function(Gt){zr+=Vr[Gt].stats.size}),zr});function on(){Ve(Vr).forEach(function(zr){zr.renderbuffer=ue.createRenderbuffer(),ue.bindRenderbuffer(Ko,zr.renderbuffer),ue.renderbufferStorage(Ko,zr.format,zr.width,zr.height)}),ue.bindRenderbuffer(Ko,null)}return{create:pn,clear:function(){Ve(Vr).forEach(Wr)},restore:on}},hl=36160,Ru=36161,$u=3553,mu=34069,Ys=36064,Yl=36096,gu=36128,Tf=33306,Kl=36053,Mf=36054,ch=36055,ku=36057,dc=36061,Qc=36193,pl=5121,yu=5126,dl=6407,_u=6408,xs=6402,$l=[dl,_u],Rs=[];Rs[_u]=4,Rs[dl]=3;var vc=[];vc[pl]=1,vc[yu]=4,vc[Qc]=2;var Pf=32854,p=32855,f=36194,l=33189,v=36168,E=34041,T=35907,I=34836,k=34842,W=34843,q=[Pf,p,f,T,k,W,I],he={};he[Kl]="complete",he[Mf]="incomplete attachment",he[ku]="incomplete dimensions",he[ch]="incomplete, missing attachment",he[dc]="unsupported";function ve(K,ue,He,Ht,hr,ar){var Jt={cur:null,next:null,dirty:!1,setFBO:null},Pr=["rgba"],jr=["rgba4","rgb565","rgb5 a1"];ue.ext_srgb&&jr.push("srgba"),ue.ext_color_buffer_half_float&&jr.push("rgba16f","rgb16f"),ue.webgl_color_buffer_float&&jr.push("rgba32f");var Vr=["uint8"];ue.oes_texture_half_float&&Vr.push("half float","float16"),ue.oes_texture_float&&Vr.push("float","float32");function Yr(Zr,dn,fn){this.target=Zr,this.texture=dn,this.renderbuffer=fn;var Ii=0,Si=0;dn?(Ii=dn.width,Si=dn.height):fn&&(Ii=fn.width,Si=fn.height),this.width=Ii,this.height=Si}function Wr(Zr){Zr&&(Zr.texture&&Zr.texture._texture.decRef(),Zr.renderbuffer&&Zr.renderbuffer._renderbuffer.decRef())}function pn(Zr,dn,fn){if(!!Zr)if(Zr.texture){var Ii=Zr.texture._texture,Si=Math.max(1,Ii.width),gn=Math.max(1,Ii.height);me(Si===dn&&gn===fn,"inconsistent width/height for supplied texture"),Ii.refCount+=1}else{var bn=Zr.renderbuffer._renderbuffer;me(bn.width===dn&&bn.height===fn,"inconsistent width/height for renderbuffer"),bn.refCount+=1}}function on(Zr,dn){dn&&(dn.texture?K.framebufferTexture2D(hl,Zr,dn.target,dn.texture._texture.texture,0):K.framebufferRenderbuffer(hl,Zr,Ru,dn.renderbuffer._renderbuffer.renderbuffer))}function zr(Zr){var dn=$u,fn=null,Ii=null,Si=Zr;typeof Zr=="object"&&(Si=Zr.data,"target"in Zr&&(dn=Zr.target|0)),me.type(Si,"function","invalid attachment data");var gn=Si._reglType;return gn==="texture2d"?(fn=Si,me(dn===$u)):gn==="textureCube"?(fn=Si,me(dn>=mu&&dn<mu+6,"invalid cube map target")):gn==="renderbuffer"?(Ii=Si,dn=Ru):me.raise("invalid regl object for attachment"),new Yr(dn,fn,Ii)}function Gt(Zr,dn,fn,Ii,Si){if(fn){var gn=Ht.create2D({width:Zr,height:dn,format:Ii,type:Si});return gn._texture.refCount=0,new Yr($u,gn,null)}else{var bn=hr.create({width:Zr,height:dn,format:Ii});return bn._renderbuffer.refCount=0,new Yr(Ru,null,bn)}}function Wt(Zr){return Zr&&(Zr.texture||Zr.renderbuffer)}function Br(Zr,dn,fn){Zr&&(Zr.texture?Zr.texture.resize(dn,fn):Zr.renderbuffer&&Zr.renderbuffer.resize(dn,fn),Zr.width=dn,Zr.height=fn)}var Tn=0,cr={};function kn(){this.id=Tn++,cr[this.id]=this,this.framebuffer=K.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Mn(Zr){Zr.colorAttachments.forEach(Wr),Wr(Zr.depthAttachment),Wr(Zr.stencilAttachment),Wr(Zr.depthStencilAttachment)}function qr(Zr){var dn=Zr.framebuffer;me(dn,"must not double destroy framebuffer"),K.deleteFramebuffer(dn),Zr.framebuffer=null,ar.framebufferCount--,delete cr[Zr.id]}function yr(Zr){var dn;K.bindFramebuffer(hl,Zr.framebuffer);var fn=Zr.colorAttachments;for(dn=0;dn<fn.length;++dn)on(Ys+dn,fn[dn]);for(dn=fn.length;dn<He.maxColorAttachments;++dn)K.framebufferTexture2D(hl,Ys+dn,$u,null,0);K.framebufferTexture2D(hl,Tf,$u,null,0),K.framebufferTexture2D(hl,Yl,$u,null,0),K.framebufferTexture2D(hl,gu,$u,null,0),on(Yl,Zr.depthAttachment),on(gu,Zr.stencilAttachment),on(Tf,Zr.depthStencilAttachment);var Ii=K.checkFramebufferStatus(hl);!K.isContextLost()&&Ii!==Kl&&me.raise("framebuffer configuration not supported, status = "+he[Ii]),K.bindFramebuffer(hl,Jt.next?Jt.next.framebuffer:null),Jt.cur=Jt.next,K.getError()}function ir(Zr,dn){var fn=new kn;ar.framebufferCount++;function Ii(gn,bn){var fi;me(Jt.next!==fn,"can not update framebuffer which is currently in use");var wi=0,qi=0,$a=!0,yo=!0,Qi=null,es=!0,Ha="rgba",Ho="uint8",Lo=1,cs=null,fs=null,hs=null,io=!1;if(typeof gn=="number")wi=gn|0,qi=bn|0||wi;else if(!gn)wi=qi=1;else{me.type(gn,"object","invalid arguments for framebuffer");var zi=gn;if("shape"in zi){var Wo=zi.shape;me(Array.isArray(Wo)&&Wo.length>=2,"invalid shape for framebuffer"),wi=Wo[0],qi=Wo[1]}else"radius"in zi&&(wi=qi=zi.radius),"width"in zi&&(wi=zi.width),"height"in zi&&(qi=zi.height);("color"in zi||"colors"in zi)&&(Qi=zi.color||zi.colors,Array.isArray(Qi)&&me(Qi.length===1||ue.webgl_draw_buffers,"multiple render targets not supported")),Qi||("colorCount"in zi&&(Lo=zi.colorCount|0,me(Lo>0,"invalid color buffer count")),"colorTexture"in zi&&(es=!!zi.colorTexture,Ha="rgba4"),"colorType"in zi&&(Ho=zi.colorType,es?(me(ue.oes_texture_float||!(Ho==="float"||Ho==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),me(ue.oes_texture_half_float||!(Ho==="half float"||Ho==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Ho==="half float"||Ho==="float16"?(me(ue.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ha="rgba16f"):(Ho==="float"||Ho==="float32")&&(me(ue.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ha="rgba32f"),me.oneOf(Ho,Vr,"invalid color type")),"colorFormat"in zi&&(Ha=zi.colorFormat,Pr.indexOf(Ha)>=0?es=!0:jr.indexOf(Ha)>=0?es=!1:me.optional(function(){es?me.oneOf(zi.colorFormat,Pr,"invalid color format for texture"):me.oneOf(zi.colorFormat,jr,"invalid color format for renderbuffer")}))),("depthTexture"in zi||"depthStencilTexture"in zi)&&(io=!!(zi.depthTexture||zi.depthStencilTexture),me(!io||ue.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in zi&&(typeof zi.depth=="boolean"?$a=zi.depth:(cs=zi.depth,yo=!1)),"stencil"in zi&&(typeof zi.stencil=="boolean"?yo=zi.stencil:(fs=zi.stencil,$a=!1)),"depthStencil"in zi&&(typeof zi.depthStencil=="boolean"?$a=yo=zi.depthStencil:(hs=zi.depthStencil,$a=!1,yo=!1))}var da=null,Do=null,vi=null,Fi=null;if(Array.isArray(Qi))da=Qi.map(zr);else if(Qi)da=[zr(Qi)];else for(da=new Array(Lo),fi=0;fi<Lo;++fi)da[fi]=Gt(wi,qi,es,Ha,Ho);me(ue.webgl_draw_buffers||da.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),me(da.length<=He.maxColorAttachments,"too many color attachments, not supported"),wi=wi||da[0].width,qi=qi||da[0].height,cs?Do=zr(cs):$a&&!yo&&(Do=Gt(wi,qi,io,"depth","uint32")),fs?vi=zr(fs):yo&&!$a&&(vi=Gt(wi,qi,!1,"stencil","uint8")),hs?Fi=zr(hs):!cs&&!fs&&yo&&$a&&(Fi=Gt(wi,qi,io,"depth stencil","depth stencil")),me(!!cs+!!fs+!!hs<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var ka=null;for(fi=0;fi<da.length;++fi)if(pn(da[fi],wi,qi),me(!da[fi]||da[fi].texture&&$l.indexOf(da[fi].texture._texture.format)>=0||da[fi].renderbuffer&&q.indexOf(da[fi].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+fi+" is invalid"),da[fi]&&da[fi].texture){var Ns=Rs[da[fi].texture._texture.format]*vc[da[fi].texture._texture.type];ka===null?ka=Ns:me(ka===Ns,"all color attachments much have the same number of bits per pixel.")}return pn(Do,wi,qi),me(!Do||Do.texture&&Do.texture._texture.format===xs||Do.renderbuffer&&Do.renderbuffer._renderbuffer.format===l,"invalid depth attachment for framebuffer object"),pn(vi,wi,qi),me(!vi||vi.renderbuffer&&vi.renderbuffer._renderbuffer.format===v,"invalid stencil attachment for framebuffer object"),pn(Fi,wi,qi),me(!Fi||Fi.texture&&Fi.texture._texture.format===E||Fi.renderbuffer&&Fi.renderbuffer._renderbuffer.format===E,"invalid depth-stencil attachment for framebuffer object"),Mn(fn),fn.width=wi,fn.height=qi,fn.colorAttachments=da,fn.depthAttachment=Do,fn.stencilAttachment=vi,fn.depthStencilAttachment=Fi,Ii.color=da.map(Wt),Ii.depth=Wt(Do),Ii.stencil=Wt(vi),Ii.depthStencil=Wt(Fi),Ii.width=fn.width,Ii.height=fn.height,yr(fn),Ii}function Si(gn,bn){me(Jt.next!==fn,"can not resize a framebuffer which is currently in use");var fi=Math.max(gn|0,1),wi=Math.max(bn|0||fi,1);if(fi===fn.width&&wi===fn.height)return Ii;for(var qi=fn.colorAttachments,$a=0;$a<qi.length;++$a)Br(qi[$a],fi,wi);return Br(fn.depthAttachment,fi,wi),Br(fn.stencilAttachment,fi,wi),Br(fn.depthStencilAttachment,fi,wi),fn.width=Ii.width=fi,fn.height=Ii.height=wi,yr(fn),Ii}return Ii(Zr,dn),H(Ii,{resize:Si,_reglType:"framebuffer",_framebuffer:fn,destroy:function(){qr(fn),Mn(fn)},use:function(bn){Jt.setFBO({framebuffer:Ii},bn)}})}function tn(Zr){var dn=Array(6);function fn(Si){var gn;me(dn.indexOf(Jt.next)<0,"can not update framebuffer which is currently in use");var bn={color:null},fi=0,wi=null,qi="rgba",$a="uint8",yo=1;if(typeof Si=="number")fi=Si|0;else if(!Si)fi=1;else{me.type(Si,"object","invalid arguments for framebuffer");var Qi=Si;if("shape"in Qi){var es=Qi.shape;me(Array.isArray(es)&&es.length>=2,"invalid shape for framebuffer"),me(es[0]===es[1],"cube framebuffer must be square"),fi=es[0]}else"radius"in Qi&&(fi=Qi.radius|0),"width"in Qi?(fi=Qi.width|0,"height"in Qi&&me(Qi.height===fi,"must be square")):"height"in Qi&&(fi=Qi.height|0);("color"in Qi||"colors"in Qi)&&(wi=Qi.color||Qi.colors,Array.isArray(wi)&&me(wi.length===1||ue.webgl_draw_buffers,"multiple render targets not supported")),wi||("colorCount"in Qi&&(yo=Qi.colorCount|0,me(yo>0,"invalid color buffer count")),"colorType"in Qi&&(me.oneOf(Qi.colorType,Vr,"invalid color type"),$a=Qi.colorType),"colorFormat"in Qi&&(qi=Qi.colorFormat,me.oneOf(Qi.colorFormat,Pr,"invalid color format for texture"))),"depth"in Qi&&(bn.depth=Qi.depth),"stencil"in Qi&&(bn.stencil=Qi.stencil),"depthStencil"in Qi&&(bn.depthStencil=Qi.depthStencil)}var Ha;if(wi)if(Array.isArray(wi))for(Ha=[],gn=0;gn<wi.length;++gn)Ha[gn]=wi[gn];else Ha=[wi];else{Ha=Array(yo);var Ho={radius:fi,format:qi,type:$a};for(gn=0;gn<yo;++gn)Ha[gn]=Ht.createCube(Ho)}for(bn.color=Array(Ha.length),gn=0;gn<Ha.length;++gn){var Lo=Ha[gn];me(typeof Lo=="function"&&Lo._reglType==="textureCube","invalid cube map"),fi=fi||Lo.width,me(Lo.width===fi&&Lo.height===fi,"invalid cube map shape"),bn.color[gn]={target:mu,data:Ha[gn]}}for(gn=0;gn<6;++gn){for(var cs=0;cs<Ha.length;++cs)bn.color[cs].target=mu+gn;gn>0&&(bn.depth=dn[0].depth,bn.stencil=dn[0].stencil,bn.depthStencil=dn[0].depthStencil),dn[gn]?dn[gn](bn):dn[gn]=ir(bn)}return H(fn,{width:fi,height:fi,color:Ha})}function Ii(Si){var gn,bn=Si|0;if(me(bn>0&&bn<=He.maxCubeMapSize,"invalid radius for cube fbo"),bn===fn.width)return fn;var fi=fn.color;for(gn=0;gn<fi.length;++gn)fi[gn].resize(bn);for(gn=0;gn<6;++gn)dn[gn].resize(bn);return fn.width=fn.height=bn,fn}return fn(Zr),H(fn,{faces:dn,resize:Ii,_reglType:"framebufferCube",destroy:function(){dn.forEach(function(gn){gn.destroy()})}})}function sn(){Jt.cur=null,Jt.next=null,Jt.dirty=!0,Ve(cr).forEach(function(Zr){Zr.framebuffer=K.createFramebuffer(),yr(Zr)})}return H(Jt,{getFramebuffer:function(dn){if(typeof dn=="function"&&dn._reglType==="framebuffer"){var fn=dn._framebuffer;if(fn instanceof kn)return fn}return null},create:ir,createCube:tn,clear:function(){Ve(cr).forEach(qr)},restore:sn})}var xe=5126,Ne=34962,Re=34963,Ye=["attributes","elements","offset","count","primitive","instances"];function ze(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=xe,this.offset=0,this.stride=0,this.divisor=0}function Ge(K,ue,He,Ht,hr,ar,Jt){for(var Pr=He.maxAttributes,jr=new Array(Pr),Vr=0;Vr<Pr;++Vr)jr[Vr]=new ze;var Yr=0,Wr={},pn={Record:ze,scope:{},state:jr,currentVAO:null,targetVAO:null,restore:zr()?Mn:function(){},createVAO:qr,getVAO:Wt,destroyBuffer:on,setVAO:zr()?Br:Tn,clear:zr()?cr:function(){}};function on(yr){for(var ir=0;ir<jr.length;++ir){var tn=jr[ir];tn.buffer===yr&&(K.disableVertexAttribArray(ir),tn.buffer=null)}}function zr(){return ue.oes_vertex_array_object}function Gt(){return ue.angle_instanced_arrays}function Wt(yr){return typeof yr=="function"&&yr._vao?yr._vao:null}function Br(yr){if(yr!==pn.currentVAO){var ir=zr();yr?ir.bindVertexArrayOES(yr.vao):ir.bindVertexArrayOES(null),pn.currentVAO=yr}}function Tn(yr){if(yr!==pn.currentVAO){if(yr)yr.bindAttrs();else{for(var ir=Gt(),tn=0;tn<jr.length;++tn){var sn=jr[tn];sn.buffer?(K.enableVertexAttribArray(tn),sn.buffer.bind(),K.vertexAttribPointer(tn,sn.size,sn.type,sn.normalized,sn.stride,sn.offfset),ir&&sn.divisor&&ir.vertexAttribDivisorANGLE(tn,sn.divisor)):(K.disableVertexAttribArray(tn),K.vertexAttrib4f(tn,sn.x,sn.y,sn.z,sn.w))}Jt.elements?K.bindBuffer(Re,Jt.elements.buffer.buffer):K.bindBuffer(Re,null)}pn.currentVAO=yr}}function cr(){Ve(Wr).forEach(function(yr){yr.destroy()})}function kn(){this.id=++Yr,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var yr=zr();yr?this.vao=yr.createVertexArrayOES():this.vao=null,Wr[this.id]=this,this.buffers=[]}kn.prototype.bindAttrs=function(){for(var yr=Gt(),ir=this.attributes,tn=0;tn<ir.length;++tn){var sn=ir[tn];sn.buffer?(K.enableVertexAttribArray(tn),K.bindBuffer(Ne,sn.buffer.buffer),K.vertexAttribPointer(tn,sn.size,sn.type,sn.normalized,sn.stride,sn.offset),yr&&sn.divisor&&yr.vertexAttribDivisorANGLE(tn,sn.divisor)):(K.disableVertexAttribArray(tn),K.vertexAttrib4f(tn,sn.x,sn.y,sn.z,sn.w))}for(var Zr=ir.length;Zr<Pr;++Zr)K.disableVertexAttribArray(Zr);var dn=ar.getElements(this.elements);dn?K.bindBuffer(Re,dn.buffer.buffer):K.bindBuffer(Re,null)},kn.prototype.refresh=function(){var yr=zr();yr&&(yr.bindVertexArrayOES(this.vao),this.bindAttrs(),pn.currentVAO=null,yr.bindVertexArrayOES(null))},kn.prototype.destroy=function(){if(this.vao){var yr=zr();this===pn.currentVAO&&(pn.currentVAO=null,yr.bindVertexArrayOES(null)),yr.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),Wr[this.id]&&(delete Wr[this.id],Ht.vaoCount-=1)};function Mn(){var yr=zr();yr&&Ve(Wr).forEach(function(ir){ir.refresh()})}function qr(yr){var ir=new kn;Ht.vaoCount+=1;function tn(sn){var Zr;if(Array.isArray(sn))Zr=sn,ir.elements&&ir.ownsElements&&ir.elements.destroy(),ir.elements=null,ir.ownsElements=!1,ir.offset=0,ir.count=0,ir.instances=-1,ir.primitive=4;else{if(me(typeof sn=="object","invalid arguments for create vao"),me("attributes"in sn,"must specify attributes for vao"),sn.elements){var dn=sn.elements;ir.ownsElements?typeof dn=="function"&&dn._reglType==="elements"?(ir.elements.destroy(),ir.ownsElements=!1):(ir.elements(dn),ir.ownsElements=!1):ar.getElements(sn.elements)?(ir.elements=sn.elements,ir.ownsElements=!1):(ir.elements=ar.create(sn.elements),ir.ownsElements=!0)}else ir.elements=null,ir.ownsElements=!1;Zr=sn.attributes,ir.offset=0,ir.count=-1,ir.instances=-1,ir.primitive=4,ir.elements&&(ir.count=ir.elements._elements.vertCount,ir.primitive=ir.elements._elements.primType),"offset"in sn&&(ir.offset=sn.offset|0),"count"in sn&&(ir.count=sn.count|0),"instances"in sn&&(ir.instances=sn.instances|0),"primitive"in sn&&(me(sn.primitive in wr,"bad primitive type: "+sn.primitive),ir.primitive=wr[sn.primitive]),me.optional(function(){for(var $a=Object.keys(sn),yo=0;yo<$a.length;++yo)me(Ye.indexOf($a[yo])>=0,'invalid option for vao: "'+$a[yo]+'" valid options are '+Ye)}),me(Array.isArray(Zr),"attributes must be an array")}me(Zr.length<Pr,"too many attributes"),me(Zr.length>0,"must specify at least one attribute");var fn={},Ii=ir.attributes;Ii.length=Zr.length;for(var Si=0;Si<Zr.length;++Si){var gn=Zr[Si],bn=Ii[Si]=new ze,fi=gn.data||gn;if(Array.isArray(fi)||G(fi)||xo(fi)){var wi;ir.buffers[Si]&&(wi=ir.buffers[Si],G(fi)&&wi._buffer.byteLength>=fi.byteLength?wi.subdata(fi):(wi.destroy(),ir.buffers[Si]=null)),ir.buffers[Si]||(wi=ir.buffers[Si]=hr.create(gn,Ne,!1,!0)),bn.buffer=hr.getBuffer(wi),bn.size=bn.buffer.dimension|0,bn.normalized=!1,bn.type=bn.buffer.dtype,bn.offset=0,bn.stride=0,bn.divisor=0,bn.state=1,fn[Si]=1}else hr.getBuffer(gn)?(bn.buffer=hr.getBuffer(gn),bn.size=bn.buffer.dimension|0,bn.normalized=!1,bn.type=bn.buffer.dtype,bn.offset=0,bn.stride=0,bn.divisor=0,bn.state=1):hr.getBuffer(gn.buffer)?(bn.buffer=hr.getBuffer(gn.buffer),bn.size=(+gn.size||bn.buffer.dimension)|0,bn.normalized=!!gn.normalized||!1,"type"in gn?(me.parameter(gn.type,Yo,"invalid buffer type"),bn.type=Yo[gn.type]):bn.type=bn.buffer.dtype,bn.offset=(gn.offset||0)|0,bn.stride=(gn.stride||0)|0,bn.divisor=(gn.divisor||0)|0,bn.state=1,me(bn.size>=1&&bn.size<=4,"size must be between 1 and 4"),me(bn.offset>=0,"invalid offset"),me(bn.stride>=0&&bn.stride<=255,"stride must be between 0 and 255"),me(bn.divisor>=0,"divisor must be positive"),me(!bn.divisor||!!ue.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in gn?(me(Si>0,"first attribute must not be a constant"),bn.x=+gn.x||0,bn.y=+gn.y||0,bn.z=+gn.z||0,bn.w=+gn.w||0,bn.state=2):me(!1,"invalid attribute spec for location "+Si)}for(var qi=0;qi<ir.buffers.length;++qi)!fn[qi]&&ir.buffers[qi]&&(ir.buffers[qi].destroy(),ir.buffers[qi]=null);return ir.refresh(),tn}return tn.destroy=function(){for(var sn=0;sn<ir.buffers.length;++sn)ir.buffers[sn]&&ir.buffers[sn].destroy();ir.buffers.length=0,ir.ownsElements&&(ir.elements.destroy(),ir.elements=null,ir.ownsElements=!1),ir.destroy()},tn._vao=ir,tn._reglType="vao",tn(yr)}return pn}var xt=35632,_t=35633,fr=35718,Vt=35721;function lr(K,ue,He,Ht){var hr={},ar={};function Jt(Gt,Wt,Br,Tn){this.name=Gt,this.id=Wt,this.location=Br,this.info=Tn}function Pr(Gt,Wt){for(var Br=0;Br<Gt.length;++Br)if(Gt[Br].id===Wt.id){Gt[Br].location=Wt.location;return}Gt.push(Wt)}function jr(Gt,Wt,Br){var Tn=Gt===xt?hr:ar,cr=Tn[Wt];if(!cr){var kn=ue.str(Wt);cr=K.createShader(Gt),K.shaderSource(cr,kn),K.compileShader(cr),me.shaderError(K,cr,kn,Gt,Br),Tn[Wt]=cr}return cr}var Vr={},Yr=[],Wr=0;function pn(Gt,Wt){this.id=Wr++,this.fragId=Gt,this.vertId=Wt,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Ht.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function on(Gt,Wt,Br){var Tn,cr,kn=jr(xt,Gt.fragId),Mn=jr(_t,Gt.vertId),qr=Gt.program=K.createProgram();if(K.attachShader(qr,kn),K.attachShader(qr,Mn),Br)for(Tn=0;Tn<Br.length;++Tn){var yr=Br[Tn];K.bindAttribLocation(qr,yr[0],yr[1])}K.linkProgram(qr),me.linkError(K,qr,ue.str(Gt.fragId),ue.str(Gt.vertId),Wt);var ir=K.getProgramParameter(qr,fr);Ht.profile&&(Gt.stats.uniformsCount=ir);var tn=Gt.uniforms;for(Tn=0;Tn<ir;++Tn)if(cr=K.getActiveUniform(qr,Tn),cr)if(cr.size>1)for(var sn=0;sn<cr.size;++sn){var Zr=cr.name.replace("[0]","["+sn+"]");Pr(tn,new Jt(Zr,ue.id(Zr),K.getUniformLocation(qr,Zr),cr))}else Pr(tn,new Jt(cr.name,ue.id(cr.name),K.getUniformLocation(qr,cr.name),cr));var dn=K.getProgramParameter(qr,Vt);Ht.profile&&(Gt.stats.attributesCount=dn);var fn=Gt.attributes;for(Tn=0;Tn<dn;++Tn)cr=K.getActiveAttrib(qr,Tn),cr&&Pr(fn,new Jt(cr.name,ue.id(cr.name),K.getAttribLocation(qr,cr.name),cr))}Ht.profile&&(He.getMaxUniformsCount=function(){var Gt=0;return Yr.forEach(function(Wt){Wt.stats.uniformsCount>Gt&&(Gt=Wt.stats.uniformsCount)}),Gt},He.getMaxAttributesCount=function(){var Gt=0;return Yr.forEach(function(Wt){Wt.stats.attributesCount>Gt&&(Gt=Wt.stats.attributesCount)}),Gt});function zr(){hr={},ar={};for(var Gt=0;Gt<Yr.length;++Gt)on(Yr[Gt],null,Yr[Gt].attributes.map(function(Wt){return[Wt.location,Wt.name]}))}return{clear:function(){var Wt=K.deleteShader.bind(K);Ve(hr).forEach(Wt),hr={},Ve(ar).forEach(Wt),ar={},Yr.forEach(function(Br){K.deleteProgram(Br.program)}),Yr.length=0,Vr={},He.shaderCount=0},program:function(Wt,Br,Tn,cr){me.command(Wt>=0,"missing vertex shader",Tn),me.command(Br>=0,"missing fragment shader",Tn);var kn=Vr[Br];kn||(kn=Vr[Br]={});var Mn=kn[Wt];if(Mn&&(Mn.refCount++,!cr))return Mn;var qr=new pn(Br,Wt);return He.shaderCount++,on(qr,Tn,cr),Mn||(kn[Wt]=qr),Yr.push(qr),H(qr,{destroy:function(){if(qr.refCount--,qr.refCount<=0){K.deleteProgram(qr.program);var ir=Yr.indexOf(qr);Yr.splice(ir,1),He.shaderCount--}kn[qr.vertId].refCount<=0&&(K.deleteShader(ar[qr.vertId]),delete ar[qr.vertId],delete Vr[qr.fragId][qr.vertId]),Object.keys(Vr[qr.fragId]).length||(K.deleteShader(hr[qr.fragId]),delete hr[qr.fragId],delete Vr[qr.fragId])}})},restore:zr,shader:jr,frag:-1,vert:-1}}var vr=6408,xr=5121,Hr=3333,cn=5126;function Un(K,ue,He,Ht,hr,ar,Jt){function Pr(Yr){var Wr;ue.next===null?(me(hr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Wr=xr):(me(ue.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Wr=ue.next.colorAttachments[0].texture._texture.type,me.optional(function(){ar.oes_texture_float?(me(Wr===xr||Wr===cn,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Wr===cn&&me(Jt.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):me(Wr===xr,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var pn=0,on=0,zr=Ht.framebufferWidth,Gt=Ht.framebufferHeight,Wt=null;G(Yr)?Wt=Yr:Yr&&(me.type(Yr,"object","invalid arguments to regl.read()"),pn=Yr.x|0,on=Yr.y|0,me(pn>=0&&pn<Ht.framebufferWidth,"invalid x offset for regl.read"),me(on>=0&&on<Ht.framebufferHeight,"invalid y offset for regl.read"),zr=(Yr.width||Ht.framebufferWidth-pn)|0,Gt=(Yr.height||Ht.framebufferHeight-on)|0,Wt=Yr.data||null),Wt&&(Wr===xr?me(Wt instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Wr===cn&&me(Wt instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),me(zr>0&&zr+pn<=Ht.framebufferWidth,"invalid width for read pixels"),me(Gt>0&&Gt+on<=Ht.framebufferHeight,"invalid height for read pixels"),He();var Br=zr*Gt*4;return Wt||(Wr===xr?Wt=new Uint8Array(Br):Wr===cn&&(Wt=Wt||new Float32Array(Br))),me.isTypedArray(Wt,"data buffer for regl.read() must be a typedarray"),me(Wt.byteLength>=Br,"data buffer for regl.read() too small"),K.pixelStorei(Hr,4),K.readPixels(pn,on,zr,Gt,vr,Wr,Wt),Wt}function jr(Yr){var Wr;return ue.setFBO({framebuffer:Yr.framebuffer},function(){Wr=Pr(Yr)}),Wr}function Vr(Yr){return!Yr||!("framebuffer"in Yr)?Pr(Yr):jr(Yr)}return Vr}function Jn(K){return Array.prototype.slice.call(K)}function oi(K){return Jn(K).join("")}function ji(){var K=0,ue=[],He=[];function Ht(Wr){for(var pn=0;pn<He.length;++pn)if(He[pn]===Wr)return ue[pn];var on="g"+K++;return ue.push(on),He.push(Wr),on}function hr(){var Wr=[];function pn(){Wr.push.apply(Wr,Jn(arguments))}var on=[];function zr(){var Gt="v"+K++;return on.push(Gt),arguments.length>0&&(Wr.push(Gt,"="),Wr.push.apply(Wr,Jn(arguments)),Wr.push(";")),Gt}return H(pn,{def:zr,toString:function(){return oi([on.length>0?"var "+on.join(",")+";":"",oi(Wr)])}})}function ar(){var Wr=hr(),pn=hr(),on=Wr.toString,zr=pn.toString;function Gt(Wt,Br){pn(Wt,Br,"=",Wr.def(Wt,Br),";")}return H(function(){Wr.apply(Wr,Jn(arguments))},{def:Wr.def,entry:Wr,exit:pn,save:Gt,set:function(Br,Tn,cr){Gt(Br,Tn),Wr(Br,Tn,"=",cr,";")},toString:function(){return on()+zr()}})}function Jt(){var Wr=oi(arguments),pn=ar(),on=ar(),zr=pn.toString,Gt=on.toString;return H(pn,{then:function(){return pn.apply(pn,Jn(arguments)),this},else:function(){return on.apply(on,Jn(arguments)),this},toString:function(){var Br=Gt();return Br&&(Br="else{"+Br+"}"),oi(["if(",Wr,"){",zr(),"}",Br])}})}var Pr=hr(),jr={};function Vr(Wr,pn){var on=[];function zr(){var cr="a"+on.length;return on.push(cr),cr}pn=pn||0;for(var Gt=0;Gt<pn;++Gt)zr();var Wt=ar(),Br=Wt.toString,Tn=jr[Wr]=H(Wt,{arg:zr,toString:function(){return oi(["function(",on.join(),"){",Br(),"}"])}});return Tn}function Yr(){var Wr=['"use strict";',Pr,"return {"];Object.keys(jr).forEach(function(Gt){Wr.push('"',Gt,'":',jr[Gt].toString(),",")}),Wr.push("}");var pn=oi(Wr).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),on=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,zr=on?N.Function.apply(null,ue.concat(pn)):Function.apply(null,ue.concat(pn));return zr.apply(null,He)}return{global:Pr,link:Ht,block:hr,proc:Vr,scope:ar,cond:Jt,compile:Yr}}var hi="xyzw".split(""),Rn=5121,bi=1,Oi=2,Qn=0,Ri=1,si=2,Di=3,$i=4,mo=5,uo=6,Ro="dither",Za="blend.enable",no="blend.color",Ks="blend.equation",Ba="blend.func",vl="depth.enable",ks="depth.func",bs="depth.range",Es="depth.mask",Co="colorMask",Ls="cull.enable",qu="cull.face",Ll="frontFace",ml="lineWidth",xu="polygonOffset.enable",ql="polygonOffset.offset",bu="sample.alpha",ko="sample.enable",Lu="sample.coverage",Jc="stencil.enable",Qu="stencil.mask",jo="stencil.func",Ds="stencil.opFront",Vo="stencil.opBack",Fs="scissor.enable",Go="scissor.box",$s="viewport",ef="profile",Dl="framebuffer",mc="vert",Ju="frag",gl="elements",Eu="primitive",Bs="count",Qo="offset",zh="instances",Of="vao",gp="Width",yp="Height",If=Dl+gp,Rf=Dl+yp,gc=$s+gp,uv=$s+yp,fh="drawingBuffer",_p=fh+gp,Ql=fh+yp,kf=[Ba,Ks,jo,Ds,Vo,Lu,$s,Go,ql],tf=34962,xp=34963,lv=35632,pd=35633,bp=3553,cv=34067,fv=2884,Ep=3042,hv=3024,Lf=2960,pm=2929,Cr=3089,Uh=32823,dd=32926,Kt=32928,Df=5126,yc=35664,Ff=35665,Bf=35666,_c=5124,Nf=35667,rf=35668,xc=35669,nf=35670,jh=35671,af=35672,hh=35673,bc=35674,Ec=35675,Js=35676,ph=35678,zf=35680,Vh=4,of=1028,Sc=1029,sf=2304,Sp=2305,pv=32775,vd=32776,md=519,Cc=7680,Cp=0,uf=1,Ap=32774,wp=513,dh=36160,yl=36064,_l={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Tp=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Uf={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Du={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Gh={frag:lv,vert:pd},Mp={cw:sf,ccw:Sp};function Hh(K){return Array.isArray(K)||G(K)||xo(K)}function gd(K){return K.sort(function(ue,He){return ue===$s?-1:He===$s?1:ue<He?-1:1})}function Jo(K,ue,He,Ht){this.thisDep=K,this.contextDep=ue,this.propDep=He,this.append=Ht}function Fu(K){return K&&!(K.thisDep||K.contextDep||K.propDep)}function va(K){return new Jo(!1,!1,!1,K)}function Zi(K,ue){var He=K.type;if(He===Qn){var Ht=K.data.length;return new Jo(!0,Ht>=1,Ht>=2,ue)}else if(He===$i){var hr=K.data;return new Jo(hr.thisDep,hr.contextDep,hr.propDep,ue)}else{if(He===mo)return new Jo(!1,!1,!1,ue);if(He===uo){for(var ar=!1,Jt=!1,Pr=!1,jr=0;jr<K.data.length;++jr){var Vr=K.data[jr];if(Vr.type===Ri)Pr=!0;else if(Vr.type===si)Jt=!0;else if(Vr.type===Di)ar=!0;else if(Vr.type===Qn){ar=!0;var Yr=Vr.data;Yr>=1&&(Jt=!0),Yr>=2&&(Pr=!0)}else Vr.type===$i&&(ar=ar||Vr.data.thisDep,Jt=Jt||Vr.data.contextDep,Pr=Pr||Vr.data.propDep)}return new Jo(ar,Jt,Pr,ue)}else return new Jo(He===Di,He===si,He===Ri,ue)}}var go=new Jo(!1,!1,!1,function(){});function Ac(K,ue,He,Ht,hr,ar,Jt,Pr,jr,Vr,Yr,Wr,pn,on,zr){var Gt=Vr.Record,Wt={add:32774,subtract:32778,"reverse subtract":32779};He.ext_blend_minmax&&(Wt.min=pv,Wt.max=vd);var Br=He.angle_instanced_arrays,Tn=He.webgl_draw_buffers,cr=He.oes_vertex_array_object,kn={dirty:!0,profile:zr.profile},Mn={},qr=[],yr={},ir={};function tn(Me){return Me.replace(".","_")}function sn(Me,ge,qe){var At=tn(Me);qr.push(Me),Mn[At]=kn[At]=!!qe,yr[At]=ge}function Zr(Me,ge,qe){var At=tn(Me);qr.push(Me),Array.isArray(qe)?(kn[At]=qe.slice(),Mn[At]=qe.slice()):kn[At]=Mn[At]=qe,ir[At]=ge}sn(Ro,hv),sn(Za,Ep),Zr(no,"blendColor",[0,0,0,0]),Zr(Ks,"blendEquationSeparate",[Ap,Ap]),Zr(Ba,"blendFuncSeparate",[uf,Cp,uf,Cp]),sn(vl,pm,!0),Zr(ks,"depthFunc",wp),Zr(bs,"depthRange",[0,1]),Zr(Es,"depthMask",!0),Zr(Co,Co,[!0,!0,!0,!0]),sn(Ls,fv),Zr(qu,"cullFace",Sc),Zr(Ll,Ll,Sp),Zr(ml,ml,1),sn(xu,Uh),Zr(ql,"polygonOffset",[0,0]),sn(bu,dd),sn(ko,Kt),Zr(Lu,"sampleCoverage",[1,!1]),sn(Jc,Lf),Zr(Qu,"stencilMask",-1),Zr(jo,"stencilFunc",[md,0,-1]),Zr(Ds,"stencilOpSeparate",[of,Cc,Cc,Cc]),Zr(Vo,"stencilOpSeparate",[Sc,Cc,Cc,Cc]),sn(Fs,Cr),Zr(Go,"scissor",[0,0,K.drawingBufferWidth,K.drawingBufferHeight]),Zr($s,$s,[0,0,K.drawingBufferWidth,K.drawingBufferHeight]);var dn={gl:K,context:pn,strings:ue,next:Mn,current:kn,draw:Wr,elements:ar,buffer:hr,shader:Yr,attributes:Vr.state,vao:Vr,uniforms:jr,framebuffer:Pr,extensions:He,timer:on,isBufferArgs:Hh},fn={primTypes:wr,compareFuncs:Uf,blendFuncs:_l,blendEquations:Wt,stencilOps:Du,glTypes:Yo,orientationType:Mp};me.optional(function(){dn.isArrayLike=Ji}),Tn&&(fn.backBuffer=[Sc],fn.drawBuffer=Se(Ht.maxDrawbuffers,function(Me){return Me===0?[0]:Se(Me,function(ge){return yl+ge})}));var Ii=0;function Si(){var Me=ji(),ge=Me.link,qe=Me.global;Me.id=Ii++,Me.batchId="0";var At=ge(dn),Yt=Me.shared={props:"a0"};Object.keys(dn).forEach(function(Ke){Yt[Ke]=qe.def(At,".",Ke)}),me.optional(function(){Me.CHECK=ge(me),Me.commandStr=me.guessCommand(),Me.command=ge(Me.commandStr),Me.assert=function(Ke,Pe,bt){Ke("if(!(",Pe,"))",this.CHECK,".commandRaise(",ge(bt),",",this.command,");")},fn.invalidBlendCombinations=Tp});var it=Me.next={},Qe=Me.current={};Object.keys(ir).forEach(function(Ke){Array.isArray(kn[Ke])&&(it[Ke]=qe.def(Yt.next,".",Ke),Qe[Ke]=qe.def(Yt.current,".",Ke))});var ft=Me.constants={};Object.keys(fn).forEach(function(Ke){ft[Ke]=qe.def(JSON.stringify(fn[Ke]))}),Me.invoke=function(Ke,Pe){switch(Pe.type){case Qn:var bt=["this",Yt.context,Yt.props,Me.batchId];return Ke.def(ge(Pe.data),".call(",bt.slice(0,Math.max(Pe.data.length+1,4)),")");case Ri:return Ke.def(Yt.props,Pe.data);case si:return Ke.def(Yt.context,Pe.data);case Di:return Ke.def("this",Pe.data);case $i:return Pe.data.append(Me,Ke),Pe.data.ref;case mo:return Pe.data.toString();case uo:return Pe.data.map(function(zt){return Me.invoke(Ke,zt)})}},Me.attribCache={};var ye={};return Me.scopeAttrib=function(Ke){var Pe=ue.id(Ke);if(Pe in ye)return ye[Pe];var bt=Vr.scope[Pe];bt||(bt=Vr.scope[Pe]=new Gt);var zt=ye[Pe]=ge(bt);return zt},Me}function gn(Me){var ge=Me.static,qe=Me.dynamic,At;if(ef in ge){var Yt=!!ge[ef];At=va(function(Qe,ft){return Yt}),At.enable=Yt}else if(ef in qe){var it=qe[ef];At=Zi(it,function(Qe,ft){return Qe.invoke(ft,it)})}return At}function bn(Me,ge){var qe=Me.static,At=Me.dynamic;if(Dl in qe){var Yt=qe[Dl];return Yt?(Yt=Pr.getFramebuffer(Yt),me.command(Yt,"invalid framebuffer object"),va(function(Qe,ft){var ye=Qe.link(Yt),Ke=Qe.shared;ft.set(Ke.framebuffer,".next",ye);var Pe=Ke.context;return ft.set(Pe,"."+If,ye+".width"),ft.set(Pe,"."+Rf,ye+".height"),ye})):va(function(Qe,ft){var ye=Qe.shared;ft.set(ye.framebuffer,".next","null");var Ke=ye.context;return ft.set(Ke,"."+If,Ke+"."+_p),ft.set(Ke,"."+Rf,Ke+"."+Ql),"null"})}else if(Dl in At){var it=At[Dl];return Zi(it,function(Qe,ft){var ye=Qe.invoke(ft,it),Ke=Qe.shared,Pe=Ke.framebuffer,bt=ft.def(Pe,".getFramebuffer(",ye,")");me.optional(function(){Qe.assert(ft,"!"+ye+"||"+bt,"invalid framebuffer object")}),ft.set(Pe,".next",bt);var zt=Ke.context;return ft.set(zt,"."+If,bt+"?"+bt+".width:"+zt+"."+_p),ft.set(zt,"."+Rf,bt+"?"+bt+".height:"+zt+"."+Ql),bt})}else return null}function fi(Me,ge,qe){var At=Me.static,Yt=Me.dynamic;function it(ye){if(ye in At){var Ke=At[ye];me.commandType(Ke,"object","invalid "+ye,qe.commandStr);var Pe=!0,bt=Ke.x|0,zt=Ke.y|0,Or,un;return"width"in Ke?(Or=Ke.width|0,me.command(Or>=0,"invalid "+ye,qe.commandStr)):Pe=!1,"height"in Ke?(un=Ke.height|0,me.command(un>=0,"invalid "+ye,qe.commandStr)):Pe=!1,new Jo(!Pe&&ge&&ge.thisDep,!Pe&&ge&&ge.contextDep,!Pe&&ge&&ge.propDep,function(rn,Zn){var Pn=rn.shared.context,zn=Or;"width"in Ke||(zn=Zn.def(Pn,".",If,"-",bt));var jn=un;return"height"in Ke||(jn=Zn.def(Pn,".",Rf,"-",zt)),[bt,zt,zn,jn]})}else if(ye in Yt){var ln=Yt[ye],En=Zi(ln,function(rn,Zn){var Pn=rn.invoke(Zn,ln);me.optional(function(){rn.assert(Zn,Pn+"&&typeof "+Pn+'==="object"',"invalid "+ye)});var zn=rn.shared.context,jn=Zn.def(Pn,".x|0"),Vn=Zn.def(Pn,".y|0"),pi=Zn.def('"width" in ',Pn,"?",Pn,".width|0:","(",zn,".",If,"-",jn,")"),ya=Zn.def('"height" in ',Pn,"?",Pn,".height|0:","(",zn,".",Rf,"-",Vn,")");return me.optional(function(){rn.assert(Zn,pi+">=0&&"+ya+">=0","invalid "+ye)}),[jn,Vn,pi,ya]});return ge&&(En.thisDep=En.thisDep||ge.thisDep,En.contextDep=En.contextDep||ge.contextDep,En.propDep=En.propDep||ge.propDep),En}else return ge?new Jo(ge.thisDep,ge.contextDep,ge.propDep,function(rn,Zn){var Pn=rn.shared.context;return[0,0,Zn.def(Pn,".",If),Zn.def(Pn,".",Rf)]}):null}var Qe=it($s);if(Qe){var ft=Qe;Qe=new Jo(Qe.thisDep,Qe.contextDep,Qe.propDep,function(ye,Ke){var Pe=ft.append(ye,Ke),bt=ye.shared.context;return Ke.set(bt,"."+gc,Pe[2]),Ke.set(bt,"."+uv,Pe[3]),Pe})}return{viewport:Qe,scissor_box:it(Go)}}function wi(Me,ge){var qe=Me.static,At=typeof qe[Ju]=="string"&&typeof qe[mc]=="string";if(At){if(Object.keys(ge.dynamic).length>0)return null;var Yt=ge.static,it=Object.keys(Yt);if(it.length>0&&typeof Yt[it[0]]=="number"){for(var Qe=[],ft=0;ft<it.length;++ft)me(typeof Yt[it[ft]]=="number","must specify all vertex attribute locations when using vaos"),Qe.push([Yt[it[ft]]|0,it[ft]]);return Qe}}return null}function qi(Me,ge,qe){var At=Me.static,Yt=Me.dynamic;function it(Pe){if(Pe in At){var bt=ue.id(At[Pe]);me.optional(function(){Yr.shader(Gh[Pe],bt,me.guessCommand())});var zt=va(function(){return bt});return zt.id=bt,zt}else if(Pe in Yt){var Or=Yt[Pe];return Zi(Or,function(un,ln){var En=un.invoke(ln,Or),rn=ln.def(un.shared.strings,".id(",En,")");return me.optional(function(){ln(un.shared.shader,".shader(",Gh[Pe],",",rn,",",un.command,");")}),rn})}return null}var Qe=it(Ju),ft=it(mc),ye=null,Ke;return Fu(Qe)&&Fu(ft)?(ye=Yr.program(ft.id,Qe.id,null,qe),Ke=va(function(Pe,bt){return Pe.link(ye)})):Ke=new Jo(Qe&&Qe.thisDep||ft&&ft.thisDep,Qe&&Qe.contextDep||ft&&ft.contextDep,Qe&&Qe.propDep||ft&&ft.propDep,function(Pe,bt){var zt=Pe.shared.shader,Or;Qe?Or=Qe.append(Pe,bt):Or=bt.def(zt,".",Ju);var un;ft?un=ft.append(Pe,bt):un=bt.def(zt,".",mc);var ln=zt+".program("+un+","+Or;return me.optional(function(){ln+=","+Pe.command}),bt.def(ln+")")}),{frag:Qe,vert:ft,progVar:Ke,program:ye}}function $a(Me,ge){var qe=Me.static,At=Me.dynamic,Yt={},it=!1;function Qe(){if(Of in qe){var Zn=qe[Of];return Zn!==null&&Vr.getVAO(Zn)===null&&(Zn=Vr.createVAO(Zn)),it=!0,Yt.vao=Zn,va(function(zn){var jn=Vr.getVAO(Zn);return jn?zn.link(jn):"null"})}else if(Of in At){it=!0;var Pn=At[Of];return Zi(Pn,function(zn,jn){var Vn=zn.invoke(jn,Pn);return jn.def(zn.shared.vao+".getVAO("+Vn+")")})}return null}var ft=Qe(),ye=!1;function Ke(){if(gl in qe){var Zn=qe[gl];if(Yt.elements=Zn,Hh(Zn)){var Pn=Yt.elements=ar.create(Zn,!0);Zn=ar.getElements(Pn),ye=!0}else Zn&&(Zn=ar.getElements(Zn),ye=!0,me.command(Zn,"invalid elements",ge.commandStr));var zn=va(function(Vn,pi){if(Zn){var ya=Vn.link(Zn);return Vn.ELEMENTS=ya,ya}return Vn.ELEMENTS=null,null});return zn.value=Zn,zn}else if(gl in At){ye=!0;var jn=At[gl];return Zi(jn,function(Vn,pi){var ya=Vn.shared,ts=ya.isBufferArgs,Su=ya.elements,Fl=Vn.invoke(pi,jn),La=pi.def("null"),ra=pi.def(ts,"(",Fl,")"),bl=Vn.cond(ra).then(La,"=",Su,".createStream(",Fl,");").else(La,"=",Su,".getElements(",Fl,");");return me.optional(function(){Vn.assert(bl.else,"!"+Fl+"||"+La,"invalid elements")}),pi.entry(bl),pi.exit(Vn.cond(ra).then(Su,".destroyStream(",La,");")),Vn.ELEMENTS=La,La})}else if(it)return new Jo(ft.thisDep,ft.contextDep,ft.propDep,function(Vn,pi){return pi.def(Vn.shared.vao+".currentVAO?"+Vn.shared.elements+".getElements("+Vn.shared.vao+".currentVAO.elements):null")});return null}var Pe=Ke();function bt(){if(Eu in qe){var Zn=qe[Eu];return Yt.primitive=Zn,me.commandParameter(Zn,wr,"invalid primitve",ge.commandStr),va(function(zn,jn){return wr[Zn]})}else if(Eu in At){var Pn=At[Eu];return Zi(Pn,function(zn,jn){var Vn=zn.constants.primTypes,pi=zn.invoke(jn,Pn);return me.optional(function(){zn.assert(jn,pi+" in "+Vn,"invalid primitive, must be one of "+Object.keys(wr))}),jn.def(Vn,"[",pi,"]")})}else{if(ye)return Fu(Pe)?Pe.value?va(function(zn,jn){return jn.def(zn.ELEMENTS,".primType")}):va(function(){return Vh}):new Jo(Pe.thisDep,Pe.contextDep,Pe.propDep,function(zn,jn){var Vn=zn.ELEMENTS;return jn.def(Vn,"?",Vn,".primType:",Vh)});if(it)return new Jo(ft.thisDep,ft.contextDep,ft.propDep,function(zn,jn){return jn.def(zn.shared.vao+".currentVAO?"+zn.shared.vao+".currentVAO.primitive:"+Vh)})}return null}function zt(Zn,Pn){if(Zn in qe){var zn=qe[Zn]|0;return Pn?Yt.offset=zn:Yt.instances=zn,me.command(!Pn||zn>=0,"invalid "+Zn,ge.commandStr),va(function(Vn,pi){return Pn&&(Vn.OFFSET=zn),zn})}else if(Zn in At){var jn=At[Zn];return Zi(jn,function(Vn,pi){var ya=Vn.invoke(pi,jn);return Pn&&(Vn.OFFSET=ya,me.optional(function(){Vn.assert(pi,ya+">=0","invalid "+Zn)})),ya})}else if(Pn){if(ye)return va(function(Vn,pi){return Vn.OFFSET=0,0});if(it)return new Jo(ft.thisDep,ft.contextDep,ft.propDep,function(Vn,pi){return pi.def(Vn.shared.vao+".currentVAO?"+Vn.shared.vao+".currentVAO.offset:0")})}else if(it)return new Jo(ft.thisDep,ft.contextDep,ft.propDep,function(Vn,pi){return pi.def(Vn.shared.vao+".currentVAO?"+Vn.shared.vao+".currentVAO.instances:-1")});return null}var Or=zt(Qo,!0);function un(){if(Bs in qe){var Zn=qe[Bs]|0;return Yt.count=Zn,me.command(typeof Zn=="number"&&Zn>=0,"invalid vertex count",ge.commandStr),va(function(){return Zn})}else if(Bs in At){var Pn=At[Bs];return Zi(Pn,function(pi,ya){var ts=pi.invoke(ya,Pn);return me.optional(function(){pi.assert(ya,"typeof "+ts+'==="number"&&'+ts+">=0&&"+ts+"===("+ts+"|0)","invalid vertex count")}),ts})}else if(ye)if(Fu(Pe)){if(Pe)return Or?new Jo(Or.thisDep,Or.contextDep,Or.propDep,function(pi,ya){var ts=ya.def(pi.ELEMENTS,".vertCount-",pi.OFFSET);return me.optional(function(){pi.assert(ya,ts+">=0","invalid vertex offset/element buffer too small")}),ts}):va(function(pi,ya){return ya.def(pi.ELEMENTS,".vertCount")});var zn=va(function(){return-1});return me.optional(function(){zn.MISSING=!0}),zn}else{var jn=new Jo(Pe.thisDep||Or.thisDep,Pe.contextDep||Or.contextDep,Pe.propDep||Or.propDep,function(pi,ya){var ts=pi.ELEMENTS;return pi.OFFSET?ya.def(ts,"?",ts,".vertCount-",pi.OFFSET,":-1"):ya.def(ts,"?",ts,".vertCount:-1")});return me.optional(function(){jn.DYNAMIC=!0}),jn}else if(it){var Vn=new Jo(ft.thisDep,ft.contextDep,ft.propDep,function(pi,ya){return ya.def(pi.shared.vao,".currentVAO?",pi.shared.vao,".currentVAO.count:-1")});return Vn}return null}var ln=bt(),En=un(),rn=zt(zh,!1);return{elements:Pe,primitive:ln,count:En,instances:rn,offset:Or,vao:ft,vaoActive:it,elementsActive:ye,static:Yt}}function yo(Me,ge){var qe=Me.static,At=Me.dynamic,Yt={};return qr.forEach(function(it){var Qe=tn(it);function ft(ye,Ke){if(it in qe){var Pe=ye(qe[it]);Yt[Qe]=va(function(){return Pe})}else if(it in At){var bt=At[it];Yt[Qe]=Zi(bt,function(zt,Or){return Ke(zt,Or,zt.invoke(Or,bt))})}}switch(it){case Ls:case Za:case Ro:case Jc:case vl:case Fs:case xu:case bu:case ko:case Es:return ft(function(ye){return me.commandType(ye,"boolean",it,ge.commandStr),ye},function(ye,Ke,Pe){return me.optional(function(){ye.assert(Ke,"typeof "+Pe+'==="boolean"',"invalid flag "+it,ye.commandStr)}),Pe});case ks:return ft(function(ye){return me.commandParameter(ye,Uf,"invalid "+it,ge.commandStr),Uf[ye]},function(ye,Ke,Pe){var bt=ye.constants.compareFuncs;return me.optional(function(){ye.assert(Ke,Pe+" in "+bt,"invalid "+it+", must be one of "+Object.keys(Uf))}),Ke.def(bt,"[",Pe,"]")});case bs:return ft(function(ye){return me.command(Ji(ye)&&ye.length===2&&typeof ye[0]=="number"&&typeof ye[1]=="number"&&ye[0]<=ye[1],"depth range is 2d array",ge.commandStr),ye},function(ye,Ke,Pe){me.optional(function(){ye.assert(Ke,ye.shared.isArrayLike+"("+Pe+")&&"+Pe+".length===2&&typeof "+Pe+'[0]==="number"&&typeof '+Pe+'[1]==="number"&&'+Pe+"[0]<="+Pe+"[1]","depth range must be a 2d array")});var bt=Ke.def("+",Pe,"[0]"),zt=Ke.def("+",Pe,"[1]");return[bt,zt]});case Ba:return ft(function(ye){me.commandType(ye,"object","blend.func",ge.commandStr);var Ke="srcRGB"in ye?ye.srcRGB:ye.src,Pe="srcAlpha"in ye?ye.srcAlpha:ye.src,bt="dstRGB"in ye?ye.dstRGB:ye.dst,zt="dstAlpha"in ye?ye.dstAlpha:ye.dst;return me.commandParameter(Ke,_l,Qe+".srcRGB",ge.commandStr),me.commandParameter(Pe,_l,Qe+".srcAlpha",ge.commandStr),me.commandParameter(bt,_l,Qe+".dstRGB",ge.commandStr),me.commandParameter(zt,_l,Qe+".dstAlpha",ge.commandStr),me.command(Tp.indexOf(Ke+", "+bt)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Ke+", "+bt+")",ge.commandStr),[_l[Ke],_l[bt],_l[Pe],_l[zt]]},function(ye,Ke,Pe){var bt=ye.constants.blendFuncs;me.optional(function(){ye.assert(Ke,Pe+"&&typeof "+Pe+'==="object"',"invalid blend func, must be an object")});function zt(Pn,zn){var jn=Ke.def('"',Pn,zn,'" in ',Pe,"?",Pe,".",Pn,zn,":",Pe,".",Pn);return me.optional(function(){ye.assert(Ke,jn+" in "+bt,"invalid "+it+"."+Pn+zn+", must be one of "+Object.keys(_l))}),jn}var Or=zt("src","RGB"),un=zt("dst","RGB");me.optional(function(){var Pn=ye.constants.invalidBlendCombinations;ye.assert(Ke,Pn+".indexOf("+Or+'+", "+'+un+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ln=Ke.def(bt,"[",Or,"]"),En=Ke.def(bt,"[",zt("src","Alpha"),"]"),rn=Ke.def(bt,"[",un,"]"),Zn=Ke.def(bt,"[",zt("dst","Alpha"),"]");return[ln,rn,En,Zn]});case Ks:return ft(function(ye){if(typeof ye=="string")return me.commandParameter(ye,Wt,"invalid "+it,ge.commandStr),[Wt[ye],Wt[ye]];if(typeof ye=="object")return me.commandParameter(ye.rgb,Wt,it+".rgb",ge.commandStr),me.commandParameter(ye.alpha,Wt,it+".alpha",ge.commandStr),[Wt[ye.rgb],Wt[ye.alpha]];me.commandRaise("invalid blend.equation",ge.commandStr)},function(ye,Ke,Pe){var bt=ye.constants.blendEquations,zt=Ke.def(),Or=Ke.def(),un=ye.cond("typeof ",Pe,'==="string"');return me.optional(function(){function ln(En,rn,Zn){ye.assert(En,Zn+" in "+bt,"invalid "+rn+", must be one of "+Object.keys(Wt))}ln(un.then,it,Pe),ye.assert(un.else,Pe+"&&typeof "+Pe+'==="object"',"invalid "+it),ln(un.else,it+".rgb",Pe+".rgb"),ln(un.else,it+".alpha",Pe+".alpha")}),un.then(zt,"=",Or,"=",bt,"[",Pe,"];"),un.else(zt,"=",bt,"[",Pe,".rgb];",Or,"=",bt,"[",Pe,".alpha];"),Ke(un),[zt,Or]});case no:return ft(function(ye){return me.command(Ji(ye)&&ye.length===4,"blend.color must be a 4d array",ge.commandStr),Se(4,function(Ke){return+ye[Ke]})},function(ye,Ke,Pe){return me.optional(function(){ye.assert(Ke,ye.shared.isArrayLike+"("+Pe+")&&"+Pe+".length===4","blend.color must be a 4d array")}),Se(4,function(bt){return Ke.def("+",Pe,"[",bt,"]")})});case Qu:return ft(function(ye){return me.commandType(ye,"number",Qe,ge.commandStr),ye|0},function(ye,Ke,Pe){return me.optional(function(){ye.assert(Ke,"typeof "+Pe+'==="number"',"invalid stencil.mask")}),Ke.def(Pe,"|0")});case jo:return ft(function(ye){me.commandType(ye,"object",Qe,ge.commandStr);var Ke=ye.cmp||"keep",Pe=ye.ref||0,bt="mask"in ye?ye.mask:-1;return me.commandParameter(Ke,Uf,it+".cmp",ge.commandStr),me.commandType(Pe,"number",it+".ref",ge.commandStr),me.commandType(bt,"number",it+".mask",ge.commandStr),[Uf[Ke],Pe,bt]},function(ye,Ke,Pe){var bt=ye.constants.compareFuncs;me.optional(function(){function ln(){ye.assert(Ke,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ln(Pe+"&&typeof ",Pe,'==="object"'),ln('!("cmp" in ',Pe,")||(",Pe,".cmp in ",bt,")")});var zt=Ke.def('"cmp" in ',Pe,"?",bt,"[",Pe,".cmp]",":",Cc),Or=Ke.def(Pe,".ref|0"),un=Ke.def('"mask" in ',Pe,"?",Pe,".mask|0:-1");return[zt,Or,un]});case Ds:case Vo:return ft(function(ye){me.commandType(ye,"object",Qe,ge.commandStr);var Ke=ye.fail||"keep",Pe=ye.zfail||"keep",bt=ye.zpass||"keep";return me.commandParameter(Ke,Du,it+".fail",ge.commandStr),me.commandParameter(Pe,Du,it+".zfail",ge.commandStr),me.commandParameter(bt,Du,it+".zpass",ge.commandStr),[it===Vo?Sc:of,Du[Ke],Du[Pe],Du[bt]]},function(ye,Ke,Pe){var bt=ye.constants.stencilOps;me.optional(function(){ye.assert(Ke,Pe+"&&typeof "+Pe+'==="object"',"invalid "+it)});function zt(Or){return me.optional(function(){ye.assert(Ke,'!("'+Or+'" in '+Pe+")||("+Pe+"."+Or+" in "+bt+")","invalid "+it+"."+Or+", must be one of "+Object.keys(Du))}),Ke.def('"',Or,'" in ',Pe,"?",bt,"[",Pe,".",Or,"]:",Cc)}return[it===Vo?Sc:of,zt("fail"),zt("zfail"),zt("zpass")]});case ql:return ft(function(ye){me.commandType(ye,"object",Qe,ge.commandStr);var Ke=ye.factor|0,Pe=ye.units|0;return me.commandType(Ke,"number",Qe+".factor",ge.commandStr),me.commandType(Pe,"number",Qe+".units",ge.commandStr),[Ke,Pe]},function(ye,Ke,Pe){me.optional(function(){ye.assert(Ke,Pe+"&&typeof "+Pe+'==="object"',"invalid "+it)});var bt=Ke.def(Pe,".factor|0"),zt=Ke.def(Pe,".units|0");return[bt,zt]});case qu:return ft(function(ye){var Ke=0;return ye==="front"?Ke=of:ye==="back"&&(Ke=Sc),me.command(!!Ke,Qe,ge.commandStr),Ke},function(ye,Ke,Pe){return me.optional(function(){ye.assert(Ke,Pe+'==="front"||'+Pe+'==="back"',"invalid cull.face")}),Ke.def(Pe,'==="front"?',of,":",Sc)});case ml:return ft(function(ye){return me.command(typeof ye=="number"&&ye>=Ht.lineWidthDims[0]&&ye<=Ht.lineWidthDims[1],"invalid line width, must be a positive number between "+Ht.lineWidthDims[0]+" and "+Ht.lineWidthDims[1],ge.commandStr),ye},function(ye,Ke,Pe){return me.optional(function(){ye.assert(Ke,"typeof "+Pe+'==="number"&&'+Pe+">="+Ht.lineWidthDims[0]+"&&"+Pe+"<="+Ht.lineWidthDims[1],"invalid line width")}),Pe});case Ll:return ft(function(ye){return me.commandParameter(ye,Mp,Qe,ge.commandStr),Mp[ye]},function(ye,Ke,Pe){return me.optional(function(){ye.assert(Ke,Pe+'==="cw"||'+Pe+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Ke.def(Pe+'==="cw"?'+sf+":"+Sp)});case Co:return ft(function(ye){return me.command(Ji(ye)&&ye.length===4,"color.mask must be length 4 array",ge.commandStr),ye.map(function(Ke){return!!Ke})},function(ye,Ke,Pe){return me.optional(function(){ye.assert(Ke,ye.shared.isArrayLike+"("+Pe+")&&"+Pe+".length===4","invalid color.mask")}),Se(4,function(bt){return"!!"+Pe+"["+bt+"]"})});case Lu:return ft(function(ye){me.command(typeof ye=="object"&&ye,Qe,ge.commandStr);var Ke="value"in ye?ye.value:1,Pe=!!ye.invert;return me.command(typeof Ke=="number"&&Ke>=0&&Ke<=1,"sample.coverage.value must be a number between 0 and 1",ge.commandStr),[Ke,Pe]},function(ye,Ke,Pe){me.optional(function(){ye.assert(Ke,Pe+"&&typeof "+Pe+'==="object"',"invalid sample.coverage")});var bt=Ke.def('"value" in ',Pe,"?+",Pe,".value:1"),zt=Ke.def("!!",Pe,".invert");return[bt,zt]})}}),Yt}function Qi(Me,ge){var qe=Me.static,At=Me.dynamic,Yt={};return Object.keys(qe).forEach(function(it){var Qe=qe[it],ft;if(typeof Qe=="number"||typeof Qe=="boolean")ft=va(function(){return Qe});else if(typeof Qe=="function"){var ye=Qe._reglType;ye==="texture2d"||ye==="textureCube"?ft=va(function(Ke){return Ke.link(Qe)}):ye==="framebuffer"||ye==="framebufferCube"?(me.command(Qe.color.length>0,'missing color attachment for framebuffer sent to uniform "'+it+'"',ge.commandStr),ft=va(function(Ke){return Ke.link(Qe.color[0])})):me.commandRaise('invalid data for uniform "'+it+'"',ge.commandStr)}else Ji(Qe)?ft=va(function(Ke){var Pe=Ke.global.def("[",Se(Qe.length,function(bt){return me.command(typeof Qe[bt]=="number"||typeof Qe[bt]=="boolean","invalid uniform "+it,Ke.commandStr),Qe[bt]}),"]");return Pe}):me.commandRaise('invalid or missing data for uniform "'+it+'"',ge.commandStr);ft.value=Qe,Yt[it]=ft}),Object.keys(At).forEach(function(it){var Qe=At[it];Yt[it]=Zi(Qe,function(ft,ye){return ft.invoke(ye,Qe)})}),Yt}function es(Me,ge){var qe=Me.static,At=Me.dynamic,Yt={};return Object.keys(qe).forEach(function(it){var Qe=qe[it],ft=ue.id(it),ye=new Gt;if(Hh(Qe))ye.state=bi,ye.buffer=hr.getBuffer(hr.create(Qe,tf,!1,!0)),ye.type=0;else{var Ke=hr.getBuffer(Qe);if(Ke)ye.state=bi,ye.buffer=Ke,ye.type=0;else if(me.command(typeof Qe=="object"&&Qe,"invalid data for attribute "+it,ge.commandStr),"constant"in Qe){var Pe=Qe.constant;ye.buffer="null",ye.state=Oi,typeof Pe=="number"?ye.x=Pe:(me.command(Ji(Pe)&&Pe.length>0&&Pe.length<=4,"invalid constant for attribute "+it,ge.commandStr),hi.forEach(function(rn,Zn){Zn<Pe.length&&(ye[rn]=Pe[Zn])}))}else{Hh(Qe.buffer)?Ke=hr.getBuffer(hr.create(Qe.buffer,tf,!1,!0)):Ke=hr.getBuffer(Qe.buffer),me.command(!!Ke,'missing buffer for attribute "'+it+'"',ge.commandStr);var bt=Qe.offset|0;me.command(bt>=0,'invalid offset for attribute "'+it+'"',ge.commandStr);var zt=Qe.stride|0;me.command(zt>=0&&zt<256,'invalid stride for attribute "'+it+'", must be integer betweeen [0, 255]',ge.commandStr);var Or=Qe.size|0;me.command(!("size"in Qe)||Or>0&&Or<=4,'invalid size for attribute "'+it+'", must be 1,2,3,4',ge.commandStr);var un=!!Qe.normalized,ln=0;"type"in Qe&&(me.commandParameter(Qe.type,Yo,"invalid type for attribute "+it,ge.commandStr),ln=Yo[Qe.type]);var En=Qe.divisor|0;me.optional(function(){"divisor"in Qe&&(me.command(En===0||Br,'cannot specify divisor for attribute "'+it+'", instancing not supported',ge.commandStr),me.command(En>=0,'invalid divisor for attribute "'+it+'"',ge.commandStr));var rn=ge.commandStr,Zn=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Qe).forEach(function(Pn){me.command(Zn.indexOf(Pn)>=0,'unknown parameter "'+Pn+'" for attribute pointer "'+it+'" (valid parameters are '+Zn+")",rn)})}),ye.buffer=Ke,ye.state=bi,ye.size=Or,ye.normalized=un,ye.type=ln||Ke.dtype,ye.offset=bt,ye.stride=zt,ye.divisor=En}}Yt[it]=va(function(rn,Zn){var Pn=rn.attribCache;if(ft in Pn)return Pn[ft];var zn={isStream:!1};return Object.keys(ye).forEach(function(jn){zn[jn]=ye[jn]}),ye.buffer&&(zn.buffer=rn.link(ye.buffer),zn.type=zn.type||zn.buffer+".dtype"),Pn[ft]=zn,zn})}),Object.keys(At).forEach(function(it){var Qe=At[it];function ft(ye,Ke){var Pe=ye.invoke(Ke,Qe),bt=ye.shared,zt=ye.constants,Or=bt.isBufferArgs,un=bt.buffer;me.optional(function(){ye.assert(Ke,Pe+"&&(typeof "+Pe+'==="object"||typeof '+Pe+'==="function")&&('+Or+"("+Pe+")||"+un+".getBuffer("+Pe+")||"+un+".getBuffer("+Pe+".buffer)||"+Or+"("+Pe+'.buffer)||("constant" in '+Pe+"&&(typeof "+Pe+'.constant==="number"||'+bt.isArrayLike+"("+Pe+".constant))))",'invalid dynamic attribute "'+it+'"')});var ln={isStream:Ke.def(!1)},En=new Gt;En.state=bi,Object.keys(En).forEach(function(zn){ln[zn]=Ke.def(""+En[zn])});var rn=ln.buffer,Zn=ln.type;Ke("if(",Or,"(",Pe,")){",ln.isStream,"=true;",rn,"=",un,".createStream(",tf,",",Pe,");",Zn,"=",rn,".dtype;","}else{",rn,"=",un,".getBuffer(",Pe,");","if(",rn,"){",Zn,"=",rn,".dtype;",'}else if("constant" in ',Pe,"){",ln.state,"=",Oi,";","if(typeof "+Pe+'.constant === "number"){',ln[hi[0]],"=",Pe,".constant;",hi.slice(1).map(function(zn){return ln[zn]}).join("="),"=0;","}else{",hi.map(function(zn,jn){return ln[zn]+"="+Pe+".constant.length>"+jn+"?"+Pe+".constant["+jn+"]:0;"}).join(""),"}}else{","if(",Or,"(",Pe,".buffer)){",rn,"=",un,".createStream(",tf,",",Pe,".buffer);","}else{",rn,"=",un,".getBuffer(",Pe,".buffer);","}",Zn,'="type" in ',Pe,"?",zt.glTypes,"[",Pe,".type]:",rn,".dtype;",ln.normalized,"=!!",Pe,".normalized;");function Pn(zn){Ke(ln[zn],"=",Pe,".",zn,"|0;")}return Pn("size"),Pn("offset"),Pn("stride"),Pn("divisor"),Ke("}}"),Ke.exit("if(",ln.isStream,"){",un,".destroyStream(",rn,");","}"),ln}Yt[it]=Zi(Qe,ft)}),Yt}function Ha(Me){var ge=Me.static,qe=Me.dynamic,At={};return Object.keys(ge).forEach(function(Yt){var it=ge[Yt];At[Yt]=va(function(Qe,ft){return typeof it=="number"||typeof it=="boolean"?""+it:Qe.link(it)})}),Object.keys(qe).forEach(function(Yt){var it=qe[Yt];At[Yt]=Zi(it,function(Qe,ft){return Qe.invoke(ft,it)})}),At}function Ho(Me,ge,qe,At,Yt){var it=Me.static,Qe=Me.dynamic;me.optional(function(){var Pn=[Dl,mc,Ju,gl,Eu,Qo,Bs,zh,ef,Of].concat(qr);function zn(jn){Object.keys(jn).forEach(function(Vn){me.command(Pn.indexOf(Vn)>=0,'unknown parameter "'+Vn+'"',Yt.commandStr)})}zn(it),zn(Qe)});var ft=wi(Me,ge),ye=bn(Me,Yt),Ke=fi(Me,ye,Yt),Pe=$a(Me,Yt),bt=yo(Me,Yt),zt=qi(Me,Yt,ft);function Or(Pn){var zn=Ke[Pn];zn&&(bt[Pn]=zn)}Or($s),Or(tn(Go));var un=Object.keys(bt).length>0,ln={framebuffer:ye,draw:Pe,shader:zt,state:bt,dirty:un,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ln.profile=gn(Me,Yt),ln.uniforms=Qi(qe,Yt),ln.drawVAO=ln.scopeVAO=Pe.vao,!ln.drawVAO&&zt.program&&!ft&&He.angle_instanced_arrays&&Pe.static.elements){var En=!0,rn=zt.program.attributes.map(function(Pn){var zn=ge.static[Pn];return En=En&&!!zn,zn});if(En&&rn.length>0){var Zn=Vr.getVAO(Vr.createVAO({attributes:rn,elements:Pe.static.elements}));ln.drawVAO=new Jo(null,null,null,function(Pn,zn){return Pn.link(Zn)}),ln.useVAO=!0}}return ft?ln.useVAO=!0:ln.attributes=es(ge,Yt),ln.context=Ha(At,Yt),ln}function Lo(Me,ge,qe){var At=Me.shared,Yt=At.context,it=Me.scope();Object.keys(qe).forEach(function(Qe){ge.save(Yt,"."+Qe);var ft=qe[Qe],ye=ft.append(Me,ge);Array.isArray(ye)?it(Yt,".",Qe,"=[",ye.join(),"];"):it(Yt,".",Qe,"=",ye,";")}),ge(it)}function cs(Me,ge,qe,At){var Yt=Me.shared,it=Yt.gl,Qe=Yt.framebuffer,ft;Tn&&(ft=ge.def(Yt.extensions,".webgl_draw_buffers"));var ye=Me.constants,Ke=ye.drawBuffer,Pe=ye.backBuffer,bt;qe?bt=qe.append(Me,ge):bt=ge.def(Qe,".next"),At||ge("if(",bt,"!==",Qe,".cur){"),ge("if(",bt,"){",it,".bindFramebuffer(",dh,",",bt,".framebuffer);"),Tn&&ge(ft,".drawBuffersWEBGL(",Ke,"[",bt,".colorAttachments.length]);"),ge("}else{",it,".bindFramebuffer(",dh,",null);"),Tn&&ge(ft,".drawBuffersWEBGL(",Pe,");"),ge("}",Qe,".cur=",bt,";"),At||ge("}")}function fs(Me,ge,qe){var At=Me.shared,Yt=At.gl,it=Me.current,Qe=Me.next,ft=At.current,ye=At.next,Ke=Me.cond(ft,".dirty");qr.forEach(function(Pe){var bt=tn(Pe);if(!(bt in qe.state)){var zt,Or;if(bt in Qe){zt=Qe[bt],Or=it[bt];var un=Se(kn[bt].length,function(En){return Ke.def(zt,"[",En,"]")});Ke(Me.cond(un.map(function(En,rn){return En+"!=="+Or+"["+rn+"]"}).join("||")).then(Yt,".",ir[bt],"(",un,");",un.map(function(En,rn){return Or+"["+rn+"]="+En}).join(";"),";"))}else{zt=Ke.def(ye,".",bt);var ln=Me.cond(zt,"!==",ft,".",bt);Ke(ln),bt in yr?ln(Me.cond(zt).then(Yt,".enable(",yr[bt],");").else(Yt,".disable(",yr[bt],");"),ft,".",bt,"=",zt,";"):ln(Yt,".",ir[bt],"(",zt,");",ft,".",bt,"=",zt,";")}}}),Object.keys(qe.state).length===0&&Ke(ft,".dirty=false;"),ge(Ke)}function hs(Me,ge,qe,At){var Yt=Me.shared,it=Me.current,Qe=Yt.current,ft=Yt.gl;gd(Object.keys(qe)).forEach(function(ye){var Ke=qe[ye];if(!(At&&!At(Ke))){var Pe=Ke.append(Me,ge);if(yr[ye]){var bt=yr[ye];Fu(Ke)?Pe?ge(ft,".enable(",bt,");"):ge(ft,".disable(",bt,");"):ge(Me.cond(Pe).then(ft,".enable(",bt,");").else(ft,".disable(",bt,");")),ge(Qe,".",ye,"=",Pe,";")}else if(Ji(Pe)){var zt=it[ye];ge(ft,".",ir[ye],"(",Pe,");",Pe.map(function(Or,un){return zt+"["+un+"]="+Or}).join(";"),";")}else ge(ft,".",ir[ye],"(",Pe,");",Qe,".",ye,"=",Pe,";")}})}function io(Me,ge){Br&&(Me.instancing=ge.def(Me.shared.extensions,".angle_instanced_arrays"))}function zi(Me,ge,qe,At,Yt){var it=Me.shared,Qe=Me.stats,ft=it.current,ye=it.timer,Ke=qe.profile;function Pe(){var Pn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return Pn||typeof performance=="undefined"?"Date.now()":"performance.now()"}var bt,zt;function Or(Pn){bt=ge.def(),Pn(bt,"=",Pe(),";"),typeof Yt=="string"?Pn(Qe,".count+=",Yt,";"):Pn(Qe,".count++;"),on&&(At?(zt=ge.def(),Pn(zt,"=",ye,".getNumPendingQueries();")):Pn(ye,".beginQuery(",Qe,");"))}function un(Pn){Pn(Qe,".cpuTime+=",Pe(),"-",bt,";"),on&&(At?Pn(ye,".pushScopeStats(",zt,",",ye,".getNumPendingQueries(),",Qe,");"):Pn(ye,".endQuery();"))}function ln(Pn){var zn=ge.def(ft,".profile");ge(ft,".profile=",Pn,";"),ge.exit(ft,".profile=",zn,";")}var En;if(Ke){if(Fu(Ke)){Ke.enable?(Or(ge),un(ge.exit),ln("true")):ln("false");return}En=Ke.append(Me,ge),ln(En)}else En=ge.def(ft,".profile");var rn=Me.block();Or(rn),ge("if(",En,"){",rn,"}");var Zn=Me.block();un(Zn),ge.exit("if(",En,"){",Zn,"}")}function Wo(Me,ge,qe,At,Yt){var it=Me.shared;function Qe(ye){switch(ye){case yc:case Nf:case jh:return 2;case Ff:case rf:case af:return 3;case Bf:case xc:case hh:return 4;default:return 1}}function ft(ye,Ke,Pe){var bt=it.gl,zt=ge.def(ye,".location"),Or=ge.def(it.attributes,"[",zt,"]"),un=Pe.state,ln=Pe.buffer,En=[Pe.x,Pe.y,Pe.z,Pe.w],rn=["buffer","normalized","offset","stride"];function Zn(){ge("if(!",Or,".buffer){",bt,".enableVertexAttribArray(",zt,");}");var zn=Pe.type,jn;if(Pe.size?jn=ge.def(Pe.size,"||",Ke):jn=Ke,ge("if(",Or,".type!==",zn,"||",Or,".size!==",jn,"||",rn.map(function(pi){return Or+"."+pi+"!=="+Pe[pi]}).join("||"),"){",bt,".bindBuffer(",tf,",",ln,".buffer);",bt,".vertexAttribPointer(",[zt,jn,zn,Pe.normalized,Pe.stride,Pe.offset],");",Or,".type=",zn,";",Or,".size=",jn,";",rn.map(function(pi){return Or+"."+pi+"="+Pe[pi]+";"}).join(""),"}"),Br){var Vn=Pe.divisor;ge("if(",Or,".divisor!==",Vn,"){",Me.instancing,".vertexAttribDivisorANGLE(",[zt,Vn],");",Or,".divisor=",Vn,";}")}}function Pn(){ge("if(",Or,".buffer){",bt,".disableVertexAttribArray(",zt,");",Or,".buffer=null;","}if(",hi.map(function(zn,jn){return Or+"."+zn+"!=="+En[jn]}).join("||"),"){",bt,".vertexAttrib4f(",zt,",",En,");",hi.map(function(zn,jn){return Or+"."+zn+"="+En[jn]+";"}).join(""),"}")}un===bi?Zn():un===Oi?Pn():(ge("if(",un,"===",bi,"){"),Zn(),ge("}else{"),Pn(),ge("}"))}At.forEach(function(ye){var Ke=ye.name,Pe=qe.attributes[Ke],bt;if(Pe){if(!Yt(Pe))return;bt=Pe.append(Me,ge)}else{if(!Yt(go))return;var zt=Me.scopeAttrib(Ke);me.optional(function(){Me.assert(ge,zt+".state","missing attribute "+Ke)}),bt={},Object.keys(new Gt).forEach(function(Or){bt[Or]=ge.def(zt,".",Or)})}ft(Me.link(ye),Qe(ye.info.type),bt)})}function da(Me,ge,qe,At,Yt,it){for(var Qe=Me.shared,ft=Qe.gl,ye,Ke=0;Ke<At.length;++Ke){var Pe=At[Ke],bt=Pe.name,zt=Pe.info.type,Or=qe.uniforms[bt],un=Me.link(Pe),ln=un+".location",En;if(Or){if(!Yt(Or))continue;if(Fu(Or)){var rn=Or.value;if(me.command(rn!==null&&typeof rn!="undefined",'missing uniform "'+bt+'"',Me.commandStr),zt===ph||zt===zf){me.command(typeof rn=="function"&&(zt===ph&&(rn._reglType==="texture2d"||rn._reglType==="framebuffer")||zt===zf&&(rn._reglType==="textureCube"||rn._reglType==="framebufferCube")),"invalid texture for uniform "+bt,Me.commandStr);var Zn=Me.link(rn._texture||rn.color[0]._texture);ge(ft,".uniform1i(",ln,",",Zn+".bind());"),ge.exit(Zn,".unbind();")}else if(zt===bc||zt===Ec||zt===Js){me.optional(function(){me.command(Ji(rn),"invalid matrix for uniform "+bt,Me.commandStr),me.command(zt===bc&&rn.length===4||zt===Ec&&rn.length===9||zt===Js&&rn.length===16,"invalid length for matrix uniform "+bt,Me.commandStr)});var Pn=Me.global.def("new Float32Array(["+Array.prototype.slice.call(rn)+"])"),zn=2;zt===Ec?zn=3:zt===Js&&(zn=4),ge(ft,".uniformMatrix",zn,"fv(",ln,",false,",Pn,");")}else{switch(zt){case Df:me.commandType(rn,"number","uniform "+bt,Me.commandStr),ye="1f";break;case yc:me.command(Ji(rn)&&rn.length===2,"uniform "+bt,Me.commandStr),ye="2f";break;case Ff:me.command(Ji(rn)&&rn.length===3,"uniform "+bt,Me.commandStr),ye="3f";break;case Bf:me.command(Ji(rn)&&rn.length===4,"uniform "+bt,Me.commandStr),ye="4f";break;case nf:me.commandType(rn,"boolean","uniform "+bt,Me.commandStr),ye="1i";break;case _c:me.commandType(rn,"number","uniform "+bt,Me.commandStr),ye="1i";break;case jh:me.command(Ji(rn)&&rn.length===2,"uniform "+bt,Me.commandStr),ye="2i";break;case Nf:me.command(Ji(rn)&&rn.length===2,"uniform "+bt,Me.commandStr),ye="2i";break;case af:me.command(Ji(rn)&&rn.length===3,"uniform "+bt,Me.commandStr),ye="3i";break;case rf:me.command(Ji(rn)&&rn.length===3,"uniform "+bt,Me.commandStr),ye="3i";break;case hh:me.command(Ji(rn)&&rn.length===4,"uniform "+bt,Me.commandStr),ye="4i";break;case xc:me.command(Ji(rn)&&rn.length===4,"uniform "+bt,Me.commandStr),ye="4i";break}ge(ft,".uniform",ye,"(",ln,",",Ji(rn)?Array.prototype.slice.call(rn):rn,");")}continue}else En=Or.append(Me,ge)}else{if(!Yt(go))continue;En=ge.def(Qe.uniforms,"[",ue.id(bt),"]")}zt===ph?(me(!Array.isArray(En),"must specify a scalar prop for textures"),ge("if(",En,"&&",En,'._reglType==="framebuffer"){',En,"=",En,".color[0];","}")):zt===zf&&(me(!Array.isArray(En),"must specify a scalar prop for cube maps"),ge("if(",En,"&&",En,'._reglType==="framebufferCube"){',En,"=",En,".color[0];","}")),me.optional(function(){function ra(el,Rp){Me.assert(ge,el,'bad data or missing for uniform "'+bt+'".  '+Rp)}function bl(el){me(!Array.isArray(En),"must not specify an array type for uniform"),ra("typeof "+En+'==="'+el+'"',"invalid type, expected "+el)}function Bu(el,Rp){Array.isArray(En)?me(En.length===el,"must have length "+el):ra(Qe.isArrayLike+"("+En+")&&"+En+".length==="+el,"invalid vector, should have length "+el,Me.commandStr)}function Ip(el){me(!Array.isArray(En),"must not specify a value type"),ra("typeof "+En+'==="function"&&'+En+'._reglType==="texture'+(el===bp?"2d":"Cube")+'"',"invalid texture type",Me.commandStr)}switch(zt){case _c:bl("number");break;case Nf:Bu(2,"number");break;case rf:Bu(3,"number");break;case xc:Bu(4,"number");break;case Df:bl("number");break;case yc:Bu(2,"number");break;case Ff:Bu(3,"number");break;case Bf:Bu(4,"number");break;case nf:bl("boolean");break;case jh:Bu(2,"boolean");break;case af:Bu(3,"boolean");break;case hh:Bu(4,"boolean");break;case bc:Bu(4,"number");break;case Ec:Bu(9,"number");break;case Js:Bu(16,"number");break;case ph:Ip(bp);break;case zf:Ip(cv);break}});var jn=1;switch(zt){case ph:case zf:var Vn=ge.def(En,"._texture");ge(ft,".uniform1i(",ln,",",Vn,".bind());"),ge.exit(Vn,".unbind();");continue;case _c:case nf:ye="1i";break;case Nf:case jh:ye="2i",jn=2;break;case rf:case af:ye="3i",jn=3;break;case xc:case hh:ye="4i",jn=4;break;case Df:ye="1f";break;case yc:ye="2f",jn=2;break;case Ff:ye="3f",jn=3;break;case Bf:ye="4f",jn=4;break;case bc:ye="Matrix2fv";break;case Ec:ye="Matrix3fv";break;case Js:ye="Matrix4fv";break}if(ye.charAt(0)==="M"){ge(ft,".uniform",ye,"(",ln,",");var pi=Math.pow(zt-bc+2,2),ya=Me.global.def("new Float32Array(",pi,")");Array.isArray(En)?ge("false,(",Se(pi,function(ra){return ya+"["+ra+"]="+En[ra]}),",",ya,")"):ge("false,(Array.isArray(",En,")||",En," instanceof Float32Array)?",En,":(",Se(pi,function(ra){return ya+"["+ra+"]="+En+"["+ra+"]"}),",",ya,")"),ge(");")}else if(jn>1){for(var ts=[],Su=[],Fl=0;Fl<jn;++Fl)Array.isArray(En)?Su.push(En[Fl]):Su.push(ge.def(En+"["+Fl+"]")),it&&ts.push(ge.def());it&&ge("if(!",Me.batchId,"||",ts.map(function(ra,bl){return ra+"!=="+Su[bl]}).join("||"),"){",ts.map(function(ra,bl){return ra+"="+Su[bl]+";"}).join("")),ge(ft,".uniform",ye,"(",ln,",",Su.join(","),");"),it&&ge("}")}else{if(me(!Array.isArray(En),"uniform value must not be an array"),it){var La=ge.def();ge("if(!",Me.batchId,"||",La,"!==",En,"){",La,"=",En,";")}ge(ft,".uniform",ye,"(",ln,",",En,");"),it&&ge("}")}}}function Do(Me,ge,qe,At){var Yt=Me.shared,it=Yt.gl,Qe=Yt.draw,ft=At.draw;function ye(){var jn=ft.elements,Vn,pi=ge;return jn?((jn.contextDep&&At.contextDynamic||jn.propDep)&&(pi=qe),Vn=jn.append(Me,pi),ft.elementsActive&&pi("if("+Vn+")"+it+".bindBuffer("+xp+","+Vn+".buffer.buffer);")):(Vn=pi.def(),pi(Vn,"=",Qe,".",gl,";","if(",Vn,"){",it,".bindBuffer(",xp,",",Vn,".buffer.buffer);}","else if(",Yt.vao,".currentVAO){",Vn,"=",Me.shared.elements+".getElements("+Yt.vao,".currentVAO.elements);",cr?"":"if("+Vn+")"+it+".bindBuffer("+xp+","+Vn+".buffer.buffer);","}")),Vn}function Ke(){var jn=ft.count,Vn,pi=ge;return jn?((jn.contextDep&&At.contextDynamic||jn.propDep)&&(pi=qe),Vn=jn.append(Me,pi),me.optional(function(){jn.MISSING&&Me.assert(ge,"false","missing vertex count"),jn.DYNAMIC&&Me.assert(pi,Vn+">=0","missing vertex count")})):(Vn=pi.def(Qe,".",Bs),me.optional(function(){Me.assert(pi,Vn+">=0","missing vertex count")})),Vn}var Pe=ye();function bt(jn){var Vn=ft[jn];return Vn?Vn.contextDep&&At.contextDynamic||Vn.propDep?Vn.append(Me,qe):Vn.append(Me,ge):ge.def(Qe,".",jn)}var zt=bt(Eu),Or=bt(Qo),un=Ke();if(typeof un=="number"){if(un===0)return}else qe("if(",un,"){"),qe.exit("}");var ln,En;Br&&(ln=bt(zh),En=Me.instancing);var rn=Pe+".type",Zn=ft.elements&&Fu(ft.elements)&&!ft.vaoActive;function Pn(){function jn(){qe(En,".drawElementsInstancedANGLE(",[zt,un,rn,Or+"<<(("+rn+"-"+Rn+")>>1)",ln],");")}function Vn(){qe(En,".drawArraysInstancedANGLE(",[zt,Or,un,ln],");")}Pe&&Pe!=="null"?Zn?jn():(qe("if(",Pe,"){"),jn(),qe("}else{"),Vn(),qe("}")):Vn()}function zn(){function jn(){qe(it+".drawElements("+[zt,un,rn,Or+"<<(("+rn+"-"+Rn+")>>1)"]+");")}function Vn(){qe(it+".drawArrays("+[zt,Or,un]+");")}Pe&&Pe!=="null"?Zn?jn():(qe("if(",Pe,"){"),jn(),qe("}else{"),Vn(),qe("}")):Vn()}Br&&(typeof ln!="number"||ln>=0)?typeof ln=="string"?(qe("if(",ln,">0){"),Pn(),qe("}else if(",ln,"<0){"),zn(),qe("}")):Pn():zn()}function vi(Me,ge,qe,At,Yt){var it=Si(),Qe=it.proc("body",Yt);return me.optional(function(){it.commandStr=ge.commandStr,it.command=it.link(ge.commandStr)}),Br&&(it.instancing=Qe.def(it.shared.extensions,".angle_instanced_arrays")),Me(it,Qe,qe,At),it.compile().body}function Fi(Me,ge,qe,At){io(Me,ge),qe.useVAO?qe.drawVAO?ge(Me.shared.vao,".setVAO(",qe.drawVAO.append(Me,ge),");"):ge(Me.shared.vao,".setVAO(",Me.shared.vao,".targetVAO);"):(ge(Me.shared.vao,".setVAO(null);"),Wo(Me,ge,qe,At.attributes,function(){return!0})),da(Me,ge,qe,At.uniforms,function(){return!0},!1),Do(Me,ge,ge,qe)}function ka(Me,ge){var qe=Me.proc("draw",1);io(Me,qe),Lo(Me,qe,ge.context),cs(Me,qe,ge.framebuffer),fs(Me,qe,ge),hs(Me,qe,ge.state),zi(Me,qe,ge,!1,!0);var At=ge.shader.progVar.append(Me,qe);if(qe(Me.shared.gl,".useProgram(",At,".program);"),ge.shader.program)Fi(Me,qe,ge,ge.shader.program);else{qe(Me.shared.vao,".setVAO(null);");var Yt=Me.global.def("{}"),it=qe.def(At,".id"),Qe=qe.def(Yt,"[",it,"]");qe(Me.cond(Qe).then(Qe,".call(this,a0);").else(Qe,"=",Yt,"[",it,"]=",Me.link(function(ft){return vi(Fi,Me,ge,ft,1)}),"(",At,");",Qe,".call(this,a0);"))}Object.keys(ge.state).length>0&&qe(Me.shared.current,".dirty=true;"),Me.shared.vao&&qe(Me.shared.vao,".setVAO(null);")}function Ns(Me,ge,qe,At){Me.batchId="a1",io(Me,ge);function Yt(){return!0}Wo(Me,ge,qe,At.attributes,Yt),da(Me,ge,qe,At.uniforms,Yt,!1),Do(Me,ge,ge,qe)}function Ss(Me,ge,qe,At){io(Me,ge);var Yt=qe.contextDep,it=ge.def(),Qe="a0",ft="a1",ye=ge.def();Me.shared.props=ye,Me.batchId=it;var Ke=Me.scope(),Pe=Me.scope();ge(Ke.entry,"for(",it,"=0;",it,"<",ft,";++",it,"){",ye,"=",Qe,"[",it,"];",Pe,"}",Ke.exit);function bt(rn){return rn.contextDep&&Yt||rn.propDep}function zt(rn){return!bt(rn)}if(qe.needsContext&&Lo(Me,Pe,qe.context),qe.needsFramebuffer&&cs(Me,Pe,qe.framebuffer),hs(Me,Pe,qe.state,bt),qe.profile&&bt(qe.profile)&&zi(Me,Pe,qe,!1,!0),At)qe.useVAO?qe.drawVAO?bt(qe.drawVAO)?Pe(Me.shared.vao,".setVAO(",qe.drawVAO.append(Me,Pe),");"):Ke(Me.shared.vao,".setVAO(",qe.drawVAO.append(Me,Ke),");"):Ke(Me.shared.vao,".setVAO(",Me.shared.vao,".targetVAO);"):(Ke(Me.shared.vao,".setVAO(null);"),Wo(Me,Ke,qe,At.attributes,zt),Wo(Me,Pe,qe,At.attributes,bt)),da(Me,Ke,qe,At.uniforms,zt,!1),da(Me,Pe,qe,At.uniforms,bt,!0),Do(Me,Ke,Pe,qe);else{var Or=Me.global.def("{}"),un=qe.shader.progVar.append(Me,Pe),ln=Pe.def(un,".id"),En=Pe.def(Or,"[",ln,"]");Pe(Me.shared.gl,".useProgram(",un,".program);","if(!",En,"){",En,"=",Or,"[",ln,"]=",Me.link(function(rn){return vi(Ns,Me,qe,rn,2)}),"(",un,");}",En,".call(this,a0[",it,"],",it,");")}}function Fe(Me,ge){var qe=Me.proc("batch",2);Me.batchId="0",io(Me,qe);var At=!1,Yt=!0;Object.keys(ge.context).forEach(function(Or){At=At||ge.context[Or].propDep}),At||(Lo(Me,qe,ge.context),Yt=!1);var it=ge.framebuffer,Qe=!1;it?(it.propDep?At=Qe=!0:it.contextDep&&At&&(Qe=!0),Qe||cs(Me,qe,it)):cs(Me,qe,null),ge.state.viewport&&ge.state.viewport.propDep&&(At=!0);function ft(Or){return Or.contextDep&&At||Or.propDep}fs(Me,qe,ge),hs(Me,qe,ge.state,function(Or){return!ft(Or)}),(!ge.profile||!ft(ge.profile))&&zi(Me,qe,ge,!1,"a1"),ge.contextDep=At,ge.needsContext=Yt,ge.needsFramebuffer=Qe;var ye=ge.shader.progVar;if(ye.contextDep&&At||ye.propDep)Ss(Me,qe,ge,null);else{var Ke=ye.append(Me,qe);if(qe(Me.shared.gl,".useProgram(",Ke,".program);"),ge.shader.program)Ss(Me,qe,ge,ge.shader.program);else{qe(Me.shared.vao,".setVAO(null);");var Pe=Me.global.def("{}"),bt=qe.def(Ke,".id"),zt=qe.def(Pe,"[",bt,"]");qe(Me.cond(zt).then(zt,".call(this,a0,a1);").else(zt,"=",Pe,"[",bt,"]=",Me.link(function(Or){return vi(Ss,Me,ge,Or,2)}),"(",Ke,");",zt,".call(this,a0,a1);"))}}Object.keys(ge.state).length>0&&qe(Me.shared.current,".dirty=true;"),Me.shared.vao&&qe(Me.shared.vao,".setVAO(null);")}function er(Me,ge){var qe=Me.proc("scope",3);Me.batchId="a2";var At=Me.shared,Yt=At.current;Lo(Me,qe,ge.context),ge.framebuffer&&ge.framebuffer.append(Me,qe),gd(Object.keys(ge.state)).forEach(function(Qe){var ft=ge.state[Qe],ye=ft.append(Me,qe);Ji(ye)?ye.forEach(function(Ke,Pe){qe.set(Me.next[Qe],"["+Pe+"]",Ke)}):qe.set(At.next,"."+Qe,ye)}),zi(Me,qe,ge,!0,!0),[gl,Qo,Bs,zh,Eu].forEach(function(Qe){var ft=ge.draw[Qe];!ft||qe.set(At.draw,"."+Qe,""+ft.append(Me,qe))}),Object.keys(ge.uniforms).forEach(function(Qe){var ft=ge.uniforms[Qe].append(Me,qe);Array.isArray(ft)&&(ft="["+ft.join()+"]"),qe.set(At.uniforms,"["+ue.id(Qe)+"]",ft)}),Object.keys(ge.attributes).forEach(function(Qe){var ft=ge.attributes[Qe].append(Me,qe),ye=Me.scopeAttrib(Qe);Object.keys(new Gt).forEach(function(Ke){qe.set(ye,"."+Ke,ft[Ke])})}),ge.scopeVAO&&qe.set(At.vao,".targetVAO",ge.scopeVAO.append(Me,qe));function it(Qe){var ft=ge.shader[Qe];ft&&qe.set(At.shader,"."+Qe,ft.append(Me,qe))}it(mc),it(Ju),Object.keys(ge.state).length>0&&(qe(Yt,".dirty=true;"),qe.exit(Yt,".dirty=true;")),qe("a1(",Me.shared.context,",a0,",Me.batchId,");")}function Lt(Me){if(!(typeof Me!="object"||Ji(Me))){for(var ge=Object.keys(Me),qe=0;qe<ge.length;++qe)if(Xn.isDynamic(Me[ge[qe]]))return!0;return!1}}function On(Me,ge,qe){var At=ge.static[qe];if(!At||!Lt(At))return;var Yt=Me.global,it=Object.keys(At),Qe=!1,ft=!1,ye=!1,Ke=Me.global.def("{}");it.forEach(function(bt){var zt=At[bt];if(Xn.isDynamic(zt)){typeof zt=="function"&&(zt=At[bt]=Xn.unbox(zt));var Or=Zi(zt,null);Qe=Qe||Or.thisDep,ye=ye||Or.propDep,ft=ft||Or.contextDep}else{switch(Yt(Ke,".",bt,"="),typeof zt){case"number":Yt(zt);break;case"string":Yt('"',zt,'"');break;case"object":Array.isArray(zt)&&Yt("[",zt.join(),"]");break;default:Yt(Me.link(zt));break}Yt(";")}});function Pe(bt,zt){it.forEach(function(Or){var un=At[Or];if(!!Xn.isDynamic(un)){var ln=bt.invoke(zt,un);zt(Ke,".",Or,"=",ln,";")}})}ge.dynamic[qe]=new Xn.DynamicVariable($i,{thisDep:Qe,contextDep:ft,propDep:ye,ref:Ke,append:Pe}),delete ge.static[qe]}function Vi(Me,ge,qe,At,Yt){var it=Si();it.stats=it.link(Yt),Object.keys(ge.static).forEach(function(ft){On(it,ge,ft)}),kf.forEach(function(ft){On(it,Me,ft)});var Qe=Ho(Me,ge,qe,At,it);return ka(it,Qe),er(it,Qe),Fe(it,Qe),H(it.compile(),{destroy:function(){Qe.shader.program.destroy()}})}return{next:Mn,current:kn,procs:function(){var Me=Si(),ge=Me.proc("poll"),qe=Me.proc("refresh"),At=Me.block();ge(At),qe(At);var Yt=Me.shared,it=Yt.gl,Qe=Yt.next,ft=Yt.current;At(ft,".dirty=false;"),cs(Me,ge),cs(Me,qe,null,!0);var ye;Br&&(ye=Me.link(Br)),He.oes_vertex_array_object&&qe(Me.link(He.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Ke=0;Ke<Ht.maxAttributes;++Ke){var Pe=qe.def(Yt.attributes,"[",Ke,"]"),bt=Me.cond(Pe,".buffer");bt.then(it,".enableVertexAttribArray(",Ke,");",it,".bindBuffer(",tf,",",Pe,".buffer.buffer);",it,".vertexAttribPointer(",Ke,",",Pe,".size,",Pe,".type,",Pe,".normalized,",Pe,".stride,",Pe,".offset);").else(it,".disableVertexAttribArray(",Ke,");",it,".vertexAttrib4f(",Ke,",",Pe,".x,",Pe,".y,",Pe,".z,",Pe,".w);",Pe,".buffer=null;"),qe(bt),Br&&qe(ye,".vertexAttribDivisorANGLE(",Ke,",",Pe,".divisor);")}return qe(Me.shared.vao,".currentVAO=null;",Me.shared.vao,".setVAO(",Me.shared.vao,".targetVAO);"),Object.keys(yr).forEach(function(zt){var Or=yr[zt],un=At.def(Qe,".",zt),ln=Me.block();ln("if(",un,"){",it,".enable(",Or,")}else{",it,".disable(",Or,")}",ft,".",zt,"=",un,";"),qe(ln),ge("if(",un,"!==",ft,".",zt,"){",ln,"}")}),Object.keys(ir).forEach(function(zt){var Or=ir[zt],un=kn[zt],ln,En,rn=Me.block();if(rn(it,".",Or,"("),Ji(un)){var Zn=un.length;ln=Me.global.def(Qe,".",zt),En=Me.global.def(ft,".",zt),rn(Se(Zn,function(Pn){return ln+"["+Pn+"]"}),");",Se(Zn,function(Pn){return En+"["+Pn+"]="+ln+"["+Pn+"];"}).join("")),ge("if(",Se(Zn,function(Pn){return ln+"["+Pn+"]!=="+En+"["+Pn+"]"}).join("||"),"){",rn,"}")}else ln=At.def(Qe,".",zt),En=At.def(ft,".",zt),rn(ln,");",ft,".",zt,"=",ln,";"),ge("if(",ln,"!==",En,"){",rn,"}");qe(rn)}),Me.compile()}(),compile:Vi}}function dm(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var yd=34918,vm=34919,dv=35007,vv=function(ue,He){if(!He.ext_disjoint_timer_query)return null;var Ht=[];function hr(){return Ht.pop()||He.ext_disjoint_timer_query.createQueryEXT()}function ar(Tn){Ht.push(Tn)}var Jt=[];function Pr(Tn){var cr=hr();He.ext_disjoint_timer_query.beginQueryEXT(dv,cr),Jt.push(cr),zr(Jt.length-1,Jt.length,Tn)}function jr(){He.ext_disjoint_timer_query.endQueryEXT(dv)}function Vr(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Yr=[];function Wr(){return Yr.pop()||new Vr}function pn(Tn){Yr.push(Tn)}var on=[];function zr(Tn,cr,kn){var Mn=Wr();Mn.startQueryIndex=Tn,Mn.endQueryIndex=cr,Mn.sum=0,Mn.stats=kn,on.push(Mn)}var Gt=[],Wt=[];function Br(){var Tn,cr,kn=Jt.length;if(kn!==0){Wt.length=Math.max(Wt.length,kn+1),Gt.length=Math.max(Gt.length,kn+1),Gt[0]=0,Wt[0]=0;var Mn=0;for(Tn=0,cr=0;cr<Jt.length;++cr){var qr=Jt[cr];He.ext_disjoint_timer_query.getQueryObjectEXT(qr,vm)?(Mn+=He.ext_disjoint_timer_query.getQueryObjectEXT(qr,yd),ar(qr)):Jt[Tn++]=qr,Gt[cr+1]=Mn,Wt[cr+1]=Tn}for(Jt.length=Tn,Tn=0,cr=0;cr<on.length;++cr){var yr=on[cr],ir=yr.startQueryIndex,tn=yr.endQueryIndex;yr.sum+=Gt[tn]-Gt[ir];var sn=Wt[ir],Zr=Wt[tn];Zr===sn?(yr.stats.gpuTime+=yr.sum/1e6,pn(yr)):(yr.startQueryIndex=sn,yr.endQueryIndex=Zr,on[Tn++]=yr)}on.length=Tn}}return{beginQuery:Pr,endQuery:jr,pushScopeStats:zr,update:Br,getNumPendingQueries:function(){return Jt.length},clear:function(){Ht.push.apply(Ht,Jt);for(var cr=0;cr<Ht.length;cr++)He.ext_disjoint_timer_query.deleteQueryEXT(Ht[cr]);Jt.length=0,Ht.length=0},restore:function(){Jt.length=0,Ht.length=0}}},_d=16384,mv=256,gv=1024,vh=34962,Pp="webglcontextlost",Op="webglcontextrestored",mh=1,Na=2,xd=3;function xl(K,ue){for(var He=0;He<K.length;++He)if(K[He]===ue)return He;return-1}function jf(K){var ue=J(K);if(!ue)return null;var He=ue.gl,Ht=He.getContextAttributes(),hr=He.isContextLost(),ar=pe(He,ue);if(!ar)return null;var Jt=No(),Pr=dm(),jr=ar.extensions,Vr=vv(He,jr),Yr=Yi(),Wr=He.drawingBufferWidth,pn=He.drawingBufferHeight,on={tick:0,time:0,viewportWidth:Wr,viewportHeight:pn,framebufferWidth:Wr,framebufferHeight:pn,drawingBufferWidth:Wr,drawingBufferHeight:pn,pixelRatio:ue.pixelRatio},zr={},Gt={elements:null,primitive:4,count:-1,offset:0,instances:-1},Wt=Io(He,jr),Br=V(He,Pr,ue,kn),Tn=Tl(He,jr,Br,Pr),cr=Ge(He,jr,Wt,Pr,Br,Tn,Gt);function kn(vi){return cr.destroyBuffer(vi)}var Mn=lr(He,Jt,Pr,ue),qr=kl(He,jr,Wt,function(){tn.procs.poll()},on,Pr,ue),yr=qo(He,jr,Wt,Pr,ue),ir=ve(He,jr,Wt,qr,yr,Pr),tn=Ac(He,Jt,jr,Wt,Br,Tn,qr,ir,zr,cr,Mn,Gt,on,Vr,ue),sn=Un(He,ir,tn.procs.poll,on,Ht,jr,Wt),Zr=tn.next,dn=He.canvas,fn=[],Ii=[],Si=[],gn=[ue.onDestroy],bn=null;function fi(){if(fn.length===0){Vr&&Vr.update(),bn=null;return}bn=ci.next(fi),io();for(var vi=fn.length-1;vi>=0;--vi){var Fi=fn[vi];Fi&&Fi(on,null,0)}He.flush(),Vr&&Vr.update()}function wi(){!bn&&fn.length>0&&(bn=ci.next(fi))}function qi(){bn&&(ci.cancel(fi),bn=null)}function $a(vi){vi.preventDefault(),hr=!0,qi(),Ii.forEach(function(Fi){Fi()})}function yo(vi){He.getError(),hr=!1,ar.restore(),Mn.restore(),Br.restore(),qr.restore(),yr.restore(),ir.restore(),cr.restore(),Vr&&Vr.restore(),tn.procs.refresh(),wi(),Si.forEach(function(Fi){Fi()})}var Qi=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;!Qi&&dn&&(dn.addEventListener(Pp,$a,!1),dn.addEventListener(Op,yo,!1));function es(){fn.length=0,qi(),!Qi&&dn&&(dn.removeEventListener(Pp,$a),dn.removeEventListener(Op,yo)),Mn.clear(),ir.clear(),yr.clear(),cr.clear(),qr.clear(),Tn.clear(),Br.clear(),Vr&&Vr.clear(),gn.forEach(function(vi){vi()})}function Ha(vi){me(!!vi,"invalid args to regl({...})"),me.type(vi,"object","invalid args to regl({...})");function Fi(it){var Qe=H({},it);delete Qe.uniforms,delete Qe.attributes,delete Qe.context,delete Qe.vao,"stencil"in Qe&&Qe.stencil.op&&(Qe.stencil.opBack=Qe.stencil.opFront=Qe.stencil.op,delete Qe.stencil.op);function ft(ye){if(ye in Qe){var Ke=Qe[ye];delete Qe[ye],Object.keys(Ke).forEach(function(Pe){Qe[ye+"."+Pe]=Ke[Pe]})}}return ft("blend"),ft("depth"),ft("cull"),ft("stencil"),ft("polygonOffset"),ft("scissor"),ft("sample"),"vao"in it&&(Qe.vao=it.vao),Qe}function ka(it,Qe){var ft={},ye={};return Object.keys(it).forEach(function(Ke){var Pe=it[Ke];if(Xn.isDynamic(Pe)){ye[Ke]=Xn.unbox(Pe,Ke);return}else if(Qe&&Array.isArray(Pe)){for(var bt=0;bt<Pe.length;++bt)if(Xn.isDynamic(Pe[bt])){ye[Ke]=Xn.unbox(Pe,Ke);return}}ft[Ke]=Pe}),{dynamic:ye,static:ft}}var Ns=ka(vi.context||{},!0),Ss=ka(vi.uniforms||{},!0),Fe=ka(vi.attributes||{},!1),er=ka(Fi(vi),!1),Lt={gpuTime:0,cpuTime:0,count:0},On=tn.compile(er,Fe,Ss,Ns,Lt),Vi=On.draw,Me=On.batch,ge=On.scope,qe=[];function At(it){for(;qe.length<it;)qe.push(null);return qe}function Yt(it,Qe){var ft;if(hr&&me.raise("context lost"),typeof it=="function")return ge.call(this,null,it,0);if(typeof Qe=="function")if(typeof it=="number")for(ft=0;ft<it;++ft)ge.call(this,null,Qe,ft);else if(Array.isArray(it))for(ft=0;ft<it.length;++ft)ge.call(this,it[ft],Qe,ft);else return ge.call(this,it,Qe,0);else if(typeof it=="number"){if(it>0)return Me.call(this,At(it|0),it|0)}else if(Array.isArray(it)){if(it.length)return Me.call(this,it,it.length)}else return Vi.call(this,it)}return H(Yt,{stats:Lt,destroy:function(){On.destroy()}})}var Ho=ir.setFBO=Ha({framebuffer:Xn.define.call(null,mh,"framebuffer")});function Lo(vi,Fi){var ka=0;tn.procs.poll();var Ns=Fi.color;Ns&&(He.clearColor(+Ns[0]||0,+Ns[1]||0,+Ns[2]||0,+Ns[3]||0),ka|=_d),"depth"in Fi&&(He.clearDepth(+Fi.depth),ka|=mv),"stencil"in Fi&&(He.clearStencil(Fi.stencil|0),ka|=gv),me(!!ka,"called regl.clear with no buffer specified"),He.clear(ka)}function cs(vi){if(me(typeof vi=="object"&&vi,"regl.clear() takes an object as input"),"framebuffer"in vi)if(vi.framebuffer&&vi.framebuffer_reglType==="framebufferCube")for(var Fi=0;Fi<6;++Fi)Ho(H({framebuffer:vi.framebuffer.faces[Fi]},vi),Lo);else Ho(vi,Lo);else Lo(null,vi)}function fs(vi){me.type(vi,"function","regl.frame() callback must be a function"),fn.push(vi);function Fi(){var ka=xl(fn,vi);me(ka>=0,"cannot cancel a frame twice");function Ns(){var Ss=xl(fn,Ns);fn[Ss]=fn[fn.length-1],fn.length-=1,fn.length<=0&&qi()}fn[ka]=Ns}return wi(),{cancel:Fi}}function hs(){var vi=Zr.viewport,Fi=Zr.scissor_box;vi[0]=vi[1]=Fi[0]=Fi[1]=0,on.viewportWidth=on.framebufferWidth=on.drawingBufferWidth=vi[2]=Fi[2]=He.drawingBufferWidth,on.viewportHeight=on.framebufferHeight=on.drawingBufferHeight=vi[3]=Fi[3]=He.drawingBufferHeight}function io(){on.tick+=1,on.time=Wo(),hs(),tn.procs.poll()}function zi(){qr.refresh(),hs(),tn.procs.refresh(),Vr&&Vr.update()}function Wo(){return(Yi()-Yr)/1e3}zi();function da(vi,Fi){me.type(Fi,"function","listener callback must be a function");var ka;switch(vi){case"frame":return fs(Fi);case"lost":ka=Ii;break;case"restore":ka=Si;break;case"destroy":ka=gn;break;default:me.raise("invalid event, must be one of frame,lost,restore,destroy")}return ka.push(Fi),{cancel:function(){for(var Ss=0;Ss<ka.length;++Ss)if(ka[Ss]===Fi){ka[Ss]=ka[ka.length-1],ka.pop();return}}}}var Do=H(Ha,{clear:cs,prop:Xn.define.bind(null,mh),context:Xn.define.bind(null,Na),this:Xn.define.bind(null,xd),draw:Ha({}),buffer:function(Fi){return Br.create(Fi,vh,!1,!1)},elements:function(Fi){return Tn.create(Fi,!1)},texture:qr.create2D,cube:qr.createCube,renderbuffer:yr.create,framebuffer:ir.create,framebufferCube:ir.createCube,vao:cr.createVAO,attributes:Ht,frame:fs,on:da,limits:Wt,hasExtension:function(Fi){return Wt.extensions.indexOf(Fi.toLowerCase())>=0},read:sn,destroy:es,_gl:He,_refresh:zi,poll:function(){io(),Vr&&Vr.update()},now:Wo,stats:Pr});return ue.onDone(null,Do),Do}return jf})},Sk89:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.postConstruct=void 0;var N=w("MON2"),G=w("xfSm"),H=w("GXnB");function B(){return function(h,z,U){var Q=new H.Metadata(G.POST_CONSTRUCT,z);if(Reflect.hasOwnMetadata(G.POST_CONSTRUCT,h.constructor))throw new Error(N.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(G.POST_CONSTRUCT,Q,h.constructor)}}Z.postConstruct=B},SksO:function(ae,Z){function w(N,G){return ae.exports=w=Object.setPrototypeOf||function(B,h){return B.__proto__=h,B},ae.exports.__esModule=!0,ae.exports.default=ae.exports,w(N,G)}ae.exports=w,ae.exports.__esModule=!0,ae.exports.default=ae.exports},Sq3C:function(ae,Z,w){var N=w("sKgW"),G=w("zoYe"),H=w("wy8a"),B=w("quyA"),h=w("Z1HP"),z=w("Em2t"),U=Math.ceil;function Q(se,Ce){Ce=Ce===void 0?" ":G(Ce);var be=Ce.length;if(be<2)return be?N(Ce,se):Ce;var st=N(Ce,U(se/h(Ce)));return B(Ce)?H(z(st),0,se).join(""):st.slice(0,se)}ae.exports=Q},Sxd8:function(ae,Z,w){var N=w("ZCgT");function G(H){var B=N(H),h=B%1;return B===B?h?B-h:B:0}ae.exports=G},T1AV:function(ae,Z,w){var N=w("t2Dn"),G=w("5Tg0"),H=w("yP5f"),B=w("Q1l4"),h=w("+iFO"),z=w("03A+"),U=w("Z0cm"),Q=w("3L66"),se=w("DSRE"),Ce=w("lSCD"),be=w("GoyQ"),st=w("YO3V"),tt=w("c6wG"),ut=w("itsj"),ht=w("jeLo");function gt(Be,dt,rt,lt,$,Qt,Ir){var br=ut(Be,rt),Rt=ut(dt,rt),ke=Ir.get(Rt);if(ke){N(Be,rt,ke);return}var Mt=Qt?Qt(br,Rt,rt+"",Be,dt,Ir):void 0,Nt=Mt===void 0;if(Nt){var nr=U(Rt),Mr=!nr&&se(Rt),Jr=!nr&&!Mr&&tt(Rt);Mt=Rt,nr||Mr||Jr?U(br)?Mt=br:Q(br)?Mt=B(br):Mr?(Nt=!1,Mt=G(Rt,!0)):Jr?(Nt=!1,Mt=H(Rt,!0)):Mt=[]:st(Rt)||z(Rt)?(Mt=br,z(br)?Mt=ht(br):(!be(br)||Ce(br))&&(Mt=h(Rt))):Nt=!1}Nt&&(Ir.set(Rt,Mt),$(Mt,Rt,lt,Qt,Ir),Ir.delete(Rt)),N(Be,rt,Mt)}ae.exports=gt},TIQr:function(ae,Z,w){"use strict";ae.exports=G,ae.exports.default=G;var N=1e20;function G(U,Q,se,Ce,be,st){this.fontSize=U||24,this.buffer=Q===void 0?3:Q,this.cutoff=Ce||.25,this.fontFamily=be||"sans-serif",this.fontWeight=st||"normal",this.radius=se||8;var tt=this.size=this.fontSize+this.buffer*2,ut=tt+this.buffer*2,ht=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;ht?this.canvas=my.createOffscreenCanvas(tt,tt,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=tt),this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(ut*ut),this.gridInner=new Float64Array(ut*ut),this.f=new Float64Array(ut),this.z=new Float64Array(ut+1),this.v=new Uint16Array(ut),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,ht?this.middle=Math.round(tt/2*1):this.middle=Math.round(tt/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function H(U,Q,se,Ce,be,st,tt){st.fill(N,0,Q*se),tt.fill(0,0,Q*se);for(var ut=(Q-Ce)/2,ht=0;ht<be;ht++)for(var gt=0;gt<Ce;gt++){var Be=(ht+ut)*Q+gt+ut,dt=U.data[4*(ht*Ce+gt)+3]/255;if(dt===1)st[Be]=0,tt[Be]=N;else if(dt===0)st[Be]=N,tt[Be]=0;else{var rt=Math.max(0,.5-dt),lt=Math.max(0,dt-.5);st[Be]=rt*rt,tt[Be]=lt*lt}}}function B(U,Q,se,Ce,be,st,tt){for(var ut=0;ut<Q*se;ut++){var ht=Math.sqrt(Ce[ut])-Math.sqrt(be[ut]);U[ut]=Math.round(255-255*(ht/st+tt))}}G.prototype._draw=function(U,Q){var se=this.ctx.measureText(U),Ce=se.width,be=2*this.buffer,st,tt,ut,ht,gt,Be,dt,rt;Q&&this.useMetrics?(gt=Math.floor(se.actualBoundingBoxAscent),rt=this.buffer+Math.ceil(se.actualBoundingBoxAscent),Be=this.buffer,dt=this.buffer,tt=Math.min(this.size,Math.ceil(se.actualBoundingBoxRight-se.actualBoundingBoxLeft)),ht=Math.min(this.size-Be,Math.ceil(se.actualBoundingBoxAscent+se.actualBoundingBoxDescent)),st=tt+be,ut=ht+be,this.ctx.textBaseline="alphabetic"):(st=tt=this.size,ut=ht=this.size,gt=19*this.fontSize/24,Be=dt=0,rt=this.middle,this.ctx.textBaseline="middle");var lt;tt&&ht&&(this.ctx.clearRect(dt,Be,tt,ht),this.ctx.fillText(U,this.buffer,rt),lt=this.ctx.getImageData(dt,Be,tt,ht));var $=new Uint8ClampedArray(st*ut);return H(lt,st,ut,tt,ht,this.gridOuter,this.gridInner),h(this.gridOuter,st,ut,this.f,this.v,this.z),h(this.gridInner,st,ut,this.f,this.v,this.z),B($,st,ut,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:$,metrics:{width:tt,height:ht,sdfWidth:st,sdfHeight:ut,top:gt,left:0,advance:Ce}}},G.prototype.draw=function(U){return this._draw(U,!1).data},G.prototype.drawWithMetrics=function(U){return this._draw(U,!0)};function h(U,Q,se,Ce,be,st){for(var tt=0;tt<Q;tt++)z(U,tt,Q,se,Ce,be,st);for(var ut=0;ut<se;ut++)z(U,ut*Q,1,Q,Ce,be,st)}function z(U,Q,se,Ce,be,st,tt){var ut,ht,gt,Be;for(st[0]=0,tt[0]=-N,tt[1]=N,ut=0;ut<Ce;ut++)be[ut]=U[Q+ut*se];for(ut=1,ht=0,gt=0;ut<Ce;ut++){do Be=st[ht],gt=(be[ut]-be[Be]+ut*ut-Be*Be)/(ut-Be)/2;while(gt<=tt[ht]&&--ht>-1);ht++,st[ht]=ut,tt[ht]=gt,tt[ht+1]=N}for(ut=0,ht=0;ut<Ce;ut++){for(;tt[ht+1]<ut;)ht++;Be=st[ht],U[Q+ut*se]=be[Be]+(ut-Be)*(ut-Be)}}},TKrE:function(ae,Z,w){var N=w("qRkn"),G=w("dt0z"),H=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,B="\\u0300-\\u036f",h="\\ufe20-\\ufe2f",z="\\u20d0-\\u20ff",U=B+h+z,Q="["+U+"]",se=RegExp(Q,"g");function Ce(be){return be=G(be),be&&be.replace(H,N).replace(se,"")}ae.exports=Ce},"U+yc":function(ae,Z){function w(N,G,H,B,h){var z={};return Object.keys(B).forEach(function(U){z[U]=B[U]}),z.enumerable=!!z.enumerable,z.configurable=!!z.configurable,("value"in z||z.initializer)&&(z.writable=!0),z=H.slice().reverse().reduce(function(U,Q){return Q(N,G,U)||U},z),h&&z.initializer!==void 0&&(z.value=z.initializer?z.initializer.call(h):void 0,z.initializer=void 0),z.initializer===void 0&&(Object.defineProperty(N,G,z),z=null),z}ae.exports=w,ae.exports.__esModule=!0,ae.exports.default=ae.exports},UB5X:function(ae,Z,w){var N=w("NykK"),G=w("ExA7"),H="[object Number]";function B(h){return typeof h=="number"||G(h)&&N(h)==H}ae.exports=B},Ucsi:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0});var N=Symbol.for("INJECTION");function G(U,Q,se,Ce){function be(){return Ce&&!Reflect.hasMetadata(N,this,Q)&&Reflect.defineMetadata(N,se(),this,Q),Reflect.hasMetadata(N,this,Q)?Reflect.getMetadata(N,this,Q):se()}function st(tt){Reflect.defineMetadata(N,tt,this,Q)}Object.defineProperty(U,Q,{configurable:!0,enumerable:!0,get:be,set:st})}function H(U,Q){return function(se){return function(Ce,be){var st=function(){return U.get(se)};G(Ce,be,st,Q)}}}Z.makePropertyInjectDecorator=H;function B(U,Q){return function(se,Ce){return function(be,st){var tt=function(){return U.getNamed(se,Ce)};G(be,st,tt,Q)}}}Z.makePropertyInjectNamedDecorator=B;function h(U,Q){return function(se,Ce,be){return function(st,tt){var ut=function(){return U.getTagged(se,Ce,be)};G(st,tt,ut,Q)}}}Z.makePropertyInjectTaggedDecorator=h;function z(U,Q){return function(se){return function(Ce,be){var st=function(){return U.getAll(se)};G(Ce,be,st,Q)}}}Z.makePropertyMultiInjectDecorator=z},VOtZ:function(ae,Z,w){var N=w("juv8"),G=w("MvSz");function H(B,h){return N(B,G(B),h)}ae.exports=H},VmRL:function(ae,Z,w){"use strict";ae.exports=N,ae.exports.default=N;function N(de,Ie,we){we=we||2;var ct=Ie&&Ie.length,ot=ct?Ie[0]*we:de.length,wt=G(de,0,ot,we,!0),S=[];if(!wt||wt.next===wt.prev)return S;var ur,Pt,Ft,Et,St,Zt,dr;if(ct&&(wt=se(de,Ie,wt,we)),de.length>80*we){ur=Ft=de[0],Pt=Et=de[1];for(var qt=we;qt<ot;qt+=we)St=de[qt],Zt=de[qt+1],St<ur&&(ur=St),Zt<Pt&&(Pt=Zt),St>Ft&&(Ft=St),Zt>Et&&(Et=Zt);dr=Math.max(Ft-ur,Et-Pt),dr=dr!==0?1/dr:0}return B(wt,S,we,ur,Pt,dr),S}function G(de,Ie,we,ct,ot){var wt,S;if(ot===Er(de,Ie,we,ct)>0)for(wt=Ie;wt<we;wt+=ct)S=nr(wt,de[wt],de[wt+1],S);else for(wt=we-ct;wt>=Ie;wt-=ct)S=nr(wt,de[wt],de[wt+1],S);return S&&$(S,S.next)&&(Mr(S),S=S.next),S}function H(de,Ie){if(!de)return de;Ie||(Ie=de);var we=de,ct;do if(ct=!1,!we.steiner&&($(we,we.next)||lt(we.prev,we,we.next)===0)){if(Mr(we),we=Ie=we.prev,we===we.next)break;ct=!0}else we=we.next;while(ct||we!==Ie);return Ie}function B(de,Ie,we,ct,ot,wt,S){if(!!de){!S&&wt&&ut(de,ct,ot,wt);for(var ur=de,Pt,Ft;de.prev!==de.next;){if(Pt=de.prev,Ft=de.next,wt?z(de,ct,ot,wt):h(de)){Ie.push(Pt.i/we),Ie.push(de.i/we),Ie.push(Ft.i/we),Mr(de),de=Ft.next,ur=Ft.next;continue}if(de=Ft,de===ur){S?S===1?(de=U(H(de),Ie,we),B(de,Ie,we,ct,ot,wt,2)):S===2&&Q(de,Ie,we,ct,ot,wt):B(H(de),Ie,we,ct,ot,wt,1);break}}}}function h(de){var Ie=de.prev,we=de,ct=de.next;if(lt(Ie,we,ct)>=0)return!1;for(var ot=de.next.next;ot!==de.prev;){if(dt(Ie.x,Ie.y,we.x,we.y,ct.x,ct.y,ot.x,ot.y)&&lt(ot.prev,ot,ot.next)>=0)return!1;ot=ot.next}return!0}function z(de,Ie,we,ct){var ot=de.prev,wt=de,S=de.next;if(lt(ot,wt,S)>=0)return!1;for(var ur=ot.x<wt.x?ot.x<S.x?ot.x:S.x:wt.x<S.x?wt.x:S.x,Pt=ot.y<wt.y?ot.y<S.y?ot.y:S.y:wt.y<S.y?wt.y:S.y,Ft=ot.x>wt.x?ot.x>S.x?ot.x:S.x:wt.x>S.x?wt.x:S.x,Et=ot.y>wt.y?ot.y>S.y?ot.y:S.y:wt.y>S.y?wt.y:S.y,St=gt(ur,Pt,Ie,we,ct),Zt=gt(Ft,Et,Ie,we,ct),dr=de.prevZ,qt=de.nextZ;dr&&dr.z>=St&&qt&&qt.z<=Zt;){if(dr!==de.prev&&dr!==de.next&&dt(ot.x,ot.y,wt.x,wt.y,S.x,S.y,dr.x,dr.y)&&lt(dr.prev,dr,dr.next)>=0||(dr=dr.prevZ,qt!==de.prev&&qt!==de.next&&dt(ot.x,ot.y,wt.x,wt.y,S.x,S.y,qt.x,qt.y)&&lt(qt.prev,qt,qt.next)>=0))return!1;qt=qt.nextZ}for(;dr&&dr.z>=St;){if(dr!==de.prev&&dr!==de.next&&dt(ot.x,ot.y,wt.x,wt.y,S.x,S.y,dr.x,dr.y)&&lt(dr.prev,dr,dr.next)>=0)return!1;dr=dr.prevZ}for(;qt&&qt.z<=Zt;){if(qt!==de.prev&&qt!==de.next&&dt(ot.x,ot.y,wt.x,wt.y,S.x,S.y,qt.x,qt.y)&&lt(qt.prev,qt,qt.next)>=0)return!1;qt=qt.nextZ}return!0}function U(de,Ie,we){var ct=de;do{var ot=ct.prev,wt=ct.next.next;!$(ot,wt)&&Qt(ot,ct,ct.next,wt)&&ke(ot,wt)&&ke(wt,ot)&&(Ie.push(ot.i/we),Ie.push(ct.i/we),Ie.push(wt.i/we),Mr(ct),Mr(ct.next),ct=de=wt),ct=ct.next}while(ct!==de);return H(ct)}function Q(de,Ie,we,ct,ot,wt){var S=de;do{for(var ur=S.next.next;ur!==S.prev;){if(S.i!==ur.i&&rt(S,ur)){var Pt=Nt(S,ur);S=H(S,S.next),Pt=H(Pt,Pt.next),B(S,Ie,we,ct,ot,wt),B(Pt,Ie,we,ct,ot,wt);return}ur=ur.next}S=S.next}while(S!==de)}function se(de,Ie,we,ct){var ot=[],wt,S,ur,Pt,Ft;for(wt=0,S=Ie.length;wt<S;wt++)ur=Ie[wt]*ct,Pt=wt<S-1?Ie[wt+1]*ct:de.length,Ft=G(de,ur,Pt,ct,!1),Ft===Ft.next&&(Ft.steiner=!0),ot.push(Be(Ft));for(ot.sort(Ce),wt=0;wt<ot.length;wt++)we=be(ot[wt],we),we=H(we,we.next);return we}function Ce(de,Ie){return de.x-Ie.x}function be(de,Ie){var we=st(de,Ie);if(!we)return Ie;var ct=Nt(we,de),ot=H(we,we.next);return H(ct,ct.next),Ie===we?ot:Ie}function st(de,Ie){var we=Ie,ct=de.x,ot=de.y,wt=-Infinity,S;do{if(ot<=we.y&&ot>=we.next.y&&we.next.y!==we.y){var ur=we.x+(ot-we.y)*(we.next.x-we.x)/(we.next.y-we.y);if(ur<=ct&&ur>wt){if(wt=ur,ur===ct){if(ot===we.y)return we;if(ot===we.next.y)return we.next}S=we.x<we.next.x?we:we.next}}we=we.next}while(we!==Ie);if(!S)return null;if(ct===wt)return S;var Pt=S,Ft=S.x,Et=S.y,St=Infinity,Zt;we=S;do ct>=we.x&&we.x>=Ft&&ct!==we.x&&dt(ot<Et?ct:wt,ot,Ft,Et,ot<Et?wt:ct,ot,we.x,we.y)&&(Zt=Math.abs(ot-we.y)/(ct-we.x),ke(we,de)&&(Zt<St||Zt===St&&(we.x>S.x||we.x===S.x&&tt(S,we)))&&(S=we,St=Zt)),we=we.next;while(we!==Pt);return S}function tt(de,Ie){return lt(de.prev,de,Ie.prev)<0&&lt(Ie.next,de,de.next)<0}function ut(de,Ie,we,ct){var ot=de;do ot.z===null&&(ot.z=gt(ot.x,ot.y,Ie,we,ct)),ot.prevZ=ot.prev,ot.nextZ=ot.next,ot=ot.next;while(ot!==de);ot.prevZ.nextZ=null,ot.prevZ=null,ht(ot)}function ht(de){var Ie,we,ct,ot,wt,S,ur,Pt,Ft=1;do{for(we=de,de=null,wt=null,S=0;we;){for(S++,ct=we,ur=0,Ie=0;Ie<Ft&&(ur++,ct=ct.nextZ,!!ct);Ie++);for(Pt=Ft;ur>0||Pt>0&&ct;)ur!==0&&(Pt===0||!ct||we.z<=ct.z)?(ot=we,we=we.nextZ,ur--):(ot=ct,ct=ct.nextZ,Pt--),wt?wt.nextZ=ot:de=ot,ot.prevZ=wt,wt=ot;we=ct}wt.nextZ=null,Ft*=2}while(S>1);return de}function gt(de,Ie,we,ct,ot){return de=32767*(de-we)*ot,Ie=32767*(Ie-ct)*ot,de=(de|de<<8)&16711935,de=(de|de<<4)&252645135,de=(de|de<<2)&858993459,de=(de|de<<1)&1431655765,Ie=(Ie|Ie<<8)&16711935,Ie=(Ie|Ie<<4)&252645135,Ie=(Ie|Ie<<2)&858993459,Ie=(Ie|Ie<<1)&1431655765,de|Ie<<1}function Be(de){var Ie=de,we=de;do(Ie.x<we.x||Ie.x===we.x&&Ie.y<we.y)&&(we=Ie),Ie=Ie.next;while(Ie!==de);return we}function dt(de,Ie,we,ct,ot,wt,S,ur){return(ot-S)*(Ie-ur)-(de-S)*(wt-ur)>=0&&(de-S)*(ct-ur)-(we-S)*(Ie-ur)>=0&&(we-S)*(wt-ur)-(ot-S)*(ct-ur)>=0}function rt(de,Ie){return de.next.i!==Ie.i&&de.prev.i!==Ie.i&&!Rt(de,Ie)&&(ke(de,Ie)&&ke(Ie,de)&&Mt(de,Ie)&&(lt(de.prev,de,Ie.prev)||lt(de,Ie.prev,Ie))||$(de,Ie)&&lt(de.prev,de,de.next)>0&&lt(Ie.prev,Ie,Ie.next)>0)}function lt(de,Ie,we){return(Ie.y-de.y)*(we.x-Ie.x)-(Ie.x-de.x)*(we.y-Ie.y)}function $(de,Ie){return de.x===Ie.x&&de.y===Ie.y}function Qt(de,Ie,we,ct){var ot=br(lt(de,Ie,we)),wt=br(lt(de,Ie,ct)),S=br(lt(we,ct,de)),ur=br(lt(we,ct,Ie));return!!(ot!==wt&&S!==ur||ot===0&&Ir(de,we,Ie)||wt===0&&Ir(de,ct,Ie)||S===0&&Ir(we,de,ct)||ur===0&&Ir(we,Ie,ct))}function Ir(de,Ie,we){return Ie.x<=Math.max(de.x,we.x)&&Ie.x>=Math.min(de.x,we.x)&&Ie.y<=Math.max(de.y,we.y)&&Ie.y>=Math.min(de.y,we.y)}function br(de){return de>0?1:de<0?-1:0}function Rt(de,Ie){var we=de;do{if(we.i!==de.i&&we.next.i!==de.i&&we.i!==Ie.i&&we.next.i!==Ie.i&&Qt(we,we.next,de,Ie))return!0;we=we.next}while(we!==de);return!1}function ke(de,Ie){return lt(de.prev,de,de.next)<0?lt(de,Ie,de.next)>=0&&lt(de,de.prev,Ie)>=0:lt(de,Ie,de.prev)<0||lt(de,de.next,Ie)<0}function Mt(de,Ie){var we=de,ct=!1,ot=(de.x+Ie.x)/2,wt=(de.y+Ie.y)/2;do we.y>wt!=we.next.y>wt&&we.next.y!==we.y&&ot<(we.next.x-we.x)*(wt-we.y)/(we.next.y-we.y)+we.x&&(ct=!ct),we=we.next;while(we!==de);return ct}function Nt(de,Ie){var we=new Jr(de.i,de.x,de.y),ct=new Jr(Ie.i,Ie.x,Ie.y),ot=de.next,wt=Ie.prev;return de.next=Ie,Ie.prev=de,we.next=ot,ot.prev=we,ct.next=we,we.prev=ct,wt.next=ct,ct.prev=wt,ct}function nr(de,Ie,we,ct){var ot=new Jr(de,Ie,we);return ct?(ot.next=ct.next,ot.prev=ct,ct.next.prev=ot,ct.next=ot):(ot.prev=ot,ot.next=ot),ot}function Mr(de){de.next.prev=de.prev,de.prev.next=de.next,de.prevZ&&(de.prevZ.nextZ=de.nextZ),de.nextZ&&(de.nextZ.prevZ=de.prevZ)}function Jr(de,Ie,we){this.i=de,this.x=Ie,this.y=we,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}N.deviation=function(de,Ie,we,ct){var ot=Ie&&Ie.length,wt=ot?Ie[0]*we:de.length,S=Math.abs(Er(de,0,wt,we));if(ot)for(var ur=0,Pt=Ie.length;ur<Pt;ur++){var Ft=Ie[ur]*we,Et=ur<Pt-1?Ie[ur+1]*we:de.length;S-=Math.abs(Er(de,Ft,Et,we))}var St=0;for(ur=0;ur<ct.length;ur+=3){var Zt=ct[ur]*we,dr=ct[ur+1]*we,qt=ct[ur+2]*we;St+=Math.abs((de[Zt]-de[qt])*(de[dr+1]-de[Zt+1])-(de[Zt]-de[dr])*(de[qt+1]-de[Zt+1]))}return S===0&&St===0?0:Math.abs((St-S)/S)};function Er(de,Ie,we,ct){for(var ot=0,wt=Ie,S=we-ct;wt<we;wt+=ct)ot+=(de[S]-de[wt])*(de[wt+1]+de[S+1]),S=wt;return ot}N.flatten=function(de){for(var Ie=de[0][0].length,we={vertices:[],holes:[],dimensions:Ie},ct=0,ot=0;ot<de.length;ot++){for(var wt=0;wt<de[ot].length;wt++)for(var S=0;S<Ie;S++)we.vertices.push(de[ot][wt][S]);ot>0&&(ct+=de[ot-1].length,we.holes.push(ct))}return we}},W8MJ:function(ae,Z){function w(G,H){for(var B=0;B<H.length;B++){var h=H[B];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(G,h.key,h)}}function N(G,H,B){return H&&w(G.prototype,H),B&&w(G,B),Object.defineProperty(G,"prototype",{writable:!1}),G}ae.exports=N,ae.exports.__esModule=!0,ae.exports.default=ae.exports},WwFo:function(ae,Z,w){var N=w("juv8"),G=w("7GkX");function H(B,h){return B&&N(h,G(h),B)}ae.exports=H},XYm9:function(ae,Z,w){var N=w("+K+b");function G(H,B){var h=B?N(H.buffer):H.buffer;return new H.constructor(h,H.byteOffset,H.byteLength)}ae.exports=G},"Xt/L":function(ae,Z){function w(N,G,H){for(var B=-1,h=N==null?0:N.length;++B<h;)if(H(G,N[B]))return!0;return!1}ae.exports=w},YO3V:function(ae,Z,w){var N=w("NykK"),G=w("LcsW"),H=w("ExA7"),B="[object Object]",h=Function.prototype,z=Object.prototype,U=h.toString,Q=z.hasOwnProperty,se=U.call(Object);function Ce(be){if(!H(be)||N(be)!=B)return!1;var st=G(be);if(st===null)return!0;var tt=Q.call(st,"constructor")&&st.constructor;return typeof tt=="function"&&tt instanceof tt&&U.call(tt)==se}ae.exports=Ce},Yk9n:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.inject=Z.LazyServiceIdentifer=void 0;var N=w("MON2"),G=w("xfSm"),H=w("GXnB"),B=w("Ztfv"),h=function(){function U(Q){this._cb=Q}return U.prototype.unwrap=function(){return this._cb()},U}();Z.LazyServiceIdentifer=h;function z(U){return function(Q,se,Ce){if(U===void 0)throw new Error(N.UNDEFINED_INJECT_ANNOTATION(Q.name));var be=new H.Metadata(G.INJECT_TAG,U);typeof Ce=="number"?B.tagParameter(Q,se,Ce,be):B.tagProperty(Q,se,be)}}Z.inject=z},Z1HP:function(ae,Z,w){var N=w("ycre"),G=w("quyA"),H=w("q4HE");function B(h){return G(h)?H(h):N(h)}ae.exports=B},ZCgT:function(ae,Z,w){var N=w("tLB3"),G=1/0,H=17976931348623157e292;function B(h){if(!h)return h===0?h:0;if(h=N(h),h===G||h===-G){var z=h<0?-1:1;return z*H}return h===h?h:0}ae.exports=B},ZK94:function(ae,Z){ae.exports.RADIUS=6378137,ae.exports.FLATTENING=1/298.257223563,ae.exports.POLAR_RADIUS=63567523142e-4},Ztfv:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.tagProperty=Z.tagParameter=Z.decorate=void 0;var N=w("MON2"),G=w("xfSm");function H(se,Ce,be,st){var tt=G.TAGGED;h(tt,se,Ce,st,be)}Z.tagParameter=H;function B(se,Ce,be){var st=G.TAGGED_PROP;h(st,se.constructor,Ce,be)}Z.tagProperty=B;function h(se,Ce,be,st,tt){var ut={},ht=typeof tt=="number",gt=tt!==void 0&&ht?tt.toString():be;if(ht&&be!==void 0)throw new Error(N.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(se,Ce)&&(ut=Reflect.getMetadata(se,Ce));var Be=ut[gt];if(!Array.isArray(Be))Be=[];else for(var dt=0,rt=Be;dt<rt.length;dt++){var lt=rt[dt];if(lt.key===st.key)throw new Error(N.DUPLICATED_METADATA+" "+lt.key.toString())}Be.push(st),ut[gt]=Be,Reflect.defineMetadata(se,ut,Ce)}function z(se,Ce){Reflect.decorate(se,Ce)}function U(se,Ce){return function(be,st){Ce(be,st,se)}}function Q(se,Ce,be){typeof be=="number"?z([U(be,se)],Ce):typeof be=="string"?Reflect.decorate([se],Ce,be):z([se],Ce)}Z.decorate=Q},ZzCi:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.named=void 0;var N=w("xfSm"),G=w("GXnB"),H=w("Ztfv");function B(h){return function(z,U,Q){var se=new G.Metadata(N.NAMED_TAG,h);typeof Q=="number"?H.tagParameter(z,U,Q,se):H.tagProperty(z,U,se)}}Z.named=B},a1gu:function(ae,Z,w){var N=w("cDf5").default,G=w("PJYZ");function H(B,h){if(h&&(N(h)==="object"||typeof h=="function"))return h;if(h!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G(B)}ae.exports=H,ae.exports.__esModule=!0,ae.exports.default=ae.exports},aHsQ:function(ae,Z,w){"use strict";var N=w("EFp3"),G=w.n(N),H=w("6D9b"),B=w.n(H),h=w("cWXX")},aPG5:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.resolve=void 0;var N=w("MON2"),G=w("FV85"),H=w("qK8v"),B=w("ujMp"),h=w("cSJO"),z=function(Ce,be,st){try{return st()}catch(tt){throw H.isStackOverflowExeption(tt)?new Error(N.CIRCULAR_DEPENDENCY_IN_FACTORY(Ce,be.toString())):tt}},U=function se(Ce){return function(be){be.parentContext.setCurrentRequest(be);var st=be.bindings,tt=be.childRequests,ut=be.target&&be.target.isArray(),ht=!be.parentRequest||!be.parentRequest.target||!be.target||!be.parentRequest.target.matchesArray(be.target.serviceIdentifier);if(ut&&ht)return tt.map(function($){var Qt=se(Ce);return Qt($)});var gt=null;if(be.target.isOptional()&&st.length===0)return;var Be=st[0],dt=Be.scope===G.BindingScopeEnum.Singleton,rt=Be.scope===G.BindingScopeEnum.Request;if(dt&&Be.activated)return Be.cache;if(rt&&Ce!==null&&Ce.has(Be.id))return Ce.get(Be.id);if(Be.type===G.BindingTypeEnum.ConstantValue)gt=Be.cache,Be.activated=!0;else if(Be.type===G.BindingTypeEnum.Function)gt=Be.cache,Be.activated=!0;else if(Be.type===G.BindingTypeEnum.Constructor)gt=Be.implementationType;else if(Be.type===G.BindingTypeEnum.DynamicValue&&Be.dynamicValue!==null)gt=z("toDynamicValue",Be.serviceIdentifier,function(){return Be.dynamicValue(be.parentContext)});else if(Be.type===G.BindingTypeEnum.Factory&&Be.factory!==null)gt=z("toFactory",Be.serviceIdentifier,function(){return Be.factory(be.parentContext)});else if(Be.type===G.BindingTypeEnum.Provider&&Be.provider!==null)gt=z("toProvider",Be.serviceIdentifier,function(){return Be.provider(be.parentContext)});else if(Be.type===G.BindingTypeEnum.Instance&&Be.implementationType!==null)gt=h.resolveInstance(Be.implementationType,tt,se(Ce));else{var lt=B.getServiceIdentifierAsString(be.serviceIdentifier);throw new Error(N.INVALID_BINDING_TYPE+" "+lt)}return typeof Be.onActivation=="function"&&(gt=Be.onActivation(be.parentContext,gt)),dt&&(Be.cache=gt,Be.activated=!0),rt&&Ce!==null&&!Ce.has(Be.id)&&Ce.set(Be.id,gt),gt}};function Q(se){var Ce=U(se.plan.rootRequest.requestScope);return Ce(se.plan.rootRequest)}Z.resolve=Q},asDA:function(ae,Z){function w(N,G,H,B){var h=-1,z=N==null?0:N.length;for(B&&z&&(H=N[++h]);++h<z;)H=G(H,N[h],h,N);return H}ae.exports=w},b2z7:function(ae,Z){var w=/\w*$/;function N(G){var H=new G.constructor(G.source,w.exec(G));return H.lastIndex=G.lastIndex,H}ae.exports=N},b48C:function(ae,Z){function w(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(N){return!1}}ae.exports=w,ae.exports.__esModule=!0,ae.exports.default=ae.exports},bahg:function(ae,Z){function w(N){return N.split("")}ae.exports=w},cSJO:function(ae,Z,w){"use strict";var N=this&&this.__spreadArray||function(se,Ce){for(var be=0,st=Ce.length,tt=se.length;be<st;be++,tt++)se[tt]=Ce[be];return se};Object.defineProperty(Z,"__esModule",{value:!0}),Z.resolveInstance=void 0;var G=w("MON2"),H=w("FV85"),B=w("xfSm");function h(se,Ce,be){var st=Ce.filter(function(ut){return ut.target!==null&&ut.target.type===H.TargetTypeEnum.ClassProperty}),tt=st.map(be);return st.forEach(function(ut,ht){var gt="";gt=ut.target.name.value();var Be=tt[ht];se[gt]=Be}),se}function z(se,Ce){return new(se.bind.apply(se,N([void 0],Ce)))}function U(se,Ce){if(Reflect.hasMetadata(B.POST_CONSTRUCT,se)){var be=Reflect.getMetadata(B.POST_CONSTRUCT,se);try{Ce[be.value]()}catch(st){throw new Error(G.POST_CONSTRUCT_ERROR(se.name,st.message))}}}function Q(se,Ce,be){var st=null;if(Ce.length>0){var tt=Ce.filter(function(ht){return ht.target!==null&&ht.target.type===H.TargetTypeEnum.ConstructorArgument}),ut=tt.map(be);st=z(se,ut),st=h(st,Ce,be)}else st=new se;return U(se,st),st}Z.resolveInstance=Q},cWXX:function(ae,Z,w){"use strict";var N=w("EFp3"),G=w.n(N),H=w("oIFs"),B=w.n(H)},cZ5Q:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.injectable=void 0;var N=w("MON2"),G=w("xfSm");function H(){return function(B){if(Reflect.hasOwnMetadata(G.PARAM_TYPES,B))throw new Error(N.DUPLICATED_INJECTABLE_DECORATOR);var h=Reflect.getMetadata(G.DESIGN_PARAM_TYPES,B)||[];return Reflect.defineMetadata(G.PARAM_TYPES,h,B),B}}Z.injectable=H},"cq/+":function(ae,Z,w){var N=w("mc0g"),G=N();ae.exports=G},cvCv:function(ae,Z){function w(N){return function(){return N}}ae.exports=w},d9O0:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.id=void 0;var N=0;function G(){return N++}Z.id=G},dQpi:function(ae,Z,w){var N=w("yGk4"),G=w("vN+2"),H=w("rEGp"),B=1/0,h=N&&1/H(new N([,-0]))[1]==B?function(z){return new N(z)}:G;ae.exports=h},dTAl:function(ae,Z,w){var N=w("GoyQ"),G=Object.create,H=function(){function B(){}return function(h){if(!N(h))return{};if(G)return G(h);B.prototype=h;var z=new B;return B.prototype=void 0,z}}();ae.exports=H},dVn5:function(ae,Z){var w=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function N(G){return G.match(w)||[]}ae.exports=N},dX1H:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.Target=void 0;var N=w("xfSm"),G=w("d9O0"),H=w("GXnB"),B=w("zxMA"),h=function(){function z(U,Q,se,Ce){this.id=G.id(),this.type=U,this.serviceIdentifier=se,this.name=new B.QueryableString(Q||""),this.metadata=new Array;var be=null;typeof Ce=="string"?be=new H.Metadata(N.NAMED_TAG,Ce):Ce instanceof H.Metadata&&(be=Ce),be!==null&&this.metadata.push(be)}return z.prototype.hasTag=function(U){for(var Q=0,se=this.metadata;Q<se.length;Q++){var Ce=se[Q];if(Ce.key===U)return!0}return!1},z.prototype.isArray=function(){return this.hasTag(N.MULTI_INJECT_TAG)},z.prototype.matchesArray=function(U){return this.matchesTag(N.MULTI_INJECT_TAG)(U)},z.prototype.isNamed=function(){return this.hasTag(N.NAMED_TAG)},z.prototype.isTagged=function(){return this.metadata.some(function(U){return N.NON_CUSTOM_TAG_KEYS.every(function(Q){return U.key!==Q})})},z.prototype.isOptional=function(){return this.matchesTag(N.OPTIONAL_TAG)(!0)},z.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(U){return U.key===N.NAMED_TAG})[0]:null},z.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(U){return N.NON_CUSTOM_TAG_KEYS.every(function(Q){return U.key!==Q})}):null},z.prototype.matchesNamedTag=function(U){return this.matchesTag(N.NAMED_TAG)(U)},z.prototype.matchesTag=function(U){var Q=this;return function(se){for(var Ce=0,be=Q.metadata;Ce<be.length;Ce++){var st=be[Ce];if(st.key===U&&st.value===se)return!0}return!1}},z}();Z.Target=h},doU7:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.BindingCount=void 0;var N={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};Z.BindingCount=N},dt0z:function(ae,Z,w){var N=w("zoYe");function G(H){return H==null?"":N(H)}ae.exports=G},dxzI:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.AsyncContainerModule=Z.ContainerModule=void 0;var N=w("d9O0"),G=function(){function B(h){this.id=N.id(),this.registry=h}return B}();Z.ContainerModule=G;var H=function(){function B(h){this.id=N.id(),this.registry=h}return B}();Z.AsyncContainerModule=H},eUgh:function(ae,Z){function w(N,G){for(var H=-1,B=N==null?0:N.length,h=Array(B);++H<B;)h[H]=G(N[H],H,N);return h}ae.exports=w},fbrv:function(ae,Z,w){"use strict";var N=this&&this.__spreadArray||function(ht,gt){for(var Be=0,dt=gt.length,rt=ht.length;Be<dt;Be++,rt++)ht[rt]=gt[Be];return ht};Object.defineProperty(Z,"__esModule",{value:!0}),Z.getFunctionName=Z.getBaseClassDependencyCount=Z.getDependencies=void 0;var G=w("Yk9n"),H=w("MON2"),B=w("FV85"),h=w("xfSm"),z=w("ujMp");Object.defineProperty(Z,"getFunctionName",{enumerable:!0,get:function(){return z.getFunctionName}});var U=w("dX1H");function Q(ht,gt){var Be=z.getFunctionName(gt),dt=se(ht,Be,gt,!1);return dt}Z.getDependencies=Q;function se(ht,gt,Be,dt){var rt=ht.getConstructorMetadata(Be),lt=rt.compilerGeneratedMetadata;if(lt===void 0){var $=H.MISSING_INJECTABLE_ANNOTATION+" "+gt+".";throw new Error($)}var Qt=rt.userGeneratedMetadata,Ir=Object.keys(Qt),br=Be.length===0&&Ir.length>0,Rt=Ir.length>Be.length,ke=br||Rt?Ir.length:Be.length,Mt=be(dt,gt,lt,Qt,ke),Nt=st(ht,Be),nr=N(N([],Mt),Nt);return nr}function Ce(ht,gt,Be,dt,rt){var lt=rt[ht.toString()]||[],$=ut(lt),Qt=$.unmanaged!==!0,Ir=dt[ht],br=$.inject||$.multiInject;if(Ir=br||Ir,Ir instanceof G.LazyServiceIdentifer&&(Ir=Ir.unwrap()),Qt){var Rt=Ir===Object,ke=Ir===Function,Mt=Ir===void 0,Nt=Rt||ke||Mt;if(!gt&&Nt){var nr=H.MISSING_INJECT_ANNOTATION+" argument "+ht+" in class "+Be+".";throw new Error(nr)}var Mr=new U.Target(B.TargetTypeEnum.ConstructorArgument,$.targetName,Ir);return Mr.metadata=lt,Mr}return null}function be(ht,gt,Be,dt,rt){for(var lt=[],$=0;$<rt;$++){var Qt=$,Ir=Ce(Qt,ht,gt,Be,dt);Ir!==null&&lt.push(Ir)}return lt}function st(ht,gt){for(var Be=ht.getPropertiesMetadata(gt),dt=[],rt=Object.keys(Be),lt=0,$=rt;lt<$.length;lt++){var Qt=$[lt],Ir=Be[Qt],br=ut(Be[Qt]),Rt=br.targetName||Qt,ke=br.inject||br.multiInject,Mt=new U.Target(B.TargetTypeEnum.ClassProperty,Rt,ke);Mt.metadata=Ir,dt.push(Mt)}var Nt=Object.getPrototypeOf(gt.prototype).constructor;if(Nt!==Object){var nr=st(ht,Nt);dt=N(N([],dt),nr)}return dt}function tt(ht,gt){var Be=Object.getPrototypeOf(gt.prototype).constructor;if(Be!==Object){var dt=z.getFunctionName(Be),rt=se(ht,dt,Be,!0),lt=rt.map(function(Ir){return Ir.metadata.filter(function(br){return br.key===h.UNMANAGED_TAG})}),$=[].concat.apply([],lt).length,Qt=rt.length-$;return Qt>0?Qt:tt(ht,Be)}else return 0}Z.getBaseClassDependencyCount=tt;function ut(ht){var gt={};return ht.forEach(function(Be){gt[Be.key.toString()]=Be.value}),{inject:gt[h.INJECT_TAG],multiInject:gt[h.MULTI_INJECT_TAG],targetName:gt[h.NAME_TAG],unmanaged:gt[h.UNMANAGED_TAG]}}},fo6e:function(ae,Z){var w=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function N(G){return w.test(G)}ae.exports=N},g4R6:function(ae,Z){function w(N,G,H){return N===N&&(H!==void 0&&(N=N<=H?N:H),G!==void 0&&(N=N>=G?N:G)),N}ae.exports=w},gFfm:function(ae,Z){function w(N,G){for(var H=-1,B=N==null?0:N.length;++H<B&&G(N[H],H,N)!==!1;);return N}ae.exports=w},gQMU:function(ae,Z,w){var N=w("0ZTe"),G=N("toUpperCase");ae.exports=G},gzZq:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.BindingToSyntax=void 0;var N=w("MON2"),G=w("FV85"),H=w("D9lx"),B=w("LKzl"),h=function(){function z(U){this._binding=U}return z.prototype.to=function(U){return this._binding.type=G.BindingTypeEnum.Instance,this._binding.implementationType=U,new H.BindingInWhenOnSyntax(this._binding)},z.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+N.INVALID_TO_SELF_VALUE);var U=this._binding.serviceIdentifier;return this.to(U)},z.prototype.toConstantValue=function(U){return this._binding.type=G.BindingTypeEnum.ConstantValue,this._binding.cache=U,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=G.BindingScopeEnum.Singleton,new B.BindingWhenOnSyntax(this._binding)},z.prototype.toDynamicValue=function(U){return this._binding.type=G.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=U,this._binding.implementationType=null,new H.BindingInWhenOnSyntax(this._binding)},z.prototype.toConstructor=function(U){return this._binding.type=G.BindingTypeEnum.Constructor,this._binding.implementationType=U,this._binding.scope=G.BindingScopeEnum.Singleton,new B.BindingWhenOnSyntax(this._binding)},z.prototype.toFactory=function(U){return this._binding.type=G.BindingTypeEnum.Factory,this._binding.factory=U,this._binding.scope=G.BindingScopeEnum.Singleton,new B.BindingWhenOnSyntax(this._binding)},z.prototype.toFunction=function(U){if(typeof U!="function")throw new Error(N.INVALID_FUNCTION_BINDING);var Q=this.toConstantValue(U);return this._binding.type=G.BindingTypeEnum.Function,this._binding.scope=G.BindingScopeEnum.Singleton,Q},z.prototype.toAutoFactory=function(U){return this._binding.type=G.BindingTypeEnum.Factory,this._binding.factory=function(Q){var se=function(){return Q.container.get(U)};return se},this._binding.scope=G.BindingScopeEnum.Singleton,new B.BindingWhenOnSyntax(this._binding)},z.prototype.toProvider=function(U){return this._binding.type=G.BindingTypeEnum.Provider,this._binding.provider=U,this._binding.scope=G.BindingScopeEnum.Singleton,new B.BindingWhenOnSyntax(this._binding)},z.prototype.toService=function(U){this.toDynamicValue(function(Q){return Q.container.get(U)})},z}();Z.BindingToSyntax=h},h7MG:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.getBindingDictionary=Z.createMockRequest=Z.plan=void 0;var N=w("doU7"),G=w("MON2"),H=w("FV85"),B=w("xfSm"),h=w("qK8v"),z=w("ujMp"),U=w("oy+k"),Q=w("GXnB"),se=w("yMAV"),Ce=w("fbrv"),be=w("xiII"),st=w("dX1H");function tt($){return $._bindingDictionary}Z.getBindingDictionary=tt;function ut($,Qt,Ir,br,Rt,ke){var Mt=$?B.MULTI_INJECT_TAG:B.INJECT_TAG,Nt=new Q.Metadata(Mt,Ir),nr=new st.Target(Qt,br,Ir,Nt);if(Rt!==void 0){var Mr=new Q.Metadata(Rt,ke);nr.metadata.push(Mr)}return nr}function ht($,Qt,Ir,br,Rt){var ke=dt(Ir.container,Rt.serviceIdentifier),Mt=[];return ke.length===N.BindingCount.NoBindingsAvailable&&Ir.container.options.autoBindInjectable&&typeof Rt.serviceIdentifier=="function"&&$.getConstructorMetadata(Rt.serviceIdentifier).compilerGeneratedMetadata&&(Ir.container.bind(Rt.serviceIdentifier).toSelf(),ke=dt(Ir.container,Rt.serviceIdentifier)),Qt?Mt=ke:Mt=ke.filter(function(Nt){var nr=new be.Request(Nt.serviceIdentifier,Ir,br,Nt,Rt);return Nt.constraint(nr)}),gt(Rt.serviceIdentifier,Mt,Rt,Ir.container),Mt}function gt($,Qt,Ir,br){switch(Qt.length){case N.BindingCount.NoBindingsAvailable:if(Ir.isOptional())return Qt;var Rt=z.getServiceIdentifierAsString($),ke=G.NOT_REGISTERED;throw ke+=z.listMetadataForTarget(Rt,Ir),ke+=z.listRegisteredBindingsForServiceIdentifier(br,Rt,dt),new Error(ke);case N.BindingCount.OnlyOneBindingAvailable:if(!Ir.isArray())return Qt;case N.BindingCount.MultipleBindingsAvailable:default:if(Ir.isArray())return Qt;var Rt=z.getServiceIdentifierAsString($),ke=G.AMBIGUOUS_MATCH+" "+Rt;throw ke+=z.listRegisteredBindingsForServiceIdentifier(br,Rt,dt),new Error(ke)}}function Be($,Qt,Ir,br,Rt,ke){var Mt,Nt;if(Rt===null){Mt=ht($,Qt,br,null,ke),Nt=new be.Request(Ir,br,null,Mt,ke);var nr=new se.Plan(br,Nt);br.addPlan(nr)}else Mt=ht($,Qt,br,Rt,ke),Nt=Rt.addChildRequest(ke.serviceIdentifier,Mt,ke);Mt.forEach(function(Mr){var Jr=null;if(ke.isArray())Jr=Nt.addChildRequest(Mr.serviceIdentifier,Mr,ke);else{if(Mr.cache)return;Jr=Nt}if(Mr.type===H.BindingTypeEnum.Instance&&Mr.implementationType!==null){var Er=Ce.getDependencies($,Mr.implementationType);if(!br.container.options.skipBaseClassChecks){var de=Ce.getBaseClassDependencyCount($,Mr.implementationType);if(Er.length<de){var Ie=G.ARGUMENTS_LENGTH_MISMATCH(Ce.getFunctionName(Mr.implementationType));throw new Error(Ie)}}Er.forEach(function(we){Be($,!1,we.serviceIdentifier,br,Jr,we)})}})}function dt($,Qt){var Ir=[],br=tt($);return br.hasKey(Qt)?Ir=br.get(Qt):$.parent!==null&&(Ir=dt($.parent,Qt)),Ir}function rt($,Qt,Ir,br,Rt,ke,Mt,Nt){Nt===void 0&&(Nt=!1);var nr=new U.Context(Qt),Mr=ut(Ir,br,Rt,"",ke,Mt);try{return Be($,Nt,Rt,nr,null,Mr),nr}catch(Jr){throw h.isStackOverflowExeption(Jr)&&nr.plan&&z.circularDependencyToException(nr.plan.rootRequest),Jr}}Z.plan=rt;function lt($,Qt,Ir,br){var Rt=new st.Target(H.TargetTypeEnum.Variable,"",Qt,new Q.Metadata(Ir,br)),ke=new U.Context($),Mt=new be.Request(Qt,ke,null,[],Rt);return Mt}Z.createMockRequest=lt},heNW:function(ae,Z){function w(N,G,H){switch(H.length){case 0:return N.call(G);case 1:return N.call(G,H[0]);case 2:return N.call(G,H[0],H[1]);case 3:return N.call(G,H[0],H[1],H[2])}return N.apply(G,H)}ae.exports=w},hi0z:function(ae,Z,w){"use strict";(function(N,G){ae.exports=G()})(this,function(){function N(Ce){var be=[];return Ce.AMapUI&&be.push(G(Ce.AMapUI)),Ce.Loca&&be.push(H(Ce.Loca)),Promise.all(be)}function G(Ce){return new Promise(function(be,st){var tt=[];if(Ce.plugins)for(var ut=0;ut<Ce.plugins.length;ut+=1)h.AMapUI.plugins.indexOf(Ce.plugins[ut])==-1&&tt.push(Ce.plugins[ut]);if(z.AMapUI===B.failed)st("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(z.AMapUI===B.notload){z.AMapUI=B.loading,h.AMapUI.version=Ce.version||h.AMapUI.version,ut=h.AMapUI.version;var ht=document.body||document.head,gt=document.createElement("script");gt.type="text/javascript",gt.src="https://webapi.amap.com/ui/"+ut+"/main.js",gt.onerror=function(Be){z.AMapUI=B.failed,st("\u8BF7\u6C42 AMapUI \u5931\u8D25")},gt.onload=function(){if(z.AMapUI=B.loaded,tt.length)window.AMapUI.loadUI(tt,function(){for(var Be=0,dt=tt.length;Be<dt;Be++){var rt=tt[Be].split("/").slice(-1)[0];window.AMapUI[rt]=arguments[Be]}for(be();U.AMapUI.length;)U.AMapUI.splice(0,1)[0]()});else for(be();U.AMapUI.length;)U.AMapUI.splice(0,1)[0]()},ht.appendChild(gt)}else z.AMapUI===B.loaded?Ce.version&&Ce.version!==h.AMapUI.version?st("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):tt.length?window.AMapUI.loadUI(tt,function(){for(var Be=0,dt=tt.length;Be<dt;Be++){var rt=tt[Be].split("/").slice(-1)[0];window.AMapUI[rt]=arguments[Be]}be()}):be():Ce.version&&Ce.version!==h.AMapUI.version?st("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):U.AMapUI.push(function(Be){Be?st(Be):tt.length?window.AMapUI.loadUI(tt,function(){for(var dt=0,rt=tt.length;dt<rt;dt++){var lt=tt[dt].split("/").slice(-1)[0];window.AMapUI[lt]=arguments[dt]}be()}):be()})})}function H(Ce){return new Promise(function(be,st){if(h.AMap.version.startsWith("2.0"))st("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(z.Loca===B.failed)st("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(z.Loca===B.notload){z.Loca=B.loading,h.Loca.version=Ce.version||h.Loca.version;var tt=h.Loca.version,ut=h.key,ht=document.body||document.head,gt=document.createElement("script");gt.type="text/javascript",gt.src="https://webapi.amap.com/loca?v="+tt+"&key="+ut,gt.onerror=function(Be){z.Loca=B.failed,st("\u8BF7\u6C42 AMapUI \u5931\u8D25")},gt.onload=function(){for(z.Loca=B.loaded,be();U.Loca.length;)U.Loca.splice(0,1)[0]()},ht.appendChild(gt)}else z.Loca===B.loaded?Ce.version&&Ce.version!==h.Loca.version?st("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):be():Ce.version&&Ce.version!==h.Loca.version?st("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):U.Loca.push(function(Be){Be?st(Be):st()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var B;(function(Ce){Ce.notload="notload",Ce.loading="loading",Ce.loaded="loaded",Ce.failed="failed"})(B||(B={}));var h={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},z={AMap:B.notload,AMapUI:B.notload,Loca:B.notload},U={AMap:[],AMapUI:[],Loca:[]},Q=[],se=function(be){typeof be=="function"&&(z.AMap===B.loaded?be(window.AMap):Q.push(be))};return{load:function(be){return new Promise(function(st,tt){if(z.AMap==B.failed)tt("");else if(z.AMap==B.notload){var ut=be.key,ht=be.version,gt=be.plugins;ut?(window.AMap&&location.host!=="lbs.amap.com"&&tt("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),h.key=ut,h.AMap.version=ht||h.AMap.version,h.AMap.plugins=gt||h.AMap.plugins,z.AMap=B.loading,ht=document.body||document.head,window.___onAPILoaded=function(dt){if(delete window.___onAPILoaded,dt)z.AMap=B.failed,tt(dt);else for(z.AMap=B.loaded,N(be).then(function(){st(window.AMap)}).catch(tt);Q.length;)Q.splice(0,1)[0]()},gt=document.createElement("script"),gt.type="text/javascript",gt.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+h.AMap.version+"&key="+ut+"&plugin="+h.AMap.plugins.join(","),gt.onerror=function(dt){z.AMap=B.failed,tt(dt)},ht.appendChild(gt)):tt("\u8BF7\u586B\u5199key")}else if(z.AMap==B.loaded)if(be.key&&be.key!==h.key)tt("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(be.version&&be.version!==h.AMap.version)tt("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(ut=[],be.plugins)for(ht=0;ht<be.plugins.length;ht+=1)h.AMap.plugins.indexOf(be.plugins[ht])==-1&&ut.push(be.plugins[ht]);ut.length?window.AMap.plugin(ut,function(){N(be).then(function(){st(window.AMap)}).catch(tt)}):N(be).then(function(){st(window.AMap)}).catch(tt)}else if(be.key&&be.key!==h.key)tt("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(be.version&&be.version!==h.AMap.version)tt("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var Be=[];if(be.plugins)for(ht=0;ht<be.plugins.length;ht+=1)h.AMap.plugins.indexOf(be.plugins[ht])==-1&&Be.push(be.plugins[ht]);se(function(){Be.length?window.AMap.plugin(Be,function(){N(be).then(function(){st(window.AMap)}).catch(tt)}):N(be).then(function(){st(window.AMap)}).catch(tt)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,h={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},z={AMap:B.notload,AMapUI:B.notload,Loca:B.notload},U={AMap:[],AMapUI:[],Loca:[]}}}})},hypo:function(ae,Z,w){var N=w("O0oS");function G(H,B,h){B=="__proto__"&&N?N(H,B,{configurable:!0,enumerable:!0,value:h,writable:!0}):H[B]=h}ae.exports=G},iWIM:function(ae,Z,w){var N=w("n3AX");function G(){return typeof Reflect!="undefined"&&Reflect.get?(ae.exports=G=Reflect.get,ae.exports.__esModule=!0,ae.exports.default=ae.exports):(ae.exports=G=function(B,h,z){var U=N(B,h);if(!!U){var Q=Object.getOwnPropertyDescriptor(U,h);return Q.get?Q.get.call(arguments.length<3?B:z):Q.value}},ae.exports.__esModule=!0,ae.exports.default=ae.exports),G.apply(this,arguments)}ae.exports=G,ae.exports.__esModule=!0,ae.exports.default=ae.exports},iegG:function(ae,Z){function w(G){var H=G.target||G.srcElement;H.__resizeRAF__&&cancelAnimationFrame(H.__resizeRAF__),H.__resizeRAF__=requestAnimationFrame(function(){var B=H.__resizeTrigger__,h=B&&B.__resizeListeners__;h&&h.forEach(function(z){z.call(B,G)})})}var N=function(H,B){var h=this,z=h.document,U,Q=z.attachEvent;typeof navigator!="undefined"&&(U=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function se(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",w)}if(!H.__resizeListeners__)if(H.__resizeListeners__=[],Q)H.__resizeTrigger__=H,H.attachEvent("onresize",w);else{getComputedStyle(H).position==="static"&&(H.style.position="relative");var Ce=H.__resizeTrigger__=z.createElement("object");Ce.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),Ce.setAttribute("class","resize-sensor"),Ce.setAttribute("tabindex","-1"),Ce.setAttribute("title",""),Ce.__resizeElement__=H,Ce.onload=se,Ce.type="text/html",U&&H.appendChild(Ce),Ce.data="about:blank",U||H.appendChild(Ce)}H.__resizeListeners__.push(B)};ae.exports=typeof window=="undefined"?N:N.bind(window),ae.exports.unbind=function(G,H){var B=document.attachEvent,h=G.__resizeListeners__||[];if(H){var z=h.indexOf(H);z!==-1&&h.splice(z,1)}else h=G.__resizeListeners__=[];if(!h.length){if(B)G.detachEvent("onresize",w);else if(G.__resizeTrigger__){var U=G.__resizeTrigger__.contentDocument,Q=U&&U.defaultView;Q&&(Q.removeEventListener("resize",w),delete Q.__resizeTrigger__),G.__resizeTrigger__=!G.removeChild(G.__resizeTrigger__)}delete G.__resizeListeners__}}},itsj:function(ae,Z){function w(N,G){if(!(G==="constructor"&&typeof N[G]=="function")&&G!="__proto__")return N[G]}ae.exports=w},jCWc:function(ae,Z,w){"use strict";var N=w("EFp3"),G=w.n(N),H=w("1GLa")},"jIg/":function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.multiInject=void 0;var N=w("xfSm"),G=w("GXnB"),H=w("Ztfv");function B(h){return function(z,U,Q){var se=new G.Metadata(N.MULTI_INJECT_TAG,h);typeof Q=="number"?H.tagParameter(z,U,Q,se):H.tagProperty(z,U,se)}}Z.multiInject=B},jYQm:function(ae,Z,w){"use strict";var N=w("q1tI"),G=w.n(N),H=Object(N.createContext)({});Z.a=H},jYx5:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.optional=void 0;var N=w("xfSm"),G=w("GXnB"),H=w("Ztfv");function B(){return function(h,z,U){var Q=new G.Metadata(N.OPTIONAL_TAG,!0);typeof U=="number"?H.tagParameter(h,z,U,Q):H.tagProperty(h,z,Q)}}Z.optional=B},"jbM+":function(ae,Z,w){var N=w("R/W3");function G(H,B){var h=H==null?0:H.length;return!!h&&N(H,B,0)>-1}ae.exports=G},jeLo:function(ae,Z,w){var N=w("juv8"),G=w("mTTR");function H(B){return N(B,G(B))}ae.exports=H},juv8:function(ae,Z,w){var N=w("MrPd"),G=w("hypo");function H(B,h,z,U){var Q=!z;z||(z={});for(var se=-1,Ce=h.length;++se<Ce;){var be=h[se],st=U?U(z[be],B[be],be,z,B):void 0;st===void 0&&(st=B[be]),Q?G(z,be,st):N(z,be,st)}return z}ae.exports=H},kPKH:function(ae,Z,w){"use strict";var N=w("/kpp");Z.a=N.a},lwsE:function(ae,Z){function w(N,G){if(!(N instanceof G))throw new TypeError("Cannot call a class as a function")}ae.exports=w,ae.exports.__esModule=!0,ae.exports.default=ae.exports},mNvP:function(ae,Z,w){(function(N,G){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var H;(function(B){(function(h){var z=typeof G=="object"?G:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),U=Q(B);typeof z.Reflect=="undefined"?z.Reflect=B:U=Q(z.Reflect,U),h(U);function Q(se,Ce){return function(be,st){typeof se[be]!="function"&&Object.defineProperty(se,be,{configurable:!0,writable:!0,value:st}),Ce&&Ce(be,st)}}})(function(h){var z=Object.prototype.hasOwnProperty,U=typeof Symbol=="function",Q=U&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",se=U&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",Ce=typeof Object.create=="function",be={__proto__:[]}instanceof Array,st=!Ce&&!be,tt={create:Ce?function(){return os(Object.create(null))}:be?function(){return os({__proto__:null})}:function(){return os({})},has:st?function(jt,_r){return z.call(jt,_r)}:function(jt,_r){return _r in jt},get:st?function(jt,_r){return z.call(jt,_r)?jt[_r]:void 0}:function(jt,_r){return jt[_r]}},ut=Object.getPrototypeOf(Function),ht=typeof N=="object"&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL==="true",gt=!ht&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:yn(),Be=!ht&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Bi(),dt=!ht&&typeof WeakMap=="function"?WeakMap:Mo(),rt=new dt;function lt(jt,_r,Xr,vn){if(Pt(Xr)){if(!gr(jt))throw new TypeError;if(!Rr(_r))throw new TypeError;return Mr(jt,_r)}else{if(!gr(jt))throw new TypeError;if(!St(_r))throw new TypeError;if(!St(vn)&&!Pt(vn)&&!Ft(vn))throw new TypeError;return Ft(vn)&&(vn=void 0),Xr=Ur(Xr),Jr(jt,_r,Xr,vn)}}h("decorate",lt);function $(jt,_r){function Xr(vn,Kr){if(!St(vn))throw new TypeError;if(!Pt(Kr)&&!Hn(Kr))throw new TypeError;ot(jt,_r,vn,Kr)}return Xr}h("metadata",$);function Qt(jt,_r,Xr,vn){if(!St(Xr))throw new TypeError;return Pt(vn)||(vn=Ur(vn)),ot(jt,_r,Xr,vn)}h("defineMetadata",Qt);function Ir(jt,_r,Xr){if(!St(_r))throw new TypeError;return Pt(Xr)||(Xr=Ur(Xr)),de(jt,_r,Xr)}h("hasMetadata",Ir);function br(jt,_r,Xr){if(!St(_r))throw new TypeError;return Pt(Xr)||(Xr=Ur(Xr)),Ie(jt,_r,Xr)}h("hasOwnMetadata",br);function Rt(jt,_r,Xr){if(!St(_r))throw new TypeError;return Pt(Xr)||(Xr=Ur(Xr)),we(jt,_r,Xr)}h("getMetadata",Rt);function ke(jt,_r,Xr){if(!St(_r))throw new TypeError;return Pt(Xr)||(Xr=Ur(Xr)),ct(jt,_r,Xr)}h("getOwnMetadata",ke);function Mt(jt,_r){if(!St(jt))throw new TypeError;return Pt(_r)||(_r=Ur(_r)),wt(jt,_r)}h("getMetadataKeys",Mt);function Nt(jt,_r){if(!St(jt))throw new TypeError;return Pt(_r)||(_r=Ur(_r)),S(jt,_r)}h("getOwnMetadataKeys",Nt);function nr(jt,_r,Xr){if(!St(_r))throw new TypeError;Pt(Xr)||(Xr=Ur(Xr));var vn=Er(_r,Xr,!1);if(Pt(vn)||!vn.delete(jt))return!1;if(vn.size>0)return!0;var Kr=rt.get(_r);return Kr.delete(Xr),Kr.size>0||rt.delete(_r),!0}h("deleteMetadata",nr);function Mr(jt,_r){for(var Xr=jt.length-1;Xr>=0;--Xr){var vn=jt[Xr],Kr=vn(_r);if(!Pt(Kr)&&!Ft(Kr)){if(!Rr(Kr))throw new TypeError;_r=Kr}}return _r}function Jr(jt,_r,Xr,vn){for(var Kr=jt.length-1;Kr>=0;--Kr){var ba=jt[Kr],li=ba(_r,Xr,vn);if(!Pt(li)&&!Ft(li)){if(!St(li))throw new TypeError;vn=li}}return vn}function Er(jt,_r,Xr){var vn=rt.get(jt);if(Pt(vn)){if(!Xr)return;vn=new gt,rt.set(jt,vn)}var Kr=vn.get(_r);if(Pt(Kr)){if(!Xr)return;Kr=new gt,vn.set(_r,Kr)}return Kr}function de(jt,_r,Xr){var vn=Ie(jt,_r,Xr);if(vn)return!0;var Kr=me(_r);return Ft(Kr)?!1:de(jt,Kr,Xr)}function Ie(jt,_r,Xr){var vn=Er(_r,Xr,!1);return Pt(vn)?!1:qt(vn.has(jt))}function we(jt,_r,Xr){var vn=Ie(jt,_r,Xr);if(vn)return ct(jt,_r,Xr);var Kr=me(_r);if(!Ft(Kr))return we(jt,Kr,Xr)}function ct(jt,_r,Xr){var vn=Er(_r,Xr,!1);if(!Pt(vn))return vn.get(jt)}function ot(jt,_r,Xr,vn){var Kr=Er(Xr,vn,!0);Kr.set(jt,_r)}function wt(jt,_r){var Xr=S(jt,_r),vn=me(jt);if(vn===null)return Xr;var Kr=wt(vn,_r);if(Kr.length<=0)return Xr;if(Xr.length<=0)return Kr;for(var ba=new Be,li=[],Xn=0,ci=Xr;Xn<ci.length;Xn++){var Hi=ci[Xn],Yi=ba.has(Hi);Yi||(ba.add(Hi),li.push(Hi))}for(var No=0,Ma=Kr;No<Ma.length;No++){var Hi=Ma[No],Yi=ba.has(Hi);Yi||(ba.add(Hi),li.push(Hi))}return li}function S(jt,_r){var Xr=[],vn=Er(jt,_r,!1);if(Pt(vn))return Xr;for(var Kr=vn.keys(),ba=_n(Kr),li=0;;){var Xn=ii(ba);if(!Xn)return Xr.length=li,Xr;var ci=qn(Xn);try{Xr[li]=ci}catch(Hi){try{Xi(ba)}finally{throw Hi}}li++}}function ur(jt){if(jt===null)return 1;switch(typeof jt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return jt===null?1:6;default:return 6}}function Pt(jt){return jt===void 0}function Ft(jt){return jt===null}function Et(jt){return typeof jt=="symbol"}function St(jt){return typeof jt=="object"?jt!==null:typeof jt=="function"}function Zt(jt,_r){switch(ur(jt)){case 0:return jt;case 1:return jt;case 2:return jt;case 3:return jt;case 4:return jt;case 5:return jt}var Xr=_r===3?"string":_r===5?"number":"default",vn=en(jt,Q);if(vn!==void 0){var Kr=vn.call(jt,Xr);if(St(Kr))throw new TypeError;return Kr}return dr(jt,Xr==="default"?"number":Xr)}function dr(jt,_r){if(_r==="string"){var Xr=jt.toString;if(or(Xr)){var vn=Xr.call(jt);if(!St(vn))return vn}var Kr=jt.valueOf;if(or(Kr)){var vn=Kr.call(jt);if(!St(vn))return vn}}else{var Kr=jt.valueOf;if(or(Kr)){var vn=Kr.call(jt);if(!St(vn))return vn}var ba=jt.toString;if(or(ba)){var vn=ba.call(jt);if(!St(vn))return vn}}throw new TypeError}function qt(jt){return!!jt}function pr(jt){return""+jt}function Ur(jt){var _r=Zt(jt,3);return Et(_r)?_r:pr(_r)}function gr(jt){return Array.isArray?Array.isArray(jt):jt instanceof Object?jt instanceof Array:Object.prototype.toString.call(jt)==="[object Array]"}function or(jt){return typeof jt=="function"}function Rr(jt){return typeof jt=="function"}function Hn(jt){switch(ur(jt)){case 3:return!0;case 4:return!0;default:return!1}}function en(jt,_r){var Xr=jt[_r];if(Xr!=null){if(!or(Xr))throw new TypeError;return Xr}}function _n(jt){var _r=en(jt,se);if(!or(_r))throw new TypeError;var Xr=_r.call(jt);if(!St(Xr))throw new TypeError;return Xr}function qn(jt){return jt.value}function ii(jt){var _r=jt.next();return _r.done?!1:_r}function Xi(jt){var _r=jt.return;_r&&_r.call(jt)}function me(jt){var _r=Object.getPrototypeOf(jt);if(typeof jt!="function"||jt===ut||_r!==ut)return _r;var Xr=jt.prototype,vn=Xr&&Object.getPrototypeOf(Xr);if(vn==null||vn===Object.prototype)return _r;var Kr=vn.constructor;return typeof Kr!="function"||Kr===jt?_r:Kr}function yn(){var jt={},_r=[],Xr=function(){function li(Xn,ci,Hi){this._index=0,this._keys=Xn,this._values=ci,this._selector=Hi}return li.prototype["@@iterator"]=function(){return this},li.prototype[se]=function(){return this},li.prototype.next=function(){var Xn=this._index;if(Xn>=0&&Xn<this._keys.length){var ci=this._selector(this._keys[Xn],this._values[Xn]);return Xn+1>=this._keys.length?(this._index=-1,this._keys=_r,this._values=_r):this._index++,{value:ci,done:!1}}return{value:void 0,done:!0}},li.prototype.throw=function(Xn){throw this._index>=0&&(this._index=-1,this._keys=_r,this._values=_r),Xn},li.prototype.return=function(Xn){return this._index>=0&&(this._index=-1,this._keys=_r,this._values=_r),{value:Xn,done:!0}},li}();return function(){function li(){this._keys=[],this._values=[],this._cacheKey=jt,this._cacheIndex=-2}return Object.defineProperty(li.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),li.prototype.has=function(Xn){return this._find(Xn,!1)>=0},li.prototype.get=function(Xn){var ci=this._find(Xn,!1);return ci>=0?this._values[ci]:void 0},li.prototype.set=function(Xn,ci){var Hi=this._find(Xn,!0);return this._values[Hi]=ci,this},li.prototype.delete=function(Xn){var ci=this._find(Xn,!1);if(ci>=0){for(var Hi=this._keys.length,Yi=ci+1;Yi<Hi;Yi++)this._keys[Yi-1]=this._keys[Yi],this._values[Yi-1]=this._values[Yi];return this._keys.length--,this._values.length--,Xn===this._cacheKey&&(this._cacheKey=jt,this._cacheIndex=-2),!0}return!1},li.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=jt,this._cacheIndex=-2},li.prototype.keys=function(){return new Xr(this._keys,this._values,vn)},li.prototype.values=function(){return new Xr(this._keys,this._values,Kr)},li.prototype.entries=function(){return new Xr(this._keys,this._values,ba)},li.prototype["@@iterator"]=function(){return this.entries()},li.prototype[se]=function(){return this.entries()},li.prototype._find=function(Xn,ci){return this._cacheKey!==Xn&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Xn)),this._cacheIndex<0&&ci&&(this._cacheIndex=this._keys.length,this._keys.push(Xn),this._values.push(void 0)),this._cacheIndex},li}();function vn(li,Xn){return li}function Kr(li,Xn){return Xn}function ba(li,Xn){return[li,Xn]}}function Bi(){return function(){function jt(){this._map=new gt}return Object.defineProperty(jt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),jt.prototype.has=function(_r){return this._map.has(_r)},jt.prototype.add=function(_r){return this._map.set(_r,_r),this},jt.prototype.delete=function(_r){return this._map.delete(_r)},jt.prototype.clear=function(){this._map.clear()},jt.prototype.keys=function(){return this._map.keys()},jt.prototype.values=function(){return this._map.values()},jt.prototype.entries=function(){return this._map.entries()},jt.prototype["@@iterator"]=function(){return this.keys()},jt.prototype[se]=function(){return this.keys()},jt}()}function Mo(){var jt=16,_r=tt.create(),Xr=vn();return function(){function ci(){this._key=vn()}return ci.prototype.has=function(Hi){var Yi=Kr(Hi,!1);return Yi!==void 0?tt.has(Yi,this._key):!1},ci.prototype.get=function(Hi){var Yi=Kr(Hi,!1);return Yi!==void 0?tt.get(Yi,this._key):void 0},ci.prototype.set=function(Hi,Yi){var No=Kr(Hi,!0);return No[this._key]=Yi,this},ci.prototype.delete=function(Hi){var Yi=Kr(Hi,!1);return Yi!==void 0?delete Yi[this._key]:!1},ci.prototype.clear=function(){this._key=vn()},ci}();function vn(){var ci;do ci="@@WeakMap@@"+Xn();while(tt.has(_r,ci));return _r[ci]=!0,ci}function Kr(ci,Hi){if(!z.call(ci,Xr)){if(!Hi)return;Object.defineProperty(ci,Xr,{value:tt.create()})}return ci[Xr]}function ba(ci,Hi){for(var Yi=0;Yi<Hi;++Yi)ci[Yi]=Math.random()*255|0;return ci}function li(ci){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(ci)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(ci)):ba(new Uint8Array(ci),ci):ba(new Array(ci),ci)}function Xn(){var ci=li(jt);ci[6]=ci[6]&79|64,ci[8]=ci[8]&191|128;for(var Hi="",Yi=0;Yi<jt;++Yi){var No=ci[Yi];(Yi===4||Yi===6||Yi===8)&&(Hi+="-"),No<16&&(Hi+="0"),Hi+=No.toString(16).toLowerCase()}return Hi}}function os(jt){return jt.__=void 0,delete jt.__,jt}})})(H||(H={}))}).call(this,w("Q2Ig"),w("IyRk"))},mTTR:function(ae,Z,w){var N=w("b80T"),G=w("QcOe"),H=w("MMmD");function B(h){return H(h)?N(h,!0):G(h)}ae.exports=B},mc0g:function(ae,Z){function w(N){return function(G,H,B){for(var h=-1,z=Object(G),U=B(G),Q=U.length;Q--;){var se=U[N?Q:++h];if(H(z[se],se,z)===!1)break}return G}}ae.exports=w},mhV4:function(ae,Z,w){var N=w("ZK94");ae.exports.geometry=G,ae.exports.ring=B;function G(z){var U=0,Q;switch(z.type){case"Polygon":return H(z.coordinates);case"MultiPolygon":for(Q=0;Q<z.coordinates.length;Q++)U+=H(z.coordinates[Q]);return U;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Q=0;Q<z.geometries.length;Q++)U+=G(z.geometries[Q]);return U}}function H(z){var U=0;if(z&&z.length>0){U+=Math.abs(B(z[0]));for(var Q=1;Q<z.length;Q++)U-=Math.abs(B(z[Q]))}return U}function B(z){var U,Q,se,Ce,be,st,tt,ut=0,ht=z.length;if(ht>2){for(tt=0;tt<ht;tt++)tt===ht-2?(Ce=ht-2,be=ht-1,st=0):tt===ht-1?(Ce=ht-1,be=0,st=1):(Ce=tt,be=tt+1,st=tt+2),U=z[Ce],Q=z[be],se=z[st],ut+=(h(se[0])-h(U[0]))*Math.sin(h(Q[1]));ut=ut*N.RADIUS*N.RADIUS/2}return ut}function h(z){return z*Math.PI/180}},mpbz:function(ae,Z,w){(function(N,G){ae.exports=G()})(this,function(){"use strict";function N(Rt,ke,Mt,Nt,nr,Mr){if(!(nr-Nt<=Mt)){var Jr=Nt+nr>>1;G(Rt,ke,Jr,Nt,nr,Mr%2),N(Rt,ke,Mt,Nt,Jr-1,Mr+1),N(Rt,ke,Mt,Jr+1,nr,Mr+1)}}function G(Rt,ke,Mt,Nt,nr,Mr){for(;nr>Nt;){if(nr-Nt>600){var Jr=nr-Nt+1,Er=Mt-Nt+1,de=Math.log(Jr),Ie=.5*Math.exp(2*de/3),we=.5*Math.sqrt(de*Ie*(Jr-Ie)/Jr)*(Er-Jr/2<0?-1:1),ct=Math.max(Nt,Math.floor(Mt-Er*Ie/Jr+we)),ot=Math.min(nr,Math.floor(Mt+(Jr-Er)*Ie/Jr+we));G(Rt,ke,Mt,ct,ot,Mr)}var wt=ke[2*Mt+Mr],S=Nt,ur=nr;for(H(Rt,ke,Nt,Mt),ke[2*nr+Mr]>wt&&H(Rt,ke,Nt,nr);S<ur;){for(H(Rt,ke,S,ur),S++,ur--;ke[2*S+Mr]<wt;)S++;for(;ke[2*ur+Mr]>wt;)ur--}ke[2*Nt+Mr]===wt?H(Rt,ke,Nt,ur):(ur++,H(Rt,ke,ur,nr)),ur<=Mt&&(Nt=ur+1),Mt<=ur&&(nr=ur-1)}}function H(Rt,ke,Mt,Nt){B(Rt,Mt,Nt),B(ke,2*Mt,2*Nt),B(ke,2*Mt+1,2*Nt+1)}function B(Rt,ke,Mt){var Nt=Rt[ke];Rt[ke]=Rt[Mt],Rt[Mt]=Nt}function h(Rt,ke,Mt,Nt,nr,Mr,Jr){for(var Er=[0,Rt.length-1,0],de=[],Ie,we;Er.length;){var ct=Er.pop(),ot=Er.pop(),wt=Er.pop();if(ot-wt<=Jr){for(var S=wt;S<=ot;S++)Ie=ke[2*S],we=ke[2*S+1],Ie>=Mt&&Ie<=nr&&we>=Nt&&we<=Mr&&de.push(Rt[S]);continue}var ur=Math.floor((wt+ot)/2);Ie=ke[2*ur],we=ke[2*ur+1],Ie>=Mt&&Ie<=nr&&we>=Nt&&we<=Mr&&de.push(Rt[ur]);var Pt=(ct+1)%2;(ct===0?Mt<=Ie:Nt<=we)&&(Er.push(wt),Er.push(ur-1),Er.push(Pt)),(ct===0?nr>=Ie:Mr>=we)&&(Er.push(ur+1),Er.push(ot),Er.push(Pt))}return de}function z(Rt,ke,Mt,Nt,nr,Mr){for(var Jr=[0,Rt.length-1,0],Er=[],de=nr*nr;Jr.length;){var Ie=Jr.pop(),we=Jr.pop(),ct=Jr.pop();if(we-ct<=Mr){for(var ot=ct;ot<=we;ot++)U(ke[2*ot],ke[2*ot+1],Mt,Nt)<=de&&Er.push(Rt[ot]);continue}var wt=Math.floor((ct+we)/2),S=ke[2*wt],ur=ke[2*wt+1];U(S,ur,Mt,Nt)<=de&&Er.push(Rt[wt]);var Pt=(Ie+1)%2;(Ie===0?Mt-nr<=S:Nt-nr<=ur)&&(Jr.push(ct),Jr.push(wt-1),Jr.push(Pt)),(Ie===0?Mt+nr>=S:Nt+nr>=ur)&&(Jr.push(wt+1),Jr.push(we),Jr.push(Pt))}return Er}function U(Rt,ke,Mt,Nt){var nr=Rt-Mt,Mr=ke-Nt;return nr*nr+Mr*Mr}var Q=function(ke){return ke[0]},se=function(ke){return ke[1]},Ce=function(ke,Mt,Nt,nr,Mr){Mt===void 0&&(Mt=Q),Nt===void 0&&(Nt=se),nr===void 0&&(nr=64),Mr===void 0&&(Mr=Float64Array),this.nodeSize=nr,this.points=ke;for(var Jr=ke.length<65536?Uint16Array:Uint32Array,Er=this.ids=new Jr(ke.length),de=this.coords=new Mr(ke.length*2),Ie=0;Ie<ke.length;Ie++)Er[Ie]=Ie,de[2*Ie]=Mt(ke[Ie]),de[2*Ie+1]=Nt(ke[Ie]);N(Er,de,nr,0,Er.length-1,0)};Ce.prototype.range=function(ke,Mt,Nt,nr){return h(this.ids,this.coords,ke,Mt,Nt,nr,this.nodeSize)},Ce.prototype.within=function(ke,Mt,Nt){return z(this.ids,this.coords,ke,Mt,Nt,this.nodeSize)};var be={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ke){return ke}},st=Math.fround||function(Rt){return function(ke){return Rt[0]=+ke,Rt[0]}}(new Float32Array(1)),tt=function(ke){this.options=Qt(Object.create(be),ke),this.trees=new Array(this.options.maxZoom+1)};tt.prototype.load=function(ke){var Mt=this.options,Nt=Mt.log,nr=Mt.minZoom,Mr=Mt.maxZoom,Jr=Mt.nodeSize;Nt&&console.time("total time");var Er="prepare "+ke.length+" points";Nt&&console.time(Er),this.points=ke;for(var de=[],Ie=0;Ie<ke.length;Ie++)!ke[Ie].geometry||de.push(ht(ke[Ie],Ie));this.trees[Mr+1]=new Ce(de,Ir,br,Jr,Float32Array),Nt&&console.timeEnd(Er);for(var we=Mr;we>=nr;we--){var ct=+Date.now();de=this._cluster(de,we),this.trees[we]=new Ce(de,Ir,br,Jr,Float32Array),Nt&&console.log("z%d: %d clusters in %dms",we,de.length,+Date.now()-ct)}return Nt&&console.timeEnd("total time"),this},tt.prototype.getClusters=function(ke,Mt){var Nt=((ke[0]+180)%360+360)%360-180,nr=Math.max(-90,Math.min(90,ke[1])),Mr=ke[2]===180?180:((ke[2]+180)%360+360)%360-180,Jr=Math.max(-90,Math.min(90,ke[3]));if(ke[2]-ke[0]>=360)Nt=-180,Mr=180;else if(Nt>Mr){var Er=this.getClusters([Nt,nr,180,Jr],Mt),de=this.getClusters([-180,nr,Mr,Jr],Mt);return Er.concat(de)}for(var Ie=this.trees[this._limitZoom(Mt)],we=Ie.range(dt(Nt),rt(Jr),dt(Mr),rt(nr)),ct=[],ot=0,wt=we;ot<wt.length;ot+=1){var S=wt[ot],ur=Ie.points[S];ct.push(ur.numPoints?gt(ur):this.points[ur.index])}return ct},tt.prototype.getChildren=function(ke){var Mt=this._getOriginId(ke),Nt=this._getOriginZoom(ke),nr="No cluster with the specified id.",Mr=this.trees[Nt];if(!Mr)throw new Error(nr);var Jr=Mr.points[Mt];if(!Jr)throw new Error(nr);for(var Er=this.options.radius/(this.options.extent*Math.pow(2,Nt-1)),de=Mr.within(Jr.x,Jr.y,Er),Ie=[],we=0,ct=de;we<ct.length;we+=1){var ot=ct[we],wt=Mr.points[ot];wt.parentId===ke&&Ie.push(wt.numPoints?gt(wt):this.points[wt.index])}if(Ie.length===0)throw new Error(nr);return Ie},tt.prototype.getLeaves=function(ke,Mt,Nt){Mt=Mt||10,Nt=Nt||0;var nr=[];return this._appendLeaves(nr,ke,Mt,Nt,0),nr},tt.prototype.getTile=function(ke,Mt,Nt){var nr=this.trees[this._limitZoom(ke)],Mr=Math.pow(2,ke),Jr=this.options,Er=Jr.extent,de=Jr.radius,Ie=de/Er,we=(Nt-Ie)/Mr,ct=(Nt+1+Ie)/Mr,ot={features:[]};return this._addTileFeatures(nr.range((Mt-Ie)/Mr,we,(Mt+1+Ie)/Mr,ct),nr.points,Mt,Nt,Mr,ot),Mt===0&&this._addTileFeatures(nr.range(1-Ie/Mr,we,1,ct),nr.points,Mr,Nt,Mr,ot),Mt===Mr-1&&this._addTileFeatures(nr.range(0,we,Ie/Mr,ct),nr.points,-1,Nt,Mr,ot),ot.features.length?ot:null},tt.prototype.getClusterExpansionZoom=function(ke){for(var Mt=this._getOriginZoom(ke)-1;Mt<=this.options.maxZoom;){var Nt=this.getChildren(ke);if(Mt++,Nt.length!==1)break;ke=Nt[0].properties.cluster_id}return Mt},tt.prototype._appendLeaves=function(ke,Mt,Nt,nr,Mr){for(var Jr=this.getChildren(Mt),Er=0,de=Jr;Er<de.length;Er+=1){var Ie=de[Er],we=Ie.properties;if(we&&we.cluster?Mr+we.point_count<=nr?Mr+=we.point_count:Mr=this._appendLeaves(ke,we.cluster_id,Nt,nr,Mr):Mr<nr?Mr++:ke.push(Ie),ke.length===Nt)break}return Mr},tt.prototype._addTileFeatures=function(ke,Mt,Nt,nr,Mr,Jr){for(var Er=0,de=ke;Er<de.length;Er+=1){var Ie=de[Er],we=Mt[Ie],ct=we.numPoints,ot=void 0,wt=void 0,S=void 0;if(ct)ot=Be(we),wt=we.x,S=we.y;else{var ur=this.points[we.index];ot=ur.properties,wt=dt(ur.geometry.coordinates[0]),S=rt(ur.geometry.coordinates[1])}var Pt={type:1,geometry:[[Math.round(this.options.extent*(wt*Mr-Nt)),Math.round(this.options.extent*(S*Mr-nr))]],tags:ot},Ft=void 0;ct?Ft=we.id:this.options.generateId?Ft=we.index:this.points[we.index].id&&(Ft=this.points[we.index].id),Ft!==void 0&&(Pt.id=Ft),Jr.features.push(Pt)}},tt.prototype._limitZoom=function(ke){return Math.max(this.options.minZoom,Math.min(+ke,this.options.maxZoom+1))},tt.prototype._cluster=function(ke,Mt){for(var Nt=[],nr=this.options,Mr=nr.radius,Jr=nr.extent,Er=nr.reduce,de=nr.minPoints,Ie=Mr/(Jr*Math.pow(2,Mt)),we=0;we<ke.length;we++){var ct=ke[we];if(!(ct.zoom<=Mt)){ct.zoom=Mt;for(var ot=this.trees[Mt+1],wt=ot.within(ct.x,ct.y,Ie),S=ct.numPoints||1,ur=S,Pt=0,Ft=wt;Pt<Ft.length;Pt+=1){var Et=Ft[Pt],St=ot.points[Et];St.zoom>Mt&&(ur+=St.numPoints||1)}if(ur>S&&ur>=de){for(var Zt=ct.x*S,dr=ct.y*S,qt=Er&&S>1?this._map(ct,!0):null,pr=(we<<5)+(Mt+1)+this.points.length,Ur=0,gr=wt;Ur<gr.length;Ur+=1){var or=gr[Ur],Rr=ot.points[or];if(!(Rr.zoom<=Mt)){Rr.zoom=Mt;var Hn=Rr.numPoints||1;Zt+=Rr.x*Hn,dr+=Rr.y*Hn,Rr.parentId=pr,Er&&(qt||(qt=this._map(ct,!0)),Er(qt,this._map(Rr)))}}ct.parentId=pr,Nt.push(ut(Zt/ur,dr/ur,pr,ur,qt))}else if(Nt.push(ct),ur>1)for(var en=0,_n=wt;en<_n.length;en+=1){var qn=_n[en],ii=ot.points[qn];ii.zoom<=Mt||(ii.zoom=Mt,Nt.push(ii))}}}return Nt},tt.prototype._getOriginId=function(ke){return ke-this.points.length>>5},tt.prototype._getOriginZoom=function(ke){return(ke-this.points.length)%32},tt.prototype._map=function(ke,Mt){if(ke.numPoints)return Mt?Qt({},ke.properties):ke.properties;var Nt=this.points[ke.index].properties,nr=this.options.map(Nt);return Mt&&nr===Nt?Qt({},nr):nr};function ut(Rt,ke,Mt,Nt,nr){return{x:st(Rt),y:st(ke),zoom:Infinity,id:Mt,parentId:-1,numPoints:Nt,properties:nr}}function ht(Rt,ke){var Mt=Rt.geometry.coordinates,Nt=Mt[0],nr=Mt[1];return{x:st(dt(Nt)),y:st(rt(nr)),zoom:Infinity,index:ke,parentId:-1}}function gt(Rt){return{type:"Feature",id:Rt.id,properties:Be(Rt),geometry:{type:"Point",coordinates:[lt(Rt.x),$(Rt.y)]}}}function Be(Rt){var ke=Rt.numPoints,Mt=ke>=1e4?Math.round(ke/1e3)+"k":ke>=1e3?Math.round(ke/100)/10+"k":ke;return Qt(Qt({},Rt.properties),{cluster:!0,cluster_id:Rt.id,point_count:ke,point_count_abbreviated:Mt})}function dt(Rt){return Rt/360+.5}function rt(Rt){var ke=Math.sin(Rt*Math.PI/180),Mt=.5-.25*Math.log((1+ke)/(1-ke))/Math.PI;return Mt<0?0:Mt>1?1:Mt}function lt(Rt){return(Rt-.5)*360}function $(Rt){var ke=(180-Rt*360)*Math.PI/180;return 360*Math.atan(Math.exp(ke))/Math.PI-90}function Qt(Rt,ke){for(var Mt in ke)Rt[Mt]=ke[Mt];return Rt}function Ir(Rt){return Rt.x}function br(Rt){return Rt.y}return tt})},"mv/X":function(ae,Z,w){var N=w("ljhN"),G=w("MMmD"),H=w("wJg7"),B=w("GoyQ");function h(z,U,Q){if(!B(Q))return!1;var se=typeof U;return(se=="number"?G(Q)&&H(U,Q.length):se=="string"&&U in Q)?N(Q[U],z):!1}ae.exports=h},n2J3:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.unmanaged=void 0;var N=w("xfSm"),G=w("GXnB"),H=w("Ztfv");function B(){return function(h,z,U){var Q=new G.Metadata(N.UNMANAGED_TAG,!0);H.tagParameter(h,z,U,Q)}}Z.unmanaged=B},n3AX:function(ae,Z,w){var N=w("Nsbk");function G(H,B){for(;!Object.prototype.hasOwnProperty.call(H,B)&&(H=N(H),H!==null););return H}ae.exports=G,ae.exports.__esModule=!0,ae.exports.default=ae.exports},"oCl/":function(ae,Z,w){var N=w("CH3K"),G=w("LcsW"),H=w("MvSz"),B=w("0ycA"),h=Object.getOwnPropertySymbols,z=h?function(U){for(var Q=[];U;)N(Q,H(U)),U=G(U);return Q}:B;ae.exports=z},oIFs:function(ae,Z,w){},oShl:function(ae,Z,w){var N=w("Nsbk"),G=w("SksO"),H=w("xfeJ"),B=w("sXyB");function h(z){var U=typeof Map=="function"?new Map:void 0;return ae.exports=h=function(se){if(se===null||!H(se))return se;if(typeof se!="function")throw new TypeError("Super expression must either be null or a function");if(typeof U!="undefined"){if(U.has(se))return U.get(se);U.set(se,Ce)}function Ce(){return B(se,arguments,N(this).constructor)}return Ce.prototype=Object.create(se.prototype,{constructor:{value:Ce,enumerable:!1,writable:!0,configurable:!0}}),G(Ce,se)},ae.exports.__esModule=!0,ae.exports.default=ae.exports,h(z)}ae.exports=h,ae.exports.__esModule=!0,ae.exports.default=ae.exports},oaX6:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.targetName=void 0;var N=w("xfSm"),G=w("GXnB"),H=w("Ztfv");function B(h){return function(z,U,Q){var se=new G.Metadata(N.NAME_TAG,h);H.tagParameter(z,U,Q,se)}}Z.targetName=B},"otv/":function(ae,Z,w){var N=w("nmnc"),G=N?N.prototype:void 0,H=G?G.valueOf:void 0;function B(h){return H?Object(H.call(h)):{}}ae.exports=B},"oy+k":function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.Context=void 0;var N=w("d9O0"),G=function(){function H(B){this.id=N.id(),this.container=B}return H.prototype.addPlan=function(B){this.plan=B},H.prototype.setCurrentRequest=function(B){this.currentRequest=B},H}();Z.Context=G},pFRH:function(ae,Z,w){var N=w("cvCv"),G=w("O0oS"),H=w("zZ0H"),B=G?function(h,z){return G(h,"toString",{configurable:!0,enumerable:!1,value:N(z),writable:!0})}:H;ae.exports=B},q4HE:function(ae,Z){var w="\\ud800-\\udfff",N="\\u0300-\\u036f",G="\\ufe20-\\ufe2f",H="\\u20d0-\\u20ff",B=N+G+H,h="\\ufe0e\\ufe0f",z="["+w+"]",U="["+B+"]",Q="\\ud83c[\\udffb-\\udfff]",se="(?:"+U+"|"+Q+")",Ce="[^"+w+"]",be="(?:\\ud83c[\\udde6-\\uddff]){2}",st="[\\ud800-\\udbff][\\udc00-\\udfff]",tt="\\u200d",ut=se+"?",ht="["+h+"]?",gt="(?:"+tt+"(?:"+[Ce,be,st].join("|")+")"+ht+ut+")*",Be=ht+ut+gt,dt="(?:"+[Ce+U+"?",U,be,st,z].join("|")+")",rt=RegExp(Q+"(?="+Q+")|"+dt+Be,"g");function lt($){for(var Qt=rt.lastIndex=0;rt.test($);)++Qt;return Qt}ae.exports=lt},qK8v:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.isStackOverflowExeption=void 0;var N=w("MON2");function G(H){return H instanceof RangeError||H.message===N.STACK_OVERFLOW}Z.isStackOverflowExeption=G},qRkn:function(ae,Z,w){var N=w("3cYt"),G={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},H=N(G);ae.exports=H},quyA:function(ae,Z){var w="\\ud800-\\udfff",N="\\u0300-\\u036f",G="\\ufe20-\\ufe2f",H="\\u20d0-\\u20ff",B=N+G+H,h="\\ufe0e\\ufe0f",z="\\u200d",U=RegExp("["+z+w+B+h+"]");function Q(se){return U.test(se)}ae.exports=Q},sGsY:function(ae,Z,w){"use strict";var N=w("rePB"),G=w("wx14"),H=w("q1tI"),B=w("TSYQ"),h=w.n(B),z=w("H84U"),U=w("/ezw"),Q=w("B6l+"),se=w.n(Q),Ce=function(Er){var de=Er.value,Ie=Er.formatter,we=Er.precision,ct=Er.decimalSeparator,ot=Er.groupSeparator,wt=ot===void 0?"":ot,S=Er.prefixCls,ur;if(typeof Ie=="function")ur=Ie(de);else{var Pt=String(de),Ft=Pt.match(/^(-?)(\d*)(\.(\d+))?$/);if(!Ft||Pt==="-")ur=Pt;else{var Et=Ft[1],St=Ft[2]||"0",Zt=Ft[4]||"";St=St.replace(/\B(?=(\d{3})+(?!\d))/g,wt),typeof we=="number"&&(Zt=se()(Zt,we,"0").slice(0,we)),Zt&&(Zt="".concat(ct).concat(Zt)),ur=[H.createElement("span",{key:"int",className:"".concat(S,"-content-value-int")},Et,St),Zt&&H.createElement("span",{key:"decimal",className:"".concat(S,"-content-value-decimal")},Zt)]}}return H.createElement("span",{className:"".concat(S,"-content-value")},ur)},be=Ce,st=function(Er){var de=Er.prefixCls,Ie=Er.className,we=Er.style,ct=Er.valueStyle,ot=Er.value,wt=ot===void 0?0:ot,S=Er.title,ur=Er.valueRender,Pt=Er.prefix,Ft=Er.suffix,Et=Er.loading,St=Er.direction,Zt=Er.onMouseEnter,dr=Er.onMouseLeave,qt=H.createElement(be,Object(G.a)({},Er,{value:wt})),pr=h()(de,Object(N.a)({},"".concat(de,"-rtl"),St==="rtl"),Ie);return H.createElement("div",{className:pr,style:we,onMouseEnter:Zt,onMouseLeave:dr},S&&H.createElement("div",{className:"".concat(de,"-title")},S),H.createElement(U.a,{paragraph:!1,loading:Et},H.createElement("div",{style:ct,className:"".concat(de,"-content")},Pt&&H.createElement("span",{className:"".concat(de,"-content-prefix")},Pt),ur?ur(qt):qt,Ft&&H.createElement("span",{className:"".concat(de,"-content-suffix")},Ft))))};st.defaultProps={decimalSeparator:".",groupSeparator:",",loading:!1};var tt=Object(z.c)({prefixCls:"statistic"})(st),ut=tt,ht=w("1OyB"),gt=w("vuIU"),Be=w("Ji7U"),dt=w("LK+K"),rt=w("ODXe"),lt=w("QQZ/"),$=w.n(lt),Qt=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Ir(Jr,Er){var de=Jr,Ie=/\[[^\]]*]/g,we=(Er.match(Ie)||[]).map(function(S){return S.slice(1,-1)}),ct=Er.replace(Ie,"[]"),ot=Qt.reduce(function(S,ur){var Pt=Object(rt.a)(ur,2),Ft=Pt[0],Et=Pt[1];if(S.indexOf(Ft)!==-1){var St=Math.floor(de/Et);return de-=St*Et,S.replace(new RegExp("".concat(Ft,"+"),"g"),function(Zt){var dr=Zt.length;return $()(St.toString(),dr,"0")})}return S},ct),wt=0;return ot.replace(Ie,function(){var S=we[wt];return wt+=1,S})}function br(Jr,Er){var de=Er.format,Ie=de===void 0?"":de,we=new Date(Jr).getTime(),ct=Date.now(),ot=Math.max(we-ct,0);return Ir(ot,Ie)}var Rt=w("0n0R"),ke=1e3/30;function Mt(Jr){return new Date(Jr).getTime()}var Nt=function(Jr){Object(Be.a)(de,Jr);var Er=Object(dt.a)(de);function de(){var Ie;return Object(ht.a)(this,de),Ie=Er.apply(this,arguments),Ie.syncTimer=function(){var we=Ie.props.value,ct=Mt(we);ct>=Date.now()?Ie.startTimer():Ie.stopTimer()},Ie.startTimer=function(){if(!Ie.countdownId){var we=Ie.props,ct=we.onChange,ot=we.value,wt=Mt(ot);Ie.countdownId=window.setInterval(function(){Ie.forceUpdate(),ct&&wt>Date.now()&&ct(wt-Date.now())},ke)}},Ie.stopTimer=function(){var we=Ie.props,ct=we.onFinish,ot=we.value;if(Ie.countdownId){clearInterval(Ie.countdownId),Ie.countdownId=void 0;var wt=Mt(ot);ct&&wt<Date.now()&&ct()}},Ie.formatCountdown=function(we,ct){var ot=Ie.props.format;return br(we,Object(G.a)(Object(G.a)({},ct),{format:ot}))},Ie.valueRender=function(we){return Object(Rt.a)(we,{title:void 0})},Ie}return Object(gt.a)(de,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return H.createElement(ut,Object(G.a)({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),de}(H.Component);Nt.defaultProps={format:"HH:mm:ss"};var nr=Nt;ut.Countdown=nr;var Mr=Z.a=ut},sKgW:function(ae,Z){var w=9007199254740991,N=Math.floor;function G(H,B){var h="";if(!H||B<1||B>w)return h;do B%2&&(h+=H),B=N(B/2),B&&(H+=H);while(B);return h}ae.exports=G},sXyB:function(ae,Z,w){var N=w("SksO"),G=w("b48C");function H(B,h,z){return G()?(ae.exports=H=Reflect.construct,ae.exports.__esModule=!0,ae.exports.default=ae.exports):(ae.exports=H=function(Q,se,Ce){var be=[null];be.push.apply(be,se);var st=Function.bind.apply(Q,be),tt=new st;return Ce&&N(tt,Ce.prototype),tt},ae.exports.__esModule=!0,ae.exports.default=ae.exports),H.apply(null,arguments)}ae.exports=H,ae.exports.__esModule=!0,ae.exports.default=ae.exports},sgoq:function(ae,Z,w){var N=w("asDA"),G=w("TKrE"),H=w("6nK8"),B="['\u2019]",h=RegExp(B,"g");function z(U){return function(Q){return N(H(G(Q).replace(h,"")),U,"")}}ae.exports=z},szb8:function(ae,Z,w){"use strict";w.r(Z),w.d(Z,"Interpreter",function(){return Ca}),w.d(Z,"vm",function(){return N}),w.d(Z,"evaluate",function(){return wl}),w.d(Z,"Function",function(){return cu});var N={};w.r(N),w.d(N,"createContext",function(){return Va}),w.d(N,"compileFunction",function(){return lu}),w.d(N,"runInContext",function(){return Tu}),w.d(N,"runInNewContext",function(){return rh}),w.d(N,"Script",function(){return Al});var G={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},H="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",B={5:H,"5module":H+" export import",6:H+" const class extends export import super"},h=/^in(stanceof)?$/,z="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",U="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF\u1AC0\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F",Q=new RegExp("["+z+"]"),se=new RegExp("["+z+U+"]");z=U=null;var Ce=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],be=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function st(_,O){for(var V=65536,L=0;L<O.length;L+=2){if(V+=O[L],V>_)return!1;if(V+=O[L+1],V>=_)return!0}}function tt(_,O){return _<65?_===36:_<91?!0:_<97?_===95:_<123?!0:_<=65535?_>=170&&Q.test(String.fromCharCode(_)):O===!1?!1:st(_,Ce)}function ut(_,O){return _<48?_===36:_<58?!0:_<65?!1:_<91?!0:_<97?_===95:_<123?!0:_<=65535?_>=170&&se.test(String.fromCharCode(_)):O===!1?!1:st(_,Ce)||st(_,be)}var ht=function(O,V){V===void 0&&(V={}),this.label=O,this.keyword=V.keyword,this.beforeExpr=!!V.beforeExpr,this.startsExpr=!!V.startsExpr,this.isLoop=!!V.isLoop,this.isAssign=!!V.isAssign,this.prefix=!!V.prefix,this.postfix=!!V.postfix,this.binop=V.binop||null,this.updateContext=null};function gt(_,O){return new ht(_,{beforeExpr:!0,binop:O})}var Be={beforeExpr:!0},dt={startsExpr:!0},rt={};function lt(_,O){return O===void 0&&(O={}),O.keyword=_,rt[_]=new ht(_,O)}var $={num:new ht("num",dt),regexp:new ht("regexp",dt),string:new ht("string",dt),name:new ht("name",dt),eof:new ht("eof"),bracketL:new ht("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new ht("]"),braceL:new ht("{",{beforeExpr:!0,startsExpr:!0}),braceR:new ht("}"),parenL:new ht("(",{beforeExpr:!0,startsExpr:!0}),parenR:new ht(")"),comma:new ht(",",Be),semi:new ht(";",Be),colon:new ht(":",Be),dot:new ht("."),question:new ht("?",Be),questionDot:new ht("?."),arrow:new ht("=>",Be),template:new ht("template"),invalidTemplate:new ht("invalidTemplate"),ellipsis:new ht("...",Be),backQuote:new ht("`",dt),dollarBraceL:new ht("${",{beforeExpr:!0,startsExpr:!0}),eq:new ht("=",{beforeExpr:!0,isAssign:!0}),assign:new ht("_=",{beforeExpr:!0,isAssign:!0}),incDec:new ht("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new ht("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:gt("||",1),logicalAND:gt("&&",2),bitwiseOR:gt("|",3),bitwiseXOR:gt("^",4),bitwiseAND:gt("&",5),equality:gt("==/!=/===/!==",6),relational:gt("</>/<=/>=",7),bitShift:gt("<</>>/>>>",8),plusMin:new ht("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:gt("%",10),star:gt("*",10),slash:gt("/",10),starstar:new ht("**",{beforeExpr:!0}),coalesce:gt("??",1),_break:lt("break"),_case:lt("case",Be),_catch:lt("catch"),_continue:lt("continue"),_debugger:lt("debugger"),_default:lt("default",Be),_do:lt("do",{isLoop:!0,beforeExpr:!0}),_else:lt("else",Be),_finally:lt("finally"),_for:lt("for",{isLoop:!0}),_function:lt("function",dt),_if:lt("if"),_return:lt("return",Be),_switch:lt("switch"),_throw:lt("throw",Be),_try:lt("try"),_var:lt("var"),_const:lt("const"),_while:lt("while",{isLoop:!0}),_with:lt("with"),_new:lt("new",{beforeExpr:!0,startsExpr:!0}),_this:lt("this",dt),_super:lt("super",dt),_class:lt("class",dt),_extends:lt("extends",Be),_export:lt("export"),_import:lt("import",dt),_null:lt("null",dt),_true:lt("true",dt),_false:lt("false",dt),_in:lt("in",{beforeExpr:!0,binop:7}),_instanceof:lt("instanceof",{beforeExpr:!0,binop:7}),_typeof:lt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:lt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:lt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Qt=/\r\n?|\n|\u2028|\u2029/,Ir=new RegExp(Qt.source,"g");function br(_,O){return _===10||_===13||!O&&(_===8232||_===8233)}var Rt=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,ke=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Mt=Object.prototype,Nt=Mt.hasOwnProperty,nr=Mt.toString;function Mr(_,O){return Nt.call(_,O)}var Jr=Array.isArray||function(_){return nr.call(_)==="[object Array]"};function Er(_){return new RegExp("^(?:"+_.replace(/ /g,"|")+")$")}var de=function(O,V){this.line=O,this.column=V};de.prototype.offset=function(O){return new de(this.line,this.column+O)};var Ie=function(O,V,L){this.start=V,this.end=L,O.sourceFile!==null&&(this.source=O.sourceFile)};function we(_,O){for(var V=1,L=0;;){Ir.lastIndex=L;var ne=Ir.exec(_);if(ne&&ne.index<O)++V,L=ne.index+ne[0].length;else return new de(V,O-L)}}var ct={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function ot(_){var O={};for(var V in ct)O[V]=_&&Mr(_,V)?_[V]:ct[V];if(O.ecmaVersion>=2015&&(O.ecmaVersion-=2009),O.allowReserved==null&&(O.allowReserved=O.ecmaVersion<5),Jr(O.onToken)){var L=O.onToken;O.onToken=function(ne){return L.push(ne)}}return Jr(O.onComment)&&(O.onComment=wt(O,O.onComment)),O}function wt(_,O){return function(V,L,ne,Te,Je,pt){var Tt={type:V?"Block":"Line",value:L,start:ne,end:Te};_.locations&&(Tt.loc=new Ie(this,Je,pt)),_.ranges&&(Tt.range=[ne,Te]),O.push(Tt)}}var S=1,ur=2,Pt=S|ur,Ft=4,Et=8,St=16,Zt=32,dr=64,qt=128;function pr(_,O){return ur|(_?Ft:0)|(O?Et:0)}var Ur=0,gr=1,or=2,Rr=3,Hn=4,en=5,_n=function(O,V,L){this.options=O=ot(O),this.sourceFile=O.sourceFile,this.keywords=Er(B[O.ecmaVersion>=6?6:O.sourceType==="module"?"5module":5]);var ne="";if(O.allowReserved!==!0){for(var Te=O.ecmaVersion;!(ne=G[Te]);Te--);O.sourceType==="module"&&(ne+=" await")}this.reservedWords=Er(ne);var Je=(ne?ne+" ":"")+G.strict;this.reservedWordsStrict=Er(Je),this.reservedWordsStrictBind=Er(Je+" "+G.strictBind),this.input=String(V),this.containsEsc=!1,L?(this.pos=L,this.lineStart=this.input.lastIndexOf(`
`,L-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Qt).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=$.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=O.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},this.pos===0&&O.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(S),this.regexpState=null},qn={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};_n.prototype.parse=function(){var O=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(O)},qn.inFunction.get=function(){return(this.currentVarScope().flags&ur)>0},qn.inGenerator.get=function(){return(this.currentVarScope().flags&Et)>0},qn.inAsync.get=function(){return(this.currentVarScope().flags&Ft)>0},qn.allowSuper.get=function(){return(this.currentThisScope().flags&dr)>0},qn.allowDirectSuper.get=function(){return(this.currentThisScope().flags&qt)>0},qn.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},_n.prototype.inNonArrowFunction=function(){return(this.currentThisScope().flags&ur)>0},_n.extend=function(){for(var O=[],V=arguments.length;V--;)O[V]=arguments[V];for(var L=this,ne=0;ne<O.length;ne++)L=O[ne](L);return L},_n.parse=function(O,V){return new this(V,O).parse()},_n.parseExpressionAt=function(O,V,L){var ne=new this(L,O,V);return ne.nextToken(),ne.parseExpression()},_n.tokenizer=function(O,V){return new this(V,O)},Object.defineProperties(_n.prototype,qn);var ii=_n.prototype,Xi=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;ii.strictDirective=function(_){for(;;){ke.lastIndex=_,_+=ke.exec(this.input)[0].length;var O=Xi.exec(this.input.slice(_));if(!O)return!1;if((O[1]||O[2])==="use strict"){ke.lastIndex=_+O[0].length;var V=ke.exec(this.input),L=V.index+V[0].length,ne=this.input.charAt(L);return ne===";"||ne==="}"||Qt.test(V[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(ne)||ne==="!"&&this.input.charAt(L+1)==="=")}_+=O[0].length,ke.lastIndex=_,_+=ke.exec(this.input)[0].length,this.input[_]===";"&&_++}},ii.eat=function(_){return this.type===_?(this.next(),!0):!1},ii.isContextual=function(_){return this.type===$.name&&this.value===_&&!this.containsEsc},ii.eatContextual=function(_){return this.isContextual(_)?(this.next(),!0):!1},ii.expectContextual=function(_){this.eatContextual(_)||this.unexpected()},ii.canInsertSemicolon=function(){return this.type===$.eof||this.type===$.braceR||Qt.test(this.input.slice(this.lastTokEnd,this.start))},ii.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},ii.semicolon=function(){!this.eat($.semi)&&!this.insertSemicolon()&&this.unexpected()},ii.afterTrailingComma=function(_,O){if(this.type===_)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),O||this.next(),!0},ii.expect=function(_){this.eat(_)||this.unexpected()},ii.unexpected=function(_){this.raise(_!=null?_:this.start,"Unexpected token")};function me(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}ii.checkPatternErrors=function(_,O){if(!!_){_.trailingComma>-1&&this.raiseRecoverable(_.trailingComma,"Comma is not permitted after the rest element");var V=O?_.parenthesizedAssign:_.parenthesizedBind;V>-1&&this.raiseRecoverable(V,"Parenthesized pattern")}},ii.checkExpressionErrors=function(_,O){if(!_)return!1;var V=_.shorthandAssign,L=_.doubleProto;if(!O)return V>=0||L>=0;V>=0&&this.raise(V,"Shorthand property assignments are valid only in destructuring patterns"),L>=0&&this.raiseRecoverable(L,"Redefinition of __proto__ property")},ii.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},ii.isSimpleAssignTarget=function(_){return _.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(_.expression):_.type==="Identifier"||_.type==="MemberExpression"};var yn=_n.prototype;yn.parseTopLevel=function(_){var O={};for(_.body||(_.body=[]);this.type!==$.eof;){var V=this.parseStatement(null,!0,O);_.body.push(V)}if(this.inModule)for(var L=0,ne=Object.keys(this.undefinedExports);L<ne.length;L+=1){var Te=ne[L];this.raiseRecoverable(this.undefinedExports[Te].start,"Export '"+Te+"' is not defined")}return this.adaptDirectivePrologue(_.body),this.next(),_.sourceType=this.options.sourceType,this.finishNode(_,"Program")};var Bi={kind:"loop"},Mo={kind:"switch"};yn.isLet=function(_){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;ke.lastIndex=this.pos;var O=ke.exec(this.input),V=this.pos+O[0].length,L=this.input.charCodeAt(V);if(L===91)return!0;if(_)return!1;if(L===123)return!0;if(tt(L,!0)){for(var ne=V+1;ut(this.input.charCodeAt(ne),!0);)++ne;var Te=this.input.slice(V,ne);if(!h.test(Te))return!0}return!1},yn.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;ke.lastIndex=this.pos;var _=ke.exec(this.input),O=this.pos+_[0].length;return!Qt.test(this.input.slice(this.pos,O))&&this.input.slice(O,O+8)==="function"&&(O+8===this.input.length||!ut(this.input.charAt(O+8)))},yn.parseStatement=function(_,O,V){var L=this.type,ne=this.startNode(),Te;switch(this.isLet(_)&&(L=$._var,Te="let"),L){case $._break:case $._continue:return this.parseBreakContinueStatement(ne,L.keyword);case $._debugger:return this.parseDebuggerStatement(ne);case $._do:return this.parseDoStatement(ne);case $._for:return this.parseForStatement(ne);case $._function:return _&&(this.strict||_!=="if"&&_!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(ne,!1,!_);case $._class:return _&&this.unexpected(),this.parseClass(ne,!0);case $._if:return this.parseIfStatement(ne);case $._return:return this.parseReturnStatement(ne);case $._switch:return this.parseSwitchStatement(ne);case $._throw:return this.parseThrowStatement(ne);case $._try:return this.parseTryStatement(ne);case $._const:case $._var:return Te=Te||this.value,_&&Te!=="var"&&this.unexpected(),this.parseVarStatement(ne,Te);case $._while:return this.parseWhileStatement(ne);case $._with:return this.parseWithStatement(ne);case $.braceL:return this.parseBlock(!0,ne);case $.semi:return this.parseEmptyStatement(ne);case $._export:case $._import:if(this.options.ecmaVersion>10&&L===$._import){ke.lastIndex=this.pos;var Je=ke.exec(this.input),pt=this.pos+Je[0].length,Tt=this.input.charCodeAt(pt);if(Tt===40||Tt===46)return this.parseExpressionStatement(ne,this.parseExpression())}return this.options.allowImportExportEverywhere||(O||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),L===$._import?this.parseImport(ne):this.parseExport(ne,V);default:if(this.isAsyncFunction())return _&&this.unexpected(),this.next(),this.parseFunctionStatement(ne,!0,!_);var wr=this.value,Fr=this.parseExpression();return L===$.name&&Fr.type==="Identifier"&&this.eat($.colon)?this.parseLabeledStatement(ne,wr,Fr,_):this.parseExpressionStatement(ne,Fr)}},yn.parseBreakContinueStatement=function(_,O){var V=O==="break";this.next(),this.eat($.semi)||this.insertSemicolon()?_.label=null:this.type!==$.name?this.unexpected():(_.label=this.parseIdent(),this.semicolon());for(var L=0;L<this.labels.length;++L){var ne=this.labels[L];if((_.label==null||ne.name===_.label.name)&&(ne.kind!=null&&(V||ne.kind==="loop")||_.label&&V))break}return L===this.labels.length&&this.raise(_.start,"Unsyntactic "+O),this.finishNode(_,V?"BreakStatement":"ContinueStatement")},yn.parseDebuggerStatement=function(_){return this.next(),this.semicolon(),this.finishNode(_,"DebuggerStatement")},yn.parseDoStatement=function(_){return this.next(),this.labels.push(Bi),_.body=this.parseStatement("do"),this.labels.pop(),this.expect($._while),_.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat($.semi):this.semicolon(),this.finishNode(_,"DoWhileStatement")},yn.parseForStatement=function(_){this.next();var O=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(Bi),this.enterScope(0),this.expect($.parenL),this.type===$.semi)return O>-1&&this.unexpected(O),this.parseFor(_,null);var V=this.isLet();if(this.type===$._var||this.type===$._const||V){var L=this.startNode(),ne=V?"let":this.value;return this.next(),this.parseVar(L,!0,ne),this.finishNode(L,"VariableDeclaration"),(this.type===$._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&L.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===$._in?O>-1&&this.unexpected(O):_.await=O>-1),this.parseForIn(_,L)):(O>-1&&this.unexpected(O),this.parseFor(_,L))}var Te=new me,Je=this.parseExpression(!0,Te);return this.type===$._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===$._in?O>-1&&this.unexpected(O):_.await=O>-1),this.toAssignable(Je,!1,Te),this.checkLVal(Je),this.parseForIn(_,Je)):(this.checkExpressionErrors(Te,!0),O>-1&&this.unexpected(O),this.parseFor(_,Je))},yn.parseFunctionStatement=function(_,O,V){return this.next(),this.parseFunction(_,jt|(V?0:_r),!1,O)},yn.parseIfStatement=function(_){return this.next(),_.test=this.parseParenExpression(),_.consequent=this.parseStatement("if"),_.alternate=this.eat($._else)?this.parseStatement("if"):null,this.finishNode(_,"IfStatement")},yn.parseReturnStatement=function(_){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat($.semi)||this.insertSemicolon()?_.argument=null:(_.argument=this.parseExpression(),this.semicolon()),this.finishNode(_,"ReturnStatement")},yn.parseSwitchStatement=function(_){this.next(),_.discriminant=this.parseParenExpression(),_.cases=[],this.expect($.braceL),this.labels.push(Mo),this.enterScope(0);for(var O,V=!1;this.type!==$.braceR;)if(this.type===$._case||this.type===$._default){var L=this.type===$._case;O&&this.finishNode(O,"SwitchCase"),_.cases.push(O=this.startNode()),O.consequent=[],this.next(),L?O.test=this.parseExpression():(V&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),V=!0,O.test=null),this.expect($.colon)}else O||this.unexpected(),O.consequent.push(this.parseStatement(null));return this.exitScope(),O&&this.finishNode(O,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(_,"SwitchStatement")},yn.parseThrowStatement=function(_){return this.next(),Qt.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),_.argument=this.parseExpression(),this.semicolon(),this.finishNode(_,"ThrowStatement")};var os=[];yn.parseTryStatement=function(_){if(this.next(),_.block=this.parseBlock(),_.handler=null,this.type===$._catch){var O=this.startNode();if(this.next(),this.eat($.parenL)){O.param=this.parseBindingAtom();var V=O.param.type==="Identifier";this.enterScope(V?Zt:0),this.checkLVal(O.param,V?Hn:or),this.expect($.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),O.param=null,this.enterScope(0);O.body=this.parseBlock(!1),this.exitScope(),_.handler=this.finishNode(O,"CatchClause")}return _.finalizer=this.eat($._finally)?this.parseBlock():null,!_.handler&&!_.finalizer&&this.raise(_.start,"Missing catch or finally clause"),this.finishNode(_,"TryStatement")},yn.parseVarStatement=function(_,O){return this.next(),this.parseVar(_,!1,O),this.semicolon(),this.finishNode(_,"VariableDeclaration")},yn.parseWhileStatement=function(_){return this.next(),_.test=this.parseParenExpression(),this.labels.push(Bi),_.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(_,"WhileStatement")},yn.parseWithStatement=function(_){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),_.object=this.parseParenExpression(),_.body=this.parseStatement("with"),this.finishNode(_,"WithStatement")},yn.parseEmptyStatement=function(_){return this.next(),this.finishNode(_,"EmptyStatement")},yn.parseLabeledStatement=function(_,O,V,L){for(var ne=0,Te=this.labels;ne<Te.length;ne+=1){var Je=Te[ne];Je.name===O&&this.raise(V.start,"Label '"+O+"' is already declared")}for(var pt=this.type.isLoop?"loop":this.type===$._switch?"switch":null,Tt=this.labels.length-1;Tt>=0;Tt--){var wr=this.labels[Tt];if(wr.statementStart===_.start)wr.statementStart=this.start,wr.kind=pt;else break}return this.labels.push({name:O,kind:pt,statementStart:this.start}),_.body=this.parseStatement(L?L.indexOf("label")===-1?L+"label":L:"label"),this.labels.pop(),_.label=V,this.finishNode(_,"LabeledStatement")},yn.parseExpressionStatement=function(_,O){return _.expression=O,this.semicolon(),this.finishNode(_,"ExpressionStatement")},yn.parseBlock=function(_,O,V){for(_===void 0&&(_=!0),O===void 0&&(O=this.startNode()),O.body=[],this.expect($.braceL),_&&this.enterScope(0);this.type!==$.braceR;){var L=this.parseStatement(null);O.body.push(L)}return V&&(this.strict=!1),this.next(),_&&this.exitScope(),this.finishNode(O,"BlockStatement")},yn.parseFor=function(_,O){return _.init=O,this.expect($.semi),_.test=this.type===$.semi?null:this.parseExpression(),this.expect($.semi),_.update=this.type===$.parenR?null:this.parseExpression(),this.expect($.parenR),_.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(_,"ForStatement")},yn.parseForIn=function(_,O){var V=this.type===$._in;return this.next(),O.type==="VariableDeclaration"&&O.declarations[0].init!=null&&(!V||this.options.ecmaVersion<8||this.strict||O.kind!=="var"||O.declarations[0].id.type!=="Identifier")?this.raise(O.start,(V?"for-in":"for-of")+" loop variable declaration may not have an initializer"):O.type==="AssignmentPattern"&&this.raise(O.start,"Invalid left-hand side in for-loop"),_.left=O,_.right=V?this.parseExpression():this.parseMaybeAssign(),this.expect($.parenR),_.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(_,V?"ForInStatement":"ForOfStatement")},yn.parseVar=function(_,O,V){for(_.declarations=[],_.kind=V;;){var L=this.startNode();if(this.parseVarId(L,V),this.eat($.eq)?L.init=this.parseMaybeAssign(O):V==="const"&&!(this.type===$._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():L.id.type!=="Identifier"&&!(O&&(this.type===$._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):L.init=null,_.declarations.push(this.finishNode(L,"VariableDeclarator")),!this.eat($.comma))break}return _},yn.parseVarId=function(_,O){_.id=this.parseBindingAtom(),this.checkLVal(_.id,O==="var"?gr:or,!1)};var jt=1,_r=2,Xr=4;yn.parseFunction=function(_,O,V,L){this.initFunction(_),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!L)&&(this.type===$.star&&O&_r&&this.unexpected(),_.generator=this.eat($.star)),this.options.ecmaVersion>=8&&(_.async=!!L),O&jt&&(_.id=O&Xr&&this.type!==$.name?null:this.parseIdent(),_.id&&!(O&_r)&&this.checkLVal(_.id,this.strict||_.generator||_.async?this.treatFunctionsAsVar?gr:or:Rr));var ne=this.yieldPos,Te=this.awaitPos,Je=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(pr(_.async,_.generator)),O&jt||(_.id=this.type===$.name?this.parseIdent():null),this.parseFunctionParams(_),this.parseFunctionBody(_,V,!1),this.yieldPos=ne,this.awaitPos=Te,this.awaitIdentPos=Je,this.finishNode(_,O&jt?"FunctionDeclaration":"FunctionExpression")},yn.parseFunctionParams=function(_){this.expect($.parenL),_.params=this.parseBindingList($.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},yn.parseClass=function(_,O){this.next();var V=this.strict;this.strict=!0,this.parseClassId(_,O),this.parseClassSuper(_);var L=this.startNode(),ne=!1;for(L.body=[],this.expect($.braceL);this.type!==$.braceR;){var Te=this.parseClassElement(_.superClass!==null);Te&&(L.body.push(Te),Te.type==="MethodDefinition"&&Te.kind==="constructor"&&(ne&&this.raise(Te.start,"Duplicate constructor in the same class"),ne=!0))}return this.strict=V,this.next(),_.body=this.finishNode(L,"ClassBody"),this.finishNode(_,O?"ClassDeclaration":"ClassExpression")},yn.parseClassElement=function(_){var O=this;if(this.eat($.semi))return null;var V=this.startNode(),L=function(wr,Fr){Fr===void 0&&(Fr=!1);var Wn=O.start,Ci=O.startLoc;return O.eatContextual(wr)?O.type!==$.parenL&&(!Fr||!O.canInsertSemicolon())?!0:(V.key&&O.unexpected(),V.computed=!1,V.key=O.startNodeAt(Wn,Ci),V.key.name=wr,O.finishNode(V.key,"Identifier"),!1):!1};V.kind="method",V.static=L("static");var ne=this.eat($.star),Te=!1;ne||(this.options.ecmaVersion>=8&&L("async",!0)?(Te=!0,ne=this.options.ecmaVersion>=9&&this.eat($.star)):L("get")?V.kind="get":L("set")&&(V.kind="set")),V.key||this.parsePropertyName(V);var Je=V.key,pt=!1;return!V.computed&&!V.static&&(Je.type==="Identifier"&&Je.name==="constructor"||Je.type==="Literal"&&Je.value==="constructor")?(V.kind!=="method"&&this.raise(Je.start,"Constructor can't have get/set modifier"),ne&&this.raise(Je.start,"Constructor can't be a generator"),Te&&this.raise(Je.start,"Constructor can't be an async method"),V.kind="constructor",pt=_):V.static&&Je.type==="Identifier"&&Je.name==="prototype"&&this.raise(Je.start,"Classes may not have a static property named prototype"),this.parseClassMethod(V,ne,Te,pt),V.kind==="get"&&V.value.params.length!==0&&this.raiseRecoverable(V.value.start,"getter should have no params"),V.kind==="set"&&V.value.params.length!==1&&this.raiseRecoverable(V.value.start,"setter should have exactly one param"),V.kind==="set"&&V.value.params[0].type==="RestElement"&&this.raiseRecoverable(V.value.params[0].start,"Setter cannot use rest params"),V},yn.parseClassMethod=function(_,O,V,L){return _.value=this.parseMethod(O,V,L),this.finishNode(_,"MethodDefinition")},yn.parseClassId=function(_,O){this.type===$.name?(_.id=this.parseIdent(),O&&this.checkLVal(_.id,or,!1)):(O===!0&&this.unexpected(),_.id=null)},yn.parseClassSuper=function(_){_.superClass=this.eat($._extends)?this.parseExprSubscripts():null},yn.parseExport=function(_,O){if(this.next(),this.eat($.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(_.exported=this.parseIdent(!0),this.checkExport(O,_.exported.name,this.lastTokStart)):_.exported=null),this.expectContextual("from"),this.type!==$.string&&this.unexpected(),_.source=this.parseExprAtom(),this.semicolon(),this.finishNode(_,"ExportAllDeclaration");if(this.eat($._default)){this.checkExport(O,"default",this.lastTokStart);var V;if(this.type===$._function||(V=this.isAsyncFunction())){var L=this.startNode();this.next(),V&&this.next(),_.declaration=this.parseFunction(L,jt|Xr,!1,V)}else if(this.type===$._class){var ne=this.startNode();_.declaration=this.parseClass(ne,"nullableID")}else _.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(_,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())_.declaration=this.parseStatement(null),_.declaration.type==="VariableDeclaration"?this.checkVariableExport(O,_.declaration.declarations):this.checkExport(O,_.declaration.id.name,_.declaration.id.start),_.specifiers=[],_.source=null;else{if(_.declaration=null,_.specifiers=this.parseExportSpecifiers(O),this.eatContextual("from"))this.type!==$.string&&this.unexpected(),_.source=this.parseExprAtom();else{for(var Te=0,Je=_.specifiers;Te<Je.length;Te+=1){var pt=Je[Te];this.checkUnreserved(pt.local),this.checkLocalExport(pt.local)}_.source=null}this.semicolon()}return this.finishNode(_,"ExportNamedDeclaration")},yn.checkExport=function(_,O,V){!_||(Mr(_,O)&&this.raiseRecoverable(V,"Duplicate export '"+O+"'"),_[O]=!0)},yn.checkPatternExport=function(_,O){var V=O.type;if(V==="Identifier")this.checkExport(_,O.name,O.start);else if(V==="ObjectPattern")for(var L=0,ne=O.properties;L<ne.length;L+=1){var Te=ne[L];this.checkPatternExport(_,Te)}else if(V==="ArrayPattern")for(var Je=0,pt=O.elements;Je<pt.length;Je+=1){var Tt=pt[Je];Tt&&this.checkPatternExport(_,Tt)}else V==="Property"?this.checkPatternExport(_,O.value):V==="AssignmentPattern"?this.checkPatternExport(_,O.left):V==="RestElement"?this.checkPatternExport(_,O.argument):V==="ParenthesizedExpression"&&this.checkPatternExport(_,O.expression)},yn.checkVariableExport=function(_,O){if(!!_)for(var V=0,L=O;V<L.length;V+=1){var ne=L[V];this.checkPatternExport(_,ne.id)}},yn.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},yn.parseExportSpecifiers=function(_){var O=[],V=!0;for(this.expect($.braceL);!this.eat($.braceR);){if(V)V=!1;else if(this.expect($.comma),this.afterTrailingComma($.braceR))break;var L=this.startNode();L.local=this.parseIdent(!0),L.exported=this.eatContextual("as")?this.parseIdent(!0):L.local,this.checkExport(_,L.exported.name,L.exported.start),O.push(this.finishNode(L,"ExportSpecifier"))}return O},yn.parseImport=function(_){return this.next(),this.type===$.string?(_.specifiers=os,_.source=this.parseExprAtom()):(_.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),_.source=this.type===$.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(_,"ImportDeclaration")},yn.parseImportSpecifiers=function(){var _=[],O=!0;if(this.type===$.name){var V=this.startNode();if(V.local=this.parseIdent(),this.checkLVal(V.local,or),_.push(this.finishNode(V,"ImportDefaultSpecifier")),!this.eat($.comma))return _}if(this.type===$.star){var L=this.startNode();return this.next(),this.expectContextual("as"),L.local=this.parseIdent(),this.checkLVal(L.local,or),_.push(this.finishNode(L,"ImportNamespaceSpecifier")),_}for(this.expect($.braceL);!this.eat($.braceR);){if(O)O=!1;else if(this.expect($.comma),this.afterTrailingComma($.braceR))break;var ne=this.startNode();ne.imported=this.parseIdent(!0),this.eatContextual("as")?ne.local=this.parseIdent():(this.checkUnreserved(ne.imported),ne.local=ne.imported),this.checkLVal(ne.local,or),_.push(this.finishNode(ne,"ImportSpecifier"))}return _},yn.adaptDirectivePrologue=function(_){for(var O=0;O<_.length&&this.isDirectiveCandidate(_[O]);++O)_[O].directive=_[O].expression.raw.slice(1,-1)},yn.isDirectiveCandidate=function(_){return _.type==="ExpressionStatement"&&_.expression.type==="Literal"&&typeof _.expression.value=="string"&&(this.input[_.start]==='"'||this.input[_.start]==="'")};var vn=_n.prototype;vn.toAssignable=function(_,O,V){if(this.options.ecmaVersion>=6&&_)switch(_.type){case"Identifier":this.inAsync&&_.name==="await"&&this.raise(_.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":_.type="ObjectPattern",V&&this.checkPatternErrors(V,!0);for(var L=0,ne=_.properties;L<ne.length;L+=1){var Te=ne[L];this.toAssignable(Te,O),Te.type==="RestElement"&&(Te.argument.type==="ArrayPattern"||Te.argument.type==="ObjectPattern")&&this.raise(Te.argument.start,"Unexpected token")}break;case"Property":_.kind!=="init"&&this.raise(_.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(_.value,O);break;case"ArrayExpression":_.type="ArrayPattern",V&&this.checkPatternErrors(V,!0),this.toAssignableList(_.elements,O);break;case"SpreadElement":_.type="RestElement",this.toAssignable(_.argument,O),_.argument.type==="AssignmentPattern"&&this.raise(_.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":_.operator!=="="&&this.raise(_.left.end,"Only '=' operator can be used for specifying default value."),_.type="AssignmentPattern",delete _.operator,this.toAssignable(_.left,O);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(_.expression,O,V);break;case"ChainExpression":this.raiseRecoverable(_.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!O)break;default:this.raise(_.start,"Assigning to rvalue")}else V&&this.checkPatternErrors(V,!0);return _},vn.toAssignableList=function(_,O){for(var V=_.length,L=0;L<V;L++){var ne=_[L];ne&&this.toAssignable(ne,O)}if(V){var Te=_[V-1];this.options.ecmaVersion===6&&O&&Te&&Te.type==="RestElement"&&Te.argument.type!=="Identifier"&&this.unexpected(Te.argument.start)}return _},vn.parseSpread=function(_){var O=this.startNode();return this.next(),O.argument=this.parseMaybeAssign(!1,_),this.finishNode(O,"SpreadElement")},vn.parseRestBinding=function(){var _=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==$.name&&this.unexpected(),_.argument=this.parseBindingAtom(),this.finishNode(_,"RestElement")},vn.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case $.bracketL:var _=this.startNode();return this.next(),_.elements=this.parseBindingList($.bracketR,!0,!0),this.finishNode(_,"ArrayPattern");case $.braceL:return this.parseObj(!0)}return this.parseIdent()},vn.parseBindingList=function(_,O,V){for(var L=[],ne=!0;!this.eat(_);)if(ne?ne=!1:this.expect($.comma),O&&this.type===$.comma)L.push(null);else{if(V&&this.afterTrailingComma(_))break;if(this.type===$.ellipsis){var Te=this.parseRestBinding();this.parseBindingListItem(Te),L.push(Te),this.type===$.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(_);break}else{var Je=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(Je),L.push(Je)}}return L},vn.parseBindingListItem=function(_){return _},vn.parseMaybeDefault=function(_,O,V){if(V=V||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat($.eq))return V;var L=this.startNodeAt(_,O);return L.left=V,L.right=this.parseMaybeAssign(),this.finishNode(L,"AssignmentPattern")},vn.checkLVal=function(_,O,V){switch(O===void 0&&(O=Ur),_.type){case"Identifier":O===or&&_.name==="let"&&this.raiseRecoverable(_.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(_.name)&&this.raiseRecoverable(_.start,(O?"Binding ":"Assigning to ")+_.name+" in strict mode"),V&&(Mr(V,_.name)&&this.raiseRecoverable(_.start,"Argument name clash"),V[_.name]=!0),O!==Ur&&O!==en&&this.declareName(_.name,O,_.start);break;case"ChainExpression":this.raiseRecoverable(_.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":O&&this.raiseRecoverable(_.start,"Binding member expression");break;case"ObjectPattern":for(var L=0,ne=_.properties;L<ne.length;L+=1){var Te=ne[L];this.checkLVal(Te,O,V)}break;case"Property":this.checkLVal(_.value,O,V);break;case"ArrayPattern":for(var Je=0,pt=_.elements;Je<pt.length;Je+=1){var Tt=pt[Je];Tt&&this.checkLVal(Tt,O,V)}break;case"AssignmentPattern":this.checkLVal(_.left,O,V);break;case"RestElement":this.checkLVal(_.argument,O,V);break;case"ParenthesizedExpression":this.checkLVal(_.expression,O,V);break;default:this.raise(_.start,(O?"Binding":"Assigning to")+" rvalue")}};var Kr=_n.prototype;Kr.checkPropClash=function(_,O,V){if(!(this.options.ecmaVersion>=9&&_.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(_.computed||_.method||_.shorthand))){var L=_.key,ne;switch(L.type){case"Identifier":ne=L.name;break;case"Literal":ne=String(L.value);break;default:return}var Te=_.kind;if(this.options.ecmaVersion>=6){ne==="__proto__"&&Te==="init"&&(O.proto&&(V?V.doubleProto<0&&(V.doubleProto=L.start):this.raiseRecoverable(L.start,"Redefinition of __proto__ property")),O.proto=!0);return}ne="$"+ne;var Je=O[ne];if(Je){var pt;Te==="init"?pt=this.strict&&Je.init||Je.get||Je.set:pt=Je.init||Je[Te],pt&&this.raiseRecoverable(L.start,"Redefinition of property")}else Je=O[ne]={init:!1,get:!1,set:!1};Je[Te]=!0}},Kr.parseExpression=function(_,O){var V=this.start,L=this.startLoc,ne=this.parseMaybeAssign(_,O);if(this.type===$.comma){var Te=this.startNodeAt(V,L);for(Te.expressions=[ne];this.eat($.comma);)Te.expressions.push(this.parseMaybeAssign(_,O));return this.finishNode(Te,"SequenceExpression")}return ne},Kr.parseMaybeAssign=function(_,O,V){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(_);this.exprAllowed=!1}var L=!1,ne=-1,Te=-1;O?(ne=O.parenthesizedAssign,Te=O.trailingComma,O.parenthesizedAssign=O.trailingComma=-1):(O=new me,L=!0);var Je=this.start,pt=this.startLoc;(this.type===$.parenL||this.type===$.name)&&(this.potentialArrowAt=this.start);var Tt=this.parseMaybeConditional(_,O);if(V&&(Tt=V.call(this,Tt,Je,pt)),this.type.isAssign){var wr=this.startNodeAt(Je,pt);return wr.operator=this.value,wr.left=this.type===$.eq?this.toAssignable(Tt,!1,O):Tt,L||(O.parenthesizedAssign=O.trailingComma=O.doubleProto=-1),O.shorthandAssign>=wr.left.start&&(O.shorthandAssign=-1),this.checkLVal(Tt),this.next(),wr.right=this.parseMaybeAssign(_),this.finishNode(wr,"AssignmentExpression")}else L&&this.checkExpressionErrors(O,!0);return ne>-1&&(O.parenthesizedAssign=ne),Te>-1&&(O.trailingComma=Te),Tt},Kr.parseMaybeConditional=function(_,O){var V=this.start,L=this.startLoc,ne=this.parseExprOps(_,O);if(this.checkExpressionErrors(O))return ne;if(this.eat($.question)){var Te=this.startNodeAt(V,L);return Te.test=ne,Te.consequent=this.parseMaybeAssign(),this.expect($.colon),Te.alternate=this.parseMaybeAssign(_),this.finishNode(Te,"ConditionalExpression")}return ne},Kr.parseExprOps=function(_,O){var V=this.start,L=this.startLoc,ne=this.parseMaybeUnary(O,!1);return this.checkExpressionErrors(O)||ne.start===V&&ne.type==="ArrowFunctionExpression"?ne:this.parseExprOp(ne,V,L,-1,_)},Kr.parseExprOp=function(_,O,V,L,ne){var Te=this.type.binop;if(Te!=null&&(!ne||this.type!==$._in)&&Te>L){var Je=this.type===$.logicalOR||this.type===$.logicalAND,pt=this.type===$.coalesce;pt&&(Te=$.logicalAND.binop);var Tt=this.value;this.next();var wr=this.start,Fr=this.startLoc,Wn=this.parseExprOp(this.parseMaybeUnary(null,!1),wr,Fr,Te,ne),Ci=this.buildBinary(O,V,_,Wn,Tt,Je||pt);return(Je&&this.type===$.coalesce||pt&&(this.type===$.logicalOR||this.type===$.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(Ci,O,V,L,ne)}return _},Kr.buildBinary=function(_,O,V,L,ne,Te){var Je=this.startNodeAt(_,O);return Je.left=V,Je.operator=ne,Je.right=L,this.finishNode(Je,Te?"LogicalExpression":"BinaryExpression")},Kr.parseMaybeUnary=function(_,O){var V=this.start,L=this.startLoc,ne;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))ne=this.parseAwait(),O=!0;else if(this.type.prefix){var Te=this.startNode(),Je=this.type===$.incDec;Te.operator=this.value,Te.prefix=!0,this.next(),Te.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(_,!0),Je?this.checkLVal(Te.argument):this.strict&&Te.operator==="delete"&&Te.argument.type==="Identifier"?this.raiseRecoverable(Te.start,"Deleting local variable in strict mode"):O=!0,ne=this.finishNode(Te,Je?"UpdateExpression":"UnaryExpression")}else{if(ne=this.parseExprSubscripts(_),this.checkExpressionErrors(_))return ne;for(;this.type.postfix&&!this.canInsertSemicolon();){var pt=this.startNodeAt(V,L);pt.operator=this.value,pt.prefix=!1,pt.argument=ne,this.checkLVal(ne),this.next(),ne=this.finishNode(pt,"UpdateExpression")}}return!O&&this.eat($.starstar)?this.buildBinary(V,L,ne,this.parseMaybeUnary(null,!1),"**",!1):ne},Kr.parseExprSubscripts=function(_){var O=this.start,V=this.startLoc,L=this.parseExprAtom(_);if(L.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return L;var ne=this.parseSubscripts(L,O,V);return _&&ne.type==="MemberExpression"&&(_.parenthesizedAssign>=ne.start&&(_.parenthesizedAssign=-1),_.parenthesizedBind>=ne.start&&(_.parenthesizedBind=-1)),ne},Kr.parseSubscripts=function(_,O,V,L){for(var ne=this.options.ecmaVersion>=8&&_.type==="Identifier"&&_.name==="async"&&this.lastTokEnd===_.end&&!this.canInsertSemicolon()&&_.end-_.start==5&&this.potentialArrowAt===_.start,Te=!1;;){var Je=this.parseSubscript(_,O,V,L,ne,Te);if(Je.optional&&(Te=!0),Je===_||Je.type==="ArrowFunctionExpression"){if(Te){var pt=this.startNodeAt(O,V);pt.expression=Je,Je=this.finishNode(pt,"ChainExpression")}return Je}_=Je}},Kr.parseSubscript=function(_,O,V,L,ne,Te){var Je=this.options.ecmaVersion>=11,pt=Je&&this.eat($.questionDot);L&&pt&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var Tt=this.eat($.bracketL);if(Tt||pt&&this.type!==$.parenL&&this.type!==$.backQuote||this.eat($.dot)){var wr=this.startNodeAt(O,V);wr.object=_,wr.property=Tt?this.parseExpression():this.parseIdent(this.options.allowReserved!=="never"),wr.computed=!!Tt,Tt&&this.expect($.bracketR),Je&&(wr.optional=pt),_=this.finishNode(wr,"MemberExpression")}else if(!L&&this.eat($.parenL)){var Fr=new me,Wn=this.yieldPos,Ci=this.awaitPos,di=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var aa=this.parseExprList($.parenR,this.options.ecmaVersion>=8,!1,Fr);if(ne&&!pt&&!this.canInsertSemicolon()&&this.eat($.arrow))return this.checkPatternErrors(Fr,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=Wn,this.awaitPos=Ci,this.awaitIdentPos=di,this.parseArrowExpression(this.startNodeAt(O,V),aa,!0);this.checkExpressionErrors(Fr,!0),this.yieldPos=Wn||this.yieldPos,this.awaitPos=Ci||this.awaitPos,this.awaitIdentPos=di||this.awaitIdentPos;var sa=this.startNodeAt(O,V);sa.callee=_,sa.arguments=aa,Je&&(sa.optional=pt),_=this.finishNode(sa,"CallExpression")}else if(this.type===$.backQuote){(pt||Te)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var pa=this.startNodeAt(O,V);pa.tag=_,pa.quasi=this.parseTemplate({isTagged:!0}),_=this.finishNode(pa,"TaggedTemplateExpression")}return _},Kr.parseExprAtom=function(_){this.type===$.slash&&this.readRegexp();var O,V=this.potentialArrowAt===this.start;switch(this.type){case $._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),O=this.startNode(),this.next(),this.type===$.parenL&&!this.allowDirectSuper&&this.raise(O.start,"super() call outside constructor of a subclass"),this.type!==$.dot&&this.type!==$.bracketL&&this.type!==$.parenL&&this.unexpected(),this.finishNode(O,"Super");case $._this:return O=this.startNode(),this.next(),this.finishNode(O,"ThisExpression");case $.name:var L=this.start,ne=this.startLoc,Te=this.containsEsc,Je=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!Te&&Je.name==="async"&&!this.canInsertSemicolon()&&this.eat($._function))return this.parseFunction(this.startNodeAt(L,ne),0,!1,!0);if(V&&!this.canInsertSemicolon()){if(this.eat($.arrow))return this.parseArrowExpression(this.startNodeAt(L,ne),[Je],!1);if(this.options.ecmaVersion>=8&&Je.name==="async"&&this.type===$.name&&!Te)return Je=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat($.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(L,ne),[Je],!0)}return Je;case $.regexp:var pt=this.value;return O=this.parseLiteral(pt.value),O.regex={pattern:pt.pattern,flags:pt.flags},O;case $.num:case $.string:return this.parseLiteral(this.value);case $._null:case $._true:case $._false:return O=this.startNode(),O.value=this.type===$._null?null:this.type===$._true,O.raw=this.type.keyword,this.next(),this.finishNode(O,"Literal");case $.parenL:var Tt=this.start,wr=this.parseParenAndDistinguishExpression(V);return _&&(_.parenthesizedAssign<0&&!this.isSimpleAssignTarget(wr)&&(_.parenthesizedAssign=Tt),_.parenthesizedBind<0&&(_.parenthesizedBind=Tt)),wr;case $.bracketL:return O=this.startNode(),this.next(),O.elements=this.parseExprList($.bracketR,!0,!0,_),this.finishNode(O,"ArrayExpression");case $.braceL:return this.parseObj(!1,_);case $._function:return O=this.startNode(),this.next(),this.parseFunction(O,0);case $._class:return this.parseClass(this.startNode(),!1);case $._new:return this.parseNew();case $.backQuote:return this.parseTemplate();case $._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},Kr.parseExprImport=function(){var _=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var O=this.parseIdent(!0);switch(this.type){case $.parenL:return this.parseDynamicImport(_);case $.dot:return _.meta=O,this.parseImportMeta(_);default:this.unexpected()}},Kr.parseDynamicImport=function(_){if(this.next(),_.source=this.parseMaybeAssign(),!this.eat($.parenR)){var O=this.start;this.eat($.comma)&&this.eat($.parenR)?this.raiseRecoverable(O,"Trailing comma is not allowed in import()"):this.unexpected(O)}return this.finishNode(_,"ImportExpression")},Kr.parseImportMeta=function(_){this.next();var O=this.containsEsc;return _.property=this.parseIdent(!0),_.property.name!=="meta"&&this.raiseRecoverable(_.property.start,"The only valid meta property for import is 'import.meta'"),O&&this.raiseRecoverable(_.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&this.raiseRecoverable(_.start,"Cannot use 'import.meta' outside a module"),this.finishNode(_,"MetaProperty")},Kr.parseLiteral=function(_){var O=this.startNode();return O.value=_,O.raw=this.input.slice(this.start,this.end),O.raw.charCodeAt(O.raw.length-1)===110&&(O.bigint=O.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(O,"Literal")},Kr.parseParenExpression=function(){this.expect($.parenL);var _=this.parseExpression();return this.expect($.parenR),_},Kr.parseParenAndDistinguishExpression=function(_){var O=this.start,V=this.startLoc,L,ne=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Te=this.start,Je=this.startLoc,pt=[],Tt=!0,wr=!1,Fr=new me,Wn=this.yieldPos,Ci=this.awaitPos,di;for(this.yieldPos=0,this.awaitPos=0;this.type!==$.parenR;)if(Tt?Tt=!1:this.expect($.comma),ne&&this.afterTrailingComma($.parenR,!0)){wr=!0;break}else if(this.type===$.ellipsis){di=this.start,pt.push(this.parseParenItem(this.parseRestBinding())),this.type===$.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}else pt.push(this.parseMaybeAssign(!1,Fr,this.parseParenItem));var aa=this.start,sa=this.startLoc;if(this.expect($.parenR),_&&!this.canInsertSemicolon()&&this.eat($.arrow))return this.checkPatternErrors(Fr,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=Wn,this.awaitPos=Ci,this.parseParenArrowList(O,V,pt);(!pt.length||wr)&&this.unexpected(this.lastTokStart),di&&this.unexpected(di),this.checkExpressionErrors(Fr,!0),this.yieldPos=Wn||this.yieldPos,this.awaitPos=Ci||this.awaitPos,pt.length>1?(L=this.startNodeAt(Te,Je),L.expressions=pt,this.finishNodeAt(L,"SequenceExpression",aa,sa)):L=pt[0]}else L=this.parseParenExpression();if(this.options.preserveParens){var pa=this.startNodeAt(O,V);return pa.expression=L,this.finishNode(pa,"ParenthesizedExpression")}else return L},Kr.parseParenItem=function(_){return _},Kr.parseParenArrowList=function(_,O,V){return this.parseArrowExpression(this.startNodeAt(_,O),V)};var ba=[];Kr.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var _=this.startNode(),O=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat($.dot)){_.meta=O;var V=this.containsEsc;return _.property=this.parseIdent(!0),_.property.name!=="target"&&this.raiseRecoverable(_.property.start,"The only valid meta property for new is 'new.target'"),V&&this.raiseRecoverable(_.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(_.start,"'new.target' can only be used in functions"),this.finishNode(_,"MetaProperty")}var L=this.start,ne=this.startLoc,Te=this.type===$._import;return _.callee=this.parseSubscripts(this.parseExprAtom(),L,ne,!0),Te&&_.callee.type==="ImportExpression"&&this.raise(L,"Cannot use new with import()"),this.eat($.parenL)?_.arguments=this.parseExprList($.parenR,this.options.ecmaVersion>=8,!1):_.arguments=ba,this.finishNode(_,"NewExpression")},Kr.parseTemplateElement=function(_){var O=_.isTagged,V=this.startNode();return this.type===$.invalidTemplate?(O||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),V.value={raw:this.value,cooked:null}):V.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),V.tail=this.type===$.backQuote,this.finishNode(V,"TemplateElement")},Kr.parseTemplate=function(_){_===void 0&&(_={});var O=_.isTagged;O===void 0&&(O=!1);var V=this.startNode();this.next(),V.expressions=[];var L=this.parseTemplateElement({isTagged:O});for(V.quasis=[L];!L.tail;)this.type===$.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect($.dollarBraceL),V.expressions.push(this.parseExpression()),this.expect($.braceR),V.quasis.push(L=this.parseTemplateElement({isTagged:O}));return this.next(),this.finishNode(V,"TemplateLiteral")},Kr.isAsyncProp=function(_){return!_.computed&&_.key.type==="Identifier"&&_.key.name==="async"&&(this.type===$.name||this.type===$.num||this.type===$.string||this.type===$.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===$.star)&&!Qt.test(this.input.slice(this.lastTokEnd,this.start))},Kr.parseObj=function(_,O){var V=this.startNode(),L=!0,ne={};for(V.properties=[],this.next();!this.eat($.braceR);){if(L)L=!1;else if(this.expect($.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma($.braceR))break;var Te=this.parseProperty(_,O);_||this.checkPropClash(Te,ne,O),V.properties.push(Te)}return this.finishNode(V,_?"ObjectPattern":"ObjectExpression")},Kr.parseProperty=function(_,O){var V=this.startNode(),L,ne,Te,Je;if(this.options.ecmaVersion>=9&&this.eat($.ellipsis))return _?(V.argument=this.parseIdent(!1),this.type===$.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(V,"RestElement")):(this.type===$.parenL&&O&&(O.parenthesizedAssign<0&&(O.parenthesizedAssign=this.start),O.parenthesizedBind<0&&(O.parenthesizedBind=this.start)),V.argument=this.parseMaybeAssign(!1,O),this.type===$.comma&&O&&O.trailingComma<0&&(O.trailingComma=this.start),this.finishNode(V,"SpreadElement"));this.options.ecmaVersion>=6&&(V.method=!1,V.shorthand=!1,(_||O)&&(Te=this.start,Je=this.startLoc),_||(L=this.eat($.star)));var pt=this.containsEsc;return this.parsePropertyName(V),!_&&!pt&&this.options.ecmaVersion>=8&&!L&&this.isAsyncProp(V)?(ne=!0,L=this.options.ecmaVersion>=9&&this.eat($.star),this.parsePropertyName(V,O)):ne=!1,this.parsePropertyValue(V,_,L,ne,Te,Je,O,pt),this.finishNode(V,"Property")},Kr.parsePropertyValue=function(_,O,V,L,ne,Te,Je,pt){if((V||L)&&this.type===$.colon&&this.unexpected(),this.eat($.colon))_.value=O?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Je),_.kind="init";else if(this.options.ecmaVersion>=6&&this.type===$.parenL)O&&this.unexpected(),_.kind="init",_.method=!0,_.value=this.parseMethod(V,L);else if(!O&&!pt&&this.options.ecmaVersion>=5&&!_.computed&&_.key.type==="Identifier"&&(_.key.name==="get"||_.key.name==="set")&&this.type!==$.comma&&this.type!==$.braceR&&this.type!==$.eq){(V||L)&&this.unexpected(),_.kind=_.key.name,this.parsePropertyName(_),_.value=this.parseMethod(!1);var Tt=_.kind==="get"?0:1;if(_.value.params.length!==Tt){var wr=_.value.start;_.kind==="get"?this.raiseRecoverable(wr,"getter should have no params"):this.raiseRecoverable(wr,"setter should have exactly one param")}else _.kind==="set"&&_.value.params[0].type==="RestElement"&&this.raiseRecoverable(_.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!_.computed&&_.key.type==="Identifier"?((V||L)&&this.unexpected(),this.checkUnreserved(_.key),_.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=ne),_.kind="init",O?_.value=this.parseMaybeDefault(ne,Te,_.key):this.type===$.eq&&Je?(Je.shorthandAssign<0&&(Je.shorthandAssign=this.start),_.value=this.parseMaybeDefault(ne,Te,_.key)):_.value=_.key,_.shorthand=!0):this.unexpected()},Kr.parsePropertyName=function(_){if(this.options.ecmaVersion>=6){if(this.eat($.bracketL))return _.computed=!0,_.key=this.parseMaybeAssign(),this.expect($.bracketR),_.key;_.computed=!1}return _.key=this.type===$.num||this.type===$.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},Kr.initFunction=function(_){_.id=null,this.options.ecmaVersion>=6&&(_.generator=_.expression=!1),this.options.ecmaVersion>=8&&(_.async=!1)},Kr.parseMethod=function(_,O,V){var L=this.startNode(),ne=this.yieldPos,Te=this.awaitPos,Je=this.awaitIdentPos;return this.initFunction(L),this.options.ecmaVersion>=6&&(L.generator=_),this.options.ecmaVersion>=8&&(L.async=!!O),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(pr(O,L.generator)|dr|(V?qt:0)),this.expect($.parenL),L.params=this.parseBindingList($.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(L,!1,!0),this.yieldPos=ne,this.awaitPos=Te,this.awaitIdentPos=Je,this.finishNode(L,"FunctionExpression")},Kr.parseArrowExpression=function(_,O,V){var L=this.yieldPos,ne=this.awaitPos,Te=this.awaitIdentPos;return this.enterScope(pr(V,!1)|St),this.initFunction(_),this.options.ecmaVersion>=8&&(_.async=!!V),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,_.params=this.toAssignableList(O,!0),this.parseFunctionBody(_,!0,!1),this.yieldPos=L,this.awaitPos=ne,this.awaitIdentPos=Te,this.finishNode(_,"ArrowFunctionExpression")},Kr.parseFunctionBody=function(_,O,V){var L=O&&this.type!==$.braceL,ne=this.strict,Te=!1;if(L)_.body=this.parseMaybeAssign(),_.expression=!0,this.checkParams(_,!1);else{var Je=this.options.ecmaVersion>=7&&!this.isSimpleParamList(_.params);(!ne||Je)&&(Te=this.strictDirective(this.end),Te&&Je&&this.raiseRecoverable(_.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var pt=this.labels;this.labels=[],Te&&(this.strict=!0),this.checkParams(_,!ne&&!Te&&!O&&!V&&this.isSimpleParamList(_.params)),this.strict&&_.id&&this.checkLVal(_.id,en),_.body=this.parseBlock(!1,void 0,Te&&!ne),_.expression=!1,this.adaptDirectivePrologue(_.body.body),this.labels=pt}this.exitScope()},Kr.isSimpleParamList=function(_){for(var O=0,V=_;O<V.length;O+=1){var L=V[O];if(L.type!=="Identifier")return!1}return!0},Kr.checkParams=function(_,O){for(var V={},L=0,ne=_.params;L<ne.length;L+=1){var Te=ne[L];this.checkLVal(Te,gr,O?null:V)}},Kr.parseExprList=function(_,O,V,L){for(var ne=[],Te=!0;!this.eat(_);){if(Te)Te=!1;else if(this.expect($.comma),O&&this.afterTrailingComma(_))break;var Je=void 0;V&&this.type===$.comma?Je=null:this.type===$.ellipsis?(Je=this.parseSpread(L),L&&this.type===$.comma&&L.trailingComma<0&&(L.trailingComma=this.start)):Je=this.parseMaybeAssign(!1,L),ne.push(Je)}return ne},Kr.checkUnreserved=function(_){var O=_.start,V=_.end,L=_.name;if(this.inGenerator&&L==="yield"&&this.raiseRecoverable(O,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&L==="await"&&this.raiseRecoverable(O,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(L)&&this.raise(O,"Unexpected keyword '"+L+"'"),!(this.options.ecmaVersion<6&&this.input.slice(O,V).indexOf("\\")!==-1)){var ne=this.strict?this.reservedWordsStrict:this.reservedWords;ne.test(L)&&(!this.inAsync&&L==="await"&&this.raiseRecoverable(O,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(O,"The keyword '"+L+"' is reserved"))}},Kr.parseIdent=function(_,O){var V=this.startNode();return this.type===$.name?V.name=this.value:this.type.keyword?(V.name=this.type.keyword,(V.name==="class"||V.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop()):this.unexpected(),this.next(!!_),this.finishNode(V,"Identifier"),_||(this.checkUnreserved(V),V.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=V.start)),V},Kr.parseYield=function(_){this.yieldPos||(this.yieldPos=this.start);var O=this.startNode();return this.next(),this.type===$.semi||this.canInsertSemicolon()||this.type!==$.star&&!this.type.startsExpr?(O.delegate=!1,O.argument=null):(O.delegate=this.eat($.star),O.argument=this.parseMaybeAssign(_)),this.finishNode(O,"YieldExpression")},Kr.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var _=this.startNode();return this.next(),_.argument=this.parseMaybeUnary(null,!1),this.finishNode(_,"AwaitExpression")};var li=_n.prototype;li.raise=function(_,O){var V=we(this.input,_);O+=" ("+V.line+":"+V.column+")";var L=new SyntaxError(O);throw L.pos=_,L.loc=V,L.raisedAt=this.pos,L},li.raiseRecoverable=li.raise,li.curPosition=function(){if(this.options.locations)return new de(this.curLine,this.pos-this.lineStart)};var Xn=_n.prototype,ci=function(O){this.flags=O,this.var=[],this.lexical=[],this.functions=[]};Xn.enterScope=function(_){this.scopeStack.push(new ci(_))},Xn.exitScope=function(){this.scopeStack.pop()},Xn.treatFunctionsAsVarInScope=function(_){return _.flags&ur||!this.inModule&&_.flags&S},Xn.declareName=function(_,O,V){var L=!1;if(O===or){var ne=this.currentScope();L=ne.lexical.indexOf(_)>-1||ne.functions.indexOf(_)>-1||ne.var.indexOf(_)>-1,ne.lexical.push(_),this.inModule&&ne.flags&S&&delete this.undefinedExports[_]}else if(O===Hn){var Te=this.currentScope();Te.lexical.push(_)}else if(O===Rr){var Je=this.currentScope();this.treatFunctionsAsVar?L=Je.lexical.indexOf(_)>-1:L=Je.lexical.indexOf(_)>-1||Je.var.indexOf(_)>-1,Je.functions.push(_)}else for(var pt=this.scopeStack.length-1;pt>=0;--pt){var Tt=this.scopeStack[pt];if(Tt.lexical.indexOf(_)>-1&&!(Tt.flags&Zt&&Tt.lexical[0]===_)||!this.treatFunctionsAsVarInScope(Tt)&&Tt.functions.indexOf(_)>-1){L=!0;break}if(Tt.var.push(_),this.inModule&&Tt.flags&S&&delete this.undefinedExports[_],Tt.flags&Pt)break}L&&this.raiseRecoverable(V,"Identifier '"+_+"' has already been declared")},Xn.checkLocalExport=function(_){this.scopeStack[0].lexical.indexOf(_.name)===-1&&this.scopeStack[0].var.indexOf(_.name)===-1&&(this.undefinedExports[_.name]=_)},Xn.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},Xn.currentVarScope=function(){for(var _=this.scopeStack.length-1;;_--){var O=this.scopeStack[_];if(O.flags&Pt)return O}},Xn.currentThisScope=function(){for(var _=this.scopeStack.length-1;;_--){var O=this.scopeStack[_];if(O.flags&Pt&&!(O.flags&St))return O}};var Hi=function(O,V,L){this.type="",this.start=V,this.end=0,O.options.locations&&(this.loc=new Ie(O,L)),O.options.directSourceFile&&(this.sourceFile=O.options.directSourceFile),O.options.ranges&&(this.range=[V,0])},Yi=_n.prototype;Yi.startNode=function(){return new Hi(this,this.start,this.startLoc)},Yi.startNodeAt=function(_,O){return new Hi(this,_,O)};function No(_,O,V,L){return _.type=O,_.end=V,this.options.locations&&(_.loc.end=L),this.options.ranges&&(_.range[1]=V),_}Yi.finishNode=function(_,O){return No.call(this,_,O,this.lastTokEnd,this.lastTokEndLoc)},Yi.finishNodeAt=function(_,O,V,L){return No.call(this,_,O,V,L)};var Ma=function(O,V,L,ne,Te){this.token=O,this.isExpr=!!V,this.preserveSpace=!!L,this.override=ne,this.generator=!!Te},ma={b_stat:new Ma("{",!1),b_expr:new Ma("{",!0),b_tmpl:new Ma("${",!1),p_stat:new Ma("(",!1),p_expr:new Ma("(",!0),q_tmpl:new Ma("`",!0,!0,function(_){return _.tryReadTemplateToken()}),f_stat:new Ma("function",!1),f_expr:new Ma("function",!0),f_expr_gen:new Ma("function",!0,!1,null,!0),f_gen:new Ma("function",!1,!1,null,!0)},Hs=_n.prototype;Hs.initialContext=function(){return[ma.b_stat]},Hs.braceIsBlock=function(_){var O=this.curContext();return O===ma.f_expr||O===ma.f_stat?!0:_===$.colon&&(O===ma.b_stat||O===ma.b_expr)?!O.isExpr:_===$._return||_===$.name&&this.exprAllowed?Qt.test(this.input.slice(this.lastTokEnd,this.start)):_===$._else||_===$.semi||_===$.eof||_===$.parenR||_===$.arrow?!0:_===$.braceL?O===ma.b_stat:_===$._var||_===$._const||_===$.name?!1:!this.exprAllowed},Hs.inGeneratorContext=function(){for(var _=this.context.length-1;_>=1;_--){var O=this.context[_];if(O.token==="function")return O.generator}return!1},Hs.updateContext=function(_){var O,V=this.type;V.keyword&&_===$.dot?this.exprAllowed=!1:(O=V.updateContext)?O.call(this,_):this.exprAllowed=V.beforeExpr},$.parenR.updateContext=$.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var _=this.context.pop();_===ma.b_stat&&this.curContext().token==="function"&&(_=this.context.pop()),this.exprAllowed=!_.isExpr},$.braceL.updateContext=function(_){this.context.push(this.braceIsBlock(_)?ma.b_stat:ma.b_expr),this.exprAllowed=!0},$.dollarBraceL.updateContext=function(){this.context.push(ma.b_tmpl),this.exprAllowed=!0},$.parenL.updateContext=function(_){var O=_===$._if||_===$._for||_===$._with||_===$._while;this.context.push(O?ma.p_stat:ma.p_expr),this.exprAllowed=!0},$.incDec.updateContext=function(){},$._function.updateContext=$._class.updateContext=function(_){_.beforeExpr&&_!==$.semi&&_!==$._else&&!(_===$._return&&Qt.test(this.input.slice(this.lastTokEnd,this.start)))&&!((_===$.colon||_===$.braceL)&&this.curContext()===ma.b_stat)?this.context.push(ma.f_expr):this.context.push(ma.f_stat),this.exprAllowed=!1},$.backQuote.updateContext=function(){this.curContext()===ma.q_tmpl?this.context.pop():this.context.push(ma.q_tmpl),this.exprAllowed=!1},$.star.updateContext=function(_){if(_===$._function){var O=this.context.length-1;this.context[O]===ma.f_expr?this.context[O]=ma.f_expr_gen:this.context[O]=ma.f_gen}this.exprAllowed=!0},$.name.updateContext=function(_){var O=!1;this.options.ecmaVersion>=6&&_!==$.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(O=!0),this.exprAllowed=O};var il="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ja=il+" Extended_Pictographic",re=ja,J={9:il,10:ja,11:re},pe="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Se="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",De=Se+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",et=De+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",vt={9:Se,10:De,11:et},_e={};function je(_){var O=_e[_]={binary:Er(J[_]+" "+pe),nonBinary:{General_Category:Er(pe),Script:Er(vt[_])}};O.nonBinary.Script_Extensions=O.nonBinary.Script,O.nonBinary.gc=O.nonBinary.General_Category,O.nonBinary.sc=O.nonBinary.Script,O.nonBinary.scx=O.nonBinary.Script_Extensions}je(9),je(10),je(11);var $e=_n.prototype,Ar=function(O){this.parser=O,this.validFlags="gim"+(O.options.ecmaVersion>=6?"uy":"")+(O.options.ecmaVersion>=9?"s":""),this.unicodeProperties=_e[O.options.ecmaVersion>=11?11:O.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};Ar.prototype.reset=function(O,V,L){var ne=L.indexOf("u")!==-1;this.start=O|0,this.source=V+"",this.flags=L,this.switchU=ne&&this.parser.options.ecmaVersion>=6,this.switchN=ne&&this.parser.options.ecmaVersion>=9},Ar.prototype.raise=function(O){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+O)},Ar.prototype.at=function(O,V){V===void 0&&(V=!1);var L=this.source,ne=L.length;if(O>=ne)return-1;var Te=L.charCodeAt(O);if(!(V||this.switchU)||Te<=55295||Te>=57344||O+1>=ne)return Te;var Je=L.charCodeAt(O+1);return Je>=56320&&Je<=57343?(Te<<10)+Je-56613888:Te},Ar.prototype.nextIndex=function(O,V){V===void 0&&(V=!1);var L=this.source,ne=L.length;if(O>=ne)return ne;var Te=L.charCodeAt(O),Je;return!(V||this.switchU)||Te<=55295||Te>=57344||O+1>=ne||(Je=L.charCodeAt(O+1))<56320||Je>57343?O+1:O+2},Ar.prototype.current=function(O){return O===void 0&&(O=!1),this.at(this.pos,O)},Ar.prototype.lookahead=function(O){return O===void 0&&(O=!1),this.at(this.nextIndex(this.pos,O),O)},Ar.prototype.advance=function(O){O===void 0&&(O=!1),this.pos=this.nextIndex(this.pos,O)},Ar.prototype.eat=function(O,V){return V===void 0&&(V=!1),this.current(V)===O?(this.advance(V),!0):!1};function kr(_){return _<=65535?String.fromCharCode(_):(_-=65536,String.fromCharCode((_>>10)+55296,(_&1023)+56320))}$e.validateRegExpFlags=function(_){for(var O=_.validFlags,V=_.flags,L=0;L<V.length;L++){var ne=V.charAt(L);O.indexOf(ne)===-1&&this.raise(_.start,"Invalid regular expression flag"),V.indexOf(ne,L+1)>-1&&this.raise(_.start,"Duplicate regular expression flag")}},$e.validateRegExpPattern=function(_){this.regexp_pattern(_),!_.switchN&&this.options.ecmaVersion>=9&&_.groupNames.length>0&&(_.switchN=!0,this.regexp_pattern(_))},$e.regexp_pattern=function(_){_.pos=0,_.lastIntValue=0,_.lastStringValue="",_.lastAssertionIsQuantifiable=!1,_.numCapturingParens=0,_.maxBackReference=0,_.groupNames.length=0,_.backReferenceNames.length=0,this.regexp_disjunction(_),_.pos!==_.source.length&&(_.eat(41)&&_.raise("Unmatched ')'"),(_.eat(93)||_.eat(125))&&_.raise("Lone quantifier brackets")),_.maxBackReference>_.numCapturingParens&&_.raise("Invalid escape");for(var O=0,V=_.backReferenceNames;O<V.length;O+=1){var L=V[O];_.groupNames.indexOf(L)===-1&&_.raise("Invalid named capture referenced")}},$e.regexp_disjunction=function(_){for(this.regexp_alternative(_);_.eat(124);)this.regexp_alternative(_);this.regexp_eatQuantifier(_,!0)&&_.raise("Nothing to repeat"),_.eat(123)&&_.raise("Lone quantifier brackets")},$e.regexp_alternative=function(_){for(;_.pos<_.source.length&&this.regexp_eatTerm(_););},$e.regexp_eatTerm=function(_){return this.regexp_eatAssertion(_)?(_.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(_)&&_.switchU&&_.raise("Invalid quantifier"),!0):(_.switchU?this.regexp_eatAtom(_):this.regexp_eatExtendedAtom(_))?(this.regexp_eatQuantifier(_),!0):!1},$e.regexp_eatAssertion=function(_){var O=_.pos;if(_.lastAssertionIsQuantifiable=!1,_.eat(94)||_.eat(36))return!0;if(_.eat(92)){if(_.eat(66)||_.eat(98))return!0;_.pos=O}if(_.eat(40)&&_.eat(63)){var V=!1;if(this.options.ecmaVersion>=9&&(V=_.eat(60)),_.eat(61)||_.eat(33))return this.regexp_disjunction(_),_.eat(41)||_.raise("Unterminated group"),_.lastAssertionIsQuantifiable=!V,!0}return _.pos=O,!1},$e.regexp_eatQuantifier=function(_,O){return O===void 0&&(O=!1),this.regexp_eatQuantifierPrefix(_,O)?(_.eat(63),!0):!1},$e.regexp_eatQuantifierPrefix=function(_,O){return _.eat(42)||_.eat(43)||_.eat(63)||this.regexp_eatBracedQuantifier(_,O)},$e.regexp_eatBracedQuantifier=function(_,O){var V=_.pos;if(_.eat(123)){var L=0,ne=-1;if(this.regexp_eatDecimalDigits(_)&&(L=_.lastIntValue,_.eat(44)&&this.regexp_eatDecimalDigits(_)&&(ne=_.lastIntValue),_.eat(125)))return ne!==-1&&ne<L&&!O&&_.raise("numbers out of order in {} quantifier"),!0;_.switchU&&!O&&_.raise("Incomplete quantifier"),_.pos=V}return!1},$e.regexp_eatAtom=function(_){return this.regexp_eatPatternCharacters(_)||_.eat(46)||this.regexp_eatReverseSolidusAtomEscape(_)||this.regexp_eatCharacterClass(_)||this.regexp_eatUncapturingGroup(_)||this.regexp_eatCapturingGroup(_)},$e.regexp_eatReverseSolidusAtomEscape=function(_){var O=_.pos;if(_.eat(92)){if(this.regexp_eatAtomEscape(_))return!0;_.pos=O}return!1},$e.regexp_eatUncapturingGroup=function(_){var O=_.pos;if(_.eat(40)){if(_.eat(63)&&_.eat(58)){if(this.regexp_disjunction(_),_.eat(41))return!0;_.raise("Unterminated group")}_.pos=O}return!1},$e.regexp_eatCapturingGroup=function(_){if(_.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(_):_.current()===63&&_.raise("Invalid group"),this.regexp_disjunction(_),_.eat(41))return _.numCapturingParens+=1,!0;_.raise("Unterminated group")}return!1},$e.regexp_eatExtendedAtom=function(_){return _.eat(46)||this.regexp_eatReverseSolidusAtomEscape(_)||this.regexp_eatCharacterClass(_)||this.regexp_eatUncapturingGroup(_)||this.regexp_eatCapturingGroup(_)||this.regexp_eatInvalidBracedQuantifier(_)||this.regexp_eatExtendedPatternCharacter(_)},$e.regexp_eatInvalidBracedQuantifier=function(_){return this.regexp_eatBracedQuantifier(_,!0)&&_.raise("Nothing to repeat"),!1},$e.regexp_eatSyntaxCharacter=function(_){var O=_.current();return rr(O)?(_.lastIntValue=O,_.advance(),!0):!1};function rr(_){return _===36||_>=40&&_<=43||_===46||_===63||_>=91&&_<=94||_>=123&&_<=125}$e.regexp_eatPatternCharacters=function(_){for(var O=_.pos,V=0;(V=_.current())!==-1&&!rr(V);)_.advance();return _.pos!==O},$e.regexp_eatExtendedPatternCharacter=function(_){var O=_.current();return O!==-1&&O!==36&&!(O>=40&&O<=43)&&O!==46&&O!==63&&O!==91&&O!==94&&O!==124?(_.advance(),!0):!1},$e.regexp_groupSpecifier=function(_){if(_.eat(63)){if(this.regexp_eatGroupName(_)){_.groupNames.indexOf(_.lastStringValue)!==-1&&_.raise("Duplicate capture group name"),_.groupNames.push(_.lastStringValue);return}_.raise("Invalid group")}},$e.regexp_eatGroupName=function(_){if(_.lastStringValue="",_.eat(60)){if(this.regexp_eatRegExpIdentifierName(_)&&_.eat(62))return!0;_.raise("Invalid capture group name")}return!1},$e.regexp_eatRegExpIdentifierName=function(_){if(_.lastStringValue="",this.regexp_eatRegExpIdentifierStart(_)){for(_.lastStringValue+=kr(_.lastIntValue);this.regexp_eatRegExpIdentifierPart(_);)_.lastStringValue+=kr(_.lastIntValue);return!0}return!1},$e.regexp_eatRegExpIdentifierStart=function(_){var O=_.pos,V=this.options.ecmaVersion>=11,L=_.current(V);return _.advance(V),L===92&&this.regexp_eatRegExpUnicodeEscapeSequence(_,V)&&(L=_.lastIntValue),Lr(L)?(_.lastIntValue=L,!0):(_.pos=O,!1)};function Lr(_){return tt(_,!0)||_===36||_===95}$e.regexp_eatRegExpIdentifierPart=function(_){var O=_.pos,V=this.options.ecmaVersion>=11,L=_.current(V);return _.advance(V),L===92&&this.regexp_eatRegExpUnicodeEscapeSequence(_,V)&&(L=_.lastIntValue),an(L)?(_.lastIntValue=L,!0):(_.pos=O,!1)};function an(_){return ut(_,!0)||_===36||_===95||_===8204||_===8205}$e.regexp_eatAtomEscape=function(_){return this.regexp_eatBackReference(_)||this.regexp_eatCharacterClassEscape(_)||this.regexp_eatCharacterEscape(_)||_.switchN&&this.regexp_eatKGroupName(_)?!0:(_.switchU&&(_.current()===99&&_.raise("Invalid unicode escape"),_.raise("Invalid escape")),!1)},$e.regexp_eatBackReference=function(_){var O=_.pos;if(this.regexp_eatDecimalEscape(_)){var V=_.lastIntValue;if(_.switchU)return V>_.maxBackReference&&(_.maxBackReference=V),!0;if(V<=_.numCapturingParens)return!0;_.pos=O}return!1},$e.regexp_eatKGroupName=function(_){if(_.eat(107)){if(this.regexp_eatGroupName(_))return _.backReferenceNames.push(_.lastStringValue),!0;_.raise("Invalid named reference")}return!1},$e.regexp_eatCharacterEscape=function(_){return this.regexp_eatControlEscape(_)||this.regexp_eatCControlLetter(_)||this.regexp_eatZero(_)||this.regexp_eatHexEscapeSequence(_)||this.regexp_eatRegExpUnicodeEscapeSequence(_,!1)||!_.switchU&&this.regexp_eatLegacyOctalEscapeSequence(_)||this.regexp_eatIdentityEscape(_)},$e.regexp_eatCControlLetter=function(_){var O=_.pos;if(_.eat(99)){if(this.regexp_eatControlLetter(_))return!0;_.pos=O}return!1},$e.regexp_eatZero=function(_){return _.current()===48&&!_i(_.lookahead())?(_.lastIntValue=0,_.advance(),!0):!1},$e.regexp_eatControlEscape=function(_){var O=_.current();return O===116?(_.lastIntValue=9,_.advance(),!0):O===110?(_.lastIntValue=10,_.advance(),!0):O===118?(_.lastIntValue=11,_.advance(),!0):O===102?(_.lastIntValue=12,_.advance(),!0):O===114?(_.lastIntValue=13,_.advance(),!0):!1},$e.regexp_eatControlLetter=function(_){var O=_.current();return An(O)?(_.lastIntValue=O%32,_.advance(),!0):!1};function An(_){return _>=65&&_<=90||_>=97&&_<=122}$e.regexp_eatRegExpUnicodeEscapeSequence=function(_,O){O===void 0&&(O=!1);var V=_.pos,L=O||_.switchU;if(_.eat(117)){if(this.regexp_eatFixedHexDigits(_,4)){var ne=_.lastIntValue;if(L&&ne>=55296&&ne<=56319){var Te=_.pos;if(_.eat(92)&&_.eat(117)&&this.regexp_eatFixedHexDigits(_,4)){var Je=_.lastIntValue;if(Je>=56320&&Je<=57343)return _.lastIntValue=(ne-55296)*1024+(Je-56320)+65536,!0}_.pos=Te,_.lastIntValue=ne}return!0}if(L&&_.eat(123)&&this.regexp_eatHexDigits(_)&&_.eat(125)&&tr(_.lastIntValue))return!0;L&&_.raise("Invalid unicode escape"),_.pos=V}return!1};function tr(_){return _>=0&&_<=1114111}$e.regexp_eatIdentityEscape=function(_){if(_.switchU)return this.regexp_eatSyntaxCharacter(_)?!0:_.eat(47)?(_.lastIntValue=47,!0):!1;var O=_.current();return O!==99&&(!_.switchN||O!==107)?(_.lastIntValue=O,_.advance(),!0):!1},$e.regexp_eatDecimalEscape=function(_){_.lastIntValue=0;var O=_.current();if(O>=49&&O<=57){do _.lastIntValue=10*_.lastIntValue+(O-48),_.advance();while((O=_.current())>=48&&O<=57);return!0}return!1},$e.regexp_eatCharacterClassEscape=function(_){var O=_.current();if(Cn(O))return _.lastIntValue=-1,_.advance(),!0;if(_.switchU&&this.options.ecmaVersion>=9&&(O===80||O===112)){if(_.lastIntValue=-1,_.advance(),_.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(_)&&_.eat(125))return!0;_.raise("Invalid property name")}return!1};function Cn(_){return _===100||_===68||_===115||_===83||_===119||_===87}$e.regexp_eatUnicodePropertyValueExpression=function(_){var O=_.pos;if(this.regexp_eatUnicodePropertyName(_)&&_.eat(61)){var V=_.lastStringValue;if(this.regexp_eatUnicodePropertyValue(_)){var L=_.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(_,V,L),!0}}if(_.pos=O,this.regexp_eatLoneUnicodePropertyNameOrValue(_)){var ne=_.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(_,ne),!0}return!1},$e.regexp_validateUnicodePropertyNameAndValue=function(_,O,V){Mr(_.unicodeProperties.nonBinary,O)||_.raise("Invalid property name"),_.unicodeProperties.nonBinary[O].test(V)||_.raise("Invalid property value")},$e.regexp_validateUnicodePropertyNameOrValue=function(_,O){_.unicodeProperties.binary.test(O)||_.raise("Invalid property name")},$e.regexp_eatUnicodePropertyName=function(_){var O=0;for(_.lastStringValue="";hn(O=_.current());)_.lastStringValue+=kr(O),_.advance();return _.lastStringValue!==""};function hn(_){return An(_)||_===95}$e.regexp_eatUnicodePropertyValue=function(_){var O=0;for(_.lastStringValue="";xn(O=_.current());)_.lastStringValue+=kr(O),_.advance();return _.lastStringValue!==""};function xn(_){return hn(_)||_i(_)}$e.regexp_eatLoneUnicodePropertyNameOrValue=function(_){return this.regexp_eatUnicodePropertyValue(_)},$e.regexp_eatCharacterClass=function(_){if(_.eat(91)){if(_.eat(94),this.regexp_classRanges(_),_.eat(93))return!0;_.raise("Unterminated character class")}return!1},$e.regexp_classRanges=function(_){for(;this.regexp_eatClassAtom(_);){var O=_.lastIntValue;if(_.eat(45)&&this.regexp_eatClassAtom(_)){var V=_.lastIntValue;_.switchU&&(O===-1||V===-1)&&_.raise("Invalid character class"),O!==-1&&V!==-1&&O>V&&_.raise("Range out of order in character class")}}},$e.regexp_eatClassAtom=function(_){var O=_.pos;if(_.eat(92)){if(this.regexp_eatClassEscape(_))return!0;if(_.switchU){var V=_.current();(V===99||Ki(V))&&_.raise("Invalid class escape"),_.raise("Invalid escape")}_.pos=O}var L=_.current();return L!==93?(_.lastIntValue=L,_.advance(),!0):!1},$e.regexp_eatClassEscape=function(_){var O=_.pos;if(_.eat(98))return _.lastIntValue=8,!0;if(_.switchU&&_.eat(45))return _.lastIntValue=45,!0;if(!_.switchU&&_.eat(99)){if(this.regexp_eatClassControlLetter(_))return!0;_.pos=O}return this.regexp_eatCharacterClassEscape(_)||this.regexp_eatCharacterEscape(_)},$e.regexp_eatClassControlLetter=function(_){var O=_.current();return _i(O)||O===95?(_.lastIntValue=O%32,_.advance(),!0):!1},$e.regexp_eatHexEscapeSequence=function(_){var O=_.pos;if(_.eat(120)){if(this.regexp_eatFixedHexDigits(_,2))return!0;_.switchU&&_.raise("Invalid escape"),_.pos=O}return!1},$e.regexp_eatDecimalDigits=function(_){var O=_.pos,V=0;for(_.lastIntValue=0;_i(V=_.current());)_.lastIntValue=10*_.lastIntValue+(V-48),_.advance();return _.pos!==O};function _i(_){return _>=48&&_<=57}$e.regexp_eatHexDigits=function(_){var O=_.pos,V=0;for(_.lastIntValue=0;wn(V=_.current());)_.lastIntValue=16*_.lastIntValue+Ni(V),_.advance();return _.pos!==O};function wn(_){return _>=48&&_<=57||_>=65&&_<=70||_>=97&&_<=102}function Ni(_){return _>=65&&_<=70?10+(_-65):_>=97&&_<=102?10+(_-97):_-48}$e.regexp_eatLegacyOctalEscapeSequence=function(_){if(this.regexp_eatOctalDigit(_)){var O=_.lastIntValue;if(this.regexp_eatOctalDigit(_)){var V=_.lastIntValue;O<=3&&this.regexp_eatOctalDigit(_)?_.lastIntValue=O*64+V*8+_.lastIntValue:_.lastIntValue=O*8+V}else _.lastIntValue=O;return!0}return!1},$e.regexp_eatOctalDigit=function(_){var O=_.current();return Ki(O)?(_.lastIntValue=O-48,_.advance(),!0):(_.lastIntValue=0,!1)};function Ki(_){return _>=48&&_<=55}$e.regexp_eatFixedHexDigits=function(_,O){var V=_.pos;_.lastIntValue=0;for(var L=0;L<O;++L){var ne=_.current();if(!wn(ne))return _.pos=V,!1;_.lastIntValue=16*_.lastIntValue+Ni(ne),_.advance()}return!0};var Mi=function(O){this.type=O.type,this.value=O.value,this.start=O.start,this.end=O.end,O.options.locations&&(this.loc=new Ie(O,O.startLoc,O.endLoc)),O.options.ranges&&(this.range=[O.start,O.end])},Fn=_n.prototype;Fn.next=function(_){!_&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Mi(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Fn.getToken=function(){return this.next(),new Mi(this)},typeof Symbol!="undefined"&&(Fn[Symbol.iterator]=function(){var _=this;return{next:function(){var V=_.getToken();return{done:V.type===$.eof,value:V}}}}),Fn.curContext=function(){return this.context[this.context.length-1]},Fn.nextToken=function(){var _=this.curContext();if((!_||!_.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken($.eof);if(_.override)return _.override(this);this.readToken(this.fullCharCodeAtPos())},Fn.readToken=function(_){return tt(_,this.options.ecmaVersion>=6)||_===92?this.readWord():this.getTokenFromCode(_)},Fn.fullCharCodeAtPos=function(){var _=this.input.charCodeAt(this.pos);if(_<=55295||_>=57344)return _;var O=this.input.charCodeAt(this.pos+1);return(_<<10)+O-56613888},Fn.skipBlockComment=function(){var _=this.options.onComment&&this.curPosition(),O=this.pos,V=this.input.indexOf("*/",this.pos+=2);if(V===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=V+2,this.options.locations){Ir.lastIndex=O;for(var L;(L=Ir.exec(this.input))&&L.index<this.pos;)++this.curLine,this.lineStart=L.index+L[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(O+2,V),O,this.pos,_,this.curPosition())},Fn.skipLineComment=function(_){for(var O=this.pos,V=this.options.onComment&&this.curPosition(),L=this.input.charCodeAt(this.pos+=_);this.pos<this.input.length&&!br(L);)L=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(O+_,this.pos),O,this.pos,V,this.curPosition())},Fn.skipSpace=function(){e:for(;this.pos<this.input.length;){var _=this.input.charCodeAt(this.pos);switch(_){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(_>8&&_<14||_>=5760&&Rt.test(String.fromCharCode(_)))++this.pos;else break e}}},Fn.finishToken=function(_,O){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var V=this.type;this.type=_,this.value=O,this.updateContext(V)},Fn.readToken_dot=function(){var _=this.input.charCodeAt(this.pos+1);if(_>=48&&_<=57)return this.readNumber(!0);var O=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&_===46&&O===46?(this.pos+=3,this.finishToken($.ellipsis)):(++this.pos,this.finishToken($.dot))},Fn.readToken_slash=function(){var _=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):_===61?this.finishOp($.assign,2):this.finishOp($.slash,1)},Fn.readToken_mult_modulo_exp=function(_){var O=this.input.charCodeAt(this.pos+1),V=1,L=_===42?$.star:$.modulo;return this.options.ecmaVersion>=7&&_===42&&O===42&&(++V,L=$.starstar,O=this.input.charCodeAt(this.pos+2)),O===61?this.finishOp($.assign,V+1):this.finishOp(L,V)},Fn.readToken_pipe_amp=function(_){var O=this.input.charCodeAt(this.pos+1);if(O===_){if(this.options.ecmaVersion>=12){var V=this.input.charCodeAt(this.pos+2);if(V===61)return this.finishOp($.assign,3)}return this.finishOp(_===124?$.logicalOR:$.logicalAND,2)}return O===61?this.finishOp($.assign,2):this.finishOp(_===124?$.bitwiseOR:$.bitwiseAND,1)},Fn.readToken_caret=function(){var _=this.input.charCodeAt(this.pos+1);return _===61?this.finishOp($.assign,2):this.finishOp($.bitwiseXOR,1)},Fn.readToken_plus_min=function(_){var O=this.input.charCodeAt(this.pos+1);return O===_?O===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Qt.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp($.incDec,2):O===61?this.finishOp($.assign,2):this.finishOp($.plusMin,1)},Fn.readToken_lt_gt=function(_){var O=this.input.charCodeAt(this.pos+1),V=1;return O===_?(V=_===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+V)===61?this.finishOp($.assign,V+1):this.finishOp($.bitShift,V)):O===33&&_===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(O===61&&(V=2),this.finishOp($.relational,V))},Fn.readToken_eq_excl=function(_){var O=this.input.charCodeAt(this.pos+1);return O===61?this.finishOp($.equality,this.input.charCodeAt(this.pos+2)===61?3:2):_===61&&O===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken($.arrow)):this.finishOp(_===61?$.eq:$.prefix,1)},Fn.readToken_question=function(){var _=this.options.ecmaVersion;if(_>=11){var O=this.input.charCodeAt(this.pos+1);if(O===46){var V=this.input.charCodeAt(this.pos+2);if(V<48||V>57)return this.finishOp($.questionDot,2)}if(O===63){if(_>=12){var L=this.input.charCodeAt(this.pos+2);if(L===61)return this.finishOp($.assign,3)}return this.finishOp($.coalesce,2)}}return this.finishOp($.question,1)},Fn.getTokenFromCode=function(_){switch(_){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken($.parenL);case 41:return++this.pos,this.finishToken($.parenR);case 59:return++this.pos,this.finishToken($.semi);case 44:return++this.pos,this.finishToken($.comma);case 91:return++this.pos,this.finishToken($.bracketL);case 93:return++this.pos,this.finishToken($.bracketR);case 123:return++this.pos,this.finishToken($.braceL);case 125:return++this.pos,this.finishToken($.braceR);case 58:return++this.pos,this.finishToken($.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken($.backQuote);case 48:var O=this.input.charCodeAt(this.pos+1);if(O===120||O===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(O===111||O===79)return this.readRadixNumber(8);if(O===98||O===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(_);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(_);case 124:case 38:return this.readToken_pipe_amp(_);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(_);case 60:case 62:return this.readToken_lt_gt(_);case 61:case 33:return this.readToken_eq_excl(_);case 63:return this.readToken_question();case 126:return this.finishOp($.prefix,1)}this.raise(this.pos,"Unexpected character '"+ia(_)+"'")},Fn.finishOp=function(_,O){var V=this.input.slice(this.pos,this.pos+O);return this.pos+=O,this.finishToken(_,V)},Fn.readRegexp=function(){for(var _,O,V=this.pos;;){this.pos>=this.input.length&&this.raise(V,"Unterminated regular expression");var L=this.input.charAt(this.pos);if(Qt.test(L)&&this.raise(V,"Unterminated regular expression"),_)_=!1;else{if(L==="[")O=!0;else if(L==="]"&&O)O=!1;else if(L==="/"&&!O)break;_=L==="\\"}++this.pos}var ne=this.input.slice(V,this.pos);++this.pos;var Te=this.pos,Je=this.readWord1();this.containsEsc&&this.unexpected(Te);var pt=this.regexpState||(this.regexpState=new Ar(this));pt.reset(V,ne,Je),this.validateRegExpFlags(pt),this.validateRegExpPattern(pt);var Tt=null;try{Tt=new RegExp(ne,Je)}catch(wr){}return this.finishToken($.regexp,{pattern:ne,flags:Je,value:Tt})},Fn.readInt=function(_,O,V){for(var L=this.options.ecmaVersion>=12&&O===void 0,ne=V&&this.input.charCodeAt(this.pos)===48,Te=this.pos,Je=0,pt=0,Tt=0,wr=O==null?Infinity:O;Tt<wr;++Tt,++this.pos){var Fr=this.input.charCodeAt(this.pos),Wn=void 0;if(L&&Fr===95){ne&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),pt===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),Tt===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),pt=Fr;continue}if(Fr>=97?Wn=Fr-97+10:Fr>=65?Wn=Fr-65+10:Fr>=48&&Fr<=57?Wn=Fr-48:Wn=Infinity,Wn>=_)break;pt=Fr,Je=Je*_+Wn}return L&&pt===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Te||O!=null&&this.pos-Te!==O?null:Je};function Ui(_,O){return O?parseInt(_,8):parseFloat(_.replace(/_/g,""))}function zo(_){return typeof BigInt!="function"?null:BigInt(_.replace(/_/g,""))}Fn.readRadixNumber=function(_){var O=this.pos;this.pos+=2;var V=this.readInt(_);return V==null&&this.raise(this.start+2,"Expected number in radix "+_),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(V=zo(this.input.slice(O,this.pos)),++this.pos):tt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken($.num,V)},Fn.readNumber=function(_){var O=this.pos;!_&&this.readInt(10,void 0,!0)===null&&this.raise(O,"Invalid number");var V=this.pos-O>=2&&this.input.charCodeAt(O)===48;V&&this.strict&&this.raise(O,"Invalid number");var L=this.input.charCodeAt(this.pos);if(!V&&!_&&this.options.ecmaVersion>=11&&L===110){var ne=zo(this.input.slice(O,this.pos));return++this.pos,tt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken($.num,ne)}V&&/[89]/.test(this.input.slice(O,this.pos))&&(V=!1),L===46&&!V&&(++this.pos,this.readInt(10),L=this.input.charCodeAt(this.pos)),(L===69||L===101)&&!V&&(L=this.input.charCodeAt(++this.pos),(L===43||L===45)&&++this.pos,this.readInt(10)===null&&this.raise(O,"Invalid number")),tt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Te=Ui(this.input.slice(O,this.pos),V);return this.finishToken($.num,Te)},Fn.readCodePoint=function(){var _=this.input.charCodeAt(this.pos),O;if(_===123){this.options.ecmaVersion<6&&this.unexpected();var V=++this.pos;O=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,O>1114111&&this.invalidStringToken(V,"Code point out of bounds")}else O=this.readHexChar(4);return O};function ia(_){return _<=65535?String.fromCharCode(_):(_-=65536,String.fromCharCode((_>>10)+55296,(_&1023)+56320))}Fn.readString=function(_){for(var O="",V=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var L=this.input.charCodeAt(this.pos);if(L===_)break;L===92?(O+=this.input.slice(V,this.pos),O+=this.readEscapedChar(!1),V=this.pos):(br(L,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return O+=this.input.slice(V,this.pos++),this.finishToken($.string,O)};var Ka={};Fn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(_){if(_===Ka)this.readInvalidTemplateToken();else throw _}this.inTemplateElement=!1},Fn.invalidStringToken=function(_,O){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Ka;this.raise(_,O)},Fn.readTmplToken=function(){for(var _="",O=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var V=this.input.charCodeAt(this.pos);if(V===96||V===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===$.template||this.type===$.invalidTemplate)?V===36?(this.pos+=2,this.finishToken($.dollarBraceL)):(++this.pos,this.finishToken($.backQuote)):(_+=this.input.slice(O,this.pos),this.finishToken($.template,_));if(V===92)_+=this.input.slice(O,this.pos),_+=this.readEscapedChar(!0),O=this.pos;else if(br(V)){switch(_+=this.input.slice(O,this.pos),++this.pos,V){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:_+=`
`;break;default:_+=String.fromCharCode(V);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),O=this.pos}else++this.pos}},Fn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken($.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},Fn.readEscapedChar=function(_){var O=this.input.charCodeAt(++this.pos);switch(++this.pos,O){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return ia(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(_){var V=this.pos-1;return this.invalidStringToken(V,"Invalid escape sequence in template string"),null}default:if(O>=48&&O<=55){var L=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],ne=parseInt(L,8);return ne>255&&(L=L.slice(0,-1),ne=parseInt(L,8)),this.pos+=L.length-1,O=this.input.charCodeAt(this.pos),(L!=="0"||O===56||O===57)&&(this.strict||_)&&this.invalidStringToken(this.pos-1-L.length,_?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(ne)}return br(O)?"":String.fromCharCode(O)}},Fn.readHexChar=function(_){var O=this.pos,V=this.readInt(16,_);return V===null&&this.invalidStringToken(O,"Bad character escape sequence"),V},Fn.readWord1=function(){this.containsEsc=!1;for(var _="",O=!0,V=this.pos,L=this.options.ecmaVersion>=6;this.pos<this.input.length;){var ne=this.fullCharCodeAtPos();if(ut(ne,L))this.pos+=ne<=65535?1:2;else if(ne===92){this.containsEsc=!0,_+=this.input.slice(V,this.pos);var Te=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Je=this.readCodePoint();(O?tt:ut)(Je,L)||this.invalidStringToken(Te,"Invalid Unicode escape"),_+=ia(Je),V=this.pos}else break;O=!1}return _+this.input.slice(V,this.pos)},Fn.readWord=function(){var _=this.readWord1(),O=$.name;return this.keywords.test(_)&&(O=rt[_]),this.finishToken(O,_)};var ri="7.4.1";_n.acorn={Parser:_n,version:ri,defaultOptions:ct,Position:de,SourceLocation:Ie,getLineInfo:we,Node:Hi,TokenType:ht,tokTypes:$,keywordTypes:rt,TokContext:Ma,tokContexts:ma,isIdentifierChar:ut,isIdentifierStart:tt,Token:Mi,isNewLine:br,lineBreak:Qt,lineBreakG:Ir,nonASCIIwhitespace:Rt};function Ai(_,O){return _n.parse(_,O)}function xi(_,O,V){return _n.parseExpressionAt(_,O,V)}function to(_,O){return _n.tokenizer(_,O)}function ao(_,O){_.prototype=Object.create(O.prototype),_.prototype.constructor=_,_.__proto__=O}function Ea(_){var O=typeof Map=="function"?new Map:void 0;return Ea=function(L){if(L===null||!Bt(L))return L;if(typeof L!="function")throw new TypeError("Super expression must either be null or a function");if(typeof O!="undefined"){if(O.has(L))return O.get(L);O.set(L,ne)}function ne(){return ss(L,arguments,ro(this).constructor)}return ne.prototype=Object.create(L.prototype,{constructor:{value:ne,enumerable:!1,writable:!0,configurable:!0}}),wa(ne,L)},Ea(_)}function Ct(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(_){return!1}}function ss(_,O,V){return Ct()?ss=Reflect.construct:ss=function(ne,Te,Je){var pt=[null];pt.push.apply(pt,Te);var Tt=Function.bind.apply(ne,pt),wr=new Tt;return Je&&wa(wr,Je.prototype),wr},ss.apply(null,arguments)}function Bt(_){return Function.toString.call(_).indexOf("[native code]")!==-1}function wa(_,O){return wa=Object.setPrototypeOf||function(L,ne){return L.__proto__=ne,L},wa(_,O)}function ro(_){return ro=Object.setPrototypeOf?Object.getPrototypeOf:function(V){return V.__proto__||Object.getPrototypeOf(V)},ro(_)}var Pa=function(_){ao(O,_);function O(){return _.apply(this,arguments)||this}return O}(Ea(Error)),Ta=function(_){ao(O,_);function O(){return _.apply(this,arguments)||this}return O}(Ea(SyntaxError)),Po=function(_){ao(O,_);function O(){return _.apply(this,arguments)||this}return O}(Ea(ReferenceError)),Nr=function(_){ao(O,_);function O(){return _.apply(this,arguments)||this}return O}(Ea(TypeError)),Xo=function(_){ao(O,_);function O(){return _.apply(this,arguments)||this}return O}(Pa),$r=function(_){ao(O,_);function O(){return _.apply(this,arguments)||this}return O}(Ta),Oo=function(_){ao(O,_);function O(){return _.apply(this,arguments)||this}return O}(Po),mt={UnknownError:[3001,"%0",Xo],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",Xo],NodeTypeSyntaxError:[1001,"Unknown node type: %0",Oo],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",Oo],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",Oo],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",Oo],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",Oo],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",Oo],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",Oo],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",Oo],ParamTypeSyntaxError:[1009,"Unknown param type: %0",Oo],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",Oo],FunctionUndefinedReferenceError:[2001,"%0 is not a function",Po],VariableUndefinedReferenceError:[2002,"%0 is not defined",Po],IsNotConstructor:[2003,"%0 is not a constructor",Nr]};function wu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(_){return!1}}function ms(_,O,V){return wu()?ms=Reflect.construct:ms=function(ne,Te,Je){var pt=[null];pt.push.apply(pt,Te);var Tt=Function.bind.apply(ne,pt),wr=new Tt;return Je&&oe(wr,Je.prototype),wr},ms.apply(null,arguments)}function oe(_,O){return oe=Object.setPrototypeOf||function(L,ne){return L.__proto__=ne,L},oe(_,O)}var Ws="0.0.3";function Io(_,O){Object.defineProperty(_,"name",{value:O,writable:!1,enumerable:!1,configurable:!0})}var xo=Object.prototype.hasOwnProperty,Ve=Symbol("Break"),fe=Symbol("Continue"),Ue=Symbol("DefaultCase"),kt=Symbol("EmptyStatementReturn"),Gr=Symbol("WithScopeName"),In=Symbol("SuperScopeName"),Li=Symbol("RootScopeName"),Oa=Symbol("GlobalScopeName");function Sa(_){return typeof _=="function"}var Ia=function(){function _(V){this.interpreter=V}var O=_.prototype;return O.generator=function(){var L=this.interpreter;function ne(){return this.getCurrentScope()}function Te(){return this.getGlobalScope()}function Je(){return this.getCurrentContext()}return{getOptions:L.getOptions.bind(L),getCurrentScope:ne.bind(L),getGlobalScope:Te.bind(L),getCurrentContext:Je.bind(L),getExecStartTime:L.getExecStartTime.bind(L)}},_}();function oo(_,O,V){if(V===void 0&&(V=!0),!(_ instanceof Ia))throw new Error("Illegal call");if(typeof O!="string")return O;if(!!O){var L=_.generator(),ne=L.getOptions(),Te={timeout:ne.timeout,_initEnv:function(){V||this.setCurrentContext(L.getCurrentContext()),this.execStartTime=L.getExecStartTime(),this.execEndTime=this.execStartTime}},Je=V?L.getGlobalScope():L.getCurrentScope(),pt=new Ca(Je,Te);return pt.evaluate(O)}}Object.defineProperty(oo,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});function Cl(_){if(!(_ instanceof Ia))throw new Error("Illegal call");for(var O=_.generator(),V=arguments.length,L=new Array(V>1?V-1:0),ne=1;ne<V;ne++)L[ne-1]=arguments[ne];var Te=L.pop(),Je=new Ca(O.getGlobalScope(),O.getOptions()),pt=`
		    (function anonymous(`+L.join(",")+`){
		        `+Te+`
		    });
		    `;return Je.evaluate(pt)}Object.defineProperty(Cl,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var gs=function(O){this.value=O},ho=function(O){this.value=O},us=function(O){this.value=O},Ts=function(O,V,L){V===void 0&&(V=null),this.name=L,this.parent=V,this.data=O,this.labelStack=[]};function Ms(){}function Yo(_,O){return _===void 0&&(_=null),new Ts(Object.create(null),_,O)}function au(_){return Object.create(_)}var Ps={NaN:NaN,Infinity:Infinity,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Float64Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:oo,Function:Cl};typeof JSON!="undefined"&&(Ps.JSON=JSON),typeof Promise!="undefined"&&(Ps.Promise=Promise),typeof Set!="undefined"&&(Ps.Set=Set),typeof Map!="undefined"&&(Ps.Map=Map),typeof Symbol!="undefined"&&(Ps.Symbol=Symbol),typeof Proxy!="undefined"&&(Ps.Proxy=Proxy),typeof WeakMap!="undefined"&&(Ps.WeakMap=WeakMap),typeof WeakSet!="undefined"&&(Ps.WeakSet=WeakSet),typeof Reflect!="undefined"&&(Ps.Reflect=Reflect);var Ca=function(){function _(V,L){V===void 0&&(V=_.global),L===void 0&&(L={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:L.ecmaVersion||_.ecmaVersion,timeout:L.timeout||0,rootContext:L.rootContext,globalContextInFunction:L.globalContextInFunction===void 0?_.globalContextInFunction:L.globalContextInFunction,_initEnv:L._initEnv},this.context=V||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var O=_.prototype;return O.initEnvironment=function(L){var ne;if(L instanceof Ts)ne=L;else{var Te=null,Je=this.createSuperScope(L);this.options.rootContext&&(Te=new Ts(au(this.options.rootContext),Je,Li)),ne=new Ts(L,Te||Je,Oa)}this.globalScope=ne,this.currentScope=this.globalScope,this.globalContext=ne.data,this.currentContext=ne.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var pt=this.options._initEnv;pt&&pt.call(this)},O.getExecStartTime=function(){return this.execStartTime},O.getExecutionTime=function(){return this.execEndTime-this.execStartTime},O.setExecTimeout=function(L){L===void 0&&(L=0),this.options.timeout=L},O.getOptions=function(){return this.options},O.getGlobalScope=function(){return this.globalScope},O.getCurrentScope=function(){return this.currentScope},O.getCurrentContext=function(){return this.currentContext},O.isInterruptThrow=function(L){return L instanceof Xo||L instanceof Oo||L instanceof $r},O.createSuperScope=function(L){var ne=Object.assign({},Ps),Te=Object.keys(ne);return Te.forEach(function(Je){Je in L&&delete ne[Je]}),new Ts(ne,null,In)},O.setCurrentContext=function(L){this.currentContext=L},O.setCurrentScope=function(L){this.currentScope=L},O.evaluate=function(L){L===void 0&&(L="");var ne;if(!!L)return ne=Ai(L,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||_.ecmaVersion}),this.evaluateNode(ne,L)},O.appendCode=function(L){return this.evaluate(L)},O.evaluateNode=function(L,ne){var Te=this;ne===void 0&&(ne=""),this.value=void 0,this.source=ne,this.sourceList.push(ne),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var Je=this.getCurrentScope(),pt=this.getCurrentContext(),Tt=Je.labelStack.concat([]),wr=this.callStack.concat([]),Fr=function(){Te.setCurrentScope(Je),Te.setCurrentContext(pt),Je.labelStack=Tt,Te.callStack=wr};try{var Wn=this.createClosure(L);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),Wn()}catch(Ci){throw Ci}finally{Fr(),this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},O.createErrorMessage=function(L,ne,Te){var Je=L[1].replace("%0",String(ne));return Te!==null&&(Je+=this.getNodePosition(Te||this.lastExecNode)),Je},O.createError=function(L,ne){return new ne(L)},O.createThrowError=function(L,ne){return this.createError(L,ne)},O.createInternalThrowError=function(L,ne,Te){return this.createError(this.createErrorMessage(L,ne,Te),L[2])},O.checkTimeout=function(){if(!this.isRunning)return!1;var L=this.options.timeout||0,ne=Date.now();return ne-this.execStartTime>L},O.getNodePosition=function(L){if(L){var ne="";return L.loc?" ["+L.loc.start.line+":"+L.loc.start.column+"]"+ne:""}return""},O.createClosure=function(L){var ne=this,Te;switch(L.type){case"BinaryExpression":Te=this.binaryExpressionHandler(L);break;case"LogicalExpression":Te=this.logicalExpressionHandler(L);break;case"UnaryExpression":Te=this.unaryExpressionHandler(L);break;case"UpdateExpression":Te=this.updateExpressionHandler(L);break;case"ObjectExpression":Te=this.objectExpressionHandler(L);break;case"ArrayExpression":Te=this.arrayExpressionHandler(L);break;case"CallExpression":Te=this.callExpressionHandler(L);break;case"NewExpression":Te=this.newExpressionHandler(L);break;case"MemberExpression":Te=this.memberExpressionHandler(L);break;case"ThisExpression":Te=this.thisExpressionHandler(L);break;case"SequenceExpression":Te=this.sequenceExpressionHandler(L);break;case"Literal":Te=this.literalHandler(L);break;case"Identifier":Te=this.identifierHandler(L);break;case"AssignmentExpression":Te=this.assignmentExpressionHandler(L);break;case"FunctionDeclaration":Te=this.functionDeclarationHandler(L);break;case"VariableDeclaration":Te=this.variableDeclarationHandler(L);break;case"BlockStatement":case"Program":Te=this.programHandler(L);break;case"ExpressionStatement":Te=this.expressionStatementHandler(L);break;case"EmptyStatement":Te=this.emptyStatementHandler(L);break;case"ReturnStatement":Te=this.returnStatementHandler(L);break;case"FunctionExpression":Te=this.functionExpressionHandler(L);break;case"IfStatement":Te=this.ifStatementHandler(L);break;case"ConditionalExpression":Te=this.conditionalExpressionHandler(L);break;case"ForStatement":Te=this.forStatementHandler(L);break;case"WhileStatement":Te=this.whileStatementHandler(L);break;case"DoWhileStatement":Te=this.doWhileStatementHandler(L);break;case"ForInStatement":Te=this.forInStatementHandler(L);break;case"WithStatement":Te=this.withStatementHandler(L);break;case"ThrowStatement":Te=this.throwStatementHandler(L);break;case"TryStatement":Te=this.tryStatementHandler(L);break;case"ContinueStatement":Te=this.continueStatementHandler(L);break;case"BreakStatement":Te=this.breakStatementHandler(L);break;case"SwitchStatement":Te=this.switchStatementHandler(L);break;case"LabeledStatement":Te=this.labeledStatementHandler(L);break;case"DebuggerStatement":Te=this.debuggerStatementHandler(L);break;default:throw this.createInternalThrowError(mt.NodeTypeSyntaxError,L.type,L)}return function(){var Je=ne.options.timeout;if(Je&&Je>0&&ne.checkTimeout())throw ne.createInternalThrowError(mt.ExecutionTimeOutError,Je,null);return ne.lastExecNode=L,Te.apply(void 0,arguments)}},O.binaryExpressionHandler=function(L){var ne=this,Te=this.createClosure(L.left),Je=this.createClosure(L.right);return function(){var pt=Te(),Tt=Je();switch(L.operator){case"==":return pt==Tt;case"!=":return pt!=Tt;case"===":return pt===Tt;case"!==":return pt!==Tt;case"<":return pt<Tt;case"<=":return pt<=Tt;case">":return pt>Tt;case">=":return pt>=Tt;case"<<":return pt<<Tt;case">>":return pt>>Tt;case">>>":return pt>>>Tt;case"+":return pt+Tt;case"-":return pt-Tt;case"*":return pt*Tt;case"**":return Math.pow(pt,Tt);case"/":return pt/Tt;case"%":return pt%Tt;case"|":return pt|Tt;case"^":return pt^Tt;case"&":return pt&Tt;case"in":return pt in Tt;case"instanceof":return pt instanceof Tt;default:throw ne.createInternalThrowError(mt.BinaryOperatorSyntaxError,L.operator,L)}}},O.logicalExpressionHandler=function(L){var ne=this,Te=this.createClosure(L.left),Je=this.createClosure(L.right);return function(){switch(L.operator){case"||":return Te()||Je();case"&&":return Te()&&Je();default:throw ne.createInternalThrowError(mt.LogicalOperatorSyntaxError,L.operator,L)}}},O.unaryExpressionHandler=function(L){var ne=this;switch(L.operator){case"delete":var Te=this.createObjectGetter(L.argument),Je=this.createNameGetter(L.argument);return function(){var Fr=Te(),Wn=Je();return delete Fr[Wn]};default:var pt;if(L.operator==="typeof"&&L.argument.type==="Identifier"){var Tt=this.createObjectGetter(L.argument),wr=this.createNameGetter(L.argument);pt=function(){return Tt()[wr()]}}else pt=this.createClosure(L.argument);return function(){var Fr=pt();switch(L.operator){case"-":return-Fr;case"+":return+Fr;case"!":return!Fr;case"~":return~Fr;case"void":return;case"typeof":return typeof Fr;default:throw ne.createInternalThrowError(mt.UnaryOperatorSyntaxError,L.operator,L)}}}},O.updateExpressionHandler=function(L){var ne=this,Te=this.createObjectGetter(L.argument),Je=this.createNameGetter(L.argument);return function(){var pt=Te(),Tt=Je();switch(ne.assertVariable(pt,Tt,L),L.operator){case"++":return L.prefix?++pt[Tt]:pt[Tt]++;case"--":return L.prefix?--pt[Tt]:pt[Tt]--;default:throw ne.createInternalThrowError(mt.UpdateOperatorSyntaxError,L.operator,L)}}},O.objectExpressionHandler=function(L){var ne=this,Te=[];function Je(Tt){return Tt.type==="Identifier"?Tt.name:Tt.type==="Literal"?Tt.value:this.throwError(mt.ObjectStructureSyntaxError,Tt.type,Tt)}var pt=Object.create(null);return L.properties.forEach(function(Tt){var wr=Tt.kind,Fr=Je(Tt.key);(!pt[Fr]||wr==="init")&&(pt[Fr]={}),pt[Fr][wr]=ne.createClosure(Tt.value),Te.push({key:Fr,property:Tt})}),function(){for(var Tt={},wr=Te.length,Fr=0;Fr<wr;Fr++){var Wn=Te[Fr],Ci=Wn.key,di=pt[Ci],aa=di.init?di.init():void 0,sa=di.get?di.get():function(){},pa=di.set?di.set():function(_s){};if("set"in di||"get"in di){var ou={configurable:!0,enumerable:!0,get:sa,set:pa};Object.defineProperty(Tt,Ci,ou)}else{var ys=Wn.property,ea=ys.kind;ys.key.type==="Identifier"&&ys.value.type==="FunctionExpression"&&ea==="init"&&!ys.value.id&&Io(aa,ys.key.name),Tt[Ci]=aa}}return Tt}},O.arrayExpressionHandler=function(L){var ne=this,Te=L.elements.map(function(Je){return Je&&ne.createClosure(Je)});return function(){for(var Je=Te.length,pt=Array(Je),Tt=0;Tt<Je;Tt++){var wr=Te[Tt];wr&&(pt[Tt]=wr())}return pt}},O.safeObjectGet=function(L,ne,Te){return L[ne]},O.createCallFunctionGetter=function(L){var ne=this;switch(L.type){case"MemberExpression":var Te=this.createClosure(L.object),Je=this.createMemberKeyGetter(L),pt=this.source;return function(){var wr=Te(),Fr=Je(),Wn=ne.safeObjectGet(wr,Fr,L);if(!Wn||!Sa(Wn)){var Ci=pt.slice(L.start,L.end);throw ne.createInternalThrowError(mt.FunctionUndefinedReferenceError,Ci,L)}return Wn.__IS_EVAL_FUNC?function(di){return Wn(new Ia(ne),di,!0)}:Wn.__IS_FUNCTION_FUNC?function(){for(var di=arguments.length,aa=new Array(di),sa=0;sa<di;sa++)aa[sa]=arguments[sa];return Wn.apply(void 0,[new Ia(ne)].concat(aa))}:Wn.bind(wr)};default:var Tt=this.createClosure(L);return function(){var wr="";L.type==="Identifier"&&(wr=L.name);var Fr=Tt();if(!Fr||!Sa(Fr))throw ne.createInternalThrowError(mt.FunctionUndefinedReferenceError,wr,L);if(L.type==="Identifier"&&Fr.__IS_EVAL_FUNC&&wr==="eval")return function(di){var aa=ne.getScopeFromName(wr,ne.getCurrentScope()),sa=aa.name===In||aa.name===Oa||aa.name===Li;return Fr(new Ia(ne),di,!sa)};if(Fr.__IS_EVAL_FUNC)return function(di){return Fr(new Ia(ne),di,!0)};if(Fr.__IS_FUNCTION_FUNC)return function(){for(var di=arguments.length,aa=new Array(di),sa=0;sa<di;sa++)aa[sa]=arguments[sa];return Fr.apply(void 0,[new Ia(ne)].concat(aa))};var Wn=ne.options.globalContextInFunction;if(L.type==="Identifier"){var Ci=ne.getIdentifierScope(L);Ci.name===Gr&&(Wn=Ci.data)}return Fr.bind(Wn)}}},O.callExpressionHandler=function(L){var ne=this,Te=this.createCallFunctionGetter(L.callee),Je=L.arguments.map(function(pt){return ne.createClosure(pt)});return function(){return Te().apply(void 0,Je.map(function(pt){return pt()}))}},O.functionExpressionHandler=function(L){var ne=this,Te=this,Je=this.source,pt=this.collectDeclVars,Tt=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var wr=L.id?L.id.name:"",Fr=L.params.length,Wn=L.params.map(function(sa){return ne.createParamNameGetter(sa)}),Ci=this.createClosure(L.body),di=this.collectDeclVars,aa=this.collectDeclFuncs;return this.collectDeclVars=pt,this.collectDeclFuncs=Tt,function(){var sa=Te.getCurrentScope(),pa=function ou(){for(var ys=arguments.length,ea=new Array(ys),_s=0;_s<ys;_s++)ea[_s]=arguments[_s];Te.callStack.push(""+wr);var ic=Te.getCurrentScope(),Tl=Yo(sa,"FunctionScope("+wr+")");Te.setCurrentScope(Tl),Te.addDeclarationsToScope(di,aa,Tl),wr&&(Tl.data[wr]=ou),Tl.data.arguments=arguments,Wn.forEach(function(_f,hu){Tl.data[_f()]=ea[hu]});var jl=Te.getCurrentContext();Te.setCurrentContext(this);var Dc=Ci();if(Te.setCurrentContext(jl),Te.setCurrentScope(ic),Te.callStack.pop(),Dc instanceof gs)return Dc.value};return Io(pa,wr),Object.defineProperty(pa,"length",{value:Fr,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(pa,"toString",{value:function(){return Je.slice(L.start,L.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(pa,"valueOf",{value:function(){return Je.slice(L.start,L.end)},writable:!0,configurable:!0,enumerable:!1}),pa}},O.newExpressionHandler=function(L){var ne=this,Te=this.source,Je=this.createClosure(L.callee),pt=L.arguments.map(function(Tt){return ne.createClosure(Tt)});return function(){var Tt=Je();if(!Sa(Tt)||Tt.__IS_EVAL_FUNC){var wr=L.callee,Fr=Te.slice(wr.start,wr.end);throw ne.createInternalThrowError(mt.IsNotConstructor,Fr,L)}return Tt.__IS_FUNCTION_FUNC?Tt.apply(void 0,[new Ia(ne)].concat(pt.map(function(Wn){return Wn()}))):ms(Tt,pt.map(function(Wn){return Wn()}))}},O.memberExpressionHandler=function(L){var ne=this.createClosure(L.object),Te=this.createMemberKeyGetter(L);return function(){var Je=ne(),pt=Te();return Je[pt]}},O.thisExpressionHandler=function(L){var ne=this;return function(){return ne.getCurrentContext()}},O.sequenceExpressionHandler=function(L){var ne=this,Te=L.expressions.map(function(Je){return ne.createClosure(Je)});return function(){for(var Je,pt=Te.length,Tt=0;Tt<pt;Tt++){var wr=Te[Tt];Je=wr()}return Je}},O.literalHandler=function(L){return function(){return L.regex?new RegExp(L.regex.pattern,L.regex.flags):L.value}},O.identifierHandler=function(L){var ne=this;return function(){var Te=ne.getCurrentScope(),Je=ne.getScopeDataFromName(L.name,Te);return ne.assertVariable(Je,L.name,L),Je[L.name]}},O.getIdentifierScope=function(L){var ne=this.getCurrentScope(),Te=this.getScopeFromName(L.name,ne);return Te},O.assignmentExpressionHandler=function(L){var ne=this;L.left.type==="Identifier"&&L.right.type==="FunctionExpression"&&!L.right.id&&(L.right.id={type:"Identifier",name:L.left.name});var Te=this.createObjectGetter(L.left),Je=this.createNameGetter(L.left),pt=this.createClosure(L.right);return function(){var Tt=Te(),wr=Je(),Fr=pt();switch(L.operator!=="="&&ne.assertVariable(Tt,wr,L),L.operator){case"=":return Tt[wr]=Fr;case"+=":return Tt[wr]+=Fr;case"-=":return Tt[wr]-=Fr;case"*=":return Tt[wr]*=Fr;case"**=":return Tt[wr]=Math.pow(Tt[wr],Fr);case"/=":return Tt[wr]/=Fr;case"%=":return Tt[wr]%=Fr;case"<<=":return Tt[wr]<<=Fr;case">>=":return Tt[wr]>>=Fr;case">>>=":return Tt[wr]>>>=Fr;case"&=":return Tt[wr]&=Fr;case"^=":return Tt[wr]^=Fr;case"|=":return Tt[wr]|=Fr;default:throw ne.createInternalThrowError(mt.AssignmentExpressionSyntaxError,L.type,L)}}},O.functionDeclarationHandler=function(L){if(L.id){var ne=this.functionExpressionHandler(L);Object.defineProperty(ne,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(L.id.name,ne)}return function(){return kt}},O.getVariableName=function(L){if(L.type==="Identifier")return L.name;throw this.createInternalThrowError(mt.VariableTypeSyntaxError,L.type,L)},O.variableDeclarationHandler=function(L){for(var ne=this,Te,Je=[],pt=0;pt<L.declarations.length;pt++){var Tt=L.declarations[pt];this.varDeclaration(this.getVariableName(Tt.id)),Tt.init&&Je.push({type:"AssignmentExpression",operator:"=",left:Tt.id,right:Tt.init})}return Je.length&&(Te=this.createClosure({type:"BlockStatement",body:Je})),function(){if(Te){var wr=ne.isVarDeclMode;ne.isVarDeclMode=!0,Te(),ne.isVarDeclMode=wr}return kt}},O.assertVariable=function(L,ne,Te){if(L===this.globalScope.data&&!(ne in L))throw this.createInternalThrowError(mt.VariableUndefinedReferenceError,ne,Te)},O.programHandler=function(L){var ne=this,Te=L.body.map(function(Je){return ne.createClosure(Je)});return function(){for(var Je=kt,pt=0;pt<Te.length;pt++){var Tt=Te[pt],wr=ne.setValue(Tt());if(wr!==kt&&(Je=wr,Je instanceof gs||Je instanceof ho||Je instanceof us||Je===Ve||Je===fe))break}return Je}},O.expressionStatementHandler=function(L){return this.createClosure(L.expression)},O.emptyStatementHandler=function(L){return function(){return kt}},O.returnStatementHandler=function(L){var ne=L.argument?this.createClosure(L.argument):Ms;return function(){return new gs(ne())}},O.ifStatementHandler=function(L){var ne=this.createClosure(L.test),Te=this.createClosure(L.consequent),Je=L.alternate?this.createClosure(L.alternate):function(){return kt};return function(){return ne()?Te():Je()}},O.conditionalExpressionHandler=function(L){return this.ifStatementHandler(L)},O.forStatementHandler=function(L){var ne=this,Te=Ms,Je=L.test?this.createClosure(L.test):function(){return!0},pt=Ms,Tt=this.createClosure(L.body);return L.type==="ForStatement"&&(Te=L.init?this.createClosure(L.init):Te,pt=L.update?this.createClosure(L.update):Ms),function(wr){var Fr,Wn=kt,Ci=L.type==="DoWhileStatement";for(wr&&wr.type==="LabeledStatement"&&(Fr=wr.label.name),Te();Ci||Je();pt()){Ci=!1;var di=ne.setValue(Tt());if(!(di===kt||di===fe)){if(di===Ve)break;if(Wn=di,Wn instanceof us&&Wn.value===Fr){Wn=kt;continue}if(Wn instanceof gs||Wn instanceof ho||Wn instanceof us)break}}return Wn}},O.whileStatementHandler=function(L){return this.forStatementHandler(L)},O.doWhileStatementHandler=function(L){return this.forStatementHandler(L)},O.forInStatementHandler=function(L){var ne=this,Te=L.left,Je=this.createClosure(L.right),pt=this.createClosure(L.body);return L.left.type==="VariableDeclaration"&&(this.createClosure(L.left)(),Te=L.left.declarations[0].id),function(Tt){var wr,Fr=kt,Wn;Tt&&Tt.type==="LabeledStatement"&&(wr=Tt.label.name);var Ci=Je();for(Wn in Ci){ne.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:Te,right:{type:"Literal",value:Wn}})();var di=ne.setValue(pt());if(!(di===kt||di===fe)){if(di===Ve)break;if(Fr=di,Fr instanceof us&&Fr.value===wr){Fr=kt;continue}if(Fr instanceof gs||Fr instanceof ho||Fr instanceof us)break}}return Fr}},O.withStatementHandler=function(L){var ne=this,Te=this.createClosure(L.object),Je=this.createClosure(L.body);return function(){var pt=Te(),Tt=ne.getCurrentScope(),wr=new Ts(pt,Tt,Gr);ne.setCurrentScope(wr);var Fr=ne.setValue(Je());return ne.setCurrentScope(Tt),Fr}},O.throwStatementHandler=function(L){var ne=this,Te=this.createClosure(L.argument);return function(){throw ne.setValue(void 0),Te()}},O.tryStatementHandler=function(L){var ne=this,Te=this.createClosure(L.block),Je=L.handler?this.catchClauseHandler(L.handler):null,pt=L.finalizer?this.createClosure(L.finalizer):null;return function(){var Tt=ne.getCurrentScope(),wr=ne.getCurrentContext(),Fr=Tt.labelStack.concat([]),Wn=ne.callStack.concat([]),Ci=kt,di,aa,sa=function(){ne.setCurrentScope(Tt),ne.setCurrentContext(wr),Tt.labelStack=Fr,ne.callStack=Wn};try{Ci=ne.setValue(Te()),Ci instanceof gs&&(di=Ci)}catch(pa){if(sa(),ne.isInterruptThrow(pa))throw pa;if(Je)try{Ci=ne.setValue(Je(pa)),Ci instanceof gs&&(di=Ci)}catch(ou){if(sa(),ne.isInterruptThrow(ou))throw ou;aa=ou}}if(pt)try{Ci=pt(),Ci instanceof gs&&(di=Ci)}catch(pa){if(sa(),ne.isInterruptThrow(pa))throw pa;aa=pa}if(aa)throw aa;return di||Ci}},O.catchClauseHandler=function(L){var ne=this,Te=this.createParamNameGetter(L.param),Je=this.createClosure(L.body);return function(pt){var Tt,wr=ne.getCurrentScope(),Fr=wr.data,Wn=Te(),Ci=xo.call(Fr,Wn),di=Fr[Wn];return Fr[Wn]=pt,Tt=Je(),Ci?Fr[Wn]=di:delete Fr[Wn],Tt}},O.continueStatementHandler=function(L){return function(){return L.label?new us(L.label.name):fe}},O.breakStatementHandler=function(L){return function(){return L.label?new ho(L.label.name):Ve}},O.switchStatementHandler=function(L){var ne=this,Te=this.createClosure(L.discriminant),Je=L.cases.map(function(pt){return ne.switchCaseHandler(pt)});return function(){for(var pt=Te(),Tt=!1,wr,Fr,Wn,Ci=0;Ci<Je.length;Ci++){var di=Je[Ci](),aa=di.testClosure();if(aa===Ue){Wn=di;continue}if(Tt||aa===pt){if(Tt=!0,Fr=ne.setValue(di.bodyClosure()),Fr===kt)continue;if(Fr===Ve||(wr=Fr,wr instanceof gs||wr instanceof ho||wr instanceof us||wr===fe))break}}if(!Tt&&Wn){Fr=ne.setValue(Wn.bodyClosure());var sa=Fr===kt||Fr===Ve||Fr===fe;sa||(wr=Fr)}return wr}},O.switchCaseHandler=function(L){var ne=L.test?this.createClosure(L.test):function(){return Ue},Te=this.createClosure({type:"BlockStatement",body:L.consequent});return function(){return{testClosure:ne,bodyClosure:Te}}},O.labeledStatementHandler=function(L){var ne=this,Te=L.label.name,Je=this.createClosure(L.body);return function(){var pt,Tt=ne.getCurrentScope();return Tt.labelStack.push(Te),pt=Je(L),pt instanceof ho&&pt.value===Te&&(pt=kt),Tt.labelStack.pop(),pt}},O.debuggerStatementHandler=function(L){return function(){debugger;return kt}},O.createParamNameGetter=function(L){if(L.type==="Identifier")return function(){return L.name};throw this.createInternalThrowError(mt.ParamTypeSyntaxError,L.type,L)},O.createObjectKeyGetter=function(L){var ne;return L.type==="Identifier"?ne=function(){return L.name}:ne=this.createClosure(L),function(){return ne()}},O.createMemberKeyGetter=function(L){return L.computed?this.createClosure(L.property):this.createObjectKeyGetter(L.property)},O.createObjectGetter=function(L){var ne=this;switch(L.type){case"Identifier":return function(){return ne.getScopeDataFromName(L.name,ne.getCurrentScope())};case"MemberExpression":return this.createClosure(L.object);default:throw this.createInternalThrowError(mt.AssignmentTypeSyntaxError,L.type,L)}},O.createNameGetter=function(L){switch(L.type){case"Identifier":return function(){return L.name};case"MemberExpression":return this.createMemberKeyGetter(L);default:throw this.createInternalThrowError(mt.AssignmentTypeSyntaxError,L.type,L)}},O.varDeclaration=function(L){var ne=this.collectDeclVars;ne[L]=void 0},O.funcDeclaration=function(L,ne){var Te=this.collectDeclFuncs;Te[L]=ne},O.addDeclarationsToScope=function(L,ne,Te){var Je=Te.data;for(var pt in ne){var Tt=ne[pt];Je[pt]=Tt&&Tt()}for(var wr in L)wr in Je||(Je[wr]=void 0)},O.getScopeValue=function(L,ne){var Te=this.getScopeFromName(L,ne);return Te.data[L]},O.getScopeDataFromName=function(L,ne){return this.getScopeFromName(L,ne).data},O.getScopeFromName=function(L,ne){var Te=ne;do if(L in Te.data)return Te;while(Te=Te.parent);return this.globalScope},O.setValue=function(L){var ne=this.callStack.length;return this.isVarDeclMode||ne||L===kt||L===Ve||L===fe||L instanceof ho||L instanceof us||(this.value=L instanceof gs?L.value:L),L},O.getValue=function(){return this.value},_}();Ca.version=Ws,Ca.eval=oo,Ca.Function=Cl,Ca.ecmaVersion=5,Ca.globalContextInFunction=void 0,Ca.global=Object.create(null);function Va(_){return _===void 0&&(_=Object.create(null)),_}function lu(_,O,V){O===void 0&&(O=[]),V===void 0&&(V={});var L=V.parsingContext,ne=V.timeout===void 0?0:V.timeout,Te=`
    (function anonymous(`+O.join(",")+`){
         `+_+`
    });
    `,Je=new Ca(L,{ecmaVersion:V.ecmaVersion,timeout:ne,rootContext:V.rootContext,globalContextInFunction:V.globalContextInFunction});return Je.evaluate(Te)}function Tu(_,O,V){var L=new Ca(O,V);return L.evaluate(_)}var rh=Tu,Al=function(){function _(V){this._code=V}var O=_.prototype;return O.runInContext=function(L){return Tu(this._code,L)},O.runInNewContext=function(L){return Tu(this._code,L)},_}(),wl=function(_,O,V){return Tu(_,O,V)},cu=function(){for(var _=arguments.length,O=new Array(_),V=0;V<_;V++)O[V]=arguments[V];var L=O.pop();return lu(L||"",O)},fu=Z.default=wl},t2Dn:function(ae,Z,w){var N=w("hypo"),G=w("ljhN");function H(B,h,z){(z!==void 0&&!G(B[h],z)||z===void 0&&!(h in B))&&N(B,h,z)}ae.exports=H},u6S6:function(ae,Z,w){var N=w("6acW"),G=w("sgoq"),H=G(function(B,h,z){return h=h.toLowerCase(),B+(z?N(h):h)});ae.exports=H},uhBA:function(ae,Z,w){"use strict";var N=Object.prototype.hasOwnProperty,G="~";function H(){}Object.create&&(H.prototype=Object.create(null),new H().__proto__||(G=!1));function B(Q,se,Ce){this.fn=Q,this.context=se,this.once=Ce||!1}function h(Q,se,Ce,be,st){if(typeof Ce!="function")throw new TypeError("The listener must be a function");var tt=new B(Ce,be||Q,st),ut=G?G+se:se;return Q._events[ut]?Q._events[ut].fn?Q._events[ut]=[Q._events[ut],tt]:Q._events[ut].push(tt):(Q._events[ut]=tt,Q._eventsCount++),Q}function z(Q,se){--Q._eventsCount==0?Q._events=new H:delete Q._events[se]}function U(){this._events=new H,this._eventsCount=0}U.prototype.eventNames=function(){var se=[],Ce,be;if(this._eventsCount===0)return se;for(be in Ce=this._events)N.call(Ce,be)&&se.push(G?be.slice(1):be);return Object.getOwnPropertySymbols?se.concat(Object.getOwnPropertySymbols(Ce)):se},U.prototype.listeners=function(se){var Ce=G?G+se:se,be=this._events[Ce];if(!be)return[];if(be.fn)return[be.fn];for(var st=0,tt=be.length,ut=new Array(tt);st<tt;st++)ut[st]=be[st].fn;return ut},U.prototype.listenerCount=function(se){var Ce=G?G+se:se,be=this._events[Ce];return be?be.fn?1:be.length:0},U.prototype.emit=function(se,Ce,be,st,tt,ut){var ht=G?G+se:se;if(!this._events[ht])return!1;var gt=this._events[ht],Be=arguments.length,dt,rt;if(gt.fn){switch(gt.once&&this.removeListener(se,gt.fn,void 0,!0),Be){case 1:return gt.fn.call(gt.context),!0;case 2:return gt.fn.call(gt.context,Ce),!0;case 3:return gt.fn.call(gt.context,Ce,be),!0;case 4:return gt.fn.call(gt.context,Ce,be,st),!0;case 5:return gt.fn.call(gt.context,Ce,be,st,tt),!0;case 6:return gt.fn.call(gt.context,Ce,be,st,tt,ut),!0}for(rt=1,dt=new Array(Be-1);rt<Be;rt++)dt[rt-1]=arguments[rt];gt.fn.apply(gt.context,dt)}else{var lt=gt.length,$;for(rt=0;rt<lt;rt++)switch(gt[rt].once&&this.removeListener(se,gt[rt].fn,void 0,!0),Be){case 1:gt[rt].fn.call(gt[rt].context);break;case 2:gt[rt].fn.call(gt[rt].context,Ce);break;case 3:gt[rt].fn.call(gt[rt].context,Ce,be);break;case 4:gt[rt].fn.call(gt[rt].context,Ce,be,st);break;default:if(!dt)for($=1,dt=new Array(Be-1);$<Be;$++)dt[$-1]=arguments[$];gt[rt].fn.apply(gt[rt].context,dt)}}return!0},U.prototype.on=function(se,Ce,be){return h(this,se,Ce,be,!1)},U.prototype.once=function(se,Ce,be){return h(this,se,Ce,be,!0)},U.prototype.removeListener=function(se,Ce,be,st){var tt=G?G+se:se;if(!this._events[tt])return this;if(!Ce)return z(this,tt),this;var ut=this._events[tt];if(ut.fn)ut.fn===Ce&&(!st||ut.once)&&(!be||ut.context===be)&&z(this,tt);else{for(var ht=0,gt=[],Be=ut.length;ht<Be;ht++)(ut[ht].fn!==Ce||st&&!ut[ht].once||be&&ut[ht].context!==be)&&gt.push(ut[ht]);gt.length?this._events[tt]=gt.length===1?gt[0]:gt:z(this,tt)}return this},U.prototype.removeAllListeners=function(se){var Ce;return se?(Ce=G?G+se:se,this._events[Ce]&&z(this,Ce)):(this._events=new H,this._eventsCount=0),this},U.prototype.off=U.prototype.removeListener,U.prototype.addListener=U.prototype.on,U.prefixed=G,U.EventEmitter=U,ae.exports=U},ujMp:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.circularDependencyToException=Z.listMetadataForTarget=Z.listRegisteredBindingsForServiceIdentifier=Z.getServiceIdentifierAsString=Z.getFunctionName=void 0;var N=w("MON2");function G(se){if(typeof se=="function"){var Ce=se;return Ce.name}else{if(typeof se=="symbol")return se.toString();var Ce=se;return Ce}}Z.getServiceIdentifierAsString=G;function H(se,Ce,be){var st="",tt=be(se,Ce);return tt.length!==0&&(st=`
Registered bindings:`,tt.forEach(function(ut){var ht="Object";ut.implementationType!==null&&(ht=Q(ut.implementationType)),st=st+`
 `+ht,ut.constraint.metaData&&(st=st+" - "+ut.constraint.metaData)})),st}Z.listRegisteredBindingsForServiceIdentifier=H;function B(se,Ce){return se.parentRequest===null?!1:se.parentRequest.serviceIdentifier===Ce?!0:B(se.parentRequest,Ce)}function h(se){function Ce(st,tt){tt===void 0&&(tt=[]);var ut=G(st.serviceIdentifier);return tt.push(ut),st.parentRequest!==null?Ce(st.parentRequest,tt):tt}var be=Ce(se);return be.reverse().join(" --> ")}function z(se){se.childRequests.forEach(function(Ce){if(B(Ce,Ce.serviceIdentifier)){var be=h(Ce);throw new Error(N.CIRCULAR_DEPENDENCY+" "+be)}else z(Ce)})}Z.circularDependencyToException=z;function U(se,Ce){if(Ce.isTagged()||Ce.isNamed()){var be="",st=Ce.getNamedTag(),tt=Ce.getCustomTags();return st!==null&&(be+=st.toString()+`
`),tt!==null&&tt.forEach(function(ut){be+=ut.toString()+`
`})," "+se+`
 `+se+" - "+be}else return" "+se}Z.listMetadataForTarget=U;function Q(se){if(se.name)return se.name;var Ce=se.toString(),be=Ce.match(/^function\s*([^\s(]+)/);return be?be[1]:"Anonymous function: "+Ce}Z.getFunctionName=Q},"vN+2":function(ae,Z){function w(){}ae.exports=w},"w/wX":function(ae,Z,w){var N=w("QqLw"),G=w("ExA7"),H="[object Set]";function B(h){return G(h)&&N(h)==H}ae.exports=B},wclG:function(ae,Z,w){var N=w("pFRH"),G=w("88Gu"),H=G(N);ae.exports=H},wnjb:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.MetadataReader=void 0;var N=w("xfSm"),G=function(){function H(){}return H.prototype.getConstructorMetadata=function(B){var h=Reflect.getMetadata(N.PARAM_TYPES,B),z=Reflect.getMetadata(N.TAGGED,B);return{compilerGeneratedMetadata:h,userGeneratedMetadata:z||{}}},H.prototype.getPropertiesMetadata=function(B){var h=Reflect.getMetadata(N.TAGGED_PROP,B)||[];return h},H}();Z.MetadataReader=G},wrZu:function(ae,Z,w){var N=w("+K+b"),G=w("XYm9"),H=w("b2z7"),B=w("otv/"),h=w("yP5f"),z="[object Boolean]",U="[object Date]",Q="[object Map]",se="[object Number]",Ce="[object RegExp]",be="[object Set]",st="[object String]",tt="[object Symbol]",ut="[object ArrayBuffer]",ht="[object DataView]",gt="[object Float32Array]",Be="[object Float64Array]",dt="[object Int8Array]",rt="[object Int16Array]",lt="[object Int32Array]",$="[object Uint8Array]",Qt="[object Uint8ClampedArray]",Ir="[object Uint16Array]",br="[object Uint32Array]";function Rt(ke,Mt,Nt){var nr=ke.constructor;switch(Mt){case ut:return N(ke);case z:case U:return new nr(+ke);case ht:return G(ke,Nt);case gt:case Be:case dt:case rt:case lt:case $:case Qt:case Ir:case br:return h(ke,Nt);case Q:return new nr;case se:case st:return new nr(ke);case Ce:return H(ke);case be:return new nr;case tt:return B(ke)}}ae.exports=Rt},wy8a:function(ae,Z,w){var N=w("KxBF");function G(H,B,h){var z=H.length;return h=h===void 0?z:h,!B&&h>=z?H:N(H,B,h)}ae.exports=G},xfSm:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.NON_CUSTOM_TAG_KEYS=Z.POST_CONSTRUCT=Z.DESIGN_PARAM_TYPES=Z.PARAM_TYPES=Z.TAGGED_PROP=Z.TAGGED=Z.MULTI_INJECT_TAG=Z.INJECT_TAG=Z.OPTIONAL_TAG=Z.UNMANAGED_TAG=Z.NAME_TAG=Z.NAMED_TAG=void 0,Z.NAMED_TAG="named",Z.NAME_TAG="name",Z.UNMANAGED_TAG="unmanaged",Z.OPTIONAL_TAG="optional",Z.INJECT_TAG="inject",Z.MULTI_INJECT_TAG="multi_inject",Z.TAGGED="inversify:tagged",Z.TAGGED_PROP="inversify:tagged_props",Z.PARAM_TYPES="inversify:paramtypes",Z.DESIGN_PARAM_TYPES="design:paramtypes",Z.POST_CONSTRUCT="post_construct";function N(){return[Z.INJECT_TAG,Z.MULTI_INJECT_TAG,Z.NAME_TAG,Z.UNMANAGED_TAG,Z.NAMED_TAG,Z.OPTIONAL_TAG]}Z.NON_CUSTOM_TAG_KEYS=N()},xfeJ:function(ae,Z){function w(N){return Function.toString.call(N).indexOf("[native code]")!==-1}ae.exports=w,ae.exports.__esModule=!0,ae.exports.default=ae.exports},xiII:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.Request=void 0;var N=w("d9O0"),G=function(){function H(B,h,z,U,Q){this.id=N.id(),this.serviceIdentifier=B,this.parentContext=h,this.parentRequest=z,this.target=Q,this.childRequests=[],this.bindings=Array.isArray(U)?U:[U],this.requestScope=z===null?new Map:null}return H.prototype.addChildRequest=function(B,h,z){var U=new H(B,this.parentContext,this,h,z);return this.childRequests.push(U),U},H}();Z.Request=G},xp6e:function(ae,Z,w){"use strict";(function(N){w.d(Z,"a",function(){return ot}),w.d(Z,"b",function(){return Pt}),w.d(Z,"c",function(){return de}),w.d(Z,"d",function(){return ur});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function G(Ft,Et,St,Zt){function dr(qt){return qt instanceof St?qt:new St(function(pr){pr(qt)})}return new(St||(St=Promise))(function(qt,pr){function Ur(Rr){try{or(Zt.next(Rr))}catch(Hn){pr(Hn)}}function gr(Rr){try{or(Zt.throw(Rr))}catch(Hn){pr(Hn)}}function or(Rr){Rr.done?qt(Rr.value):dr(Rr.value).then(Ur,gr)}or((Zt=Zt.apply(Ft,Et||[])).next())})}function H(Ft,Et){var St={label:0,sent:function(){if(qt[0]&1)throw qt[1];return qt[1]},trys:[],ops:[]},Zt,dr,qt,pr;return pr={next:Ur(0),throw:Ur(1),return:Ur(2)},typeof Symbol=="function"&&(pr[Symbol.iterator]=function(){return this}),pr;function Ur(or){return function(Rr){return gr([or,Rr])}}function gr(or){if(Zt)throw new TypeError("Generator is already executing.");for(;St;)try{if(Zt=1,dr&&(qt=or[0]&2?dr.return:or[0]?dr.throw||((qt=dr.return)&&qt.call(dr),0):dr.next)&&!(qt=qt.call(dr,or[1])).done)return qt;switch(dr=0,qt&&(or=[or[0]&2,qt.value]),or[0]){case 0:case 1:qt=or;break;case 4:return St.label++,{value:or[1],done:!1};case 5:St.label++,dr=or[1],or=[0];continue;case 7:or=St.ops.pop(),St.trys.pop();continue;default:if(qt=St.trys,!(qt=qt.length>0&&qt[qt.length-1])&&(or[0]===6||or[0]===2)){St=0;continue}if(or[0]===3&&(!qt||or[1]>qt[0]&&or[1]<qt[3])){St.label=or[1];break}if(or[0]===6&&St.label<qt[1]){St.label=qt[1],qt=or;break}if(qt&&St.label<qt[2]){St.label=qt[2],St.ops.push(or);break}qt[2]&&St.ops.pop(),St.trys.pop();continue}or=Et.call(Ft,St)}catch(Rr){or=[6,Rr],dr=0}finally{Zt=qt=0}if(or[0]&5)throw or[1];return{value:or[0]?or[1]:void 0,done:!0}}}function B(Ft,Et){var St=typeof Symbol=="function"&&Ft[Symbol.iterator];if(!St)return Ft;var Zt=St.call(Ft),dr,qt=[],pr;try{for(;(Et===void 0||Et-- >0)&&!(dr=Zt.next()).done;)qt.push(dr.value)}catch(Ur){pr={error:Ur}}finally{try{dr&&!dr.done&&(St=Zt.return)&&St.call(Zt)}finally{if(pr)throw pr.error}}return qt}function h(){for(var Ft=[],Et=0;Et<arguments.length;Et++)Ft=Ft.concat(B(arguments[Et]));return Ft}function z(Ft){return Ft&&Ft.__esModule&&Object.prototype.hasOwnProperty.call(Ft,"default")?Ft.default:Ft}function U(Ft,Et){return Et={exports:{}},Ft(Et,Et.exports),Et.exports}var Q=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=St;function St(Zt){return Zt&&typeof Zt.length=="number"&&Zt.length>=0&&Zt.length%1==0}Ft.exports=Et.default});z(Q);var se=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=function(St){return function(){for(var Zt=[],dr=arguments.length;dr--;)Zt[dr]=arguments[dr];var qt=Zt.pop();return St.call(this,Zt,qt)}},Ft.exports=Et.default});z(se);var Ce=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.fallback=dr,Et.wrap=qt;var St=Et.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Zt=Et.hasNextTick=typeof N=="object"&&typeof N.nextTick=="function";function dr(Ur){setTimeout(Ur,0)}function qt(Ur){return function(gr){for(var or=[],Rr=arguments.length-1;Rr-- >0;)or[Rr]=arguments[Rr+1];return Ur(function(){return gr.apply(void 0,or)})}}var pr;St?pr=setImmediate:Zt?pr=N.nextTick:pr=dr,Et.default=qt(pr)});z(Ce);var be=Ce.fallback,st=Ce.wrap,tt=Ce.hasSetImmediate,ut=Ce.hasNextTick,ht=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=qt;var St=dr(se),Zt=dr(Ce);function dr(gr){return gr&&gr.__esModule?gr:{default:gr}}function qt(gr){return(0,gt.isAsync)(gr)?function(){for(var or=[],Rr=arguments.length;Rr--;)or[Rr]=arguments[Rr];var Hn=or.pop(),en=gr.apply(this,or);return pr(en,Hn)}:(0,St.default)(function(or,Rr){var Hn;try{Hn=gr.apply(this,or)}catch(en){return Rr(en)}if(Hn&&typeof Hn.then=="function")return pr(Hn,Rr);Rr(null,Hn)})}function pr(gr,or){return gr.then(function(Rr){Ur(or,null,Rr)},function(Rr){Ur(or,Rr&&Rr.message?Rr:new Error(Rr))})}function Ur(gr,or,Rr){try{gr(or,Rr)}catch(Hn){(0,Zt.default)(function(en){throw en},Hn)}}Ft.exports=Et.default});z(ht);var gt=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.isAsyncIterable=Et.isAsyncGenerator=Et.isAsync=void 0;var St=Zt(ht);function Zt(gr){return gr&&gr.__esModule?gr:{default:gr}}function dr(gr){return gr[Symbol.toStringTag]==="AsyncFunction"}function qt(gr){return gr[Symbol.toStringTag]==="AsyncGenerator"}function pr(gr){return typeof gr[Symbol.asyncIterator]=="function"}function Ur(gr){if(typeof gr!="function")throw new Error("expected a function");return dr(gr)?(0,St.default)(gr):gr}Et.default=Ur,Et.isAsync=dr,Et.isAsyncGenerator=qt,Et.isAsyncIterable=pr});z(gt);var Be=gt.isAsyncIterable,dt=gt.isAsyncGenerator,rt=gt.isAsync,lt=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=St;function St(Zt,dr){if(dr===void 0&&(dr=Zt.length),!dr)throw new Error("arity is undefined");function qt(){for(var pr=this,Ur=[],gr=arguments.length;gr--;)Ur[gr]=arguments[gr];return typeof Ur[dr-1]=="function"?Zt.apply(this,Ur):new Promise(function(or,Rr){Ur[dr-1]=function(Hn){for(var en=[],_n=arguments.length-1;_n-- >0;)en[_n]=arguments[_n+1];if(Hn)return Rr(Hn);or(en.length>1?en:en[0])},Zt.apply(pr,Ur)})}return Object.defineProperty(qt,"name",{configurable:!0,value:"awaitable("+Zt.name+")"}),qt}Ft.exports=Et.default});z(lt);var $=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0});var St=qt(Q),Zt=qt(gt),dr=qt(lt);function qt(pr){return pr&&pr.__esModule?pr:{default:pr}}Et.default=(0,dr.default)(function(pr,Ur,gr){var or=(0,St.default)(Ur)?[]:{};pr(Ur,function(Rr,Hn,en){(0,Zt.default)(Rr)(function(_n){for(var qn,ii=[],Xi=arguments.length-1;Xi-- >0;)ii[Xi]=arguments[Xi+1];ii.length<2&&(qn=ii,ii=qn[0]),or[Hn]=ii,en(_n)})},function(Rr){return gr(Rr,or)})},3),Ft.exports=Et.default});z($);var Qt=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=St;function St(Zt){function dr(){for(var qt=[],pr=arguments.length;pr--;)qt[pr]=arguments[pr];if(Zt!==null){var Ur=Zt;Zt=null,Ur.apply(this,qt)}}return Object.assign(dr,Zt),dr}Ft.exports=Et.default});z(Qt);var Ir=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=function(St){return St[Symbol.iterator]&&St[Symbol.iterator]()},Ft.exports=Et.default});z(Ir);var br=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=gr;var St=dr(Q),Zt=dr(Ir);function dr(or){return or&&or.__esModule?or:{default:or}}function qt(or){var Rr=-1,Hn=or.length;return function(){return++Rr<Hn?{value:or[Rr],key:Rr}:null}}function pr(or){var Rr=-1;return function(){var en=or.next();return en.done?null:(Rr++,{value:en.value,key:Rr})}}function Ur(or){var Rr=or?Object.keys(or):[],Hn=-1,en=Rr.length;return function(){var qn=Rr[++Hn];return Hn<en?{value:or[qn],key:qn}:null}}function gr(or){if((0,St.default)(or))return qt(or);var Rr=(0,Zt.default)(or);return Rr?pr(Rr):Ur(or)}Ft.exports=Et.default});z(br);var Rt=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=St;function St(Zt){return function(){for(var dr=[],qt=arguments.length;qt--;)dr[qt]=arguments[qt];if(Zt===null)throw new Error("Callback was already called.");var pr=Zt;Zt=null,pr.apply(this,dr)}}Ft.exports=Et.default});z(Rt);var ke=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0});var St={};Et.default=St,Ft.exports=Et.default});z(ke);var Mt=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=dr;var St=Zt(ke);function Zt(qt){return qt&&qt.__esModule?qt:{default:qt}}function dr(qt,pr,Ur,gr){var or=!1,Rr=!1,Hn=!1,en=0,_n=0;function qn(){en>=pr||Hn||or||(Hn=!0,qt.next().then(function(me){var yn=me.value,Bi=me.done;if(!(Rr||or)){if(Hn=!1,Bi){or=!0,en<=0&&gr(null);return}en++,Ur(yn,_n,ii),_n++,qn()}}).catch(Xi))}function ii(me,yn){if(en-=1,!Rr){if(me)return Xi(me);if(me===!1){or=!0,Rr=!0;return}if(yn===St.default||or&&en<=0)return or=!0,gr(null);qn()}}function Xi(me){Rr||(Hn=!1,or=!0,gr(me))}qn()}Ft.exports=Et.default});z(Mt);var Nt=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0});var St=Ur(Qt),Zt=Ur(br),dr=Ur(Rt),qt=Ur(Mt),pr=Ur(ke);function Ur(gr){return gr&&gr.__esModule?gr:{default:gr}}Et.default=function(gr){return function(or,Rr,Hn){if(Hn=(0,St.default)(Hn),gr<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!or)return Hn(null);if((0,gt.isAsyncGenerator)(or))return(0,qt.default)(or,gr,Rr,Hn);if((0,gt.isAsyncIterable)(or))return(0,qt.default)(or[Symbol.asyncIterator](),gr,Rr,Hn);var en=(0,Zt.default)(or),_n=!1,qn=!1,ii=0,Xi=!1;function me(Bi,Mo){if(!qn)if(ii-=1,Bi)_n=!0,Hn(Bi);else if(Bi===!1)_n=!0,qn=!0;else{if(Mo===pr.default||_n&&ii<=0)return _n=!0,Hn(null);Xi||yn()}}function yn(){for(Xi=!0;ii<gr&&!_n;){var Bi=en();if(Bi===null){_n=!0,ii<=0&&Hn(null);return}ii+=1,Rr(Bi.value,Bi.key,(0,dr.default)(me))}Xi=!1}yn()}},Ft.exports=Et.default});z(Nt);var nr=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0});var St=qt(Nt),Zt=qt(gt),dr=qt(lt);function qt(Ur){return Ur&&Ur.__esModule?Ur:{default:Ur}}function pr(Ur,gr,or,Rr){return(0,St.default)(gr)(Ur,(0,Zt.default)(or),Rr)}Et.default=(0,dr.default)(pr,4),Ft.exports=Et.default});z(nr);var Mr=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0});var St=dr(nr),Zt=dr(lt);function dr(pr){return pr&&pr.__esModule?pr:{default:pr}}function qt(pr,Ur,gr){return(0,St.default)(pr,1,Ur,gr)}Et.default=(0,Zt.default)(qt,3),Ft.exports=Et.default});z(Mr);var Jr=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=qt;var St=dr($),Zt=dr(Mr);function dr(pr){return pr&&pr.__esModule?pr:{default:pr}}function qt(pr,Ur){return(0,St.default)(Zt.default,pr,Ur)}Ft.exports=Et.default}),Er=z(Jr),de=function(){function Ft(){for(var Et=arguments,St=[],Zt=0;Zt<arguments.length;Zt++)St[Zt]=Et[Zt];this.args=[],this.tasks=[]}return Ft.prototype.call=function(){for(var Et=arguments,St=[],Zt=0;Zt<arguments.length;Zt++)St[Zt]=Et[Zt];return this.args=St,Er(this.tasks)},Ft.prototype.tap=function(Et,St){var Zt=this;this.tasks.push(function(dr){St.apply(void 0,h(Zt.args)),dr(null,Et)})},Ft}(),Ie=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0});var St=or(Q),Zt=or(ke),dr=or(nr),qt=or(Qt),pr=or(Rt),Ur=or(gt),gr=or(lt);function or(_n){return _n&&_n.__esModule?_n:{default:_n}}function Rr(_n,qn,ii){ii=(0,qt.default)(ii);var Xi=0,me=0,yn=_n.length,Bi=!1;yn===0&&ii(null);function Mo(os,jt){os===!1&&(Bi=!0),Bi!==!0&&(os?ii(os):(++me===yn||jt===Zt.default)&&ii(null))}for(;Xi<yn;Xi++)qn(_n[Xi],Xi,(0,pr.default)(Mo))}function Hn(_n,qn,ii){return(0,dr.default)(_n,Infinity,qn,ii)}function en(_n,qn,ii){var Xi=(0,St.default)(_n)?Rr:Hn;return Xi(_n,(0,Ur.default)(qn),ii)}Et.default=(0,gr.default)(en,3),Ft.exports=Et.default});z(Ie);var we=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=qt;var St=dr(Ie),Zt=dr($);function dr(pr){return pr&&pr.__esModule?pr:{default:pr}}function qt(pr,Ur){return(0,Zt.default)(St.default,pr,Ur)}Ft.exports=Et.default}),ct=z(we),ot=function(){function Ft(){for(var Et=arguments,St=[],Zt=0;Zt<arguments.length;Zt++)St[Zt]=Et[Zt];this.tasks=[]}return Ft.prototype.promise=function(){for(var Et=arguments,St=[],Zt=0;Zt<arguments.length;Zt++)St[Zt]=Et[Zt];return ct(this.tasks)},Ft.prototype.tapPromise=function(Et,St){var Zt=this;this.tasks.push(function(dr){return G(Zt,void 0,void 0,function(){return H(this,function(qt){switch(qt.label){case 0:return[4,St()];case 1:return qt.sent(),dr(null,Et),[2]}})})})},Ft}(),wt=U(function(Ft,Et){Object.defineProperty(Et,"__esModule",{value:!0});var St=pr(Qt),Zt=pr(Rt),dr=pr(gt),qt=pr(lt);function pr(gr){return gr&&gr.__esModule?gr:{default:gr}}function Ur(gr,or){if(or=(0,St.default)(or),!Array.isArray(gr))return or(new Error("First argument to waterfall must be an array of functions"));if(!gr.length)return or();var Rr=0;function Hn(_n){var qn=(0,dr.default)(gr[Rr++]);qn.apply(void 0,_n.concat([(0,Zt.default)(en)]))}function en(_n){for(var qn=[],ii=arguments.length-1;ii-- >0;)qn[ii]=arguments[ii+1];if(_n!==!1){if(_n||Rr===gr.length)return or.apply(void 0,[_n].concat(qn));Hn(qn)}}Hn([])}Et.default=(0,qt.default)(Ur),Ft.exports=Et.default}),S=z(wt),ur=function(){function Ft(){for(var Et=arguments,St=[],Zt=0;Zt<arguments.length;Zt++)St[Zt]=Et[Zt];this.tasks=[]}return Ft.prototype.call=function(){for(var Et=arguments,St=[],Zt=0;Zt<arguments.length;Zt++)St[Zt]=Et[Zt];return S(this.tasks)},Ft.prototype.tap=function(Et,St){this.tasks.length===0?this.tasks.push(function(Zt){var dr=St();Zt(dr?null:!1,dr)}):this.tasks.push(function(Zt,dr){var qt=St();dr(qt?null:!1,Et)})},Ft}(),Pt=function(){function Ft(){for(var Et=arguments,St=[],Zt=0;Zt<arguments.length;Zt++)St[Zt]=Et[Zt];this.tasks=[]}return Ft.prototype.call=function(){for(var Et=arguments,St=[],Zt=0;Zt<arguments.length;Zt++)St[Zt]=Et[Zt];return Er(this.tasks)},Ft.prototype.tap=function(Et,St){this.tasks.push(function(Zt){var dr=St();Zt(dr,Et)})},Ft}()}).call(this,w("Q2Ig"))},yG8O:function(ae,Z){function w(N,G,H,B){!H||Object.defineProperty(N,G,{enumerable:H.enumerable,configurable:H.configurable,writable:H.writable,value:H.initializer?H.initializer.call(B):void 0})}ae.exports=w,ae.exports.__esModule=!0,ae.exports.default=ae.exports},yHx3:function(ae,Z){var w=Object.prototype,N=w.hasOwnProperty;function G(H){var B=H.length,h=new H.constructor(B);return B&&typeof H[0]=="string"&&N.call(H,"index")&&(h.index=H.index,h.input=H.input),h}ae.exports=G},yMAV:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.Plan=void 0;var N=function(){function G(H,B){this.parentContext=H,this.rootRequest=B}return G}();Z.Plan=N},yP5f:function(ae,Z,w){var N=w("+K+b");function G(H,B){var h=B?N(H.buffer):H.buffer;return new H.constructor(h,H.byteOffset,H.length)}ae.exports=G},yXPU:function(ae,Z){function w(G,H,B,h,z,U,Q){try{var se=G[U](Q),Ce=se.value}catch(be){B(be);return}se.done?H(Ce):Promise.resolve(Ce).then(h,z)}function N(G){return function(){var H=this,B=arguments;return new Promise(function(h,z){var U=G.apply(H,B);function Q(Ce){w(U,h,z,Q,se,"next",Ce)}function se(Ce){w(U,h,z,Q,se,"throw",Ce)}Q(void 0)})}}ae.exports=N,ae.exports.__esModule=!0,ae.exports.default=ae.exports},ycre:function(ae,Z,w){var N=w("711d"),G=N("length");ae.exports=G},z4Hk:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.BindingWhenSyntax=void 0;var N=w("406g"),G=w("RR/i"),H=function(){function B(h){this._binding=h}return B.prototype.when=function(h){return this._binding.constraint=h,new N.BindingOnSyntax(this._binding)},B.prototype.whenTargetNamed=function(h){return this._binding.constraint=G.namedConstraint(h),new N.BindingOnSyntax(this._binding)},B.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(h){var z=h.target!==null&&!h.target.isNamed()&&!h.target.isTagged();return z},new N.BindingOnSyntax(this._binding)},B.prototype.whenTargetTagged=function(h,z){return this._binding.constraint=G.taggedConstraint(h)(z),new N.BindingOnSyntax(this._binding)},B.prototype.whenInjectedInto=function(h){return this._binding.constraint=function(z){return G.typeConstraint(h)(z.parentRequest)},new N.BindingOnSyntax(this._binding)},B.prototype.whenParentNamed=function(h){return this._binding.constraint=function(z){return G.namedConstraint(h)(z.parentRequest)},new N.BindingOnSyntax(this._binding)},B.prototype.whenParentTagged=function(h,z){return this._binding.constraint=function(U){return G.taggedConstraint(h)(z)(U.parentRequest)},new N.BindingOnSyntax(this._binding)},B.prototype.whenAnyAncestorIs=function(h){return this._binding.constraint=function(z){return G.traverseAncerstors(z,G.typeConstraint(h))},new N.BindingOnSyntax(this._binding)},B.prototype.whenNoAncestorIs=function(h){return this._binding.constraint=function(z){return!G.traverseAncerstors(z,G.typeConstraint(h))},new N.BindingOnSyntax(this._binding)},B.prototype.whenAnyAncestorNamed=function(h){return this._binding.constraint=function(z){return G.traverseAncerstors(z,G.namedConstraint(h))},new N.BindingOnSyntax(this._binding)},B.prototype.whenNoAncestorNamed=function(h){return this._binding.constraint=function(z){return!G.traverseAncerstors(z,G.namedConstraint(h))},new N.BindingOnSyntax(this._binding)},B.prototype.whenAnyAncestorTagged=function(h,z){return this._binding.constraint=function(U){return G.traverseAncerstors(U,G.taggedConstraint(h)(z))},new N.BindingOnSyntax(this._binding)},B.prototype.whenNoAncestorTagged=function(h,z){return this._binding.constraint=function(U){return!G.traverseAncerstors(U,G.taggedConstraint(h)(z))},new N.BindingOnSyntax(this._binding)},B.prototype.whenAnyAncestorMatches=function(h){return this._binding.constraint=function(z){return G.traverseAncerstors(z,h)},new N.BindingOnSyntax(this._binding)},B.prototype.whenNoAncestorMatches=function(h){return this._binding.constraint=function(z){return!G.traverseAncerstors(z,h)},new N.BindingOnSyntax(this._binding)},B}();Z.BindingWhenSyntax=H},zEVN:function(ae,Z,w){var N=w("Gi0A"),G=w("sEf8"),H=w("mdPL"),B=H&&H.isMap,h=B?G(B):N;ae.exports=h},zZ0H:function(ae,Z){function w(N){return N}ae.exports=w},zoYe:function(ae,Z,w){var N=w("nmnc"),G=w("eUgh"),H=w("Z0cm"),B=w("/9aa"),h=1/0,z=N?N.prototype:void 0,U=z?z.toString:void 0;function Q(se){if(typeof se=="string")return se;if(H(se))return G(se,Q)+"";if(B(se))return U?U.call(se):"";var Ce=se+"";return Ce=="0"&&1/se==-h?"-0":Ce}ae.exports=Q},zvhG:function(ae,Z){ae.exports=w;function w(N,G,H,B){this.cx=3*N,this.bx=3*(H-N)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*G,this.by=3*(B-G)-this.cy,this.ay=1-this.cy-this.by,this.p1x=N,this.p1y=B,this.p2x=H,this.p2y=B}w.prototype.sampleCurveX=function(N){return((this.ax*N+this.bx)*N+this.cx)*N},w.prototype.sampleCurveY=function(N){return((this.ay*N+this.by)*N+this.cy)*N},w.prototype.sampleCurveDerivativeX=function(N){return(3*this.ax*N+2*this.bx)*N+this.cx},w.prototype.solveCurveX=function(N,G){typeof G=="undefined"&&(G=1e-6);var H,B,h,z,U;for(h=N,U=0;U<8;U++){if(z=this.sampleCurveX(h)-N,Math.abs(z)<G)return h;var Q=this.sampleCurveDerivativeX(h);if(Math.abs(Q)<1e-6)break;h=h-z/Q}if(H=0,B=1,h=N,h<H)return H;if(h>B)return B;for(;H<B;){if(z=this.sampleCurveX(h),Math.abs(z-N)<G)return h;N>z?H=h:B=h,h=(B-H)*.5+H}return h},w.prototype.solve=function(N,G){return this.sampleCurveY(this.solveCurveX(N,G))}},zxMA:function(ae,Z,w){"use strict";Object.defineProperty(Z,"__esModule",{value:!0}),Z.QueryableString=void 0;var N=function(){function G(H){this.str=H}return G.prototype.startsWith=function(H){return this.str.indexOf(H)===0},G.prototype.endsWith=function(H){var B="",h=H.split("").reverse().join("");return B=this.str.split("").reverse().join(""),this.startsWith.call({str:B},h)},G.prototype.contains=function(H){return this.str.indexOf(H)!==-1},G.prototype.equals=function(H){return this.str===H},G.prototype.value=function(){return this.str},G}();Z.QueryableString=N}}]);
