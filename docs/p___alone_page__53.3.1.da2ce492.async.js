(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[8407],{785017:function(ie,K,t){"use strict";t.r(K),t.d(K,{_:function(){return z},default:function(){return ce}});var me=t(703494),C=t(30951),de=t(580647),A=t(271494),e=t(556692),P=t(421326),T=t(254546),fe=t(748033),O=t(340328),ve=t(48602),w=t(808117),Ee=t(417952),D=t(943098),i=t(941877),ge=t(765418),L=t(133),y=t(788397),S=t(721961),Ze=t(616110),V=t(900133),W=t(363919),G=t(26733),x=(0,e.createContext)(null);function X(g){var f=g.children,F=(0,e.useState)(null),h=(0,S.Z)(F,2),v=h[0],Z=h[1];return(0,e.useEffect)(function(){var p=function(){var s=(0,y.Z)((0,i.Z)().mark(function l(){var n;return(0,i.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,G.X3)("pentestDB",1,{upgrade:function(u){u.objectStoreNames.contains("files")||u.createObjectStore("files",{keyPath:"id",autoIncrement:!0}),u.objectStoreNames.contains("assets")||u.createObjectStore("assets",{keyPath:"id",autoIncrement:!0}),u.objectStoreNames.contains("knowledge")||u.createObjectStore("knowledge",{keyPath:"id",autoIncrement:!0})}});case 2:n=a.sent,Z(n);case 4:case"end":return a.stop()}},l)}));return function(){return s.apply(this,arguments)}}();p()},[]),e.createElement(x.Provider,{value:v},f)}var $=function(){return(0,e.useContext)(x)},k=t(212574),J=V.Z.Dragger;function Q(){var g=(0,e.useState)([]),f=(0,S.Z)(g,2),F=f[0],h=f[1],v=$(),Z=function(){var s=(0,y.Z)((0,i.Z)().mark(function l(n){var E;return(0,i.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:try{E=new FileReader,E.onload=function(){var u=(0,y.Z)((0,i.Z)().mark(function o(d){var c,I,r,H,M;return(0,i.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return c=new Uint8Array(d.target.result),I=k.read(c,{type:"array"}),r=I.Sheets[I.SheetNames[0]],H=k.utils.sheet_to_json(r),M={name:n.name,type:n.type,uploadTime:new Date().toISOString(),content:H},j.next=7,v.add("files",M);case 7:L.default.success("".concat(n.name," \u4E0A\u4F20\u6210\u529F")),p();case 9:case"end":return j.stop()}},o)}));return function(o){return u.apply(this,arguments)}}(),E.readAsArrayBuffer(n)}catch(u){L.default.error("".concat(n.name," \u4E0A\u4F20\u5931\u8D25\uFF1A").concat(u.message))}return m.abrupt("return",!1);case 2:case"end":return m.stop()}},l)}));return function(n){return s.apply(this,arguments)}}(),p=function(){var s=(0,y.Z)((0,i.Z)().mark(function l(){var n;return(0,i.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!v){a.next=5;break}return a.next=3,v.getAll("files");case 3:n=a.sent,h(n);case 5:case"end":return a.stop()}},l)}));return function(){return s.apply(this,arguments)}}();return(0,e.useEffect)(function(){p()},[v]),e.createElement("div",null,e.createElement(D.Z,{title:"\u6587\u4EF6\u4E0A\u4F20",style:{marginBottom:20}},e.createElement(J,{customRequest:function(l){var n=l.file;return Z(n)},showUploadList:!1},e.createElement("p",{className:"ant-upload-drag-icon"},e.createElement(W.Z,null)),e.createElement("p",{className:"ant-upload-text"},"\u70B9\u51FB\u6216\u62D6\u62FD\u6587\u4EF6\u5230\u6B64\u533A\u57DF\u4E0A\u4F20"),e.createElement("p",{className:"ant-upload-hint"},"\u652F\u6301 .xlsx, .csv \u683C\u5F0F\u7684\u6587\u4EF6"))),e.createElement(D.Z,{title:"\u65F6\u95F4\u8F74"},e.createElement(O.Z,{mode:"left"},F.map(function(s,l){return e.createElement(O.Z.Item,{key:l,label:new Date(s.uploadTime).toLocaleString()},e.createElement(D.Z,{size:"small",title:s.name},e.createElement(w.Z,{size:"small",onClick:function(){return L.default.info("\u67E5\u770B\u6587\u4EF6\u5185\u5BB9")}},"\u67E5\u770B\u5185\u5BB9")))}))))}var Y=Q,he=t(598246),b=t(425668),pe=t(931719),q=t(937010),ye=t(15746),N=t(631314),_=N.Z.Search;function ee(){var g=(0,e.useState)([]),f=(0,S.Z)(g,2),F=f[0],h=f[1],v=(0,e.useState)([]),Z=(0,S.Z)(v,2),p=Z[0],s=Z[1],l=$(),n=[{title:"\u7C7B\u578B",dataIndex:"type",key:"type",render:function(m){return e.createElement(q.Z,{color:"blue"},m)}},{title:"\u57DF\u540D/IP",dataIndex:"target",key:"target"},{title:"\u7AEF\u53E3",dataIndex:"port",key:"port"},{title:"URL",dataIndex:"url",key:"url"},{title:"\u6307\u7EB9\u4FE1\u606F",dataIndex:"fingerprint",key:"fingerprint"}],E=function(m){var u=F.filter(function(o){return Object.values(o).some(function(d){return String(d).toLowerCase().includes(m.toLowerCase())})});s(u)};return(0,e.useEffect)(function(){var a=function(){var m=(0,y.Z)((0,i.Z)().mark(function u(){var o;return(0,i.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!l){c.next=6;break}return c.next=3,l.getAll("assets");case 3:o=c.sent,h(o),s(o);case 6:case"end":return c.stop()}},u)}));return function(){return m.apply(this,arguments)}}();a()},[l]),e.createElement("div",null,e.createElement(D.Z,{title:"\u8D44\u4EA7\u7BA1\u7406"},e.createElement(_,{placeholder:"\u641C\u7D22\u8D44\u4EA7",onSearch:E,style:{marginBottom:20}}),e.createElement(b.Z,{columns:n,dataSource:p,rowKey:"id"})))}var te=ee,Se=t(736302),ae=t(620099),Fe=t(540675),U=t(963715),R=t(379812),Ae=t(182785),B=t(848603),ne=N.Z.TextArea;function re(){var g=(0,e.useState)([]),f=(0,S.Z)(g,2),F=f[0],h=f[1],v=(0,e.useState)(!1),Z=(0,S.Z)(v,2),p=Z[0],s=Z[1],l=B.Z.useForm(),n=(0,S.Z)(l,1),E=n[0],a=$(),m=function(){var o=(0,y.Z)((0,i.Z)().mark(function d(){var c;return(0,i.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!a){r.next=5;break}return r.next=3,a.getAll("knowledge");case 3:c=r.sent,h(c);case 5:case"end":return r.stop()}},d)}));return function(){return o.apply(this,arguments)}}();(0,e.useEffect)(function(){m()},[a]);var u=function(){var o=(0,y.Z)((0,i.Z)().mark(function d(c){return(0,i.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,a.add("knowledge",(0,R.Z)((0,R.Z)({},c),{},{createTime:new Date().toISOString()}));case 3:s(!1),E.resetFields(),m(),r.next=10;break;case 8:r.prev=8,r.t0=r.catch(0);case 10:case"end":return r.stop()}},d,null,[[0,8]])}));return function(c){return o.apply(this,arguments)}}();return e.createElement("div",null,e.createElement(D.Z,{title:"\u77E5\u8BC6\u5E93",extra:e.createElement(w.Z,{type:"primary",onClick:function(){return s(!0)}},"\u6DFB\u52A0\u8BB0\u5F55")},e.createElement(U.ZP,{itemLayout:"vertical",dataSource:F,renderItem:function(d){return e.createElement(U.ZP.Item,null,e.createElement(U.ZP.Item.Meta,{title:d.title,description:new Date(d.createTime).toLocaleString()}),d.content)}})),e.createElement(ae.Z,{title:"\u6DFB\u52A0\u77E5\u8BC6",visible:p,onCancel:function(){return s(!1)},footer:null},e.createElement(B.Z,{form:E,onFinish:u},e.createElement(B.Z.Item,{name:"title",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]},e.createElement(N.Z,{placeholder:"\u6807\u9898"})),e.createElement(B.Z.Item,{name:"content",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9"}]},e.createElement(ne,{rows:4,placeholder:"\u5185\u5BB9"})),e.createElement(B.Z.Item,null,e.createElement(w.Z,{type:"primary",htmlType:"submit"},"\u4FDD\u5B58")))))}var le=re,ue=A.Z.Header,De=A.Z.Sider,se=A.Z.Content;function oe(){return e.createElement(X,null,e.createElement(P.VK,null,e.createElement(A.Z,{style:{minHeight:"100vh"}},e.createElement(ue,null,e.createElement("div",{className:"logo"}),e.createElement(C.Z,{theme:"dark",mode:"horizontal"},e.createElement(C.Z.Item,{key:"1"},e.createElement(P.rU,{to:"/"},"\u65F6\u95F4\u8F74")),e.createElement(C.Z.Item,{key:"2"},e.createElement(P.rU,{to:"/assets"},"\u8D44\u4EA7\u7BA1\u7406")),e.createElement(C.Z.Item,{key:"3"},e.createElement(P.rU,{to:"/knowledge"},"\u77E5\u8BC6\u5E93")))),e.createElement(A.Z,null,e.createElement(se,{style:{margin:"24px 16px",padding:24,background:"#fff"}},e.createElement(T.rs,null,e.createElement(T.AW,{exact:!0,path:"/",component:Y}),e.createElement(T.AW,{path:"/assets",component:te}),e.createElement(T.AW,{path:"/knowledge",component:le})))))))}var z=function(){return e.createElement(e.Fragment,null,e.createElement(oe,null))},ce=z}}]);
