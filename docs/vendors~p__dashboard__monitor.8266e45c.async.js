(window.webpackJsonp=window.webpackJsonp||[]).push([[127],{"+K+b":function(le,$,M){var j=M("JHRd");function Z(Y){var k=new Y.constructor(Y.byteLength);return new j(k).set(new j(Y)),k}le.exports=Z},"+Qka":function(le,$,M){var j=M("fmRc"),Z=M("t2Dn"),Y=M("cq/+"),k=M("T1AV"),h=M("GoyQ"),V=M("mTTR"),H=M("itsj");function te(pe,Oe,Ae,vt,at){pe!==Oe&&Y(Oe,function(gt,yt){if(at||(at=new j),h(gt))k(pe,Oe,yt,Ae,te,vt,at);else{var St=vt?vt(H(pe,yt),gt,yt+"",pe,Oe,at):void 0;St===void 0&&(St=gt),Z(pe,yt,St)}},V)}le.exports=te},"+iFO":function(le,$,M){var j=M("dTAl"),Z=M("LcsW"),Y=M("6sVZ");function k(h){return typeof h.constructor=="function"&&!Y(h)?j(Z(h)):{}}le.exports=k},"/ezw":function(le,$,M){"use strict";var j=M("rePB"),Z=M("wx14"),Y=M("U8pU"),k=M("q1tI"),h=M("TSYQ"),V=M.n(h),H=function(be){var Ne=be.prefixCls,Ie=be.className,pt=be.width,mt=be.style;return k.createElement("h3",{className:V()(Ne,Ie),style:Object(Z.a)({width:pt},mt)})},te=H,pe=M("KQm4"),Oe=function(be){var Ne=function(Ut){var Xt=be.width,It=be.rows,Lt=It===void 0?2:It;if(Array.isArray(Xt))return Xt[Ut];if(Lt-1===Ut)return Xt},Ie=be.prefixCls,pt=be.className,mt=be.style,Dt=be.rows,w=Object(pe.a)(Array(Dt)).map(function(br,Ut){return k.createElement("li",{key:Ut,style:{width:Ne(Ut)}})});return k.createElement("ul",{className:V()(Ie,pt),style:mt},w)},Ae=Oe,vt=M("H84U"),at=function(be){var Ne,Ie,pt=be.prefixCls,mt=be.className,Dt=be.style,w=be.size,br=be.shape,Ut=V()((Ne={},Object(j.a)(Ne,"".concat(pt,"-lg"),w==="large"),Object(j.a)(Ne,"".concat(pt,"-sm"),w==="small"),Ne)),Xt=V()((Ie={},Object(j.a)(Ie,"".concat(pt,"-circle"),br==="circle"),Object(j.a)(Ie,"".concat(pt,"-square"),br==="square"),Object(j.a)(Ie,"".concat(pt,"-round"),br==="round"),Ie)),It=typeof w=="number"?{width:w,height:w,lineHeight:"".concat(w,"px")}:{};return k.createElement("span",{className:V()(pt,Ut,Xt,mt),style:Object(Z.a)(Object(Z.a)({},It),Dt)})},gt=at,yt=M("bT9E"),St=function(be){var Ne=function(pt){var mt=pt.getPrefixCls,Dt=be.prefixCls,w=be.className,br=be.active,Ut=mt("skeleton",Dt),Xt=Object(yt.a)(be,["prefixCls","className"]),It=V()(Ut,"".concat(Ut,"-element"),Object(j.a)({},"".concat(Ut,"-active"),br),w);return k.createElement("div",{className:It},k.createElement(gt,Object(Z.a)({prefixCls:"".concat(Ut,"-avatar")},Xt)))};return k.createElement(vt.a,null,Ne)};St.defaultProps={size:"default",shape:"circle"};var He=St,dt=function(be){var Ne=function(pt){var mt,Dt=pt.getPrefixCls,w=be.prefixCls,br=be.className,Ut=be.active,Xt=be.block,It=Xt===void 0?!1:Xt,Lt=Dt("skeleton",w),ir=Object(yt.a)(be,["prefixCls"]),Ar=V()(Lt,"".concat(Lt,"-element"),(mt={},Object(j.a)(mt,"".concat(Lt,"-active"),Ut),Object(j.a)(mt,"".concat(Lt,"-block"),It),mt),br);return k.createElement("div",{className:Ar},k.createElement(gt,Object(Z.a)({prefixCls:"".concat(Lt,"-button")},ir)))};return k.createElement(vt.a,null,Ne)};dt.defaultProps={size:"default"};var ct=dt,_t=function(be){var Ne=function(pt){var mt=pt.getPrefixCls,Dt=be.prefixCls,w=be.className,br=be.active,Ut=mt("skeleton",Dt),Xt=Object(yt.a)(be,["prefixCls"]),It=V()(Ut,"".concat(Ut,"-element"),Object(j.a)({},"".concat(Ut,"-active"),br),w);return k.createElement("div",{className:It},k.createElement(gt,Object(Z.a)({prefixCls:"".concat(Ut,"-input")},Xt)))};return k.createElement(vt.a,null,Ne)};_t.defaultProps={size:"default"};var ee=_t,rr="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",Fr=function(be){var Ne=function(pt){var mt=pt.getPrefixCls,Dt=be.prefixCls,w=be.className,br=be.style,Ut=mt("skeleton",Dt),Xt=V()(Ut,"".concat(Ut,"-element"),w);return k.createElement("div",{className:Xt},k.createElement("div",{className:V()("".concat(Ut,"-image"),w),style:br},k.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(Ut,"-image-svg")},k.createElement("path",{d:rr,className:"".concat(Ut,"-image-path")}))))};return k.createElement(vt.a,null,Ne)},Mr=Fr;function Nt(kr){return kr&&Object(Y.a)(kr)==="object"?kr:{}}function ze(kr,be){return kr&&!be?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function zt(kr,be){return!kr&&be?{width:"38%"}:kr&&be?{width:"50%"}:{}}function Kt(kr,be){var Ne={};return(!kr||!be)&&(Ne.width="61%"),!kr&&be?Ne.rows=3:Ne.rows=2,Ne}var vr=function(be){var Ne=function(pt){var mt=pt.getPrefixCls,Dt=pt.direction,w=be.prefixCls,br=be.loading,Ut=be.className,Xt=be.style,It=be.children,Lt=be.avatar,ir=be.title,Ar=be.paragraph,nr=be.active,Pr=be.round,$r=mt("skeleton",w);if(br||!("loading"in be)){var Or,_r=!!Lt,Br=!!ir,Jn=!!Ar,mn;if(_r){var wn=Object(Z.a)(Object(Z.a)({prefixCls:"".concat($r,"-avatar")},ze(Br,Jn)),Nt(Lt));mn=k.createElement("div",{className:"".concat($r,"-header")},k.createElement(gt,wn))}var pi;if(Br||Jn){var Ci;if(Br){var fa=Object(Z.a)(Object(Z.a)({prefixCls:"".concat($r,"-title")},zt(_r,Jn)),Nt(ir));Ci=k.createElement(te,fa)}var _e;if(Jn){var Pn=Object(Z.a)(Object(Z.a)({prefixCls:"".concat($r,"-paragraph")},Kt(_r,Br)),Nt(Ar));_e=k.createElement(Ae,Pn)}pi=k.createElement("div",{className:"".concat($r,"-content")},Ci,_e)}var oa=V()($r,(Or={},Object(j.a)(Or,"".concat($r,"-with-avatar"),_r),Object(j.a)(Or,"".concat($r,"-active"),nr),Object(j.a)(Or,"".concat($r,"-rtl"),Dt==="rtl"),Object(j.a)(Or,"".concat($r,"-round"),Pr),Or),Ut);return k.createElement("div",{className:oa,style:Xt},mn,pi)}return It};return k.createElement(vt.a,null,Ne)};vr.defaultProps={avatar:!1,title:!0,paragraph:!0},vr.Button=ct,vr.Avatar=He,vr.Input=ee,vr.Image=Mr;var jr=vr,vn=$.a=jr},"/kpp":function(le,$,M){"use strict";var j=M("rePB"),Z=M("wx14"),Y=M("U8pU"),k=M("q1tI"),h=M.n(k),V=M("TSYQ"),H=M.n(V),te=M("o/2+"),pe=M("H84U"),Oe=function(gt,yt){var St={};for(var He in gt)Object.prototype.hasOwnProperty.call(gt,He)&&yt.indexOf(He)<0&&(St[He]=gt[He]);if(gt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var dt=0,He=Object.getOwnPropertySymbols(gt);dt<He.length;dt++)yt.indexOf(He[dt])<0&&Object.prototype.propertyIsEnumerable.call(gt,He[dt])&&(St[He[dt]]=gt[He[dt]]);return St};function Ae(gt){return typeof gt=="number"?"".concat(gt," ").concat(gt," auto"):/^\d+(\.\d+)?(px|em|rem|%)$/.test(gt)?"0 0 ".concat(gt):gt}var vt=["xs","sm","md","lg","xl","xxl"],at=k.forwardRef(function(gt,yt){var St,He=k.useContext(pe.b),dt=He.getPrefixCls,ct=He.direction,_t=k.useContext(te.a),ee=_t.gutter,rr=_t.wrap,Fr=_t.supportFlexGap,Mr=gt.prefixCls,Nt=gt.span,ze=gt.order,zt=gt.offset,Kt=gt.push,vr=gt.pull,jr=gt.className,vn=gt.children,kr=gt.flex,be=gt.style,Ne=Oe(gt,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),Ie=dt("col",Mr),pt={};vt.forEach(function(Ut){var Xt,It={},Lt=gt[Ut];typeof Lt=="number"?It.span=Lt:Object(Y.a)(Lt)==="object"&&(It=Lt||{}),delete Ne[Ut],pt=Object(Z.a)(Object(Z.a)({},pt),(Xt={},Object(j.a)(Xt,"".concat(Ie,"-").concat(Ut,"-").concat(It.span),It.span!==void 0),Object(j.a)(Xt,"".concat(Ie,"-").concat(Ut,"-order-").concat(It.order),It.order||It.order===0),Object(j.a)(Xt,"".concat(Ie,"-").concat(Ut,"-offset-").concat(It.offset),It.offset||It.offset===0),Object(j.a)(Xt,"".concat(Ie,"-").concat(Ut,"-push-").concat(It.push),It.push||It.push===0),Object(j.a)(Xt,"".concat(Ie,"-").concat(Ut,"-pull-").concat(It.pull),It.pull||It.pull===0),Object(j.a)(Xt,"".concat(Ie,"-rtl"),ct==="rtl"),Xt))});var mt=H()(Ie,(St={},Object(j.a)(St,"".concat(Ie,"-").concat(Nt),Nt!==void 0),Object(j.a)(St,"".concat(Ie,"-order-").concat(ze),ze),Object(j.a)(St,"".concat(Ie,"-offset-").concat(zt),zt),Object(j.a)(St,"".concat(Ie,"-push-").concat(Kt),Kt),Object(j.a)(St,"".concat(Ie,"-pull-").concat(vr),vr),St),jr,pt),Dt={};if(ee&&ee[0]>0){var w=ee[0]/2;Dt.paddingLeft=w,Dt.paddingRight=w}if(ee&&ee[1]>0&&!Fr){var br=ee[1]/2;Dt.paddingTop=br,Dt.paddingBottom=br}return kr&&(Dt.flex=Ae(kr),rr===!1&&!Dt.minWidth&&(Dt.minWidth=0)),k.createElement("div",Object(Z.a)({},Ne,{style:Object(Z.a)(Object(Z.a)({},Dt),be),className:mt,ref:yt}),vn)});at.displayName="Col",$.a=at},"0JQy":function(le,$){var M="\\ud800-\\udfff",j="\\u0300-\\u036f",Z="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",k=j+Z+Y,h="\\ufe0e\\ufe0f",V="["+M+"]",H="["+k+"]",te="\\ud83c[\\udffb-\\udfff]",pe="(?:"+H+"|"+te+")",Oe="[^"+M+"]",Ae="(?:\\ud83c[\\udde6-\\uddff]){2}",vt="[\\ud800-\\udbff][\\udc00-\\udfff]",at="\\u200d",gt=pe+"?",yt="["+h+"]?",St="(?:"+at+"(?:"+[Oe,Ae,vt].join("|")+")"+yt+gt+")*",He=yt+gt+St,dt="(?:"+[Oe+H+"?",H,Ae,vt,V].join("|")+")",ct=RegExp(te+"(?="+te+")|"+dt+He,"g");function _t(ee){return ee.match(ct)||[]}le.exports=_t},"0ZTe":function(le,$,M){var j=M("wy8a"),Z=M("quyA"),Y=M("Em2t"),k=M("dt0z");function h(V){return function(H){H=k(H);var te=Z(H)?Y(H):void 0,pe=te?te[0]:H.charAt(0),Oe=te?j(te,1).join(""):H.slice(1);return pe[V]()+Oe}}le.exports=h},"0gSV":function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.tagged=void 0;var j=M("GXnB"),Z=M("Ztfv");function Y(k,h){return function(V,H,te){var pe=new j.Metadata(k,h);typeof te=="number"?Z.tagParameter(V,H,te,pe):Z.tagProperty(V,H,pe)}}$.tagged=Y},"1+5i":function(le,$,M){var j=M("w/wX"),Z=M("sEf8"),Y=M("mdPL"),k=Y&&Y.isSet,h=k?Z(k):j;le.exports=h},"1ABj":function(le,$){function M(j,Z){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}le.exports=M,le.exports.__esModule=!0,le.exports.default=le.exports},"2ajD":function(le,$){function M(j){return j!==j}le.exports=M},"3L66":function(le,$,M){var j=M("MMmD"),Z=M("ExA7");function Y(k){return Z(k)&&j(k)}le.exports=Y},"3cYt":function(le,$){function M(j){return function(Z){return j==null?void 0:j[Z]}}le.exports=M},"406g":function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingOnSyntax=void 0;var j=M("z4Hk"),Z=function(){function Y(k){this._binding=k}return Y.prototype.onActivation=function(k){return this._binding.onActivation=k,new j.BindingWhenSyntax(this._binding)},Y}();$.BindingOnSyntax=Z},"4ZJM":function(le,$,M){(function(j,Z){le.exports=Z()})(this,function(){"use strict";var j,Z,Y;function k(h,V){if(!j)j=V;else if(!Z)Z=V;else{var H="var sharedChunk = {}; ("+j+")(sharedChunk); ("+Z+")(sharedChunk);",te={};j(te),Y=V(te),typeof window!="undefined"&&(Y.workerUrl=window.URL.createObjectURL(new Blob([H],{type:"text/javascript"})))}}return k(["exports"],function(h){"use strict";function V(a,o){return a(o={exports:{}},o.exports),o.exports}var H=te;function te(a,o,u,v){this.cx=3*a,this.bx=3*(u-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(v-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=v,this.p2x=u,this.p2y=v}te.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a},te.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a},te.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},te.prototype.solveCurveX=function(a,o){var u,v,_,S,A;for(o===void 0&&(o=1e-6),_=a,A=0;A<8;A++){if(S=this.sampleCurveX(_)-a,Math.abs(S)<o)return _;var R=this.sampleCurveDerivativeX(_);if(Math.abs(R)<1e-6)break;_-=S/R}if((_=a)<(u=0))return u;if(_>(v=1))return v;for(;u<v;){if(S=this.sampleCurveX(_),Math.abs(S-a)<o)return _;a>S?u=_:v=_,_=.5*(v-u)+u}return _},te.prototype.solve=function(a,o){return this.sampleCurveY(this.solveCurveX(a,o))};var pe=Oe;function Oe(a,o){this.x=a,this.y=o}Oe.prototype={clone:function(){return new Oe(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,u){return this.clone()._rotateAround(o,u)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var u=o.x-this.x,v=o.y-this.y;return u*u+v*v},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,u){return Math.atan2(this.x*u-this.y*o,this.x*o+this.y*u)},_matMult:function(o){var u=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=u,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var u=Math.cos(o),v=Math.sin(o),_=v*this.x+u*this.y;return this.x=u*this.x-v*this.y,this.y=_,this},_rotateAround:function(o,u){var v=Math.cos(o),_=Math.sin(o),S=u.y+_*(this.x-u.x)+v*(this.y-u.y);return this.x=u.x+v*(this.x-u.x)-_*(this.y-u.y),this.y=S,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Oe.convert=function(a){return a instanceof Oe?a:Array.isArray(a)?new Oe(a[0],a[1]):a};var Ae=typeof self!="undefined"?self:{},vt=Math.pow(2,53)-1;function at(a,o,u,v){var _=new H(a,o,u,v);return function(S){return _.solve(S)}}var gt=at(.25,.1,.25,1);function yt(a,o,u){return Math.min(u,Math.max(o,a))}function St(a,o,u){var v=u-o,_=((a-o)%v+v)%v+o;return _===o?u:_}function He(a){for(var o=[],u=arguments.length-1;u-- >0;)o[u]=arguments[u+1];for(var v=0,_=o;v<_.length;v+=1){var S=_[v];for(var A in S)a[A]=S[A]}return a}var dt=1;function ct(){return dt++}function _t(){return function a(o){return o?(o^16*Math.random()>>o/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function ee(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function rr(a,o){a.forEach(function(u){o[u]&&(o[u]=o[u].bind(o))})}function Fr(a,o){return a.indexOf(o,a.length-o.length)!==-1}function Mr(a,o,u){var v={};for(var _ in a)v[_]=o.call(u||this,a[_],_,a);return v}function Nt(a,o,u){var v={};for(var _ in a)o.call(u||this,a[_],_,a)&&(v[_]=a[_]);return v}function ze(a){return Array.isArray(a)?a.map(ze):typeof a=="object"&&a?Mr(a,ze):a}var zt={};function Kt(a){zt[a]||(typeof console!="undefined"&&console.warn(a),zt[a]=!0)}function vr(a,o,u){return(u.y-a.y)*(o.x-a.x)>(o.y-a.y)*(u.x-a.x)}function jr(a){for(var o=0,u=0,v=a.length,_=v-1,S=void 0,A=void 0;u<v;_=u++)o+=((A=a[_]).x-(S=a[u]).x)*(S.y+A.y);return o}function vn(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function kr(a){var o={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(v,_,S,A){var R=S||A;return o[_]=!R||R.toLowerCase(),""}),o["max-age"]){var u=parseInt(o["max-age"],10);isNaN(u)?delete o["max-age"]:o["max-age"]=u}return o}var be=null;function Ne(a){if(be==null){var o=a.navigator?a.navigator.userAgent:null;be=!!a.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return be}function Ie(a){try{var o=Ae[a];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch(u){return!1}}var pt,mt,Dt,w,br=Ae.performance&&Ae.performance.now?Ae.performance.now.bind(Ae.performance):Date.now.bind(Date),Ut=Ae.requestAnimationFrame||Ae.mozRequestAnimationFrame||Ae.webkitRequestAnimationFrame||Ae.msRequestAnimationFrame,Xt=Ae.cancelAnimationFrame||Ae.mozCancelAnimationFrame||Ae.webkitCancelAnimationFrame||Ae.msCancelAnimationFrame,It={now:br,frame:function(o){var u=Ut(o);return{cancel:function(){return Xt(u)}}},getImageData:function(o,u){u===void 0&&(u=0);var v=Ae.document.createElement("canvas"),_=v.getContext("2d");if(!_)throw new Error("failed to create canvas 2d context");return v.width=o.width,v.height=o.height,_.drawImage(o,0,0,o.width,o.height),_.getImageData(-u,-u,o.width+2*u,o.height+2*u)},resolveURL:function(o){return pt||(pt=Ae.document.createElement("a")),pt.href=o,pt.href},hardwareConcurrency:Ae.navigator&&Ae.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Ae.devicePixelRatio},get prefersReducedMotion(){return!!Ae.matchMedia&&(mt==null&&(mt=Ae.matchMedia("(prefers-reduced-motion: reduce)")),mt.matches)}},Lt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ir={supported:!1,testSupport:function(o){!Ar&&w&&(nr?Pr(o):Dt=o)}},Ar=!1,nr=!1;function Pr(a){var o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,w),a.isContextLost())return;ir.supported=!0}catch(u){}a.deleteTexture(o),Ar=!0}Ae.document&&((w=Ae.document.createElement("img")).onload=function(){Dt&&Pr(Dt),Dt=null,nr=!0},w.onerror=function(){Ar=!0,Dt=null},w.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var $r="01",Or=function(o,u){this._transformRequestFn=o,this._customAccessToken=u,this._createSkuToken()};function _r(a){return a.indexOf("mapbox:")===0}Or.prototype._createSkuToken=function(){var a=function(){for(var o="",u=0;u<10;u++)o+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",$r,o].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt},Or.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Or.prototype.transformRequest=function(a,o){return this._transformRequestFn&&this._transformRequestFn(a,o)||{url:a}},Or.prototype.normalizeStyleURL=function(a,o){if(!_r(a))return a;var u=wn(a);return u.path="/styles/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||o)},Or.prototype.normalizeGlyphsURL=function(a,o){if(!_r(a))return a;var u=wn(a);return u.path="/fonts/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||o)},Or.prototype.normalizeSourceURL=function(a,o){if(!_r(a))return a;var u=wn(a);return u.path="/v4/"+u.authority+".json",u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||o)},Or.prototype.normalizeSpriteURL=function(a,o,u,v){var _=wn(a);return _r(a)?(_.path="/styles/v1"+_.path+"/sprite"+o+u,this._makeAPIURL(_,this._customAccessToken||v)):(_.path+=""+o+u,pi(_))},Or.prototype.normalizeTileURL=function(a,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!_r(a))return a;var u=wn(a);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,(It.devicePixelRatio>=2||o===512?"@2x":"")+(ir.supported?".webp":"$1")),u.path=u.path.replace(/^.+\/v4\//,"/"),u.path="/v4"+u.path;var v=this._customAccessToken||function(_){for(var S=0,A=_;S<A.length;S+=1){var R=A[S].match(/^access_token=(.*)$/);if(R)return R[1]}return null}(u.params)||Lt.ACCESS_TOKEN;return Lt.REQUIRE_ACCESS_TOKEN&&v&&this._skuToken&&u.params.push("sku="+this._skuToken),this._makeAPIURL(u,v)},Or.prototype.canonicalizeTileURL=function(a,o){var u=wn(a);if(!u.path.match(/(^\/v4\/)/)||!u.path.match(/\.[\w]+$/))return a;var v="mapbox://tiles/";v+=u.path.replace("/v4/","");var _=u.params;return o&&(_=_.filter(function(S){return!S.match(/^access_token=/)})),_.length&&(v+="?"+_.join("&")),v},Or.prototype.canonicalizeTileset=function(a,o){for(var u=!!o&&_r(o),v=[],_=0,S=a.tiles||[];_<S.length;_+=1){var A=S[_];Jn(A)?v.push(this.canonicalizeTileURL(A,u)):v.push(A)}return v},Or.prototype._makeAPIURL=function(a,o){var u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",v=wn(Lt.API_URL);if(a.protocol=v.protocol,a.authority=v.authority,a.protocol==="http"){var _=a.params.indexOf("secure");_>=0&&a.params.splice(_,1)}if(v.path!=="/"&&(a.path=""+v.path+a.path),!Lt.REQUIRE_ACCESS_TOKEN)return pi(a);if(!(o=o||Lt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+u);if(o[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+u);return a.params=a.params.filter(function(S){return S.indexOf("access_token")===-1}),a.params.push("access_token="+o),pi(a)};var Br=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Jn(a){return Br.test(a)}var mn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function wn(a){var o=a.match(mn);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function pi(a){var o=a.params.length?"?"+a.params.join("&"):"";return a.protocol+"://"+a.authority+a.path+o}function Ci(a){if(!a)return null;var o=a.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(decodeURIComponent(Ae.atob(o[1]).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(u){return null}}var fa=function(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};fa.prototype.getStorageKey=function(a){var o,u=Ci(Lt.ACCESS_TOKEN);return o=u&&u.u?Ae.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,function(v,_){return String.fromCharCode(Number("0x"+_))})):Lt.ACCESS_TOKEN||"",a?"mapbox.eventData."+a+":"+o:"mapbox.eventData:"+o},fa.prototype.fetchEventData=function(){var a=Ie("localStorage"),o=this.getStorageKey(),u=this.getStorageKey("uuid");if(a)try{var v=Ae.localStorage.getItem(o);v&&(this.eventData=JSON.parse(v));var _=Ae.localStorage.getItem(u);_&&(this.anonId=_)}catch(S){Kt("Unable to read from LocalStorage")}},fa.prototype.saveEventData=function(){var a=Ie("localStorage"),o=this.getStorageKey(),u=this.getStorageKey("uuid");if(a)try{Ae.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&Ae.localStorage.setItem(o,JSON.stringify(this.eventData))}catch(v){Kt("Unable to write to LocalStorage")}},fa.prototype.processRequests=function(a){},fa.prototype.postEvent=function(a,o,u,v){var _=this;if(Lt.EVENTS_URL){var S=wn(Lt.EVENTS_URL);S.params.push("access_token="+(v||Lt.ACCESS_TOKEN||""));var A={event:this.type,created:new Date(a).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:$r,userId:this.anonId},R=o?He(A,o):A,z={url:pi(S),headers:{"Content-Type":"text/plain"},body:JSON.stringify([R])};this.pendingRequest=wo(z,function(W){_.pendingRequest=null,u(W),_.saveEventData(),_.processRequests(v)})}},fa.prototype.queueRequest=function(a,o){this.queue.push(a),this.processRequests(o)};var _e,Pn,oa=function(a){function o(){a.call(this,"map.load"),this.success={},this.skuToken=""}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.postMapLoadEvent=function(u,v,_,S){this.skuToken=_,(Lt.EVENTS_URL&&S||Lt.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(A){return _r(A)||Jn(A)}))&&this.queueRequest({id:v,timestamp:Date.now()},S)},o.prototype.processRequests=function(u){var v=this;if(!this.pendingRequest&&this.queue.length!==0){var _=this.queue.shift(),S=_.id,A=_.timestamp;S&&this.success[S]||(this.anonId||this.fetchEventData(),ee(this.anonId)||(this.anonId=_t()),this.postEvent(A,{skuToken:this.skuToken},function(R){R||S&&(v.success[S]=!0)},u))}},o}(fa),ws=new(function(a){function o(u){a.call(this,"appUserTurnstile"),this._customAccessToken=u}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.postTurnstileEvent=function(u,v){Lt.EVENTS_URL&&Lt.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(_){return _r(_)||Jn(_)})&&this.queueRequest(Date.now(),v)},o.prototype.processRequests=function(u){var v=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var _=Ci(Lt.ACCESS_TOKEN),S=_?_.u:Lt.ACCESS_TOKEN,A=S!==this.eventData.tokenU;ee(this.anonId)||(this.anonId=_t(),A=!0);var R=this.queue.shift();if(this.eventData.lastSuccess){var z=new Date(this.eventData.lastSuccess),W=new Date(R),q=(R-this.eventData.lastSuccess)/864e5;A=A||q>=1||q<-1||z.getDate()!==W.getDate()}else A=!0;if(!A)return this.processRequests();this.postEvent(R,{"enabled.telemetry":!1},function(ne){ne||(v.eventData.lastSuccess=R,v.eventData.tokenU=S)},u)}},o}(fa)),ys=ws.postTurnstileEvent.bind(ws),Jt=new oa,Ir=Jt.postMapLoadEvent.bind(Jt),en=500,On=50;function ln(){Ae.caches&&!_e&&(_e=Ae.caches.open("mapbox-tiles"))}function Ka(a){var o=a.indexOf("?");return o<0?a:a.slice(0,o)}var wi,fi=1/0;function Ti(){return wi==null&&(wi=Ae.OffscreenCanvas&&new Ae.OffscreenCanvas(1,1).getContext("2d")&&typeof Ae.createImageBitmap=="function"),wi}var da={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(da);var ya=function(a){function o(u,v,_){v===401&&Jn(_)&&(u+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),a.call(this,u),this.status=v,this.url=_,this.name=this.constructor.name,this.message=u}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},o}(Error),_s=vn()?function(){return self.worker&&self.worker.referrer}:function(){return(Ae.location.protocol==="blob:"?Ae.parent:Ae).location.href},xo,$a,Vu=function(o,u){if(!(/^file:/.test(v=o.url)||/^file:/.test(_s())&&!/^\w+:/.test(v))){if(Ae.fetch&&Ae.Request&&Ae.AbortController&&Ae.Request.prototype.hasOwnProperty("signal"))return function(_,S){var A,R=new Ae.AbortController,z=new Ae.Request(_.url,{method:_.method||"GET",body:_.body,credentials:_.credentials,headers:_.headers,referrer:_s(),signal:R.signal}),W=!1,q=!1,ne=(A=z.url).indexOf("sku=")>0&&Jn(A);_.type==="json"&&z.headers.set("Accept","application/json");var ae=function(Be,Je,Qe){if(!q){if(Be&&Be.message!=="SecurityError"&&Kt(Be),Je&&Qe)return Te(Je);var Tt=Date.now();Ae.fetch(z).then(function(Zt){if(Zt.ok){var ar=ne?Zt.clone():null;return Te(Zt,ar,Tt)}return S(new ya(Zt.statusText,Zt.status,_.url))}).catch(function(Zt){Zt.code!==20&&S(new Error(Zt.message))})}},Te=function(Be,Je,Qe){(_.type==="arrayBuffer"?Be.arrayBuffer():_.type==="json"?Be.json():Be.text()).then(function(Tt){q||(Je&&Qe&&function(Zt,ar,Lr){if(ln(),_e){var xr={status:ar.status,statusText:ar.statusText,headers:new Ae.Headers};ar.headers.forEach(function(_n,ci){return xr.headers.set(ci,_n)});var dn=kr(ar.headers.get("Cache-Control")||"");dn["no-store"]||(dn["max-age"]&&xr.headers.set("Expires",new Date(Lr+1e3*dn["max-age"]).toUTCString()),new Date(xr.headers.get("Expires")).getTime()-Lr<42e4||function(_n,ci){if(Pn===void 0)try{new Response(new ReadableStream),Pn=!0}catch(_i){Pn=!1}Pn?ci(_n.body):_n.blob().then(ci)}(ar,function(_n){var ci=new Ae.Response(_n,xr);ln(),_e&&_e.then(function(_i){return _i.put(Ka(Zt.url),ci)}).catch(function(_i){return Kt(_i.message)})}))}}(z,Je,Qe),W=!0,S(null,Tt,Be.headers.get("Cache-Control"),Be.headers.get("Expires")))}).catch(function(Tt){q||S(new Error(Tt.message))})};return ne?function(je,Be){if(ln(),!_e)return Be(null);var Je=Ka(je.url);_e.then(function(Qe){Qe.match(Je).then(function(Tt){var Zt=function(ar){if(!ar)return!1;var Lr=new Date(ar.headers.get("Expires")||0),xr=kr(ar.headers.get("Cache-Control")||"");return Lr>Date.now()&&!xr["no-cache"]}(Tt);Qe.delete(Je),Zt&&Qe.put(Je,Tt.clone()),Be(null,Tt,Zt)}).catch(Be)}).catch(Be)}(z,ae):ae(null,null),{cancel:function(){q=!0,W||R.abort()}}}(o,u);if(vn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,u,void 0,!0)}var v;return function(_,S){var A=new Ae.XMLHttpRequest;for(var R in A.open(_.method||"GET",_.url,!0),_.type==="arrayBuffer"&&(A.responseType="arraybuffer"),_.headers)A.setRequestHeader(R,_.headers[R]);return _.type==="json"&&(A.responseType="text",A.setRequestHeader("Accept","application/json")),A.withCredentials=_.credentials==="include",A.onerror=function(){S(new Error(A.statusText))},A.onload=function(){if((A.status>=200&&A.status<300||A.status===0)&&A.response!==null){var z=A.response;if(_.type==="json")try{z=JSON.parse(A.response)}catch(W){return S(W)}S(null,z,A.getResponseHeader("Cache-Control"),A.getResponseHeader("Expires"))}else S(new ya(A.statusText,A.status,_.url))},A.send(_.body),{cancel:function(){return A.abort()}}}(o,u)},ec=function(o,u){return Vu(He(o,{type:"arrayBuffer"}),u)},wo=function(o,u){return Vu(He(o,{method:"POST"}),u)},oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";xo=[],$a=0;var ie=function a(o,u){if(ir.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),$a>=Lt.MAX_PARALLEL_IMAGE_REQUESTS){var v={requestParameters:o,callback:u,cancelled:!1,cancel:function(){this.cancelled=!0}};return xo.push(v),v}$a++;var _=!1,S=function(){if(!_)for(_=!0,$a--;xo.length&&$a<Lt.MAX_PARALLEL_IMAGE_REQUESTS;){var z=xo.shift();z.cancelled||(z.cancel=a(z.requestParameters,z.callback).cancel)}},A=ec(o,function(R,z,W,q){S(),R?u(R):z&&(Ti()?function(ne,ae){var Te=new Ae.Blob([new Uint8Array(ne)],{type:"image/png"});Ae.createImageBitmap(Te).then(function(je){ae(null,je)}).catch(function(je){ae(new Error("Could not load image because of "+je.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(z,u):function(ne,ae,Te,je){var Be=new Ae.Image,Je=Ae.URL;Be.onload=function(){ae(null,Be),Je.revokeObjectURL(Be.src),Be.onload=null,Ae.requestAnimationFrame(function(){Be.src=oe})},Be.onerror=function(){return ae(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Qe=new Ae.Blob([new Uint8Array(ne)],{type:"image/png"});Be.cacheControl=Te,Be.expires=je,Be.src=ne.byteLength?Je.createObjectURL(Qe):oe}(z,u,W,q))});return{cancel:function(){A.cancel(),S()}}};function xe(a,o,u){u[a]&&u[a].indexOf(o)!==-1||(u[a]=u[a]||[],u[a].push(o))}function Me(a,o,u){if(u&&u[a]){var v=u[a].indexOf(o);v!==-1&&u[a].splice(v,1)}}var Ve=function(o,u){u===void 0&&(u={}),He(this,u),this.type=o},ft=function(a){function o(u,v){v===void 0&&(v={}),a.call(this,"error",He({error:u},v))}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o}(Ve),Ct=function(){};Ct.prototype.on=function(a,o){return this._listeners=this._listeners||{},xe(a,o,this._listeners),this},Ct.prototype.off=function(a,o){return Me(a,o,this._listeners),Me(a,o,this._oneTimeListeners),this},Ct.prototype.once=function(a,o){return this._oneTimeListeners=this._oneTimeListeners||{},xe(a,o,this._oneTimeListeners),this},Ct.prototype.fire=function(a,o){typeof a=="string"&&(a=new Ve(a,o||{}));var u=a.type;if(this.listens(u)){a.target=this;for(var v=0,_=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];v<_.length;v+=1)_[v].call(this,a);for(var S=0,A=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];S<A.length;S+=1){var R=A[S];Me(u,R,this._oneTimeListeners),R.call(this,a)}var z=this._eventedParent;z&&(He(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),z.fire(a))}else a instanceof ft&&console.error(a.error);return this},Ct.prototype.listens=function(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)},Ct.prototype.setEventedParent=function(a,o){return this._eventedParent=a,this._eventedParentData=o,this};var Ce={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ye=function(o,u,v,_){this.message=(o?o+": ":"")+v,_&&(this.identifier=_),u!=null&&u.__line__&&(this.line=u.__line__)};function nt(a){var o=a.value;return o?[new Ye(a.key,o,"constants have been deprecated as of v8")]:[]}function Nr(a){for(var o=[],u=arguments.length-1;u-- >0;)o[u]=arguments[u+1];for(var v=0,_=o;v<_.length;v+=1){var S=_[v];for(var A in S)a[A]=S[A]}return a}function Xr(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function dr(a){if(Array.isArray(a))return a.map(dr);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){var o={};for(var u in a)o[u]=dr(a[u]);return o}return Xr(a)}var Yr=function(a){function o(u,v){a.call(this,v),this.message=v,this.key=u}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o}(Error),xn=function(o,u){u===void 0&&(u=[]),this.parent=o,this.bindings={};for(var v=0,_=u;v<_.length;v+=1){var S=_[v];this.bindings[S[0]]=S[1]}};xn.prototype.concat=function(a){return new xn(this,a)},xn.prototype.get=function(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(a+" not found in scope.")},xn.prototype.has=function(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)};var Gn={kind:"null"},pr={kind:"number"},jn={kind:"string"},Rn={kind:"boolean"},Nn={kind:"color"},Gi={kind:"object"},Hn={kind:"value"},ha={kind:"collator"},Sa={kind:"formatted"},Ji={kind:"resolvedImage"};function ei(a,o){return{kind:"array",itemType:a,N:o}}function ua(a){if(a.kind==="array"){var o=ua(a.itemType);return typeof a.N=="number"?"array<"+o+", "+a.N+">":a.itemType.kind==="value"?"array":"array<"+o+">"}return a.kind}var Ds=[Gn,pr,jn,Rn,Nn,Sa,Gi,ei(Hn),Ji];function Ca(a,o){if(o.kind==="error")return null;if(a.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!Ca(a.itemType,o.itemType))&&(typeof a.N!="number"||a.N===o.N))return null}else{if(a.kind===o.kind)return null;if(a.kind==="value"){for(var u=0,v=Ds;u<v.length;u+=1)if(!Ca(v[u],o))return null}}return"Expected "+ua(a)+" but found "+ua(o)+" instead."}function zo(a,o){return o.some(function(u){return u.kind===a.kind})}function Ei(a,o){return o.some(function(u){return u==="null"?a===null:u==="array"?Array.isArray(a):u==="object"?a&&!Array.isArray(a)&&typeof a=="object":u===typeof a})}var Qi=V(function(a,o){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function v(R){return(R=Math.round(R))<0?0:R>255?255:R}function _(R){return v(R[R.length-1]==="%"?parseFloat(R)/100*255:parseInt(R))}function S(R){return(z=R[R.length-1]==="%"?parseFloat(R)/100:parseFloat(R))<0?0:z>1?1:z;var z}function A(R,z,W){return W<0?W+=1:W>1&&(W-=1),6*W<1?R+(z-R)*W*6:2*W<1?z:3*W<2?R+(z-R)*(2/3-W)*6:R}try{o.parseCSSColor=function(R){var z,W=R.replace(/ /g,"").toLowerCase();if(W in u)return u[W].slice();if(W[0]==="#")return W.length===4?(z=parseInt(W.substr(1),16))>=0&&z<=4095?[(3840&z)>>4|(3840&z)>>8,240&z|(240&z)>>4,15&z|(15&z)<<4,1]:null:W.length===7&&(z=parseInt(W.substr(1),16))>=0&&z<=16777215?[(16711680&z)>>16,(65280&z)>>8,255&z,1]:null;var q=W.indexOf("("),ne=W.indexOf(")");if(q!==-1&&ne+1===W.length){var ae=W.substr(0,q),Te=W.substr(q+1,ne-(q+1)).split(","),je=1;switch(ae){case"rgba":if(Te.length!==4)return null;je=S(Te.pop());case"rgb":return Te.length!==3?null:[_(Te[0]),_(Te[1]),_(Te[2]),je];case"hsla":if(Te.length!==4)return null;je=S(Te.pop());case"hsl":if(Te.length!==3)return null;var Be=(parseFloat(Te[0])%360+360)%360/360,Je=S(Te[1]),Qe=S(Te[2]),Tt=Qe<=.5?Qe*(Je+1):Qe+Je-Qe*Je,Zt=2*Qe-Tt;return[v(255*A(Zt,Tt,Be+1/3)),v(255*A(Zt,Tt,Be)),v(255*A(Zt,Tt,Be-1/3)),je];default:return null}}return null}}catch(R){}}).parseCSSColor,Bi=function(o,u,v,_){_===void 0&&(_=1),this.r=o,this.g=u,this.b=v,this.a=_};Bi.parse=function(a){if(a){if(a instanceof Bi)return a;if(typeof a=="string"){var o=Qi(a);if(o)return new Bi(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3])}}},Bi.prototype.toString=function(){var a=this.toArray(),o=a[1],u=a[2],v=a[3];return"rgba("+Math.round(a[0])+","+Math.round(o)+","+Math.round(u)+","+v+")"},Bi.prototype.toArray=function(){var a=this.a;return a===0?[0,0,0,0]:[255*this.r/a,255*this.g/a,255*this.b/a,a]},Bi.black=new Bi(0,0,0,1),Bi.white=new Bi(1,1,1,1),Bi.transparent=new Bi(0,0,0,0),Bi.red=new Bi(1,0,0,1);var Uo=function(o,u,v){this.sensitivity=o?u?"variant":"case":u?"accent":"base",this.locale=v,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Uo.prototype.compare=function(a,o){return this.collator.compare(a,o)},Uo.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Ho=function(o,u,v,_,S){this.text=o,this.image=u,this.scale=v,this.fontStack=_,this.textColor=S},so=function(o){this.sections=o};so.fromString=function(a){return new so([new Ho(a,null,null,null,null)])},so.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(a){return a.text.length!==0||a.image&&a.image.name.length!==0})},so.factory=function(a){return a instanceof so?a:so.fromString(a)},so.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(a){return a.text}).join("")},so.prototype.serialize=function(){for(var a=["format"],o=0,u=this.sections;o<u.length;o+=1){var v=u[o];if(v.image)a.push(["image",v.image.name]);else{a.push(v.text);var _={};v.fontStack&&(_["text-font"]=["literal",v.fontStack.split(",")]),v.scale&&(_["font-scale"]=v.scale),v.textColor&&(_["text-color"]=["rgba"].concat(v.textColor.toArray())),a.push(_)}}return a};var Ft=function(o){this.name=o.name,this.available=o.available};function nu(a,o,u,v){return typeof a=="number"&&a>=0&&a<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof u=="number"&&u>=0&&u<=255?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:"Invalid rgba value ["+[a,o,u,v].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof v=="number"?[a,o,u,v]:[a,o,u]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Yt(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Bi||a instanceof Uo||a instanceof so||a instanceof Ft)return!0;if(Array.isArray(a)){for(var o=0,u=a;o<u.length;o+=1)if(!Yt(u[o]))return!1;return!0}if(typeof a=="object"){for(var v in a)if(!Yt(a[v]))return!1;return!0}return!1}function uo(a){if(a===null)return Gn;if(typeof a=="string")return jn;if(typeof a=="boolean")return Rn;if(typeof a=="number")return pr;if(a instanceof Bi)return Nn;if(a instanceof Uo)return ha;if(a instanceof so)return Sa;if(a instanceof Ft)return Ji;if(Array.isArray(a)){for(var o,u=a.length,v=0,_=a;v<_.length;v+=1){var S=uo(_[v]);if(o){if(o===S)continue;o=Hn;break}o=S}return ei(o||Hn,u)}return Gi}function jo(a){var o=typeof a;return a===null?"":o==="string"||o==="number"||o==="boolean"?String(a):a instanceof Bi||a instanceof so||a instanceof Ft?a.toString():JSON.stringify(a)}Ft.prototype.toString=function(){return this.name},Ft.fromString=function(a){return a?new Ft({name:a,available:!1}):null},Ft.prototype.serialize=function(){return["image",this.name]};var vo=function(o,u){this.type=o,this.value=u};vo.parse=function(a,o){if(a.length!==2)return o.error("'literal' expression requires exactly one argument, but found "+(a.length-1)+" instead.");if(!Yt(a[1]))return o.error("invalid value");var u=a[1],v=uo(u),_=o.expectedType;return v.kind!=="array"||v.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(v=_),new vo(v,u)},vo.prototype.evaluate=function(){return this.value},vo.prototype.eachChild=function(){},vo.prototype.outputDefined=function(){return!0},vo.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Bi?["rgba"].concat(this.value.toArray()):this.value instanceof so?this.value.serialize():this.value};var no=function(o){this.name="ExpressionEvaluationError",this.message=o};no.prototype.toJSON=function(){return this.message};var As={string:jn,number:pr,boolean:Rn,object:Gi},qr=function(o,u){this.type=o,this.args=u};qr.parse=function(a,o){if(a.length<2)return o.error("Expected at least one argument.");var u,v=1,_=a[0];if(_==="array"){var S,A;if(a.length>2){var R=a[1];if(typeof R!="string"||!(R in As)||R==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);S=As[R],v++}else S=Hn;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return o.error('The length argument to "array" must be a positive integer literal',2);A=a[2],v++}u=ei(S,A)}else u=As[_];for(var z=[];v<a.length;v++){var W=o.parse(a[v],v,Hn);if(!W)return null;z.push(W)}return new qr(u,z)},qr.prototype.evaluate=function(a){for(var o=0;o<this.args.length;o++){var u=this.args[o].evaluate(a);if(!Ca(this.type,uo(u)))return u;if(o===this.args.length-1)throw new no("Expected value to be of type "+ua(this.type)+", but found "+ua(uo(u))+" instead.")}return null},qr.prototype.eachChild=function(a){this.args.forEach(a)},qr.prototype.outputDefined=function(){return this.args.every(function(a){return a.outputDefined()})},qr.prototype.serialize=function(){var a=this.type,o=[a.kind];if(a.kind==="array"){var u=a.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){o.push(u.kind);var v=a.N;(typeof v=="number"||this.args.length>1)&&o.push(v)}}return o.concat(this.args.map(function(_){return _.serialize()}))};var xs=function(o){this.type=Sa,this.sections=o};xs.parse=function(a,o){if(a.length<2)return o.error("Expected at least one argument.");var u=a[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");for(var v=[],_=!1,S=1;S<=a.length-1;++S){var A=a[S];if(_&&typeof A=="object"&&!Array.isArray(A)){_=!1;var R=null;if(A["font-scale"]&&!(R=o.parse(A["font-scale"],1,pr)))return null;var z=null;if(A["text-font"]&&!(z=o.parse(A["text-font"],1,ei(jn))))return null;var W=null;if(A["text-color"]&&!(W=o.parse(A["text-color"],1,Nn)))return null;var q=v[v.length-1];q.scale=R,q.font=z,q.textColor=W}else{var ne=o.parse(a[S],1,Hn);if(!ne)return null;var ae=ne.type.kind;if(ae!=="string"&&ae!=="value"&&ae!=="null"&&ae!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,v.push({content:ne,scale:null,font:null,textColor:null})}}return new xs(v)},xs.prototype.evaluate=function(a){return new so(this.sections.map(function(o){var u=o.content.evaluate(a);return uo(u)===Ji?new Ho("",u,null,null,null):new Ho(jo(u),null,o.scale?o.scale.evaluate(a):null,o.font?o.font.evaluate(a).join(","):null,o.textColor?o.textColor.evaluate(a):null)}))},xs.prototype.eachChild=function(a){for(var o=0,u=this.sections;o<u.length;o+=1){var v=u[o];a(v.content),v.scale&&a(v.scale),v.font&&a(v.font),v.textColor&&a(v.textColor)}},xs.prototype.outputDefined=function(){return!1},xs.prototype.serialize=function(){for(var a=["format"],o=0,u=this.sections;o<u.length;o+=1){var v=u[o];a.push(v.content.serialize());var _={};v.scale&&(_["font-scale"]=v.scale.serialize()),v.font&&(_["text-font"]=v.font.serialize()),v.textColor&&(_["text-color"]=v.textColor.serialize()),a.push(_)}return a};var hn=function(o){this.type=Ji,this.input=o};hn.parse=function(a,o){if(a.length!==2)return o.error("Expected two arguments.");var u=o.parse(a[1],1,jn);return u?new hn(u):o.error("No image name provided.")},hn.prototype.evaluate=function(a){var o=this.input.evaluate(a),u=Ft.fromString(o);return u&&a.availableImages&&(u.available=a.availableImages.indexOf(o)>-1),u},hn.prototype.eachChild=function(a){a(this.input)},hn.prototype.outputDefined=function(){return!1},hn.prototype.serialize=function(){return["image",this.input.serialize()]};var Ts={"to-boolean":Rn,"to-color":Nn,"to-number":pr,"to-string":jn},wt=function(o,u){this.type=o,this.args=u};wt.parse=function(a,o){if(a.length<2)return o.error("Expected at least one argument.");var u=a[0];if((u==="to-boolean"||u==="to-string")&&a.length!==2)return o.error("Expected one argument.");for(var v=Ts[u],_=[],S=1;S<a.length;S++){var A=o.parse(a[S],S,Hn);if(!A)return null;_.push(A)}return new wt(v,_)},wt.prototype.evaluate=function(a){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(a));if(this.type.kind==="color"){for(var o,u,v=0,_=this.args;v<_.length;v+=1){if(u=null,(o=_[v].evaluate(a))instanceof Bi)return o;if(typeof o=="string"){var S=a.parseColor(o);if(S)return S}else if(Array.isArray(o)&&!(u=o.length<3||o.length>4?"Invalid rbga value "+JSON.stringify(o)+": expected an array containing either three or four numeric values.":nu(o[0],o[1],o[2],o[3])))return new Bi(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new no(u||"Could not parse color from value '"+(typeof o=="string"?o:String(JSON.stringify(o)))+"'")}if(this.type.kind==="number"){for(var A=null,R=0,z=this.args;R<z.length;R+=1){if((A=z[R].evaluate(a))===null)return 0;var W=Number(A);if(!isNaN(W))return W}throw new no("Could not convert "+JSON.stringify(A)+" to number.")}return this.type.kind==="formatted"?so.fromString(jo(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?Ft.fromString(jo(this.args[0].evaluate(a))):jo(this.args[0].evaluate(a))},wt.prototype.eachChild=function(a){this.args.forEach(a)},wt.prototype.outputDefined=function(){return this.args.every(function(a){return a.outputDefined()})},wt.prototype.serialize=function(){if(this.type.kind==="formatted")return new xs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new hn(this.args[0]).serialize();var a=["to-"+this.type.kind];return this.eachChild(function(o){a.push(o.serialize())}),a};var _l=["Unknown","Point","LineString","Polygon"],Us=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Us.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Us.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?_l[this.feature.type]:this.feature.type:null},Us.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Us.prototype.canonicalID=function(){return this.canonical},Us.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Us.prototype.parseColor=function(a){var o=this._parseColorCache[a];return o||(o=this._parseColorCache[a]=Bi.parse(a)),o};var ce=function(o,u,v,_){this.name=o,this.type=u,this._evaluate=v,this.args=_};ce.prototype.evaluate=function(a){return this._evaluate(a,this.args)},ce.prototype.eachChild=function(a){this.args.forEach(a)},ce.prototype.outputDefined=function(){return!1},ce.prototype.serialize=function(){return[this.name].concat(this.args.map(function(a){return a.serialize()}))},ce.parse=function(a,o){var u,v=a[0],_=ce.definitions[v];if(!_)return o.error('Unknown expression "'+v+'". If you wanted a literal array, use ["literal", [...]].',0);for(var S=Array.isArray(_)?_[0]:_.type,A=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,R=A.filter(function(vi){var ti=vi[0];return!Array.isArray(ti)||ti.length===a.length-1}),z=null,W=0,q=R;W<q.length;W+=1){var ne=q[W],ae=ne[0],Te=ne[1];z=new cl(o.registry,o.path,null,o.scope);for(var je=[],Be=!1,Je=1;Je<a.length;Je++){var Qe=a[Je],Tt=Array.isArray(ae)?ae[Je-1]:ae.type,Zt=z.parse(Qe,1+je.length,Tt);if(!Zt){Be=!0;break}je.push(Zt)}if(!Be)if(Array.isArray(ae)&&ae.length!==je.length)z.error("Expected "+ae.length+" arguments, but found "+je.length+" instead.");else{for(var ar=0;ar<je.length;ar++){var Lr=Array.isArray(ae)?ae[ar]:ae.type,xr=je[ar];z.concat(ar+1).checkSubtype(Lr,xr.type)}if(z.errors.length===0)return new ce(v,S,Te,je)}}if(R.length===1)(u=o.errors).push.apply(u,z.errors);else{for(var dn=(R.length?R:A).map(function(vi){var ti;return ti=vi[0],Array.isArray(ti)?"("+ti.map(ua).join(", ")+")":"("+ua(ti.type)+"...)"}).join(" | "),_n=[],ci=1;ci<a.length;ci++){var _i=o.parse(a[ci],1+_n.length);if(!_i)return null;_n.push(ua(_i.type))}o.error("Expected arguments of type "+dn+", but found ("+_n.join(", ")+") instead.")}return null},ce.register=function(a,o){for(var u in ce.definitions=o,o)a[u]=ce};var Tu=function(o,u,v){this.type=ha,this.locale=v,this.caseSensitive=o,this.diacriticSensitive=u};function ls(a,o){a[0]=Math.min(a[0],o[0]),a[1]=Math.min(a[1],o[1]),a[2]=Math.max(a[2],o[0]),a[3]=Math.max(a[3],o[1])}function $o(a,o){return!(a[0]<=o[0]||a[2]>=o[2]||a[1]<=o[1]||a[3]>=o[3])}function Ke(a,o){var u=(180+a[0])/360,v=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,_=Math.pow(2,o.z);return[Math.round(u*_*8192),Math.round(v*_*8192)]}function me(a,o,u){return o[1]>a[1]!=u[1]>a[1]&&a[0]<(u[0]-o[0])*(a[1]-o[1])/(u[1]-o[1])+o[0]}function Xe(a,o){for(var u,v,_,S,A,R,z,W=!1,q=0,ne=o.length;q<ne;q++)for(var ae=o[q],Te=0,je=ae.length;Te<je-1;Te++){if((S=(u=a)[0]-(v=ae[Te])[0])*(z=u[1]-(_=ae[Te+1])[1])-(R=u[0]-_[0])*(A=u[1]-v[1])==0&&S*R<=0&&A*z<=0)return!1;me(a,ae[Te],ae[Te+1])&&(W=!W)}return W}function Ht(a,o){for(var u=0;u<o.length;u++)if(Xe(a,o[u]))return!0;return!1}function rn(a,o,u,v){var _=v[0]-u[0],S=v[1]-u[1],A=(a[0]-u[0])*S-_*(a[1]-u[1]),R=(o[0]-u[0])*S-_*(o[1]-u[1]);return A>0&&R<0||A<0&&R>0}function Yn(a,o,u){for(var v=0,_=u;v<_.length;v+=1)for(var S=_[v],A=0;A<S.length-1;++A)if((ne=[(q=S[A+1])[0]-(W=S[A])[0],q[1]-W[1]])[0]*(ae=[(z=o)[0]-(R=a)[0],z[1]-R[1]])[1]-ne[1]*ae[0]!=0&&rn(R,z,W,q)&&rn(W,q,R,z))return!0;var R,z,W,q,ne,ae;return!1}function la(a,o){for(var u=0;u<a.length;++u)if(!Xe(a[u],o))return!1;for(var v=0;v<a.length-1;++v)if(Yn(a[v],a[v+1],o))return!1;return!0}function mo(a,o){for(var u=0;u<o.length;u++)if(la(a,o[u]))return!0;return!1}function lo(a,o,u){for(var v=[],_=0;_<a.length;_++){for(var S=[],A=0;A<a[_].length;A++){var R=Ke(a[_][A],u);ls(o,R),S.push(R)}v.push(S)}return v}function bo(a,o,u){for(var v=[],_=0;_<a.length;_++){var S=lo(a[_],o,u);v.push(S)}return v}function qo(a,o,u,v){if(a[0]<u[0]||a[0]>u[2]){var _=.5*v,S=a[0]-u[0]>_?-v:u[0]-a[0]>_?v:0;S===0&&(S=a[0]-u[2]>_?-v:u[2]-a[0]>_?v:0),a[0]+=S}ls(o,a)}function yc(a,o,u,v){for(var _=8192*Math.pow(2,v.z),S=[8192*v.x,8192*v.y],A=[],R=0,z=a;R<z.length;R+=1)for(var W=0,q=z[R];W<q.length;W+=1){var ne=q[W],ae=[ne.x+S[0],ne.y+S[1]];qo(ae,o,u,_),A.push(ae)}return A}function gu(a,o,u,v){for(var _,S=8192*Math.pow(2,v.z),A=[8192*v.x,8192*v.y],R=[],z=0,W=a;z<W.length;z+=1){for(var q=[],ne=0,ae=W[z];ne<ae.length;ne+=1){var Te=ae[ne],je=[Te.x+A[0],Te.y+A[1]];ls(o,je),q.push(je)}R.push(q)}if(o[2]-o[0]<=S/2){(_=o)[0]=_[1]=1/0,_[2]=_[3]=-1/0;for(var Be=0,Je=R;Be<Je.length;Be+=1)for(var Qe=0,Tt=Je[Be];Qe<Tt.length;Qe+=1)qo(Tt[Qe],o,u,S)}return R}Tu.parse=function(a,o){if(a.length!==2)return o.error("Expected one argument.");var u=a[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");var v=o.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,Rn);if(!v)return null;var _=o.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,Rn);if(!_)return null;var S=null;return u.locale&&!(S=o.parse(u.locale,1,jn))?null:new Tu(v,_,S)},Tu.prototype.evaluate=function(a){return new Uo(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)},Tu.prototype.eachChild=function(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)},Tu.prototype.outputDefined=function(){return!1},Tu.prototype.serialize=function(){var a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]};var cs=function(o,u){this.type=Rn,this.geojson=o,this.geometries=u};function iu(a){if(a instanceof ce&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof cs)return!1;var o=!0;return a.eachChild(function(u){o&&!iu(u)&&(o=!1)}),o}function Mu(a){if(a instanceof ce&&a.name==="feature-state")return!1;var o=!0;return a.eachChild(function(u){o&&!Mu(u)&&(o=!1)}),o}function au(a,o){if(a instanceof ce&&o.indexOf(a.name)>=0)return!1;var u=!0;return a.eachChild(function(v){u&&!au(v,o)&&(u=!1)}),u}cs.parse=function(a,o){if(a.length!==2)return o.error("'within' expression requires exactly one argument, but found "+(a.length-1)+" instead.");if(Yt(a[1])){var u=a[1];if(u.type==="FeatureCollection")for(var v=0;v<u.features.length;++v){var _=u.features[v].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new cs(u,u.features[v].geometry)}else if(u.type==="Feature"){var S=u.geometry.type;if(S==="Polygon"||S==="MultiPolygon")return new cs(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new cs(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")},cs.prototype.evaluate=function(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(o,u){var v=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],S=o.canonicalID();if(u.type==="Polygon"){var A=lo(u.coordinates,_,S),R=yc(o.geometry(),v,_,S);if(!$o(v,_))return!1;for(var z=0,W=R;z<W.length;z+=1)if(!Xe(W[z],A))return!1}if(u.type==="MultiPolygon"){var q=bo(u.coordinates,_,S),ne=yc(o.geometry(),v,_,S);if(!$o(v,_))return!1;for(var ae=0,Te=ne;ae<Te.length;ae+=1)if(!Ht(Te[ae],q))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(o,u){var v=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],S=o.canonicalID();if(u.type==="Polygon"){var A=lo(u.coordinates,_,S),R=gu(o.geometry(),v,_,S);if(!$o(v,_))return!1;for(var z=0,W=R;z<W.length;z+=1)if(!la(W[z],A))return!1}if(u.type==="MultiPolygon"){var q=bo(u.coordinates,_,S),ne=gu(o.geometry(),v,_,S);if(!$o(v,_))return!1;for(var ae=0,Te=ne;ae<Te.length;ae+=1)if(!mo(Te[ae],q))return!1}return!0}(a,this.geometries)}return!1},cs.prototype.eachChild=function(){},cs.prototype.outputDefined=function(){return!0},cs.prototype.serialize=function(){return["within",this.geojson]};var js=function(o,u){this.type=u.type,this.name=o,this.boundExpression=u};js.parse=function(a,o){if(a.length!==2||typeof a[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");var u=a[1];return o.scope.has(u)?new js(u,o.scope.get(u)):o.error('Unknown variable "'+u+'". Make sure "'+u+'" has been bound in an enclosing "let" expression before using it.',1)},js.prototype.evaluate=function(a){return this.boundExpression.evaluate(a)},js.prototype.eachChild=function(){},js.prototype.outputDefined=function(){return!1},js.prototype.serialize=function(){return["var",this.name]};var cl=function(o,u,v,_,S){u===void 0&&(u=[]),_===void 0&&(_=new xn),S===void 0&&(S=[]),this.registry=o,this.path=u,this.key=u.map(function(A){return"["+A+"]"}).join(""),this.scope=_,this.errors=S,this.expectedType=v};function Pu(a,o){for(var u,v=a.length-1,_=0,S=v,A=0;_<=S;)if((u=a[A=Math.floor((_+S)/2)])<=o){if(A===v||o<a[A+1])return A;_=A+1}else{if(!(u>o))throw new no("Input is not a number.");S=A-1}return 0}cl.prototype.parse=function(a,o,u,v,_){return _===void 0&&(_={}),o?this.concat(o,u,v)._parse(a,_):this._parse(a,_)},cl.prototype._parse=function(a,o){function u(W,q,ne){return ne==="assert"?new qr(q,[W]):ne==="coerce"?new wt(q,[W]):W}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var v=a[0];if(typeof v!="string")return this.error("Expression name must be a string, but found "+typeof v+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var _=this.registry[v];if(_){var S=_.parse(a,this);if(!S)return null;if(this.expectedType){var A=this.expectedType,R=S.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||R.kind!=="value")if(A.kind!=="color"&&A.kind!=="formatted"&&A.kind!=="resolvedImage"||R.kind!=="value"&&R.kind!=="string"){if(this.checkSubtype(A,R))return null}else S=u(S,A,o.typeAnnotation||"coerce");else S=u(S,A,o.typeAnnotation||"assert")}if(!(S instanceof vo)&&S.type.kind!=="resolvedImage"&&function W(q){if(q instanceof js)return W(q.boundExpression);if(q instanceof ce&&q.name==="error"||q instanceof Tu||q instanceof cs)return!1;var ne=q instanceof wt||q instanceof qr,ae=!0;return q.eachChild(function(Te){ae=ne?ae&&W(Te):ae&&Te instanceof vo}),!!ae&&iu(q)&&au(q,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(S)){var z=new Us;try{S=new vo(S.type,S.evaluate(z))}catch(W){return this.error(W.message),null}}return S}return this.error('Unknown expression "'+v+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof a+" instead.")},cl.prototype.concat=function(a,o,u){var v=typeof a=="number"?this.path.concat(a):this.path,_=u?this.scope.concat(u):this.scope;return new cl(this.registry,v,o||null,_,this.errors)},cl.prototype.error=function(a){for(var o=[],u=arguments.length-1;u-- >0;)o[u]=arguments[u+1];var v=""+this.key+o.map(function(_){return"["+_+"]"}).join("");this.errors.push(new Yr(v,a))},cl.prototype.checkSubtype=function(a,o){var u=Ca(a,o);return u&&this.error(u),u};var co=function(o,u,v){this.type=o,this.input=u,this.labels=[],this.outputs=[];for(var _=0,S=v;_<S.length;_+=1){var A=S[_],R=A[1];this.labels.push(A[0]),this.outputs.push(R)}};function Po(a,o,u){return a*(1-u)+o*u}co.parse=function(a,o){if(a.length-1<4)return o.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if((a.length-1)%2!=0)return o.error("Expected an even number of arguments.");var u=o.parse(a[1],1,pr);if(!u)return null;var v=[],_=null;o.expectedType&&o.expectedType.kind!=="value"&&(_=o.expectedType);for(var S=1;S<a.length;S+=2){var A=S===1?-1/0:a[S],R=a[S+1],z=S,W=S+1;if(typeof A!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(v.length&&v[v.length-1][0]>=A)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);var q=o.parse(R,W,_);if(!q)return null;_=_||q.type,v.push([A,q])}return new co(_,u,v)},co.prototype.evaluate=function(a){var o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(a);var v=this.input.evaluate(a);if(v<=o[0])return u[0].evaluate(a);var _=o.length;return v>=o[_-1]?u[_-1].evaluate(a):u[Pu(o,v)].evaluate(a)},co.prototype.eachChild=function(a){a(this.input);for(var o=0,u=this.outputs;o<u.length;o+=1)a(u[o])},co.prototype.outputDefined=function(){return this.outputs.every(function(a){return a.outputDefined()})},co.prototype.serialize=function(){for(var a=["step",this.input.serialize()],o=0;o<this.labels.length;o++)o>0&&a.push(this.labels[o]),a.push(this.outputs[o].serialize());return a};var Ha=Object.freeze({__proto__:null,number:Po,color:function(o,u,v){return new Bi(Po(o.r,u.r,v),Po(o.g,u.g,v),Po(o.b,u.b,v),Po(o.a,u.a,v))},array:function(o,u,v){return o.map(function(_,S){return Po(_,u[S],v)})}}),Wa=6/29*3*(6/29),Yh=Math.PI/180,Bc=180/Math.PI;function Nc(a){return a>.008856451679035631?Math.pow(a,1/3):a/Wa+4/29}function xl(a){return a>6/29?a*a*a:Wa*(a-4/29)}function bl(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function b(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function L(a){var o=b(a.r),u=b(a.g),v=b(a.b),_=Nc((.4124564*o+.3575761*u+.1804375*v)/.95047),S=Nc((.2126729*o+.7151522*u+.072175*v)/1);return{l:116*S-16,a:500*(_-S),b:200*(S-Nc((.0193339*o+.119192*u+.9503041*v)/1.08883)),alpha:a.a}}function X(a){var o=(a.l+16)/116,u=isNaN(a.a)?o:o+a.a/500,v=isNaN(a.b)?o:o-a.b/200;return o=1*xl(o),u=.95047*xl(u),v=1.08883*xl(v),new Bi(bl(3.2404542*u-1.5371385*o-.4985314*v),bl(-.969266*u+1.8760108*o+.041556*v),bl(.0556434*u-.2040259*o+1.0572252*v),a.alpha)}function B(a,o,u){var v=o-a;return a+u*(v>180||v<-180?v-360*Math.round(v/360):v)}var se={forward:L,reverse:X,interpolate:function(o,u,v){return{l:Po(o.l,u.l,v),a:Po(o.a,u.a,v),b:Po(o.b,u.b,v),alpha:Po(o.alpha,u.alpha,v)}}},Le={forward:function(o){var u=L(o),v=u.l,_=u.a,S=u.b,A=Math.atan2(S,_)*Bc;return{h:A<0?A+360:A,c:Math.sqrt(_*_+S*S),l:v,alpha:o.a}},reverse:function(o){var u=o.h*Yh,v=o.c;return X({l:o.l,a:Math.cos(u)*v,b:Math.sin(u)*v,alpha:o.alpha})},interpolate:function(o,u,v){return{h:B(o.h,u.h,v),c:Po(o.c,u.c,v),l:Po(o.l,u.l,v),alpha:Po(o.alpha,u.alpha,v)}}},ot=Object.freeze({__proto__:null,lab:se,hcl:Le}),Et=function(o,u,v,_,S){this.type=o,this.operator=u,this.interpolation=v,this.input=_,this.labels=[],this.outputs=[];for(var A=0,R=S;A<R.length;A+=1){var z=R[A],W=z[1];this.labels.push(z[0]),this.outputs.push(W)}};function Pt(a,o,u,v){var _=v-u,S=a-u;return _===0?0:o===1?S/_:(Math.pow(o,S)-1)/(Math.pow(o,_)-1)}Et.interpolationFactor=function(a,o,u,v){var _=0;if(a.name==="exponential")_=Pt(o,a.base,u,v);else if(a.name==="linear")_=Pt(o,1,u,v);else if(a.name==="cubic-bezier"){var S=a.controlPoints;_=new H(S[0],S[1],S[2],S[3]).solve(Pt(o,1,u,v))}return _},Et.parse=function(a,o){var u=a[0],v=a[1],_=a[2],S=a.slice(3);if(!Array.isArray(v)||v.length===0)return o.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){var A=v[1];if(typeof A!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:A}}else{if(v[0]!=="cubic-bezier")return o.error("Unknown interpolation type "+String(v[0]),1,0);var R=v.slice(1);if(R.length!==4||R.some(function(Je){return typeof Je!="number"||Je<0||Je>1}))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:R}}if(a.length-1<4)return o.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if((a.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(!(_=o.parse(_,2,pr)))return null;var z=[],W=null;u==="interpolate-hcl"||u==="interpolate-lab"?W=Nn:o.expectedType&&o.expectedType.kind!=="value"&&(W=o.expectedType);for(var q=0;q<S.length;q+=2){var ne=S[q],ae=S[q+1],Te=q+3,je=q+4;if(typeof ne!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Te);if(z.length&&z[z.length-1][0]>=ne)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Te);var Be=o.parse(ae,je,W);if(!Be)return null;W=W||Be.type,z.push([ne,Be])}return W.kind==="number"||W.kind==="color"||W.kind==="array"&&W.itemType.kind==="number"&&typeof W.N=="number"?new Et(W,u,v,_,z):o.error("Type "+ua(W)+" is not interpolatable.")},Et.prototype.evaluate=function(a){var o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(a);var v=this.input.evaluate(a);if(v<=o[0])return u[0].evaluate(a);var _=o.length;if(v>=o[_-1])return u[_-1].evaluate(a);var S=Pu(o,v),A=Et.interpolationFactor(this.interpolation,v,o[S],o[S+1]),R=u[S].evaluate(a),z=u[S+1].evaluate(a);return this.operator==="interpolate"?Ha[this.type.kind.toLowerCase()](R,z,A):this.operator==="interpolate-hcl"?Le.reverse(Le.interpolate(Le.forward(R),Le.forward(z),A)):se.reverse(se.interpolate(se.forward(R),se.forward(z),A))},Et.prototype.eachChild=function(a){a(this.input);for(var o=0,u=this.outputs;o<u.length;o+=1)a(u[o])},Et.prototype.outputDefined=function(){return this.outputs.every(function(a){return a.outputDefined()})},Et.prototype.serialize=function(){var a;a=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var o=[this.operator,a,this.input.serialize()],u=0;u<this.labels.length;u++)o.push(this.labels[u],this.outputs[u].serialize());return o};var zr=function(o,u){this.type=o,this.args=u};zr.parse=function(a,o){if(a.length<2)return o.error("Expectected at least one argument.");var u=null,v=o.expectedType;v&&v.kind!=="value"&&(u=v);for(var _=[],S=0,A=a.slice(1);S<A.length;S+=1){var R=o.parse(A[S],1+_.length,u,void 0,{typeAnnotation:"omit"});if(!R)return null;u=u||R.type,_.push(R)}var z=v&&_.some(function(W){return Ca(v,W.type)});return new zr(z?Hn:u,_)},zr.prototype.evaluate=function(a){for(var o,u=null,v=0,_=0,S=this.args;_<S.length&&(v++,(u=S[_].evaluate(a))&&u instanceof Ft&&!u.available&&(o||(o=u.name),u=null,v===this.args.length&&(u=o)),u===null);_+=1);return u},zr.prototype.eachChild=function(a){this.args.forEach(a)},zr.prototype.outputDefined=function(){return this.args.every(function(a){return a.outputDefined()})},zr.prototype.serialize=function(){var a=["coalesce"];return this.eachChild(function(o){a.push(o.serialize())}),a};var Kr=function(o,u){this.type=u.type,this.bindings=[].concat(o),this.result=u};Kr.prototype.evaluate=function(a){return this.result.evaluate(a)},Kr.prototype.eachChild=function(a){for(var o=0,u=this.bindings;o<u.length;o+=1)a(u[o][1]);a(this.result)},Kr.parse=function(a,o){if(a.length<4)return o.error("Expected at least 3 arguments, but found "+(a.length-1)+" instead.");for(var u=[],v=1;v<a.length-1;v+=2){var _=a[v];if(typeof _!="string")return o.error("Expected string, but found "+typeof _+" instead.",v);if(/[^a-zA-Z0-9_]/.test(_))return o.error("Variable names must contain only alphanumeric characters or '_'.",v);var S=o.parse(a[v+1],v+1);if(!S)return null;u.push([_,S])}var A=o.parse(a[a.length-1],a.length-1,o.expectedType,u);return A?new Kr(u,A):null},Kr.prototype.outputDefined=function(){return this.result.outputDefined()},Kr.prototype.serialize=function(){for(var a=["let"],o=0,u=this.bindings;o<u.length;o+=1){var v=u[o];a.push(v[0],v[1].serialize())}return a.push(this.result.serialize()),a};var oi=function(o,u,v){this.type=o,this.index=u,this.input=v};oi.parse=function(a,o){if(a.length!==3)return o.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var u=o.parse(a[1],1,pr),v=o.parse(a[2],2,ei(o.expectedType||Hn));return u&&v?new oi(v.type.itemType,u,v):null},oi.prototype.evaluate=function(a){var o=this.index.evaluate(a),u=this.input.evaluate(a);if(o<0)throw new no("Array index out of bounds: "+o+" < 0.");if(o>=u.length)throw new no("Array index out of bounds: "+o+" > "+(u.length-1)+".");if(o!==Math.floor(o))throw new no("Array index must be an integer, but found "+o+" instead.");return u[o]},oi.prototype.eachChild=function(a){a(this.index),a(this.input)},oi.prototype.outputDefined=function(){return!1},oi.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ki=function(o,u){this.type=Rn,this.needle=o,this.haystack=u};Ki.parse=function(a,o){if(a.length!==3)return o.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var u=o.parse(a[1],1,Hn),v=o.parse(a[2],2,Hn);return u&&v?zo(u.type,[Rn,jn,pr,Gn,Hn])?new Ki(u,v):o.error("Expected first argument to be of type boolean, string, number or null, but found "+ua(u.type)+" instead"):null},Ki.prototype.evaluate=function(a){var o=this.needle.evaluate(a),u=this.haystack.evaluate(a);if(!u)return!1;if(!Ei(o,["boolean","string","number","null"]))throw new no("Expected first argument to be of type boolean, string, number or null, but found "+ua(uo(o))+" instead.");if(!Ei(u,["string","array"]))throw new no("Expected second argument to be of type array or string, but found "+ua(uo(u))+" instead.");return u.indexOf(o)>=0},Ki.prototype.eachChild=function(a){a(this.needle),a(this.haystack)},Ki.prototype.outputDefined=function(){return!0},Ki.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Li=function(o,u,v){this.type=pr,this.needle=o,this.haystack=u,this.fromIndex=v};Li.parse=function(a,o){if(a.length<=2||a.length>=5)return o.error("Expected 3 or 4 arguments, but found "+(a.length-1)+" instead.");var u=o.parse(a[1],1,Hn),v=o.parse(a[2],2,Hn);if(!u||!v)return null;if(!zo(u.type,[Rn,jn,pr,Gn,Hn]))return o.error("Expected first argument to be of type boolean, string, number or null, but found "+ua(u.type)+" instead");if(a.length===4){var _=o.parse(a[3],3,pr);return _?new Li(u,v,_):null}return new Li(u,v)},Li.prototype.evaluate=function(a){var o=this.needle.evaluate(a),u=this.haystack.evaluate(a);if(!Ei(o,["boolean","string","number","null"]))throw new no("Expected first argument to be of type boolean, string, number or null, but found "+ua(uo(o))+" instead.");if(!Ei(u,["string","array"]))throw new no("Expected second argument to be of type array or string, but found "+ua(uo(u))+" instead.");if(this.fromIndex){var v=this.fromIndex.evaluate(a);return u.indexOf(o,v)}return u.indexOf(o)},Li.prototype.eachChild=function(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)},Li.prototype.outputDefined=function(){return!1},Li.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Oa=function(o,u,v,_,S,A){this.inputType=o,this.type=u,this.input=v,this.cases=_,this.outputs=S,this.otherwise=A};Oa.parse=function(a,o){if(a.length<5)return o.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if(a.length%2!=1)return o.error("Expected an even number of arguments.");var u,v;o.expectedType&&o.expectedType.kind!=="value"&&(v=o.expectedType);for(var _={},S=[],A=2;A<a.length-1;A+=2){var R=a[A],z=a[A+1];Array.isArray(R)||(R=[R]);var W=o.concat(A);if(R.length===0)return W.error("Expected at least one branch label.");for(var q=0,ne=R;q<ne.length;q+=1){var ae=ne[q];if(typeof ae!="number"&&typeof ae!="string")return W.error("Branch labels must be numbers or strings.");if(typeof ae=="number"&&Math.abs(ae)>Number.MAX_SAFE_INTEGER)return W.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof ae=="number"&&Math.floor(ae)!==ae)return W.error("Numeric branch labels must be integer values.");if(u){if(W.checkSubtype(u,uo(ae)))return null}else u=uo(ae);if(_[String(ae)]!==void 0)return W.error("Branch labels must be unique.");_[String(ae)]=S.length}var Te=o.parse(z,A,v);if(!Te)return null;v=v||Te.type,S.push(Te)}var je=o.parse(a[1],1,Hn);if(!je)return null;var Be=o.parse(a[a.length-1],a.length-1,v);return Be?je.type.kind!=="value"&&o.concat(1).checkSubtype(u,je.type)?null:new Oa(u,v,je,_,S,Be):null},Oa.prototype.evaluate=function(a){var o=this.input.evaluate(a);return(uo(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(a)},Oa.prototype.eachChild=function(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)},Oa.prototype.outputDefined=function(){return this.outputs.every(function(a){return a.outputDefined()})&&this.otherwise.outputDefined()},Oa.prototype.serialize=function(){for(var a=this,o=["match",this.input.serialize()],u=[],v={},_=0,S=Object.keys(this.cases).sort();_<S.length;_+=1){var A=S[_];(ne=v[this.cases[A]])===void 0?(v[this.cases[A]]=u.length,u.push([this.cases[A],[A]])):u[ne][1].push(A)}for(var R=function(je){return a.inputType.kind==="number"?Number(je):je},z=0,W=u;z<W.length;z+=1){var q=W[z],ne=q[0],ae=q[1];o.push(ae.length===1?R(ae[0]):ae.map(R)),o.push(this.outputs[outputIndex$1].serialize())}return o.push(this.otherwise.serialize()),o};var sa=function(o,u,v){this.type=o,this.branches=u,this.otherwise=v};sa.parse=function(a,o){if(a.length<4)return o.error("Expected at least 3 arguments, but found only "+(a.length-1)+".");if(a.length%2!=0)return o.error("Expected an odd number of arguments.");var u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);for(var v=[],_=1;_<a.length-1;_+=2){var S=o.parse(a[_],_,Rn);if(!S)return null;var A=o.parse(a[_+1],_+1,u);if(!A)return null;v.push([S,A]),u=u||A.type}var R=o.parse(a[a.length-1],a.length-1,u);return R?new sa(u,v,R):null},sa.prototype.evaluate=function(a){for(var o=0,u=this.branches;o<u.length;o+=1){var v=u[o],_=v[1];if(v[0].evaluate(a))return _.evaluate(a)}return this.otherwise.evaluate(a)},sa.prototype.eachChild=function(a){for(var o=0,u=this.branches;o<u.length;o+=1){var v=u[o],_=v[1];a(v[0]),a(_)}a(this.otherwise)},sa.prototype.outputDefined=function(){return this.branches.every(function(a){return a[1].outputDefined()})&&this.otherwise.outputDefined()},sa.prototype.serialize=function(){var a=["case"];return this.eachChild(function(o){a.push(o.serialize())}),a};var Va=function(o,u,v,_){this.type=o,this.input=u,this.beginIndex=v,this.endIndex=_};function Qo(a,o){return a==="=="||a==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function yu(a,o,u,v){return v.compare(o,u)===0}function Ma(a,o,u){var v=a!=="=="&&a!=="!=";return function(){function _(S,A,R){this.type=Rn,this.lhs=S,this.rhs=A,this.collator=R,this.hasUntypedArgument=S.type.kind==="value"||A.type.kind==="value"}return _.parse=function(S,A){if(S.length!==3&&S.length!==4)return A.error("Expected two or three arguments.");var R=S[0],z=A.parse(S[1],1,Hn);if(!z)return null;if(!Qo(R,z.type))return A.concat(1).error('"'+R+`" comparisons are not supported for type '`+ua(z.type)+"'.");var W=A.parse(S[2],2,Hn);if(!W)return null;if(!Qo(R,W.type))return A.concat(2).error('"'+R+`" comparisons are not supported for type '`+ua(W.type)+"'.");if(z.type.kind!==W.type.kind&&z.type.kind!=="value"&&W.type.kind!=="value")return A.error("Cannot compare types '"+ua(z.type)+"' and '"+ua(W.type)+"'.");v&&(z.type.kind==="value"&&W.type.kind!=="value"?z=new qr(W.type,[z]):z.type.kind!=="value"&&W.type.kind==="value"&&(W=new qr(z.type,[W])));var q=null;if(S.length===4){if(z.type.kind!=="string"&&W.type.kind!=="string"&&z.type.kind!=="value"&&W.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(!(q=A.parse(S[3],3,ha)))return null}return new _(z,W,q)},_.prototype.evaluate=function(S){var A=this.lhs.evaluate(S),R=this.rhs.evaluate(S);if(v&&this.hasUntypedArgument){var z=uo(A),W=uo(R);if(z.kind!==W.kind||z.kind!=="string"&&z.kind!=="number")throw new no('Expected arguments for "'+a+'" to be (string, string) or (number, number), but found ('+z.kind+", "+W.kind+") instead.")}if(this.collator&&!v&&this.hasUntypedArgument){var q=uo(A),ne=uo(R);if(q.kind!=="string"||ne.kind!=="string")return o(S,A,R)}return this.collator?u(S,A,R,this.collator.evaluate(S)):o(S,A,R)},_.prototype.eachChild=function(S){S(this.lhs),S(this.rhs),this.collator&&S(this.collator)},_.prototype.outputDefined=function(){return!0},_.prototype.serialize=function(){var S=[a];return this.eachChild(function(A){S.push(A.serialize())}),S},_}()}Va.parse=function(a,o){if(a.length<=2||a.length>=5)return o.error("Expected 3 or 4 arguments, but found "+(a.length-1)+" instead.");var u=o.parse(a[1],1,Hn),v=o.parse(a[2],2,pr);if(!u||!v)return null;if(!zo(u.type,[ei(Hn),jn,Hn]))return o.error("Expected first argument to be of type array or string, but found "+ua(u.type)+" instead");if(a.length===4){var _=o.parse(a[3],3,pr);return _?new Va(u.type,u,v,_):null}return new Va(u.type,u,v)},Va.prototype.evaluate=function(a){var o=this.input.evaluate(a),u=this.beginIndex.evaluate(a);if(!Ei(o,["string","array"]))throw new no("Expected first argument to be of type array or string, but found "+ua(uo(o))+" instead.");if(this.endIndex){var v=this.endIndex.evaluate(a);return o.slice(u,v)}return o.slice(u)},Va.prototype.eachChild=function(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)},Va.prototype.outputDefined=function(){return!1},Va.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Jo=Ma("==",function(a,o,u){return o===u},yu),_c=Ma("!=",function(a,o,u){return o!==u},function(a,o,u,v){return!yu(0,o,u,v)}),tc=Ma("<",function(a,o,u){return o<u},function(a,o,u,v){return v.compare(o,u)<0}),Eo=Ma(">",function(a,o,u){return o>u},function(a,o,u,v){return v.compare(o,u)>0}),El=Ma("<=",function(a,o,u){return o<=u},function(a,o,u,v){return v.compare(o,u)<=0}),wf=Ma(">=",function(a,o,u){return o>=u},function(a,o,u,v){return v.compare(o,u)>=0}),Sl=function(o,u,v,_,S){this.type=jn,this.number=o,this.locale=u,this.currency=v,this.minFractionDigits=_,this.maxFractionDigits=S};Sl.parse=function(a,o){if(a.length!==3)return o.error("Expected two arguments.");var u=o.parse(a[1],1,pr);if(!u)return null;var v=a[2];if(typeof v!="object"||Array.isArray(v))return o.error("NumberFormat options argument must be an object.");var _=null;if(v.locale&&!(_=o.parse(v.locale,1,jn)))return null;var S=null;if(v.currency&&!(S=o.parse(v.currency,1,jn)))return null;var A=null;if(v["min-fraction-digits"]&&!(A=o.parse(v["min-fraction-digits"],1,pr)))return null;var R=null;return v["max-fraction-digits"]&&!(R=o.parse(v["max-fraction-digits"],1,pr))?null:new Sl(u,_,S,A,R)},Sl.prototype.evaluate=function(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))},Sl.prototype.eachChild=function(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)},Sl.prototype.outputDefined=function(){return!1},Sl.prototype.serialize=function(){var a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]};var xa=function(o){this.type=pr,this.input=o};xa.parse=function(a,o){if(a.length!==2)return o.error("Expected 1 argument, but found "+(a.length-1)+" instead.");var u=o.parse(a[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error("Expected argument of type string or array, but found "+ua(u.type)+" instead."):new xa(u):null},xa.prototype.evaluate=function(a){var o=this.input.evaluate(a);if(typeof o=="string"||Array.isArray(o))return o.length;throw new no("Expected value to be of type string or array, but found "+ua(uo(o))+" instead.")},xa.prototype.eachChild=function(a){a(this.input)},xa.prototype.outputDefined=function(){return!1},xa.prototype.serialize=function(){var a=["length"];return this.eachChild(function(o){a.push(o.serialize())}),a};var Fl={"==":Jo,"!=":_c,">":Eo,"<":tc,">=":wf,"<=":El,array:qr,at:oi,boolean:qr,case:sa,coalesce:zr,collator:Tu,format:xs,image:hn,in:Ki,"index-of":Li,interpolate:Et,"interpolate-hcl":Et,"interpolate-lab":Et,length:xa,let:Kr,literal:vo,match:Oa,number:qr,"number-format":Sl,object:qr,slice:Va,step:co,string:qr,"to-boolean":wt,"to-color":wt,"to-number":wt,"to-string":wt,var:js,within:cs};function Ah(a,o){var u=o[0],v=o[1],_=o[2],S=o[3];u=u.evaluate(a),v=v.evaluate(a),_=_.evaluate(a);var A=S?S.evaluate(a):1,R=nu(u,v,_,A);if(R)throw new no(R);return new Bi(u/255*A,v/255*A,_/255*A,A)}function fs(a,o){return a in o}function Af(a,o){var u=o[a];return u===void 0?null:u}function tl(a){return{type:a}}function fl(a){return{result:"success",value:a}}function xc(a){return{result:"error",value:a}}function Bl(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function zc(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Nl(a){return!!a.expression&&a.expression.interpolated}function fo(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function nf(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function Ap(a){return a}function Uc(a,o,u){return a!==void 0?a:o!==void 0?o:u!==void 0?u:void 0}function Th(a,o,u,v,_){return Uc(typeof u===_?v[u]:void 0,a.default,o.default)}function Kp(a,o,u){if(fo(u)!=="number")return Uc(a.default,o.default);var v=a.stops.length;if(v===1||u<=a.stops[0][0])return a.stops[0][1];if(u>=a.stops[v-1][0])return a.stops[v-1][1];var _=Pu(a.stops.map(function(S){return S[0]}),u);return a.stops[_][1]}function Kh(a,o,u){var v=a.base!==void 0?a.base:1;if(fo(u)!=="number")return Uc(a.default,o.default);var _=a.stops.length;if(_===1||u<=a.stops[0][0])return a.stops[0][1];if(u>=a.stops[_-1][0])return a.stops[_-1][1];var S=Pu(a.stops.map(function(ne){return ne[0]}),u),A=function(ne,ae,Te,je){var Be=je-Te,Je=ne-Te;return Be===0?0:ae===1?Je/Be:(Math.pow(ae,Je)-1)/(Math.pow(ae,Be)-1)}(u,v,a.stops[S][0],a.stops[S+1][0]),R=a.stops[S][1],z=a.stops[S+1][1],W=Ha[o.type]||Ap;if(a.colorSpace&&a.colorSpace!=="rgb"){var q=ot[a.colorSpace];W=function(ae,Te){return q.reverse(q.interpolate(q.forward(ae),q.forward(Te),A))}}return typeof R.evaluate=="function"?{evaluate:function(){for(var ae=[],Te=arguments.length;Te--;)ae[Te]=arguments[Te];var je=R.evaluate.apply(void 0,ae),Be=z.evaluate.apply(void 0,ae);if(je!==void 0&&Be!==void 0)return W(je,Be,A)}}:W(R,z,A)}function ou(a,o,u){return o.type==="color"?u=Bi.parse(u):o.type==="formatted"?u=so.fromString(u.toString()):o.type==="resolvedImage"?u=Ft.fromString(u.toString()):fo(u)===o.type||o.type==="enum"&&o.values[u]||(u=void 0),Uc(u,a.default,o.default)}ce.register(Fl,{error:[{kind:"error"},[jn],function(a,o){throw new no(o[0].evaluate(a))}],typeof:[jn,[Hn],function(a,o){return ua(uo(o[0].evaluate(a)))}],"to-rgba":[ei(pr,4),[Nn],function(a,o){return o[0].evaluate(a).toArray()}],rgb:[Nn,[pr,pr,pr],Ah],rgba:[Nn,[pr,pr,pr,pr],Ah],has:{type:Rn,overloads:[[[jn],function(a,o){return fs(o[0].evaluate(a),a.properties())}],[[jn,Gi],function(a,o){var u=o[1];return fs(o[0].evaluate(a),u.evaluate(a))}]]},get:{type:Hn,overloads:[[[jn],function(a,o){return Af(o[0].evaluate(a),a.properties())}],[[jn,Gi],function(a,o){var u=o[1];return Af(o[0].evaluate(a),u.evaluate(a))}]]},"feature-state":[Hn,[jn],function(a,o){return Af(o[0].evaluate(a),a.featureState||{})}],properties:[Gi,[],function(a){return a.properties()}],"geometry-type":[jn,[],function(a){return a.geometryType()}],id:[Hn,[],function(a){return a.id()}],zoom:[pr,[],function(a){return a.globals.zoom}],"heatmap-density":[pr,[],function(a){return a.globals.heatmapDensity||0}],"line-progress":[pr,[],function(a){return a.globals.lineProgress||0}],accumulated:[Hn,[],function(a){return a.globals.accumulated===void 0?null:a.globals.accumulated}],"+":[pr,tl(pr),function(a,o){for(var u=0,v=0,_=o;v<_.length;v+=1)u+=_[v].evaluate(a);return u}],"*":[pr,tl(pr),function(a,o){for(var u=1,v=0,_=o;v<_.length;v+=1)u*=_[v].evaluate(a);return u}],"-":{type:pr,overloads:[[[pr,pr],function(a,o){var u=o[1];return o[0].evaluate(a)-u.evaluate(a)}],[[pr],function(a,o){return-o[0].evaluate(a)}]]},"/":[pr,[pr,pr],function(a,o){var u=o[1];return o[0].evaluate(a)/u.evaluate(a)}],"%":[pr,[pr,pr],function(a,o){var u=o[1];return o[0].evaluate(a)%u.evaluate(a)}],ln2:[pr,[],function(){return Math.LN2}],pi:[pr,[],function(){return Math.PI}],e:[pr,[],function(){return Math.E}],"^":[pr,[pr,pr],function(a,o){var u=o[1];return Math.pow(o[0].evaluate(a),u.evaluate(a))}],sqrt:[pr,[pr],function(a,o){return Math.sqrt(o[0].evaluate(a))}],log10:[pr,[pr],function(a,o){return Math.log(o[0].evaluate(a))/Math.LN10}],ln:[pr,[pr],function(a,o){return Math.log(o[0].evaluate(a))}],log2:[pr,[pr],function(a,o){return Math.log(o[0].evaluate(a))/Math.LN2}],sin:[pr,[pr],function(a,o){return Math.sin(o[0].evaluate(a))}],cos:[pr,[pr],function(a,o){return Math.cos(o[0].evaluate(a))}],tan:[pr,[pr],function(a,o){return Math.tan(o[0].evaluate(a))}],asin:[pr,[pr],function(a,o){return Math.asin(o[0].evaluate(a))}],acos:[pr,[pr],function(a,o){return Math.acos(o[0].evaluate(a))}],atan:[pr,[pr],function(a,o){return Math.atan(o[0].evaluate(a))}],min:[pr,tl(pr),function(a,o){return Math.min.apply(Math,o.map(function(u){return u.evaluate(a)}))}],max:[pr,tl(pr),function(a,o){return Math.max.apply(Math,o.map(function(u){return u.evaluate(a)}))}],abs:[pr,[pr],function(a,o){return Math.abs(o[0].evaluate(a))}],round:[pr,[pr],function(a,o){var u=o[0].evaluate(a);return u<0?-Math.round(-u):Math.round(u)}],floor:[pr,[pr],function(a,o){return Math.floor(o[0].evaluate(a))}],ceil:[pr,[pr],function(a,o){return Math.ceil(o[0].evaluate(a))}],"filter-==":[Rn,[jn,Hn],function(a,o){var u=o[0],v=o[1];return a.properties()[u.value]===v.value}],"filter-id-==":[Rn,[Hn],function(a,o){var u=o[0];return a.id()===u.value}],"filter-type-==":[Rn,[jn],function(a,o){var u=o[0];return a.geometryType()===u.value}],"filter-<":[Rn,[jn,Hn],function(a,o){var u=o[0],v=o[1],_=a.properties()[u.value],S=v.value;return typeof _==typeof S&&_<S}],"filter-id-<":[Rn,[Hn],function(a,o){var u=o[0],v=a.id(),_=u.value;return typeof v==typeof _&&v<_}],"filter->":[Rn,[jn,Hn],function(a,o){var u=o[0],v=o[1],_=a.properties()[u.value],S=v.value;return typeof _==typeof S&&_>S}],"filter-id->":[Rn,[Hn],function(a,o){var u=o[0],v=a.id(),_=u.value;return typeof v==typeof _&&v>_}],"filter-<=":[Rn,[jn,Hn],function(a,o){var u=o[0],v=o[1],_=a.properties()[u.value],S=v.value;return typeof _==typeof S&&_<=S}],"filter-id-<=":[Rn,[Hn],function(a,o){var u=o[0],v=a.id(),_=u.value;return typeof v==typeof _&&v<=_}],"filter->=":[Rn,[jn,Hn],function(a,o){var u=o[0],v=o[1],_=a.properties()[u.value],S=v.value;return typeof _==typeof S&&_>=S}],"filter-id->=":[Rn,[Hn],function(a,o){var u=o[0],v=a.id(),_=u.value;return typeof v==typeof _&&v>=_}],"filter-has":[Rn,[Hn],function(a,o){return o[0].value in a.properties()}],"filter-has-id":[Rn,[],function(a){return a.id()!==null&&a.id()!==void 0}],"filter-type-in":[Rn,[ei(jn)],function(a,o){return o[0].value.indexOf(a.geometryType())>=0}],"filter-id-in":[Rn,[ei(Hn)],function(a,o){return o[0].value.indexOf(a.id())>=0}],"filter-in-small":[Rn,[jn,ei(Hn)],function(a,o){var u=o[0];return o[1].value.indexOf(a.properties()[u.value])>=0}],"filter-in-large":[Rn,[jn,ei(Hn)],function(a,o){var u=o[0],v=o[1];return function(_,S,A,R){for(;A<=R;){var z=A+R>>1;if(S[z]===_)return!0;S[z]>_?R=z-1:A=z+1}return!1}(a.properties()[u.value],v.value,0,v.value.length-1)}],all:{type:Rn,overloads:[[[Rn,Rn],function(a,o){var u=o[1];return o[0].evaluate(a)&&u.evaluate(a)}],[tl(Rn),function(a,o){for(var u=0,v=o;u<v.length;u+=1)if(!v[u].evaluate(a))return!1;return!0}]]},any:{type:Rn,overloads:[[[Rn,Rn],function(a,o){var u=o[1];return o[0].evaluate(a)||u.evaluate(a)}],[tl(Rn),function(a,o){for(var u=0,v=o;u<v.length;u+=1)if(v[u].evaluate(a))return!0;return!1}]]},"!":[Rn,[Rn],function(a,o){return!o[0].evaluate(a)}],"is-supported-script":[Rn,[jn],function(a,o){var u=a.globals&&a.globals.isSupportedScript;return!u||u(o[0].evaluate(a))}],upcase:[jn,[jn],function(a,o){return o[0].evaluate(a).toUpperCase()}],downcase:[jn,[jn],function(a,o){return o[0].evaluate(a).toLowerCase()}],concat:[jn,tl(Hn),function(a,o){return o.map(function(u){return jo(u.evaluate(a))}).join("")}],"resolved-locale":[jn,[ha],function(a,o){return o[0].evaluate(a).resolvedLocale()}]});var zl=function(o,u){this.expression=o,this._warningHistory={},this._evaluator=new Us,this._defaultValue=u?function(v){return v.type==="color"&&nf(v.default)?new Bi(0,0,0,0):v.type==="color"?Bi.parse(v.default)||null:v.default===void 0?null:v.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null};function hl(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Fl}function jc(a,o){var u=new cl(Fl,[],o?function(_){var S={color:Nn,string:jn,number:pr,enum:jn,boolean:Rn,formatted:Sa,resolvedImage:Ji};return _.type==="array"?ei(S[_.value]||Hn,_.length):S[_.type]}(o):void 0),v=u.parse(a,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return v?fl(new zl(v,o)):xc(u.errors)}zl.prototype.evaluateWithoutErrorHandling=function(a,o,u,v,_,S){return this._evaluator.globals=a,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=v,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)},zl.prototype.evaluate=function(a,o,u,v,_,S){this._evaluator.globals=a,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=v,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=S||null;try{var A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new no("Expected value to be one of "+Object.keys(this._enumValues).map(function(R){return JSON.stringify(R)}).join(", ")+", but found "+JSON.stringify(A)+" instead.");return A}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console!="undefined"&&console.warn(R.message)),this._defaultValue}};var Ul=function(o,u){this.kind=o,this._styleExpression=u,this.isStateDependent=o!=="constant"&&!Mu(u.expression)};Ul.prototype.evaluateWithoutErrorHandling=function(a,o,u,v,_,S){return this._styleExpression.evaluateWithoutErrorHandling(a,o,u,v,_,S)},Ul.prototype.evaluate=function(a,o,u,v,_,S){return this._styleExpression.evaluate(a,o,u,v,_,S)};var af=function(o,u,v,_){this.kind=o,this.zoomStops=v,this._styleExpression=u,this.isStateDependent=o!=="camera"&&!Mu(u.expression),this.interpolationType=_};function Mh(a,o){if((a=jc(a,o)).result==="error")return a;var u=a.value.expression,v=iu(u);if(!v&&!Bl(o))return xc([new Yr("","data expressions not supported")]);var _=au(u,["zoom"]);if(!_&&!zc(o))return xc([new Yr("","zoom expressions not supported")]);var S=function A(R){var z=null;if(R instanceof Kr)z=A(R.result);else if(R instanceof zr)for(var W=0,q=R.args;W<q.length&&!(z=A(q[W]));W+=1);else(R instanceof co||R instanceof Et)&&R.input instanceof ce&&R.input.name==="zoom"&&(z=R);return z instanceof Yr||R.eachChild(function(ne){var ae=A(ne);ae instanceof Yr?z=ae:!z&&ae?z=new Yr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):z&&ae&&z!==ae&&(z=new Yr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),z}(u);return S||_?S instanceof Yr?xc([S]):S instanceof Et&&!Nl(o)?xc([new Yr("",'"interpolate" expressions cannot be used with this property')]):fl(S?new af(v?"camera":"composite",a.value,S.labels,S instanceof Et?S.interpolation:void 0):new Ul(v?"constant":"source",a.value)):xc([new Yr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}af.prototype.evaluateWithoutErrorHandling=function(a,o,u,v,_,S){return this._styleExpression.evaluateWithoutErrorHandling(a,o,u,v,_,S)},af.prototype.evaluate=function(a,o,u,v,_,S){return this._styleExpression.evaluate(a,o,u,v,_,S)},af.prototype.interpolationFactor=function(a,o,u){return this.interpolationType?Et.interpolationFactor(this.interpolationType,a,o,u):0};var of=function(o,u){this._parameters=o,this._specification=u,Nr(this,function v(_,S){var A,R,z,W=S.type==="color",q=_.stops&&typeof _.stops[0][0]=="object",ne=q||!(q||_.property!==void 0),ae=_.type||(Nl(S)?"exponential":"interval");if(W&&((_=Nr({},_)).stops&&(_.stops=_.stops.map(function(vi){return[vi[0],Bi.parse(vi[1])]})),_.default=Bi.parse(_.default?_.default:S.default)),_.colorSpace&&_.colorSpace!=="rgb"&&!ot[_.colorSpace])throw new Error("Unknown color space: "+_.colorSpace);if(ae==="exponential")A=Kh;else if(ae==="interval")A=Kp;else if(ae==="categorical"){A=Th,R=Object.create(null);for(var Te=0,je=_.stops;Te<je.length;Te+=1){var Be=je[Te];R[Be[0]]=Be[1]}z=typeof _.stops[0][0]}else{if(ae!=="identity")throw new Error('Unknown function type "'+ae+'"');A=ou}if(q){for(var Je={},Qe=[],Tt=0;Tt<_.stops.length;Tt++){var Zt=_.stops[Tt],ar=Zt[0].zoom;Je[ar]===void 0&&(Je[ar]={zoom:ar,type:_.type,property:_.property,default:_.default,stops:[]},Qe.push(ar)),Je[ar].stops.push([Zt[0].value,Zt[1]])}for(var Lr=[],xr=0,dn=Qe;xr<dn.length;xr+=1){var _n=dn[xr];Lr.push([Je[_n].zoom,v(Je[_n],S)])}var ci={name:"linear"};return{kind:"composite",interpolationType:ci,interpolationFactor:Et.interpolationFactor.bind(void 0,ci),zoomStops:Lr.map(function(vi){return vi[0]}),evaluate:function(ti,Zi){var Pi=ti.zoom;return Kh({stops:Lr,base:_.base},S,Pi).evaluate(Pi,Zi)}}}if(ne){var _i=ae==="exponential"?{name:"exponential",base:_.base!==void 0?_.base:1}:null;return{kind:"camera",interpolationType:_i,interpolationFactor:Et.interpolationFactor.bind(void 0,_i),zoomStops:_.stops.map(function(vi){return vi[0]}),evaluate:function(ti){return A(_,S,ti.zoom,R,z)}}}return{kind:"source",evaluate:function(ti,Zi){var Pi=Zi&&Zi.properties?Zi.properties[_.property]:void 0;return Pi===void 0?Uc(_.default,S.default):A(_,S,Pi,R,z)}}}(this._parameters,this._specification))};function es(a){var o=a.key,u=a.value,v=a.valueSpec||{},_=a.objectElementValidators||{},S=a.style,A=a.styleSpec,R=[],z=fo(u);if(z!=="object")return[new Ye(o,u,"object expected, "+z+" found")];for(var W in u){var q=W.split(".")[0],ne=v[q]||v["*"],ae=void 0;if(_[q])ae=_[q];else if(v[q])ae=Qn;else if(_["*"])ae=_["*"];else{if(!v["*"]){R.push(new Ye(o,u[W],'unknown property "'+W+'"'));continue}ae=Qn}R=R.concat(ae({key:(o&&o+".")+W,value:u[W],valueSpec:ne,style:S,styleSpec:A,object:u,objectKey:W},u))}for(var Te in v)_[Te]||v[Te].required&&v[Te].default===void 0&&u[Te]===void 0&&R.push(new Ye(o,u,'missing required property "'+Te+'"'));return R}function $h(a){var o=a.value,u=a.valueSpec,v=a.style,_=a.styleSpec,S=a.key,A=a.arrayElementValidator||Qn;if(fo(o)!=="array")return[new Ye(S,o,"array expected, "+fo(o)+" found")];if(u.length&&o.length!==u.length)return[new Ye(S,o,"array length "+u.length+" expected, length "+o.length+" found")];if(u["min-length"]&&o.length<u["min-length"])return[new Ye(S,o,"array length at least "+u["min-length"]+" expected, length "+o.length+" found")];var R={type:u.value,values:u.values};_.$version<7&&(R.function=u.function),fo(u.value)==="object"&&(R=u.value);for(var z=[],W=0;W<o.length;W++)z=z.concat(A({array:o,arrayIndex:W,value:o[W],valueSpec:R,style:v,styleSpec:_,key:S+"["+W+"]"}));return z}function Vc(a){var o=a.key,u=a.value,v=a.valueSpec,_=fo(u);return _==="number"&&u!=u&&(_="NaN"),_!=="number"?[new Ye(o,u,"number expected, "+_+" found")]:"minimum"in v&&u<v.minimum?[new Ye(o,u,u+" is less than the minimum value "+v.minimum)]:"maximum"in v&&u>v.maximum?[new Ye(o,u,u+" is greater than the maximum value "+v.maximum)]:[]}function qh(a){var o,u,v,_=a.valueSpec,S=Xr(a.value.type),A={},R=S!=="categorical"&&a.value.property===void 0,z=!R,W=fo(a.value.stops)==="array"&&fo(a.value.stops[0])==="array"&&fo(a.value.stops[0][0])==="object",q=es({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(je){if(S==="identity")return[new Ye(je.key,je.value,'identity function may not have a "stops" property')];var Be=[],Je=je.value;return Be=Be.concat($h({key:je.key,value:Je,valueSpec:je.valueSpec,style:je.style,styleSpec:je.styleSpec,arrayElementValidator:ne})),fo(Je)==="array"&&Je.length===0&&Be.push(new Ye(je.key,Je,"array must have at least one stop")),Be},default:function(je){return Qn({key:je.key,value:je.value,valueSpec:_,style:je.style,styleSpec:je.styleSpec})}}});return S==="identity"&&R&&q.push(new Ye(a.key,a.value,'missing required property "property"')),S==="identity"||a.value.stops||q.push(new Ye(a.key,a.value,'missing required property "stops"')),S==="exponential"&&a.valueSpec.expression&&!Nl(a.valueSpec)&&q.push(new Ye(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(z&&!Bl(a.valueSpec)?q.push(new Ye(a.key,a.value,"property functions not supported")):R&&!zc(a.valueSpec)&&q.push(new Ye(a.key,a.value,"zoom functions not supported"))),S!=="categorical"&&!W||a.value.property!==void 0||q.push(new Ye(a.key,a.value,'"property" property is required')),q;function ne(Te){var je=[],Be=Te.value,Je=Te.key;if(fo(Be)!=="array")return[new Ye(Je,Be,"array expected, "+fo(Be)+" found")];if(Be.length!==2)return[new Ye(Je,Be,"array length 2 expected, length "+Be.length+" found")];if(W){if(fo(Be[0])!=="object")return[new Ye(Je,Be,"object expected, "+fo(Be[0])+" found")];if(Be[0].zoom===void 0)return[new Ye(Je,Be,"object stop key must have zoom")];if(Be[0].value===void 0)return[new Ye(Je,Be,"object stop key must have value")];if(v&&v>Xr(Be[0].zoom))return[new Ye(Je,Be[0].zoom,"stop zoom values must appear in ascending order")];Xr(Be[0].zoom)!==v&&(v=Xr(Be[0].zoom),u=void 0,A={}),je=je.concat(es({key:Je+"[0]",value:Be[0],valueSpec:{zoom:{}},style:Te.style,styleSpec:Te.styleSpec,objectElementValidators:{zoom:Vc,value:ae}}))}else je=je.concat(ae({key:Je+"[0]",value:Be[0],valueSpec:{},style:Te.style,styleSpec:Te.styleSpec},Be));return hl(dr(Be[1]))?je.concat([new Ye(Je+"[1]",Be[1],"expressions are not allowed in function stops.")]):je.concat(Qn({key:Je+"[1]",value:Be[1],valueSpec:_,style:Te.style,styleSpec:Te.styleSpec}))}function ae(Te,je){var Be=fo(Te.value),Je=Xr(Te.value),Qe=Te.value!==null?Te.value:je;if(o){if(Be!==o)return[new Ye(Te.key,Qe,Be+" stop domain type must match previous stop domain type "+o)]}else o=Be;if(Be!=="number"&&Be!=="string"&&Be!=="boolean")return[new Ye(Te.key,Qe,"stop domain value must be a number, string, or boolean")];if(Be!=="number"&&S!=="categorical"){var Tt="number expected, "+Be+" found";return Bl(_)&&S===void 0&&(Tt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ye(Te.key,Qe,Tt)]}return S!=="categorical"||Be!=="number"||isFinite(Je)&&Math.floor(Je)===Je?S!=="categorical"&&Be==="number"&&u!==void 0&&Je<u?[new Ye(Te.key,Qe,"stop domain values must appear in ascending order")]:(u=Je,S==="categorical"&&Je in A?[new Ye(Te.key,Qe,"stop domain values must be unique")]:(A[Je]=!0,[])):[new Ye(Te.key,Qe,"integer expected, found "+Je)]}}function rc(a){var o=(a.expressionContext==="property"?Mh:jc)(dr(a.value),a.valueSpec);if(o.result==="error")return o.value.map(function(v){return new Ye(""+a.key+v.key,a.value,v.message)});var u=o.value.expression||o.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!u.outputDefined())return[new Ye(a.key,a.value,'Invalid data expression for "'+a.propertyKey+'". Output values must be contained as literals within the expression.')];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Mu(u))return[new Ye(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!Mu(u))return[new Ye(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!au(u,["zoom","feature-state"]))return[new Ye(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!iu(u))return[new Ye(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function nc(a){var o=a.key,u=a.value,v=a.valueSpec,_=[];return Array.isArray(v.values)?v.values.indexOf(Xr(u))===-1&&_.push(new Ye(o,u,"expected one of ["+v.values.join(", ")+"], "+JSON.stringify(u)+" found")):Object.keys(v.values).indexOf(Xr(u))===-1&&_.push(new Ye(o,u,"expected one of ["+Object.keys(v.values).join(", ")+"], "+JSON.stringify(u)+" found")),_}function Tf(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(var o=0,u=a.slice(1);o<u.length;o+=1){var v=u[o];if(!Tf(v)&&typeof v!="boolean")return!1}return!0;default:return!0}}of.deserialize=function(a){return new of(a._parameters,a._specification)},of.serialize=function(a){return{_parameters:a._parameters,_specification:a._specification}};var ic={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function sf(a){if(a==null)return{filter:function(){return!0},needGeometry:!1};Tf(a)||(a=qf(a));var o=jc(a,ic);if(o.result==="error")throw new Error(o.value.map(function(u){return u.key+": "+u.message}).join(", "));return{filter:function(v,_,S){return o.value.evaluate(v,_,{},S)},needGeometry:function u(v){if(!Array.isArray(v))return!1;if(v[0]==="within")return!0;for(var _=1;_<v.length;_++)if(u(v[_]))return!0;return!1}(a)}}function $f(a,o){return a<o?-1:a>o?1:0}function qf(a){if(!a)return!0;var o,u=a[0];return a.length<=1?u!=="any":u==="=="?Qf(a[1],a[2],"=="):u==="!="?Mf(Qf(a[1],a[2],"==")):u==="<"||u===">"||u==="<="||u===">="?Qf(a[1],a[2],u):u==="any"?(o=a.slice(1),["any"].concat(o.map(qf))):u==="all"?["all"].concat(a.slice(1).map(qf)):u==="none"?["all"].concat(a.slice(1).map(qf).map(Mf)):u==="in"?jl(a[1],a.slice(2)):u==="!in"?Mf(jl(a[1],a.slice(2))):u==="has"?Cl(a[1]):u==="!has"?Mf(Cl(a[1])):u!=="within"||a}function Qf(a,o,u){switch(a){case"$type":return["filter-type-"+u,o];case"$id":return["filter-id-"+u,o];default:return["filter-"+u,a,o]}}function jl(a,o){if(o.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(function(u){return typeof u!=typeof o[0]})?["filter-in-large",a,["literal",o.sort($f)]]:["filter-in-small",a,["literal",o]]}}function Cl(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Mf(a){return["!",a]}function Qh(a){return Tf(dr(a.value))?rc(Nr({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function o(u){var v=u.value,_=u.key;if(fo(v)!=="array")return[new Ye(_,v,"array expected, "+fo(v)+" found")];var S,A=u.styleSpec,R=[];if(v.length<1)return[new Ye(_,v,"filter array must have at least 1 element")];switch(R=R.concat(nc({key:_+"[0]",value:v[0],valueSpec:A.filter_operator,style:u.style,styleSpec:u.styleSpec})),Xr(v[0])){case"<":case"<=":case">":case">=":v.length>=2&&Xr(v[1])==="$type"&&R.push(new Ye(_,v,'"$type" cannot be use with operator "'+v[0]+'"'));case"==":case"!=":v.length!==3&&R.push(new Ye(_,v,'filter array for operator "'+v[0]+'" must have 3 elements'));case"in":case"!in":v.length>=2&&(S=fo(v[1]))!=="string"&&R.push(new Ye(_+"[1]",v[1],"string expected, "+S+" found"));for(var z=2;z<v.length;z++)S=fo(v[z]),Xr(v[1])==="$type"?R=R.concat(nc({key:_+"["+z+"]",value:v[z],valueSpec:A.geometry_type,style:u.style,styleSpec:u.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&R.push(new Ye(_+"["+z+"]",v[z],"string, number, or boolean expected, "+S+" found"));break;case"any":case"all":case"none":for(var W=1;W<v.length;W++)R=R.concat(o({key:_+"["+W+"]",value:v[W],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":S=fo(v[1]),v.length!==2?R.push(new Ye(_,v,'filter array for "'+v[0]+'" operator must have 2 elements')):S!=="string"&&R.push(new Ye(_+"[1]",v[1],"string expected, "+S+" found"));break;case"within":S=fo(v[1]),v.length!==2?R.push(new Ye(_,v,'filter array for "'+v[0]+'" operator must have 2 elements')):S!=="object"&&R.push(new Ye(_+"[1]",v[1],"object expected, "+S+" found"))}return R}(a)}function Jf(a,o){var u=a.key,v=a.style,_=a.styleSpec,S=a.value,A=a.objectKey,R=_[o+"_"+a.layerType];if(!R)return[];var z=A.match(/^(.*)-transition$/);if(o==="paint"&&z&&R[z[1]]&&R[z[1]].transition)return Qn({key:u,value:S,valueSpec:_.transition,style:v,styleSpec:_});var W,q=a.valueSpec||R[A];if(!q)return[new Ye(u,S,'unknown property "'+A+'"')];if(fo(S)==="string"&&Bl(q)&&!q.tokens&&(W=/^{([^}]+)}$/.exec(S)))return[new Ye(u,S,'"'+A+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(W[1])+" }`.")];var ne=[];return a.layerType==="symbol"&&(A==="text-field"&&v&&!v.glyphs&&ne.push(new Ye(u,S,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&nf(dr(S))&&Xr(S.type)==="identity"&&ne.push(new Ye(u,S,'"text-font" does not support identity functions'))),ne.concat(Qn({key:a.key,value:S,valueSpec:q,style:v,styleSpec:_,expressionContext:"property",propertyType:o,propertyKey:A}))}function Jh(a){return Jf(a,"paint")}function eh(a){return Jf(a,"layout")}function Pf(a){var o=[],u=a.value,v=a.key,_=a.style,S=a.styleSpec;u.type||u.ref||o.push(new Ye(v,u,'either "type" or "ref" is required'));var A,R=Xr(u.type),z=Xr(u.ref);if(u.id)for(var W=Xr(u.id),q=0;q<a.arrayIndex;q++){var ne=_.layers[q];Xr(ne.id)===W&&o.push(new Ye(v,u.id,'duplicate layer id "'+u.id+'", previously used at line '+ne.id.__line__))}if("ref"in u)["type","source","source-layer","filter","layout"].forEach(function(je){je in u&&o.push(new Ye(v,u[je],'"'+je+'" is prohibited for ref layers'))}),_.layers.forEach(function(je){Xr(je.id)===z&&(A=je)}),A?A.ref?o.push(new Ye(v,u.ref,"ref cannot reference another ref layer")):R=Xr(A.type):o.push(new Ye(v,u.ref,'ref layer "'+z+'" not found'));else if(R!=="background")if(u.source){var ae=_.sources&&_.sources[u.source],Te=ae&&Xr(ae.type);ae?Te==="vector"&&R==="raster"?o.push(new Ye(v,u.source,'layer "'+u.id+'" requires a raster source')):Te==="raster"&&R!=="raster"?o.push(new Ye(v,u.source,'layer "'+u.id+'" requires a vector source')):Te!=="vector"||u["source-layer"]?Te==="raster-dem"&&R!=="hillshade"?o.push(new Ye(v,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):R!=="line"||!u.paint||!u.paint["line-gradient"]||Te==="geojson"&&ae.lineMetrics||o.push(new Ye(v,u,'layer "'+u.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):o.push(new Ye(v,u,'layer "'+u.id+'" must specify a "source-layer"')):o.push(new Ye(v,u.source,'source "'+u.source+'" not found'))}else o.push(new Ye(v,u,'missing required property "source"'));return o=o.concat(es({key:v,value:u,valueSpec:S.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Qn({key:v+".type",value:u.type,valueSpec:S.layer.type,style:a.style,styleSpec:a.styleSpec,object:u,objectKey:"type"})},filter:Qh,layout:function(Be){return es({layer:u,key:Be.key,value:Be.value,style:Be.style,styleSpec:Be.styleSpec,objectElementValidators:{"*":function(Qe){return eh(Nr({layerType:R},Qe))}}})},paint:function(Be){return es({layer:u,key:Be.key,value:Be.value,style:Be.style,styleSpec:Be.styleSpec,objectElementValidators:{"*":function(Qe){return Jh(Nr({layerType:R},Qe))}}})}}}))}function wl(a){var o=a.value,u=a.key,v=fo(o);return v!=="string"?[new Ye(u,o,"string expected, "+v+" found")]:[]}var At={promoteId:function(o){var u=o.key,v=o.value;if(fo(v)==="string")return wl({key:u,value:v});var _=[];for(var S in v)_.push.apply(_,wl({key:u+"."+S,value:v[S]}));return _}};function Vr(a){var o=a.value,u=a.key,v=a.styleSpec,_=a.style;if(!o.type)return[new Ye(u,o,'"type" is required')];var S,A=Xr(o.type);switch(A){case"vector":case"raster":case"raster-dem":return es({key:u,value:o,valueSpec:v["source_"+A.replace("-","_")],style:a.style,styleSpec:v,objectElementValidators:At});case"geojson":if(S=es({key:u,value:o,valueSpec:v.source_geojson,style:_,styleSpec:v,objectElementValidators:At}),o.cluster)for(var R in o.clusterProperties){var z=o.clusterProperties[R],W=z[0],q=typeof W=="string"?[W,["accumulated"],["get",R]]:W;S.push.apply(S,rc({key:u+"."+R+".map",value:z[1],expressionContext:"cluster-map"})),S.push.apply(S,rc({key:u+"."+R+".reduce",value:q,expressionContext:"cluster-reduce"}))}return S;case"video":return es({key:u,value:o,valueSpec:v.source_video,style:_,styleSpec:v});case"image":return es({key:u,value:o,valueSpec:v.source_image,style:_,styleSpec:v});case"canvas":return[new Ye(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return nc({key:u+".type",value:o.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:_,styleSpec:v})}}function yr(a){var o=a.value,u=a.styleSpec,v=u.light,_=a.style,S=[],A=fo(o);if(o===void 0)return S;if(A!=="object")return S.concat([new Ye("light",o,"object expected, "+A+" found")]);for(var R in o){var z=R.match(/^(.*)-transition$/);S=S.concat(z&&v[z[1]]&&v[z[1]].transition?Qn({key:R,value:o[R],valueSpec:u.transition,style:_,styleSpec:u}):v[R]?Qn({key:R,value:o[R],valueSpec:v[R],style:_,styleSpec:u}):[new Ye(R,o[R],'unknown property "'+R+'"')])}return S}var gi={"*":function(){return[]},array:$h,boolean:function(o){var u=o.value,v=o.key,_=fo(u);return _!=="boolean"?[new Ye(v,u,"boolean expected, "+_+" found")]:[]},number:Vc,color:function(o){var u=o.key,v=o.value,_=fo(v);return _!=="string"?[new Ye(u,v,"color expected, "+_+" found")]:Qi(v)===null?[new Ye(u,v,'color expected, "'+v+'" found')]:[]},constants:nt,enum:nc,filter:Qh,function:qh,layer:Pf,object:es,source:Vr,light:yr,string:wl,formatted:function(o){return wl(o).length===0?[]:rc(o)},resolvedImage:function(o){return wl(o).length===0?[]:rc(o)}};function Qn(a){var o=a.value,u=a.valueSpec,v=a.styleSpec;return u.expression&&nf(Xr(o))?qh(a):u.expression&&hl(dr(o))?rc(a):u.type&&gi[u.type]?gi[u.type](a):es(Nr({},a,{valueSpec:u.type?v[u.type]:u}))}function Hi(a){var o=a.value,u=a.key,v=wl(a);return v.length||(o.indexOf("{fontstack}")===-1&&v.push(new Ye(u,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&v.push(new Ye(u,o,'"glyphs" url must include a "{range}" token'))),v}function Da(a,o){o===void 0&&(o=Ce);var u=[];return u=u.concat(Qn({key:"",value:a,valueSpec:o.$root,styleSpec:o,style:a,objectElementValidators:{glyphs:Hi,"*":function(){return[]}}})),a.constants&&(u=u.concat(nt({key:"constants",value:a.constants,style:a,styleSpec:o}))),Ya(u)}function Ya(a){return[].concat(a).sort(function(o,u){return o.line-u.line})}function uf(a){return function(){for(var o=[],u=arguments.length;u--;)o[u]=arguments[u];return Ya(a.apply(this,o))}}Da.source=uf(Vr),Da.light=uf(yr),Da.layer=uf(Pf),Da.filter=uf(Qh),Da.paintProperty=uf(Jh),Da.layoutProperty=uf(eh);var lf=Da,Vl=lf.light,ep=lf.paintProperty,Ph=lf.layoutProperty;function ac(a,o){var u=!1;if(o&&o.length)for(var v=0,_=o;v<_.length;v+=1)a.fire(new ft(new Error(_[v].message))),u=!0;return u}var pl=$i;function $i(a,o,u){var v=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var _=new Int32Array(this.arrayBuffer);a=_[0],this.d=(o=_[1])+2*(u=_[2]);for(var S=0;S<this.d*this.d;S++){var A=_[3+S],R=_[3+S+1];v.push(A===R?null:_.subarray(A,R))}var z=_[3+v.length+1];this.keys=_.subarray(_[3+v.length],z),this.bboxes=_.subarray(z),this.insert=this._insertReadonly}else{this.d=o+2*u;for(var W=0;W<this.d*this.d;W++)v.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=a,this.padding=u,this.scale=o/a,this.uid=0;var q=u/o*a;this.min=-q,this.max=a+q}$i.prototype.insert=function(a,o,u,v,_){this._forEachCell(o,u,v,_,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(v),this.bboxes.push(_)},$i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},$i.prototype._insertCell=function(a,o,u,v,_,S){this.cells[_].push(S)},$i.prototype.query=function(a,o,u,v,_){var S=this.min,A=this.max;if(a<=S&&o<=S&&A<=u&&A<=v&&!_)return Array.prototype.slice.call(this.keys);var R=[];return this._forEachCell(a,o,u,v,this._queryCell,R,{},_),R},$i.prototype._queryCell=function(a,o,u,v,_,S,A,R){var z=this.cells[_];if(z!==null)for(var W=this.keys,q=this.bboxes,ne=0;ne<z.length;ne++){var ae=z[ne];if(A[ae]===void 0){var Te=4*ae;(R?R(q[Te+0],q[Te+1],q[Te+2],q[Te+3]):a<=q[Te+2]&&o<=q[Te+3]&&u>=q[Te+0]&&v>=q[Te+1])?(A[ae]=!0,S.push(W[ae])):A[ae]=!1}}},$i.prototype._forEachCell=function(a,o,u,v,_,S,A,R){for(var z=this._convertToCellCoord(a),W=this._convertToCellCoord(o),q=this._convertToCellCoord(u),ne=this._convertToCellCoord(v),ae=z;ae<=q;ae++)for(var Te=W;Te<=ne;Te++){var je=this.d*Te+ae;if((!R||R(this._convertFromCellCoord(ae),this._convertFromCellCoord(Te),this._convertFromCellCoord(ae+1),this._convertFromCellCoord(Te+1)))&&_.call(this,a,o,u,v,je,S,A,R))return}},$i.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},$i.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},$i.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,o=3+this.cells.length+1+1,u=0,v=0;v<this.cells.length;v++)u+=this.cells[v].length;var _=new Int32Array(o+u+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var S=o,A=0;A<a.length;A++){var R=a[A];_[3+A]=S,_.set(R,S),S+=R.length}return _[3+a.length]=S,_.set(this.keys,S),_[3+a.length+1]=S+=this.keys.length,_.set(this.bboxes,S),S+=this.bboxes.length,_.buffer};var io=Ae.ImageData,di=Ae.ImageBitmap,qa={};function Kn(a,o,u){u===void 0&&(u={}),Object.defineProperty(o,"_classRegistryKey",{value:a,writeable:!1}),qa[a]={klass:o,omit:u.omit||[],shallow:u.shallow||[]}}for(var Gu in Kn("Object",Object),pl.serialize=function(a,o){var u=a.toArrayBuffer();return o&&o.push(u),{buffer:u}},pl.deserialize=function(a){return new pl(a.buffer)},Kn("Grid",pl),Kn("Color",Bi),Kn("Error",Error),Kn("ResolvedImage",Ft),Kn("StylePropertyFunction",of),Kn("StyleExpression",zl,{omit:["_evaluator"]}),Kn("ZoomDependentExpression",af),Kn("ZoomConstantExpression",Ul),Kn("CompoundExpression",ce,{omit:["_evaluate"]}),Fl)Fl[Gu]._classRegistryKey||Kn("Expression_"+Gu,Fl[Gu]);function cf(a){return a&&typeof ArrayBuffer!="undefined"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Gc(a){return di&&a instanceof di}function Hu(a,o){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(cf(a)||Gc(a))return o&&o.push(a),a;if(ArrayBuffer.isView(a)){var u=a;return o&&o.push(u.buffer),u}if(a instanceof io)return o&&o.push(a.data.buffer),a;if(Array.isArray(a)){for(var v=[],_=0,S=a;_<S.length;_+=1)v.push(Hu(S[_],o));return v}if(typeof a=="object"){var A=a.constructor,R=A._classRegistryKey;if(!R)throw new Error("can't serialize object of unregistered class");var z=A.serialize?A.serialize(a,o):{};if(!A.serialize){for(var W in a)if(a.hasOwnProperty(W)&&!(qa[R].omit.indexOf(W)>=0)){var q=a[W];z[W]=qa[R].shallow.indexOf(W)>=0?q:Hu(q,o)}a instanceof Error&&(z.message=a.message)}if(z.$name)throw new Error("$name property is reserved for worker serialization logic.");return R!=="Object"&&(z.$name=R),z}throw new Error("can't serialize object of type "+typeof a)}function bs(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||cf(a)||Gc(a)||ArrayBuffer.isView(a)||a instanceof io)return a;if(Array.isArray(a))return a.map(bs);if(typeof a=="object"){var o=a.$name||"Object",u=qa[o].klass;if(!u)throw new Error("can't deserialize unregistered class "+o);if(u.deserialize)return u.deserialize(a);for(var v=Object.create(u.prototype),_=0,S=Object.keys(a);_<S.length;_+=1){var A=S[_];if(A!=="$name"){var R=a[A];v[A]=qa[o].shallow.indexOf(A)>=0?R:bs(R)}}return v}throw new Error("can't deserialize object of type "+typeof a)}var ff=function(){this.first=!0};ff.prototype.update=function(a,o){var u=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=o),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=u,!0))};var Ln={"Latin-1 Supplement":function(o){return o>=128&&o<=255},Arabic:function(o){return o>=1536&&o<=1791},"Arabic Supplement":function(o){return o>=1872&&o<=1919},"Arabic Extended-A":function(o){return o>=2208&&o<=2303},"Hangul Jamo":function(o){return o>=4352&&o<=4607},"Unified Canadian Aboriginal Syllabics":function(o){return o>=5120&&o<=5759},Khmer:function(o){return o>=6016&&o<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(o){return o>=6320&&o<=6399},"General Punctuation":function(o){return o>=8192&&o<=8303},"Letterlike Symbols":function(o){return o>=8448&&o<=8527},"Number Forms":function(o){return o>=8528&&o<=8591},"Miscellaneous Technical":function(o){return o>=8960&&o<=9215},"Control Pictures":function(o){return o>=9216&&o<=9279},"Optical Character Recognition":function(o){return o>=9280&&o<=9311},"Enclosed Alphanumerics":function(o){return o>=9312&&o<=9471},"Geometric Shapes":function(o){return o>=9632&&o<=9727},"Miscellaneous Symbols":function(o){return o>=9728&&o<=9983},"Miscellaneous Symbols and Arrows":function(o){return o>=11008&&o<=11263},"CJK Radicals Supplement":function(o){return o>=11904&&o<=12031},"Kangxi Radicals":function(o){return o>=12032&&o<=12255},"Ideographic Description Characters":function(o){return o>=12272&&o<=12287},"CJK Symbols and Punctuation":function(o){return o>=12288&&o<=12351},Hiragana:function(o){return o>=12352&&o<=12447},Katakana:function(o){return o>=12448&&o<=12543},Bopomofo:function(o){return o>=12544&&o<=12591},"Hangul Compatibility Jamo":function(o){return o>=12592&&o<=12687},Kanbun:function(o){return o>=12688&&o<=12703},"Bopomofo Extended":function(o){return o>=12704&&o<=12735},"CJK Strokes":function(o){return o>=12736&&o<=12783},"Katakana Phonetic Extensions":function(o){return o>=12784&&o<=12799},"Enclosed CJK Letters and Months":function(o){return o>=12800&&o<=13055},"CJK Compatibility":function(o){return o>=13056&&o<=13311},"CJK Unified Ideographs Extension A":function(o){return o>=13312&&o<=19903},"Yijing Hexagram Symbols":function(o){return o>=19904&&o<=19967},"CJK Unified Ideographs":function(o){return o>=19968&&o<=40959},"Yi Syllables":function(o){return o>=40960&&o<=42127},"Yi Radicals":function(o){return o>=42128&&o<=42191},"Hangul Jamo Extended-A":function(o){return o>=43360&&o<=43391},"Hangul Syllables":function(o){return o>=44032&&o<=55215},"Hangul Jamo Extended-B":function(o){return o>=55216&&o<=55295},"Private Use Area":function(o){return o>=57344&&o<=63743},"CJK Compatibility Ideographs":function(o){return o>=63744&&o<=64255},"Arabic Presentation Forms-A":function(o){return o>=64336&&o<=65023},"Vertical Forms":function(o){return o>=65040&&o<=65055},"CJK Compatibility Forms":function(o){return o>=65072&&o<=65103},"Small Form Variants":function(o){return o>=65104&&o<=65135},"Arabic Presentation Forms-B":function(o){return o>=65136&&o<=65279},"Halfwidth and Fullwidth Forms":function(o){return o>=65280&&o<=65519}};function Gl(a){for(var o=0,u=a;o<u.length;o+=1)if(hs(u[o].charCodeAt(0)))return!0;return!1}function hs(a){return!(a!==746&&a!==747&&(a<4352||!(Ln["Bopomofo Extended"](a)||Ln.Bopomofo(a)||Ln["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Ln["CJK Compatibility Ideographs"](a)||Ln["CJK Compatibility"](a)||Ln["CJK Radicals Supplement"](a)||Ln["CJK Strokes"](a)||!(!Ln["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Ln["CJK Unified Ideographs Extension A"](a)||Ln["CJK Unified Ideographs"](a)||Ln["Enclosed CJK Letters and Months"](a)||Ln["Hangul Compatibility Jamo"](a)||Ln["Hangul Jamo Extended-A"](a)||Ln["Hangul Jamo Extended-B"](a)||Ln["Hangul Jamo"](a)||Ln["Hangul Syllables"](a)||Ln.Hiragana(a)||Ln["Ideographic Description Characters"](a)||Ln.Kanbun(a)||Ln["Kangxi Radicals"](a)||Ln["Katakana Phonetic Extensions"](a)||Ln.Katakana(a)&&a!==12540||!(!Ln["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Ln["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Ln["Unified Canadian Aboriginal Syllabics"](a)||Ln["Unified Canadian Aboriginal Syllabics Extended"](a)||Ln["Vertical Forms"](a)||Ln["Yijing Hexagram Symbols"](a)||Ln["Yi Syllables"](a)||Ln["Yi Radicals"](a))))}function hf(a){return!(hs(a)||function(o){return!!(Ln["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||Ln["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||Ln["Letterlike Symbols"](o)||Ln["Number Forms"](o)||Ln["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||Ln["Control Pictures"](o)&&o!==9251||Ln["Optical Character Recognition"](o)||Ln["Enclosed Alphanumerics"](o)||Ln["Geometric Shapes"](o)||Ln["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||Ln["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Ln["CJK Symbols and Punctuation"](o)||Ln.Katakana(o)||Ln["Private Use Area"](o)||Ln["CJK Compatibility Forms"](o)||Ln["Small Form Variants"](o)||Ln["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(a))}function Vs(a){return a>=1424&&a<=2303||Ln["Arabic Presentation Forms-A"](a)||Ln["Arabic Presentation Forms-B"](a)}function Ms(a,o){return!(!o&&Vs(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Ln.Khmer(a))}function bc(a){for(var o=0,u=a;o<u.length;o+=1)if(Vs(u[o].charCodeAt(0)))return!0;return!1}var Hl=null,_u="unavailable",Ec=null,tp=function(o){o&&typeof o=="string"&&o.indexOf("NetworkError")>-1&&(_u="error"),Hl&&Hl(o)};function th(){Hc.fire(new Ve("pluginStateChange",{pluginStatus:_u,pluginURL:Ec}))}var Hc=new Ct,pf=function(){return _u},Wu=function(){if(_u!=="deferred"||!Ec)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_u="loading",th(),Ec&&ec({url:Ec},function(o){o?tp(o):(_u="loaded",th())})},rl={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return _u==="loaded"||rl.applyArabicShaping!=null},isLoading:function(){return _u==="loading"},setState:function(o){_u=o.pluginStatus,Ec=o.pluginURL},isParsed:function(){return rl.applyArabicShaping!=null&&rl.processBidirectionalText!=null&&rl.processStyledBidirectionalText!=null},getPluginURL:function(){return Ec}},ma=function(o,u){this.zoom=o,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.zoomHistory=u.zoomHistory,this.transition=u.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ff,this.transition={})};ma.prototype.isSupportedScript=function(a){return function(o,u){for(var v=0,_=o;v<_.length;v+=1)if(!Ms(_[v].charCodeAt(0),u))return!1;return!0}(a,rl.isLoaded())},ma.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ma.prototype.getCrossfadeParameters=function(){var a=this.zoom,o=a-Math.floor(a),u=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*o}};var Al=function(o,u){this.property=o,this.value=u,this.expression=function(v,_){if(nf(v))return new of(v,_);if(hl(v)){var S=Mh(v,_);if(S.result==="error")throw new Error(S.value.map(function(R){return R.key+": "+R.message}).join(", "));return S.value}var A=v;return typeof v=="string"&&_.type==="color"&&(A=Bi.parse(v)),{kind:"constant",evaluate:function(){return A}}}(u===void 0?o.specification.default:u,o.specification)};Al.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Al.prototype.possiblyEvaluate=function(a,o,u){return this.property.possiblyEvaluate(this,a,o,u)};var Tl=function(o){this.property=o,this.value=new Al(o,void 0)};Tl.prototype.transitioned=function(a,o){return new ts(this.property,this.value,o,He({},a.transition,this.transition),a.now)},Tl.prototype.untransitioned=function(){return new ts(this.property,this.value,null,{},0)};var Za=function(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)};Za.prototype.getValue=function(a){return ze(this._values[a].value.value)},Za.prototype.setValue=function(a,o){this._values.hasOwnProperty(a)||(this._values[a]=new Tl(this._values[a].property)),this._values[a].value=new Al(this._values[a].property,o===null?void 0:ze(o))},Za.prototype.getTransition=function(a){return ze(this._values[a].transition)},Za.prototype.setTransition=function(a,o){this._values.hasOwnProperty(a)||(this._values[a]=new Tl(this._values[a].property)),this._values[a].transition=ze(o)||void 0},Za.prototype.serialize=function(){for(var a={},o=0,u=Object.keys(this._values);o<u.length;o+=1){var v=u[o],_=this.getValue(v);_!==void 0&&(a[v]=_);var S=this.getTransition(v);S!==void 0&&(a[v+"-transition"]=S)}return a},Za.prototype.transitioned=function(a,o){for(var u=new Wc(this._properties),v=0,_=Object.keys(this._values);v<_.length;v+=1){var S=_[v];u._values[S]=this._values[S].transitioned(a,o._values[S])}return u},Za.prototype.untransitioned=function(){for(var a=new Wc(this._properties),o=0,u=Object.keys(this._values);o<u.length;o+=1){var v=u[o];a._values[v]=this._values[v].untransitioned()}return a};var ts=function(o,u,v,_,S){this.property=o,this.value=u,this.begin=S+_.delay||0,this.end=this.begin+_.duration||0,o.specification.transition&&(_.delay||_.duration)&&(this.prior=v)};ts.prototype.possiblyEvaluate=function(a,o,u){var v=a.now||0,_=this.value.possiblyEvaluate(a,o,u),S=this.prior;if(S){if(v>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(v<this.begin)return S.possiblyEvaluate(a,o,u);var A=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(a,o,u),_,function(R){if(R<=0)return 0;if(R>=1)return 1;var z=R*R,W=z*R;return 4*(R<.5?W:3*(R-z)+W-.75)}(A))}return _};var Wc=function(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)};Wc.prototype.possiblyEvaluate=function(a,o,u){for(var v=new Of(this._properties),_=0,S=Object.keys(this._values);_<S.length;_+=1){var A=S[_];v._values[A]=this._values[A].possiblyEvaluate(a,o,u)}return v},Wc.prototype.hasTransition=function(){for(var a=0,o=Object.keys(this._values);a<o.length;a+=1)if(this._values[o[a]].prior)return!0;return!1};var Gs=function(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)};Gs.prototype.getValue=function(a){return ze(this._values[a].value)},Gs.prototype.setValue=function(a,o){this._values[a]=new Al(this._values[a].property,o===null?void 0:ze(o))},Gs.prototype.serialize=function(){for(var a={},o=0,u=Object.keys(this._values);o<u.length;o+=1){var v=u[o],_=this.getValue(v);_!==void 0&&(a[v]=_)}return a},Gs.prototype.possiblyEvaluate=function(a,o,u){for(var v=new Of(this._properties),_=0,S=Object.keys(this._values);_<S.length;_+=1){var A=S[_];v._values[A]=this._values[A].possiblyEvaluate(a,o,u)}return v};var ps=function(o,u,v){this.property=o,this.value=u,this.parameters=v};ps.prototype.isConstant=function(){return this.value.kind==="constant"},ps.prototype.constantOr=function(a){return this.value.kind==="constant"?this.value.value:a},ps.prototype.evaluate=function(a,o,u,v){return this.property.evaluate(this.value,this.parameters,a,o,u,v)};var Of=function(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)};Of.prototype.get=function(a){return this._values[a]};var bi=function(o){this.specification=o};bi.prototype.possiblyEvaluate=function(a,o){return a.expression.evaluate(o)},bi.prototype.interpolate=function(a,o,u){var v=Ha[this.specification.type];return v?v(a,o,u):a};var si=function(o,u){this.specification=o,this.overrides=u};si.prototype.possiblyEvaluate=function(a,o,u,v){return new ps(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(o,null,{},u,v)}:a.expression,o)},si.prototype.interpolate=function(a,o,u){if(a.value.kind!=="constant"||o.value.kind!=="constant")return a;if(a.value.value===void 0||o.value.value===void 0)return new ps(this,{kind:"constant",value:void 0},a.parameters);var v=Ha[this.specification.type];return v?new ps(this,{kind:"constant",value:v(a.value.value,o.value.value,u)},a.parameters):a},si.prototype.evaluate=function(a,o,u,v,_,S){return a.kind==="constant"?a.value:a.evaluate(o,u,v,_,S)};var Zc=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.possiblyEvaluate=function(u,v,_,S){if(u.value===void 0)return new ps(this,{kind:"constant",value:void 0},v);if(u.expression.kind==="constant"){var A=u.expression.evaluate(v,null,{},_,S),R=u.property.specification.type==="resolvedImage"&&typeof A!="string"?A.name:A,z=this._calculate(R,R,R,v);return new ps(this,{kind:"constant",value:z},v)}if(u.expression.kind==="camera"){var W=this._calculate(u.expression.evaluate({zoom:v.zoom-1}),u.expression.evaluate({zoom:v.zoom}),u.expression.evaluate({zoom:v.zoom+1}),v);return new ps(this,{kind:"constant",value:W},v)}return new ps(this,u.expression,v)},o.prototype.evaluate=function(u,v,_,S,A,R){if(u.kind==="source"){var z=u.evaluate(v,_,S,A,R);return this._calculate(z,z,z,v)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(v.zoom)-1},_,S),u.evaluate({zoom:Math.floor(v.zoom)},_,S),u.evaluate({zoom:Math.floor(v.zoom)+1},_,S),v):u.value},o.prototype._calculate=function(u,v,_,S){return S.zoom>S.zoomHistory.lastIntegerZoom?{from:u,to:v}:{from:_,to:v}},o.prototype.interpolate=function(u){return u},o}(si),ko=function(o){this.specification=o};ko.prototype.possiblyEvaluate=function(a,o,u,v){if(a.value!==void 0){if(a.expression.kind==="constant"){var _=a.expression.evaluate(o,null,{},u,v);return this._calculate(_,_,_,o)}return this._calculate(a.expression.evaluate(new ma(Math.floor(o.zoom-1),o)),a.expression.evaluate(new ma(Math.floor(o.zoom),o)),a.expression.evaluate(new ma(Math.floor(o.zoom+1),o)),o)}},ko.prototype._calculate=function(a,o,u,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:a,to:o}:{from:u,to:o}},ko.prototype.interpolate=function(a){return a};var Zu=function(o){this.specification=o};Zu.prototype.possiblyEvaluate=function(a,o,u,v){return!!a.expression.evaluate(o,null,{},u,v)},Zu.prototype.interpolate=function(){return!1};var ds=function(o){for(var u in this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],o){var v=o[u];v.specification.overridable&&this.overridableProperties.push(u);var _=this.defaultPropertyValues[u]=new Al(v,void 0),S=this.defaultTransitionablePropertyValues[u]=new Tl(v);this.defaultTransitioningPropertyValues[u]=S.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=_.possiblyEvaluate({})}};Kn("DataDrivenProperty",si),Kn("DataConstantProperty",bi),Kn("CrossFadedDataDrivenProperty",Zc),Kn("CrossFadedProperty",ko),Kn("ColorRampProperty",Zu);var nl=function(a){function o(u,v){if(a.call(this),this.id=u.id,this.type=u.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},u.type!=="custom"&&(this.metadata=(u=u).metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),v.layout&&(this._unevaluatedLayout=new Gs(v.layout)),v.paint)){for(var _ in this._transitionablePaint=new Za(v.paint),u.paint)this.setPaintProperty(_,u.paint[_],{validate:!1});for(var S in u.layout)this.setLayoutProperty(S,u.layout[S],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Of(v.paint)}}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},o.prototype.getLayoutProperty=function(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)},o.prototype.setLayoutProperty=function(u,v,_){_===void 0&&(_={}),v!=null&&this._validate(Ph,"layers."+this.id+".layout."+u,u,v,_)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,v):this.visibility=v)},o.prototype.getPaintProperty=function(u){return Fr(u,"-transition")?this._transitionablePaint.getTransition(u.slice(0,-"-transition".length)):this._transitionablePaint.getValue(u)},o.prototype.setPaintProperty=function(u,v,_){if(_===void 0&&(_={}),v!=null&&this._validate(ep,"layers."+this.id+".paint."+u,u,v,_))return!1;if(Fr(u,"-transition"))return this._transitionablePaint.setTransition(u.slice(0,-"-transition".length),v||void 0),!1;var S=this._transitionablePaint._values[u],A=S.property.specification["property-type"]==="cross-faded-data-driven",R=S.value.isDataDriven(),z=S.value;this._transitionablePaint.setValue(u,v),this._handleSpecialPaintPropertyUpdate(u);var W=this._transitionablePaint._values[u].value;return W.isDataDriven()||R||A||this._handleOverridablePaintPropertyUpdate(u,z,W)},o.prototype._handleSpecialPaintPropertyUpdate=function(u){},o.prototype._handleOverridablePaintPropertyUpdate=function(u,v,_){return!1},o.prototype.isHidden=function(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"},o.prototype.updateTransitions=function(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)},o.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},o.prototype.recalculate=function(u,v){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,v)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,v)},o.prototype.serialize=function(){var u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),Nt(u,function(v,_){return!(v===void 0||_==="layout"&&!Object.keys(v).length||_==="paint"&&!Object.keys(v).length)})},o.prototype._validate=function(u,v,_,S,A){return A===void 0&&(A={}),(!A||A.validate!==!1)&&ac(this,u.call(lf,{key:v,layerType:this.type,objectKey:_,value:S,styleSpec:Ce,style:{glyphs:!0,sprite:!0}}))},o.prototype.is3D=function(){return!1},o.prototype.isTileClipped=function(){return!1},o.prototype.hasOffscreenPass=function(){return!1},o.prototype.resize=function(){},o.prototype.isStateDependent=function(){for(var u in this.paint._values){var v=this.paint.get(u);if(v instanceof ps&&Bl(v.property.specification)&&(v.value.kind==="source"||v.value.kind==="composite")&&v.value.isStateDependent)return!0}return!1},o}(Ct),Sc={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},vs=function(o,u){this._structArray=o,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Qa=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Hs(a,o){o===void 0&&(o=1);var u=0,v=0;return{members:a.map(function(_){var S=Sc[_.type].BYTES_PER_ELEMENT,A=u=Cc(u,Math.max(o,S)),R=_.components||1;return v=Math.max(v,S),u+=S*R,{name:_.name,type:_.type,components:R,offset:A}}),size:Cc(u,Math.max(v,o)),alignment:o}}function Cc(a,o){return Math.ceil(a/o)*o}Qa.serialize=function(a,o){return a._trim(),o&&(a.isTransferred=!0,o.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}},Qa.deserialize=function(a){var o=Object.create(this.prototype);return o.arrayBuffer=a.arrayBuffer,o.length=a.length,o.capacity=a.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o},Qa.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Qa.prototype.clear=function(){this.length=0},Qa.prototype.resize=function(a){this.reserve(a),this.length=a},Qa.prototype.reserve=function(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}},Qa.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Wl=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v){var _=this.length;return this.resize(_+1),this.emplace(_,u,v)},o.prototype.emplace=function(u,v,_){var S=2*u;return this.int16[S+0]=v,this.int16[S+1]=_,u},o}(Qa);Wl.prototype.bytesPerElement=4,Kn("StructArrayLayout2i4",Wl);var dl=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_,S){var A=this.length;return this.resize(A+1),this.emplace(A,u,v,_,S)},o.prototype.emplace=function(u,v,_,S,A){var R=4*u;return this.int16[R+0]=v,this.int16[R+1]=_,this.int16[R+2]=S,this.int16[R+3]=A,u},o}(Qa);dl.prototype.bytesPerElement=8,Kn("StructArrayLayout4i8",dl);var Ou=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_,S,A,R){var z=this.length;return this.resize(z+1),this.emplace(z,u,v,_,S,A,R)},o.prototype.emplace=function(u,v,_,S,A,R,z){var W=6*u;return this.int16[W+0]=v,this.int16[W+1]=_,this.int16[W+2]=S,this.int16[W+3]=A,this.int16[W+4]=R,this.int16[W+5]=z,u},o}(Qa);Ou.prototype.bytesPerElement=12,Kn("StructArrayLayout2i4i12",Ou);var Iu=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_,S,A,R){var z=this.length;return this.resize(z+1),this.emplace(z,u,v,_,S,A,R)},o.prototype.emplace=function(u,v,_,S,A,R,z){var W=4*u,q=8*u;return this.int16[W+0]=v,this.int16[W+1]=_,this.uint8[q+4]=S,this.uint8[q+5]=A,this.uint8[q+6]=R,this.uint8[q+7]=z,u},o}(Qa);Iu.prototype.bytesPerElement=8,Kn("StructArrayLayout2i4ub8",Iu);var Pe=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v){var _=this.length;return this.resize(_+1),this.emplace(_,u,v)},o.prototype.emplace=function(u,v,_){var S=2*u;return this.float32[S+0]=v,this.float32[S+1]=_,u},o}(Qa);Pe.prototype.bytesPerElement=8,Kn("StructArrayLayout2f8",Pe);var xu=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_,S,A,R,z,W,q,ne){var ae=this.length;return this.resize(ae+1),this.emplace(ae,u,v,_,S,A,R,z,W,q,ne)},o.prototype.emplace=function(u,v,_,S,A,R,z,W,q,ne,ae){var Te=10*u;return this.uint16[Te+0]=v,this.uint16[Te+1]=_,this.uint16[Te+2]=S,this.uint16[Te+3]=A,this.uint16[Te+4]=R,this.uint16[Te+5]=z,this.uint16[Te+6]=W,this.uint16[Te+7]=q,this.uint16[Te+8]=ne,this.uint16[Te+9]=ae,u},o}(Qa);xu.prototype.bytesPerElement=20,Kn("StructArrayLayout10ui20",xu);var df=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_,S,A,R,z,W,q,ne,ae,Te){var je=this.length;return this.resize(je+1),this.emplace(je,u,v,_,S,A,R,z,W,q,ne,ae,Te)},o.prototype.emplace=function(u,v,_,S,A,R,z,W,q,ne,ae,Te,je){var Be=12*u;return this.int16[Be+0]=v,this.int16[Be+1]=_,this.int16[Be+2]=S,this.int16[Be+3]=A,this.uint16[Be+4]=R,this.uint16[Be+5]=z,this.uint16[Be+6]=W,this.uint16[Be+7]=q,this.int16[Be+8]=ne,this.int16[Be+9]=ae,this.int16[Be+10]=Te,this.int16[Be+11]=je,u},o}(Qa);df.prototype.bytesPerElement=24,Kn("StructArrayLayout4i4ui4i24",df);var su=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_){var S=this.length;return this.resize(S+1),this.emplace(S,u,v,_)},o.prototype.emplace=function(u,v,_,S){var A=3*u;return this.float32[A+0]=v,this.float32[A+1]=_,this.float32[A+2]=S,u},o}(Qa);su.prototype.bytesPerElement=12,Kn("StructArrayLayout3f12",su);var Fa=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u){var v=this.length;return this.resize(v+1),this.emplace(v,u)},o.prototype.emplace=function(u,v){return this.uint32[1*u+0]=v,u},o}(Qa);Fa.prototype.bytesPerElement=4,Kn("StructArrayLayout1ul4",Fa);var rp=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_,S,A,R,z,W,q){var ne=this.length;return this.resize(ne+1),this.emplace(ne,u,v,_,S,A,R,z,W,q)},o.prototype.emplace=function(u,v,_,S,A,R,z,W,q,ne){var ae=10*u,Te=5*u;return this.int16[ae+0]=v,this.int16[ae+1]=_,this.int16[ae+2]=S,this.int16[ae+3]=A,this.int16[ae+4]=R,this.int16[ae+5]=z,this.uint32[Te+3]=W,this.uint16[ae+8]=q,this.uint16[ae+9]=ne,u},o}(Qa);rp.prototype.bytesPerElement=20,Kn("StructArrayLayout6i1ul2ui20",rp);var Zl=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_,S,A,R){var z=this.length;return this.resize(z+1),this.emplace(z,u,v,_,S,A,R)},o.prototype.emplace=function(u,v,_,S,A,R,z){var W=6*u;return this.int16[W+0]=v,this.int16[W+1]=_,this.int16[W+2]=S,this.int16[W+3]=A,this.int16[W+4]=R,this.int16[W+5]=z,u},o}(Qa);Zl.prototype.bytesPerElement=12,Kn("StructArrayLayout2i2i2i12",Zl);var If=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_,S,A){var R=this.length;return this.resize(R+1),this.emplace(R,u,v,_,S,A)},o.prototype.emplace=function(u,v,_,S,A,R){var z=4*u,W=8*u;return this.float32[z+0]=v,this.float32[z+1]=_,this.float32[z+2]=S,this.int16[W+6]=A,this.int16[W+7]=R,u},o}(Qa);If.prototype.bytesPerElement=16,Kn("StructArrayLayout2f1f2i16",If);var Xl=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_,S){var A=this.length;return this.resize(A+1),this.emplace(A,u,v,_,S)},o.prototype.emplace=function(u,v,_,S,A){var R=12*u,z=3*u;return this.uint8[R+0]=v,this.uint8[R+1]=_,this.float32[z+1]=S,this.float32[z+2]=A,u},o}(Qa);Xl.prototype.bytesPerElement=12,Kn("StructArrayLayout2ub2f12",Xl);var wc=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_){var S=this.length;return this.resize(S+1),this.emplace(S,u,v,_)},o.prototype.emplace=function(u,v,_,S){var A=3*u;return this.uint16[A+0]=v,this.uint16[A+1]=_,this.uint16[A+2]=S,u},o}(Qa);wc.prototype.bytesPerElement=6,Kn("StructArrayLayout3ui6",wc);var Ml=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_,S,A,R,z,W,q,ne,ae,Te,je,Be,Je,Qe,Tt){var Zt=this.length;return this.resize(Zt+1),this.emplace(Zt,u,v,_,S,A,R,z,W,q,ne,ae,Te,je,Be,Je,Qe,Tt)},o.prototype.emplace=function(u,v,_,S,A,R,z,W,q,ne,ae,Te,je,Be,Je,Qe,Tt,Zt){var ar=24*u,Lr=12*u,xr=48*u;return this.int16[ar+0]=v,this.int16[ar+1]=_,this.uint16[ar+2]=S,this.uint16[ar+3]=A,this.uint32[Lr+2]=R,this.uint32[Lr+3]=z,this.uint32[Lr+4]=W,this.uint16[ar+10]=q,this.uint16[ar+11]=ne,this.uint16[ar+12]=ae,this.float32[Lr+7]=Te,this.float32[Lr+8]=je,this.uint8[xr+36]=Be,this.uint8[xr+37]=Je,this.uint8[xr+38]=Qe,this.uint32[Lr+10]=Tt,this.int16[ar+22]=Zt,u},o}(Qa);Ml.prototype.bytesPerElement=48,Kn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ml);var Ac=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_,S,A,R,z,W,q,ne,ae,Te,je,Be,Je,Qe,Tt,Zt,ar,Lr,xr,dn,_n,ci,_i,vi,ti,Zi){var Pi=this.length;return this.resize(Pi+1),this.emplace(Pi,u,v,_,S,A,R,z,W,q,ne,ae,Te,je,Be,Je,Qe,Tt,Zt,ar,Lr,xr,dn,_n,ci,_i,vi,ti,Zi)},o.prototype.emplace=function(u,v,_,S,A,R,z,W,q,ne,ae,Te,je,Be,Je,Qe,Tt,Zt,ar,Lr,xr,dn,_n,ci,_i,vi,ti,Zi,Pi){var xi=34*u,Pa=17*u;return this.int16[xi+0]=v,this.int16[xi+1]=_,this.int16[xi+2]=S,this.int16[xi+3]=A,this.int16[xi+4]=R,this.int16[xi+5]=z,this.int16[xi+6]=W,this.int16[xi+7]=q,this.uint16[xi+8]=ne,this.uint16[xi+9]=ae,this.uint16[xi+10]=Te,this.uint16[xi+11]=je,this.uint16[xi+12]=Be,this.uint16[xi+13]=Je,this.uint16[xi+14]=Qe,this.uint16[xi+15]=Tt,this.uint16[xi+16]=Zt,this.uint16[xi+17]=ar,this.uint16[xi+18]=Lr,this.uint16[xi+19]=xr,this.uint16[xi+20]=dn,this.uint16[xi+21]=_n,this.uint16[xi+22]=ci,this.uint32[Pa+12]=_i,this.float32[Pa+13]=vi,this.float32[Pa+14]=ti,this.float32[Pa+15]=Zi,this.float32[Pa+16]=Pi,u},o}(Qa);Ac.prototype.bytesPerElement=68,Kn("StructArrayLayout8i15ui1ul4f68",Ac);var Pl=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u){var v=this.length;return this.resize(v+1),this.emplace(v,u)},o.prototype.emplace=function(u,v){return this.float32[1*u+0]=v,u},o}(Qa);Pl.prototype.bytesPerElement=4,Kn("StructArrayLayout1f4",Pl);var bu=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_){var S=this.length;return this.resize(S+1),this.emplace(S,u,v,_)},o.prototype.emplace=function(u,v,_,S){var A=3*u;return this.int16[A+0]=v,this.int16[A+1]=_,this.int16[A+2]=S,u},o}(Qa);bu.prototype.bytesPerElement=6,Kn("StructArrayLayout3i6",bu);var Xu=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_){var S=this.length;return this.resize(S+1),this.emplace(S,u,v,_)},o.prototype.emplace=function(u,v,_,S){var A=4*u;return this.uint32[2*u+0]=v,this.uint16[A+2]=_,this.uint16[A+3]=S,u},o}(Qa);Xu.prototype.bytesPerElement=8,Kn("StructArrayLayout1ul2ui8",Xu);var Ru=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v){var _=this.length;return this.resize(_+1),this.emplace(_,u,v)},o.prototype.emplace=function(u,v,_){var S=2*u;return this.uint16[S+0]=v,this.uint16[S+1]=_,u},o}(Qa);Ru.prototype.bytesPerElement=4,Kn("StructArrayLayout2ui4",Ru);var Rf=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u){var v=this.length;return this.resize(v+1),this.emplace(v,u)},o.prototype.emplace=function(u,v){return this.uint16[1*u+0]=v,u},o}(Qa);Rf.prototype.bytesPerElement=2,Kn("StructArrayLayout1ui2",Rf);var Oh=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,_,S){var A=this.length;return this.resize(A+1),this.emplace(A,u,v,_,S)},o.prototype.emplace=function(u,v,_,S,A){var R=4*u;return this.float32[R+0]=v,this.float32[R+1]=_,this.float32[R+2]=S,this.float32[R+3]=A,u},o}(Qa);Oh.prototype.bytesPerElement=16,Kn("StructArrayLayout4f16",Oh);var d=function(a){function o(){a.apply(this,arguments)}a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o;var u={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return u.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},u.x1.get=function(){return this._structArray.int16[this._pos2+2]},u.y1.get=function(){return this._structArray.int16[this._pos2+3]},u.x2.get=function(){return this._structArray.int16[this._pos2+4]},u.y2.get=function(){return this._structArray.int16[this._pos2+5]},u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.anchorPoint.get=function(){return new pe(this.anchorPointX,this.anchorPointY)},Object.defineProperties(o.prototype,u),o}(vs);d.prototype.size=20;var f=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.get=function(u){return new d(this,u)},o}(rp);Kn("CollisionBoxArray",f);var l=function(a){function o(){a.apply(this,arguments)}a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},u.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},u.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},u.segment.get=function(){return this._structArray.uint16[this._pos2+10]},u.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},u.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},u.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},u.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},u.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},u.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},u.placedOrientation.set=function(v){this._structArray.uint8[this._pos1+37]=v},u.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},u.hidden.set=function(v){this._structArray.uint8[this._pos1+38]=v},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},u.crossTileID.set=function(v){this._structArray.uint32[this._pos4+10]=v},u.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(o.prototype,u),o}(vs);l.prototype.size=48;var m=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.get=function(u){return new l(this,u)},o}(Ml);Kn("PlacedSymbolArray",m);var C=function(a){function o(){a.apply(this,arguments)}a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},u.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},u.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},u.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},u.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},u.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},u.key.get=function(){return this._structArray.uint16[this._pos2+8]},u.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},u.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},u.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},u.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},u.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},u.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},u.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},u.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},u.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},u.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},u.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},u.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},u.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},u.crossTileID.set=function(v){this._structArray.uint32[this._pos4+12]=v},u.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},u.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},u.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},u.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(o.prototype,u),o}(vs);C.prototype.size=68;var P=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.get=function(u){return new C(this,u)},o}(Ac);Kn("SymbolInstanceArray",P);var D=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.getoffsetX=function(u){return this.float32[1*u+0]},o}(Pl);Kn("GlyphOffsetArray",D);var N=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.getx=function(u){return this.int16[3*u+0]},o.prototype.gety=function(u){return this.int16[3*u+1]},o.prototype.gettileUnitDistanceFromAnchor=function(u){return this.int16[3*u+2]},o}(bu);Kn("SymbolLineVertexArray",N);var K=function(a){function o(){a.apply(this,arguments)}a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o;var u={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(o.prototype,u),o}(vs);K.prototype.size=8;var re=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.get=function(u){return new K(this,u)},o}(Xu);Kn("FeatureIndexArray",re);var ge=Hs([{name:"a_pos",components:2,type:"Int16"}],4).members,ye=function(o){o===void 0&&(o=[]),this.segments=o};function we(a,o){return 256*(a=yt(Math.floor(a),0,255))+yt(Math.floor(o),0,255)}ye.prototype.prepareSegment=function(a,o,u,v){var _=this.segments[this.segments.length-1];return a>ye.MAX_VERTEX_ARRAY_LENGTH&&Kt("Max vertices per segment is "+ye.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+a),(!_||_.vertexLength+a>ye.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==v)&&(_={vertexOffset:o.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},v!==void 0&&(_.sortKey=v),this.segments.push(_)),_},ye.prototype.get=function(){return this.segments},ye.prototype.destroy=function(){for(var a=0,o=this.segments;a<o.length;a+=1){var u=o[a];for(var v in u.vaos)u.vaos[v].destroy()}},ye.simpleSegment=function(a,o,u,v){return new ye([{vertexOffset:a,primitiveOffset:o,vertexLength:u,primitiveLength:v,vaos:{},sortKey:0}])},ye.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Kn("SegmentVector",ye);var We=Hs([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Ue=V(function(a){a.exports=function(o,u){var v,_,S,A,R,z,W,q;for(_=o.length-(v=3&o.length),S=u,R=3432918353,z=461845907,q=0;q<_;)W=255&o.charCodeAt(q)|(255&o.charCodeAt(++q))<<8|(255&o.charCodeAt(++q))<<16|(255&o.charCodeAt(++q))<<24,++q,S=27492+(65535&(A=5*(65535&(S=(S^=W=(65535&(W=(W=(65535&W)*R+(((W>>>16)*R&65535)<<16)&4294967295)<<15|W>>>17))*z+(((W>>>16)*z&65535)<<16)&4294967295)<<13|S>>>19))+((5*(S>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(W=0,v){case 3:W^=(255&o.charCodeAt(q+2))<<16;case 2:W^=(255&o.charCodeAt(q+1))<<8;case 1:S^=W=(65535&(W=(W=(65535&(W^=255&o.charCodeAt(q)))*R+(((W>>>16)*R&65535)<<16)&4294967295)<<15|W>>>17))*z+(((W>>>16)*z&65535)<<16)&4294967295}return S^=o.length,S=2246822507*(65535&(S^=S>>>16))+((2246822507*(S>>>16)&65535)<<16)&4294967295,S=3266489909*(65535&(S^=S>>>13))+((3266489909*(S>>>16)&65535)<<16)&4294967295,(S^=S>>>16)>>>0}}),tt=V(function(a){a.exports=function(o,u){for(var v,_=o.length,S=u^_,A=0;_>=4;)v=1540483477*(65535&(v=255&o.charCodeAt(A)|(255&o.charCodeAt(++A))<<8|(255&o.charCodeAt(++A))<<16|(255&o.charCodeAt(++A))<<24))+((1540483477*(v>>>16)&65535)<<16),S=1540483477*(65535&S)+((1540483477*(S>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),_-=4,++A;switch(_){case 3:S^=(255&o.charCodeAt(A+2))<<16;case 2:S^=(255&o.charCodeAt(A+1))<<8;case 1:S=1540483477*(65535&(S^=255&o.charCodeAt(A)))+((1540483477*(S>>>16)&65535)<<16)}return S=1540483477*(65535&(S^=S>>>13))+((1540483477*(S>>>16)&65535)<<16),(S^=S>>>15)>>>0}}),Ze=Ue,$e=tt;Ze.murmur3=Ue,Ze.murmur2=$e;var Ot=function(){this.ids=[],this.positions=[],this.indexed=!1};Ot.prototype.add=function(a,o,u,v){this.ids.push(Sr(a)),this.positions.push(o,u,v)},Ot.prototype.getPositions=function(a){for(var o=Sr(a),u=0,v=this.ids.length-1;u<v;){var _=u+v>>1;this.ids[_]>=o?v=_:u=_+1}for(var S=[];this.ids[u]===o;)S.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return S},Ot.serialize=function(a,o){var u=new Float64Array(a.ids),v=new Uint32Array(a.positions);return function _(S,A,R,z){for(;R<z;){for(var W=S[R+z>>1],q=R-1,ne=z+1;;){do q++;while(S[q]<W);do ne--;while(S[ne]>W);if(q>=ne)break;qt(S,q,ne),qt(A,3*q,3*ne),qt(A,3*q+1,3*ne+1),qt(A,3*q+2,3*ne+2)}ne-R<z-ne?(_(S,A,R,ne),R=ne+1):(_(S,A,ne+1,z),z=ne)}}(u,v,0,u.length-1),o&&o.push(u.buffer,v.buffer),{ids:u,positions:v}},Ot.deserialize=function(a){var o=new Ot;return o.ids=a.ids,o.positions=a.positions,o.indexed=!0,o};var Mt=Math.pow(2,53)-1;function Sr(a){var o=+a;return!isNaN(o)&&o<=Mt?o:Ze(String(a))}function qt(a,o,u){var v=a[o];a[o]=a[u],a[u]=v}Kn("FeaturePositionMap",Ot);var gr=function(o,u){this.gl=o.gl,this.location=u},Tr=function(a){function o(u,v){a.call(this,u,v),this.current=0}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))},o}(gr),Dr=function(a){function o(u,v){a.call(this,u,v),this.current=0}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))},o}(gr),nn=function(a){function o(u,v){a.call(this,u,v),this.current=[0,0]}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))},o}(gr),An=function(a){function o(u,v){a.call(this,u,v),this.current=[0,0,0]}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))},o}(gr),Vn=function(a){function o(u,v){a.call(this,u,v),this.current=[0,0,0,0]}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))},o}(gr),mi=function(a){function o(u,v){a.call(this,u,v),this.current=Bi.transparent}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))},o}(gr),yi=new Float32Array(16),Ni=function(a){function o(u,v){a.call(this,u,v),this.current=yi}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.set=function(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(var v=1;v<16;v++)if(u[v]!==this.current[v]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}},o}(gr);function Ii(a){return[we(255*a.r,255*a.g),we(255*a.b,255*a.a)]}var $n=function(o,u,v){this.value=o,this.uniformNames=u.map(function(_){return"u_"+_}),this.type=v};$n.prototype.setUniform=function(a,o,u){a.set(u.constantOr(this.value))},$n.prototype.getBinding=function(a,o,u){return this.type==="color"?new mi(a,o):new Dr(a,o)};var zi=function(o,u){this.uniformNames=u.map(function(v){return"u_"+v}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};zi.prototype.setConstantPatternPositions=function(a,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=a.tlbr},zi.prototype.setUniform=function(a,o,u,v){var _=v==="u_pattern_to"?this.patternTo:v==="u_pattern_from"?this.patternFrom:v==="u_pixel_ratio_to"?this.pixelRatioTo:v==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&a.set(_)},zi.prototype.getBinding=function(a,o,u){return u.substr(0,9)==="u_pattern"?new Vn(a,o):new Dr(a,o)};var Wi=function(o,u,v,_){this.expression=o,this.type=v,this.maxValue=0,this.paintVertexAttributes=u.map(function(S){return{name:"a_"+S,type:"Float32",components:v==="color"?2:1,offset:0}}),this.paintVertexArray=new _};Wi.prototype.populatePaintArray=function(a,o,u,v,_){var S=this.paintVertexArray.length,A=this.expression.evaluate(new ma(0),o,{},v,[],_);this.paintVertexArray.resize(a),this._setPaintValue(S,a,A)},Wi.prototype.updatePaintArray=function(a,o,u,v){var _=this.expression.evaluate({zoom:0},u,v);this._setPaintValue(a,o,_)},Wi.prototype._setPaintValue=function(a,o,u){if(this.type==="color")for(var v=Ii(u),_=a;_<o;_++)this.paintVertexArray.emplace(_,v[0],v[1]);else{for(var S=a;S<o;S++)this.paintVertexArray.emplace(S,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}},Wi.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Wi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ui=function(o,u,v,_,S,A){this.expression=o,this.uniformNames=u.map(function(R){return"u_"+R+"_t"}),this.type=v,this.useIntegerZoom=_,this.zoom=S,this.maxValue=0,this.paintVertexAttributes=u.map(function(R){return{name:"a_"+R,type:"Float32",components:v==="color"?4:2,offset:0}}),this.paintVertexArray=new A};ui.prototype.populatePaintArray=function(a,o,u,v,_){var S=this.expression.evaluate(new ma(this.zoom),o,{},v,[],_),A=this.expression.evaluate(new ma(this.zoom+1),o,{},v,[],_),R=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(R,a,S,A)},ui.prototype.updatePaintArray=function(a,o,u,v){var _=this.expression.evaluate({zoom:this.zoom},u,v),S=this.expression.evaluate({zoom:this.zoom+1},u,v);this._setPaintValue(a,o,_,S)},ui.prototype._setPaintValue=function(a,o,u,v){if(this.type==="color")for(var _=Ii(u),S=Ii(v),A=a;A<o;A++)this.paintVertexArray.emplace(A,_[0],_[1],S[0],S[1]);else{for(var R=a;R<o;R++)this.paintVertexArray.emplace(R,u,v);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(v))}},ui.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ui.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ui.prototype.setUniform=function(a,o){var u=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,v=yt(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);a.set(v)},ui.prototype.getBinding=function(a,o,u){return new Dr(a,o)};var ea=function(o,u,v,_,S,A){this.expression=o,this.type=u,this.useIntegerZoom=v,this.zoom=_,this.layerId=A,this.zoomInPaintVertexArray=new S,this.zoomOutPaintVertexArray=new S};ea.prototype.populatePaintArray=function(a,o,u){var v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(v,a,o.patterns&&o.patterns[this.layerId],u)},ea.prototype.updatePaintArray=function(a,o,u,v,_){this._setPaintValues(a,o,u.patterns&&u.patterns[this.layerId],_)},ea.prototype._setPaintValues=function(a,o,u,v){if(v&&u){var _=v[u.min],S=v[u.mid],A=v[u.max];if(_&&S&&A)for(var R=a;R<o;R++)this.zoomInPaintVertexArray.emplace(R,S.tl[0],S.tl[1],S.br[0],S.br[1],_.tl[0],_.tl[1],_.br[0],_.br[1],S.pixelRatio,_.pixelRatio),this.zoomOutPaintVertexArray.emplace(R,S.tl[0],S.tl[1],S.br[0],S.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],S.pixelRatio,A.pixelRatio)}},ea.prototype.upload=function(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,We.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,We.members,this.expression.isStateDependent))},ea.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ai=function(o,u,v){this.binders={},this._buffers=[];var _=[];for(var S in o.paint._values)if(v(S)){var A=o.paint.get(S);if(A instanceof ps&&Bl(A.property.specification)){var R=wa(S,o.type),z=A.value,W=A.property.specification.type,q=A.property.useIntegerZoom,ne=A.property.specification["property-type"],ae=ne==="cross-faded"||ne==="cross-faded-data-driven";if(z.kind==="constant")this.binders[S]=ae?new zi(z.value,R):new $n(z.value,R,W),_.push("/u_"+S);else if(z.kind==="source"||ae){var Te=rs(S,W,"source");this.binders[S]=ae?new ea(z,W,q,u,Te,o.id):new Wi(z,R,W,Te),_.push("/a_"+S)}else{var je=rs(S,W,"composite");this.binders[S]=new ui(z,R,W,q,u,je),_.push("/z_"+S)}}}this.cacheKey=_.sort().join("")};Ai.prototype.getMaxValue=function(a){var o=this.binders[a];return o instanceof Wi||o instanceof ui?o.maxValue:0},Ai.prototype.populatePaintArrays=function(a,o,u,v,_){for(var S in this.binders){var A=this.binders[S];(A instanceof Wi||A instanceof ui||A instanceof ea)&&A.populatePaintArray(a,o,u,v,_)}},Ai.prototype.setConstantPatternPositions=function(a,o){for(var u in this.binders){var v=this.binders[u];v instanceof zi&&v.setConstantPatternPositions(a,o)}},Ai.prototype.updatePaintArrays=function(a,o,u,v,_){var S=!1;for(var A in a)for(var R=0,z=o.getPositions(A);R<z.length;R+=1){var W=z[R],q=u.feature(W.index);for(var ne in this.binders){var ae=this.binders[ne];if((ae instanceof Wi||ae instanceof ui||ae instanceof ea)&&ae.expression.isStateDependent===!0){var Te=v.paint.get(ne);ae.expression=Te.value,ae.updatePaintArray(W.start,W.end,q,a[A],_),S=!0}}}return S},Ai.prototype.defines=function(){var a=[];for(var o in this.binders){var u=this.binders[o];(u instanceof $n||u instanceof zi)&&a.push.apply(a,u.uniformNames.map(function(v){return"#define HAS_UNIFORM_"+v}))}return a},Ai.prototype.getBinderAttributes=function(){var a=[];for(var o in this.binders){var u=this.binders[o];if(u instanceof Wi||u instanceof ui)for(var v=0;v<u.paintVertexAttributes.length;v++)a.push(u.paintVertexAttributes[v].name);else if(u instanceof ea)for(var _=0;_<We.members.length;_++)a.push(We.members[_].name)}return a},Ai.prototype.getBinderUniforms=function(){var a=[];for(var o in this.binders){var u=this.binders[o];if(u instanceof $n||u instanceof zi||u instanceof ui)for(var v=0,_=u.uniformNames;v<_.length;v+=1)a.push(_[v])}return a},Ai.prototype.getPaintVertexBuffers=function(){return this._buffers},Ai.prototype.getUniforms=function(a,o){var u=[];for(var v in this.binders){var _=this.binders[v];if(_ instanceof $n||_ instanceof zi||_ instanceof ui)for(var S=0,A=_.uniformNames;S<A.length;S+=1){var R=A[S];if(o[R]){var z=_.getBinding(a,o[R],R);u.push({name:R,property:v,binding:z})}}}return u},Ai.prototype.setUniforms=function(a,o,u,v){for(var _=0,S=o;_<S.length;_+=1){var A=S[_],R=A.name,z=A.property;this.binders[z].setUniform(A.binding,v,u.get(z),R)}},Ai.prototype.updatePaintBuffers=function(a){for(var o in this._buffers=[],this.binders){var u=this.binders[o];if(a&&u instanceof ea){var v=a.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(u instanceof Wi||u instanceof ui)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}},Ai.prototype.upload=function(a){for(var o in this.binders){var u=this.binders[o];(u instanceof Wi||u instanceof ui||u instanceof ea)&&u.upload(a)}this.updatePaintBuffers()},Ai.prototype.destroy=function(){for(var a in this.binders){var o=this.binders[a];(o instanceof Wi||o instanceof ui||o instanceof ea)&&o.destroy()}};var na=function(o,u,v){v===void 0&&(v=function(){return!0}),this.programConfigurations={};for(var _=0,S=o;_<S.length;_+=1){var A=S[_];this.programConfigurations[A.id]=new Ai(A,u,v)}this.needsUpload=!1,this._featureMap=new Ot,this._bufferOffset=0};function wa(a,o){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(o+"-","").replace(/-/g,"_")]}function rs(a,o,u){var v={color:{source:Pe,composite:Oh},number:{source:Pl,composite:Pe}},_=function(S){return{"line-pattern":{source:xu,composite:xu},"fill-pattern":{source:xu,composite:xu},"fill-extrusion-pattern":{source:xu,composite:xu}}[S]}(a);return _&&_[u]||v[o][u]}na.prototype.populatePaintArrays=function(a,o,u,v,_,S){for(var A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(a,o,v,_,S);o.id!==void 0&&this._featureMap.add(o.id,u,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0},na.prototype.updatePaintArrays=function(a,o,u,v){for(var _=0,S=u;_<S.length;_+=1){var A=S[_];this.needsUpload=this.programConfigurations[A.id].updatePaintArrays(a,this._featureMap,o,A,v)||this.needsUpload}},na.prototype.get=function(a){return this.programConfigurations[a]},na.prototype.upload=function(a){if(this.needsUpload){for(var o in this.programConfigurations)this.programConfigurations[o].upload(a);this.needsUpload=!1}},na.prototype.destroy=function(){for(var a in this.programConfigurations)this.programConfigurations[a].destroy()},Kn("ConstantBinder",$n),Kn("CrossFadedConstantBinder",zi),Kn("SourceExpressionBinder",Wi),Kn("CrossFadedCompositeBinder",ea),Kn("CompositeExpressionBinder",ui),Kn("ProgramConfiguration",Ai,{omit:["_buffers"]}),Kn("ProgramConfigurationSet",na);var ka=Math.pow(2,14)-1,ms=-ka-1;function Oo(a){for(var o=8192/a.extent,u=a.loadGeometry(),v=0;v<u.length;v++)for(var _=u[v],S=0;S<_.length;S++){var A=_[S],R=Math.round(A.x*o),z=Math.round(A.y*o);A.x=yt(R,ms,ka),A.y=yt(z,ms,ka),(R<A.x||R>A.x+1||z<A.y||z>A.y+1)&&Kt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return u}function Ja(a,o){return{type:a.type,id:a.id,properties:a.properties,geometry:o?Oo(a):[]}}function Eu(a,o,u,v,_){a.emplaceBack(2*o+(v+1)/2,2*u+(_+1)/2)}var ho=function(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new Wl,this.indexArray=new wc,this.segments=new ye,this.programConfigurations=new na(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};function Yu(a,o){for(var u=0;u<a.length;u++)if(ku(o,a[u]))return!0;for(var v=0;v<o.length;v++)if(ku(a,o[v]))return!0;return!!Es(a,o)}function Su(a,o,u){return!!ku(a,o)||!!oc(o,a,u)}function go(a,o){if(a.length===1)return Tc(o,a[0]);for(var u=0;u<o.length;u++)for(var v=o[u],_=0;_<v.length;_++)if(ku(a,v[_]))return!0;for(var S=0;S<a.length;S++)if(Tc(o,a[S]))return!0;for(var A=0;A<o.length;A++)if(Es(a,o[A]))return!0;return!1}function Ws(a,o,u){if(a.length>1){if(Es(a,o))return!0;for(var v=0;v<o.length;v++)if(oc(o[v],a,u))return!0}for(var _=0;_<a.length;_++)if(oc(a[_],o,u))return!0;return!1}function Es(a,o){if(a.length===0||o.length===0)return!1;for(var u=0;u<a.length-1;u++)for(var v=a[u],_=a[u+1],S=0;S<o.length-1;S++)if(Lu(v,_,o[S],o[S+1]))return!0;return!1}function Lu(a,o,u,v){return vr(a,u,v)!==vr(o,u,v)&&vr(a,o,u)!==vr(a,o,v)}function oc(a,o,u){var v=u*u;if(o.length===1)return a.distSqr(o[0])<v;for(var _=1;_<o.length;_++)if(sc(a,o[_-1],o[_])<v)return!0;return!1}function sc(a,o,u){var v=o.distSqr(u);if(v===0)return a.distSqr(o);var _=((a.x-o.x)*(u.x-o.x)+(a.y-o.y)*(u.y-o.y))/v;return a.distSqr(_<0?o:_>1?u:u.sub(o)._mult(_)._add(o))}function Tc(a,o){for(var u,v,_,S=!1,A=0;A<a.length;A++)for(var R=0,z=(u=a[A]).length-1;R<u.length;z=R++)(v=u[R]).y>o.y!=(_=u[z]).y>o.y&&o.x<(_.x-v.x)*(o.y-v.y)/(_.y-v.y)+v.x&&(S=!S);return S}function ku(a,o){for(var u=!1,v=0,_=a.length-1;v<a.length;_=v++){var S=a[v],A=a[_];S.y>o.y!=A.y>o.y&&o.x<(A.x-S.x)*(o.y-S.y)/(A.y-S.y)+S.x&&(u=!u)}return u}function Xc(a,o,u){var v=u[0],_=u[2];if(a.x<v.x&&o.x<v.x||a.x>_.x&&o.x>_.x||a.y<v.y&&o.y<v.y||a.y>_.y&&o.y>_.y)return!1;var S=vr(a,o,u[0]);return S!==vr(a,o,u[1])||S!==vr(a,o,u[2])||S!==vr(a,o,u[3])}function Ol(a,o,u){var v=o.paint.get(a).value;return v.kind==="constant"?v.value:u.programConfigurations.get(o.id).getMaxValue(a)}function Ps(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Ku(a,o,u,v,_){if(!o[0]&&!o[1])return a;var S=pe.convert(o)._mult(_);u==="viewport"&&S._rotate(-v);for(var A=[],R=0;R<a.length;R++)A.push(a[R].sub(S));return A}ho.prototype.populate=function(a,o,u){var v=this.layers[0],_=[],S=null;v.type==="circle"&&(S=v.layout.get("circle-sort-key"));for(var A=0,R=a;A<R.length;A+=1){var z=R[A],W=z.feature,q=z.id,ne=z.index,ae=z.sourceLayerIndex,Te=this.layers[0]._featureFilter.needGeometry,je=Ja(W,Te);if(this.layers[0]._featureFilter.filter(new ma(this.zoom),je,u)){var Be=S?S.evaluate(je,{},u):void 0,Je={id:q,properties:W.properties,type:W.type,sourceLayerIndex:ae,index:ne,geometry:Te?je.geometry:Oo(W),patterns:{},sortKey:Be};_.push(Je)}}S&&_.sort(function(_n,ci){return _n.sortKey-ci.sortKey});for(var Qe=0,Tt=_;Qe<Tt.length;Qe+=1){var Zt=Tt[Qe],ar=Zt.geometry,Lr=Zt.index,xr=Zt.sourceLayerIndex,dn=a[Lr].feature;this.addFeature(Zt,ar,Lr,u),o.featureIndex.insert(dn,ar,Lr,xr,this.index)}},ho.prototype.update=function(a,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,o,this.stateDependentLayers,u)},ho.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ho.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ho.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,ge),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},ho.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ho.prototype.addFeature=function(a,o,u,v){for(var _=0,S=o;_<S.length;_+=1)for(var A=0,R=S[_];A<R.length;A+=1){var z=R[A],W=z.x,q=z.y;if(!(W<0||W>=8192||q<0||q>=8192)){var ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),ae=ne.vertexLength;Eu(this.layoutVertexArray,W,q,-1,-1),Eu(this.layoutVertexArray,W,q,1,-1),Eu(this.layoutVertexArray,W,q,1,1),Eu(this.layoutVertexArray,W,q,-1,1),this.indexArray.emplaceBack(ae,ae+1,ae+2),this.indexArray.emplaceBack(ae,ae+3,ae+2),ne.vertexLength+=4,ne.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,u,{},v)},Kn("CircleBucket",ho,{omit:["layers"]});var rh=new ds({"circle-sort-key":new si(Ce.layout_circle["circle-sort-key"])}),uc={paint:new ds({"circle-radius":new si(Ce.paint_circle["circle-radius"]),"circle-color":new si(Ce.paint_circle["circle-color"]),"circle-blur":new si(Ce.paint_circle["circle-blur"]),"circle-opacity":new si(Ce.paint_circle["circle-opacity"]),"circle-translate":new bi(Ce.paint_circle["circle-translate"]),"circle-translate-anchor":new bi(Ce.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new bi(Ce.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new bi(Ce.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new si(Ce.paint_circle["circle-stroke-width"]),"circle-stroke-color":new si(Ce.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new si(Ce.paint_circle["circle-stroke-opacity"])}),layout:rh},Ss=typeof Float32Array!="undefined"?Float32Array:Array;function Cu(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Fs(a,o,u){var v=o[0],_=o[1],S=o[2],A=o[3],R=o[4],z=o[5],W=o[6],q=o[7],ne=o[8],ae=o[9],Te=o[10],je=o[11],Be=o[12],Je=o[13],Qe=o[14],Tt=o[15],Zt=u[0],ar=u[1],Lr=u[2],xr=u[3];return a[0]=Zt*v+ar*R+Lr*ne+xr*Be,a[1]=Zt*_+ar*z+Lr*ae+xr*Je,a[2]=Zt*S+ar*W+Lr*Te+xr*Qe,a[3]=Zt*A+ar*q+Lr*je+xr*Tt,a[4]=(Zt=u[4])*v+(ar=u[5])*R+(Lr=u[6])*ne+(xr=u[7])*Be,a[5]=Zt*_+ar*z+Lr*ae+xr*Je,a[6]=Zt*S+ar*W+Lr*Te+xr*Qe,a[7]=Zt*A+ar*q+Lr*je+xr*Tt,a[8]=(Zt=u[8])*v+(ar=u[9])*R+(Lr=u[10])*ne+(xr=u[11])*Be,a[9]=Zt*_+ar*z+Lr*ae+xr*Je,a[10]=Zt*S+ar*W+Lr*Te+xr*Qe,a[11]=Zt*A+ar*q+Lr*je+xr*Tt,a[12]=(Zt=u[12])*v+(ar=u[13])*R+(Lr=u[14])*ne+(xr=u[15])*Be,a[13]=Zt*_+ar*z+Lr*ae+xr*Je,a[14]=Zt*S+ar*W+Lr*Te+xr*Qe,a[15]=Zt*A+ar*q+Lr*je+xr*Tt,a}Math.hypot||(Math.hypot=function(){for(var a=arguments,o=0,u=arguments.length;u--;)o+=a[u]*a[u];return Math.sqrt(o)});var Du,Bs=Fs;function Fu(a,o,u){var v=o[0],_=o[1],S=o[2],A=o[3];return a[0]=u[0]*v+u[4]*_+u[8]*S+u[12]*A,a[1]=u[1]*v+u[5]*_+u[9]*S+u[13]*A,a[2]=u[2]*v+u[6]*_+u[10]*S+u[14]*A,a[3]=u[3]*v+u[7]*_+u[11]*S+u[15]*A,a}Du=new Ss(3),Ss!=Float32Array&&(Du[0]=0,Du[1]=0,Du[2]=0),function(){var a=new Ss(4);Ss!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0)}();var vf=(function(){var a=new Ss(2);Ss!=Float32Array&&(a[0]=0,a[1]=0)}(),function(a){function o(u){a.call(this,u,uc)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.createBucket=function(u){return new ho(u)},o.prototype.queryRadius=function(u){var v=u;return Ol("circle-radius",this,v)+Ol("circle-stroke-width",this,v)+Ps(this.paint.get("circle-translate"))},o.prototype.queryIntersectsFeature=function(u,v,_,S,A,R,z,W){for(var q=Ku(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),R.angle,z),ne=this.paint.get("circle-radius").evaluate(v,_)+this.paint.get("circle-stroke-width").evaluate(v,_),ae=this.paint.get("circle-pitch-alignment")==="map",Te=ae?q:function(dn,_n){return dn.map(function(ci){return Yc(ci,_n)})}(q,W),je=ae?ne*z:ne,Be=0,Je=S;Be<Je.length;Be+=1)for(var Qe=0,Tt=Je[Be];Qe<Tt.length;Qe+=1){var Zt=Tt[Qe],ar=ae?Zt:Yc(Zt,W),Lr=je,xr=Fu([],[Zt.x,Zt.y,0,1],W);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Lr*=xr[3]/R.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Lr*=R.cameraToCenterDistance/xr[3]),Su(Te,ar,Lr))return!0}return!1},o}(nl));function Yc(a,o){var u=Fu([],[a.x,a.y,0,1],o);return new pe(u[0]/u[3],u[1]/u[3])}var Kc=function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o}(ho);function Yl(a,o,u,v){var _=o.width,S=o.height;if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==_*S*u)throw new RangeError("mismatched image size")}else v=new Uint8Array(_*S*u);return a.width=_,a.height=S,a.data=v,a}function lc(a,o,u){var v=o.width,_=o.height;if(v!==a.width||_!==a.height){var S=Yl({},{width:v,height:_},u);vl(a,S,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,v),height:Math.min(a.height,_)},u),a.width=v,a.height=_,a.data=S.data}}function vl(a,o,u,v,_,S){if(_.width===0||_.height===0)return o;if(_.width>a.width||_.height>a.height||u.x>a.width-_.width||u.y>a.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>o.width||_.height>o.height||v.x>o.width-_.width||v.y>o.height-_.height)throw new RangeError("out of range destination coordinates for image copy");for(var A=a.data,R=o.data,z=0;z<_.height;z++)for(var W=((u.y+z)*a.width+u.x)*S,q=((v.y+z)*o.width+v.x)*S,ne=0;ne<_.width*S;ne++)R[q+ne]=A[W+ne];return o}Kn("HeatmapBucket",Kc,{omit:["layers"]});var Zs=function(o,u){Yl(this,o,1,u)};Zs.prototype.resize=function(a){lc(this,a,1)},Zs.prototype.clone=function(){return new Zs({width:this.width,height:this.height},new Uint8Array(this.data))},Zs.copy=function(a,o,u,v,_){vl(a,o,u,v,_,1)};var Xs=function(o,u){Yl(this,o,4,u)};Xs.prototype.resize=function(a){lc(this,a,4)},Xs.prototype.replace=function(a,o){o?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a},Xs.prototype.clone=function(){return new Xs({width:this.width,height:this.height},new Uint8Array(this.data))},Xs.copy=function(a,o,u,v,_){vl(a,o,u,v,_,4)},Kn("AlphaImage",Zs),Kn("RGBAImage",Xs);var np={paint:new ds({"heatmap-radius":new si(Ce.paint_heatmap["heatmap-radius"]),"heatmap-weight":new si(Ce.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new bi(Ce.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Zu(Ce.paint_heatmap["heatmap-color"]),"heatmap-opacity":new bi(Ce.paint_heatmap["heatmap-opacity"])})};function nh(a){var o={},u=a.resolution||256,v=a.clips?a.clips.length:1,_=a.image||new Xs({width:u,height:v}),S=function(Be,Je,Qe){o[a.evaluationKey]=Qe;var Tt=a.expression.evaluate(o);_.data[Be+Je+0]=Math.floor(255*Tt.r/Tt.a),_.data[Be+Je+1]=Math.floor(255*Tt.g/Tt.a),_.data[Be+Je+2]=Math.floor(255*Tt.b/Tt.a),_.data[Be+Je+3]=Math.floor(255*Tt.a)};if(a.clips)for(var A=0,R=0;A<v;++A,R+=4*u)for(var z=0,W=0;z<u;z++,W+=4){var q=z/(u-1),ne=a.clips[A];S(R,W,ne.start*(1-q)+ne.end*q)}else for(var ae=0,Te=0;ae<u;ae++,Te+=4)S(0,Te,ae/(u-1));return _}var $p=function(a){function o(u){a.call(this,u,np),this._updateColorRamp()}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.createBucket=function(u){return new Kc(u)},o.prototype._handleSpecialPaintPropertyUpdate=function(u){u==="heatmap-color"&&this._updateColorRamp()},o.prototype._updateColorRamp=function(){this.colorRamp=nh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},o.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},o.prototype.queryRadius=function(){return 0},o.prototype.queryIntersectsFeature=function(){return!1},o.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},o}(nl),Tp={paint:new ds({"hillshade-illumination-direction":new bi(Ce.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new bi(Ce.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new bi(Ce.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new bi(Ce.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new bi(Ce.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new bi(Ce.paint_hillshade["hillshade-accent-color"])})},Ih=function(a){function o(u){a.call(this,u,Tp)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},o}(nl),Lf=Hs([{name:"a_pos",components:2,type:"Int16"}],4).members,mf=ip,qp=ip;function ip(a,o,u){u=u||2;var v,_,S,A,R,z,W,q=o&&o.length,ne=q?o[0]*u:a.length,ae=ap(a,0,ne,u,!0),Te=[];if(!ae||ae.next===ae.prev)return Te;if(q&&(ae=function(Be,Je,Qe,Tt){var Zt,ar,Lr,xr=[];for(Zt=0,ar=Je.length;Zt<ar;Zt++)(Lr=ap(Be,Je[Zt]*Tt,Zt<ar-1?Je[Zt+1]*Tt:Be.length,Tt,!1))===Lr.next&&(Lr.steiner=!0),xr.push(Jp(Lr));for(xr.sort(Qp),Zt=0;Zt<xr.length;Zt++)cc(xr[Zt],Qe),Qe=ba(Qe,Qe.next);return Qe}(a,o,ae,u)),a.length>80*u){v=S=a[0],_=A=a[1];for(var je=u;je<ne;je+=u)(R=a[je])<v&&(v=R),(z=a[je+1])<_&&(_=z),R>S&&(S=R),z>A&&(A=z);W=(W=Math.max(S-v,A-_))!==0?1/W:0}return Rh(ae,Te,u,v,_,W),Te}function ap(a,o,u,v,_){var S,A;if(_===Il(a,o,u,v)>0)for(S=o;S<u;S+=v)A=sh(S,a[S],a[S+1],A);else for(S=u-v;S>=o;S-=v)A=sh(S,a[S],a[S+1],A);return A&&Mc(A,A.next)&&($c(A),A=A.next),A}function ba(a,o){if(!a)return a;o||(o=a);var u,v=a;do if(u=!1,v.steiner||!Mc(v,v.next)&&Cr(v.prev,v,v.next)!==0)v=v.next;else{if($c(v),(v=o=v.prev)===v.next)break;u=!0}while(u||v!==o);return o}function Rh(a,o,u,v,_,S,A){if(a){!A&&S&&function(q,ne,ae,Te){var je=q;do je.z===null&&(je.z=Lh(je.x,je.y,ne,ae,Te)),je.prevZ=je.prev,je.nextZ=je.next,je=je.next;while(je!==q);je.prevZ.nextZ=null,je.prevZ=null,function(Be){var Je,Qe,Tt,Zt,ar,Lr,xr,dn,_n=1;do{for(Qe=Be,Be=null,ar=null,Lr=0;Qe;){for(Lr++,Tt=Qe,xr=0,Je=0;Je<_n&&(xr++,Tt=Tt.nextZ);Je++);for(dn=_n;xr>0||dn>0&&Tt;)xr!==0&&(dn===0||!Tt||Qe.z<=Tt.z)?(Zt=Qe,Qe=Qe.nextZ,xr--):(Zt=Tt,Tt=Tt.nextZ,dn--),ar?ar.nextZ=Zt:Be=Zt,Zt.prevZ=ar,ar=Zt;Qe=Tt}ar.nextZ=null,_n*=2}while(Lr>1)}(je)}(a,v,_,S);for(var R,z,W=a;a.prev!==a.next;)if(R=a.prev,z=a.next,S?ah(a,v,_,S):ih(a))o.push(R.i/u),o.push(a.i/u),o.push(z.i/u),$c(a),a=z.next,W=z.next;else if((a=z)===W){A?A===1?Rh(a=wd(ba(a),o,u),o,u,v,_,S,2):A===2&&Ad(a,o,u,v,_,S):Rh(ba(a),o,u,v,_,S,1);break}}}function ih(a){var o=a.prev,u=a,v=a.next;if(Cr(o,u,v)>=0)return!1;for(var _=a.next.next;_!==a.prev;){if(oh(o.x,o.y,u.x,u.y,v.x,v.y,_.x,_.y)&&Cr(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function ah(a,o,u,v){var _=a.prev,S=a,A=a.next;if(Cr(_,S,A)>=0)return!1;for(var R=_.x>S.x?_.x>A.x?_.x:A.x:S.x>A.x?S.x:A.x,z=_.y>S.y?_.y>A.y?_.y:A.y:S.y>A.y?S.y:A.y,W=Lh(_.x<S.x?_.x<A.x?_.x:A.x:S.x<A.x?S.x:A.x,_.y<S.y?_.y<A.y?_.y:A.y:S.y<A.y?S.y:A.y,o,u,v),q=Lh(R,z,o,u,v),ne=a.prevZ,ae=a.nextZ;ne&&ne.z>=W&&ae&&ae.z<=q;){if(ne!==a.prev&&ne!==a.next&&oh(_.x,_.y,S.x,S.y,A.x,A.y,ne.x,ne.y)&&Cr(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,ae!==a.prev&&ae!==a.next&&oh(_.x,_.y,S.x,S.y,A.x,A.y,ae.x,ae.y)&&Cr(ae.prev,ae,ae.next)>=0))return!1;ae=ae.nextZ}for(;ne&&ne.z>=W;){if(ne!==a.prev&&ne!==a.next&&oh(_.x,_.y,S.x,S.y,A.x,A.y,ne.x,ne.y)&&Cr(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;ae&&ae.z<=q;){if(ae!==a.prev&&ae!==a.next&&oh(_.x,_.y,S.x,S.y,A.x,A.y,ae.x,ae.y)&&Cr(ae.prev,ae,ae.next)>=0)return!1;ae=ae.nextZ}return!0}function wd(a,o,u){var v=a;do{var _=v.prev,S=v.next.next;!Mc(_,S)&&Mp(_,v,v.next,S)&&yf(_,S)&&yf(S,_)&&(o.push(_.i/u),o.push(v.i/u),o.push(S.i/u),$c(v),$c(v.next),v=a=S),v=v.next}while(v!==a);return ba(v)}function Ad(a,o,u,v,_,S){var A=a;do{for(var R=A.next.next;R!==A.prev;){if(A.i!==R.i&&uv(A,R)){var z=kf(A,R);return A=ba(A,A.next),z=ba(z,z.next),Rh(A,o,u,v,_,S),void Rh(z,o,u,v,_,S)}R=R.next}A=A.next}while(A!==a)}function Qp(a,o){return a.x-o.x}function cc(a,o){if(o=function(v,_){var S,A=_,R=v.x,z=v.y,W=-1/0;do{if(z<=A.y&&z>=A.next.y&&A.next.y!==A.y){var q=A.x+(z-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(q<=R&&q>W){if(W=q,q===R){if(z===A.y)return A;if(z===A.next.y)return A.next}S=A.x<A.next.x?A:A.next}}A=A.next}while(A!==_);if(!S)return null;if(R===W)return S;var ne,ae=S,Te=S.x,je=S.y,Be=1/0;A=S;do R>=A.x&&A.x>=Te&&R!==A.x&&oh(z<je?R:W,z,Te,je,z<je?W:R,z,A.x,A.y)&&(ne=Math.abs(z-A.y)/(R-A.x),yf(A,v)&&(ne<Be||ne===Be&&(A.x>S.x||A.x===S.x&&sv(S,A)))&&(S=A,Be=ne)),A=A.next;while(A!==ae);return S}(a,o)){var u=kf(o,a);ba(o,o.next),ba(u,u.next)}}function sv(a,o){return Cr(a.prev,a,o.prev)<0&&Cr(o.next,a,a.next)<0}function Lh(a,o,u,v,_){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-u)*_)|a<<8))|a<<4))|a<<2))|a<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-v)*_)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function Jp(a){var o=a,u=a;do(o.x<u.x||o.x===u.x&&o.y<u.y)&&(u=o),o=o.next;while(o!==a);return u}function oh(a,o,u,v,_,S,A,R){return(_-A)*(o-R)-(a-A)*(S-R)>=0&&(a-A)*(v-R)-(u-A)*(o-R)>=0&&(u-A)*(S-R)-(_-A)*(v-R)>=0}function uv(a,o){return a.next.i!==o.i&&a.prev.i!==o.i&&!function(u,v){var _=u;do{if(_.i!==u.i&&_.next.i!==u.i&&_.i!==v.i&&_.next.i!==v.i&&Mp(_,_.next,u,v))return!0;_=_.next}while(_!==u);return!1}(a,o)&&(yf(a,o)&&yf(o,a)&&function(u,v){var _=u,S=!1,A=(u.x+v.x)/2,R=(u.y+v.y)/2;do _.y>R!=_.next.y>R&&_.next.y!==_.y&&A<(_.next.x-_.x)*(R-_.y)/(_.next.y-_.y)+_.x&&(S=!S),_=_.next;while(_!==u);return S}(a,o)&&(Cr(a.prev,a,o.prev)||Cr(a,o.prev,o))||Mc(a,o)&&Cr(a.prev,a,a.next)>0&&Cr(o.prev,o,o.next)>0)}function Cr(a,o,u){return(o.y-a.y)*(u.x-o.x)-(o.x-a.x)*(u.y-o.y)}function Mc(a,o){return a.x===o.x&&a.y===o.y}function Mp(a,o,u,v){var _=gf(Cr(a,o,u)),S=gf(Cr(a,o,v)),A=gf(Cr(u,v,a)),R=gf(Cr(u,v,o));return _!==S&&A!==R||!(_!==0||!sr(a,u,o))||!(S!==0||!sr(a,v,o))||!(A!==0||!sr(u,a,v))||!(R!==0||!sr(u,o,v))}function sr(a,o,u){return o.x<=Math.max(a.x,u.x)&&o.x>=Math.min(a.x,u.x)&&o.y<=Math.max(a.y,u.y)&&o.y>=Math.min(a.y,u.y)}function gf(a){return a>0?1:a<0?-1:0}function yf(a,o){return Cr(a.prev,a,a.next)<0?Cr(a,o,a.next)>=0&&Cr(a,a.prev,o)>=0:Cr(a,o,a.prev)<0||Cr(a,a.next,o)<0}function kf(a,o){var u=new Df(a.i,a.x,a.y),v=new Df(o.i,o.x,o.y),_=a.next,S=o.prev;return a.next=o,o.prev=a,u.next=_,_.prev=u,v.next=u,u.prev=v,S.next=v,v.prev=S,v}function sh(a,o,u,v){var _=new Df(a,o,u);return v?(_.next=v.next,_.prev=v,v.next.prev=_,v.next=_):(_.prev=_,_.next=_),_}function $c(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Df(a,o,u){this.i=a,this.x=o,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Il(a,o,u,v){for(var _=0,S=o,A=u-v;S<u;S+=v)_+=(a[A]-a[S])*(a[S+1]+a[A+1]),A=S;return _}function Ff(a,o,u,v,_){(function S(A,R,z,W,q){for(;W>z;){if(W-z>600){var ne=W-z+1,ae=R-z+1,Te=Math.log(ne),je=.5*Math.exp(2*Te/3),Be=.5*Math.sqrt(Te*je*(ne-je)/ne)*(ae-ne/2<0?-1:1);S(A,R,Math.max(z,Math.floor(R-ae*je/ne+Be)),Math.min(W,Math.floor(R+(ne-ae)*je/ne+Be)),q)}var Je=A[R],Qe=z,Tt=W;for(Rl(A,z,R),q(A[W],Je)>0&&Rl(A,z,W);Qe<Tt;){for(Rl(A,Qe,Tt),Qe++,Tt--;q(A[Qe],Je)<0;)Qe++;for(;q(A[Tt],Je)>0;)Tt--}q(A[z],Je)===0?Rl(A,z,Tt):Rl(A,++Tt,W),Tt<=R&&(z=Tt+1),R<=Tt&&(W=Tt-1)}})(a,o,u||0,v||a.length-1,_||op)}function Rl(a,o,u){var v=a[o];a[o]=a[u],a[u]=v}function op(a,o){return a<o?-1:a>o?1:0}function Bf(a,o){var u=a.length;if(u<=1)return[a];for(var v,_,S=[],A=0;A<u;A++){var R=jr(a[A]);R!==0&&(a[A].area=Math.abs(R),_===void 0&&(_=R<0),_===R<0?(v&&S.push(v),v=[a[A]]):v.push(a[A]))}if(v&&S.push(v),o>1)for(var z=0;z<S.length;z++)S[z].length<=o||(Ff(S[z],o,1,S[z].length-1,uh),S[z]=S[z].slice(0,o));return S}function uh(a,o){return o.area-a.area}function Nf(a,o,u){for(var v=u.patternDependencies,_=!1,S=0,A=o;S<A.length;S+=1){var R=A[S].paint.get(a+"-pattern");R.isConstant()||(_=!0);var z=R.constantOr(null);z&&(_=!0,v[z.to]=!0,v[z.from]=!0)}return _}function zf(a,o,u,v,_){for(var S=_.patternDependencies,A=0,R=o;A<R.length;A+=1){var z=R[A],W=z.paint.get(a+"-pattern").value;if(W.kind!=="constant"){var q=W.evaluate({zoom:v-1},u,{},_.availableImages),ne=W.evaluate({zoom:v},u,{},_.availableImages),ae=W.evaluate({zoom:v+1},u,{},_.availableImages);ne=ne&&ne.name?ne.name:ne,ae=ae&&ae.name?ae.name:ae,S[q=q&&q.name?q.name:q]=!0,S[ne]=!0,S[ae]=!0,u.patterns[z.id]={min:q,mid:ne,max:ae}}}return u}ip.deviation=function(a,o,u,v){var _=o&&o.length,S=Math.abs(Il(a,0,_?o[0]*u:a.length,u));if(_)for(var A=0,R=o.length;A<R;A++)S-=Math.abs(Il(a,o[A]*u,A<R-1?o[A+1]*u:a.length,u));var z=0;for(A=0;A<v.length;A+=3){var W=v[A]*u,q=v[A+1]*u,ne=v[A+2]*u;z+=Math.abs((a[W]-a[ne])*(a[q+1]-a[W+1])-(a[W]-a[q])*(a[ne+1]-a[W+1]))}return S===0&&z===0?0:Math.abs((z-S)/S)},ip.flatten=function(a){for(var o=a[0][0].length,u={vertices:[],holes:[],dimensions:o},v=0,_=0;_<a.length;_++){for(var S=0;S<a[_].length;S++)for(var A=0;A<o;A++)u.vertices.push(a[_][S][A]);_>0&&u.holes.push(v+=a[_-1].length)}return u},mf.default=qp;var il=function(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Wl,this.indexArray=new wc,this.indexArray2=new Ru,this.programConfigurations=new na(o.layers,o.zoom),this.segments=new ye,this.segments2=new ye,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};il.prototype.populate=function(a,o,u){this.hasPattern=Nf("fill",this.layers,o);for(var v=this.layers[0].layout.get("fill-sort-key"),_=[],S=0,A=a;S<A.length;S+=1){var R=A[S],z=R.feature,W=R.id,q=R.index,ne=R.sourceLayerIndex,ae=this.layers[0]._featureFilter.needGeometry,Te=Ja(z,ae);if(this.layers[0]._featureFilter.filter(new ma(this.zoom),Te,u)){var je=v?v.evaluate(Te,{},u,o.availableImages):void 0,Be={id:W,properties:z.properties,type:z.type,sourceLayerIndex:ne,index:q,geometry:ae?Te.geometry:Oo(z),patterns:{},sortKey:je};_.push(Be)}}v&&_.sort(function(dn,_n){return dn.sortKey-_n.sortKey});for(var Je=0,Qe=_;Je<Qe.length;Je+=1){var Tt=Qe[Je],Zt=Tt.geometry,ar=Tt.index,Lr=Tt.sourceLayerIndex;if(this.hasPattern){var xr=zf("fill",this.layers,Tt,this.zoom,o);this.patternFeatures.push(xr)}else this.addFeature(Tt,Zt,ar,u,{});o.featureIndex.insert(a[ar].feature,Zt,ar,Lr,this.index)}},il.prototype.update=function(a,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,o,this.stateDependentLayers,u)},il.prototype.addFeatures=function(a,o,u){for(var v=0,_=this.patternFeatures;v<_.length;v+=1){var S=_[v];this.addFeature(S,S.geometry,S.index,o,u)}},il.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},il.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},il.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Lf),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0},il.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},il.prototype.addFeature=function(a,o,u,v,_){for(var S=0,A=Bf(o,500);S<A.length;S+=1){for(var R=A[S],z=0,W=0,q=R;W<q.length;W+=1)z+=q[W].length;for(var ne=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray),ae=ne.vertexLength,Te=[],je=[],Be=0,Je=R;Be<Je.length;Be+=1){var Qe=Je[Be];if(Qe.length!==0){Qe!==R[0]&&je.push(Te.length/2);var Tt=this.segments2.prepareSegment(Qe.length,this.layoutVertexArray,this.indexArray2),Zt=Tt.vertexLength;this.layoutVertexArray.emplaceBack(Qe[0].x,Qe[0].y),this.indexArray2.emplaceBack(Zt+Qe.length-1,Zt),Te.push(Qe[0].x),Te.push(Qe[0].y);for(var ar=1;ar<Qe.length;ar++)this.layoutVertexArray.emplaceBack(Qe[ar].x,Qe[ar].y),this.indexArray2.emplaceBack(Zt+ar-1,Zt+ar),Te.push(Qe[ar].x),Te.push(Qe[ar].y);Tt.vertexLength+=Qe.length,Tt.primitiveLength+=Qe.length}}for(var Lr=mf(Te,je),xr=0;xr<Lr.length;xr+=3)this.indexArray.emplaceBack(ae+Lr[xr],ae+Lr[xr+1],ae+Lr[xr+2]);ne.vertexLength+=z,ne.primitiveLength+=Lr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,u,_,v)},Kn("FillBucket",il,{omit:["layers","patternFeatures"]});var kh=new ds({"fill-sort-key":new si(Ce.layout_fill["fill-sort-key"])}),lh={paint:new ds({"fill-antialias":new bi(Ce.paint_fill["fill-antialias"]),"fill-opacity":new si(Ce.paint_fill["fill-opacity"]),"fill-color":new si(Ce.paint_fill["fill-color"]),"fill-outline-color":new si(Ce.paint_fill["fill-outline-color"]),"fill-translate":new bi(Ce.paint_fill["fill-translate"]),"fill-translate-anchor":new bi(Ce.paint_fill["fill-translate-anchor"]),"fill-pattern":new Zc(Ce.paint_fill["fill-pattern"])}),layout:kh},Pp=function(a){function o(u){a.call(this,u,lh)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.recalculate=function(u,v){a.prototype.recalculate.call(this,u,v);var _=this.paint._values["fill-outline-color"];_.value.kind==="constant"&&_.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},o.prototype.createBucket=function(u){return new il(u)},o.prototype.queryRadius=function(){return Ps(this.paint.get("fill-translate"))},o.prototype.queryIntersectsFeature=function(u,v,_,S,A,R,z){return go(Ku(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),R.angle,z),S)},o.prototype.isTileClipped=function(){return!0},o}(nl),Uf=Hs([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,_f=uu;function uu(a,o,u,v,_){this.properties={},this.extent=u,this.type=0,this._pbf=a,this._geometry=-1,this._keys=v,this._values=_,a.readFields(fc,this,o)}function fc(a,o,u){a==1?o.id=u.readVarint():a==2?function(v,_){for(var S=v.readVarint()+v.pos;v.pos<S;){var A=_._keys[v.readVarint()],R=_._values[v.readVarint()];_.properties[A]=R}}(u,o):a==3?o.type=u.readVarint():a==4&&(o._geometry=u.pos)}function lv(a){for(var o,u,v=0,_=0,S=a.length,A=S-1;_<S;A=_++)v+=((u=a[A]).x-(o=a[_]).x)*(o.y+u.y);return v}uu.types=["Unknown","Point","LineString","Polygon"],uu.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var o,u=a.readVarint()+a.pos,v=1,_=0,S=0,A=0,R=[];a.pos<u;){if(_<=0){var z=a.readVarint();v=7&z,_=z>>3}if(_--,v===1||v===2)S+=a.readSVarint(),A+=a.readSVarint(),v===1&&(o&&R.push(o),o=[]),o.push(new pe(S,A));else{if(v!==7)throw new Error("unknown command "+v);o&&o.push(o[0].clone())}}return o&&R.push(o),R},uu.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var o=a.readVarint()+a.pos,u=1,v=0,_=0,S=0,A=1/0,R=-1/0,z=1/0,W=-1/0;a.pos<o;){if(v<=0){var q=a.readVarint();u=7&q,v=q>>3}if(v--,u===1||u===2)(_+=a.readSVarint())<A&&(A=_),_>R&&(R=_),(S+=a.readSVarint())<z&&(z=S),S>W&&(W=S);else if(u!==7)throw new Error("unknown command "+u)}return[A,z,R,W]},uu.prototype.toGeoJSON=function(a,o,u){var v,_,S=this.extent*Math.pow(2,u),A=this.extent*a,R=this.extent*o,z=this.loadGeometry(),W=uu.types[this.type];function q(Te){for(var je=0;je<Te.length;je++){var Be=Te[je];Te[je]=[360*(Be.x+A)/S-180,360/Math.PI*Math.atan(Math.exp((180-360*(Be.y+R)/S)*Math.PI/180))-90]}}switch(this.type){case 1:var ne=[];for(v=0;v<z.length;v++)ne[v]=z[v][0];q(z=ne);break;case 2:for(v=0;v<z.length;v++)q(z[v]);break;case 3:for(z=function(Te){var je=Te.length;if(je<=1)return[Te];for(var Be,Je,Qe=[],Tt=0;Tt<je;Tt++){var Zt=lv(Te[Tt]);Zt!==0&&(Je===void 0&&(Je=Zt<0),Je===Zt<0?(Be&&Qe.push(Be),Be=[Te[Tt]]):Be.push(Te[Tt]))}return Be&&Qe.push(Be),Qe}(z),v=0;v<z.length;v++)for(_=0;_<z[v].length;_++)q(z[v][_])}z.length===1?z=z[0]:W="Multi"+W;var ae={type:"Feature",geometry:{type:W,coordinates:z},properties:this.properties};return"id"in this&&(ae.id=this.id),ae};var Td=sp;function sp(a,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Kl,this,o),this.length=this._features.length}function Kl(a,o,u){a===15?o.version=u.readVarint():a===1?o.name=u.readString():a===5?o.extent=u.readVarint():a===2?o._features.push(u.pos):a===3?o._keys.push(u.readString()):a===4&&o._values.push(function(v){for(var _=null,S=v.readVarint()+v.pos;v.pos<S;){var A=v.readVarint()>>3;_=A===1?v.readString():A===2?v.readFloat():A===3?v.readDouble():A===4?v.readVarint64():A===5?v.readVarint():A===6?v.readSVarint():A===7?v.readBoolean():null}return _}(u))}function Op(a,o,u){if(a===3){var v=new Td(u,u.readVarint()+u.pos);v.length&&(o[v.name]=v)}}sp.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var o=this._pbf.readVarint()+this._pbf.pos;return new _f(this._pbf,o,this.extent,this._keys,this._values)};var jf={VectorTile:function(o,u){this.layers=o.readFields(Op,{},u)},VectorTileFeature:_f,VectorTileLayer:Td},ed=jf.VectorTileFeature.types,Ip=Math.pow(2,13);function qc(a,o,u,v,_,S,A,R){a.emplaceBack(o,u,2*Math.floor(v*Ip)+A,_*Ip*2,S*Ip*2,Math.round(R))}var ml=function(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new Ou,this.indexArray=new wc,this.programConfigurations=new na(o.layers,o.zoom),this.segments=new ye,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};function Pc(a,o){return a.x===o.x&&(a.x<0||a.x>8192)||a.y===o.y&&(a.y<0||a.y>8192)}ml.prototype.populate=function(a,o,u){this.features=[],this.hasPattern=Nf("fill-extrusion",this.layers,o);for(var v=0,_=a;v<_.length;v+=1){var S=_[v],A=S.feature,R=S.id,z=S.index,W=S.sourceLayerIndex,q=this.layers[0]._featureFilter.needGeometry,ne=Ja(A,q);if(this.layers[0]._featureFilter.filter(new ma(this.zoom),ne,u)){var ae={id:R,sourceLayerIndex:W,index:z,geometry:q?ne.geometry:Oo(A),properties:A.properties,type:A.type,patterns:{}};this.hasPattern?this.features.push(zf("fill-extrusion",this.layers,ae,this.zoom,o)):this.addFeature(ae,ae.geometry,z,u,{}),o.featureIndex.insert(A,ae.geometry,z,W,this.index,!0)}}},ml.prototype.addFeatures=function(a,o,u){for(var v=0,_=this.features;v<_.length;v+=1){var S=_[v];this.addFeature(S,S.geometry,S.index,o,u)}},ml.prototype.update=function(a,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,o,this.stateDependentLayers,u)},ml.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ml.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ml.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Uf),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},ml.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ml.prototype.addFeature=function(a,o,u,v,_){for(var S=0,A=Bf(o,500);S<A.length;S+=1){for(var R=A[S],z=0,W=0,q=R;W<q.length;W+=1)z+=q[W].length;for(var ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),ae=0,Te=R;ae<Te.length;ae+=1){var je=Te[ae];if(je.length!==0&&!((Pa=je).every(function(aa){return aa.x<0})||Pa.every(function(aa){return aa.x>8192})||Pa.every(function(aa){return aa.y<0})||Pa.every(function(aa){return aa.y>8192})))for(var Be=0,Je=0;Je<je.length;Je++){var Qe=je[Je];if(Je>=1){var Tt=je[Je-1];if(!Pc(Qe,Tt)){ne.vertexLength+4>ye.MAX_VERTEX_ARRAY_LENGTH&&(ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Zt=Qe.sub(Tt)._perp()._unit(),ar=Tt.dist(Qe);Be+ar>32768&&(Be=0),qc(this.layoutVertexArray,Qe.x,Qe.y,Zt.x,Zt.y,0,0,Be),qc(this.layoutVertexArray,Qe.x,Qe.y,Zt.x,Zt.y,0,1,Be),qc(this.layoutVertexArray,Tt.x,Tt.y,Zt.x,Zt.y,0,0,Be+=ar),qc(this.layoutVertexArray,Tt.x,Tt.y,Zt.x,Zt.y,0,1,Be);var Lr=ne.vertexLength;this.indexArray.emplaceBack(Lr,Lr+2,Lr+1),this.indexArray.emplaceBack(Lr+1,Lr+2,Lr+3),ne.vertexLength+=4,ne.primitiveLength+=2}}}}if(ne.vertexLength+z>ye.MAX_VERTEX_ARRAY_LENGTH&&(ne=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray)),ed[a.type]==="Polygon"){for(var xr=[],dn=[],_n=ne.vertexLength,ci=0,_i=R;ci<_i.length;ci+=1){var vi=_i[ci];if(vi.length!==0){vi!==R[0]&&dn.push(xr.length/2);for(var ti=0;ti<vi.length;ti++){var Zi=vi[ti];qc(this.layoutVertexArray,Zi.x,Zi.y,0,0,1,1,0),xr.push(Zi.x),xr.push(Zi.y)}}}for(var Pi=mf(xr,dn),xi=0;xi<Pi.length;xi+=3)this.indexArray.emplaceBack(_n+Pi[xi],_n+Pi[xi+2],_n+Pi[xi+1]);ne.primitiveLength+=Pi.length/3,ne.vertexLength+=z}}var Pa;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,u,_,v)},Kn("FillExtrusionBucket",ml,{omit:["layers","features"]});var Rp={paint:new ds({"fill-extrusion-opacity":new bi(Ce["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new si(Ce["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new bi(Ce["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new bi(Ce["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Zc(Ce["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new si(Ce["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new si(Ce["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new bi(Ce["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},ch=function(a){function o(u){a.call(this,u,Rp)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.createBucket=function(u){return new ml(u)},o.prototype.queryRadius=function(){return Ps(this.paint.get("fill-extrusion-translate"))},o.prototype.is3D=function(){return!0},o.prototype.queryIntersectsFeature=function(u,v,_,S,A,R,z,W){var q=Ku(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),R.angle,z),ne=this.paint.get("fill-extrusion-height").evaluate(v,_),ae=this.paint.get("fill-extrusion-base").evaluate(v,_),Te=function(Be,Je,Qe,Tt){for(var Zt=[],ar=0,Lr=Be;ar<Lr.length;ar+=1){var xr=Lr[ar],dn=[xr.x,xr.y,0,1];Fu(dn,dn,Je),Zt.push(new pe(dn[0]/dn[3],dn[1]/dn[3]))}return Zt}(q,W),je=function(Be,Je,Qe,Tt){for(var Zt=[],ar=[],Lr=Tt[8]*Je,xr=Tt[9]*Je,dn=Tt[10]*Je,_n=Tt[11]*Je,ci=Tt[8]*Qe,_i=Tt[9]*Qe,vi=Tt[10]*Qe,ti=Tt[11]*Qe,Zi=0,Pi=Be;Zi<Pi.length;Zi+=1){for(var xi=[],Pa=[],aa=0,to=Pi[Zi];aa<to.length;aa+=1){var Fi=to[aa],Ra=Fi.x,Do=Fi.y,Fo=Tt[0]*Ra+Tt[4]*Do+Tt[12],is=Tt[1]*Ra+Tt[5]*Do+Tt[13],as=Tt[2]*Ra+Tt[6]*Do+Tt[14],Yo=Tt[3]*Ra+Tt[7]*Do+Tt[15],qs=as+dn,Ls=Yo+_n,ol=Fo+ci,Qs=is+_i,$u=as+vi,du=Yo+ti,Js=new pe((Fo+Lr)/Ls,(is+xr)/Ls);Js.z=qs/Ls,xi.push(Js);var eu=new pe(ol/du,Qs/du);eu.z=$u/du,Pa.push(eu)}Zt.push(xi),ar.push(Pa)}return[Zt,ar]}(S,ae,ne,W);return function(Be,Je,Qe){var Tt=1/0;go(Qe,Je)&&(Tt=up(Qe,Je[0]));for(var Zt=0;Zt<Je.length;Zt++)for(var ar=Je[Zt],Lr=Be[Zt],xr=0;xr<ar.length-1;xr++){var dn=ar[xr],_n=[dn,ar[xr+1],Lr[xr+1],Lr[xr],dn];Yu(Qe,_n)&&(Tt=Math.min(Tt,up(Qe,_n)))}return Tt!==1/0&&Tt}(je[0],je[1],Te)},o}(nl);function al(a,o){return a.x*o.x+a.y*o.y}function up(a,o){if(a.length===1){for(var u,v=0,_=o[v++];!u||_.equals(u);)if(!(u=o[v++]))return 1/0;for(;v<o.length;v++){var S=o[v],A=a[0],R=u.sub(_),z=S.sub(_),W=A.sub(_),q=al(R,R),ne=al(R,z),ae=al(z,z),Te=al(W,R),je=al(W,z),Be=q*ae-ne*ne,Je=(ae*Te-ne*je)/Be,Qe=(q*je-ne*Te)/Be,Tt=_.z*(1-Je-Qe)+u.z*Je+S.z*Qe;if(isFinite(Tt))return Tt}return 1/0}for(var Zt=1/0,ar=0,Lr=o;ar<Lr.length;ar+=1)Zt=Math.min(Zt,Lr[ar].z);return Zt}var Dh=Hs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Fh=Hs([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,lp=jf.VectorTileFeature.types,Ys=Math.cos(Math.PI/180*37.5),Ll=Math.pow(2,14)/.5,Ba=function(o){var u=this;this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(v){return v.id}),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(v){u.gradients[v.id]={}}),this.layoutVertexArray=new Iu,this.layoutVertexArray2=new Pe,this.indexArray=new wc,this.programConfigurations=new na(o.layers,o.zoom),this.segments=new ye,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(v){return v.isStateDependent()}).map(function(v){return v.id})};Ba.prototype.populate=function(a,o,u){this.hasPattern=Nf("line",this.layers,o);for(var v=this.layers[0].layout.get("line-sort-key"),_=[],S=0,A=a;S<A.length;S+=1){var R=A[S],z=R.feature,W=R.id,q=R.index,ne=R.sourceLayerIndex,ae=this.layers[0]._featureFilter.needGeometry,Te=Ja(z,ae);if(this.layers[0]._featureFilter.filter(new ma(this.zoom),Te,u)){var je=v?v.evaluate(Te,{},u):void 0,Be={id:W,properties:z.properties,type:z.type,sourceLayerIndex:ne,index:q,geometry:ae?Te.geometry:Oo(z),patterns:{},sortKey:je};_.push(Be)}}v&&_.sort(function(dn,_n){return dn.sortKey-_n.sortKey});for(var Je=0,Qe=_;Je<Qe.length;Je+=1){var Tt=Qe[Je],Zt=Tt.geometry,ar=Tt.index,Lr=Tt.sourceLayerIndex;if(this.hasPattern){var xr=zf("line",this.layers,Tt,this.zoom,o);this.patternFeatures.push(xr)}else this.addFeature(Tt,Zt,ar,u,{});o.featureIndex.insert(a[ar].feature,Zt,ar,Lr,this.index)}},Ba.prototype.update=function(a,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,o,this.stateDependentLayers,u)},Ba.prototype.addFeatures=function(a,o,u){for(var v=0,_=this.patternFeatures;v<_.length;v+=1){var S=_[v];this.addFeature(S,S.geometry,S.index,o,u)}},Ba.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ba.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ba.prototype.upload=function(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,Fh)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Dh),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},Ba.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ba.prototype.lineFeatureClips=function(a){if(a.properties&&a.properties.hasOwnProperty("mapbox_clip_start")&&a.properties.hasOwnProperty("mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}},Ba.prototype.addFeature=function(a,o,u,v,_){var S=this.layers[0].layout,A=S.get("line-join").evaluate(a,{}),R=S.get("line-cap"),z=S.get("line-miter-limit"),W=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(var q=0,ne=o;q<ne.length;q+=1)this.addLine(ne[q],a,A,R,z,W);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,u,_,v)},Ba.prototype.addLine=function(a,o,u,v,_,S){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var A=0;A<a.length-1;A++)this.totalDistance+=a[A].dist(a[A+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var R=lp[o.type]==="Polygon",z=a.length;z>=2&&a[z-1].equals(a[z-2]);)z--;for(var W=0;W<z-1&&a[W].equals(a[W+1]);)W++;if(!(z<(R?3:2))){u==="bevel"&&(_=1.05);var q,ne=this.overscaling<=16?122880/(512*this.overscaling):0,ae=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray),Te=void 0,je=void 0,Be=void 0,Je=void 0;this.e1=this.e2=-1,R&&(Je=a[W].sub(q=a[z-2])._unit()._perp());for(var Qe=W;Qe<z;Qe++)if(!(je=Qe===z-1?R?a[W+1]:void 0:a[Qe+1])||!a[Qe].equals(je)){Je&&(Be=Je),q&&(Te=q),q=a[Qe],Je=je?je.sub(q)._unit()._perp():Be;var Tt=(Be=Be||Je).add(Je);Tt.x===0&&Tt.y===0||Tt._unit();var Zt=Be.x*Je.x+Be.y*Je.y,ar=Tt.x*Je.x+Tt.y*Je.y,Lr=ar!==0?1/ar:1/0,xr=2*Math.sqrt(2-2*ar),dn=ar<Ys&&Te&&je,_n=Be.x*Je.y-Be.y*Je.x>0;if(dn&&Qe>W){var ci=q.dist(Te);if(ci>2*ne){var _i=q.sub(q.sub(Te)._mult(ne/ci)._round());this.updateDistance(Te,_i),this.addCurrentVertex(_i,Be,0,0,ae),Te=_i}}var vi=Te&&je,ti=vi?u:R?"butt":v;if(vi&&ti==="round"&&(Lr<S?ti="miter":Lr<=2&&(ti="fakeround")),ti==="miter"&&Lr>_&&(ti="bevel"),ti==="bevel"&&(Lr>2&&(ti="flipbevel"),Lr<_&&(ti="miter")),Te&&this.updateDistance(Te,q),ti==="miter")Tt._mult(Lr),this.addCurrentVertex(q,Tt,0,0,ae);else if(ti==="flipbevel"){if(Lr>100)Tt=Je.mult(-1);else{var Zi=Lr*Be.add(Je).mag()/Be.sub(Je).mag();Tt._perp()._mult(Zi*(_n?-1:1))}this.addCurrentVertex(q,Tt,0,0,ae),this.addCurrentVertex(q,Tt.mult(-1),0,0,ae)}else if(ti==="bevel"||ti==="fakeround"){var Pi=-Math.sqrt(Lr*Lr-1),xi=_n?Pi:0,Pa=_n?0:Pi;if(Te&&this.addCurrentVertex(q,Be,xi,Pa,ae),ti==="fakeround")for(var aa=Math.round(180*xr/Math.PI/20),to=1;to<aa;to++){var Fi=to/aa;if(Fi!==.5){var Ra=Fi-.5;Fi+=Fi*Ra*(Fi-1)*((1.0904+Zt*(Zt*(3.55645-1.43519*Zt)-3.2452))*Ra*Ra+(.848013+Zt*(.215638*Zt-1.06021)))}var Do=Je.sub(Be)._mult(Fi)._add(Be)._unit()._mult(_n?-1:1);this.addHalfVertex(q,Do.x,Do.y,!1,_n,0,ae)}je&&this.addCurrentVertex(q,Je,-xi,-Pa,ae)}else if(ti==="butt")this.addCurrentVertex(q,Tt,0,0,ae);else if(ti==="square"){var Fo=Te?1:-1;this.addCurrentVertex(q,Tt,Fo,Fo,ae)}else ti==="round"&&(Te&&(this.addCurrentVertex(q,Be,0,0,ae),this.addCurrentVertex(q,Be,1,1,ae,!0)),je&&(this.addCurrentVertex(q,Je,-1,-1,ae,!0),this.addCurrentVertex(q,Je,0,0,ae)));if(dn&&Qe<z-1){var is=q.dist(je);if(is>2*ne){var as=q.add(je.sub(q)._mult(ne/is)._round());this.updateDistance(q,as),this.addCurrentVertex(as,Je,0,0,ae),q=as}}}}},Ba.prototype.addCurrentVertex=function(a,o,u,v,_,S){S===void 0&&(S=!1);var A=o.y*v-o.x,R=-o.y-o.x*v;this.addHalfVertex(a,o.x+o.y*u,o.y-o.x*u,S,!1,u,_),this.addHalfVertex(a,A,R,S,!0,-v,_),this.distance>Ll/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(a,o,u,v,_,S))},Ba.prototype.addHalfVertex=function(a,o,u,v,_,S,A){var R=.5*(this.lineClips?this.scaledDistance*(Ll-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a.x<<1)+(v?1:0),(a.y<<1)+(_?1:0),Math.round(63*o)+128,Math.round(63*u)+128,1+(S===0?0:S<0?-1:1)|(63&R)<<2,R>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var z=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),A.primitiveLength++),_?this.e2=z:this.e1=z},Ba.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Ba.prototype.updateDistance=function(a,o){this.distance+=a.dist(o),this.updateScaledDistance()},Kn("LineBucket",Ba,{omit:["layers","patternFeatures"]});var ga=new ds({"line-cap":new bi(Ce.layout_line["line-cap"]),"line-join":new si(Ce.layout_line["line-join"]),"line-miter-limit":new bi(Ce.layout_line["line-miter-limit"]),"line-round-limit":new bi(Ce.layout_line["line-round-limit"]),"line-sort-key":new si(Ce.layout_line["line-sort-key"])}),Wo={paint:new ds({"line-opacity":new si(Ce.paint_line["line-opacity"]),"line-color":new si(Ce.paint_line["line-color"]),"line-translate":new bi(Ce.paint_line["line-translate"]),"line-translate-anchor":new bi(Ce.paint_line["line-translate-anchor"]),"line-width":new si(Ce.paint_line["line-width"]),"line-gap-width":new si(Ce.paint_line["line-gap-width"]),"line-offset":new si(Ce.paint_line["line-offset"]),"line-blur":new si(Ce.paint_line["line-blur"]),"line-dasharray":new ko(Ce.paint_line["line-dasharray"]),"line-pattern":new Zc(Ce.paint_line["line-pattern"]),"line-gradient":new Zu(Ce.paint_line["line-gradient"])}),layout:ga},Vf=new(function(a){function o(){a.apply(this,arguments)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.possiblyEvaluate=function(u,v){return v=new ma(Math.floor(v.zoom),{now:v.now,fadeDuration:v.fadeDuration,zoomHistory:v.zoomHistory,transition:v.transition}),a.prototype.possiblyEvaluate.call(this,u,v)},o.prototype.evaluate=function(u,v,_,S){return v=He({},v,{zoom:Math.floor(v.zoom)}),a.prototype.evaluate.call(this,u,v,_,S)},o}(si))(Wo.paint.properties["line-width"].specification);Vf.useIntegerZoom=!0;var cv=function(a){function o(u){a.call(this,u,Wo),this.gradientVersion=0}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype._handleSpecialPaintPropertyUpdate=function(u){u==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof co,this.gradientVersion=(this.gradientVersion+1)%vt)},o.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},o.prototype.recalculate=function(u,v){a.prototype.recalculate.call(this,u,v),this.paint._values["line-floorwidth"]=Vf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)},o.prototype.createBucket=function(u){return new Ba(u)},o.prototype.queryRadius=function(u){var v=u,_=Qc(Ol("line-width",this,v),Ol("line-gap-width",this,v)),S=Ol("line-offset",this,v);return _/2+Math.abs(S)+Ps(this.paint.get("line-translate"))},o.prototype.queryIntersectsFeature=function(u,v,_,S,A,R,z){var W=Ku(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),R.angle,z),q=z/2*Qc(this.paint.get("line-width").evaluate(v,_),this.paint.get("line-gap-width").evaluate(v,_)),ne=this.paint.get("line-offset").evaluate(v,_);return ne&&(S=function(ae,Te){for(var je=[],Be=new pe(0,0),Je=0;Je<ae.length;Je++){for(var Qe=ae[Je],Tt=[],Zt=0;Zt<Qe.length;Zt++){var ar=Qe[Zt],Lr=Qe[Zt+1],xr=Zt===0?Be:ar.sub(Qe[Zt-1])._unit()._perp(),dn=Zt===Qe.length-1?Be:Lr.sub(ar)._unit()._perp(),_n=xr._add(dn)._unit();_n._mult(1/(_n.x*dn.x+_n.y*dn.y)),Tt.push(_n._mult(Te)._add(ar))}je.push(Tt)}return je}(S,ne*z)),function(ae,Te,je){for(var Be=0;Be<Te.length;Be++){var Je=Te[Be];if(ae.length>=3){for(var Qe=0;Qe<Je.length;Qe++)if(ku(ae,Je[Qe]))return!0}if(Ws(ae,Je,je))return!0}return!1}(W,S,q)},o.prototype.isTileClipped=function(){return!0},o}(nl);function Qc(a,o){return o>0?o+2*a:a}var fv=Hs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Md=Hs([{name:"a_projected_pos",components:3,type:"Float32"}],4),hv=(Hs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Hs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),td=(Hs([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Hs([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),pv=Hs([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function dv(a,o,u){return a.sections.forEach(function(v){v.text=function(_,S,A){var R=S.layout.get("text-transform").evaluate(A,{});return R==="uppercase"?_=_.toLocaleUpperCase():R==="lowercase"&&(_=_.toLocaleLowerCase()),rl.applyArabicShaping&&(_=rl.applyArabicShaping(_)),_}(v.text,o,u)}),a}Hs([{name:"triangle",components:3,type:"Uint16"}]),Hs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Hs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Hs([{type:"Float32",name:"offsetX"}]),Hs([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var $l={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},cp=function(o,u,v,_,S){var A,R,z=8*S-_-1,W=(1<<z)-1,q=W>>1,ne=-7,ae=v?S-1:0,Te=v?-1:1,je=o[u+ae];for(ae+=Te,A=je&(1<<-ne)-1,je>>=-ne,ne+=z;ne>0;A=256*A+o[u+ae],ae+=Te,ne-=8);for(R=A&(1<<-ne)-1,A>>=-ne,ne+=_;ne>0;R=256*R+o[u+ae],ae+=Te,ne-=8);if(A===0)A=1-q;else{if(A===W)return R?NaN:1/0*(je?-1:1);R+=Math.pow(2,_),A-=q}return(je?-1:1)*R*Math.pow(2,A-_)},fp=function(o,u,v,_,S,A){var R,z,W,q=8*A-S-1,ne=(1<<q)-1,ae=ne>>1,Te=S===23?Math.pow(2,-24)-Math.pow(2,-77):0,je=_?0:A-1,Be=_?1:-1,Je=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(z=isNaN(u)?1:0,R=ne):(R=Math.floor(Math.log(u)/Math.LN2),u*(W=Math.pow(2,-R))<1&&(R--,W*=2),(u+=R+ae>=1?Te/W:Te*Math.pow(2,1-ae))*W>=2&&(R++,W/=2),R+ae>=ne?(z=0,R=ne):R+ae>=1?(z=(u*W-1)*Math.pow(2,S),R+=ae):(z=u*Math.pow(2,ae-1)*Math.pow(2,S),R=0));S>=8;o[v+je]=255&z,je+=Be,z/=256,S-=8);for(R=R<<S|z,q+=S;q>0;o[v+je]=255&R,je+=Be,R/=256,q-=8);o[v+je-Be]|=128*Je},fh=po;function po(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}po.Varint=0,po.Fixed64=1,po.Bytes=2,po.Fixed32=5;var hh=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Ui(a){return a.type===po.Bytes?a.readVarint()+a.pos:a.pos+1}function xf(a,o,u){return u?4294967296*o+(a>>>0):4294967296*(o>>>0)+(a>>>0)}function J(a,o,u){var v=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));u.realloc(v);for(var _=u.pos-1;_>=a;_--)u.buf[_+v]=u.buf[_]}function he(a,o){for(var u=0;u<a.length;u++)o.writeVarint(a[u])}function qe(a,o){for(var u=0;u<a.length;u++)o.writeSVarint(a[u])}function er(a,o){for(var u=0;u<a.length;u++)o.writeFloat(a[u])}function wr(a,o){for(var u=0;u<a.length;u++)o.writeDouble(a[u])}function lr(a,o){for(var u=0;u<a.length;u++)o.writeBoolean(a[u])}function cr(a,o){for(var u=0;u<a.length;u++)o.writeFixed32(a[u])}function Hr(a,o){for(var u=0;u<a.length;u++)o.writeSFixed32(a[u])}function tn(a,o){for(var u=0;u<a.length;u++)o.writeFixed64(a[u])}function an(a,o){for(var u=0;u<a.length;u++)o.writeSFixed64(a[u])}function un(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+16777216*a[o+3]}function on(a,o,u){a[u]=o,a[u+1]=o>>>8,a[u+2]=o>>>16,a[u+3]=o>>>24}function kn(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+(a[o+3]<<24)}function En(a,o,u){a===1&&u.readMessage(Zr,o)}function Zr(a,o,u){if(a===3){var v=u.readMessage(Vt,{}),_=v.width,S=v.height,A=v.left,R=v.top,z=v.advance;o.push({id:v.id,bitmap:new Zs({width:_+6,height:S+6},v.bitmap),metrics:{width:_,height:S,left:A,top:R,advance:z}})}}function Vt(a,o,u){a===1?o.id=u.readVarint():a===2?o.bitmap=u.readBytes():a===3?o.width=u.readVarint():a===4?o.height=u.readVarint():a===5?o.left=u.readSVarint():a===6?o.top=u.readSVarint():a===7&&(o.advance=u.readVarint())}function tr(a){for(var o=0,u=0,v=0,_=a;v<_.length;v+=1){var S=_[v];o+=S.w*S.h,u=Math.max(u,S.w)}a.sort(function(Be,Je){return Je.h-Be.h});for(var A=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),u),h:1/0}],R=0,z=0,W=0,q=a;W<q.length;W+=1)for(var ne=q[W],ae=A.length-1;ae>=0;ae--){var Te=A[ae];if(!(ne.w>Te.w||ne.h>Te.h)){if(ne.x=Te.x,ne.y=Te.y,z=Math.max(z,ne.y+ne.h),R=Math.max(R,ne.x+ne.w),ne.w===Te.w&&ne.h===Te.h){var je=A.pop();ae<A.length&&(A[ae]=je)}else ne.h===Te.h?(Te.x+=ne.w,Te.w-=ne.w):ne.w===Te.w?(Te.y+=ne.h,Te.h-=ne.h):(A.push({x:Te.x+ne.w,y:Te.y,w:Te.w-ne.w,h:ne.h}),Te.y+=ne.h,Te.h-=ne.h);break}}return{w:R,h:z,fill:o/(R*z)||0}}po.prototype={destroy:function(){this.buf=null},readFields:function(o,u,v){for(v=v||this.length;this.pos<v;){var _=this.readVarint(),S=_>>3,A=this.pos;this.type=7&_,o(S,u,this),this.pos===A&&this.skip(_)}return u},readMessage:function(o,u){return this.readFields(o,u,this.readVarint()+this.pos)},readFixed32:function(){var o=un(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=kn(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=un(this.buf,this.pos)+4294967296*un(this.buf,this.pos+4);return this.pos+=8,o},readSFixed64:function(){var o=un(this.buf,this.pos)+4294967296*kn(this.buf,this.pos+4);return this.pos+=8,o},readFloat:function(){var o=cp(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=cp(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var u,v,_=this.buf;return u=127&(v=_[this.pos++]),v<128?u:(u|=(127&(v=_[this.pos++]))<<7,v<128?u:(u|=(127&(v=_[this.pos++]))<<14,v<128?u:(u|=(127&(v=_[this.pos++]))<<21,v<128?u:function(S,A,R){var z,W,q=R.buf;if(z=(112&(W=q[R.pos++]))>>4,W<128||(z|=(127&(W=q[R.pos++]))<<3,W<128)||(z|=(127&(W=q[R.pos++]))<<10,W<128)||(z|=(127&(W=q[R.pos++]))<<17,W<128)||(z|=(127&(W=q[R.pos++]))<<24,W<128)||(z|=(1&(W=q[R.pos++]))<<31,W<128))return xf(S,z,A);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(v=_[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var o=this.readVarint()+this.pos,u=this.pos;return this.pos=o,o-u>=12&&hh?function(v,_,S){return hh.decode(v.subarray(_,S))}(this.buf,u,o):function(v,_,S){for(var A="",R=_;R<S;){var z,W,q,ne=v[R],ae=null,Te=ne>239?4:ne>223?3:ne>191?2:1;if(R+Te>S)break;Te===1?ne<128&&(ae=ne):Te===2?(192&(z=v[R+1]))==128&&(ae=(31&ne)<<6|63&z)<=127&&(ae=null):Te===3?(W=v[R+2],(192&(z=v[R+1]))==128&&(192&W)==128&&((ae=(15&ne)<<12|(63&z)<<6|63&W)<=2047||ae>=55296&&ae<=57343)&&(ae=null)):Te===4&&(W=v[R+2],q=v[R+3],(192&(z=v[R+1]))==128&&(192&W)==128&&(192&q)==128&&((ae=(15&ne)<<18|(63&z)<<12|(63&W)<<6|63&q)<=65535||ae>=1114112)&&(ae=null)),ae===null?(ae=65533,Te=1):ae>65535&&(ae-=65536,A+=String.fromCharCode(ae>>>10&1023|55296),ae=56320|1023&ae),A+=String.fromCharCode(ae),R+=Te}return A}(this.buf,u,o)},readBytes:function(){var o=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,o);return this.pos=o,u},readPackedVarint:function(o,u){if(this.type!==po.Bytes)return o.push(this.readVarint(u));var v=Ui(this);for(o=o||[];this.pos<v;)o.push(this.readVarint(u));return o},readPackedSVarint:function(o){if(this.type!==po.Bytes)return o.push(this.readSVarint());var u=Ui(this);for(o=o||[];this.pos<u;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==po.Bytes)return o.push(this.readBoolean());var u=Ui(this);for(o=o||[];this.pos<u;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==po.Bytes)return o.push(this.readFloat());var u=Ui(this);for(o=o||[];this.pos<u;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==po.Bytes)return o.push(this.readDouble());var u=Ui(this);for(o=o||[];this.pos<u;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==po.Bytes)return o.push(this.readFixed32());var u=Ui(this);for(o=o||[];this.pos<u;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==po.Bytes)return o.push(this.readSFixed32());var u=Ui(this);for(o=o||[];this.pos<u;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==po.Bytes)return o.push(this.readFixed64());var u=Ui(this);for(o=o||[];this.pos<u;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==po.Bytes)return o.push(this.readSFixed64());var u=Ui(this);for(o=o||[];this.pos<u;)o.push(this.readSFixed64());return o},skip:function(o){var u=7&o;if(u===po.Varint)for(;this.buf[this.pos++]>127;);else if(u===po.Bytes)this.pos=this.readVarint()+this.pos;else if(u===po.Fixed32)this.pos+=4;else{if(u!==po.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(o,u){this.writeVarint(o<<3|u)},realloc:function(o){for(var u=this.length||16;u<this.pos+o;)u*=2;if(u!==this.length){var v=new Uint8Array(u);v.set(this.buf),this.buf=v,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),on(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),on(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),on(this.buf,-1&o,this.pos),on(this.buf,Math.floor(o*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),on(this.buf,-1&o,this.pos),on(this.buf,Math.floor(o*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(u,v){var _,S;if(u>=0?(_=u%4294967296|0,S=u/4294967296|0):(S=~(-u/4294967296),4294967295^(_=~(-u%4294967296))?_=_+1|0:(_=0,S=S+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");v.realloc(10),function(A,R,z){z.buf[z.pos++]=127&A|128,A>>>=7,z.buf[z.pos++]=127&A|128,A>>>=7,z.buf[z.pos++]=127&A|128,A>>>=7,z.buf[z.pos++]=127&A|128,z.buf[z.pos]=127&(A>>>=7)}(_,0,v),function(A,R){var z=(7&A)<<4;R.buf[R.pos++]|=z|((A>>>=3)?128:0),A&&(R.buf[R.pos++]=127&A|((A>>>=7)?128:0),A&&(R.buf[R.pos++]=127&A|((A>>>=7)?128:0),A&&(R.buf[R.pos++]=127&A|((A>>>=7)?128:0),A&&(R.buf[R.pos++]=127&A|((A>>>=7)?128:0),A&&(R.buf[R.pos++]=127&A)))))}(S,v)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(Boolean(o))},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var u=this.pos;this.pos=function(_,S,A){for(var R,z,W=0;W<S.length;W++){if((R=S.charCodeAt(W))>55295&&R<57344){if(!z){R>56319||W+1===S.length?(_[A++]=239,_[A++]=191,_[A++]=189):z=R;continue}if(R<56320){_[A++]=239,_[A++]=191,_[A++]=189,z=R;continue}R=z-55296<<10|R-56320|65536,z=null}else z&&(_[A++]=239,_[A++]=191,_[A++]=189,z=null);R<128?_[A++]=R:(R<2048?_[A++]=R>>6|192:(R<65536?_[A++]=R>>12|224:(_[A++]=R>>18|240,_[A++]=R>>12&63|128),_[A++]=R>>6&63|128),_[A++]=63&R|128)}return A}(this.buf,o,this.pos);var v=this.pos-u;v>=128&&J(u,v,this),this.pos=u-1,this.writeVarint(v),this.pos+=v},writeFloat:function(o){this.realloc(4),fp(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),fp(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var u=o.length;this.writeVarint(u),this.realloc(u);for(var v=0;v<u;v++)this.buf[this.pos++]=o[v]},writeRawMessage:function(o,u){this.pos++;var v=this.pos;o(u,this);var _=this.pos-v;_>=128&&J(v,_,this),this.pos=v-1,this.writeVarint(_),this.pos+=_},writeMessage:function(o,u,v){this.writeTag(o,po.Bytes),this.writeRawMessage(u,v)},writePackedVarint:function(o,u){u.length&&this.writeMessage(o,he,u)},writePackedSVarint:function(o,u){u.length&&this.writeMessage(o,qe,u)},writePackedBoolean:function(o,u){u.length&&this.writeMessage(o,lr,u)},writePackedFloat:function(o,u){u.length&&this.writeMessage(o,er,u)},writePackedDouble:function(o,u){u.length&&this.writeMessage(o,wr,u)},writePackedFixed32:function(o,u){u.length&&this.writeMessage(o,cr,u)},writePackedSFixed32:function(o,u){u.length&&this.writeMessage(o,Hr,u)},writePackedFixed64:function(o,u){u.length&&this.writeMessage(o,tn,u)},writePackedSFixed64:function(o,u){u.length&&this.writeMessage(o,an,u)},writeBytesField:function(o,u){this.writeTag(o,po.Bytes),this.writeBytes(u)},writeFixed32Field:function(o,u){this.writeTag(o,po.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(o,u){this.writeTag(o,po.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(o,u){this.writeTag(o,po.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(o,u){this.writeTag(o,po.Fixed64),this.writeSFixed64(u)},writeVarintField:function(o,u){this.writeTag(o,po.Varint),this.writeVarint(u)},writeSVarintField:function(o,u){this.writeTag(o,po.Varint),this.writeSVarint(u)},writeStringField:function(o,u){this.writeTag(o,po.Bytes),this.writeString(u)},writeFloatField:function(o,u){this.writeTag(o,po.Fixed32),this.writeFloat(u)},writeDoubleField:function(o,u){this.writeTag(o,po.Fixed64),this.writeDouble(u)},writeBooleanField:function(o,u){this.writeVarintField(o,Boolean(u))}};var Qr=function(o,u){var v=u.pixelRatio,_=u.version,S=u.stretchX,A=u.stretchY,R=u.content;this.paddedRect=o,this.pixelRatio=v,this.stretchX=S,this.stretchY=A,this.content=R,this.version=_},zn={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};zn.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},zn.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},zn.tlbr.get=function(){return this.tl.concat(this.br)},zn.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Qr.prototype,zn);var Er=function(o,u){var v={},_={};this.haveRenderCallbacks=[];var S=[];this.addImages(o,v,S),this.addImages(u,_,S);var A=tr(S),R=new Xs({width:A.w||1,height:A.h||1});for(var z in o){var W=o[z],q=v[z].paddedRect;Xs.copy(W.data,R,{x:0,y:0},{x:q.x+1,y:q.y+1},W.data)}for(var ne in u){var ae=u[ne],Te=_[ne].paddedRect,je=Te.x+1,Be=Te.y+1,Je=ae.data.width,Qe=ae.data.height;Xs.copy(ae.data,R,{x:0,y:0},{x:je,y:Be},ae.data),Xs.copy(ae.data,R,{x:0,y:Qe-1},{x:je,y:Be-1},{width:Je,height:1}),Xs.copy(ae.data,R,{x:0,y:0},{x:je,y:Be+Qe},{width:Je,height:1}),Xs.copy(ae.data,R,{x:Je-1,y:0},{x:je-1,y:Be},{width:1,height:Qe}),Xs.copy(ae.data,R,{x:0,y:0},{x:je+Je,y:Be},{width:1,height:Qe})}this.image=R,this.iconPositions=v,this.patternPositions=_};Er.prototype.addImages=function(a,o,u){for(var v in a){var _=a[v],S={x:0,y:0,w:_.data.width+2,h:_.data.height+2};u.push(S),o[v]=new Qr(S,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(v)}},Er.prototype.patchUpdatedImages=function(a,o){for(var u in a.dispatchRenderCallbacks(this.haveRenderCallbacks),a.updatedImages)this.patchUpdatedImage(this.iconPositions[u],a.getImage(u),o),this.patchUpdatedImage(this.patternPositions[u],a.getImage(u),o)},Er.prototype.patchUpdatedImage=function(a,o,u){if(a&&o&&a.version!==o.version){a.version=o.version;var v=a.tl;u.update(o.data,void 0,{x:v[0],y:v[1]})}},Kn("ImagePosition",Qr),Kn("ImageAtlas",Er);var qn={horizontal:1,vertical:2,horizontalOnly:3},Bn=function(){this.scale=1,this.fontStack="",this.imageName=null};Bn.forText=function(a,o){var u=new Bn;return u.scale=a||1,u.fontStack=o,u},Bn.forImage=function(a){var o=new Bn;return o.imageName=a,o};var pn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Rr(a,o,u,v,_,S,A,R,z,W,q,ne,ae,Te,je,Be){var Je,Qe=pn.fromFeature(a,_);ne===qn.vertical&&Qe.verticalizePunctuation();var Tt=rl.processBidirectionalText,Zt=rl.processStyledBidirectionalText;if(Tt&&Qe.sections.length===1){Je=[];for(var ar=0,Lr=Tt(Qe.toString(),ta(Qe,W,S,o,v,Te,je));ar<Lr.length;ar+=1){var xr=Lr[ar],dn=new pn;dn.text=xr,dn.sections=Qe.sections;for(var _n=0;_n<xr.length;_n++)dn.sectionIndex.push(0);Je.push(dn)}}else if(Zt){Je=[];for(var ci=0,_i=Zt(Qe.text,Qe.sectionIndex,ta(Qe,W,S,o,v,Te,je));ci<_i.length;ci+=1){var vi=_i[ci],ti=new pn;ti.text=vi[0],ti.sectionIndex=vi[1],ti.sections=Qe.sections,Je.push(ti)}}else Je=function(xi,Pa){for(var aa=[],to=xi.text,Fi=0,Ra=0,Do=Pa;Ra<Do.length;Ra+=1){var Fo=Do[Ra];aa.push(xi.substring(Fi,Fo)),Fi=Fo}return Fi<to.length&&aa.push(xi.substring(Fi,to.length)),aa}(Qe,ta(Qe,W,S,o,v,Te,je));var Zi=[],Pi={positionedLines:Zi,text:Qe.toString(),top:q[1],bottom:q[1],left:q[0],right:q[0],writingMode:ne,iconsInText:!1,verticalizable:!1};return function(xi,Pa,aa,to,Fi,Ra,Do,Fo,is,as,Yo,qs){for(var Ls=0,ol=-17,Qs=0,$u=0,du=Fo==="right"?1:Fo==="left"?0:.5,Js=0,eu=0,za=Fi;eu<za.length;eu+=1){var La=za[eu];La.trim();var To=La.getMaxScale(),Bo=24*(To-1),sl={positionedGlyphs:[],lineOffset:0};xi.positionedLines[Js]=sl;var Vo=sl.positionedGlyphs,os=0;if(La.length()){for(var Bu=0;Bu<La.length();Bu++){var Ua=La.getSection(Bu),Nu=La.getSectionIndex(Bu),pc=La.getCharCode(Bu),ef=0,Au=null,Xi=null,vh=null,vu=24,Ko=!(is===qn.horizontal||!Yo&&!hs(pc)||Yo&&(mr[pc]||(zh=pc,Ln.Arabic(zh)||Ln["Arabic Supplement"](zh)||Ln["Arabic Extended-A"](zh)||Ln["Arabic Presentation Forms-A"](zh)||Ln["Arabic Presentation Forms-B"](zh))));if(Ua.imageName){var sd=to[Ua.imageName];if(!sd)continue;vh=Ua.imageName,xi.iconsInText=xi.iconsInText||!0,Xi=sd.paddedRect;var gl=sd.displaySize;Ua.scale=24*Ua.scale/qs,ef=Bo+(24-gl[1]*Ua.scale),vu=(Au={width:gl[0],height:gl[1],left:1,top:-3,advance:Ko?gl[1]:gl[0]}).advance;var ud=Ko?gl[0]*Ua.scale-24*To:gl[1]*Ua.scale-24*To;ud>0&&ud>os&&(os=ud)}else{var Lp=aa[Ua.fontStack],kp=Lp&&Lp[pc];if(kp&&kp.rect)Xi=kp.rect,Au=kp.metrics;else{var Id=Pa[Ua.fontStack],ld=Id&&Id[pc];if(!ld)continue;Au=ld.metrics}ef=24*(To-Ua.scale)}Ko?(xi.verticalizable=!0,Vo.push({glyph:pc,imageName:vh,x:Ls,y:ol+ef,vertical:Ko,scale:Ua.scale,fontStack:Ua.fontStack,sectionIndex:Nu,metrics:Au,rect:Xi}),Ls+=vu*Ua.scale+as):(Vo.push({glyph:pc,imageName:vh,x:Ls,y:ol+ef,vertical:Ko,scale:Ua.scale,fontStack:Ua.fontStack,sectionIndex:Nu,metrics:Au,rect:Xi}),Ls+=Au.advance*Ua.scale+as)}Vo.length!==0&&(Qs=Math.max(Ls-as,Qs),Fn(Vo,0,Vo.length-1,du,os)),Ls=0;var Dp=Ra*To+os;sl.lineOffset=Math.max(os,Bo),ol+=Dp,$u=Math.max(Dp,$u),++Js}else ol+=Ra,++Js}var zh,dc=ol- -17,cd=ji(Do),mh=cd.horizontalAlign,Go=cd.verticalAlign;(function(Cs,fd,Rd,Fp,hd,pd,Bp,dd,dp){var gh,vp=(fd-Rd)*hd;gh=pd!==Bp?-dd*Fp- -17:(-Fp*dp+.5)*Bp;for(var mp=0,Np=Cs;mp<Np.length;mp+=1)for(var Gf=0,qu=Np[mp].positionedGlyphs;Gf<qu.length;Gf+=1){var Hf=qu[Gf];Hf.x+=vp,Hf.y+=gh}})(xi.positionedLines,du,mh,Go,Qs,$u,Ra,dc,Fi.length),xi.top+=-Go*dc,xi.bottom=xi.top+dc,xi.left+=-mh*Qs,xi.right=xi.left+Qs}(Pi,o,u,v,Je,A,R,z,ne,W,ae,Be),!function(xi){for(var Pa=0,aa=xi;Pa<aa.length;Pa+=1)if(aa[Pa].positionedGlyphs.length!==0)return!1;return!0}(Zi)&&Pi}pn.fromFeature=function(a,o){for(var u=new pn,v=0;v<a.sections.length;v++){var _=a.sections[v];_.image?u.addImageSection(_):u.addTextSection(_,o)}return u},pn.prototype.length=function(){return this.text.length},pn.prototype.getSection=function(a){return this.sections[this.sectionIndex[a]]},pn.prototype.getSectionIndex=function(a){return this.sectionIndex[a]},pn.prototype.getCharCode=function(a){return this.text.charCodeAt(a)},pn.prototype.verticalizePunctuation=function(){this.text=function(a){for(var o="",u=0;u<a.length;u++){var v=a.charCodeAt(u+1)||null,_=a.charCodeAt(u-1)||null;o+=v&&hf(v)&&!$l[a[u+1]]||_&&hf(_)&&!$l[a[u-1]]||!$l[a[u]]?a[u]:$l[a[u]]}return o}(this.text)},pn.prototype.trim=function(){for(var a=0,o=0;o<this.text.length&&mr[this.text.charCodeAt(o)];o++)a++;for(var u=this.text.length,v=this.text.length-1;v>=0&&v>=a&&mr[this.text.charCodeAt(v)];v--)u--;this.text=this.text.substring(a,u),this.sectionIndex=this.sectionIndex.slice(a,u)},pn.prototype.substring=function(a,o){var u=new pn;return u.text=this.text.substring(a,o),u.sectionIndex=this.sectionIndex.slice(a,o),u.sections=this.sections,u},pn.prototype.toString=function(){return this.text},pn.prototype.getMaxScale=function(){var a=this;return this.sectionIndex.reduce(function(o,u){return Math.max(o,a.sections[u].scale)},0)},pn.prototype.addTextSection=function(a,o){this.text+=a.text,this.sections.push(Bn.forText(a.scale,a.fontStack||o));for(var u=this.sections.length-1,v=0;v<a.text.length;++v)this.sectionIndex.push(u)},pn.prototype.addImageSection=function(a){var o=a.image?a.image.name:"";if(o.length!==0){var u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Bn.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Kt("Reached maximum number of images 6401")}else Kt("Can't add FormattedSection with an empty image.")},pn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var mr={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},gn={};function Sn(a,o,u,v,_,S){if(o.imageName){var A=v[o.imageName];return A?A.displaySize[0]*o.scale*24/S+_:0}var R=u[o.fontStack],z=R&&R[a];return z?z.metrics.advance*o.scale+_:0}function sn(a,o,u,v){var _=Math.pow(a-o,2);return v?a<o?_/2:2*_:_+Math.abs(u)*u}function In(a,o,u){var v=0;return a===10&&(v-=1e4),u&&(v+=150),a!==40&&a!==65288||(v+=50),o!==41&&o!==65289||(v+=50),v}function Tn(a,o,u,v,_,S){for(var A=null,R=sn(o,u,_,S),z=0,W=v;z<W.length;z+=1){var q=W[z],ne=sn(o-q.x,u,_,S)+q.badness;ne<=R&&(A=q,R=ne)}return{index:a,x:o,priorBreak:A,badness:R}}function ta(a,o,u,v,_,S,A){if(S!=="point")return[];if(!a)return[];for(var R,z=[],W=function(Je,Qe,Tt,Zt,ar,Lr){for(var xr=0,dn=0;dn<Je.length();dn++){var _n=Je.getSection(dn);xr+=Sn(Je.getCharCode(dn),_n,Zt,ar,Qe,Lr)}return xr/Math.max(1,Math.ceil(xr/Tt))}(a,o,u,v,_,A),q=a.text.indexOf("\u200B")>=0,ne=0,ae=0;ae<a.length();ae++){var Te=a.getSection(ae),je=a.getCharCode(ae);if(mr[je]||(ne+=Sn(je,Te,v,_,o,A)),ae<a.length()-1){var Be=!((R=je)<11904||!(Ln["Bopomofo Extended"](R)||Ln.Bopomofo(R)||Ln["CJK Compatibility Forms"](R)||Ln["CJK Compatibility Ideographs"](R)||Ln["CJK Compatibility"](R)||Ln["CJK Radicals Supplement"](R)||Ln["CJK Strokes"](R)||Ln["CJK Symbols and Punctuation"](R)||Ln["CJK Unified Ideographs Extension A"](R)||Ln["CJK Unified Ideographs"](R)||Ln["Enclosed CJK Letters and Months"](R)||Ln["Halfwidth and Fullwidth Forms"](R)||Ln.Hiragana(R)||Ln["Ideographic Description Characters"](R)||Ln["Kangxi Radicals"](R)||Ln["Katakana Phonetic Extensions"](R)||Ln.Katakana(R)||Ln["Vertical Forms"](R)||Ln["Yi Radicals"](R)||Ln["Yi Syllables"](R)));(gn[je]||Be||Te.imageName)&&z.push(Tn(ae+1,ne,W,z,In(je,a.getCharCode(ae+1),Be&&q),!1))}}return function Je(Qe){return Qe?Je(Qe.priorBreak).concat(Qe.index):[]}(Tn(a.length(),ne,W,z,0,!0))}function ji(a){var o=.5,u=.5;switch(a){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:o,verticalAlign:u}}function Fn(a,o,u,v,_){if(v||_)for(var S=a[u],A=(a[u].x+S.metrics.advance*S.scale)*v,R=o;R<=u;R++)a[R].x-=A,a[R].y+=_}function Dn(a,o,u,v,_,S){var A,R=a.image;if(R.content){var z=R.content,W=R.pixelRatio||1;A=[z[0]/W,z[1]/W,R.displaySize[0]-z[2]/W,R.displaySize[1]-z[3]/W]}var q,ne,ae,Te,je=o.left*S,Be=o.right*S;u==="width"||u==="both"?(Te=_[0]+je-v[3],ne=_[0]+Be+v[1]):ne=(Te=_[0]+(je+Be-R.displaySize[0])/2)+R.displaySize[0];var Je=o.top*S,Qe=o.bottom*S;return u==="height"||u==="both"?(q=_[1]+Je-v[0],ae=_[1]+Qe+v[2]):ae=(q=_[1]+(Je+Qe-R.displaySize[1])/2)+R.displaySize[1],{image:R,top:q,right:ne,bottom:ae,left:Te,collisionPadding:A}}gn[10]=!0,gn[32]=!0,gn[38]=!0,gn[40]=!0,gn[41]=!0,gn[43]=!0,gn[45]=!0,gn[47]=!0,gn[173]=!0,gn[183]=!0,gn[8203]=!0,gn[8208]=!0,gn[8211]=!0,gn[8231]=!0;var Mi=function(a){function o(u,v,_,S){a.call(this,u,v),this.angle=_,S!==void 0&&(this.segment=S)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.clone=function(){return new o(this.x,this.y,this.angle,this.segment)},o}(pe);function qi(a,o){var u=o.expression;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new ma(a+1))};if(u.kind==="source")return{kind:"source"};for(var v=u.zoomStops,_=u.interpolationType,S=0;S<v.length&&v[S]<=a;)S++;for(var A=S=Math.max(0,S-1);A<v.length&&v[A]<a+1;)A++;A=Math.min(v.length-1,A);var R=v[S],z=v[A];return u.kind==="composite"?{kind:"composite",minZoom:R,maxZoom:z,interpolationType:_}:{kind:"camera",minZoom:R,maxZoom:z,minSize:u.evaluate(new ma(R)),maxSize:u.evaluate(new ma(z)),interpolationType:_}}function Ea(a,o,u){var v=o.uSize,_=u.lowerSize;return a.kind==="source"?_/128:a.kind==="composite"?Po(_/128,u.upperSize/128,o.uSizeT):v}function Ao(a,o){var u=0,v=0;if(a.kind==="constant")v=a.layoutSize;else if(a.kind!=="source"){var _=a.interpolationType,S=_?yt(Et.interpolationFactor(_,o,a.minZoom,a.maxZoom),0,1):0;a.kind==="camera"?v=Po(a.minSize,a.maxSize,S):u=S}return{uSizeT:u,uSize:v}}Kn("Anchor",Mi);var ns=Object.freeze({__proto__:null,getSizeData:qi,evaluateSizeForFeature:Ea,evaluateSizeForZoom:Ao,SIZE_PACK_FACTOR:128});function ia(a,o,u,v,_){if(o.segment===void 0)return!0;for(var S=o,A=o.segment+1,R=0;R>-u/2;){if(--A<0)return!1;R-=a[A].dist(S),S=a[A]}R+=a[A].dist(a[A+1]),A++;for(var z=[],W=0;R<u/2;){var q=a[A],ne=a[A+1];if(!ne)return!1;var ae=a[A-1].angleTo(q)-q.angleTo(ne);for(ae=Math.abs((ae+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:R,angleDelta:ae}),W+=ae;R-z[0].distance>v;)W-=z.shift().angleDelta;if(W>_)return!1;A++,R+=q.dist(ne)}return!0}function Zo(a){for(var o=0,u=0;u<a.length-1;u++)o+=a[u].dist(a[u+1]);return o}function Io(a,o,u){return a?.6*o*u:0}function Os(a,o){return Math.max(a?a.right-a.left:0,o?o.right-o.left:0)}function Is(a,o,u,v,_,S){for(var A=Io(u,_,S),R=Os(u,v)*S,z=0,W=Zo(a)/2,q=0;q<a.length-1;q++){var ne=a[q],ae=a[q+1],Te=ne.dist(ae);if(z+Te>W){var je=(W-z)/Te,Be=Po(ne.x,ae.x,je),Je=Po(ne.y,ae.y,je),Qe=new Mi(Be,Je,ae.angleTo(ne),q);return Qe._round(),!A||ia(a,Qe,R,A,o)?Qe:void 0}z+=Te}}function lu(a,o,u,v,_,S,A,R,z){var W=Io(v,S,A),q=Os(v,_),ne=q*A,ae=a[0].x===0||a[0].x===z||a[0].y===0||a[0].y===z;return o-ne<o/4&&(o=ne+o/4),function Te(je,Be,Je,Qe,Tt,Zt,ar,Lr,xr){for(var dn=Zt/2,_n=Zo(je),ci=0,_i=Be-Je,vi=[],ti=0;ti<je.length-1;ti++){for(var Zi=je[ti],Pi=je[ti+1],xi=Zi.dist(Pi),Pa=Pi.angleTo(Zi);_i+Je<ci+xi;){var aa=((_i+=Je)-ci)/xi,to=Po(Zi.x,Pi.x,aa),Fi=Po(Zi.y,Pi.y,aa);if(to>=0&&to<xr&&Fi>=0&&Fi<xr&&_i-dn>=0&&_i+dn<=_n){var Ra=new Mi(to,Fi,Pa,ti);Ra._round(),Qe&&!ia(je,Ra,Zt,Qe,Tt)||vi.push(Ra)}}ci+=xi}return Lr||vi.length||ar||(vi=Te(je,ci/2,Je,Qe,Tt,Zt,ar,!0,xr)),vi}(a,ae?o/2*R%o:(q/2+2*S)*A*R%o,o,W,u,ne,ae,!1,z)}function cu(a,o,u,v,_){for(var S=[],A=0;A<a.length;A++)for(var R=a[A],z=void 0,W=0;W<R.length-1;W++){var q=R[W],ne=R[W+1];q.x<o&&ne.x<o||(q.x<o?q=new pe(o,q.y+(o-q.x)/(ne.x-q.x)*(ne.y-q.y))._round():ne.x<o&&(ne=new pe(o,q.y+(o-q.x)/(ne.x-q.x)*(ne.y-q.y))._round()),q.y<u&&ne.y<u||(q.y<u?q=new pe(q.x+(u-q.y)/(ne.y-q.y)*(ne.x-q.x),u)._round():ne.y<u&&(ne=new pe(q.x+(u-q.y)/(ne.y-q.y)*(ne.x-q.x),u)._round()),q.x>=v&&ne.x>=v||(q.x>=v?q=new pe(v,q.y+(v-q.x)/(ne.x-q.x)*(ne.y-q.y))._round():ne.x>=v&&(ne=new pe(v,q.y+(v-q.x)/(ne.x-q.x)*(ne.y-q.y))._round()),q.y>=_&&ne.y>=_||(q.y>=_?q=new pe(q.x+(_-q.y)/(ne.y-q.y)*(ne.x-q.x),_)._round():ne.y>=_&&(ne=new pe(q.x+(_-q.y)/(ne.y-q.y)*(ne.x-q.x),_)._round()),z&&q.equals(z[z.length-1])||S.push(z=[q]),z.push(ne)))))}return S}function fu(a,o,u,v){var _=[],S=a.image,A=S.pixelRatio,R=S.paddedRect.w-2,z=S.paddedRect.h-2,W=a.right-a.left,q=a.bottom-a.top,ne=S.stretchX||[[0,R]],ae=S.stretchY||[[0,z]],Te=function(Fi,Ra){return Fi+Ra[1]-Ra[0]},je=ne.reduce(Te,0),Be=ae.reduce(Te,0),Je=R-je,Qe=z-Be,Tt=0,Zt=je,ar=0,Lr=Be,xr=0,dn=Je,_n=0,ci=Qe;if(S.content&&v){var _i=S.content;Tt=Xo(ne,0,_i[0]),ar=Xo(ae,0,_i[1]),Zt=Xo(ne,_i[0],_i[2]),Lr=Xo(ae,_i[1],_i[3]),xr=_i[0]-Tt,_n=_i[1]-ar,dn=_i[2]-_i[0]-Zt,ci=_i[3]-_i[1]-Lr}var vi=function(Fi,Ra,Do,Fo){var is=Ns(Fi.stretch-Tt,Zt,W,a.left),as=Ga(Fi.fixed-xr,dn,Fi.stretch,je),Yo=Ns(Ra.stretch-ar,Lr,q,a.top),qs=Ga(Ra.fixed-_n,ci,Ra.stretch,Be),Ls=Ns(Do.stretch-Tt,Zt,W,a.left),ol=Ga(Do.fixed-xr,dn,Do.stretch,je),Qs=Ns(Fo.stretch-ar,Lr,q,a.top),$u=Ga(Fo.fixed-_n,ci,Fo.stretch,Be),du=new pe(is,Yo),Js=new pe(Ls,Yo),eu=new pe(Ls,Qs),za=new pe(is,Qs),La=new pe(as/A,qs/A),To=new pe(ol/A,$u/A),Bo=o*Math.PI/180;if(Bo){var sl=Math.sin(Bo),Vo=Math.cos(Bo),os=[Vo,-sl,sl,Vo];du._matMult(os),Js._matMult(os),za._matMult(os),eu._matMult(os)}var Bu=Fi.stretch+Fi.fixed,Ua=Ra.stretch+Ra.fixed;return{tl:du,tr:Js,bl:za,br:eu,tex:{x:S.paddedRect.x+1+Bu,y:S.paddedRect.y+1+Ua,w:Do.stretch+Do.fixed-Bu,h:Fo.stretch+Fo.fixed-Ua},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:La,pixelOffsetBR:To,minFontScaleX:dn/A/W,minFontScaleY:ci/A/q,isSDF:u}};if(v&&(S.stretchX||S.stretchY))for(var ti=pa(ne,Je,je),Zi=pa(ae,Qe,Be),Pi=0;Pi<ti.length-1;Pi++)for(var xi=ti[Pi],Pa=ti[Pi+1],aa=0;aa<Zi.length-1;aa++)_.push(vi(xi,Zi[aa],Pa,Zi[aa+1]));else _.push(vi({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:R+1},{fixed:0,stretch:z+1}));return _}function Xo(a,o,u){for(var v=0,_=0,S=a;_<S.length;_+=1){var A=S[_];v+=Math.max(o,Math.min(u,A[1]))-Math.max(o,Math.min(u,A[0]))}return v}function pa(a,o,u){for(var v=[{fixed:-1,stretch:0}],_=0,S=a;_<S.length;_+=1){var A=S[_],R=A[0],z=A[1],W=v[v.length-1];v.push({fixed:R-W.stretch,stretch:W.stretch}),v.push({fixed:R-W.stretch,stretch:W.stretch+(z-R)})}return v.push({fixed:o+1,stretch:u}),v}function Ns(a,o,u,v){return a/o*u+v}function Ga(a,o,u,v){return a-o*u/v}var Rs=function(o,u,v,_,S,A,R,z,W,q){if(this.boxStartIndex=o.length,W){var ne=A.top,ae=A.bottom,Te=A.collisionPadding;Te&&(ne-=Te[1],ae+=Te[3]);var je=ae-ne;je>0&&(je=Math.max(10,je),this.circleDiameter=je)}else{var Be=A.top*R-z,Je=A.bottom*R+z,Qe=A.left*R-z,Tt=A.right*R+z,Zt=A.collisionPadding;if(Zt&&(Qe-=Zt[0]*R,Be-=Zt[1]*R,Tt+=Zt[2]*R,Je+=Zt[3]*R),q){var ar=new pe(Qe,Be),Lr=new pe(Tt,Be),xr=new pe(Qe,Je),dn=new pe(Tt,Je),_n=q*Math.PI/180;ar._rotate(_n),Lr._rotate(_n),xr._rotate(_n),dn._rotate(_n),Qe=Math.min(ar.x,Lr.x,xr.x,dn.x),Tt=Math.max(ar.x,Lr.x,xr.x,dn.x),Be=Math.min(ar.y,Lr.y,xr.y,dn.y),Je=Math.max(ar.y,Lr.y,xr.y,dn.y)}o.emplaceBack(u.x,u.y,Qe,Be,Tt,Je,v,_,S)}this.boxEndIndex=o.length},ki=function(o,u){if(o===void 0&&(o=[]),u===void 0&&(u=ca),this.data=o,this.length=this.data.length,this.compare=u,this.length>0)for(var v=(this.length>>1)-1;v>=0;v--)this._down(v)};function ca(a,o){return a<o?-1:a>o?1:0}function yo(a,o,u){o===void 0&&(o=1),u===void 0&&(u=!1);for(var v=1/0,_=1/0,S=-1/0,A=-1/0,R=a[0],z=0;z<R.length;z++){var W=R[z];(!z||W.x<v)&&(v=W.x),(!z||W.y<_)&&(_=W.y),(!z||W.x>S)&&(S=W.x),(!z||W.y>A)&&(A=W.y)}var q=Math.min(S-v,A-_),ne=q/2,ae=new ki([],wu);if(q===0)return new pe(v,_);for(var Te=v;Te<S;Te+=q)for(var je=_;je<A;je+=q)ae.push(new hu(Te+ne,je+ne,ne,a));for(var Be=function(Tt){for(var Zt=0,ar=0,Lr=0,xr=Tt[0],dn=0,_n=xr.length,ci=_n-1;dn<_n;ci=dn++){var _i=xr[dn],vi=xr[ci],ti=_i.x*vi.y-vi.x*_i.y;ar+=(_i.x+vi.x)*ti,Lr+=(_i.y+vi.y)*ti,Zt+=3*ti}return new hu(ar/Zt,Lr/Zt,0,Tt)}(a),Je=ae.length;ae.length;){var Qe=ae.pop();(Qe.d>Be.d||!Be.d)&&(Be=Qe,u&&console.log("found best %d after %d probes",Math.round(1e4*Qe.d)/1e4,Je)),Qe.max-Be.d<=o||(ae.push(new hu(Qe.p.x-(ne=Qe.h/2),Qe.p.y-ne,ne,a)),ae.push(new hu(Qe.p.x+ne,Qe.p.y-ne,ne,a)),ae.push(new hu(Qe.p.x-ne,Qe.p.y+ne,ne,a)),ae.push(new hu(Qe.p.x+ne,Qe.p.y+ne,ne,a)),Je+=4)}return u&&(console.log("num probes: "+Je),console.log("best distance: "+Be.d)),Be.p}function wu(a,o){return o.max-a.max}function hu(a,o,u,v){this.p=new pe(a,o),this.h=u,this.d=function(_,S){for(var A=!1,R=1/0,z=0;z<S.length;z++)for(var W=S[z],q=0,ne=W.length,ae=ne-1;q<ne;ae=q++){var Te=W[q],je=W[ae];Te.y>_.y!=je.y>_.y&&_.x<(je.x-Te.x)*(_.y-Te.y)/(je.y-Te.y)+Te.x&&(A=!A),R=Math.min(R,sc(_,Te,je))}return(A?1:-1)*Math.sqrt(R)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}ki.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},ki.prototype.pop=function(){if(this.length!==0){var a=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),a}},ki.prototype.peek=function(){return this.data[0]},ki.prototype._up=function(a){for(var o=this.data,u=this.compare,v=o[a];a>0;){var _=a-1>>1,S=o[_];if(u(v,S)>=0)break;o[a]=S,a=_}o[a]=v},ki.prototype._down=function(a){for(var o=this.data,u=this.compare,v=this.length>>1,_=o[a];a<v;){var S=1+(a<<1),A=o[S],R=S+1;if(R<this.length&&u(o[R],A)<0&&(S=R,A=o[R]),u(A,_)>=0)break;o[a]=A,a=S}o[a]=_};var Ge=Number.POSITIVE_INFINITY;function hr(a,o){return o[1]!==Ge?function(u,v,_){var S=0,A=0;switch(v=Math.abs(v),_=Math.abs(_),u){case"top-right":case"top-left":case"top":A=_-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-_}switch(u){case"top-right":case"bottom-right":case"right":S=-v;break;case"top-left":case"bottom-left":case"left":S=v}return[S,A]}(a,o[0],o[1]):function(u,v){var _=0,S=0;v<0&&(v=0);var A=v/Math.sqrt(2);switch(u){case"top-right":case"top-left":S=A-7;break;case"bottom-right":case"bottom-left":S=7-A;break;case"bottom":S=7-v;break;case"top":S=v-7}switch(u){case"top-right":case"bottom-right":_=-A;break;case"top-left":case"bottom-left":_=A;break;case"left":_=v;break;case"right":_=-v}return[_,S]}(a,o[0])}function Wt(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Wn(a,o,u,v,_,S,A,R,z,W,q,ne,ae,Te,je){var Be=function(ar,Lr,xr,dn,_n,ci,_i,vi){for(var ti=dn.layout.get("text-rotate").evaluate(ci,{})*Math.PI/180,Zi=[],Pi=0,xi=Lr.positionedLines;Pi<xi.length;Pi+=1)for(var Pa=xi[Pi],aa=0,to=Pa.positionedGlyphs;aa<to.length;aa+=1){var Fi=to[aa];if(Fi.rect){var Ra=Fi.rect||{},Do=4,Fo=!0,is=1,as=0,Yo=(_n||vi)&&Fi.vertical,qs=Fi.metrics.advance*Fi.scale/2;if(vi&&Lr.verticalizable&&(as=Pa.lineOffset/2-(Fi.imageName?-(24-Fi.metrics.width*Fi.scale)/2:24*(Fi.scale-1))),Fi.imageName){var Ls=_i[Fi.imageName];Fo=Ls.sdf,Do=1/(is=Ls.pixelRatio)}var ol=_n?[Fi.x+qs,Fi.y]:[0,0],Qs=_n?[0,0]:[Fi.x+qs+xr[0],Fi.y+xr[1]-as],$u=[0,0];Yo&&($u=Qs,Qs=[0,0]);var du=(Fi.metrics.left-Do)*Fi.scale-qs+Qs[0],Js=(-Fi.metrics.top-Do)*Fi.scale+Qs[1],eu=du+Ra.w*Fi.scale/is,za=Js+Ra.h*Fi.scale/is,La=new pe(du,Js),To=new pe(eu,Js),Bo=new pe(du,za),sl=new pe(eu,za);if(Yo){var Vo=new pe(-qs,qs- -17),os=-Math.PI/2,Bu=12-qs,Ua=new pe(22-Bu,-(Fi.imageName?Bu:0)),Nu=new(Function.prototype.bind.apply(pe,[null].concat($u)));La._rotateAround(os,Vo)._add(Ua)._add(Nu),To._rotateAround(os,Vo)._add(Ua)._add(Nu),Bo._rotateAround(os,Vo)._add(Ua)._add(Nu),sl._rotateAround(os,Vo)._add(Ua)._add(Nu)}if(ti){var pc=Math.sin(ti),ef=Math.cos(ti),Au=[ef,-pc,pc,ef];La._matMult(Au),To._matMult(Au),Bo._matMult(Au),sl._matMult(Au)}var Xi=new pe(0,0),vh=new pe(0,0);Zi.push({tl:La,tr:To,bl:Bo,br:sl,tex:Ra,writingMode:Lr.writingMode,glyphOffset:ol,sectionIndex:Fi.sectionIndex,isSDF:Fo,pixelOffsetTL:Xi,pixelOffsetBR:vh,minFontScaleX:0,minFontScaleY:0})}}return Zi}(0,u,R,_,S,A,v,a.allowVerticalPlacement),Je=a.textSizeData,Qe=null;Je.kind==="source"?(Qe=[128*_.layout.get("text-size").evaluate(A,{})])[0]>32640&&Kt(a.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Je.kind==="composite"&&((Qe=[128*Te.compositeTextSizes[0].evaluate(A,{},je),128*Te.compositeTextSizes[1].evaluate(A,{},je)])[0]>32640||Qe[1]>32640)&&Kt(a.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),a.addSymbols(a.text,Be,Qe,R,S,A,W,o,z.lineStartIndex,z.lineLength,ae,je);for(var Tt=0,Zt=q;Tt<Zt.length;Tt+=1)ne[Zt[Tt]]=a.text.placedSymbolArray.length-1;return 4*Be.length}function va(a){for(var o in a)return a[o];return null}function De(a,o,u,v){var _=a.compareText;if(o in _){for(var S=_[o],A=S.length-1;A>=0;A--)if(v.dist(S[A])<u)return!0}else _[o]=[];return _[o].push(v),!1}var Ee=jf.VectorTileFeature.types,it=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Bt(a,o,u,v,_,S,A,R,z,W,q,ne,ae){var Te=R?Math.min(32640,Math.round(R[0])):0,je=R?Math.min(32640,Math.round(R[1])):0;a.emplaceBack(o,u,Math.round(32*v),Math.round(32*_),S,A,(Te<<1)+(z?1:0),je,16*W,16*q,256*ne,256*ae)}function ur(a,o,u){a.emplaceBack(o.x,o.y,u),a.emplaceBack(o.x,o.y,u),a.emplaceBack(o.x,o.y,u),a.emplaceBack(o.x,o.y,u)}function st(a){for(var o=0,u=a.sections;o<u.length;o+=1)if(bc(u[o].text))return!0;return!1}var ut=function(o){this.layoutVertexArray=new df,this.indexArray=new wc,this.programConfigurations=o,this.segments=new ye,this.dynamicLayoutVertexArray=new su,this.opacityVertexArray=new Fa,this.placedSymbolArray=new m};ut.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},ut.prototype.upload=function(a,o,u,v){this.isEmpty()||(u&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,fv.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Md.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,it,!0),this.opacityVertexBuffer.itemSize=1),(u||v)&&this.programConfigurations.upload(a))},ut.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Kn("SymbolBuffers",ut);var bt=function(o,u,v){this.layoutVertexArray=new o,this.layoutAttributes=u,this.indexArray=new v,this.segments=new ye,this.collisionVertexArray=new Xl};bt.prototype.upload=function(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,hv.members,!0)},bt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Kn("CollisionBuffers",bt);var Se=function(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(A){return A.id}),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Cu([]),this.placementViewportMatrix=Cu([]);var u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=qi(this.zoom,u["text-size"]),this.iconSizeData=qi(this.zoom,u["icon-size"]);var v=this.layers[0].layout,_=v.get("symbol-sort-key"),S=v.get("symbol-z-order");this.canOverlap=v.get("text-allow-overlap")||v.get("icon-allow-overlap")||v.get("text-ignore-placement")||v.get("icon-ignore-placement"),this.sortFeaturesByKey=S!=="viewport-y"&&_.constantOr(1)!==void 0,this.sortFeaturesByY=(S==="viewport-y"||S==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,v.get("symbol-placement")==="point"&&(this.writingModes=v.get("text-writing-mode").map(function(A){return qn[A]})),this.stateDependentLayerIds=this.layers.filter(function(A){return A.isStateDependent()}).map(function(A){return A.id}),this.sourceID=o.sourceID};Se.prototype.createArrays=function(){this.text=new ut(new na(this.layers,this.zoom,function(a){return/^text/.test(a)})),this.icon=new ut(new na(this.layers,this.zoom,function(a){return/^icon/.test(a)})),this.glyphOffsetArray=new D,this.lineVertexArray=new N,this.symbolInstances=new P},Se.prototype.calculateGlyphDependencies=function(a,o,u,v,_){for(var S=0;S<a.length;S++)if(o[a.charCodeAt(S)]=!0,(u||v)&&_){var A=$l[a.charAt(S)];A&&(o[A.charCodeAt(0)]=!0)}},Se.prototype.populate=function(a,o,u){var v=this.layers[0],_=v.layout,S=_.get("text-font"),A=_.get("text-field"),R=_.get("icon-image"),z=(A.value.kind!=="constant"||A.value.value instanceof so&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),W=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,q=_.get("symbol-sort-key");if(this.features=[],z||W){for(var ne=o.iconDependencies,ae=o.glyphDependencies,Te=o.availableImages,je=new ma(this.zoom),Be=0,Je=a;Be<Je.length;Be+=1){var Qe=Je[Be],Tt=Qe.feature,Zt=Qe.id,ar=Qe.index,Lr=Qe.sourceLayerIndex,xr=v._featureFilter.needGeometry,dn=Ja(Tt,xr);if(v._featureFilter.filter(je,dn,u)){xr||(dn.geometry=Oo(Tt));var _n=void 0;if(z){var ci=v.getValueAndResolveTokens("text-field",dn,u,Te),_i=so.factory(ci);st(_i)&&(this.hasRTLText=!0),(!this.hasRTLText||pf()==="unavailable"||this.hasRTLText&&rl.isParsed())&&(_n=dv(_i,v,dn))}var vi=void 0;if(W){var ti=v.getValueAndResolveTokens("icon-image",dn,u,Te);vi=ti instanceof Ft?ti:Ft.fromString(ti)}if(_n||vi){var Zi=this.sortFeaturesByKey?q.evaluate(dn,{},u):void 0;if(this.features.push({id:Zt,text:_n,icon:vi,index:ar,sourceLayerIndex:Lr,geometry:dn.geometry,properties:Tt.properties,type:Ee[Tt.type],sortKey:Zi}),vi&&(ne[vi.name]=!0),_n){var Pi=S.evaluate(dn,{},u).join(","),xi=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(qn.vertical)>=0;for(var Pa=0,aa=_n.sections;Pa<aa.length;Pa+=1){var to=aa[Pa];if(to.image)ne[to.image.name]=!0;else{var Fi=Gl(_n.toString()),Ra=to.fontStack||Pi,Do=ae[Ra]=ae[Ra]||{};this.calculateGlyphDependencies(to.text,Do,xi,this.allowVerticalPlacement,Fi)}}}}}}_.get("symbol-placement")==="line"&&(this.features=function(Fo){var is={},as={},Yo=[],qs=0;function Ls(Vo){Yo.push(Fo[Vo]),qs++}function ol(Vo,os,Bu){var Ua=as[Vo];return delete as[Vo],as[os]=Ua,Yo[Ua].geometry[0].pop(),Yo[Ua].geometry[0]=Yo[Ua].geometry[0].concat(Bu[0]),Ua}function Qs(Vo,os,Bu){var Ua=is[os];return delete is[os],is[Vo]=Ua,Yo[Ua].geometry[0].shift(),Yo[Ua].geometry[0]=Bu[0].concat(Yo[Ua].geometry[0]),Ua}function $u(Vo,os,Bu){var Ua=Bu?os[0][os[0].length-1]:os[0][0];return Vo+":"+Ua.x+":"+Ua.y}for(var du=0;du<Fo.length;du++){var Js=Fo[du],eu=Js.geometry,za=Js.text?Js.text.toString():null;if(za){var La=$u(za,eu),To=$u(za,eu,!0);if(La in as&&To in is&&as[La]!==is[To]){var Bo=Qs(La,To,eu),sl=ol(La,To,Yo[Bo].geometry);delete is[La],delete as[To],as[$u(za,Yo[sl].geometry,!0)]=sl,Yo[Bo].geometry=null}else La in as?ol(La,To,eu):To in is?Qs(La,To,eu):(Ls(du),is[La]=qs-1,as[To]=qs-1)}else Ls(du)}return Yo.filter(function(Vo){return Vo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Fo,is){return Fo.sortKey-is.sortKey})}},Se.prototype.update=function(a,o,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,o,this.layers,u),this.icon.programConfigurations.updatePaintArrays(a,o,this.layers,u))},Se.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Se.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Se.prototype.upload=function(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Se.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Se.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Se.prototype.addToLineVertexArray=function(a,o){var u=this.lineVertexArray.length;if(a.segment!==void 0){for(var v=a.dist(o[a.segment+1]),_=a.dist(o[a.segment]),S={},A=a.segment+1;A<o.length;A++)S[A]={x:o[A].x,y:o[A].y,tileUnitDistanceFromAnchor:v},A<o.length-1&&(v+=o[A+1].dist(o[A]));for(var R=a.segment||0;R>=0;R--)S[R]={x:o[R].x,y:o[R].y,tileUnitDistanceFromAnchor:_},R>0&&(_+=o[R-1].dist(o[R]));for(var z=0;z<o.length;z++){var W=S[z];this.lineVertexArray.emplaceBack(W.x,W.y,W.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}},Se.prototype.addSymbols=function(a,o,u,v,_,S,A,R,z,W,q,ne){for(var ae=a.indexArray,Te=a.layoutVertexArray,je=a.segments.prepareSegment(4*o.length,Te,ae,this.canOverlap?S.sortKey:void 0),Be=this.glyphOffsetArray.length,Je=je.vertexLength,Qe=this.allowVerticalPlacement&&A===qn.vertical?Math.PI/2:0,Tt=S.text&&S.text.sections,Zt=0;Zt<o.length;Zt++){var ar=o[Zt],Lr=ar.tl,xr=ar.tr,dn=ar.bl,_n=ar.br,ci=ar.tex,_i=ar.pixelOffsetTL,vi=ar.pixelOffsetBR,ti=ar.minFontScaleX,Zi=ar.minFontScaleY,Pi=ar.glyphOffset,xi=ar.isSDF,Pa=ar.sectionIndex,aa=je.vertexLength,to=Pi[1];Bt(Te,R.x,R.y,Lr.x,to+Lr.y,ci.x,ci.y,u,xi,_i.x,_i.y,ti,Zi),Bt(Te,R.x,R.y,xr.x,to+xr.y,ci.x+ci.w,ci.y,u,xi,vi.x,_i.y,ti,Zi),Bt(Te,R.x,R.y,dn.x,to+dn.y,ci.x,ci.y+ci.h,u,xi,_i.x,vi.y,ti,Zi),Bt(Te,R.x,R.y,_n.x,to+_n.y,ci.x+ci.w,ci.y+ci.h,u,xi,vi.x,vi.y,ti,Zi),ur(a.dynamicLayoutVertexArray,R,Qe),ae.emplaceBack(aa,aa+1,aa+2),ae.emplaceBack(aa+1,aa+2,aa+3),je.vertexLength+=4,je.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Pi[0]),Zt!==o.length-1&&Pa===o[Zt+1].sectionIndex||a.programConfigurations.populatePaintArrays(Te.length,S,S.index,{},ne,Tt&&Tt[Pa])}a.placedSymbolArray.emplaceBack(R.x,R.y,Be,this.glyphOffsetArray.length-Be,Je,z,W,R.segment,u?u[0]:0,u?u[1]:0,v[0],v[1],A,0,!1,0,q)},Se.prototype._addCollisionDebugVertex=function(a,o,u,v,_,S){return o.emplaceBack(0,0),a.emplaceBack(u.x,u.y,v,_,Math.round(S.x),Math.round(S.y))},Se.prototype.addCollisionDebugVertices=function(a,o,u,v,_,S,A){var R=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),z=R.vertexLength,W=_.layoutVertexArray,q=_.collisionVertexArray,ne=A.anchorX,ae=A.anchorY;this._addCollisionDebugVertex(W,q,S,ne,ae,new pe(a,o)),this._addCollisionDebugVertex(W,q,S,ne,ae,new pe(u,o)),this._addCollisionDebugVertex(W,q,S,ne,ae,new pe(u,v)),this._addCollisionDebugVertex(W,q,S,ne,ae,new pe(a,v)),R.vertexLength+=4;var Te=_.indexArray;Te.emplaceBack(z,z+1),Te.emplaceBack(z+1,z+2),Te.emplaceBack(z+2,z+3),Te.emplaceBack(z+3,z),R.primitiveLength+=4},Se.prototype.addDebugCollisionBoxes=function(a,o,u,v){for(var _=a;_<o;_++){var S=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,v?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,u)}},Se.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new bt(Zl,td.members,Ru),this.iconCollisionBox=new bt(Zl,td.members,Ru);for(var a=0;a<this.symbolInstances.length;a++){var o=this.symbolInstances.get(a);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}},Se.prototype._deserializeCollisionBoxesForSymbol=function(a,o,u,v,_,S,A,R,z){for(var W={},q=o;q<u;q++){var ne=a.get(q);W.textBox={x1:ne.x1,y1:ne.y1,x2:ne.x2,y2:ne.y2,anchorPointX:ne.anchorPointX,anchorPointY:ne.anchorPointY},W.textFeatureIndex=ne.featureIndex;break}for(var ae=v;ae<_;ae++){var Te=a.get(ae);W.verticalTextBox={x1:Te.x1,y1:Te.y1,x2:Te.x2,y2:Te.y2,anchorPointX:Te.anchorPointX,anchorPointY:Te.anchorPointY},W.verticalTextFeatureIndex=Te.featureIndex;break}for(var je=S;je<A;je++){var Be=a.get(je);W.iconBox={x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,anchorPointX:Be.anchorPointX,anchorPointY:Be.anchorPointY},W.iconFeatureIndex=Be.featureIndex;break}for(var Je=R;Je<z;Je++){var Qe=a.get(Je);W.verticalIconBox={x1:Qe.x1,y1:Qe.y1,x2:Qe.x2,y2:Qe.y2,anchorPointX:Qe.anchorPointX,anchorPointY:Qe.anchorPointY},W.verticalIconFeatureIndex=Qe.featureIndex;break}return W},Se.prototype.deserializeCollisionBoxes=function(a){this.collisionArrays=[];for(var o=0;o<this.symbolInstances.length;o++){var u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}},Se.prototype.hasTextData=function(){return this.text.segments.get().length>0},Se.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Se.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Se.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Se.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Se.prototype.addIndicesForPlacedSymbol=function(a,o){for(var u=a.placedSymbolArray.get(o),v=u.vertexStartIndex+4*u.numGlyphs,_=u.vertexStartIndex;_<v;_+=4)a.indexArray.emplaceBack(_,_+1,_+2),a.indexArray.emplaceBack(_+1,_+2,_+3)},Se.prototype.getSortedSymbolIndexes=function(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var o=Math.sin(a),u=Math.cos(a),v=[],_=[],S=[],A=0;A<this.symbolInstances.length;++A){S.push(A);var R=this.symbolInstances.get(A);v.push(0|Math.round(o*R.anchorX+u*R.anchorY)),_.push(R.featureIndex)}return S.sort(function(z,W){return v[z]-v[W]||_[W]-_[z]}),S},Se.prototype.addToSortKeyRanges=function(a,o){var u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:a,symbolInstanceEnd:a+1})},Se.prototype.sortFeatures=function(a){var o=this;if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,v=this.symbolInstanceIndexes;u<v.length;u+=1){var _=this.symbolInstances.get(v[u]);this.featureSortOrder.push(_.featureIndex),[_.rightJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.leftJustifiedTextSymbolIndex].forEach(function(S,A,R){S>=0&&R.indexOf(S)===A&&o.addIndicesForPlacedSymbol(o.text,S)}),_.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,_.verticalPlacedTextSymbolIndex),_.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.placedIconSymbolIndex),_.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Kn("SymbolBucket",Se,{omit:["layers","collisionBoxArray","features","compareText"]}),Se.MAX_GLYPHS=65535,Se.addDynamicAttributes=ur;var rt=new ds({"symbol-placement":new bi(Ce.layout_symbol["symbol-placement"]),"symbol-spacing":new bi(Ce.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new bi(Ce.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new si(Ce.layout_symbol["symbol-sort-key"]),"symbol-z-order":new bi(Ce.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new bi(Ce.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new bi(Ce.layout_symbol["icon-ignore-placement"]),"icon-optional":new bi(Ce.layout_symbol["icon-optional"]),"icon-rotation-alignment":new bi(Ce.layout_symbol["icon-rotation-alignment"]),"icon-size":new si(Ce.layout_symbol["icon-size"]),"icon-text-fit":new bi(Ce.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new bi(Ce.layout_symbol["icon-text-fit-padding"]),"icon-image":new si(Ce.layout_symbol["icon-image"]),"icon-rotate":new si(Ce.layout_symbol["icon-rotate"]),"icon-padding":new bi(Ce.layout_symbol["icon-padding"]),"icon-keep-upright":new bi(Ce.layout_symbol["icon-keep-upright"]),"icon-offset":new si(Ce.layout_symbol["icon-offset"]),"icon-anchor":new si(Ce.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new bi(Ce.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new bi(Ce.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new bi(Ce.layout_symbol["text-rotation-alignment"]),"text-field":new si(Ce.layout_symbol["text-field"]),"text-font":new si(Ce.layout_symbol["text-font"]),"text-size":new si(Ce.layout_symbol["text-size"]),"text-max-width":new si(Ce.layout_symbol["text-max-width"]),"text-line-height":new bi(Ce.layout_symbol["text-line-height"]),"text-letter-spacing":new si(Ce.layout_symbol["text-letter-spacing"]),"text-justify":new si(Ce.layout_symbol["text-justify"]),"text-radial-offset":new si(Ce.layout_symbol["text-radial-offset"]),"text-variable-anchor":new bi(Ce.layout_symbol["text-variable-anchor"]),"text-anchor":new si(Ce.layout_symbol["text-anchor"]),"text-max-angle":new bi(Ce.layout_symbol["text-max-angle"]),"text-writing-mode":new bi(Ce.layout_symbol["text-writing-mode"]),"text-rotate":new si(Ce.layout_symbol["text-rotate"]),"text-padding":new bi(Ce.layout_symbol["text-padding"]),"text-keep-upright":new bi(Ce.layout_symbol["text-keep-upright"]),"text-transform":new si(Ce.layout_symbol["text-transform"]),"text-offset":new si(Ce.layout_symbol["text-offset"]),"text-allow-overlap":new bi(Ce.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new bi(Ce.layout_symbol["text-ignore-placement"]),"text-optional":new bi(Ce.layout_symbol["text-optional"])}),Fe={paint:new ds({"icon-opacity":new si(Ce.paint_symbol["icon-opacity"]),"icon-color":new si(Ce.paint_symbol["icon-color"]),"icon-halo-color":new si(Ce.paint_symbol["icon-halo-color"]),"icon-halo-width":new si(Ce.paint_symbol["icon-halo-width"]),"icon-halo-blur":new si(Ce.paint_symbol["icon-halo-blur"]),"icon-translate":new bi(Ce.paint_symbol["icon-translate"]),"icon-translate-anchor":new bi(Ce.paint_symbol["icon-translate-anchor"]),"text-opacity":new si(Ce.paint_symbol["text-opacity"]),"text-color":new si(Ce.paint_symbol["text-color"],{runtimeType:Nn,getOverride:function(o){return o.textColor},hasOverride:function(o){return!!o.textColor}}),"text-halo-color":new si(Ce.paint_symbol["text-halo-color"]),"text-halo-width":new si(Ce.paint_symbol["text-halo-width"]),"text-halo-blur":new si(Ce.paint_symbol["text-halo-blur"]),"text-translate":new bi(Ce.paint_symbol["text-translate"]),"text-translate-anchor":new bi(Ce.paint_symbol["text-translate-anchor"])}),layout:rt},kt=function(o){this.type=o.property.overrides?o.property.overrides.runtimeType:Gn,this.defaultValue=o};kt.prototype.evaluate=function(a){if(a.formattedSection){var o=this.defaultValue.property.overrides;if(o&&o.hasOverride(a.formattedSection))return o.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default},kt.prototype.eachChild=function(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)},kt.prototype.outputDefined=function(){return!1},kt.prototype.serialize=function(){return null},Kn("FormatSectionOverride",kt,{omit:["defaultValue"]});var $t=function(a){function o(u){a.call(this,u,Fe)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.recalculate=function(u,v){if(a.prototype.recalculate.call(this,u,v),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var _=this.layout.get("text-writing-mode");if(_){for(var S=[],A=0,R=_;A<R.length;A+=1){var z=R[A];S.indexOf(z)<0&&S.push(z)}this.layout._values["text-writing-mode"]=S}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},o.prototype.getValueAndResolveTokens=function(u,v,_,S){var A=this.layout.get(u).evaluate(v,{},_,S),R=this._unevaluatedLayout._values[u];return R.isDataDriven()||hl(R.value)||!A?A:function(z,W){return W.replace(/{([^{}]+)}/g,function(q,ne){return ne in z?String(z[ne]):""})}(v.properties,A)},o.prototype.createBucket=function(u){return new Se(u)},o.prototype.queryRadius=function(){return 0},o.prototype.queryIntersectsFeature=function(){return!1},o.prototype._setPaintOverrides=function(){for(var u=0,v=Fe.paint.overridableProperties;u<v.length;u+=1){var _=v[u];if(o.hasPaintOverride(this.layout,_)){var S,A=this.paint.get(_),R=new kt(A),z=new zl(R,A.property.specification);S=A.value.kind==="constant"||A.value.kind==="source"?new Ul("source",z):new af("composite",z,A.value.zoomStops,A.value._interpolationType),this.paint._values[_]=new ps(A.property,S,A.parameters)}}},o.prototype._handleOverridablePaintPropertyUpdate=function(u,v,_){return!(!this.layout||v.isDataDriven()||_.isDataDriven())&&o.hasPaintOverride(this.layout,u)},o.hasPaintOverride=function(u,v){var _=u.get("text-field"),S=Fe.paint.properties[v],A=!1,R=function(ne){for(var ae=0,Te=ne;ae<Te.length;ae+=1)if(S.overrides&&S.overrides.hasOverride(Te[ae]))return void(A=!0)};if(_.value.kind==="constant"&&_.value.value instanceof so)R(_.value.value.sections);else if(_.value.kind==="source"){var z=function q(ne){A||(ne instanceof vo&&uo(ne.value)===Sa?R(ne.value.sections):ne instanceof xs?R(ne.sections):ne.eachChild(q))},W=_.value;W._styleExpression&&z(W._styleExpression.expression)}return A},o}(nl),Wr={paint:new ds({"background-color":new bi(Ce.paint_background["background-color"]),"background-pattern":new ko(Ce.paint_background["background-pattern"]),"background-opacity":new bi(Ce.paint_background["background-opacity"])})},bn=function(a){function o(u){a.call(this,u,Wr)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o}(nl),Cn={paint:new ds({"raster-opacity":new bi(Ce.paint_raster["raster-opacity"]),"raster-hue-rotate":new bi(Ce.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new bi(Ce.paint_raster["raster-brightness-min"]),"raster-brightness-max":new bi(Ce.paint_raster["raster-brightness-max"]),"raster-saturation":new bi(Ce.paint_raster["raster-saturation"]),"raster-contrast":new bi(Ce.paint_raster["raster-contrast"]),"raster-resampling":new bi(Ce.paint_raster["raster-resampling"]),"raster-fade-duration":new bi(Ce.paint_raster["raster-fade-duration"])})},Un=function(a){function o(u){a.call(this,u,Cn)}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o}(nl),yn=function(a){function o(u){a.call(this,u,{}),this.implementation=u}return a&&(o.__proto__=a),(o.prototype=Object.create(a&&a.prototype)).constructor=o,o.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},o.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},o.prototype.recalculate=function(){},o.prototype.updateTransitions=function(){},o.prototype.hasTransition=function(){},o.prototype.serialize=function(){},o.prototype.onAdd=function(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},o.prototype.onRemove=function(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},o}(nl),hi={circle:vf,heatmap:$p,hillshade:Ih,fill:Pp,"fill-extrusion":ch,line:cv,symbol:$t,background:bn,raster:Un},Zn=Ae.HTMLImageElement,ri=Ae.HTMLCanvasElement,ii=Ae.HTMLVideoElement,li=Ae.ImageData,Ri=Ae.ImageBitmap,eo=function(o,u,v,_){this.context=o,this.format=v,this.texture=o.gl.createTexture(),this.update(u,_)};eo.prototype.update=function(a,o,u){var v=a.width,_=a.height,S=!(this.size&&this.size[0]===v&&this.size[1]===_||u),A=this.context,R=A.gl;if(this.useMipmap=Boolean(o&&o.useMipmap),R.bindTexture(R.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===R.RGBA&&(!o||o.premultiply!==!1)),S)this.size=[v,_],a instanceof Zn||a instanceof ri||a instanceof ii||a instanceof li||Ri&&a instanceof Ri?R.texImage2D(R.TEXTURE_2D,0,this.format,this.format,R.UNSIGNED_BYTE,a):R.texImage2D(R.TEXTURE_2D,0,this.format,v,_,0,this.format,R.UNSIGNED_BYTE,a.data);else{var z=u||{x:0,y:0},W=z.x,q=z.y;a instanceof Zn||a instanceof ri||a instanceof ii||a instanceof li||Ri&&a instanceof Ri?R.texSubImage2D(R.TEXTURE_2D,0,W,q,R.RGBA,R.UNSIGNED_BYTE,a):R.texSubImage2D(R.TEXTURE_2D,0,W,q,v,_,R.RGBA,R.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&R.generateMipmap(R.TEXTURE_2D)},eo.prototype.bind=function(a,o,u){var v=this.context.gl;v.bindTexture(v.TEXTURE_2D,this.texture),u!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=v.LINEAR),a!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,a),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,u||a),this.filter=a),o!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,o),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,o),this.wrap=o)},eo.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},eo.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Ks=function(o){var u=this;this._callback=o,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){u._triggered=!1,u._callback()})};Ks.prototype.trigger=function(){var a=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){a._triggered=!1,a._callback()},0))},Ks.prototype.remove=function(){delete this._channel,this._callback=function(){}};var kl=function(o,u,v){this.target=o,this.parent=u,this.mapId=v,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},rr(["receive","process"],this),this.invoker=new Ks(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=vn()?o:Ae};function Jc(a,o,u){var v=2*Math.PI*6378137/256/Math.pow(2,u);return[a*v-2*Math.PI*6378137/2,o*v-2*Math.PI*6378137/2]}kl.prototype.send=function(a,o,u,v,_){var S=this;_===void 0&&(_=!1);var A=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[A]=u);var R=Ne(this.globalScope)?void 0:[];return this.target.postMessage({id:A,type:a,hasCallback:!!u,targetMapId:v,mustQueue:_,sourceMapId:this.mapId,data:Hu(o,R)},R),{cancel:function(){u&&delete S.callbacks[A],S.target.postMessage({id:A,type:"<cancel>",targetMapId:v,sourceMapId:S.mapId})}}},kl.prototype.receive=function(a){var o=a.data,u=o.id;if(u&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){delete this.tasks[u];var v=this.cancelCallbacks[u];delete this.cancelCallbacks[u],v&&v()}else vn()||o.mustQueue?(this.tasks[u]=o,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,o)},kl.prototype.process=function(){if(this.taskQueue.length){var a=this.taskQueue.shift(),o=this.tasks[a];delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),o&&this.processTask(a,o)}},kl.prototype.processTask=function(a,o){var u=this;if(o.type==="<response>"){var v=this.callbacks[a];delete this.callbacks[a],v&&(o.error?v(bs(o.error)):v(null,bs(o.data)))}else{var _=!1,S=Ne(this.globalScope)?void 0:[],A=o.hasCallback?function(q,ne){_=!0,delete u.cancelCallbacks[a],u.target.postMessage({id:a,type:"<response>",sourceMapId:u.mapId,error:q?Hu(q):null,data:Hu(ne,S)},S)}:function(q){_=!0},R=null,z=bs(o.data);if(this.parent[o.type])R=this.parent[o.type](o.sourceMapId,z,A);else if(this.parent.getWorkerSource){var W=o.type.split(".");R=this.parent.getWorkerSource(o.sourceMapId,W[0],z.source)[W[1]](z,A)}else A(new Error("Could not find function "+o.type));!_&&R&&R.cancel&&(this.cancelCallbacks[a]=R.cancel)}},kl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var So=function(o,u){o&&(u?this.setSouthWest(o).setNorthEast(u):o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))};So.prototype.setNorthEast=function(a){return this._ne=a instanceof Ia?new Ia(a.lng,a.lat):Ia.convert(a),this},So.prototype.setSouthWest=function(a){return this._sw=a instanceof Ia?new Ia(a.lng,a.lat):Ia.convert(a),this},So.prototype.extend=function(a){var o,u,v=this._sw,_=this._ne;if(a instanceof Ia)o=a,u=a;else{if(!(a instanceof So))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(So.convert(a)):this.extend(Ia.convert(a)):this;if(u=a._ne,!(o=a._sw)||!u)return this}return v||_?(v.lng=Math.min(o.lng,v.lng),v.lat=Math.min(o.lat,v.lat),_.lng=Math.max(u.lng,_.lng),_.lat=Math.max(u.lat,_.lat)):(this._sw=new Ia(o.lng,o.lat),this._ne=new Ia(u.lng,u.lat)),this},So.prototype.getCenter=function(){return new Ia((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},So.prototype.getSouthWest=function(){return this._sw},So.prototype.getNorthEast=function(){return this._ne},So.prototype.getNorthWest=function(){return new Ia(this.getWest(),this.getNorth())},So.prototype.getSouthEast=function(){return new Ia(this.getEast(),this.getSouth())},So.prototype.getWest=function(){return this._sw.lng},So.prototype.getSouth=function(){return this._sw.lat},So.prototype.getEast=function(){return this._ne.lng},So.prototype.getNorth=function(){return this._ne.lat},So.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},So.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},So.prototype.isEmpty=function(){return!(this._sw&&this._ne)},So.prototype.contains=function(a){var o=Ia.convert(a),u=o.lng,v=o.lat,_=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=v&&v<=this._ne.lat&&_},So.convert=function(a){return!a||a instanceof So?a:new So(a)};var Ia=function(o,u){if(isNaN(o)||isNaN(u))throw new Error("Invalid LngLat object: ("+o+", "+u+")");if(this.lng=+o,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ia.prototype.wrap=function(){return new Ia(St(this.lng,-180,180),this.lat)},Ia.prototype.toArray=function(){return[this.lng,this.lat]},Ia.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ia.prototype.distanceTo=function(a){var o=Math.PI/180,u=this.lat*o,v=a.lat*o,_=Math.sin(u)*Math.sin(v)+Math.cos(u)*Math.cos(v)*Math.cos((a.lng-this.lng)*o);return 63710088e-1*Math.acos(Math.min(_,1))},Ia.prototype.toBounds=function(a){a===void 0&&(a=0);var o=360*a/40075017,u=o/Math.cos(Math.PI/180*this.lat);return new So(new Ia(this.lng-u,this.lat-o),new Ia(this.lng+u,this.lat+o))},Ia.convert=function(a){if(a instanceof Ia)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new Ia(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new Ia(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Oc=2*Math.PI*63710088e-1;function ql(a){return Oc*Math.cos(a*Math.PI/180)}function rd(a){return(180+a)/360}function hc(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function nd(a,o){return a/ql(o)}function id(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}var Bh=function(o,u,v){v===void 0&&(v=0),this.x=+o,this.y=+u,this.z=+v};Bh.fromLngLat=function(a,o){o===void 0&&(o=0);var u=Ia.convert(a);return new Bh(rd(u.lng),hc(u.lat),nd(o,u.lat))},Bh.prototype.toLngLat=function(){return new Ia(360*this.x-180,id(this.y))},Bh.prototype.toAltitude=function(){return this.z*ql(id(this.y))},Bh.prototype.meterInMercatorCoordinateUnits=function(){return 1/Oc*(a=id(this.y),1/Math.cos(a*Math.PI/180));var a};var hp=function(o,u,v){this.z=o,this.x=u,this.y=v,this.key=ad(0,o,o,u,v)};hp.prototype.equals=function(a){return this.z===a.z&&this.x===a.x&&this.y===a.y},hp.prototype.url=function(a,o){var u,v,_,S,A,R=(v=this.y,_=this.z,S=Jc(256*(u=this.x),256*(v=Math.pow(2,_)-v-1),_),A=Jc(256*(u+1),256*(v+1),_),S[0]+","+S[1]+","+A[0]+","+A[1]),z=function(W,q,ne){for(var ae,Te="",je=W;je>0;je--)Te+=(q&(ae=1<<je-1)?1:0)+(ne&ae?2:0);return Te}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",z).replace("{bbox-epsg-3857}",R)},hp.prototype.getTilePoint=function(a){var o=Math.pow(2,this.z);return new pe(8192*(a.x*o-this.x),8192*(a.y*o-this.y))},hp.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Qv=function(o,u){this.wrap=o,this.canonical=u,this.key=ad(o,u.z,u.z,u.x,u.y)},$s=function(o,u,v,_,S){this.overscaledZ=o,this.wrap=u,this.canonical=new hp(v,+_,+S),this.key=ad(u,o,v,_,S)};function ad(a,o,u,v,_){(a*=2)<0&&(a=-1*a-1);var S=1<<u;return(S*S*a+S*_+v).toString(36)+u.toString(36)+o.toString(36)}$s.prototype.equals=function(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)},$s.prototype.scaledTo=function(a){var o=this.canonical.z-a;return a>this.canonical.z?new $s(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $s(a,this.wrap,a,this.canonical.x>>o,this.canonical.y>>o)},$s.prototype.calculateScaledKey=function(a,o){var u=this.canonical.z-a;return a>this.canonical.z?ad(this.wrap*+o,a,this.canonical.z,this.canonical.x,this.canonical.y):ad(this.wrap*+o,a,a,this.canonical.x>>u,this.canonical.y>>u)},$s.prototype.isChildOf=function(a){if(a.wrap!==this.wrap)return!1;var o=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>o&&a.canonical.y===this.canonical.y>>o},$s.prototype.children=function(a){if(this.overscaledZ>=a)return[new $s(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var o=this.canonical.z+1,u=2*this.canonical.x,v=2*this.canonical.y;return[new $s(o,this.wrap,o,u,v),new $s(o,this.wrap,o,u+1,v),new $s(o,this.wrap,o,u,v+1),new $s(o,this.wrap,o,u+1,v+1)]},$s.prototype.isLessThan=function(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))},$s.prototype.wrapped=function(){return new $s(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},$s.prototype.unwrapTo=function(a){return new $s(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)},$s.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},$s.prototype.toUnwrapped=function(){return new Qv(this.wrap,this.canonical)},$s.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},$s.prototype.getTilePoint=function(a){return this.canonical.getTilePoint(new Bh(a.x-this.wrap,a.y))},Kn("CanonicalTileID",hp),Kn("OverscaledTileID",$s,{omit:["posMatrix"]});var ph=function(o,u,v){if(this.uid=o,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(v&&v!=="mapbox"&&v!=="terrarium")return Kt('"'+v+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=u.height;var _=this.dim=u.height-2;this.data=new Uint32Array(u.data.buffer),this.encoding=v||"mapbox";for(var S=0;S<_;S++)this.data[this._idx(-1,S)]=this.data[this._idx(0,S)],this.data[this._idx(_,S)]=this.data[this._idx(_-1,S)],this.data[this._idx(S,-1)]=this.data[this._idx(S,0)],this.data[this._idx(S,_)]=this.data[this._idx(S,_-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(_,-1)]=this.data[this._idx(_-1,0)],this.data[this._idx(-1,_)]=this.data[this._idx(0,_-1)],this.data[this._idx(_,_)]=this.data[this._idx(_-1,_-1)]};ph.prototype.get=function(a,o){var u=new Uint8Array(this.data.buffer),v=4*this._idx(a,o);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(u[v],u[v+1],u[v+2])},ph.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},ph.prototype._idx=function(a,o){if(a<-1||a>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(a+1)},ph.prototype._unpackMapbox=function(a,o,u){return(256*a*256+256*o+u)/10-1e4},ph.prototype._unpackTerrarium=function(a,o,u){return 256*a+o+u/256-32768},ph.prototype.getPixels=function(){return new Xs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},ph.prototype.backfillBorder=function(a,o,u){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");var v=o*this.dim,_=o*this.dim+this.dim,S=u*this.dim,A=u*this.dim+this.dim;switch(o){case-1:v=_-1;break;case 1:_=v+1}switch(u){case-1:S=A-1;break;case 1:A=S+1}for(var R=-o*this.dim,z=-u*this.dim,W=S;W<A;W++)for(var q=v;q<_;q++)this.data[this._idx(q,W)]=a.data[this._idx(q+R,W+z)]},Kn("DEMData",ph);var Pd=function(o){this._stringToNumber={},this._numberToString=[];for(var u=0;u<o.length;u++){var v=o[u];this._stringToNumber[v]=u,this._numberToString[u]=v}};Pd.prototype.encode=function(a){return this._stringToNumber[a]},Pd.prototype.decode=function(a){return this._numberToString[a]};var Od=function(o,u,v,_,S){this.type="Feature",this._vectorTileFeature=o,o._z=u,o._x=v,o._y=_,this.properties=o.properties,this.id=S},vv={geometry:{configurable:!0}};vv.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},vv.geometry.set=function(a){this._geometry=a},Od.prototype.toJSON=function(){var a={geometry:this.geometry};for(var o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(a[o]=this[o]);return a},Object.defineProperties(Od.prototype,vv);var pp=function(){this.state={},this.stateChanges={},this.deletedStates={}};pp.prototype.updateState=function(a,o,u){var v=String(o);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][v]=this.stateChanges[a][v]||{},He(this.stateChanges[a][v],u),this.deletedStates[a]===null)for(var _ in this.deletedStates[a]={},this.state[a])_!==v&&(this.deletedStates[a][_]=null);else if(this.deletedStates[a]&&this.deletedStates[a][v]===null)for(var S in this.deletedStates[a][v]={},this.state[a][v])u[S]||(this.deletedStates[a][v][S]=null);else for(var A in u)this.deletedStates[a]&&this.deletedStates[a][v]&&this.deletedStates[a][v][A]===null&&delete this.deletedStates[a][v][A]},pp.prototype.removeFeatureState=function(a,o,u){if(this.deletedStates[a]!==null){var v=String(o);if(this.deletedStates[a]=this.deletedStates[a]||{},u&&o!==void 0)this.deletedStates[a][v]!==null&&(this.deletedStates[a][v]=this.deletedStates[a][v]||{},this.deletedStates[a][v][u]=null);else if(o!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][v])for(u in this.deletedStates[a][v]={},this.stateChanges[a][v])this.deletedStates[a][v][u]=null;else this.deletedStates[a][v]=null;else this.deletedStates[a]=null}},pp.prototype.getState=function(a,o){var u=String(o),v=He({},(this.state[a]||{})[u],(this.stateChanges[a]||{})[u]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){var _=this.deletedStates[a][o];if(_===null)return{};for(var S in _)delete v[S]}return v},pp.prototype.initializeTileState=function(a,o){a.setFeatureState(this.state,o)},pp.prototype.coalesceChanges=function(a,o){var u={};for(var v in this.stateChanges){this.state[v]=this.state[v]||{};var _={};for(var S in this.stateChanges[v])this.state[v][S]||(this.state[v][S]={}),He(this.state[v][S],this.stateChanges[v][S]),_[S]=this.state[v][S];u[v]=_}for(var A in this.deletedStates){this.state[A]=this.state[A]||{};var R={};if(this.deletedStates[A]===null)for(var z in this.state[A])R[z]={},this.state[A][z]={};else for(var W in this.deletedStates[A]){if(this.deletedStates[A][W]===null)this.state[A][W]={};else for(var q=0,ne=Object.keys(this.deletedStates[A][W]);q<ne.length;q+=1)delete this.state[A][W][ne[q]];R[W]=this.state[A][W]}u[A]=u[A]||{},He(u[A],R)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(var ae in a)a[ae].setFeatureState(u,o)};var dh=function(o,u){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new pl(8192,16,0),this.grid3D=new pl(8192,16,0),this.featureIndexArray=new re,this.promoteId=u};function od(a,o,u,v,_){return Mr(a,function(S,A){var R=o instanceof Of?o.get(A):null;return R&&R.evaluate?R.evaluate(u,v,_):R})}function mv(a){for(var o=1/0,u=1/0,v=-1/0,_=-1/0,S=0,A=a;S<A.length;S+=1){var R=A[S];o=Math.min(o,R.x),u=Math.min(u,R.y),v=Math.max(v,R.x),_=Math.max(_,R.y)}return{minX:o,minY:u,maxX:v,maxY:_}}function zm(a,o){return o-a}dh.prototype.insert=function(a,o,u,v,_,S){var A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,v,_);for(var R=S?this.grid3D:this.grid,z=0;z<o.length;z++){for(var W=o[z],q=[1/0,1/0,-1/0,-1/0],ne=0;ne<W.length;ne++){var ae=W[ne];q[0]=Math.min(q[0],ae.x),q[1]=Math.min(q[1],ae.y),q[2]=Math.max(q[2],ae.x),q[3]=Math.max(q[3],ae.y)}q[0]<8192&&q[1]<8192&&q[2]>=0&&q[3]>=0&&R.insert(A,q[0],q[1],q[2],q[3])}},dh.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new jf.VectorTile(new fh(this.rawTileData)).layers,this.sourceLayerCoder=new Pd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},dh.prototype.query=function(a,o,u,v){var _=this;this.loadVTLayers();for(var S=a.params||{},A=8192/a.tileSize/a.scale,R=sf(S.filter),z=a.queryGeometry,W=a.queryPadding*A,q=mv(z),ne=this.grid.query(q.minX-W,q.minY-W,q.maxX+W,q.maxY+W),ae=mv(a.cameraQueryGeometry),Te=this.grid3D.query(ae.minX-W,ae.minY-W,ae.maxX+W,ae.maxY+W,function(ar,Lr,xr,dn){return function(_n,ci,_i,vi,ti){for(var Zi=0,Pi=_n;Zi<Pi.length;Zi+=1){var xi=Pi[Zi];if(ci<=xi.x&&_i<=xi.y&&vi>=xi.x&&ti>=xi.y)return!0}var Pa=[new pe(ci,_i),new pe(ci,ti),new pe(vi,ti),new pe(vi,_i)];if(_n.length>2){for(var aa=0,to=Pa;aa<to.length;aa+=1)if(ku(_n,to[aa]))return!0}for(var Fi=0;Fi<_n.length-1;Fi++)if(Xc(_n[Fi],_n[Fi+1],Pa))return!0;return!1}(a.cameraQueryGeometry,ar-W,Lr-W,xr+W,dn+W)}),je=0,Be=Te;je<Be.length;je+=1)ne.push(Be[je]);ne.sort(zm);for(var Je,Qe={},Tt=function(Lr){var xr=ne[Lr];if(xr!==Je){Je=xr;var dn=_.featureIndexArray.get(xr),_n=null;_.loadMatchingFeature(Qe,dn.bucketIndex,dn.sourceLayerIndex,dn.featureIndex,R,S.layers,S.availableImages,o,u,v,function(ci,_i,vi){return _n||(_n=Oo(ci)),_i.queryIntersectsFeature(z,ci,vi,_n,_.z,a.transform,A,a.pixelPosMatrix)})}},Zt=0;Zt<ne.length;Zt++)Tt(Zt);return Qe},dh.prototype.loadMatchingFeature=function(a,o,u,v,_,S,A,R,z,W,q){var ne=this.bucketLayerIDs[o];if(!S||function(_n,ci){for(var _i=0;_i<_n.length;_i++)if(ci.indexOf(_n[_i])>=0)return!0;return!1}(S,ne)){var ae=this.sourceLayerCoder.decode(u),Te=this.vtLayers[ae].feature(v);if(_.needGeometry){var je=Ja(Te,!0);if(!_.filter(new ma(this.tileID.overscaledZ),je,this.tileID.canonical))return}else if(!_.filter(new ma(this.tileID.overscaledZ),Te))return;for(var Be=this.getId(Te,ae),Je=0;Je<ne.length;Je++){var Qe=ne[Je];if(!(S&&S.indexOf(Qe)<0)){var Tt=R[Qe];if(Tt){var Zt={};Be!==void 0&&W&&(Zt=W.getState(Tt.sourceLayer||"_geojsonTileLayer",Be));var ar=He({},z[Qe]);ar.paint=od(ar.paint,Tt.paint,Te,Zt,A),ar.layout=od(ar.layout,Tt.layout,Te,Zt,A);var Lr=!q||q(Te,Tt,Zt);if(Lr){var xr=new Od(Te,this.z,this.x,this.y,Be);xr.layer=ar;var dn=a[Qe];dn===void 0&&(dn=a[Qe]=[]),dn.push({featureIndex:v,feature:xr,intersectionZ:Lr})}}}}}},dh.prototype.lookupSymbolFeatures=function(a,o,u,v,_,S,A,R){var z={};this.loadVTLayers();for(var W=sf(_),q=0,ne=a;q<ne.length;q+=1)this.loadMatchingFeature(z,u,v,ne[q],W,S,A,R,o);return z},dh.prototype.hasLayer=function(a){for(var o=0,u=this.bucketLayerIDs;o<u.length;o+=1)for(var v=0,_=u[o];v<_.length;v+=1)if(a===_[v])return!0;return!1},dh.prototype.getId=function(a,o){var u=a.id;return this.promoteId&&typeof(u=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]])=="boolean"&&(u=Number(u)),u},Kn("FeatureIndex",dh,{omit:["rawTileData","sourceLayerCoder"]});var pu=function(o,u){this.tileID=o,this.uid=ct(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};pu.prototype.registerFadeDuration=function(a){var o=a+this.timeAdded;o<It.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)},pu.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},pu.prototype.loadVectorData=function(a,o,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",a){for(var v in a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(W,q){var ne={};if(!q)return ne;for(var ae=function(){var Je=je[Te],Qe=Je.layerIds.map(function(ar){return q.getLayer(ar)}).filter(Boolean);if(Qe.length!==0){Je.layers=Qe,Je.stateDependentLayerIds&&(Je.stateDependentLayers=Je.stateDependentLayerIds.map(function(ar){return Qe.filter(function(Lr){return Lr.id===ar})[0]}));for(var Tt=0,Zt=Qe;Tt<Zt.length;Tt+=1)ne[Zt[Tt].id]=Je}},Te=0,je=W;Te<je.length;Te+=1)ae();return ne}(a.buckets,o.style),this.hasSymbolBuckets=!1,this.buckets){var _=this.buckets[v];if(_ instanceof Se){if(this.hasSymbolBuckets=!0,!u)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var S in this.buckets){var A=this.buckets[S];if(A instanceof Se&&A.hasRTLText){this.hasRTLText=!0,rl.isLoading()||rl.isLoaded()||pf()!=="deferred"||Wu();break}}for(var R in this.queryPadding=0,this.buckets){var z=this.buckets[R];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(R).queryRadius(z))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)}else this.collisionBoxArray=new f},pu.prototype.unloadVectorData=function(){for(var a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},pu.prototype.getBucket=function(a){return this.buckets[a.id]},pu.prototype.upload=function(a){for(var o in this.buckets){var u=this.buckets[o];u.uploadPending()&&u.upload(a)}var v=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new eo(a,this.imageAtlas.image,v.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new eo(a,this.glyphAtlasImage,v.ALPHA),this.glyphAtlasImage=null)},pu.prototype.prepare=function(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)},pu.prototype.queryRenderedFeatures=function(a,o,u,v,_,S,A,R,z,W){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:_,scale:S,tileSize:this.tileSize,pixelPosMatrix:W,transform:R,params:A,queryPadding:this.queryPadding*z},a,o,u):{}},pu.prototype.querySourceFeatures=function(a,o){var u=this.latestFeatureIndex;if(u&&u.rawTileData){var v=u.loadVTLayers(),_=o?o.sourceLayer:"",S=v._geojsonTileLayer||v[_];if(S)for(var A=sf(o&&o.filter),R=this.tileID.canonical,z=R.z,W=R.x,q=R.y,ne={z,x:W,y:q},ae=0;ae<S.length;ae++){var Te=S.feature(ae);if(A.needGeometry){var je=Ja(Te,!0);if(!A.filter(new ma(this.tileID.overscaledZ),je,this.tileID.canonical))continue}else if(!A.filter(new ma(this.tileID.overscaledZ),Te))continue;var Be=u.getId(Te,_),Je=new Od(Te,z,W,q,Be);Je.tile=ne,a.push(Je)}}},pu.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},pu.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},pu.prototype.setExpiryData=function(a){var o=this.expirationTime;if(a.cacheControl){var u=kr(a.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){var v=Date.now(),_=!1;if(this.expirationTime>v)_=!1;else if(o)if(this.expirationTime<o)_=!0;else{var S=this.expirationTime-o;S?this.expirationTime=v+Math.max(S,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},pu.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},pu.prototype.setFeatureState=function(a,o){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(a).length!==0){var u=this.latestFeatureIndex.loadVTLayers();for(var v in this.buckets)if(o.style.hasLayer(v)){var _=this.buckets[v],S=_.layers[0].sourceLayer||"_geojsonTileLayer",A=u[S],R=a[S];if(A&&R&&Object.keys(R).length!==0){_.update(R,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});var z=o&&o.style&&o.style.getLayer(v);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(_)))}}}},pu.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},pu.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<It.now()},pu.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},pu.prototype.setHoldDuration=function(a){this.symbolFadeHoldUntil=It.now()+a},pu.prototype.setDependencies=function(a,o){for(var u={},v=0,_=o;v<_.length;v+=1)u[_[v]]=!0;this.dependencies[a]=u},pu.prototype.hasDependency=function(a,o){for(var u=0,v=a;u<v.length;u+=1){var _=this.dependencies[v[u]];if(_){for(var S=0,A=o;S<A.length;S+=1)if(_[A[S]])return!0}}return!1};var Nh=Ae.performance,Jv=function(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},Nh.mark(this._marks.start)};Jv.prototype.finish=function(){Nh.mark(this._marks.end);var a=Nh.getEntriesByName(this._marks.measure);return a.length===0&&(Nh.measure(this._marks.measure,this._marks.start,this._marks.end),a=Nh.getEntriesByName(this._marks.measure),Nh.clearMarks(this._marks.start),Nh.clearMarks(this._marks.end),Nh.clearMeasures(this._marks.measure)),a},h.Actor=kl,h.AlphaImage=Zs,h.CanonicalTileID=hp,h.CollisionBoxArray=f,h.Color=Bi,h.DEMData=ph,h.DataConstantProperty=bi,h.DictionaryCoder=Pd,h.EXTENT=8192,h.ErrorEvent=ft,h.EvaluationParameters=ma,h.Event=Ve,h.Evented=Ct,h.FeatureIndex=dh,h.FillBucket=il,h.FillExtrusionBucket=ml,h.ImageAtlas=Er,h.ImagePosition=Qr,h.LineBucket=Ba,h.LngLat=Ia,h.LngLatBounds=So,h.MercatorCoordinate=Bh,h.ONE_EM=24,h.OverscaledTileID=$s,h.Point=pe,h.Point$1=pe,h.Properties=ds,h.Protobuf=fh,h.RGBAImage=Xs,h.RequestManager=Or,h.RequestPerformance=Jv,h.ResourceType=da,h.SegmentVector=ye,h.SourceFeatureState=pp,h.StructArrayLayout1ui2=Rf,h.StructArrayLayout2f1f2i16=If,h.StructArrayLayout2i4=Wl,h.StructArrayLayout3ui6=wc,h.StructArrayLayout4i8=dl,h.SymbolBucket=Se,h.Texture=eo,h.Tile=pu,h.Transitionable=Za,h.Uniform1f=Dr,h.Uniform1i=Tr,h.Uniform2f=nn,h.Uniform3f=An,h.Uniform4f=Vn,h.UniformColor=mi,h.UniformMatrix4f=Ni,h.UnwrappedTileID=Qv,h.ValidationError=Ye,h.WritingMode=qn,h.ZoomHistory=ff,h.add=function(a,o,u){return a[0]=o[0]+u[0],a[1]=o[1]+u[1],a[2]=o[2]+u[2],a},h.addDynamicAttributes=ur,h.asyncAll=function(a,o,u){if(!a.length)return u(null,[]);var v=a.length,_=new Array(a.length),S=null;a.forEach(function(A,R){o(A,function(z,W){z&&(S=z),_[R]=W,--v==0&&u(S,_)})})},h.bezier=at,h.bindAll=rr,h.browser=It,h.cacheEntryPossiblyAdded=function(a){++fi>On&&(a.getActor().send("enforceCacheSizeLimit",en),fi=0)},h.clamp=yt,h.clearTileCache=function(a){var o=Ae.caches.delete("mapbox-tiles");a&&o.catch(a).then(function(){return a()})},h.clipLine=cu,h.clone=function(a){var o=new Ss(16);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],o[4]=a[4],o[5]=a[5],o[6]=a[6],o[7]=a[7],o[8]=a[8],o[9]=a[9],o[10]=a[10],o[11]=a[11],o[12]=a[12],o[13]=a[13],o[14]=a[14],o[15]=a[15],o},h.clone$1=ze,h.clone$2=function(a){var o=new Ss(3);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o},h.collisionCircleLayout=pv,h.config=Lt,h.create=function(){var a=new Ss(16);return Ss!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},h.create$1=function(){var a=new Ss(9);return Ss!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a},h.create$2=function(){var a=new Ss(4);return Ss!=Float32Array&&(a[1]=0,a[2]=0),a[0]=1,a[3]=1,a},h.createCommonjsModule=V,h.createExpression=jc,h.createLayout=Hs,h.createStyleLayer=function(a){return a.type==="custom"?new yn(a):new hi[a.type](a)},h.cross=function(a,o,u){var v=o[0],_=o[1],S=o[2],A=u[0],R=u[1],z=u[2];return a[0]=_*z-S*R,a[1]=S*A-v*z,a[2]=v*R-_*A,a},h.deepEqual=function a(o,u){if(Array.isArray(o)){if(!Array.isArray(u)||o.length!==u.length)return!1;for(var v=0;v<o.length;v++)if(!a(o[v],u[v]))return!1;return!0}if(typeof o=="object"&&o!==null&&u!==null){if(typeof u!="object"||Object.keys(o).length!==Object.keys(u).length)return!1;for(var _ in o)if(!a(o[_],u[_]))return!1;return!0}return o===u},h.dot=function(a,o){return a[0]*o[0]+a[1]*o[1]+a[2]*o[2]},h.dot$1=function(a,o){return a[0]*o[0]+a[1]*o[1]+a[2]*o[2]+a[3]*o[3]},h.ease=gt,h.emitValidationErrors=ac,h.endsWith=Fr,h.enforceCacheSizeLimit=function(a){ln(),_e&&_e.then(function(o){o.keys().then(function(u){for(var v=0;v<u.length-a;v++)o.delete(u[v])})})},h.evaluateSizeForFeature=Ea,h.evaluateSizeForZoom=Ao,h.evaluateVariableOffset=hr,h.evented=Hc,h.extend=He,h.featureFilter=sf,h.filterObject=Nt,h.fromRotation=function(a,o){var u=Math.sin(o),v=Math.cos(o);return a[0]=v,a[1]=u,a[2]=0,a[3]=-u,a[4]=v,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},h.getAnchorAlignment=ji,h.getAnchorJustification=Wt,h.getArrayBuffer=ec,h.getImage=ie,h.getJSON=function(a,o){return Vu(He(a,{type:"json"}),o)},h.getRTLTextPluginStatus=pf,h.getReferrer=_s,h.getVideo=function(a,o){var u,v,_=Ae.document.createElement("video");_.muted=!0,_.onloadstart=function(){o(null,_)};for(var S=0;S<a.length;S++){var A=Ae.document.createElement("source");u=a[S],v=void 0,(v=Ae.document.createElement("a")).href=u,(v.protocol!==Ae.document.location.protocol||v.host!==Ae.document.location.host)&&(_.crossOrigin="Anonymous"),A.src=a[S],_.appendChild(A)}return{cancel:function(){}}},h.identity=Cu,h.invert=function(a,o){var u=o[0],v=o[1],_=o[2],S=o[3],A=o[4],R=o[5],z=o[6],W=o[7],q=o[8],ne=o[9],ae=o[10],Te=o[11],je=o[12],Be=o[13],Je=o[14],Qe=o[15],Tt=u*R-v*A,Zt=u*z-_*A,ar=u*W-S*A,Lr=v*z-_*R,xr=v*W-S*R,dn=_*W-S*z,_n=q*Be-ne*je,ci=q*Je-ae*je,_i=q*Qe-Te*je,vi=ne*Je-ae*Be,ti=ne*Qe-Te*Be,Zi=ae*Qe-Te*Je,Pi=Tt*Zi-Zt*ti+ar*vi+Lr*_i-xr*ci+dn*_n;return Pi?(a[0]=(R*Zi-z*ti+W*vi)*(Pi=1/Pi),a[1]=(_*ti-v*Zi-S*vi)*Pi,a[2]=(Be*dn-Je*xr+Qe*Lr)*Pi,a[3]=(ae*xr-ne*dn-Te*Lr)*Pi,a[4]=(z*_i-A*Zi-W*ci)*Pi,a[5]=(u*Zi-_*_i+S*ci)*Pi,a[6]=(Je*ar-je*dn-Qe*Zt)*Pi,a[7]=(q*dn-ae*ar+Te*Zt)*Pi,a[8]=(A*ti-R*_i+W*_n)*Pi,a[9]=(v*_i-u*ti-S*_n)*Pi,a[10]=(je*xr-Be*ar+Qe*Tt)*Pi,a[11]=(ne*ar-q*xr-Te*Tt)*Pi,a[12]=(R*ci-A*vi-z*_n)*Pi,a[13]=(u*vi-v*ci+_*_n)*Pi,a[14]=(Be*Zt-je*Lr-Je*Tt)*Pi,a[15]=(q*Lr-ne*Zt+ae*Tt)*Pi,a):null},h.isChar=Ln,h.isMapboxURL=_r,h.keysDifference=function(a,o){var u=[];for(var v in a)v in o||u.push(v);return u},h.makeRequest=Vu,h.mapObject=Mr,h.mercatorXfromLng=rd,h.mercatorYfromLat=hc,h.mercatorZfromAltitude=nd,h.mul=Bs,h.multiply=Fs,h.mvt=jf,h.nextPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},h.normalize=function(a,o){var u=o[0],v=o[1],_=o[2],S=u*u+v*v+_*_;return S>0&&(S=1/Math.sqrt(S)),a[0]=o[0]*S,a[1]=o[1]*S,a[2]=o[2]*S,a},h.number=Po,h.offscreenCanvasSupported=Ti,h.ortho=function(a,o,u,v,_,S,A){var R=1/(o-u),z=1/(v-_),W=1/(S-A);return a[0]=-2*R,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*z,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*W,a[11]=0,a[12]=(o+u)*R,a[13]=(_+v)*z,a[14]=(A+S)*W,a[15]=1,a},h.parseGlyphPBF=function(a){return new fh(a).readFields(En,[])},h.pbf=fh,h.performSymbolLayout=function(a,o,u,v,_,S,A){a.createArrays(),a.tilePixelRatio=8192/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;var R=a.layers[0].layout,z=a.layers[0]._unevaluatedLayout._values,W={};if(a.textSizeData.kind==="composite"){var q=a.textSizeData,ne=q.maxZoom;W.compositeTextSizes=[z["text-size"].possiblyEvaluate(new ma(q.minZoom),A),z["text-size"].possiblyEvaluate(new ma(ne),A)]}if(a.iconSizeData.kind==="composite"){var ae=a.iconSizeData,Te=ae.maxZoom;W.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new ma(ae.minZoom),A),z["icon-size"].possiblyEvaluate(new ma(Te),A)]}W.layoutTextSize=z["text-size"].possiblyEvaluate(new ma(a.zoom+1),A),W.layoutIconSize=z["icon-size"].possiblyEvaluate(new ma(a.zoom+1),A),W.textMaxSize=z["text-size"].possiblyEvaluate(new ma(18));for(var je=24*R.get("text-line-height"),Be=R.get("text-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",Je=R.get("text-keep-upright"),Qe=R.get("text-size"),Tt=function(){var xr=ar[Zt],dn=R.get("text-font").evaluate(xr,{},A).join(","),_n=Qe.evaluate(xr,{},A),ci=W.layoutTextSize.evaluate(xr,{},A),_i=W.layoutIconSize.evaluate(xr,{},A),vi={horizontal:{},vertical:void 0},ti=xr.text,Zi=[0,0];if(ti){var Pi=ti.toString(),xi=24*R.get("text-letter-spacing").evaluate(xr,{},A),Pa=function(za){for(var La=0,To=za;La<To.length;La+=1)if(Bo=To[La].charCodeAt(0),Ln.Arabic(Bo)||Ln["Arabic Supplement"](Bo)||Ln["Arabic Extended-A"](Bo)||Ln["Arabic Presentation Forms-A"](Bo)||Ln["Arabic Presentation Forms-B"](Bo))return!1;var Bo;return!0}(Pi)?xi:0,aa=R.get("text-anchor").evaluate(xr,{},A),to=R.get("text-variable-anchor");if(!to){var Fi=R.get("text-radial-offset").evaluate(xr,{},A);Zi=Fi?hr(aa,[24*Fi,Ge]):R.get("text-offset").evaluate(xr,{},A).map(function(za){return 24*za})}var Ra=Be?"center":R.get("text-justify").evaluate(xr,{},A),Do=R.get("symbol-placement"),Fo=Do==="point"?24*R.get("text-max-width").evaluate(xr,{},A):0,is=function(){a.allowVerticalPlacement&&Gl(Pi)&&(vi.vertical=Rr(ti,o,u,_,dn,Fo,je,aa,"left",Pa,Zi,qn.vertical,!0,Do,ci,_n))};if(!Be&&to){for(var as=Ra==="auto"?to.map(function(za){return Wt(za)}):[Ra],Yo=!1,qs=0;qs<as.length;qs++){var Ls=as[qs];if(!vi.horizontal[Ls])if(Yo)vi.horizontal[Ls]=vi.horizontal[0];else{var ol=Rr(ti,o,u,_,dn,Fo,je,"center",Ls,Pa,Zi,qn.horizontal,!1,Do,ci,_n);ol&&(vi.horizontal[Ls]=ol,Yo=ol.positionedLines.length===1)}}is()}else{Ra==="auto"&&(Ra=Wt(aa));var Qs=Rr(ti,o,u,_,dn,Fo,je,aa,Ra,Pa,Zi,qn.horizontal,!1,Do,ci,_n);Qs&&(vi.horizontal[Ra]=Qs),is(),Gl(Pi)&&Be&&Je&&(vi.vertical=Rr(ti,o,u,_,dn,Fo,je,aa,Ra,Pa,Zi,qn.vertical,!1,Do,ci,_n))}}var $u=void 0,du=!1;if(xr.icon&&xr.icon.name){var Js=v[xr.icon.name];Js&&($u=function(za,La,To){var Bo=ji(To),sl=La[0]-za.displaySize[0]*Bo.horizontalAlign,Vo=La[1]-za.displaySize[1]*Bo.verticalAlign;return{image:za,top:Vo,bottom:Vo+za.displaySize[1],left:sl,right:sl+za.displaySize[0]}}(_[xr.icon.name],R.get("icon-offset").evaluate(xr,{},A),R.get("icon-anchor").evaluate(xr,{},A)),du=Js.sdf,a.sdfIcons===void 0?a.sdfIcons=Js.sdf:a.sdfIcons!==Js.sdf&&Kt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Js.pixelRatio!==a.pixelRatio||R.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0))}var eu=va(vi.horizontal)||vi.vertical;a.iconsInText=!!eu&&eu.iconsInText,(eu||$u)&&function(za,La,To,Bo,sl,Vo,os,Bu,Ua,Nu,pc){var ef=Vo.textMaxSize.evaluate(La,{});ef===void 0&&(ef=os);var Au,Xi=za.layers[0].layout,vh=Xi.get("icon-offset").evaluate(La,{},pc),vu=va(To.horizontal),Ko=os/24,sd=za.tilePixelRatio*Ko,gl=za.tilePixelRatio*ef/24,ud=za.tilePixelRatio*Bu,Lp=za.tilePixelRatio*Xi.get("symbol-spacing"),kp=Xi.get("text-padding")*za.tilePixelRatio,Id=Xi.get("icon-padding")*za.tilePixelRatio,ld=Xi.get("text-max-angle")/180*Math.PI,Dp=Xi.get("text-rotation-alignment")==="map"&&Xi.get("symbol-placement")!=="point",zh=Xi.get("icon-rotation-alignment")==="map"&&Xi.get("symbol-placement")!=="point",dc=Xi.get("symbol-placement"),cd=Lp/2,mh=Xi.get("icon-text-fit");Bo&&mh!=="none"&&(za.allowVerticalPlacement&&To.vertical&&(Au=Dn(Bo,To.vertical,mh,Xi.get("icon-text-fit-padding"),vh,Ko)),vu&&(Bo=Dn(Bo,vu,mh,Xi.get("icon-text-fit-padding"),vh,Ko)));var Go=function(ja,gp){gp.x<0||gp.x>=8192||gp.y<0||gp.y>=8192||function(ao,vc,Um,oo,yv,_v,Di,Wf,Vi,Fd,zp,Bd,Nd,xv,zu,jh,bv,Ev,Sv,zd,yl,Ud,jd,Zf,vd){var ul,ks,Uu,yp,Vh,_p=ao.addToLineVertexArray(vc,Um),Cv=0,tm=0,rm=0,nm=0,Vd=-1,tu=-1,yh={},Na=Ze(""),Gd=0,Hd=0;if(Wf._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Gd=(ul=Wf.layout.get("text-offset").evaluate(yl,{},Zf).map(function(jp){return 24*jp}))[0],Hd=ul[1]):(Gd=24*Wf.layout.get("text-radial-offset").evaluate(yl,{},Zf),Hd=Ge),ao.allowVerticalPlacement&&oo.vertical){var im=Wf.layout.get("text-rotate").evaluate(yl,{},Zf)+90;yp=new Rs(Vi,vc,Fd,zp,Bd,oo.vertical,Nd,xv,zu,im),Di&&(Vh=new Rs(Vi,vc,Fd,zp,Bd,Di,bv,Ev,zu,im))}if(yv){var ve=Wf.layout.get("icon-rotate").evaluate(yl,{}),wv=Wf.layout.get("icon-text-fit")!=="none",Av=fu(yv,ve,jd,wv),_h=Di?fu(Di,ve,jd,wv):void 0;Uu=new Rs(Vi,vc,Fd,zp,Bd,yv,bv,Ev,!1,ve),Cv=4*Av.length;var Tv=ao.iconSizeData,Up=null;Tv.kind==="source"?(Up=[128*Wf.layout.get("icon-size").evaluate(yl,{})])[0]>32640&&Kt(ao.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Tv.kind==="composite"&&((Up=[128*Ud.compositeIconSizes[0].evaluate(yl,{},Zf),128*Ud.compositeIconSizes[1].evaluate(yl,{},Zf)])[0]>32640||Up[1]>32640)&&Kt(ao.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),ao.addSymbols(ao.icon,Av,Up,zd,Sv,yl,!1,vc,_p.lineStartIndex,_p.lineLength,-1,Zf),Vd=ao.icon.placedSymbolArray.length-1,_h&&(tm=4*_h.length,ao.addSymbols(ao.icon,_h,Up,zd,Sv,yl,qn.vertical,vc,_p.lineStartIndex,_p.lineLength,-1,Zf),tu=ao.icon.placedSymbolArray.length-1)}for(var Mv in oo.horizontal){var xh=oo.horizontal[Mv];if(!ks){Na=Ze(xh.text);var am=Wf.layout.get("text-rotate").evaluate(yl,{},Zf);ks=new Rs(Vi,vc,Fd,zp,Bd,xh,Nd,xv,zu,am)}var Wd=xh.positionedLines.length===1;if(rm+=Wn(ao,vc,xh,_v,Wf,zu,yl,jh,_p,oo.vertical?qn.horizontal:qn.horizontalOnly,Wd?Object.keys(oo.horizontal):[Mv],yh,Vd,Ud,Zf),Wd)break}oo.vertical&&(nm+=Wn(ao,vc,oo.vertical,_v,Wf,zu,yl,jh,_p,qn.vertical,["vertical"],yh,tu,Ud,Zf));var Pv=ks?ks.boxStartIndex:ao.collisionBoxArray.length,om=ks?ks.boxEndIndex:ao.collisionBoxArray.length,sm=yp?yp.boxStartIndex:ao.collisionBoxArray.length,Zd=yp?yp.boxEndIndex:ao.collisionBoxArray.length,jm=Uu?Uu.boxStartIndex:ao.collisionBoxArray.length,Vm=Uu?Uu.boxEndIndex:ao.collisionBoxArray.length,um=Vh?Vh.boxStartIndex:ao.collisionBoxArray.length,lm=Vh?Vh.boxEndIndex:ao.collisionBoxArray.length,bf=-1,md=function(Xd,Iv){return Xd&&Xd.circleDiameter?Math.max(Xd.circleDiameter,Iv):Iv};bf=md(ks,bf),bf=md(yp,bf),bf=md(Uu,bf);var Ov=(bf=md(Vh,bf))>-1?1:0;Ov&&(bf*=vd/24),ao.glyphOffsetArray.length>=Se.MAX_GLYPHS&&Kt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),yl.sortKey!==void 0&&ao.addToSortKeyRanges(ao.symbolInstances.length,yl.sortKey),ao.symbolInstances.emplaceBack(vc.x,vc.y,yh.right>=0?yh.right:-1,yh.center>=0?yh.center:-1,yh.left>=0?yh.left:-1,yh.vertical||-1,Vd,tu,Na,Pv,om,sm,Zd,jm,Vm,um,lm,Fd,rm,nm,Cv,tm,Ov,0,Nd,Gd,Hd,bf)}(za,gp,ja,To,Bo,sl,Au,za.layers[0],za.collisionBoxArray,La.index,La.sourceLayerIndex,za.index,sd,kp,Dp,Ua,ud,Id,zh,vh,La,Vo,Nu,pc,os)};if(dc==="line")for(var Cs=0,fd=cu(La.geometry,0,0,8192,8192);Cs<fd.length;Cs+=1)for(var Rd=fd[Cs],Fp=0,hd=lu(Rd,Lp,ld,To.vertical||vu,Bo,24,gl,za.overscaling,8192);Fp<hd.length;Fp+=1){var pd=hd[Fp];vu&&De(za,vu.text,cd,pd)||Go(Rd,pd)}else if(dc==="line-center")for(var Bp=0,dd=La.geometry;Bp<dd.length;Bp+=1){var dp=dd[Bp];if(dp.length>1){var gh=Is(dp,ld,To.vertical||vu,Bo,24,gl);gh&&Go(dp,gh)}}else if(La.type==="Polygon")for(var vp=0,mp=Bf(La.geometry,0);vp<mp.length;vp+=1){var Np=mp[vp],Gf=yo(Np,16);Go(Np[0],new Mi(Gf.x,Gf.y,0))}else if(La.type==="LineString")for(var qu=0,Hf=La.geometry;qu<Hf.length;qu+=1){var Ld=Hf[qu];Go(Ld,new Mi(Ld[0].x,Ld[0].y,0))}else if(La.type==="Point")for(var kd=0,em=La.geometry;kd<em.length;kd+=1)for(var gv=0,gs=em[kd];gv<gs.length;gv+=1){var Dd=gs[gv];Go([Dd],new Mi(Dd.x,Dd.y,0))}}(a,xr,vi,$u,v,W,ci,_i,Zi,du,A)},Zt=0,ar=a.features;Zt<ar.length;Zt+=1)Tt();S&&a.generateCollisionDebugBuffers()},h.perspective=function(a,o,u,v,_){var S,A=1/Math.tan(o/2);return a[0]=A/u,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=A,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,_!=null&&_!==1/0?(a[10]=(_+v)*(S=1/(v-_)),a[14]=2*_*v*S):(a[10]=-1,a[14]=-2*v),a},h.pick=function(a,o){for(var u={},v=0;v<o.length;v++){var _=o[v];_ in a&&(u[_]=a[_])}return u},h.plugin=rl,h.polygonIntersectsPolygon=Yu,h.postMapLoadEvent=Ir,h.postTurnstileEvent=ys,h.potpack=tr,h.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],h.register=Kn,h.registerForPluginStateChange=function(a){return a({pluginStatus:_u,pluginURL:Ec}),Hc.on("pluginStateChange",a),a},h.renderColorRamp=nh,h.rotate=function(a,o,u){var v=o[0],_=o[1],S=o[2],A=o[3],R=Math.sin(u),z=Math.cos(u);return a[0]=v*z+S*R,a[1]=_*z+A*R,a[2]=v*-R+S*z,a[3]=_*-R+A*z,a},h.rotateX=function(a,o,u){var v=Math.sin(u),_=Math.cos(u),S=o[4],A=o[5],R=o[6],z=o[7],W=o[8],q=o[9],ne=o[10],ae=o[11];return o!==a&&(a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[4]=S*_+W*v,a[5]=A*_+q*v,a[6]=R*_+ne*v,a[7]=z*_+ae*v,a[8]=W*_-S*v,a[9]=q*_-A*v,a[10]=ne*_-R*v,a[11]=ae*_-z*v,a},h.rotateZ=function(a,o,u){var v=Math.sin(u),_=Math.cos(u),S=o[0],A=o[1],R=o[2],z=o[3],W=o[4],q=o[5],ne=o[6],ae=o[7];return o!==a&&(a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=S*_+W*v,a[1]=A*_+q*v,a[2]=R*_+ne*v,a[3]=z*_+ae*v,a[4]=W*_-S*v,a[5]=q*_-A*v,a[6]=ne*_-R*v,a[7]=ae*_-z*v,a},h.scale=function(a,o,u){var v=u[0],_=u[1],S=u[2];return a[0]=o[0]*v,a[1]=o[1]*v,a[2]=o[2]*v,a[3]=o[3]*v,a[4]=o[4]*_,a[5]=o[5]*_,a[6]=o[6]*_,a[7]=o[7]*_,a[8]=o[8]*S,a[9]=o[9]*S,a[10]=o[10]*S,a[11]=o[11]*S,a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],a},h.scale$1=function(a,o,u){return a[0]=o[0]*u,a[1]=o[1]*u,a[2]=o[2]*u,a[3]=o[3]*u,a},h.scale$2=function(a,o,u){return a[0]=o[0]*u,a[1]=o[1]*u,a[2]=o[2]*u,a},h.setCacheLimits=function(a,o){en=a,On=o},h.setRTLTextPlugin=function(a,o,u){if(u===void 0&&(u=!1),_u==="deferred"||_u==="loading"||_u==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Ec=It.resolveURL(a),_u="deferred",Hl=o,th(),u||Wu()},h.sphericalToCartesian=function(a){var o=a[0],u=a[1],v=a[2];return u+=90,u*=Math.PI/180,v*=Math.PI/180,{x:o*Math.cos(u)*Math.sin(v),y:o*Math.sin(u)*Math.sin(v),z:o*Math.cos(v)}},h.sqrLen=function(a){var o=a[0],u=a[1];return o*o+u*u},h.styleSpec=Ce,h.sub=function(a,o,u){return a[0]=o[0]-u[0],a[1]=o[1]-u[1],a[2]=o[2]-u[2],a},h.symbolSize=ns,h.transformMat3=function(a,o,u){var v=o[0],_=o[1],S=o[2];return a[0]=v*u[0]+_*u[3]+S*u[6],a[1]=v*u[1]+_*u[4]+S*u[7],a[2]=v*u[2]+_*u[5]+S*u[8],a},h.transformMat4=Fu,h.translate=function(a,o,u){var v,_,S,A,R,z,W,q,ne,ae,Te,je,Be=u[0],Je=u[1],Qe=u[2];return o===a?(a[12]=o[0]*Be+o[4]*Je+o[8]*Qe+o[12],a[13]=o[1]*Be+o[5]*Je+o[9]*Qe+o[13],a[14]=o[2]*Be+o[6]*Je+o[10]*Qe+o[14],a[15]=o[3]*Be+o[7]*Je+o[11]*Qe+o[15]):(_=o[1],S=o[2],A=o[3],R=o[4],z=o[5],W=o[6],q=o[7],ne=o[8],ae=o[9],Te=o[10],je=o[11],a[0]=v=o[0],a[1]=_,a[2]=S,a[3]=A,a[4]=R,a[5]=z,a[6]=W,a[7]=q,a[8]=ne,a[9]=ae,a[10]=Te,a[11]=je,a[12]=v*Be+R*Je+ne*Qe+o[12],a[13]=_*Be+z*Je+ae*Qe+o[13],a[14]=S*Be+W*Je+Te*Qe+o[14],a[15]=A*Be+q*Je+je*Qe+o[15]),a},h.triggerPluginCompletionEvent=tp,h.uniqueId=ct,h.validateCustomStyleLayer=function(a){var o=[],u=a.id;return u===void 0&&o.push({message:"layers."+u+': missing required property "id"'}),a.render===void 0&&o.push({message:"layers."+u+': missing required method "render"'}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&o.push({message:"layers."+u+': property "renderingMode" must be either "2d" or "3d"'}),o},h.validateLight=Vl,h.validateStyle=lf,h.values=function(a){var o=[];for(var u in a)o.push(a[u]);return o},h.vectorTile=jf,h.version="1.13.2",h.warnOnce=Kt,h.webpSupported=ir,h.window=Ae,h.wrap=St}),k(["./shared"],function(h){"use strict";function V(oe){var ie=typeof oe;if(ie==="number"||ie==="boolean"||ie==="string"||oe==null)return JSON.stringify(oe);if(Array.isArray(oe)){for(var xe="[",Me=0,Ve=oe;Me<Ve.length;Me+=1)xe+=V(Ve[Me])+",";return xe+"]"}for(var ft=Object.keys(oe).sort(),Ct="{",Ce=0;Ce<ft.length;Ce++)Ct+=JSON.stringify(ft[Ce])+":"+V(oe[ft[Ce]])+",";return Ct+"}"}function H(oe){for(var ie="",xe=0,Me=h.refProperties;xe<Me.length;xe+=1)ie+="/"+V(oe[Me[xe]]);return ie}var te=function(ie){this.keyCache={},ie&&this.replace(ie)};te.prototype.replace=function(oe){this._layerConfigs={},this._layers={},this.update(oe,[])},te.prototype.update=function(oe,ie){for(var xe=this,Me=0,Ve=oe;Me<Ve.length;Me+=1){var ft=Ve[Me];this._layerConfigs[ft.id]=ft;var Ct=this._layers[ft.id]=h.createStyleLayer(ft);Ct._featureFilter=h.featureFilter(Ct.filter),this.keyCache[ft.id]&&delete this.keyCache[ft.id]}for(var Ce=0,Ye=ie;Ce<Ye.length;Ce+=1){var nt=Ye[Ce];delete this.keyCache[nt],delete this._layerConfigs[nt],delete this._layers[nt]}this.familiesBySource={};for(var Nr=0,Xr=function(Rn,Nn){for(var Gi={},Hn=0;Hn<Rn.length;Hn++){var ha=Nn&&Nn[Rn[Hn].id]||H(Rn[Hn]);Nn&&(Nn[Rn[Hn].id]=ha);var Sa=Gi[ha];Sa||(Sa=Gi[ha]=[]),Sa.push(Rn[Hn])}var Ji=[];for(var ei in Gi)Ji.push(Gi[ei]);return Ji}(h.values(this._layerConfigs),this.keyCache);Nr<Xr.length;Nr+=1){var dr=Xr[Nr].map(function(Rn){return xe._layers[Rn.id]}),Yr=dr[0];if(Yr.visibility!=="none"){var xn=Yr.source||"",Gn=this.familiesBySource[xn];Gn||(Gn=this.familiesBySource[xn]={});var pr=Yr.sourceLayer||"_geojsonTileLayer",jn=Gn[pr];jn||(jn=Gn[pr]=[]),jn.push(dr)}}};var pe=function(ie){var xe={},Me=[];for(var Ve in ie){var ft=ie[Ve],Ct=xe[Ve]={};for(var Ce in ft){var Ye=ft[+Ce];if(Ye&&Ye.bitmap.width!==0&&Ye.bitmap.height!==0){var nt={x:0,y:0,w:Ye.bitmap.width+2,h:Ye.bitmap.height+2};Me.push(nt),Ct[Ce]={rect:nt,metrics:Ye.metrics}}}}var Nr=h.potpack(Me),Xr=new h.AlphaImage({width:Nr.w||1,height:Nr.h||1});for(var dr in ie){var Yr=ie[dr];for(var xn in Yr){var Gn=Yr[+xn];if(Gn&&Gn.bitmap.width!==0&&Gn.bitmap.height!==0){var pr=xe[dr][xn].rect;h.AlphaImage.copy(Gn.bitmap,Xr,{x:0,y:0},{x:pr.x+1,y:pr.y+1},Gn.bitmap)}}}this.image=Xr,this.positions=xe};h.register("GlyphAtlas",pe);var Oe=function(ie){this.tileID=new h.OverscaledTileID(ie.tileID.overscaledZ,ie.tileID.wrap,ie.tileID.canonical.z,ie.tileID.canonical.x,ie.tileID.canonical.y),this.uid=ie.uid,this.zoom=ie.zoom,this.pixelRatio=ie.pixelRatio,this.tileSize=ie.tileSize,this.source=ie.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ie.showCollisionBoxes,this.collectResourceTiming=!!ie.collectResourceTiming,this.returnDependencies=!!ie.returnDependencies,this.promoteId=ie.promoteId};function Ae(oe,ie,xe){for(var Me=new h.EvaluationParameters(ie),Ve=0,ft=oe;Ve<ft.length;Ve+=1)ft[Ve].recalculate(Me,xe)}function vt(oe,ie){var xe=h.getArrayBuffer(oe.request,function(Me,Ve,ft,Ct){Me?ie(Me):Ve&&ie(null,{vectorTile:new h.vectorTile.VectorTile(new h.pbf(Ve)),rawData:Ve,cacheControl:ft,expires:Ct})});return function(){xe.cancel(),ie()}}Oe.prototype.parse=function(oe,ie,xe,Me,Ve){var ft=this;this.status="parsing",this.data=oe,this.collisionBoxArray=new h.CollisionBoxArray;var Ct=new h.DictionaryCoder(Object.keys(oe.layers).sort()),Ce=new h.FeatureIndex(this.tileID,this.promoteId);Ce.bucketLayerIDs=[];var Ye,nt,Nr,Xr,dr={},Yr={featureIndex:Ce,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:xe},xn=ie.familiesBySource[this.source];for(var Gn in xn){var pr=oe.layers[Gn];if(pr){pr.version===1&&h.warnOnce('Vector tile source "'+this.source+'" layer "'+Gn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var jn=Ct.encode(Gn),Rn=[],Nn=0;Nn<pr.length;Nn++){var Gi=pr.feature(Nn),Hn=Ce.getId(Gi,Gn);Rn.push({feature:Gi,id:Hn,index:Nn,sourceLayerIndex:jn})}for(var ha=0,Sa=xn[Gn];ha<Sa.length;ha+=1){var Ji=Sa[ha],ei=Ji[0];ei.minzoom&&this.zoom<Math.floor(ei.minzoom)||ei.maxzoom&&this.zoom>=ei.maxzoom||ei.visibility!=="none"&&(Ae(Ji,this.zoom,xe),(dr[ei.id]=ei.createBucket({index:Ce.bucketLayerIDs.length,layers:Ji,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:jn,sourceID:this.source})).populate(Rn,Yr,this.tileID.canonical),Ce.bucketLayerIDs.push(Ji.map(function(Ei){return Ei.id})))}}}var ua=h.mapObject(Yr.glyphDependencies,function(Ei){return Object.keys(Ei).map(Number)});Object.keys(ua).length?Me.send("getGlyphs",{uid:this.uid,stacks:ua},function(Ei,Qi){Ye||(Ye=Ei,nt=Qi,zo.call(ft))}):nt={};var Ds=Object.keys(Yr.iconDependencies);Ds.length?Me.send("getImages",{icons:Ds,source:this.source,tileID:this.tileID,type:"icons"},function(Ei,Qi){Ye||(Ye=Ei,Nr=Qi,zo.call(ft))}):Nr={};var Ca=Object.keys(Yr.patternDependencies);function zo(){if(Ye)return Ve(Ye);if(nt&&Nr&&Xr){var Ei=new pe(nt),Qi=new h.ImageAtlas(Nr,Xr);for(var Bi in dr){var Uo=dr[Bi];Uo instanceof h.SymbolBucket?(Ae(Uo.layers,this.zoom,xe),h.performSymbolLayout(Uo,nt,Ei.positions,Nr,Qi.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Uo.hasPattern&&(Uo instanceof h.LineBucket||Uo instanceof h.FillBucket||Uo instanceof h.FillExtrusionBucket)&&(Ae(Uo.layers,this.zoom,xe),Uo.addFeatures(Yr,this.tileID.canonical,Qi.patternPositions))}this.status="done",Ve(null,{buckets:h.values(dr).filter(function(Ho){return!Ho.isEmpty()}),featureIndex:Ce,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ei.image,imageAtlas:Qi,glyphMap:this.returnDependencies?nt:null,iconMap:this.returnDependencies?Nr:null,glyphPositions:this.returnDependencies?Ei.positions:null})}}Ca.length?Me.send("getImages",{icons:Ca,source:this.source,tileID:this.tileID,type:"patterns"},function(Ei,Qi){Ye||(Ye=Ei,Xr=Qi,zo.call(ft))}):Xr={},zo.call(this)};var at=function(ie,xe,Me,Ve){this.actor=ie,this.layerIndex=xe,this.availableImages=Me,this.loadVectorData=Ve||vt,this.loading={},this.loaded={}};at.prototype.loadTile=function(oe,ie){var xe=this,Me=oe.uid;this.loading||(this.loading={});var Ve=!!(oe&&oe.request&&oe.request.collectResourceTiming)&&new h.RequestPerformance(oe.request),ft=this.loading[Me]=new Oe(oe);ft.abort=this.loadVectorData(oe,function(Ct,Ce){if(delete xe.loading[Me],Ct||!Ce)return ft.status="done",xe.loaded[Me]=ft,ie(Ct);var Ye=Ce.rawData,nt={};Ce.expires&&(nt.expires=Ce.expires),Ce.cacheControl&&(nt.cacheControl=Ce.cacheControl);var Nr={};if(Ve){var Xr=Ve.finish();Xr&&(Nr.resourceTiming=JSON.parse(JSON.stringify(Xr)))}ft.vectorTile=Ce.vectorTile,ft.parse(Ce.vectorTile,xe.layerIndex,xe.availableImages,xe.actor,function(dr,Yr){if(dr||!Yr)return ie(dr);ie(null,h.extend({rawTileData:Ye.slice(0)},Yr,nt,Nr))}),xe.loaded=xe.loaded||{},xe.loaded[Me]=ft})},at.prototype.reloadTile=function(oe,ie){var xe=this,Me=this.loaded,Ve=oe.uid,ft=this;if(Me&&Me[Ve]){var Ct=Me[Ve];Ct.showCollisionBoxes=oe.showCollisionBoxes;var Ce=function(nt,Nr){var Xr=Ct.reloadCallback;Xr&&(delete Ct.reloadCallback,Ct.parse(Ct.vectorTile,ft.layerIndex,xe.availableImages,ft.actor,Xr)),ie(nt,Nr)};Ct.status==="parsing"?Ct.reloadCallback=Ce:Ct.status==="done"&&(Ct.vectorTile?Ct.parse(Ct.vectorTile,this.layerIndex,this.availableImages,this.actor,Ce):Ce())}},at.prototype.abortTile=function(oe,ie){var xe=this.loading,Me=oe.uid;xe&&xe[Me]&&xe[Me].abort&&(xe[Me].abort(),delete xe[Me]),ie()},at.prototype.removeTile=function(oe,ie){var xe=this.loaded,Me=oe.uid;xe&&xe[Me]&&delete xe[Me],ie()};var gt=h.window.ImageBitmap,yt=function(){this.loaded={}};function St(oe,ie){if(oe.length!==0){He(oe[0],ie);for(var xe=1;xe<oe.length;xe++)He(oe[xe],!ie)}}function He(oe,ie){for(var xe=0,Me=0,Ve=oe.length,ft=Ve-1;Me<Ve;ft=Me++)xe+=(oe[Me][0]-oe[ft][0])*(oe[ft][1]+oe[Me][1]);xe>=0!=!!ie&&oe.reverse()}yt.prototype.loadTile=function(oe,ie){var xe=oe.uid,Me=oe.encoding,Ve=oe.rawImageData,ft=gt&&Ve instanceof gt?this.getImageData(Ve):Ve,Ct=new h.DEMData(xe,ft,Me);this.loaded=this.loaded||{},this.loaded[xe]=Ct,ie(null,Ct)},yt.prototype.getImageData=function(oe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(oe.width,oe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=oe.width,this.offscreenCanvas.height=oe.height,this.offscreenCanvasContext.drawImage(oe,0,0,oe.width,oe.height);var ie=this.offscreenCanvasContext.getImageData(-1,-1,oe.width+2,oe.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new h.RGBAImage({width:ie.width,height:ie.height},ie.data)},yt.prototype.removeTile=function(oe){var ie=this.loaded,xe=oe.uid;ie&&ie[xe]&&delete ie[xe]};var dt=h.vectorTile.VectorTileFeature.prototype.toGeoJSON,ct=function(ie){this._feature=ie,this.extent=h.EXTENT,this.type=ie.type,this.properties=ie.tags,"id"in ie&&!isNaN(ie.id)&&(this.id=parseInt(ie.id,10))};ct.prototype.loadGeometry=function(){if(this._feature.type===1){for(var oe=[],ie=0,xe=this._feature.geometry;ie<xe.length;ie+=1){var Me=xe[ie];oe.push([new h.Point$1(Me[0],Me[1])])}return oe}for(var Ve=[],ft=0,Ct=this._feature.geometry;ft<Ct.length;ft+=1){for(var Ce=[],Ye=0,nt=Ct[ft];Ye<nt.length;Ye+=1){var Nr=nt[Ye];Ce.push(new h.Point$1(Nr[0],Nr[1]))}Ve.push(Ce)}return Ve},ct.prototype.toGeoJSON=function(oe,ie,xe){return dt.call(this,oe,ie,xe)};var _t=function(ie){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.EXTENT,this.length=ie.length,this._features=ie};_t.prototype.feature=function(oe){return new ct(this._features[oe])};var ee=h.vectorTile.VectorTileFeature,rr=Fr;function Fr(oe,ie){this.options=ie||{},this.features=oe,this.length=oe.length}function Mr(oe,ie){this.id=typeof oe.id=="number"?oe.id:void 0,this.type=oe.type,this.rawGeometry=oe.type===1?[oe.geometry]:oe.geometry,this.properties=oe.tags,this.extent=ie||4096}Fr.prototype.feature=function(oe){return new Mr(this.features[oe],this.options.extent)},Mr.prototype.loadGeometry=function(){var oe=this.rawGeometry;this.geometry=[];for(var ie=0;ie<oe.length;ie++){for(var xe=oe[ie],Me=[],Ve=0;Ve<xe.length;Ve++)Me.push(new h.Point$1(xe[Ve][0],xe[Ve][1]));this.geometry.push(Me)}return this.geometry},Mr.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var oe=this.geometry,ie=1/0,xe=-1/0,Me=1/0,Ve=-1/0,ft=0;ft<oe.length;ft++)for(var Ct=oe[ft],Ce=0;Ce<Ct.length;Ce++){var Ye=Ct[Ce];ie=Math.min(ie,Ye.x),xe=Math.max(xe,Ye.x),Me=Math.min(Me,Ye.y),Ve=Math.max(Ve,Ye.y)}return[ie,Me,xe,Ve]},Mr.prototype.toGeoJSON=ee.prototype.toGeoJSON;var Nt=zt,ze=rr;function zt(oe){var ie=new h.pbf;return function(xe,Me){for(var Ve in xe.layers)Me.writeMessage(3,Kt,xe.layers[Ve])}(oe,ie),ie.finish()}function Kt(oe,ie){var xe;ie.writeVarintField(15,oe.version||1),ie.writeStringField(1,oe.name||""),ie.writeVarintField(5,oe.extent||4096);var Me={keys:[],values:[],keycache:{},valuecache:{}};for(xe=0;xe<oe.length;xe++)Me.feature=oe.feature(xe),ie.writeMessage(2,vr,Me);var Ve=Me.keys;for(xe=0;xe<Ve.length;xe++)ie.writeStringField(3,Ve[xe]);var ft=Me.values;for(xe=0;xe<ft.length;xe++)ie.writeMessage(4,Ne,ft[xe])}function vr(oe,ie){var xe=oe.feature;xe.id!==void 0&&ie.writeVarintField(1,xe.id),ie.writeMessage(2,jr,oe),ie.writeVarintField(3,xe.type),ie.writeMessage(4,be,xe)}function jr(oe,ie){var xe=oe.feature,Me=oe.keys,Ve=oe.values,ft=oe.keycache,Ct=oe.valuecache;for(var Ce in xe.properties){var Ye=ft[Ce];Ye===void 0&&(Me.push(Ce),ft[Ce]=Ye=Me.length-1),ie.writeVarint(Ye);var nt=xe.properties[Ce],Nr=typeof nt;Nr!=="string"&&Nr!=="boolean"&&Nr!=="number"&&(nt=JSON.stringify(nt));var Xr=Nr+":"+nt,dr=Ct[Xr];dr===void 0&&(Ve.push(nt),Ct[Xr]=dr=Ve.length-1),ie.writeVarint(dr)}}function vn(oe,ie){return(ie<<3)+(7&oe)}function kr(oe){return oe<<1^oe>>31}function be(oe,ie){for(var xe=oe.loadGeometry(),Me=oe.type,Ve=0,ft=0,Ct=xe.length,Ce=0;Ce<Ct;Ce++){var Ye=xe[Ce],nt=1;Me===1&&(nt=Ye.length),ie.writeVarint(vn(1,nt));for(var Nr=Me===3?Ye.length-1:Ye.length,Xr=0;Xr<Nr;Xr++){Xr===1&&Me!==1&&ie.writeVarint(vn(2,Nr-1));var dr=Ye[Xr].x-Ve,Yr=Ye[Xr].y-ft;ie.writeVarint(kr(dr)),ie.writeVarint(kr(Yr)),Ve+=dr,ft+=Yr}Me===3&&ie.writeVarint(vn(7,1))}}function Ne(oe,ie){var xe=typeof oe;xe==="string"?ie.writeStringField(1,oe):xe==="boolean"?ie.writeBooleanField(7,oe):xe==="number"&&(oe%1!=0?ie.writeDoubleField(3,oe):oe<0?ie.writeSVarintField(6,oe):ie.writeVarintField(5,oe))}function Ie(oe,ie,xe,Me){pt(oe,xe,Me),pt(ie,2*xe,2*Me),pt(ie,2*xe+1,2*Me+1)}function pt(oe,ie,xe){var Me=oe[ie];oe[ie]=oe[xe],oe[xe]=Me}function mt(oe,ie,xe,Me){var Ve=oe-xe,ft=ie-Me;return Ve*Ve+ft*ft}Nt.fromVectorTileJs=zt,Nt.fromGeojsonVt=function(oe,ie){ie=ie||{};var xe={};for(var Me in oe)xe[Me]=new rr(oe[Me].features,ie),xe[Me].name=Me,xe[Me].version=ie.version,xe[Me].extent=ie.extent;return zt({layers:xe})},Nt.GeoJSONWrapper=ze;var Dt=function(ie){return ie[0]},w=function(ie){return ie[1]},br=function(ie,xe,Me,Ve,ft){xe===void 0&&(xe=Dt),Me===void 0&&(Me=w),Ve===void 0&&(Ve=64),ft===void 0&&(ft=Float64Array),this.nodeSize=Ve,this.points=ie;for(var Ct=ie.length<65536?Uint16Array:Uint32Array,Ce=this.ids=new Ct(ie.length),Ye=this.coords=new ft(2*ie.length),nt=0;nt<ie.length;nt++)Ce[nt]=nt,Ye[2*nt]=xe(ie[nt]),Ye[2*nt+1]=Me(ie[nt]);(function Nr(Xr,dr,Yr,xn,Gn,pr){if(!(Gn-xn<=Yr)){var jn=xn+Gn>>1;(function Rn(Nn,Gi,Hn,ha,Sa,Ji){for(;Sa>ha;){if(Sa-ha>600){var ei=Sa-ha+1,ua=Hn-ha+1,Ds=Math.log(ei),Ca=.5*Math.exp(2*Ds/3),zo=.5*Math.sqrt(Ds*Ca*(ei-Ca)/ei)*(ua-ei/2<0?-1:1);Rn(Nn,Gi,Hn,Math.max(ha,Math.floor(Hn-ua*Ca/ei+zo)),Math.min(Sa,Math.floor(Hn+(ei-ua)*Ca/ei+zo)),Ji)}var Ei=Gi[2*Hn+Ji],Qi=ha,Bi=Sa;for(Ie(Nn,Gi,ha,Hn),Gi[2*Sa+Ji]>Ei&&Ie(Nn,Gi,ha,Sa);Qi<Bi;){for(Ie(Nn,Gi,Qi,Bi),Qi++,Bi--;Gi[2*Qi+Ji]<Ei;)Qi++;for(;Gi[2*Bi+Ji]>Ei;)Bi--}Gi[2*ha+Ji]===Ei?Ie(Nn,Gi,ha,Bi):Ie(Nn,Gi,++Bi,Sa),Bi<=Hn&&(ha=Bi+1),Hn<=Bi&&(Sa=Bi-1)}})(Xr,dr,jn,xn,Gn,pr%2),Nr(Xr,dr,Yr,xn,jn-1,pr+1),Nr(Xr,dr,Yr,jn+1,Gn,pr+1)}})(Ce,Ye,Ve,0,Ce.length-1,0)};br.prototype.range=function(oe,ie,xe,Me){return function(Ve,ft,Ct,Ce,Ye,nt,Nr){for(var Xr,dr,Yr=[0,Ve.length-1,0],xn=[];Yr.length;){var Gn=Yr.pop(),pr=Yr.pop(),jn=Yr.pop();if(pr-jn<=Nr)for(var Rn=jn;Rn<=pr;Rn++)dr=ft[2*Rn+1],(Xr=ft[2*Rn])>=Ct&&Xr<=Ye&&dr>=Ce&&dr<=nt&&xn.push(Ve[Rn]);else{var Nn=Math.floor((jn+pr)/2);dr=ft[2*Nn+1],(Xr=ft[2*Nn])>=Ct&&Xr<=Ye&&dr>=Ce&&dr<=nt&&xn.push(Ve[Nn]);var Gi=(Gn+1)%2;(Gn===0?Ct<=Xr:Ce<=dr)&&(Yr.push(jn),Yr.push(Nn-1),Yr.push(Gi)),(Gn===0?Ye>=Xr:nt>=dr)&&(Yr.push(Nn+1),Yr.push(pr),Yr.push(Gi))}}return xn}(this.ids,this.coords,oe,ie,xe,Me,this.nodeSize)},br.prototype.within=function(oe,ie,xe){return function(Me,Ve,ft,Ct,Ce,Ye){for(var nt=[0,Me.length-1,0],Nr=[],Xr=Ce*Ce;nt.length;){var dr=nt.pop(),Yr=nt.pop(),xn=nt.pop();if(Yr-xn<=Ye)for(var Gn=xn;Gn<=Yr;Gn++)mt(Ve[2*Gn],Ve[2*Gn+1],ft,Ct)<=Xr&&Nr.push(Me[Gn]);else{var pr=Math.floor((xn+Yr)/2),jn=Ve[2*pr],Rn=Ve[2*pr+1];mt(jn,Rn,ft,Ct)<=Xr&&Nr.push(Me[pr]);var Nn=(dr+1)%2;(dr===0?ft-Ce<=jn:Ct-Ce<=Rn)&&(nt.push(xn),nt.push(pr-1),nt.push(Nn)),(dr===0?ft+Ce>=jn:Ct+Ce>=Rn)&&(nt.push(pr+1),nt.push(Yr),nt.push(Nn))}}return Nr}(this.ids,this.coords,oe,ie,xe,this.nodeSize)};var Ut={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ie){return ie}},Xt=function(ie){this.options=$r(Object.create(Ut),ie),this.trees=new Array(this.options.maxZoom+1)};function It(oe,ie,xe,Me,Ve){return{x:oe,y:ie,zoom:1/0,id:xe,parentId:-1,numPoints:Me,properties:Ve}}function Lt(oe,ie){var xe=oe.geometry.coordinates,Me=xe[1];return{x:nr(xe[0]),y:Pr(Me),zoom:1/0,index:ie,parentId:-1}}function ir(oe){return{type:"Feature",id:oe.id,properties:Ar(oe),geometry:{type:"Point",coordinates:[(Me=oe.x,360*(Me-.5)),(ie=oe.y,xe=(180-360*ie)*Math.PI/180,360*Math.atan(Math.exp(xe))/Math.PI-90)]}};var ie,xe,Me}function Ar(oe){var ie=oe.numPoints,xe=ie>=1e4?Math.round(ie/1e3)+"k":ie>=1e3?Math.round(ie/100)/10+"k":ie;return $r($r({},oe.properties),{cluster:!0,cluster_id:oe.id,point_count:ie,point_count_abbreviated:xe})}function nr(oe){return oe/360+.5}function Pr(oe){var ie=Math.sin(oe*Math.PI/180),xe=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return xe<0?0:xe>1?1:xe}function $r(oe,ie){for(var xe in ie)oe[xe]=ie[xe];return oe}function Or(oe){return oe.x}function _r(oe){return oe.y}function Br(oe,ie,xe,Me,Ve,ft){var Ct=Ve-xe,Ce=ft-Me;if(Ct!==0||Ce!==0){var Ye=((oe-xe)*Ct+(ie-Me)*Ce)/(Ct*Ct+Ce*Ce);Ye>1?(xe=Ve,Me=ft):Ye>0&&(xe+=Ct*Ye,Me+=Ce*Ye)}return(Ct=oe-xe)*Ct+(Ce=ie-Me)*Ce}function Jn(oe,ie,xe,Me){var Ve={id:oe===void 0?null:oe,type:ie,geometry:xe,tags:Me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ft){var Ct=ft.geometry,Ce=ft.type;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")mn(ft,Ct);else if(Ce==="Polygon"||Ce==="MultiLineString")for(var Ye=0;Ye<Ct.length;Ye++)mn(ft,Ct[Ye]);else if(Ce==="MultiPolygon")for(Ye=0;Ye<Ct.length;Ye++)for(var nt=0;nt<Ct[Ye].length;nt++)mn(ft,Ct[Ye][nt])}(Ve),Ve}function mn(oe,ie){for(var xe=0;xe<ie.length;xe+=3)oe.minX=Math.min(oe.minX,ie[xe]),oe.minY=Math.min(oe.minY,ie[xe+1]),oe.maxX=Math.max(oe.maxX,ie[xe]),oe.maxY=Math.max(oe.maxY,ie[xe+1])}function wn(oe,ie,xe,Me){if(ie.geometry){var Ve=ie.geometry.coordinates,ft=ie.geometry.type,Ct=Math.pow(xe.tolerance/((1<<xe.maxZoom)*xe.extent),2),Ce=[],Ye=ie.id;if(xe.promoteId?Ye=ie.properties[xe.promoteId]:xe.generateId&&(Ye=Me||0),ft==="Point")pi(Ve,Ce);else if(ft==="MultiPoint")for(var nt=0;nt<Ve.length;nt++)pi(Ve[nt],Ce);else if(ft==="LineString")Ci(Ve,Ce,Ct,!1);else if(ft==="MultiLineString"){if(xe.lineMetrics){for(nt=0;nt<Ve.length;nt++)Ci(Ve[nt],Ce=[],Ct,!1),oe.push(Jn(Ye,"LineString",Ce,ie.properties));return}fa(Ve,Ce,Ct,!1)}else if(ft==="Polygon")fa(Ve,Ce,Ct,!0);else{if(ft!=="MultiPolygon"){if(ft==="GeometryCollection"){for(nt=0;nt<ie.geometry.geometries.length;nt++)wn(oe,{id:Ye,geometry:ie.geometry.geometries[nt],properties:ie.properties},xe,Me);return}throw new Error("Input data is not a valid GeoJSON object.")}for(nt=0;nt<Ve.length;nt++){var Nr=[];fa(Ve[nt],Nr,Ct,!0),Ce.push(Nr)}}oe.push(Jn(Ye,ft,Ce,ie.properties))}}function pi(oe,ie){ie.push(_e(oe[0])),ie.push(Pn(oe[1])),ie.push(0)}function Ci(oe,ie,xe,Me){for(var Ve,ft,Ct=0,Ce=0;Ce<oe.length;Ce++){var Ye=_e(oe[Ce][0]),nt=Pn(oe[Ce][1]);ie.push(Ye),ie.push(nt),ie.push(0),Ce>0&&(Ct+=Me?(Ve*nt-Ye*ft)/2:Math.sqrt(Math.pow(Ye-Ve,2)+Math.pow(nt-ft,2))),Ve=Ye,ft=nt}var Nr=ie.length-3;ie[2]=1,function Xr(dr,Yr,xn,Gn){for(var pr,jn=Gn,Rn=xn-Yr>>1,Nn=xn-Yr,Gi=dr[Yr],Hn=dr[Yr+1],ha=dr[xn],Sa=dr[xn+1],Ji=Yr+3;Ji<xn;Ji+=3){var ei=Br(dr[Ji],dr[Ji+1],Gi,Hn,ha,Sa);if(ei>jn)pr=Ji,jn=ei;else if(ei===jn){var ua=Math.abs(Ji-Rn);ua<Nn&&(pr=Ji,Nn=ua)}}jn>Gn&&(pr-Yr>3&&Xr(dr,Yr,pr,Gn),dr[pr+2]=jn,xn-pr>3&&Xr(dr,pr,xn,Gn))}(ie,0,Nr,xe),ie[Nr+2]=1,ie.size=Math.abs(Ct),ie.start=0,ie.end=ie.size}function fa(oe,ie,xe,Me){for(var Ve=0;Ve<oe.length;Ve++){var ft=[];Ci(oe[Ve],ft,xe,Me),ie.push(ft)}}function _e(oe){return oe/360+.5}function Pn(oe){var ie=Math.sin(oe*Math.PI/180),xe=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return xe<0?0:xe>1?1:xe}function oa(oe,ie,xe,Me,Ve,ft,Ct,Ce){if(Me/=ie,ft>=(xe/=ie)&&Ct<Me)return oe;if(Ct<xe||ft>=Me)return null;for(var Ye=[],nt=0;nt<oe.length;nt++){var Nr=oe[nt],Xr=Nr.geometry,dr=Nr.type,Yr=Ve===0?Nr.minX:Nr.minY,xn=Ve===0?Nr.maxX:Nr.maxY;if(Yr>=xe&&xn<Me)Ye.push(Nr);else if(!(xn<xe||Yr>=Me)){var Gn=[];if(dr==="Point"||dr==="MultiPoint")ws(Xr,Gn,xe,Me,Ve);else if(dr==="LineString")ys(Xr,Gn,xe,Me,Ve,!1,Ce.lineMetrics);else if(dr==="MultiLineString")Ir(Xr,Gn,xe,Me,Ve,!1);else if(dr==="Polygon")Ir(Xr,Gn,xe,Me,Ve,!0);else if(dr==="MultiPolygon")for(var pr=0;pr<Xr.length;pr++){var jn=[];Ir(Xr[pr],jn,xe,Me,Ve,!0),jn.length&&Gn.push(jn)}if(Gn.length){if(Ce.lineMetrics&&dr==="LineString"){for(pr=0;pr<Gn.length;pr++)Ye.push(Jn(Nr.id,dr,Gn[pr],Nr.tags));continue}dr!=="LineString"&&dr!=="MultiLineString"||(Gn.length===1?(dr="LineString",Gn=Gn[0]):dr="MultiLineString"),dr!=="Point"&&dr!=="MultiPoint"||(dr=Gn.length===3?"Point":"MultiPoint"),Ye.push(Jn(Nr.id,dr,Gn,Nr.tags))}}}return Ye.length?Ye:null}function ws(oe,ie,xe,Me,Ve){for(var ft=0;ft<oe.length;ft+=3){var Ct=oe[ft+Ve];Ct>=xe&&Ct<=Me&&(ie.push(oe[ft]),ie.push(oe[ft+1]),ie.push(oe[ft+2]))}}function ys(oe,ie,xe,Me,Ve,ft,Ct){for(var Ce,Ye,nt=Jt(oe),Nr=Ve===0?On:ln,Xr=oe.start,dr=0;dr<oe.length-3;dr+=3){var Yr=oe[dr],xn=oe[dr+1],Gn=oe[dr+2],pr=oe[dr+3],jn=oe[dr+4],Rn=Ve===0?Yr:xn,Nn=Ve===0?pr:jn,Gi=!1;Ct&&(Ce=Math.sqrt(Math.pow(Yr-pr,2)+Math.pow(xn-jn,2))),Rn<xe?Nn>xe&&(Ye=Nr(nt,Yr,xn,pr,jn,xe),Ct&&(nt.start=Xr+Ce*Ye)):Rn>Me?Nn<Me&&(Ye=Nr(nt,Yr,xn,pr,jn,Me),Ct&&(nt.start=Xr+Ce*Ye)):en(nt,Yr,xn,Gn),Nn<xe&&Rn>=xe&&(Ye=Nr(nt,Yr,xn,pr,jn,xe),Gi=!0),Nn>Me&&Rn<=Me&&(Ye=Nr(nt,Yr,xn,pr,jn,Me),Gi=!0),!ft&&Gi&&(Ct&&(nt.end=Xr+Ce*Ye),ie.push(nt),nt=Jt(oe)),Ct&&(Xr+=Ce)}var Hn=oe.length-3;Yr=oe[Hn],xn=oe[Hn+1],Gn=oe[Hn+2],(Rn=Ve===0?Yr:xn)>=xe&&Rn<=Me&&en(nt,Yr,xn,Gn),Hn=nt.length-3,ft&&Hn>=3&&(nt[Hn]!==nt[0]||nt[Hn+1]!==nt[1])&&en(nt,nt[0],nt[1],nt[2]),nt.length&&ie.push(nt)}function Jt(oe){var ie=[];return ie.size=oe.size,ie.start=oe.start,ie.end=oe.end,ie}function Ir(oe,ie,xe,Me,Ve,ft){for(var Ct=0;Ct<oe.length;Ct++)ys(oe[Ct],ie,xe,Me,Ve,ft,!1)}function en(oe,ie,xe,Me){oe.push(ie),oe.push(xe),oe.push(Me)}function On(oe,ie,xe,Me,Ve,ft){var Ct=(ft-ie)/(Me-ie);return oe.push(ft),oe.push(xe+(Ve-xe)*Ct),oe.push(1),Ct}function ln(oe,ie,xe,Me,Ve,ft){var Ct=(ft-xe)/(Ve-xe);return oe.push(ie+(Me-ie)*Ct),oe.push(ft),oe.push(1),Ct}function Ka(oe,ie){for(var xe=[],Me=0;Me<oe.length;Me++){var Ve,ft=oe[Me],Ct=ft.type;if(Ct==="Point"||Ct==="MultiPoint"||Ct==="LineString")Ve=wi(ft.geometry,ie);else if(Ct==="MultiLineString"||Ct==="Polygon"){Ve=[];for(var Ce=0;Ce<ft.geometry.length;Ce++)Ve.push(wi(ft.geometry[Ce],ie))}else if(Ct==="MultiPolygon")for(Ve=[],Ce=0;Ce<ft.geometry.length;Ce++){for(var Ye=[],nt=0;nt<ft.geometry[Ce].length;nt++)Ye.push(wi(ft.geometry[Ce][nt],ie));Ve.push(Ye)}xe.push(Jn(ft.id,Ct,Ve,ft.tags))}return xe}function wi(oe,ie){var xe=[];xe.size=oe.size,oe.start!==void 0&&(xe.start=oe.start,xe.end=oe.end);for(var Me=0;Me<oe.length;Me+=3)xe.push(oe[Me]+ie,oe[Me+1],oe[Me+2]);return xe}function fi(oe,ie){if(oe.transformed)return oe;var xe,Me,Ve,ft=1<<oe.z,Ct=oe.x,Ce=oe.y;for(xe=0;xe<oe.features.length;xe++){var Ye=oe.features[xe],nt=Ye.geometry,Nr=Ye.type;if(Ye.geometry=[],Nr===1)for(Me=0;Me<nt.length;Me+=2)Ye.geometry.push(Ti(nt[Me],nt[Me+1],ie,ft,Ct,Ce));else for(Me=0;Me<nt.length;Me++){var Xr=[];for(Ve=0;Ve<nt[Me].length;Ve+=2)Xr.push(Ti(nt[Me][Ve],nt[Me][Ve+1],ie,ft,Ct,Ce));Ye.geometry.push(Xr)}}return oe.transformed=!0,oe}function Ti(oe,ie,xe,Me,Ve,ft){return[Math.round(xe*(oe*Me-Ve)),Math.round(xe*(ie*Me-ft))]}function da(oe,ie,xe,Me,Ve){for(var ft=ie===Ve.maxZoom?0:Ve.tolerance/((1<<ie)*Ve.extent),Ct={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:xe,y:Me,z:ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ce=0;Ce<oe.length;Ce++){Ct.numFeatures++,ya(Ct,oe[Ce],ft,Ve);var Ye=oe[Ce].minX,nt=oe[Ce].minY,Nr=oe[Ce].maxX,Xr=oe[Ce].maxY;Ye<Ct.minX&&(Ct.minX=Ye),nt<Ct.minY&&(Ct.minY=nt),Nr>Ct.maxX&&(Ct.maxX=Nr),Xr>Ct.maxY&&(Ct.maxY=Xr)}return Ct}function ya(oe,ie,xe,Me){var Ve=ie.geometry,ft=ie.type,Ct=[];if(ft==="Point"||ft==="MultiPoint")for(var Ce=0;Ce<Ve.length;Ce+=3)Ct.push(Ve[Ce]),Ct.push(Ve[Ce+1]),oe.numPoints++,oe.numSimplified++;else if(ft==="LineString")_s(Ct,Ve,oe,xe,!1,!1);else if(ft==="MultiLineString"||ft==="Polygon")for(Ce=0;Ce<Ve.length;Ce++)_s(Ct,Ve[Ce],oe,xe,ft==="Polygon",Ce===0);else if(ft==="MultiPolygon")for(var Ye=0;Ye<Ve.length;Ye++){var nt=Ve[Ye];for(Ce=0;Ce<nt.length;Ce++)_s(Ct,nt[Ce],oe,xe,!0,Ce===0)}if(Ct.length){var Nr=ie.tags||null;if(ft==="LineString"&&Me.lineMetrics){for(var Xr in Nr={},ie.tags)Nr[Xr]=ie.tags[Xr];Nr.mapbox_clip_start=Ve.start/Ve.size,Nr.mapbox_clip_end=Ve.end/Ve.size}var dr={geometry:Ct,type:ft==="Polygon"||ft==="MultiPolygon"?3:ft==="LineString"||ft==="MultiLineString"?2:1,tags:Nr};ie.id!==null&&(dr.id=ie.id),oe.features.push(dr)}}function _s(oe,ie,xe,Me,Ve,ft){var Ct=Me*Me;if(Me>0&&ie.size<(Ve?Ct:Me))xe.numPoints+=ie.length/3;else{for(var Ce=[],Ye=0;Ye<ie.length;Ye+=3)(Me===0||ie[Ye+2]>Ct)&&(xe.numSimplified++,Ce.push(ie[Ye]),Ce.push(ie[Ye+1])),xe.numPoints++;Ve&&function(nt,Nr){for(var Xr=0,dr=0,Yr=nt.length,xn=Yr-2;dr<Yr;xn=dr,dr+=2)Xr+=(nt[dr]-nt[xn])*(nt[dr+1]+nt[xn+1]);if(Xr>0===Nr)for(dr=0,Yr=nt.length;dr<Yr/2;dr+=2){var Gn=nt[dr],pr=nt[dr+1];nt[dr]=nt[Yr-2-dr],nt[dr+1]=nt[Yr-1-dr],nt[Yr-2-dr]=Gn,nt[Yr-1-dr]=pr}}(Ce,ft),oe.push(Ce)}}function xo(oe,ie){var xe=(ie=this.options=function(Ve,ft){for(var Ct in ft)Ve[Ct]=ft[Ct];return Ve}(Object.create(this.options),ie)).debug;if(xe&&console.time("preprocess data"),ie.maxZoom<0||ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ie.promoteId&&ie.generateId)throw new Error("promoteId and generateId cannot be used together.");var Me=function(Ve,ft){var Ct=[];if(Ve.type==="FeatureCollection")for(var Ce=0;Ce<Ve.features.length;Ce++)wn(Ct,Ve.features[Ce],ft,Ce);else wn(Ct,Ve.type==="Feature"?Ve:{geometry:Ve},ft);return Ct}(oe,ie);this.tiles={},this.tileCoords=[],xe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ie.indexMaxZoom,ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Me=function(Ve,ft){var Ct=ft.buffer/ft.extent,Ce=Ve,Ye=oa(Ve,1,-1-Ct,Ct,0,-1,2,ft),nt=oa(Ve,1,1-Ct,2+Ct,0,-1,2,ft);return(Ye||nt)&&(Ce=oa(Ve,1,-Ct,1+Ct,0,-1,2,ft)||[],Ye&&(Ce=Ka(Ye,1).concat(Ce)),nt&&(Ce=Ce.concat(Ka(nt,-1)))),Ce}(Me,ie)).length&&this.splitTile(Me,0,0,0),xe&&(Me.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function $a(oe,ie,xe){return 32*((1<<oe)*xe+ie)+oe}function Vu(oe,ie){var xe=oe.tileID.canonical;if(!this._geoJSONIndex)return ie(null,null);var Me=this._geoJSONIndex.getTile(xe.z,xe.x,xe.y);if(!Me)return ie(null,null);var Ve=new _t(Me.features),ft=Nt(Ve);ft.byteOffset===0&&ft.byteLength===ft.buffer.byteLength||(ft=new Uint8Array(ft)),ie(null,{vectorTile:Ve,rawData:ft.buffer})}Xt.prototype.load=function(oe){var ie=this.options,xe=ie.log,Me=ie.minZoom,Ve=ie.maxZoom,ft=ie.nodeSize;xe&&console.time("total time");var Ct="prepare "+oe.length+" points";xe&&console.time(Ct),this.points=oe;for(var Ce=[],Ye=0;Ye<oe.length;Ye++)oe[Ye].geometry&&Ce.push(Lt(oe[Ye],Ye));this.trees[Ve+1]=new br(Ce,Or,_r,ft,Float32Array),xe&&console.timeEnd(Ct);for(var nt=Ve;nt>=Me;nt--){var Nr=+Date.now();Ce=this._cluster(Ce,nt),this.trees[nt]=new br(Ce,Or,_r,ft,Float32Array),xe&&console.log("z%d: %d clusters in %dms",nt,Ce.length,+Date.now()-Nr)}return xe&&console.timeEnd("total time"),this},Xt.prototype.getClusters=function(oe,ie){var xe=((oe[0]+180)%360+360)%360-180,Me=Math.max(-90,Math.min(90,oe[1])),Ve=oe[2]===180?180:((oe[2]+180)%360+360)%360-180,ft=Math.max(-90,Math.min(90,oe[3]));if(oe[2]-oe[0]>=360)xe=-180,Ve=180;else if(xe>Ve){var Ct=this.getClusters([xe,Me,180,ft],ie),Ce=this.getClusters([-180,Me,Ve,ft],ie);return Ct.concat(Ce)}for(var Ye=this.trees[this._limitZoom(ie)],nt=[],Nr=0,Xr=Ye.range(nr(xe),Pr(ft),nr(Ve),Pr(Me));Nr<Xr.length;Nr+=1){var dr=Ye.points[Xr[Nr]];nt.push(dr.numPoints?ir(dr):this.points[dr.index])}return nt},Xt.prototype.getChildren=function(oe){var ie=this._getOriginId(oe),xe=this._getOriginZoom(oe),Me="No cluster with the specified id.",Ve=this.trees[xe];if(!Ve)throw new Error(Me);var ft=Ve.points[ie];if(!ft)throw new Error(Me);for(var Ct=this.options.radius/(this.options.extent*Math.pow(2,xe-1)),Ce=[],Ye=0,nt=Ve.within(ft.x,ft.y,Ct);Ye<nt.length;Ye+=1){var Nr=Ve.points[nt[Ye]];Nr.parentId===oe&&Ce.push(Nr.numPoints?ir(Nr):this.points[Nr.index])}if(Ce.length===0)throw new Error(Me);return Ce},Xt.prototype.getLeaves=function(oe,ie,xe){var Me=[];return this._appendLeaves(Me,oe,ie=ie||10,xe=xe||0,0),Me},Xt.prototype.getTile=function(oe,ie,xe){var Me=this.trees[this._limitZoom(oe)],Ve=Math.pow(2,oe),ft=this.options,Ct=ft.radius/ft.extent,Ce=(xe-Ct)/Ve,Ye=(xe+1+Ct)/Ve,nt={features:[]};return this._addTileFeatures(Me.range((ie-Ct)/Ve,Ce,(ie+1+Ct)/Ve,Ye),Me.points,ie,xe,Ve,nt),ie===0&&this._addTileFeatures(Me.range(1-Ct/Ve,Ce,1,Ye),Me.points,Ve,xe,Ve,nt),ie===Ve-1&&this._addTileFeatures(Me.range(0,Ce,Ct/Ve,Ye),Me.points,-1,xe,Ve,nt),nt.features.length?nt:null},Xt.prototype.getClusterExpansionZoom=function(oe){for(var ie=this._getOriginZoom(oe)-1;ie<=this.options.maxZoom;){var xe=this.getChildren(oe);if(ie++,xe.length!==1)break;oe=xe[0].properties.cluster_id}return ie},Xt.prototype._appendLeaves=function(oe,ie,xe,Me,Ve){for(var ft=0,Ct=this.getChildren(ie);ft<Ct.length;ft+=1){var Ce=Ct[ft],Ye=Ce.properties;if(Ye&&Ye.cluster?Ve+Ye.point_count<=Me?Ve+=Ye.point_count:Ve=this._appendLeaves(oe,Ye.cluster_id,xe,Me,Ve):Ve<Me?Ve++:oe.push(Ce),oe.length===xe)break}return Ve},Xt.prototype._addTileFeatures=function(oe,ie,xe,Me,Ve,ft){for(var Ct=0,Ce=oe;Ct<Ce.length;Ct+=1){var Ye=ie[Ce[Ct]],nt=Ye.numPoints,Nr={type:1,geometry:[[Math.round(this.options.extent*(Ye.x*Ve-xe)),Math.round(this.options.extent*(Ye.y*Ve-Me))]],tags:nt?Ar(Ye):this.points[Ye.index].properties},Xr=void 0;nt?Xr=Ye.id:this.options.generateId?Xr=Ye.index:this.points[Ye.index].id&&(Xr=this.points[Ye.index].id),Xr!==void 0&&(Nr.id=Xr),ft.features.push(Nr)}},Xt.prototype._limitZoom=function(oe){return Math.max(this.options.minZoom,Math.min(+oe,this.options.maxZoom+1))},Xt.prototype._cluster=function(oe,ie){for(var xe=[],Me=this.options,Ve=Me.reduce,ft=Me.minPoints,Ct=Me.radius/(Me.extent*Math.pow(2,ie)),Ce=0;Ce<oe.length;Ce++){var Ye=oe[Ce];if(!(Ye.zoom<=ie)){Ye.zoom=ie;for(var nt=this.trees[ie+1],Nr=nt.within(Ye.x,Ye.y,Ct),Xr=Ye.numPoints||1,dr=Xr,Yr=0,xn=Nr;Yr<xn.length;Yr+=1){var Gn=nt.points[xn[Yr]];Gn.zoom>ie&&(dr+=Gn.numPoints||1)}if(dr>=ft){for(var pr=Ye.x*Xr,jn=Ye.y*Xr,Rn=Ve&&Xr>1?this._map(Ye,!0):null,Nn=(Ce<<5)+(ie+1)+this.points.length,Gi=0,Hn=Nr;Gi<Hn.length;Gi+=1){var ha=nt.points[Hn[Gi]];if(!(ha.zoom<=ie)){ha.zoom=ie;var Sa=ha.numPoints||1;pr+=ha.x*Sa,jn+=ha.y*Sa,ha.parentId=Nn,Ve&&(Rn||(Rn=this._map(Ye,!0)),Ve(Rn,this._map(ha)))}}Ye.parentId=Nn,xe.push(It(pr/dr,jn/dr,Nn,dr,Rn))}else if(xe.push(Ye),dr>1)for(var Ji=0,ei=Nr;Ji<ei.length;Ji+=1){var ua=nt.points[ei[Ji]];ua.zoom<=ie||(ua.zoom=ie,xe.push(ua))}}}return xe},Xt.prototype._getOriginId=function(oe){return oe-this.points.length>>5},Xt.prototype._getOriginZoom=function(oe){return(oe-this.points.length)%32},Xt.prototype._map=function(oe,ie){if(oe.numPoints)return ie?$r({},oe.properties):oe.properties;var xe=this.points[oe.index].properties,Me=this.options.map(xe);return ie&&Me===xe?$r({},Me):Me},xo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},xo.prototype.splitTile=function(oe,ie,xe,Me,Ve,ft,Ct){for(var Ce=[oe,ie,xe,Me],Ye=this.options,nt=Ye.debug;Ce.length;){Me=Ce.pop(),xe=Ce.pop(),ie=Ce.pop(),oe=Ce.pop();var Nr=1<<ie,Xr=$a(ie,xe,Me),dr=this.tiles[Xr];if(!dr&&(nt>1&&console.time("creation"),dr=this.tiles[Xr]=da(oe,ie,xe,Me,Ye),this.tileCoords.push({z:ie,x:xe,y:Me}),nt)){nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ie,xe,Me,dr.numFeatures,dr.numPoints,dr.numSimplified),console.timeEnd("creation"));var Yr="z"+ie;this.stats[Yr]=(this.stats[Yr]||0)+1,this.total++}if(dr.source=oe,Ve){if(ie===Ye.maxZoom||ie===Ve)continue;var xn=1<<Ve-ie;if(xe!==Math.floor(ft/xn)||Me!==Math.floor(Ct/xn))continue}else if(ie===Ye.indexMaxZoom||dr.numPoints<=Ye.indexMaxPoints)continue;if(dr.source=null,oe.length!==0){nt>1&&console.time("clipping");var Gn,pr,jn,Rn,Nn,Gi,Hn=.5*Ye.buffer/Ye.extent,ha=.5-Hn,Sa=.5+Hn,Ji=1+Hn;Gn=pr=jn=Rn=null,Nn=oa(oe,Nr,xe-Hn,xe+Sa,0,dr.minX,dr.maxX,Ye),Gi=oa(oe,Nr,xe+ha,xe+Ji,0,dr.minX,dr.maxX,Ye),oe=null,Nn&&(Gn=oa(Nn,Nr,Me-Hn,Me+Sa,1,dr.minY,dr.maxY,Ye),pr=oa(Nn,Nr,Me+ha,Me+Ji,1,dr.minY,dr.maxY,Ye),Nn=null),Gi&&(jn=oa(Gi,Nr,Me-Hn,Me+Sa,1,dr.minY,dr.maxY,Ye),Rn=oa(Gi,Nr,Me+ha,Me+Ji,1,dr.minY,dr.maxY,Ye),Gi=null),nt>1&&console.timeEnd("clipping"),Ce.push(Gn||[],ie+1,2*xe,2*Me),Ce.push(pr||[],ie+1,2*xe,2*Me+1),Ce.push(jn||[],ie+1,2*xe+1,2*Me),Ce.push(Rn||[],ie+1,2*xe+1,2*Me+1)}}},xo.prototype.getTile=function(oe,ie,xe){var Me=this.options,Ve=Me.extent,ft=Me.debug;if(oe<0||oe>24)return null;var Ct=1<<oe,Ce=$a(oe,ie=(ie%Ct+Ct)%Ct,xe);if(this.tiles[Ce])return fi(this.tiles[Ce],Ve);ft>1&&console.log("drilling down to z%d-%d-%d",oe,ie,xe);for(var Ye,nt=oe,Nr=ie,Xr=xe;!Ye&&nt>0;)nt--,Nr=Math.floor(Nr/2),Xr=Math.floor(Xr/2),Ye=this.tiles[$a(nt,Nr,Xr)];return Ye&&Ye.source?(ft>1&&console.log("found parent tile z%d-%d-%d",nt,Nr,Xr),ft>1&&console.time("drilling down"),this.splitTile(Ye.source,nt,Nr,Xr,oe,ie,xe),ft>1&&console.timeEnd("drilling down"),this.tiles[Ce]?fi(this.tiles[Ce],Ve):null):null};var ec=function(oe){function ie(xe,Me,Ve,ft){oe.call(this,xe,Me,Ve,Vu),ft&&(this.loadGeoJSON=ft)}return oe&&(ie.__proto__=oe),(ie.prototype=Object.create(oe&&oe.prototype)).constructor=ie,ie.prototype.loadData=function(xe,Me){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Me,this._pendingLoadDataParams=xe,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},ie.prototype._loadData=function(){var xe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Me=this._pendingCallback,Ve=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ft=!!(Ve&&Ve.request&&Ve.request.collectResourceTiming)&&new h.RequestPerformance(Ve.request);this.loadGeoJSON(Ve,function(Ct,Ce){if(Ct||!Ce)return Me(Ct);if(typeof Ce!="object")return Me(new Error("Input data given to '"+Ve.source+"' is not a valid GeoJSON object."));(function dr(Yr,xn){var Gn,pr=Yr&&Yr.type;if(pr==="FeatureCollection")for(Gn=0;Gn<Yr.features.length;Gn++)dr(Yr.features[Gn],xn);else if(pr==="GeometryCollection")for(Gn=0;Gn<Yr.geometries.length;Gn++)dr(Yr.geometries[Gn],xn);else if(pr==="Feature")dr(Yr.geometry,xn);else if(pr==="Polygon")St(Yr.coordinates,xn);else if(pr==="MultiPolygon")for(Gn=0;Gn<Yr.coordinates.length;Gn++)St(Yr.coordinates[Gn],xn);return Yr})(Ce,!0);try{if(Ve.filter){var Ye=h.createExpression(Ve.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ye.result==="error")throw new Error(Ye.value.map(function(dr){return dr.key+": "+dr.message}).join(", "));var nt=Ce.features.filter(function(dr){return Ye.value.evaluate({zoom:0},dr)});Ce={type:"FeatureCollection",features:nt}}xe._geoJSONIndex=Ve.cluster?new Xt(function(dr){var Yr=dr.superclusterOptions,xn=dr.clusterProperties;if(!xn||!Yr)return Yr;for(var Gn={},pr={},jn={accumulated:null,zoom:0},Rn={properties:null},Nn=Object.keys(xn),Gi=0,Hn=Nn;Gi<Hn.length;Gi+=1){var ha=Hn[Gi],Sa=xn[ha],Ji=Sa[0],ei=h.createExpression(Sa[1]),ua=h.createExpression(typeof Ji=="string"?[Ji,["accumulated"],["get",ha]]:Ji);Gn[ha]=ei.value,pr[ha]=ua.value}return Yr.map=function(Ds){Rn.properties=Ds;for(var Ca={},zo=0,Ei=Nn;zo<Ei.length;zo+=1){var Qi=Ei[zo];Ca[Qi]=Gn[Qi].evaluate(jn,Rn)}return Ca},Yr.reduce=function(Ds,Ca){Rn.properties=Ca;for(var zo=0,Ei=Nn;zo<Ei.length;zo+=1){var Qi=Ei[zo];jn.accumulated=Ds[Qi],Ds[Qi]=pr[Qi].evaluate(jn,Rn)}},Yr}(Ve)).load(Ce.features):function(dr,Yr){return new xo(dr,Yr)}(Ce,Ve.geojsonVtOptions)}catch(dr){return Me(dr)}xe.loaded={};var Nr={};if(ft){var Xr=ft.finish();Xr&&(Nr.resourceTiming={},Nr.resourceTiming[Ve.source]=JSON.parse(JSON.stringify(Xr)))}Me(null,Nr)})}},ie.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},ie.prototype.reloadTile=function(xe,Me){var Ve=this.loaded;return Ve&&Ve[xe.uid]?oe.prototype.reloadTile.call(this,xe,Me):this.loadTile(xe,Me)},ie.prototype.loadGeoJSON=function(xe,Me){if(xe.request)h.getJSON(xe.request,Me);else{if(typeof xe.data!="string")return Me(new Error("Input data given to '"+xe.source+"' is not a valid GeoJSON object."));try{return Me(null,JSON.parse(xe.data))}catch(Ve){return Me(new Error("Input data given to '"+xe.source+"' is not a valid GeoJSON object."))}}},ie.prototype.removeSource=function(xe,Me){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Me()},ie.prototype.getClusterExpansionZoom=function(xe,Me){try{Me(null,this._geoJSONIndex.getClusterExpansionZoom(xe.clusterId))}catch(Ve){Me(Ve)}},ie.prototype.getClusterChildren=function(xe,Me){try{Me(null,this._geoJSONIndex.getChildren(xe.clusterId))}catch(Ve){Me(Ve)}},ie.prototype.getClusterLeaves=function(xe,Me){try{Me(null,this._geoJSONIndex.getLeaves(xe.clusterId,xe.limit,xe.offset))}catch(Ve){Me(Ve)}},ie}(at),wo=function(ie){var xe=this;this.self=ie,this.actor=new h.Actor(ie,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:at,geojson:ec},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Me,Ve){if(xe.workerSourceTypes[Me])throw new Error('Worker source with name "'+Me+'" already registered.');xe.workerSourceTypes[Me]=Ve},this.self.registerRTLTextPlugin=function(Me){if(h.plugin.isParsed())throw new Error("RTL text plugin already registered.");h.plugin.applyArabicShaping=Me.applyArabicShaping,h.plugin.processBidirectionalText=Me.processBidirectionalText,h.plugin.processStyledBidirectionalText=Me.processStyledBidirectionalText}};return wo.prototype.setReferrer=function(oe,ie){this.referrer=ie},wo.prototype.setImages=function(oe,ie,xe){for(var Me in this.availableImages[oe]=ie,this.workerSources[oe]){var Ve=this.workerSources[oe][Me];for(var ft in Ve)Ve[ft].availableImages=ie}xe()},wo.prototype.setLayers=function(oe,ie,xe){this.getLayerIndex(oe).replace(ie),xe()},wo.prototype.updateLayers=function(oe,ie,xe){this.getLayerIndex(oe).update(ie.layers,ie.removedIds),xe()},wo.prototype.loadTile=function(oe,ie,xe){this.getWorkerSource(oe,ie.type,ie.source).loadTile(ie,xe)},wo.prototype.loadDEMTile=function(oe,ie,xe){this.getDEMWorkerSource(oe,ie.source).loadTile(ie,xe)},wo.prototype.reloadTile=function(oe,ie,xe){this.getWorkerSource(oe,ie.type,ie.source).reloadTile(ie,xe)},wo.prototype.abortTile=function(oe,ie,xe){this.getWorkerSource(oe,ie.type,ie.source).abortTile(ie,xe)},wo.prototype.removeTile=function(oe,ie,xe){this.getWorkerSource(oe,ie.type,ie.source).removeTile(ie,xe)},wo.prototype.removeDEMTile=function(oe,ie){this.getDEMWorkerSource(oe,ie.source).removeTile(ie)},wo.prototype.removeSource=function(oe,ie,xe){if(this.workerSources[oe]&&this.workerSources[oe][ie.type]&&this.workerSources[oe][ie.type][ie.source]){var Me=this.workerSources[oe][ie.type][ie.source];delete this.workerSources[oe][ie.type][ie.source],Me.removeSource!==void 0?Me.removeSource(ie,xe):xe()}},wo.prototype.loadWorkerSource=function(oe,ie,xe){try{this.self.importScripts(ie.url),xe()}catch(Me){xe(Me.toString())}},wo.prototype.syncRTLPluginState=function(oe,ie,xe){try{h.plugin.setState(ie);var Me=h.plugin.getPluginURL();if(h.plugin.isLoaded()&&!h.plugin.isParsed()&&Me!=null){this.self.importScripts(Me);var Ve=h.plugin.isParsed();xe(Ve?void 0:new Error("RTL Text Plugin failed to import scripts from "+Me),Ve)}}catch(ft){xe(ft.toString())}},wo.prototype.getAvailableImages=function(oe){var ie=this.availableImages[oe];return ie||(ie=[]),ie},wo.prototype.getLayerIndex=function(oe){var ie=this.layerIndexes[oe];return ie||(ie=this.layerIndexes[oe]=new te),ie},wo.prototype.getWorkerSource=function(oe,ie,xe){var Me=this;return this.workerSources[oe]||(this.workerSources[oe]={}),this.workerSources[oe][ie]||(this.workerSources[oe][ie]={}),this.workerSources[oe][ie][xe]||(this.workerSources[oe][ie][xe]=new this.workerSourceTypes[ie]({send:function(ft,Ct,Ce){Me.actor.send(ft,Ct,Ce,oe)}},this.getLayerIndex(oe),this.getAvailableImages(oe))),this.workerSources[oe][ie][xe]},wo.prototype.getDEMWorkerSource=function(oe,ie){return this.demWorkerSources[oe]||(this.demWorkerSources[oe]={}),this.demWorkerSources[oe][ie]||(this.demWorkerSources[oe][ie]=new yt),this.demWorkerSources[oe][ie]},wo.prototype.enforceCacheSizeLimit=function(oe,ie){h.enforceCacheSizeLimit(ie)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new wo(self)),wo}),k(["./shared"],function(h){"use strict";var V=h.createCommonjsModule(function(d){function f(C){return!l(C)}function l(C){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var D,N,K=new Blob([""],{type:"text/javascript"}),re=URL.createObjectURL(K);try{N=new Worker(re),D=!0}catch(ge){D=!1}return N&&N.terminate(),URL.revokeObjectURL(re),D}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var D=document.createElement("canvas");D.width=D.height=1;var N=D.getContext("2d");if(!N)return!1;var K=N.getImageData(0,0,1,1);return K&&K.width===D.width}()?(m[P=C&&C.failIfMajorPerformanceCaveat]===void 0&&(m[P]=function(D){var N=function(re){var ge=document.createElement("canvas"),ye=Object.create(f.webGLContextAttributes);return ye.failIfMajorPerformanceCaveat=re,ge.probablySupportsContext?ge.probablySupportsContext("webgl",ye)||ge.probablySupportsContext("experimental-webgl",ye):ge.supportsContext?ge.supportsContext("webgl",ye)||ge.supportsContext("experimental-webgl",ye):ge.getContext("webgl",ye)||ge.getContext("experimental-webgl",ye)}(D);if(!N)return!1;var K=N.createShader(N.VERTEX_SHADER);return!(!K||N.isContextLost())&&(N.shaderSource(K,"void main() {}"),N.compileShader(K),N.getShaderParameter(K,N.COMPILE_STATUS)===!0)}(P)),m[P]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var P}d.exports?d.exports=f:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=f,window.mapboxgl.notSupportedReason=l);var m={};f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),H={create:function(f,l,m){var C=h.window.document.createElement(f);return l!==void 0&&(C.className=l),m&&m.appendChild(C),C},createNS:function(f,l){return h.window.document.createElementNS(f,l)}},te=h.window.document&&h.window.document.documentElement.style;function pe(d){if(!te)return d[0];for(var f=0;f<d.length;f++)if(d[f]in te)return d[f];return d[0]}var Oe,Ae=pe(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);H.disableDrag=function(){te&&Ae&&(Oe=te[Ae],te[Ae]="none")},H.enableDrag=function(){te&&Ae&&(te[Ae]=Oe)};var vt=pe(["transform","WebkitTransform"]);H.setTransform=function(d,f){d.style[vt]=f};var at=!1;try{var gt=Object.defineProperty({},"passive",{get:function(){at=!0}});h.window.addEventListener("test",gt,gt),h.window.removeEventListener("test",gt,gt)}catch(d){at=!1}H.addEventListener=function(d,f,l,m){m===void 0&&(m={}),d.addEventListener(f,l,"passive"in m&&at?m:m.capture)},H.removeEventListener=function(d,f,l,m){m===void 0&&(m={}),d.removeEventListener(f,l,"passive"in m&&at?m:m.capture)};var yt=function d(f){f.preventDefault(),f.stopPropagation(),h.window.removeEventListener("click",d,!0)};function St(d){var f=d.userImage;return!!(f&&f.render&&f.render())&&(d.data.replace(new Uint8Array(f.data.buffer)),!0)}H.suppressClick=function(){h.window.addEventListener("click",yt,!0),h.window.setTimeout(function(){h.window.removeEventListener("click",yt,!0)},0)},H.mousePos=function(d,f){var l=d.getBoundingClientRect();return new h.Point(f.clientX-l.left-d.clientLeft,f.clientY-l.top-d.clientTop)},H.touchPos=function(d,f){for(var l=d.getBoundingClientRect(),m=[],C=0;C<f.length;C++)m.push(new h.Point(f[C].clientX-l.left-d.clientLeft,f[C].clientY-l.top-d.clientTop));return m},H.mouseButton=function(d){return h.window.InstallTrigger!==void 0&&d.button===2&&d.ctrlKey&&h.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button},H.remove=function(d){d.parentNode&&d.parentNode.removeChild(d)};var He=function(d){function f(){d.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.RGBAImage({width:1,height:1}),this.dirty=!0}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.isLoaded=function(){return this.loaded},f.prototype.setLoaded=function(l){if(this.loaded!==l&&(this.loaded=l,l)){for(var m=0,C=this.requestors;m<C.length;m+=1){var P=C[m];this._notify(P.ids,P.callback)}this.requestors=[]}},f.prototype.getImage=function(l){return this.images[l]},f.prototype.addImage=function(l,m){this._validate(l,m)&&(this.images[l]=m)},f.prototype._validate=function(l,m){var C=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new h.ErrorEvent(new Error('Image "'+l+'" has invalid "stretchX" value'))),C=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new h.ErrorEvent(new Error('Image "'+l+'" has invalid "stretchY" value'))),C=!1),this._validateContent(m.content,m)||(this.fire(new h.ErrorEvent(new Error('Image "'+l+'" has invalid "content" value'))),C=!1),C},f.prototype._validateStretch=function(l,m){if(!l)return!0;for(var C=0,P=0,D=l;P<D.length;P+=1){var N=D[P];if(N[0]<C||N[1]<N[0]||m<N[1])return!1;C=N[1]}return!0},f.prototype._validateContent=function(l,m){return!(l&&(l.length!==4||l[0]<0||m.data.width<l[0]||l[1]<0||m.data.height<l[1]||l[2]<0||m.data.width<l[2]||l[3]<0||m.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))},f.prototype.updateImage=function(l,m){m.version=this.images[l].version+1,this.images[l]=m,this.updatedImages[l]=!0},f.prototype.removeImage=function(l){var m=this.images[l];delete this.images[l],delete this.patterns[l],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()},f.prototype.listImages=function(){return Object.keys(this.images)},f.prototype.getImages=function(l,m){var C=!0;if(!this.isLoaded())for(var P=0,D=l;P<D.length;P+=1)this.images[D[P]]||(C=!1);this.isLoaded()||C?this._notify(l,m):this.requestors.push({ids:l,callback:m})},f.prototype._notify=function(l,m){for(var C={},P=0,D=l;P<D.length;P+=1){var N=D[P];this.images[N]||this.fire(new h.Event("styleimagemissing",{id:N}));var K=this.images[N];K?C[N]={data:K.data.clone(),pixelRatio:K.pixelRatio,sdf:K.sdf,version:K.version,stretchX:K.stretchX,stretchY:K.stretchY,content:K.content,hasRenderCallback:Boolean(K.userImage&&K.userImage.render)}:h.warnOnce('Image "'+N+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}m(null,C)},f.prototype.getPixelSize=function(){var l=this.atlasImage;return{width:l.width,height:l.height}},f.prototype.getPattern=function(l){var m=this.patterns[l],C=this.getImage(l);if(!C)return null;if(m&&m.position.version===C.version)return m.position;if(m)m.position.version=C.version;else{var P={w:C.data.width+2,h:C.data.height+2,x:0,y:0},D=new h.ImagePosition(P,C);this.patterns[l]={bin:P,position:D}}return this._updatePatternAtlas(),this.patterns[l].position},f.prototype.bind=function(l){var m=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new h.Texture(l,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)},f.prototype._updatePatternAtlas=function(){var l=[];for(var m in this.patterns)l.push(this.patterns[m].bin);var C=h.potpack(l),P=C.w,D=C.h,N=this.atlasImage;for(var K in N.resize({width:P||1,height:D||1}),this.patterns){var re=this.patterns[K].bin,ge=re.x+1,ye=re.y+1,we=this.images[K].data,We=we.width,Ue=we.height;h.RGBAImage.copy(we,N,{x:0,y:0},{x:ge,y:ye},{width:We,height:Ue}),h.RGBAImage.copy(we,N,{x:0,y:Ue-1},{x:ge,y:ye-1},{width:We,height:1}),h.RGBAImage.copy(we,N,{x:0,y:0},{x:ge,y:ye+Ue},{width:We,height:1}),h.RGBAImage.copy(we,N,{x:We-1,y:0},{x:ge-1,y:ye},{width:1,height:Ue}),h.RGBAImage.copy(we,N,{x:0,y:0},{x:ge+We,y:ye},{width:1,height:Ue})}this.dirty=!0},f.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},f.prototype.dispatchRenderCallbacks=function(l){for(var m=0,C=l;m<C.length;m+=1){var P=C[m];if(!this.callbackDispatchedThisFrame[P]){this.callbackDispatchedThisFrame[P]=!0;var D=this.images[P];St(D)&&this.updateImage(P,D)}}},f}(h.Evented),dt=ee,ct=ee,_t=1e20;function ee(d,f,l,m,C,P){this.fontSize=d||24,this.buffer=f===void 0?3:f,this.cutoff=m||.25,this.fontFamily=C||"sans-serif",this.fontWeight=P||"normal",this.radius=l||8;var D=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=D,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(D*D),this.gridInner=new Float64Array(D*D),this.f=new Float64Array(D),this.d=new Float64Array(D),this.z=new Float64Array(D+1),this.v=new Int16Array(D),this.middle=Math.round(D/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function rr(d,f,l,m,C,P,D){for(var N=0;N<f;N++){for(var K=0;K<l;K++)m[K]=d[K*f+N];for(Fr(m,C,P,D,l),K=0;K<l;K++)d[K*f+N]=C[K]}for(K=0;K<l;K++){for(N=0;N<f;N++)m[N]=d[K*f+N];for(Fr(m,C,P,D,f),N=0;N<f;N++)d[K*f+N]=Math.sqrt(C[N])}}function Fr(d,f,l,m,C){l[0]=0,m[0]=-_t,m[1]=+_t;for(var P=1,D=0;P<C;P++){for(var N=(d[P]+P*P-(d[l[D]]+l[D]*l[D]))/(2*P-2*l[D]);N<=m[D];)D--,N=(d[P]+P*P-(d[l[D]]+l[D]*l[D]))/(2*P-2*l[D]);l[++D]=P,m[D]=N,m[D+1]=+_t}for(P=0,D=0;P<C;P++){for(;m[D+1]<P;)D++;f[P]=(P-l[D])*(P-l[D])+d[l[D]]}}ee.prototype.draw=function(d){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(d,this.buffer,this.middle);for(var f=this.ctx.getImageData(0,0,this.size,this.size),l=new Uint8ClampedArray(this.size*this.size),m=0;m<this.size*this.size;m++){var C=f.data[4*m+3]/255;this.gridOuter[m]=C===1?0:C===0?_t:Math.pow(Math.max(0,.5-C),2),this.gridInner[m]=C===1?_t:C===0?0:Math.pow(Math.max(0,C-.5),2)}for(rr(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),rr(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),m=0;m<this.size*this.size;m++)l[m]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[m]-this.gridInner[m])/this.radius+this.cutoff))));return l},dt.default=ct;var Mr=function(f,l){this.requestManager=f,this.localIdeographFontFamily=l,this.entries={}};Mr.prototype.setURL=function(d){this.url=d},Mr.prototype.getGlyphs=function(d,f){var l=this,m=[];for(var C in d)for(var P=0,D=d[C];P<D.length;P+=1)m.push({stack:C,id:D[P]});h.asyncAll(m,function(N,K){var re=N.stack,ge=N.id,ye=l.entries[re];ye||(ye=l.entries[re]={glyphs:{},requests:{},ranges:{}});var we=ye.glyphs[ge];if(we===void 0){if(we=l._tinySDF(ye,re,ge))return ye.glyphs[ge]=we,void K(null,{stack:re,id:ge,glyph:we});var We=Math.floor(ge/256);if(256*We>65535)K(new Error("glyphs > 65535 not supported"));else if(ye.ranges[We])K(null,{stack:re,id:ge,glyph:we});else{var Ue=ye.requests[We];Ue||(Ue=ye.requests[We]=[],Mr.loadGlyphRange(re,We,l.url,l.requestManager,function(tt,Ze){if(Ze){for(var $e in Ze)l._doesCharSupportLocalGlyph(+$e)||(ye.glyphs[+$e]=Ze[+$e]);ye.ranges[We]=!0}for(var Ot=0,Mt=Ue;Ot<Mt.length;Ot+=1)(0,Mt[Ot])(tt,Ze);delete ye.requests[We]})),Ue.push(function(tt,Ze){tt?K(tt):Ze&&K(null,{stack:re,id:ge,glyph:Ze[ge]||null})})}}else K(null,{stack:re,id:ge,glyph:we})},function(N,K){if(N)f(N);else if(K){for(var re={},ge=0,ye=K;ge<ye.length;ge+=1){var we=ye[ge],We=we.stack,Ue=we.id,tt=we.glyph;(re[We]||(re[We]={}))[Ue]=tt&&{id:tt.id,bitmap:tt.bitmap.clone(),metrics:tt.metrics}}f(null,re)}})},Mr.prototype._doesCharSupportLocalGlyph=function(d){return!!this.localIdeographFontFamily&&(h.isChar["CJK Unified Ideographs"](d)||h.isChar["Hangul Syllables"](d)||h.isChar.Hiragana(d)||h.isChar.Katakana(d))},Mr.prototype._tinySDF=function(d,f,l){var m=this.localIdeographFontFamily;if(m&&this._doesCharSupportLocalGlyph(l)){var C=d.tinySDF;if(!C){var P="400";/bold/i.test(f)?P="900":/medium/i.test(f)?P="500":/light/i.test(f)&&(P="200"),C=d.tinySDF=new Mr.TinySDF(24,3,8,.25,m,P)}return{id:l,bitmap:new h.AlphaImage({width:30,height:30},C.draw(String.fromCharCode(l))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Mr.loadGlyphRange=function(d,f,l,m,C){var P=256*f,D=P+255,N=m.transformRequest(m.normalizeGlyphsURL(l).replace("{fontstack}",d).replace("{range}",P+"-"+D),h.ResourceType.Glyphs);h.getArrayBuffer(N,function(K,re){if(K)C(K);else if(re){for(var ge={},ye=0,we=h.parseGlyphPBF(re);ye<we.length;ye+=1){var We=we[ye];ge[We.id]=We}C(null,ge)}})},Mr.TinySDF=dt;var Nt=function(){this.specification=h.styleSpec.light.position};Nt.prototype.possiblyEvaluate=function(d,f){return h.sphericalToCartesian(d.expression.evaluate(f))},Nt.prototype.interpolate=function(d,f,l){return{x:h.number(d.x,f.x,l),y:h.number(d.y,f.y,l),z:h.number(d.z,f.z,l)}};var ze=new h.Properties({anchor:new h.DataConstantProperty(h.styleSpec.light.anchor),position:new Nt,color:new h.DataConstantProperty(h.styleSpec.light.color),intensity:new h.DataConstantProperty(h.styleSpec.light.intensity)}),zt=function(d){function f(l){d.call(this),this._transitionable=new h.Transitionable(ze),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getLight=function(){return this._transitionable.serialize()},f.prototype.setLight=function(l,m){if(m===void 0&&(m={}),!this._validate(h.validateLight,l,m))for(var C in l){var P=l[C];h.endsWith(C,"-transition")?this._transitionable.setTransition(C.slice(0,-"-transition".length),P):this._transitionable.setValue(C,P)}},f.prototype.updateTransitions=function(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)},f.prototype.hasTransition=function(){return this._transitioning.hasTransition()},f.prototype.recalculate=function(l){this.properties=this._transitioning.possiblyEvaluate(l)},f.prototype._validate=function(l,m,C){return(!C||C.validate!==!1)&&h.emitValidationErrors(this,l.call(h.validateStyle,h.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:h.styleSpec})))},f}(h.Evented),Kt=function(f,l){this.width=f,this.height=l,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Kt.prototype.getDash=function(d,f){var l=d.join(",")+String(f);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(d,f)),this.dashEntry[l]},Kt.prototype.getDashRanges=function(d,f,l){var m=[],C=d.length%2==1?-d[d.length-1]*l:0,P=d[0]*l,D=!0;m.push({left:C,right:P,isDash:D,zeroLength:d[0]===0});for(var N=d[0],K=1;K<d.length;K++){var re=d[K];m.push({left:C=N*l,right:P=(N+=re)*l,isDash:D=!D,zeroLength:re===0})}return m},Kt.prototype.addRoundDash=function(d,f,l){for(var m=f/2,C=-l;C<=l;C++)for(var P=this.width*(this.nextRow+l+C),D=0,N=d[D],K=0;K<this.width;K++){K/N.right>1&&(N=d[++D]);var re=Math.abs(K-N.left),ge=Math.abs(K-N.right),ye=Math.min(re,ge),we=void 0,We=C/l*(m+1);if(N.isDash){var Ue=m-Math.abs(We);we=Math.sqrt(ye*ye+Ue*Ue)}else we=m-Math.sqrt(ye*ye+We*We);this.data[P+K]=Math.max(0,Math.min(255,we+128))}},Kt.prototype.addRegularDash=function(d){for(var f=d.length-1;f>=0;--f){var l=d[f],m=d[f+1];l.zeroLength?d.splice(f,1):m&&m.isDash===l.isDash&&(m.left=l.left,d.splice(f,1))}var C=d[0],P=d[d.length-1];C.isDash===P.isDash&&(C.left=P.left-this.width,P.right=C.right+this.width);for(var D=this.width*this.nextRow,N=0,K=d[N],re=0;re<this.width;re++){re/K.right>1&&(K=d[++N]);var ge=Math.abs(re-K.left),ye=Math.abs(re-K.right),we=Math.min(ge,ye);this.data[D+re]=Math.max(0,Math.min(255,(K.isDash?we:-we)+128))}},Kt.prototype.addDash=function(d,f){var l=f?7:0,m=2*l+1;if(this.nextRow+m>this.height)return h.warnOnce("LineAtlas out of space"),null;for(var C=0,P=0;P<d.length;P++)C+=d[P];if(C!==0){var D=this.width/C,N=this.getDashRanges(d,this.width,D);f?this.addRoundDash(N,D,l):this.addRegularDash(N)}var K={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:C};return this.nextRow+=m,this.dirty=!0,K},Kt.prototype.bind=function(d){var f=d.gl;this.texture?(f.bindTexture(f.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,f.texSubImage2D(f.TEXTURE_2D,0,0,0,this.width,this.height,f.ALPHA,f.UNSIGNED_BYTE,this.data))):(this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.ALPHA,this.width,this.height,0,f.ALPHA,f.UNSIGNED_BYTE,this.data))};var vr=function d(f,l){this.workerPool=f,this.actors=[],this.currentActor=0,this.id=h.uniqueId();for(var m=this.workerPool.acquire(this.id),C=0;C<m.length;C++){var P=new d.Actor(m[C],l,this.id);P.name="Worker "+C,this.actors.push(P)}};function jr(d,f,l){var m=function(P,D){if(P)return l(P);if(D){var N=h.pick(h.extend(D,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(N.vectorLayers=D.vector_layers,N.vectorLayerIds=N.vectorLayers.map(function(K){return K.id})),N.tiles=f.canonicalizeTileset(N,d.url),l(null,N)}};return d.url?h.getJSON(f.transformRequest(f.normalizeSourceURL(d.url),h.ResourceType.Source),m):h.browser.frame(function(){return m(null,d)})}vr.prototype.broadcast=function(d,f,l){h.asyncAll(this.actors,function(m,C){m.send(d,f,C)},l=l||function(){})},vr.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},vr.prototype.remove=function(){this.actors.forEach(function(d){d.remove()}),this.actors=[],this.workerPool.release(this.id)},vr.Actor=h.Actor;var vn=function(f,l,m){this.bounds=h.LngLatBounds.convert(this.validateBounds(f)),this.minzoom=l||0,this.maxzoom=m||24};vn.prototype.validateBounds=function(d){return Array.isArray(d)&&d.length===4?[Math.max(-180,d[0]),Math.max(-90,d[1]),Math.min(180,d[2]),Math.min(90,d[3])]:[-180,-90,180,90]},vn.prototype.contains=function(d){var f=Math.pow(2,d.z),l=Math.floor(h.mercatorXfromLng(this.bounds.getWest())*f),m=Math.floor(h.mercatorYfromLat(this.bounds.getNorth())*f),C=Math.ceil(h.mercatorXfromLng(this.bounds.getEast())*f),P=Math.ceil(h.mercatorYfromLat(this.bounds.getSouth())*f);return d.x>=l&&d.x<C&&d.y>=m&&d.y<P};var kr=function(d){function f(l,m,C,P){if(d.call(this),this.id=l,this.dispatcher=C,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.extend(this,h.pick(m,["url","scheme","tileSize","promoteId"])),this._options=h.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(P)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.load=function(){var l=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=jr(this._options,this.map._requestManager,function(m,C){l._tileJSONRequest=null,l._loaded=!0,m?l.fire(new h.ErrorEvent(m)):C&&(h.extend(l,C),C.bounds&&(l.tileBounds=new vn(C.bounds,l.minzoom,l.maxzoom)),h.postTurnstileEvent(C.tiles,l.map._requestManager._customAccessToken),h.postMapLoadEvent(C.tiles,l.map._getMapId(),l.map._requestManager._skuToken,l.map._requestManager._customAccessToken),l.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),l.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.hasTile=function(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)},f.prototype.onAdd=function(l){this.map=l,this.load()},f.prototype.setSourceProperty=function(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},f.prototype.setTiles=function(l){var m=this;return this.setSourceProperty(function(){m._options.tiles=l}),this},f.prototype.setUrl=function(l){var m=this;return this.setSourceProperty(function(){m.url=l,m._options.url=l}),this},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return h.extend({},this._options)},f.prototype.loadTile=function(l,m){var C=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),P={request:this.map._requestManager.transformRequest(C,h.ResourceType.Tile),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:h.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function D(N,K){return delete l.request,l.aborted?m(null):N&&N.status!==404?m(N):(K&&K.resourceTiming&&(l.resourceTiming=K.resourceTiming),this.map._refreshExpiredTiles&&K&&l.setExpiryData(K),l.loadVectorData(K,this.map.painter),h.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}P.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired"?l.state==="loading"?l.reloadCallback=m:l.request=l.actor.send("reloadTile",P,D.bind(this)):(l.actor=this.dispatcher.getActor(),l.request=l.actor.send("loadTile",P,D.bind(this)))},f.prototype.abortTile=function(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id},void 0)},f.prototype.unloadTile=function(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id},void 0)},f.prototype.hasTransition=function(){return!1},f}(h.Evented),be=function(d){function f(l,m,C,P){d.call(this),this.id=l,this.dispatcher=C,this.setEventedParent(P),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.extend({type:"raster"},m),h.extend(this,h.pick(m,["url","scheme","tileSize"]))}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.load=function(){var l=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=jr(this._options,this.map._requestManager,function(m,C){l._tileJSONRequest=null,l._loaded=!0,m?l.fire(new h.ErrorEvent(m)):C&&(h.extend(l,C),C.bounds&&(l.tileBounds=new vn(C.bounds,l.minzoom,l.maxzoom)),h.postTurnstileEvent(C.tiles),h.postMapLoadEvent(C.tiles,l.map._getMapId(),l.map._requestManager._skuToken),l.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),l.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.onAdd=function(l){this.map=l,this.load()},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return h.extend({},this._options)},f.prototype.hasTile=function(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)},f.prototype.loadTile=function(l,m){var C=this,P=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);l.request=h.getImage(this.map._requestManager.transformRequest(P,h.ResourceType.Tile),function(D,N){if(delete l.request,l.aborted)l.state="unloaded",m(null);else if(D)l.state="errored",m(D);else if(N){C.map._refreshExpiredTiles&&l.setExpiryData(N),delete N.cacheControl,delete N.expires;var K=C.map.painter.context,re=K.gl;l.texture=C.map.painter.getTileTexture(N.width),l.texture?l.texture.update(N,{useMipmap:!0}):(l.texture=new h.Texture(K,N,re.RGBA,{useMipmap:!0}),l.texture.bind(re.LINEAR,re.CLAMP_TO_EDGE,re.LINEAR_MIPMAP_NEAREST),K.extTextureFilterAnisotropic&&re.texParameterf(re.TEXTURE_2D,K.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,K.extTextureFilterAnisotropicMax)),l.state="loaded",h.cacheEntryPossiblyAdded(C.dispatcher),m(null)}})},f.prototype.abortTile=function(l,m){l.request&&(l.request.cancel(),delete l.request),m()},f.prototype.unloadTile=function(l,m){l.texture&&this.map.painter.saveTileTexture(l.texture),m()},f.prototype.hasTransition=function(){return!1},f}(h.Evented),Ne=function(d){function f(l,m,C,P){d.call(this,l,m,C,P),this.type="raster-dem",this.maxzoom=22,this._options=h.extend({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox"}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},f.prototype.loadTile=function(l,m){var C=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function P(D,N){D&&(l.state="errored",m(D)),N&&(l.dem=N,l.needsHillshadePrepare=!0,l.state="loaded",m(null))}l.request=h.getImage(this.map._requestManager.transformRequest(C,h.ResourceType.Tile),function(D,N){if(delete l.request,l.aborted)l.state="unloaded",m(null);else if(D)l.state="errored",m(D);else if(N){this.map._refreshExpiredTiles&&l.setExpiryData(N),delete N.cacheControl,delete N.expires;var K=h.window.ImageBitmap&&N instanceof h.window.ImageBitmap&&h.offscreenCanvasSupported()?N:h.browser.getImageData(N,1),re={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:K,encoding:this.encoding};l.actor&&l.state!=="expired"||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",re,P.bind(this)))}}.bind(this)),l.neighboringTiles=this._getNeighboringTiles(l.tileID)},f.prototype._getNeighboringTiles=function(l){var m=l.canonical,C=Math.pow(2,m.z),P=(m.x-1+C)%C,D=m.x===0?l.wrap-1:l.wrap,N=(m.x+1+C)%C,K=m.x+1===C?l.wrap+1:l.wrap,re={};return re[new h.OverscaledTileID(l.overscaledZ,D,m.z,P,m.y).key]={backfilled:!1},re[new h.OverscaledTileID(l.overscaledZ,K,m.z,N,m.y).key]={backfilled:!1},m.y>0&&(re[new h.OverscaledTileID(l.overscaledZ,D,m.z,P,m.y-1).key]={backfilled:!1},re[new h.OverscaledTileID(l.overscaledZ,l.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},re[new h.OverscaledTileID(l.overscaledZ,K,m.z,N,m.y-1).key]={backfilled:!1}),m.y+1<C&&(re[new h.OverscaledTileID(l.overscaledZ,D,m.z,P,m.y+1).key]={backfilled:!1},re[new h.OverscaledTileID(l.overscaledZ,l.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},re[new h.OverscaledTileID(l.overscaledZ,K,m.z,N,m.y+1).key]={backfilled:!1}),re},f.prototype.unloadTile=function(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&l.actor.send("removeDEMTile",{uid:l.uid,source:this.id})},f}(be),Ie=function(d){function f(l,m,C,P){d.call(this),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=C.getActor(),this.setEventedParent(P),this._data=m.data,this._options=h.extend({},m),this._collectResourceTiming=m.collectResourceTiming,this._resourceTiming=[],m.maxzoom!==void 0&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId;var D=h.EXTENT/this.tileSize;this.workerOptions=h.extend({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:(m.buffer!==void 0?m.buffer:128)*D,tolerance:(m.tolerance!==void 0?m.tolerance:.375)*D,extent:h.EXTENT,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:m.clusterMaxZoom!==void 0?Math.min(m.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,m.clusterMinPoints||2),extent:h.EXTENT,radius:(m.clusterRadius||50)*D,log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.load=function(){var l=this;this.fire(new h.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(m){if(m)l.fire(new h.ErrorEvent(m));else{var C={dataType:"source",sourceDataType:"metadata"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(C.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new h.Event("data",C))}})},f.prototype.onAdd=function(l){this.map=l,this.load()},f.prototype.setData=function(l){var m=this;return this._data=l,this.fire(new h.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(C){if(C)m.fire(new h.ErrorEvent(C));else{var P={dataType:"source",sourceDataType:"content"};m._collectResourceTiming&&m._resourceTiming&&m._resourceTiming.length>0&&(P.resourceTiming=m._resourceTiming,m._resourceTiming=[]),m.fire(new h.Event("data",P))}}),this},f.prototype.getClusterExpansionZoom=function(l,m){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},m),this},f.prototype.getClusterChildren=function(l,m){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},m),this},f.prototype.getClusterLeaves=function(l,m,C,P){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:m,offset:C},P),this},f.prototype._updateWorkerData=function(l){var m=this;this._loaded=!1;var C=h.extend({},this.workerOptions),P=this._data;typeof P=="string"?(C.request=this.map._requestManager.transformRequest(h.browser.resolveURL(P),h.ResourceType.Source),C.request.collectResourceTiming=this._collectResourceTiming):C.data=JSON.stringify(P),this.actor.send(this.type+".loadData",C,function(D,N){m._removed||N&&N.abandoned||(m._loaded=!0,N&&N.resourceTiming&&N.resourceTiming[m.id]&&(m._resourceTiming=N.resourceTiming[m.id].slice(0)),m.actor.send(m.type+".coalesce",{source:C.source},null),l(D))})},f.prototype.loaded=function(){return this._loaded},f.prototype.loadTile=function(l,m){var C=this,P=l.actor?"reloadTile":"loadTile";l.actor=this.actor,l.request=this.actor.send(P,{type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:h.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(D,N){return delete l.request,l.unloadVectorData(),l.aborted?m(null):D?m(D):(l.loadVectorData(N,C.map.painter,P==="reloadTile"),m(null))})},f.prototype.abortTile=function(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0},f.prototype.unloadTile=function(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})},f.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},f.prototype.serialize=function(){return h.extend({},this._options,{type:this.type,data:this._data})},f.prototype.hasTransition=function(){return!1},f}(h.Evented),pt=h.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),mt=function(d){function f(l,m,C,P){d.call(this),this.id=l,this.dispatcher=C,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(P),this.options=m}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.load=function(l,m){var C=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this.url=this.options.url,h.getImage(this.map._requestManager.transformRequest(this.url,h.ResourceType.Image),function(P,D){C._loaded=!0,P?C.fire(new h.ErrorEvent(P)):D&&(C.image=D,l&&(C.coordinates=l),m&&m(),C._finishLoading())})},f.prototype.loaded=function(){return this._loaded},f.prototype.updateImage=function(l){var m=this;return this.image&&l.url?(this.options.url=l.url,this.load(l.coordinates,function(){m.texture=null}),this):this},f.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})))},f.prototype.onAdd=function(l){this.map=l,this.load()},f.prototype.setCoordinates=function(l){var m=this;this.coordinates=l;var C=l.map(h.MercatorCoordinate.fromLngLat);this.tileID=function(D){for(var N=1/0,K=1/0,re=-1/0,ge=-1/0,ye=0,we=D;ye<we.length;ye+=1){var We=we[ye];N=Math.min(N,We.x),K=Math.min(K,We.y),re=Math.max(re,We.x),ge=Math.max(ge,We.y)}var Ue=Math.max(re-N,ge-K),tt=Math.max(0,Math.floor(-Math.log(Ue)/Math.LN2)),Ze=Math.pow(2,tt);return new h.CanonicalTileID(tt,Math.floor((N+re)/2*Ze),Math.floor((K+ge)/2*Ze))}(C),this.minzoom=this.maxzoom=this.tileID.z;var P=C.map(function(D){return m.tileID.getTilePoint(D)._round()});return this._boundsArray=new h.StructArrayLayout4i8,this._boundsArray.emplaceBack(P[0].x,P[0].y,0,0),this._boundsArray.emplaceBack(P[1].x,P[1].y,h.EXTENT,0),this._boundsArray.emplaceBack(P[3].x,P[3].y,0,h.EXTENT),this._boundsArray.emplaceBack(P[2].x,P[2].y,h.EXTENT,h.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})),this},f.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var l=this.map.painter.context,m=l.gl;for(var C in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,pt.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new h.Texture(l,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this.tiles){var P=this.tiles[C];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture)}}},f.prototype.loadTile=function(l,m){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},m(null)):(l.state="errored",m(null))},f.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return!1},f}(h.Evented),Dt=function(d){function f(l,m,C,P){d.call(this,l,m,C,P),this.roundZoom=!0,this.type="video",this.options=m}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.load=function(){var l=this;this._loaded=!1;var m=this.options;this.urls=[];for(var C=0,P=m.urls;C<P.length;C+=1)this.urls.push(this.map._requestManager.transformRequest(P[C],h.ResourceType.Source).url);h.getVideo(this.urls,function(D,N){l._loaded=!0,D?l.fire(new h.ErrorEvent(D)):N&&(l.video=N,l.video.loop=!0,l.video.addEventListener("playing",function(){l.map.triggerRepaint()}),l.map&&l.video.play(),l._finishLoading())})},f.prototype.pause=function(){this.video&&this.video.pause()},f.prototype.play=function(){this.video&&this.video.play()},f.prototype.seek=function(l){if(this.video){var m=this.video.seekable;l<m.start(0)||l>m.end(0)?this.fire(new h.ErrorEvent(new h.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+m.start(0)+" and "+m.end(0)+"-second mark."))):this.video.currentTime=l}},f.prototype.getVideo=function(){return this.video},f.prototype.onAdd=function(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},f.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var l=this.map.painter.context,m=l.gl;for(var C in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,pt.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.texSubImage2D(m.TEXTURE_2D,0,0,0,m.RGBA,m.UNSIGNED_BYTE,this.video)):(this.texture=new h.Texture(l,this.video,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this.tiles){var P=this.tiles[C];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this.video&&!this.video.paused},f}(mt),w=function(d){function f(l,m,C,P){d.call(this,l,m,C,P),m.coordinates?Array.isArray(m.coordinates)&&m.coordinates.length===4&&!m.coordinates.some(function(D){return!Array.isArray(D)||D.length!==2||D.some(function(N){return typeof N!="number"})})||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+l,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+l,null,'missing required property "coordinates"'))),m.animate&&typeof m.animate!="boolean"&&this.fire(new h.ErrorEvent(new h.ValidationError("sources."+l,null,'optional "animate" property must be a boolean value'))),m.canvas?typeof m.canvas=="string"||m.canvas instanceof h.window.HTMLCanvasElement||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+l,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+l,null,'missing required property "canvas"'))),this.options=m,this.animate=m.animate===void 0||m.animate}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof h.window.HTMLCanvasElement?this.options.canvas:h.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},f.prototype.getCanvas=function(){return this.canvas},f.prototype.onAdd=function(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()},f.prototype.onRemove=function(){this.pause()},f.prototype.prepare=function(){var l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var m=this.map.painter.context,C=m.gl;for(var P in this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,pt.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new h.Texture(m,this.canvas,C.RGBA,{premultiply:!0}),this.tiles){var D=this.tiles[P];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this._playing},f.prototype._hasInvalidDimensions=function(){for(var l=0,m=[this.canvas.width,this.canvas.height];l<m.length;l+=1){var C=m[l];if(isNaN(C)||C<=0)return!0}return!1},f}(mt),br={vector:kr,raster:be,"raster-dem":Ne,geojson:Ie,video:Dt,image:mt,canvas:w};function Ut(d,f){var l=h.identity([]);return h.translate(l,l,[1,1,0]),h.scale(l,l,[.5*d.width,.5*d.height,1]),h.multiply(l,l,d.calculatePosMatrix(f.toUnwrapped()))}function Xt(d,f,l,m,C,P){var D=function(tt,Ze,$e){if(tt)for(var Ot=0,Mt=tt;Ot<Mt.length;Ot+=1){var Sr=Ze[Mt[Ot]];if(Sr&&Sr.source===$e&&Sr.type==="fill-extrusion")return!0}else for(var qt in Ze){var gr=Ze[qt];if(gr.source===$e&&gr.type==="fill-extrusion")return!0}return!1}(C&&C.layers,f,d.id),N=P.maxPitchScaleFactor(),K=d.tilesIn(m,N,D);K.sort(It);for(var re=[],ge=0,ye=K;ge<ye.length;ge+=1){var we=ye[ge];re.push({wrappedTileID:we.tileID.wrapped().key,queryResults:we.tile.queryRenderedFeatures(f,l,d._state,we.queryGeometry,we.cameraQueryGeometry,we.scale,C,P,N,Ut(d.transform,we.tileID))})}var We=function(tt){for(var Ze={},$e={},Ot=0,Mt=tt;Ot<Mt.length;Ot+=1){var Sr=Mt[Ot],qt=Sr.queryResults,gr=Sr.wrappedTileID,Tr=$e[gr]=$e[gr]||{};for(var Dr in qt)for(var nn=qt[Dr],An=Tr[Dr]=Tr[Dr]||{},Vn=Ze[Dr]=Ze[Dr]||[],mi=0,yi=nn;mi<yi.length;mi+=1){var Ni=yi[mi];An[Ni.featureIndex]||(An[Ni.featureIndex]=!0,Vn.push(Ni))}}return Ze}(re);for(var Ue in We)We[Ue].forEach(function(tt){var Ze=tt.feature,$e=d.getFeatureState(Ze.layer["source-layer"],Ze.id);Ze.source=Ze.layer.source,Ze.layer["source-layer"]&&(Ze.sourceLayer=Ze.layer["source-layer"]),Ze.state=$e});return We}function It(d,f){var l=d.tileID,m=f.tileID;return l.overscaledZ-m.overscaledZ||l.canonical.y-m.canonical.y||l.wrap-m.wrap||l.canonical.x-m.canonical.x}var Lt=function(f,l){this.max=f,this.onRemove=l,this.reset()};Lt.prototype.reset=function(){for(var d in this.data)for(var f=0,l=this.data[d];f<l.length;f+=1){var m=l[f];m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value)}return this.data={},this.order=[],this},Lt.prototype.add=function(d,f,l){var m=this,C=d.wrapped().key;this.data[C]===void 0&&(this.data[C]=[]);var P={value:f,timeout:void 0};if(l!==void 0&&(P.timeout=setTimeout(function(){m.remove(d,P)},l)),this.data[C].push(P),this.order.push(C),this.order.length>this.max){var D=this._getAndRemoveByKey(this.order[0]);D&&this.onRemove(D)}return this},Lt.prototype.has=function(d){return d.wrapped().key in this.data},Lt.prototype.getAndRemove=function(d){return this.has(d)?this._getAndRemoveByKey(d.wrapped().key):null},Lt.prototype._getAndRemoveByKey=function(d){var f=this.data[d].shift();return f.timeout&&clearTimeout(f.timeout),this.data[d].length===0&&delete this.data[d],this.order.splice(this.order.indexOf(d),1),f.value},Lt.prototype.getByKey=function(d){var f=this.data[d];return f?f[0].value:null},Lt.prototype.get=function(d){return this.has(d)?this.data[d.wrapped().key][0].value:null},Lt.prototype.remove=function(d,f){if(!this.has(d))return this;var l=d.wrapped().key,m=f===void 0?0:this.data[l].indexOf(f),C=this.data[l][m];return this.data[l].splice(m,1),C.timeout&&clearTimeout(C.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(C.value),this.order.splice(this.order.indexOf(l),1),this},Lt.prototype.setMaxSize=function(d){for(this.max=d;this.order.length>this.max;){var f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this},Lt.prototype.filter=function(d){var f=[];for(var l in this.data)for(var m=0,C=this.data[l];m<C.length;m+=1){var P=C[m];d(P.value)||f.push(P)}for(var D=0,N=f;D<N.length;D+=1){var K=N[D];this.remove(K.value.tileID,K)}};var ir=function(f,l,m){this.context=f;var C=f.gl;this.buffer=C.createBuffer(),this.dynamicDraw=Boolean(m),this.context.unbindVAO(),f.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer};ir.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},ir.prototype.updateData=function(d){var f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)},ir.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Ar={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},nr=function(f,l,m,C){this.length=l.length,this.attributes=m,this.itemSize=l.bytesPerElement,this.dynamicDraw=C,this.context=f;var P=f.gl;this.buffer=P.createBuffer(),f.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer};nr.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},nr.prototype.updateData=function(d){var f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,d.arrayBuffer)},nr.prototype.enableAttributes=function(d,f){for(var l=0;l<this.attributes.length;l++){var m=f.attributes[this.attributes[l].name];m!==void 0&&d.enableVertexAttribArray(m)}},nr.prototype.setVertexAttribPointers=function(d,f,l){for(var m=0;m<this.attributes.length;m++){var C=this.attributes[m],P=f.attributes[C.name];P!==void 0&&d.vertexAttribPointer(P,C.components,d[Ar[C.type]],!1,this.itemSize,C.offset+this.itemSize*(l||0))}},nr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Pr=function(f){this.gl=f.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Pr.prototype.get=function(){return this.current},Pr.prototype.set=function(d){},Pr.prototype.getDefault=function(){return this.default},Pr.prototype.setDefault=function(){this.set(this.default)};var $r=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return h.Color.transparent},f.prototype.set=function(l){var m=this.current;(l.r!==m.r||l.g!==m.g||l.b!==m.b||l.a!==m.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)},f}(Pr),Or=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return 1},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)},f}(Pr),_r=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return 0},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)},f}(Pr),Br=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return[!0,!0,!0,!0]},f.prototype.set=function(l){var m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||l[3]!==m[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)},f}(Pr),Jn=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!0},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)},f}(Pr),mn=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return 255},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)},f}(Pr),wn=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},f.prototype.set=function(l){var m=this.current;(l.func!==m.func||l.ref!==m.ref||l.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)},f}(Pr),pi=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){var l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]},f.prototype.set=function(l){var m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)},f}(Pr),Ci=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(l){if(l!==this.current||this.dirty){var m=this.gl;l?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=l,this.dirty=!1}},f}(Pr),fa=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return[0,1]},f.prototype.set=function(l){var m=this.current;(l[0]!==m[0]||l[1]!==m[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)},f}(Pr),_e=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(l){if(l!==this.current||this.dirty){var m=this.gl;l?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=l,this.dirty=!1}},f}(Pr),Pn=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.LESS},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)},f}(Pr),oa=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(l){if(l!==this.current||this.dirty){var m=this.gl;l?m.enable(m.BLEND):m.disable(m.BLEND),this.current=l,this.dirty=!1}},f}(Pr),ws=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){var l=this.gl;return[l.ONE,l.ZERO]},f.prototype.set=function(l){var m=this.current;(l[0]!==m[0]||l[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)},f}(Pr),ys=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return h.Color.transparent},f.prototype.set=function(l){var m=this.current;(l.r!==m.r||l.g!==m.g||l.b!==m.b||l.a!==m.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)},f}(Pr),Jt=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.FUNC_ADD},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)},f}(Pr),Ir=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(l){if(l!==this.current||this.dirty){var m=this.gl;l?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=l,this.dirty=!1}},f}(Pr),en=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.BACK},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)},f}(Pr),On=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.CCW},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)},f}(Pr),ln=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)},f}(Pr),Ka=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.TEXTURE0},f.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)},f}(Pr),wi=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){var l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]},f.prototype.set=function(l){var m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||l[3]!==m[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)},f}(Pr),fi=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){if(l!==this.current||this.dirty){var m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,l),this.current=l,this.dirty=!1}},f}(Pr),Ti=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){if(l!==this.current||this.dirty){var m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,l),this.current=l,this.dirty=!1}},f}(Pr),da=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){if(l!==this.current||this.dirty){var m=this.gl;m.bindTexture(m.TEXTURE_2D,l),this.current=l,this.dirty=!1}},f}(Pr),ya=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){if(l!==this.current||this.dirty){var m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}},f}(Pr),_s=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){var m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1},f}(Pr),xo=function(d){function f(l){d.call(this,l),this.vao=l.extVertexArrayObject}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)},f}(Pr),$a=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return 4},f.prototype.set=function(l){if(l!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}},f}(Pr),Vu=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(l){if(l!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}},f}(Pr),ec=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(l){if(l!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}},f}(Pr),wo=function(d){function f(l,m){d.call(this,l),this.context=l,this.parent=m}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f}(Pr),oe=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.setDirty=function(){this.dirty=!0},f.prototype.set=function(l){if(l!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}},f}(wo),ie=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.set=function(l){if(l!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,l),this.current=l,this.dirty=!1}},f}(wo),xe=function(f,l,m,C){this.context=f,this.width=l,this.height=m;var P=this.framebuffer=f.gl.createFramebuffer();this.colorAttachment=new oe(f,P),C&&(this.depthAttachment=new ie(f,P))};xe.prototype.destroy=function(){var d=this.context.gl,f=this.colorAttachment.get();if(f&&d.deleteTexture(f),this.depthAttachment){var l=this.depthAttachment.get();l&&d.deleteRenderbuffer(l)}d.deleteFramebuffer(this.framebuffer)};var Me=function(f,l,m){this.func=f,this.mask=l,this.range=m};Me.ReadOnly=!1,Me.ReadWrite=!0,Me.disabled=new Me(519,Me.ReadOnly,[0,1]);var Ve=function(f,l,m,C,P,D){this.test=f,this.ref=l,this.mask=m,this.fail=C,this.depthFail=P,this.pass=D};Ve.disabled=new Ve({func:519,mask:0},0,0,7680,7680,7680);var ft=function(f,l,m){this.blendFunction=f,this.blendColor=l,this.mask=m};ft.disabled=new ft(ft.Replace=[1,0],h.Color.transparent,[!1,!1,!1,!1]),ft.unblended=new ft(ft.Replace,h.Color.transparent,[!0,!0,!0,!0]),ft.alphaBlended=new ft([1,771],h.Color.transparent,[!0,!0,!0,!0]);var Ct=function(f,l,m){this.enable=f,this.mode=l,this.frontFace=m};Ct.disabled=new Ct(!1,1029,2305),Ct.backCCW=new Ct(!0,1029,2305);var Ce=function(f){this.gl=f,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new $r(this),this.clearDepth=new Or(this),this.clearStencil=new _r(this),this.colorMask=new Br(this),this.depthMask=new Jn(this),this.stencilMask=new mn(this),this.stencilFunc=new wn(this),this.stencilOp=new pi(this),this.stencilTest=new Ci(this),this.depthRange=new fa(this),this.depthTest=new _e(this),this.depthFunc=new Pn(this),this.blend=new oa(this),this.blendFunc=new ws(this),this.blendColor=new ys(this),this.blendEquation=new Jt(this),this.cullFace=new Ir(this),this.cullFaceSide=new en(this),this.frontFace=new On(this),this.program=new ln(this),this.activeTexture=new Ka(this),this.viewport=new wi(this),this.bindFramebuffer=new fi(this),this.bindRenderbuffer=new Ti(this),this.bindTexture=new da(this),this.bindVertexBuffer=new ya(this),this.bindElementBuffer=new _s(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new xo(this),this.pixelStoreUnpack=new $a(this),this.pixelStoreUnpackPremultiplyAlpha=new Vu(this),this.pixelStoreUnpackFlipY=new ec(this),this.extTextureFilterAnisotropic=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("MOZ_EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=f.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=f.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(f.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=f.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=f.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=f.getParameter(f.MAX_TEXTURE_SIZE)};Ce.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ce.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ce.prototype.createIndexBuffer=function(d,f){return new ir(this,d,f)},Ce.prototype.createVertexBuffer=function(d,f,l){return new nr(this,d,f,l)},Ce.prototype.createRenderbuffer=function(d,f,l){var m=this.gl,C=m.createRenderbuffer();return this.bindRenderbuffer.set(C),m.renderbufferStorage(m.RENDERBUFFER,d,f,l),this.bindRenderbuffer.set(null),C},Ce.prototype.createFramebuffer=function(d,f,l){return new xe(this,d,f,l)},Ce.prototype.clear=function(d){var f=d.color,l=d.depth,m=this.gl,C=0;f&&(C|=m.COLOR_BUFFER_BIT,this.clearColor.set(f),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(C|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),m.clear(C)},Ce.prototype.setCullFace=function(d){d.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(d.mode),this.frontFace.set(d.frontFace))},Ce.prototype.setDepthMode=function(d){d.func!==this.gl.ALWAYS||d.mask?(this.depthTest.set(!0),this.depthFunc.set(d.func),this.depthMask.set(d.mask),this.depthRange.set(d.range)):this.depthTest.set(!1)},Ce.prototype.setStencilMode=function(d){d.test.func!==this.gl.ALWAYS||d.mask?(this.stencilTest.set(!0),this.stencilMask.set(d.mask),this.stencilOp.set([d.fail,d.depthFail,d.pass]),this.stencilFunc.set({func:d.test.func,ref:d.ref,mask:d.test.mask})):this.stencilTest.set(!1)},Ce.prototype.setColorMode=function(d){h.deepEqual(d.blendFunction,ft.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(d.blendFunction),this.blendColor.set(d.blendColor)),this.colorMask.set(d.mask)},Ce.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ye=function(d){function f(l,m,C){var P=this;d.call(this),this.id=l,this.dispatcher=C,this.on("data",function(D){D.dataType==="source"&&D.sourceDataType==="metadata"&&(P._sourceLoaded=!0),P._sourceLoaded&&!P._paused&&D.dataType==="source"&&D.sourceDataType==="content"&&(P.reload(),P.transform&&P.update(P.transform))}),this.on("error",function(){P._sourceErrored=!0}),this._source=function(D,N,K,re){var ge=new br[N.type](D,N,K,re);if(ge.id!==D)throw new Error("Expected Source id to be "+D+" instead of "+ge.id);return h.bindAll(["load","abort","unload","serialize","prepare"],ge),ge}(l,m,C,this),this._tiles={},this._cache=new Lt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new h.SourceFeatureState}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.onAdd=function(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(l)},f.prototype.onRemove=function(l){this._source&&this._source.onRemove&&this._source.onRemove(l)},f.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var l in this._tiles){var m=this._tiles[l];if(m.state!=="loaded"&&m.state!=="errored")return!1}return!0},f.prototype.getSource=function(){return this._source},f.prototype.pause=function(){this._paused=!0},f.prototype.resume=function(){if(this._paused){var l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform)}},f.prototype._loadTile=function(l,m){return this._source.loadTile(l,m)},f.prototype._unloadTile=function(l){if(this._source.unloadTile)return this._source.unloadTile(l,function(){})},f.prototype._abortTile=function(l){if(this._source.abortTile)return this._source.abortTile(l,function(){})},f.prototype.serialize=function(){return this._source.serialize()},f.prototype.prepare=function(l){for(var m in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var C=this._tiles[m];C.upload(l),C.prepare(this.map.style.imageManager)}},f.prototype.getIds=function(){return h.values(this._tiles).map(function(l){return l.tileID}).sort(nt).map(function(l){return l.key})},f.prototype.getRenderableIds=function(l){var m=this,C=[];for(var P in this._tiles)this._isIdRenderable(P,l)&&C.push(this._tiles[P]);return l?C.sort(function(D,N){var K=D.tileID,re=N.tileID,ge=new h.Point(K.canonical.x,K.canonical.y)._rotate(m.transform.angle),ye=new h.Point(re.canonical.x,re.canonical.y)._rotate(m.transform.angle);return K.overscaledZ-re.overscaledZ||ye.y-ge.y||ye.x-ge.x}).map(function(D){return D.tileID.key}):C.map(function(D){return D.tileID}).sort(nt).map(function(D){return D.key})},f.prototype.hasRenderableParent=function(l){var m=this.findLoadedParent(l,0);return!!m&&this._isIdRenderable(m.tileID.key)},f.prototype._isIdRenderable=function(l,m){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(m||!this._tiles[l].holdingForFade())},f.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var l in this._cache.reset(),this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")},f.prototype._reloadTile=function(l,m){var C=this._tiles[l];C&&(C.state!=="loading"&&(C.state=m),this._loadTile(C,this._tileLoaded.bind(this,C,l,m)))},f.prototype._tileLoaded=function(l,m,C,P){if(P)return l.state="errored",void(P.status!==404?this._source.fire(new h.ErrorEvent(P,{tile:l})):this.update(this.transform));l.timeAdded=h.browser.now(),C==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(m,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),this._source.fire(new h.Event("data",{dataType:"source",tile:l,coord:l.tileID}))},f.prototype._backfillDEM=function(l){for(var m=this.getRenderableIds(),C=0;C<m.length;C++){var P=m[C];if(l.neighboringTiles&&l.neighboringTiles[P]){var D=this.getTileByID(P);N(l,D),N(D,l)}}function N(K,re){K.needsHillshadePrepare=!0;var ge=re.tileID.canonical.x-K.tileID.canonical.x,ye=re.tileID.canonical.y-K.tileID.canonical.y,we=Math.pow(2,K.tileID.canonical.z),We=re.tileID.key;ge===0&&ye===0||Math.abs(ye)>1||(Math.abs(ge)>1&&(Math.abs(ge+we)===1?ge+=we:Math.abs(ge-we)===1&&(ge-=we)),re.dem&&K.dem&&(K.dem.backfillBorder(re.dem,ge,ye),K.neighboringTiles&&K.neighboringTiles[We]&&(K.neighboringTiles[We].backfilled=!0)))}},f.prototype.getTile=function(l){return this.getTileByID(l.key)},f.prototype.getTileByID=function(l){return this._tiles[l]},f.prototype._retainLoadedChildren=function(l,m,C,P){for(var D in this._tiles){var N=this._tiles[D];if(!(P[D]||!N.hasData()||N.tileID.overscaledZ<=m||N.tileID.overscaledZ>C)){for(var K=N.tileID;N&&N.tileID.overscaledZ>m+1;){var re=N.tileID.scaledTo(N.tileID.overscaledZ-1);(N=this._tiles[re.key])&&N.hasData()&&(K=re)}for(var ge=K;ge.overscaledZ>m;)if(l[(ge=ge.scaledTo(ge.overscaledZ-1)).key]){P[K.key]=K;break}}}},f.prototype.findLoadedParent=function(l,m){if(l.key in this._loadedParentTiles){var C=this._loadedParentTiles[l.key];return C&&C.tileID.overscaledZ>=m?C:null}for(var P=l.overscaledZ-1;P>=m;P--){var D=l.scaledTo(P),N=this._getLoadedTile(D);if(N)return N}},f.prototype._getLoadedTile=function(l){var m=this._tiles[l.key];return m&&m.hasData()?m:this._cache.getByKey(l.wrapped().key)},f.prototype.updateCacheSize=function(l){var m=Math.ceil(l.width/this._source.tileSize)+1,C=Math.ceil(l.height/this._source.tileSize)+1,P=Math.floor(m*C*5),D=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,P):P;this._cache.setMaxSize(D)},f.prototype.handleWrapJump=function(l){var m=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,m){var C={};for(var P in this._tiles){var D=this._tiles[P];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+m),C[D.tileID.key]=D}for(var N in this._tiles=C,this._timers)clearTimeout(this._timers[N]),delete this._timers[N];for(var K in this._tiles)this._setTileReloadTimer(K,this._tiles[K])}},f.prototype.update=function(l){var m=this;if(this.transform=l,this._sourceLoaded&&!this._paused){var C;this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?C=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Tr){return new h.OverscaledTileID(Tr.canonical.z,Tr.wrap,Tr.canonical.z,Tr.canonical.x,Tr.canonical.y)}):(C=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(C=C.filter(function(Tr){return m._source.hasTile(Tr)}))):C=[];var P=l.coveringZoomLevel(this._source),D=Math.max(P-f.maxOverzooming,this._source.minzoom),N=Math.max(P+f.maxUnderzooming,this._source.minzoom),K=this._updateRetainedTiles(C,P);if(Nr(this._source.type)){for(var re={},ge={},ye=0,we=Object.keys(K);ye<we.length;ye+=1){var We=we[ye],Ue=K[We],tt=this._tiles[We];if(tt&&!(tt.fadeEndTime&&tt.fadeEndTime<=h.browser.now())){var Ze=this.findLoadedParent(Ue,D);Ze&&(this._addTile(Ze.tileID),re[Ze.tileID.key]=Ze.tileID),ge[We]=Ue}}for(var $e in this._retainLoadedChildren(ge,P,N,K),re)K[$e]||(this._coveredTiles[$e]=!0,K[$e]=re[$e])}for(var Ot in K)this._tiles[Ot].clearFadeHold();for(var Mt=0,Sr=h.keysDifference(this._tiles,K);Mt<Sr.length;Mt+=1){var qt=Sr[Mt],gr=this._tiles[qt];gr.hasSymbolBuckets&&!gr.holdingForFade()?gr.setHoldDuration(this.map._fadeDuration):gr.hasSymbolBuckets&&!gr.symbolFadeFinished()||this._removeTile(qt)}this._updateLoadedParentTileCache()}},f.prototype.releaseSymbolFadeTiles=function(){for(var l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)},f.prototype._updateRetainedTiles=function(l,m){for(var C={},P={},D=Math.max(m-f.maxOverzooming,this._source.minzoom),N=Math.max(m+f.maxUnderzooming,this._source.minzoom),K={},re=0,ge=l;re<ge.length;re+=1){var ye=ge[re],we=this._addTile(ye);C[ye.key]=ye,we.hasData()||m<this._source.maxzoom&&(K[ye.key]=ye)}this._retainLoadedChildren(K,m,N,C);for(var We=0,Ue=l;We<Ue.length;We+=1){var tt=Ue[We],Ze=this._tiles[tt.key];if(!Ze.hasData()){if(m+1>this._source.maxzoom){var $e=tt.children(this._source.maxzoom)[0],Ot=this.getTile($e);if(Ot&&Ot.hasData()){C[$e.key]=$e;continue}}else{var Mt=tt.children(this._source.maxzoom);if(C[Mt[0].key]&&C[Mt[1].key]&&C[Mt[2].key]&&C[Mt[3].key])continue}for(var Sr=Ze.wasRequested(),qt=tt.overscaledZ-1;qt>=D;--qt){var gr=tt.scaledTo(qt);if(P[gr.key]||(P[gr.key]=!0,!(Ze=this.getTile(gr))&&Sr&&(Ze=this._addTile(gr)),Ze&&(C[gr.key]=gr,Sr=Ze.wasRequested(),Ze.hasData())))break}}}return C},f.prototype._updateLoadedParentTileCache=function(){for(var l in this._loadedParentTiles={},this._tiles){for(var m=[],C=void 0,P=this._tiles[l].tileID;P.overscaledZ>0;){if(P.key in this._loadedParentTiles){C=this._loadedParentTiles[P.key];break}m.push(P.key);var D=P.scaledTo(P.overscaledZ-1);if(C=this._getLoadedTile(D))break;P=D}for(var N=0,K=m;N<K.length;N+=1)this._loadedParentTiles[K[N]]=C}},f.prototype._addTile=function(l){var m=this._tiles[l.key];if(m)return m;(m=this._cache.getAndRemove(l))&&(this._setTileReloadTimer(l.key,m),m.tileID=l,this._state.initializeTileState(m,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,m)));var C=Boolean(m);return C||(m=new h.Tile(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(m,this._tileLoaded.bind(this,m,l.key,m.state))),m?(m.uses++,this._tiles[l.key]=m,C||this._source.fire(new h.Event("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m):null},f.prototype._setTileReloadTimer=function(l,m){var C=this;l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);var P=m.getExpiryTimeout();P&&(this._timers[l]=setTimeout(function(){C._reloadTile(l,"expired"),delete C._timers[l]},P))},f.prototype._removeTile=function(l){var m=this._tiles[l];m&&(m.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),m.uses>0||(m.hasData()&&m.state!=="reloading"?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))},f.prototype.clearTiles=function(){for(var l in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(l);this._cache.reset()},f.prototype.tilesIn=function(l,m,C){var P=this,D=[],N=this.transform;if(!N)return D;for(var K=C?N.getCameraQueryGeometry(l):l,re=l.map(function(qt){return N.pointCoordinate(qt)}),ge=K.map(function(qt){return N.pointCoordinate(qt)}),ye=this.getIds(),we=1/0,We=1/0,Ue=-1/0,tt=-1/0,Ze=0,$e=ge;Ze<$e.length;Ze+=1){var Ot=$e[Ze];we=Math.min(we,Ot.x),We=Math.min(We,Ot.y),Ue=Math.max(Ue,Ot.x),tt=Math.max(tt,Ot.y)}for(var Mt=function(gr){var Tr=P._tiles[ye[gr]];if(!Tr.holdingForFade()){var Dr=Tr.tileID,nn=Math.pow(2,N.zoom-Tr.tileID.overscaledZ),An=m*Tr.queryPadding*h.EXTENT/Tr.tileSize/nn,Vn=[Dr.getTilePoint(new h.MercatorCoordinate(we,We)),Dr.getTilePoint(new h.MercatorCoordinate(Ue,tt))];if(Vn[0].x-An<h.EXTENT&&Vn[0].y-An<h.EXTENT&&Vn[1].x+An>=0&&Vn[1].y+An>=0){var mi=re.map(function(Ni){return Dr.getTilePoint(Ni)}),yi=ge.map(function(Ni){return Dr.getTilePoint(Ni)});D.push({tile:Tr,tileID:Dr,queryGeometry:mi,cameraQueryGeometry:yi,scale:nn})}}},Sr=0;Sr<ye.length;Sr++)Mt(Sr);return D},f.prototype.getVisibleCoordinates=function(l){for(var m=this,C=this.getRenderableIds(l).map(function(K){return m._tiles[K].tileID}),P=0,D=C;P<D.length;P+=1){var N=D[P];N.posMatrix=this.transform.calculatePosMatrix(N.toUnwrapped())}return C},f.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Nr(this._source.type))for(var l in this._tiles){var m=this._tiles[l];if(m.fadeEndTime!==void 0&&m.fadeEndTime>=h.browser.now())return!0}return!1},f.prototype.setFeatureState=function(l,m,C){this._state.updateState(l=l||"_geojsonTileLayer",m,C)},f.prototype.removeFeatureState=function(l,m,C){this._state.removeFeatureState(l=l||"_geojsonTileLayer",m,C)},f.prototype.getFeatureState=function(l,m){return this._state.getState(l=l||"_geojsonTileLayer",m)},f.prototype.setDependencies=function(l,m,C){var P=this._tiles[l];P&&P.setDependencies(m,C)},f.prototype.reloadTilesForDependencies=function(l,m){for(var C in this._tiles)this._tiles[C].hasDependency(l,m)&&this._reloadTile(C,"reloading");this._cache.filter(function(P){return!P.hasDependency(l,m)})},f}(h.Evented);function nt(d,f){var l=Math.abs(2*d.wrap)-+(d.wrap<0),m=Math.abs(2*f.wrap)-+(f.wrap<0);return d.overscaledZ-f.overscaledZ||m-l||f.canonical.y-d.canonical.y||f.canonical.x-d.canonical.x}function Nr(d){return d==="raster"||d==="image"||d==="video"}function Xr(){return new h.window.Worker(Oh.workerUrl)}Ye.maxOverzooming=10,Ye.maxUnderzooming=3;var dr="mapboxgl_preloaded_worker_pool",Yr=function(){this.active={}};Yr.prototype.acquire=function(d){if(!this.workers)for(this.workers=[];this.workers.length<Yr.workerCount;)this.workers.push(new Xr);return this.active[d]=!0,this.workers.slice()},Yr.prototype.release=function(d){delete this.active[d],this.numActive()===0&&(this.workers.forEach(function(f){f.terminate()}),this.workers=null)},Yr.prototype.isPreloaded=function(){return!!this.active[dr]},Yr.prototype.numActive=function(){return Object.keys(this.active).length};var xn,Gn=Math.floor(h.browser.hardwareConcurrency/2);function pr(){return xn||(xn=new Yr),xn}function jn(d,f){var l={};for(var m in d)m!=="ref"&&(l[m]=d[m]);return h.refProperties.forEach(function(C){C in f&&(l[C]=f[C])}),l}function Rn(d){d=d.slice();for(var f=Object.create(null),l=0;l<d.length;l++)f[d[l].id]=d[l];for(var m=0;m<d.length;m++)"ref"in d[m]&&(d[m]=jn(d[m],f[d[m].ref]));return d}Yr.workerCount=Math.max(Math.min(Gn,6),1);var Nn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Gi(d,f,l){l.push({command:Nn.addSource,args:[d,f[d]]})}function Hn(d,f,l){f.push({command:Nn.removeSource,args:[d]}),l[d]=!0}function ha(d,f,l,m){Hn(d,l,m),Gi(d,f,l)}function Sa(d,f,l){var m;for(m in d[l])if(d[l].hasOwnProperty(m)&&m!=="data"&&!h.deepEqual(d[l][m],f[l][m]))return!1;for(m in f[l])if(f[l].hasOwnProperty(m)&&m!=="data"&&!h.deepEqual(d[l][m],f[l][m]))return!1;return!0}function Ji(d,f,l,m,C,P){var D;for(D in f=f||{},d=d||{})d.hasOwnProperty(D)&&(h.deepEqual(d[D],f[D])||l.push({command:P,args:[m,D,f[D],C]}));for(D in f)f.hasOwnProperty(D)&&!d.hasOwnProperty(D)&&(h.deepEqual(d[D],f[D])||l.push({command:P,args:[m,D,f[D],C]}))}function ei(d){return d.id}function ua(d,f){return d[f.id]=f,d}var Ds=function(f,l){this.reset(f,l)};Ds.prototype.reset=function(d,f){this.points=d||[],this._distances=[0];for(var l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ds.prototype.lerp=function(d){if(this.points.length===1)return this.points[0];d=h.clamp(d,0,1);for(var f=1,l=this._distances[f],m=d*this.paddedLength+this.padding;l<m&&f<this._distances.length;)l=this._distances[++f];var C=f-1,P=this._distances[C],D=l-P,N=D>0?(m-P)/D:0;return this.points[C].mult(1-N).add(this.points[f].mult(N))};var Ca=function(f,l,m){var C=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(f/m),this.yCellCount=Math.ceil(l/m);for(var D=0;D<this.xCellCount*this.yCellCount;D++)C.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=f,this.height=l,this.xScale=this.xCellCount/f,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0};function zo(d,f,l,m,C){var P=h.create();return f?(h.scale(P,P,[1/C,1/C,1]),l||h.rotateZ(P,P,m.angle)):h.multiply(P,m.labelPlaneMatrix,d),P}function Ei(d,f,l,m,C){if(f){var P=h.clone(d);return h.scale(P,P,[C,C,1]),l||h.rotateZ(P,P,-m.angle),P}return m.glCoordMatrix}function Qi(d,f){var l=[d.x,d.y,0,1];no(l,l,f);var m=l[3];return{point:new h.Point(l[0]/m,l[1]/m),signedDistanceFromCamera:m}}function Bi(d,f){return .5+d/f*.5}function Uo(d,f){var l=d[0]/d[3],m=d[1]/d[3];return l>=-f[0]&&l<=f[0]&&m>=-f[1]&&m<=f[1]}function Ho(d,f,l,m,C,P,D,N){var K=m?d.textSizeData:d.iconSizeData,re=h.evaluateSizeForZoom(K,l.transform.zoom),ge=[256/l.width*2+1,256/l.height*2+1],ye=m?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;ye.clear();for(var we=d.lineVertexArray,We=m?d.text.placedSymbolArray:d.icon.placedSymbolArray,Ue=l.transform.width/l.transform.height,tt=!1,Ze=0;Ze<We.length;Ze++){var $e=We.get(Ze);if($e.hidden||$e.writingMode===h.WritingMode.vertical&&!tt)vo($e.numGlyphs,ye);else{tt=!1;var Ot=[$e.anchorX,$e.anchorY,0,1];if(h.transformMat4(Ot,Ot,f),Uo(Ot,ge)){var Mt=Bi(l.transform.cameraToCenterDistance,Ot[3]),Sr=h.evaluateSizeForFeature(K,re,$e),qt=D?Sr/Mt:Sr*Mt,gr=new h.Point($e.anchorX,$e.anchorY),Tr=Qi(gr,C).point,Dr={},nn=nu($e,qt,!1,N,f,C,P,d.glyphOffsetArray,we,ye,Tr,gr,Dr,Ue);tt=nn.useVertical,(nn.notEnoughRoom||tt||nn.needsFlipping&&nu($e,qt,!0,N,f,C,P,d.glyphOffsetArray,we,ye,Tr,gr,Dr,Ue).notEnoughRoom)&&vo($e.numGlyphs,ye)}else vo($e.numGlyphs,ye)}}m?d.text.dynamicLayoutVertexBuffer.updateData(ye):d.icon.dynamicLayoutVertexBuffer.updateData(ye)}function so(d,f,l,m,C,P,D,N,K,re,ge){var ye=N.glyphStartIndex+N.numGlyphs,we=N.lineStartIndex,We=N.lineStartIndex+N.lineLength,Ue=f.getoffsetX(N.glyphStartIndex),tt=f.getoffsetX(ye-1),Ze=uo(d*Ue,l,m,C,P,D,N.segment,we,We,K,re,ge);if(!Ze)return null;var $e=uo(d*tt,l,m,C,P,D,N.segment,we,We,K,re,ge);return $e?{first:Ze,last:$e}:null}function Ft(d,f,l,m){return d===h.WritingMode.horizontal&&Math.abs(l.y-f.y)>Math.abs(l.x-f.x)*m?{useVertical:!0}:(d===h.WritingMode.vertical?f.y<l.y:f.x>l.x)?{needsFlipping:!0}:null}function nu(d,f,l,m,C,P,D,N,K,re,ge,ye,we,We){var Ue,tt=f/24,Ze=d.lineOffsetX*tt,$e=d.lineOffsetY*tt;if(d.numGlyphs>1){var Ot=d.glyphStartIndex+d.numGlyphs,Mt=d.lineStartIndex,Sr=d.lineStartIndex+d.lineLength,qt=so(tt,N,Ze,$e,l,ge,ye,d,K,P,we);if(!qt)return{notEnoughRoom:!0};var gr=Qi(qt.first.point,D).point,Tr=Qi(qt.last.point,D).point;if(m&&!l){var Dr=Ft(d.writingMode,gr,Tr,We);if(Dr)return Dr}Ue=[qt.first];for(var nn=d.glyphStartIndex+1;nn<Ot-1;nn++)Ue.push(uo(tt*N.getoffsetX(nn),Ze,$e,l,ge,ye,d.segment,Mt,Sr,K,P,we));Ue.push(qt.last)}else{if(m&&!l){var An=Qi(ye,C).point,Vn=d.lineStartIndex+d.segment+1,mi=new h.Point(K.getx(Vn),K.gety(Vn)),yi=Qi(mi,C),Ni=yi.signedDistanceFromCamera>0?yi.point:Yt(ye,mi,An,1,C),Ii=Ft(d.writingMode,An,Ni,We);if(Ii)return Ii}var $n=uo(tt*N.getoffsetX(d.glyphStartIndex),Ze,$e,l,ge,ye,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,K,P,we);if(!$n)return{notEnoughRoom:!0};Ue=[$n]}for(var zi=0,Wi=Ue;zi<Wi.length;zi+=1){var ui=Wi[zi];h.addDynamicAttributes(re,ui.point,ui.angle)}return{}}function Yt(d,f,l,m,C){var P=Qi(d.add(d.sub(f)._unit()),C).point,D=l.sub(P);return l.add(D._mult(m/D.mag()))}function uo(d,f,l,m,C,P,D,N,K,re,ge,ye){var we=m?d-f:d+f,We=we>0?1:-1,Ue=0;m&&(We*=-1,Ue=Math.PI),We<0&&(Ue+=Math.PI);for(var tt=We>0?N+D:N+D+1,Ze=C,$e=C,Ot=0,Mt=0,Sr=Math.abs(we),qt=[];Ot+Mt<=Sr;){if((tt+=We)<N||tt>=K)return null;if($e=Ze,qt.push(Ze),(Ze=ye[tt])===void 0){var gr=new h.Point(re.getx(tt),re.gety(tt)),Tr=Qi(gr,ge);if(Tr.signedDistanceFromCamera>0)Ze=ye[tt]=Tr.point;else{var Dr=tt-We;Ze=Yt(Ot===0?P:new h.Point(re.getx(Dr),re.gety(Dr)),gr,$e,Sr-Ot+1,ge)}}Ot+=Mt,Mt=$e.dist(Ze)}var nn=(Sr-Ot)/Mt,An=Ze.sub($e),Vn=An.mult(nn)._add($e);Vn._add(An._unit()._perp()._mult(l*We));var mi=Ue+Math.atan2(Ze.y-$e.y,Ze.x-$e.x);return qt.push(Vn),{point:Vn,angle:mi,path:qt}}Ca.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ca.prototype.insert=function(d,f,l,m,C){this._forEachCell(f,l,m,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(d),this.bboxes.push(f),this.bboxes.push(l),this.bboxes.push(m),this.bboxes.push(C)},Ca.prototype.insertCircle=function(d,f,l,m){this._forEachCell(f-m,l-m,f+m,l+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(f),this.circles.push(l),this.circles.push(m)},Ca.prototype._insertBoxCell=function(d,f,l,m,C,P){this.boxCells[C].push(P)},Ca.prototype._insertCircleCell=function(d,f,l,m,C,P){this.circleCells[C].push(P)},Ca.prototype._query=function(d,f,l,m,C,P){if(l<0||d>this.width||m<0||f>this.height)return!C&&[];var D=[];if(d<=0&&f<=0&&this.width<=l&&this.height<=m){if(C)return!0;for(var N=0;N<this.boxKeys.length;N++)D.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(var K=0;K<this.circleKeys.length;K++){var re=this.circles[3*K],ge=this.circles[3*K+1],ye=this.circles[3*K+2];D.push({key:this.circleKeys[K],x1:re-ye,y1:ge-ye,x2:re+ye,y2:ge+ye})}return P?D.filter(P):D}return this._forEachCell(d,f,l,m,this._queryCell,D,{hitTest:C,seenUids:{box:{},circle:{}}},P),C?D.length>0:D},Ca.prototype._queryCircle=function(d,f,l,m,C){var P=d-l,D=d+l,N=f-l,K=f+l;if(D<0||P>this.width||K<0||N>this.height)return!m&&[];var re=[];return this._forEachCell(P,N,D,K,this._queryCellCircle,re,{hitTest:m,circle:{x:d,y:f,radius:l},seenUids:{box:{},circle:{}}},C),m?re.length>0:re},Ca.prototype.query=function(d,f,l,m,C){return this._query(d,f,l,m,!1,C)},Ca.prototype.hitTest=function(d,f,l,m,C){return this._query(d,f,l,m,!0,C)},Ca.prototype.hitTestCircle=function(d,f,l,m){return this._queryCircle(d,f,l,!0,m)},Ca.prototype._queryCell=function(d,f,l,m,C,P,D,N){var K=D.seenUids,re=this.boxCells[C];if(re!==null)for(var ge=this.bboxes,ye=0,we=re;ye<we.length;ye+=1){var We=we[ye];if(!K.box[We]){K.box[We]=!0;var Ue=4*We;if(d<=ge[Ue+2]&&f<=ge[Ue+3]&&l>=ge[Ue+0]&&m>=ge[Ue+1]&&(!N||N(this.boxKeys[We]))){if(D.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[We],x1:ge[Ue],y1:ge[Ue+1],x2:ge[Ue+2],y2:ge[Ue+3]})}}}var tt=this.circleCells[C];if(tt!==null)for(var Ze=this.circles,$e=0,Ot=tt;$e<Ot.length;$e+=1){var Mt=Ot[$e];if(!K.circle[Mt]){K.circle[Mt]=!0;var Sr=3*Mt;if(this._circleAndRectCollide(Ze[Sr],Ze[Sr+1],Ze[Sr+2],d,f,l,m)&&(!N||N(this.circleKeys[Mt]))){if(D.hitTest)return P.push(!0),!0;var qt=Ze[Sr],gr=Ze[Sr+1],Tr=Ze[Sr+2];P.push({key:this.circleKeys[Mt],x1:qt-Tr,y1:gr-Tr,x2:qt+Tr,y2:gr+Tr})}}}},Ca.prototype._queryCellCircle=function(d,f,l,m,C,P,D,N){var K=D.circle,re=D.seenUids,ge=this.boxCells[C];if(ge!==null)for(var ye=this.bboxes,we=0,We=ge;we<We.length;we+=1){var Ue=We[we];if(!re.box[Ue]){re.box[Ue]=!0;var tt=4*Ue;if(this._circleAndRectCollide(K.x,K.y,K.radius,ye[tt+0],ye[tt+1],ye[tt+2],ye[tt+3])&&(!N||N(this.boxKeys[Ue])))return P.push(!0),!0}}var Ze=this.circleCells[C];if(Ze!==null)for(var $e=this.circles,Ot=0,Mt=Ze;Ot<Mt.length;Ot+=1){var Sr=Mt[Ot];if(!re.circle[Sr]){re.circle[Sr]=!0;var qt=3*Sr;if(this._circlesCollide($e[qt],$e[qt+1],$e[qt+2],K.x,K.y,K.radius)&&(!N||N(this.circleKeys[Sr])))return P.push(!0),!0}}},Ca.prototype._forEachCell=function(d,f,l,m,C,P,D,N){for(var K=this._convertToXCellCoord(d),re=this._convertToYCellCoord(f),ge=this._convertToXCellCoord(l),ye=this._convertToYCellCoord(m),we=K;we<=ge;we++)for(var We=re;We<=ye;We++)if(C.call(this,d,f,l,m,this.xCellCount*We+we,P,D,N))return},Ca.prototype._convertToXCellCoord=function(d){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(d*this.xScale)))},Ca.prototype._convertToYCellCoord=function(d){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(d*this.yScale)))},Ca.prototype._circlesCollide=function(d,f,l,m,C,P){var D=m-d,N=C-f,K=l+P;return K*K>D*D+N*N},Ca.prototype._circleAndRectCollide=function(d,f,l,m,C,P,D){var N=(P-m)/2,K=Math.abs(d-(m+N));if(K>N+l)return!1;var re=(D-C)/2,ge=Math.abs(f-(C+re));if(ge>re+l)return!1;if(K<=N||ge<=re)return!0;var ye=K-N,we=ge-re;return ye*ye+we*we<=l*l};var jo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function vo(d,f){for(var l=0;l<d;l++){var m=f.length;f.resize(m+4),f.float32.set(jo,3*m)}}function no(d,f,l){var m=f[0],C=f[1];return d[0]=l[0]*m+l[4]*C+l[12],d[1]=l[1]*m+l[5]*C+l[13],d[3]=l[3]*m+l[7]*C+l[15],d}var As=function(f,l,m){l===void 0&&(l=new Ca(f.width+200,f.height+200,25)),m===void 0&&(m=new Ca(f.width+200,f.height+200,25)),this.transform=f,this.grid=l,this.ignoredGrid=m,this.pitchfactor=Math.cos(f._pitch)*f.cameraToCenterDistance,this.screenRightBoundary=f.width+100,this.screenBottomBoundary=f.height+100,this.gridRightBoundary=f.width+200,this.gridBottomBoundary=f.height+200};function qr(d,f,l){return f*(h.EXTENT/(d.tileSize*Math.pow(2,l-d.tileID.overscaledZ)))}As.prototype.placeCollisionBox=function(d,f,l,m,C){var P=this.projectAndGetPerspectiveRatio(m,d.anchorPointX,d.anchorPointY),D=l*P.perspectiveRatio,N=d.x1*D+P.point.x,K=d.y1*D+P.point.y,re=d.x2*D+P.point.x,ge=d.y2*D+P.point.y;return!this.isInsideGrid(N,K,re,ge)||!f&&this.grid.hitTest(N,K,re,ge,C)?{box:[],offscreen:!1}:{box:[N,K,re,ge],offscreen:this.isOffscreen(N,K,re,ge)}},As.prototype.placeCollisionCircles=function(d,f,l,m,C,P,D,N,K,re,ge,ye,we){var We=[],Ue=new h.Point(f.anchorX,f.anchorY),tt=Qi(Ue,P),Ze=Bi(this.transform.cameraToCenterDistance,tt.signedDistanceFromCamera),$e=(re?C/Ze:C*Ze)/h.ONE_EM,Ot=Qi(Ue,D).point,Mt=so($e,m,f.lineOffsetX*$e,f.lineOffsetY*$e,!1,Ot,Ue,f,l,D,{}),Sr=!1,qt=!1,gr=!0;if(Mt){for(var Tr=.5*ye*Ze+we,Dr=new h.Point(-100,-100),nn=new h.Point(this.screenRightBoundary,this.screenBottomBoundary),An=new Ds,Vn=Mt.first,mi=Mt.last,yi=[],Ni=Vn.path.length-1;Ni>=1;Ni--)yi.push(Vn.path[Ni]);for(var Ii=1;Ii<mi.path.length;Ii++)yi.push(mi.path[Ii]);var $n=2.5*Tr;if(N){var zi=yi.map(function(Ws){return Qi(Ws,N)});yi=zi.some(function(Ws){return Ws.signedDistanceFromCamera<=0})?[]:zi.map(function(Ws){return Ws.point})}var Wi=[];if(yi.length>0){for(var ui=yi[0].clone(),ea=yi[0].clone(),Ai=1;Ai<yi.length;Ai++)ui.x=Math.min(ui.x,yi[Ai].x),ui.y=Math.min(ui.y,yi[Ai].y),ea.x=Math.max(ea.x,yi[Ai].x),ea.y=Math.max(ea.y,yi[Ai].y);Wi=ui.x>=Dr.x&&ea.x<=nn.x&&ui.y>=Dr.y&&ea.y<=nn.y?[yi]:ea.x<Dr.x||ui.x>nn.x||ea.y<Dr.y||ui.y>nn.y?[]:h.clipLine([yi],Dr.x,Dr.y,nn.x,nn.y)}for(var na=0,wa=Wi;na<wa.length;na+=1){var rs;An.reset(wa[na],.25*Tr),rs=An.length<=.5*Tr?1:Math.ceil(An.paddedLength/$n)+1;for(var ka=0;ka<rs;ka++){var ms=ka/Math.max(rs-1,1),Oo=An.lerp(ms),Ja=Oo.x+100,Eu=Oo.y+100;We.push(Ja,Eu,Tr,0);var ho=Ja-Tr,Yu=Eu-Tr,Su=Ja+Tr,go=Eu+Tr;if(gr=gr&&this.isOffscreen(ho,Yu,Su,go),qt=qt||this.isInsideGrid(ho,Yu,Su,go),!d&&this.grid.hitTestCircle(Ja,Eu,Tr,ge)&&(Sr=!0,!K))return{circles:[],offscreen:!1,collisionDetected:Sr}}}}return{circles:!K&&Sr||!qt?[]:We,offscreen:gr,collisionDetected:Sr}},As.prototype.queryRenderedSymbols=function(d){if(d.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var f=[],l=1/0,m=1/0,C=-1/0,P=-1/0,D=0,N=d;D<N.length;D+=1){var K=N[D],re=new h.Point(K.x+100,K.y+100);l=Math.min(l,re.x),m=Math.min(m,re.y),C=Math.max(C,re.x),P=Math.max(P,re.y),f.push(re)}for(var ge={},ye={},we=0,We=this.grid.query(l,m,C,P).concat(this.ignoredGrid.query(l,m,C,P));we<We.length;we+=1){var Ue=We[we],tt=Ue.key;if(ge[tt.bucketInstanceId]===void 0&&(ge[tt.bucketInstanceId]={}),!ge[tt.bucketInstanceId][tt.featureIndex]){var Ze=[new h.Point(Ue.x1,Ue.y1),new h.Point(Ue.x2,Ue.y1),new h.Point(Ue.x2,Ue.y2),new h.Point(Ue.x1,Ue.y2)];h.polygonIntersectsPolygon(f,Ze)&&(ge[tt.bucketInstanceId][tt.featureIndex]=!0,ye[tt.bucketInstanceId]===void 0&&(ye[tt.bucketInstanceId]=[]),ye[tt.bucketInstanceId].push(tt.featureIndex))}}return ye},As.prototype.insertCollisionBox=function(d,f,l,m,C){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:l,featureIndex:m,collisionGroupID:C},d[0],d[1],d[2],d[3])},As.prototype.insertCollisionCircles=function(d,f,l,m,C){for(var P=f?this.ignoredGrid:this.grid,D={bucketInstanceId:l,featureIndex:m,collisionGroupID:C},N=0;N<d.length;N+=4)P.insertCircle(D,d[N],d[N+1],d[N+2])},As.prototype.projectAndGetPerspectiveRatio=function(d,f,l){var m=[f,l,0,1];return no(m,m,d),{point:new h.Point((m[0]/m[3]+1)/2*this.transform.width+100,(-m[1]/m[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/m[3]*.5}},As.prototype.isOffscreen=function(d,f,l,m){return l<100||d>=this.screenRightBoundary||m<100||f>this.screenBottomBoundary},As.prototype.isInsideGrid=function(d,f,l,m){return l>=0&&d<this.gridRightBoundary&&m>=0&&f<this.gridBottomBoundary},As.prototype.getViewportMatrix=function(){var d=h.identity([]);return h.translate(d,d,[-100,-100,0]),d};var xs=function(f,l,m,C){this.opacity=f?Math.max(0,Math.min(1,f.opacity+(f.placed?l:-l))):C&&m?1:0,this.placed=m};xs.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var hn=function(f,l,m,C,P){this.text=new xs(f?f.text:null,l,m,P),this.icon=new xs(f?f.icon:null,l,C,P)};hn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ts=function(f,l,m){this.text=f,this.icon=l,this.skipFade=m},wt=function(){this.invProjMatrix=h.create(),this.viewportMatrix=h.create(),this.circles=[]},_l=function(f,l,m,C,P){this.bucketInstanceId=f,this.featureIndex=l,this.sourceLayerIndex=m,this.bucketIndex=C,this.tileID=P},Us=function(f){this.crossSourceCollisions=f,this.maxGroupID=0,this.collisionGroups={}};function ce(d,f,l,m,C){var P=h.getAnchorAlignment(d),D=-(P.horizontalAlign-.5)*f,N=-(P.verticalAlign-.5)*l,K=h.evaluateVariableOffset(d,m);return new h.Point(D+K[0]*C,N+K[1]*C)}function Tu(d,f,l,m,C,P){var D=d.x1,N=d.x2,K=d.y1,re=d.y2,ge=d.anchorPointX,ye=d.anchorPointY,we=new h.Point(f,l);return m&&we._rotate(C?P:-P),{x1:D+we.x,y1:K+we.y,x2:N+we.x,y2:re+we.y,anchorPointX:ge,anchorPointY:ye}}Us.prototype.get=function(d){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[d]){var f=++this.maxGroupID;this.collisionGroups[d]={ID:f,predicate:function(m){return m.collisionGroupID===f}}}return this.collisionGroups[d]};var ls=function(f,l,m,C){this.transform=f.clone(),this.collisionIndex=new As(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Us(m),this.collisionCircleArrays={},this.prevPlacement=C,C&&(C.prevPlacement=void 0),this.placedOrientations={}};function $o(d,f,l,m,C){d.emplaceBack(f?1:0,l?1:0,m||0,C||0),d.emplaceBack(f?1:0,l?1:0,m||0,C||0),d.emplaceBack(f?1:0,l?1:0,m||0,C||0),d.emplaceBack(f?1:0,l?1:0,m||0,C||0)}ls.prototype.getBucketParts=function(d,f,l,m){var C=l.getBucket(f),P=l.latestFeatureIndex;if(C&&P&&f.id===C.layerIds[0]){var D=l.collisionBoxArray,N=C.layers[0].layout,K=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),re=l.tileSize/h.EXTENT,ge=this.transform.calculatePosMatrix(l.tileID.toUnwrapped()),ye=N.get("text-pitch-alignment")==="map",we=N.get("text-rotation-alignment")==="map",We=qr(l,1,this.transform.zoom),Ue=zo(ge,ye,we,this.transform,We),tt=null;if(ye){var Ze=Ei(ge,ye,we,this.transform,We);tt=h.multiply([],this.transform.labelPlaneMatrix,Ze)}this.retainedQueryData[C.bucketInstanceId]=new _l(C.bucketInstanceId,P,C.sourceLayerIndex,C.index,l.tileID);var $e={bucket:C,layout:N,posMatrix:ge,textLabelPlaneMatrix:Ue,labelToScreenMatrix:tt,scale:K,textPixelRatio:re,holdingForFade:l.holdingForFade(),collisionBoxArray:D,partiallyEvaluatedTextSize:h.evaluateSizeForZoom(C.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(m)for(var Ot=0,Mt=C.sortKeyRanges;Ot<Mt.length;Ot+=1){var Sr=Mt[Ot];d.push({sortKey:Sr.sortKey,symbolInstanceStart:Sr.symbolInstanceStart,symbolInstanceEnd:Sr.symbolInstanceEnd,parameters:$e})}else d.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:$e})}},ls.prototype.attemptAnchorPlacement=function(d,f,l,m,C,P,D,N,K,re,ge,ye,we,We,Ue){var tt,Ze=[ye.textOffset0,ye.textOffset1],$e=ce(d,l,m,Ze,C),Ot=this.collisionIndex.placeCollisionBox(Tu(f,$e.x,$e.y,P,D,this.transform.angle),ge,N,K,re.predicate);if(!Ue||this.collisionIndex.placeCollisionBox(Tu(Ue,$e.x,$e.y,P,D,this.transform.angle),ge,N,K,re.predicate).box.length!==0)return Ot.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[ye.crossTileID]&&this.prevPlacement.placements[ye.crossTileID]&&this.prevPlacement.placements[ye.crossTileID].text&&(tt=this.prevPlacement.variableOffsets[ye.crossTileID].anchor),this.variableOffsets[ye.crossTileID]={textOffset:Ze,width:l,height:m,anchor:d,textBoxScale:C,prevAnchor:tt},this.markUsedJustification(we,d,ye,We),we.allowVerticalPlacement&&(this.markUsedOrientation(we,We,ye),this.placedOrientations[ye.crossTileID]=We),{shift:$e,placedGlyphBoxes:Ot}):void 0},ls.prototype.placeLayerBucketPart=function(d,f,l){var m=this,C=d.parameters,P=C.bucket,D=C.layout,N=C.posMatrix,K=C.textLabelPlaneMatrix,re=C.labelToScreenMatrix,ge=C.textPixelRatio,ye=C.holdingForFade,we=C.collisionBoxArray,We=C.partiallyEvaluatedTextSize,Ue=C.collisionGroup,tt=D.get("text-optional"),Ze=D.get("icon-optional"),$e=D.get("text-allow-overlap"),Ot=D.get("icon-allow-overlap"),Mt=D.get("text-rotation-alignment")==="map",Sr=D.get("text-pitch-alignment")==="map",qt=D.get("icon-text-fit")!=="none",gr=D.get("symbol-z-order")==="viewport-y",Tr=$e&&(Ot||!P.hasIconData()||Ze),Dr=Ot&&($e||!P.hasTextData()||tt);!P.collisionArrays&&we&&P.deserializeCollisionBoxes(we);var nn=function($n,zi){if(!f[$n.crossTileID])if(ye)m.placements[$n.crossTileID]=new Ts(!1,!1,!1);else{var Wi,ui=!1,ea=!1,Ai=!0,na=null,wa={box:null,offscreen:null},rs={box:null,offscreen:null},ka=null,ms=null,Oo=0,Ja=0,Eu=0;zi.textFeatureIndex?Oo=zi.textFeatureIndex:$n.useRuntimeCollisionCircles&&(Oo=$n.featureIndex),zi.verticalTextFeatureIndex&&(Ja=zi.verticalTextFeatureIndex);var ho=zi.textBox;if(ho){var Yu=function(Fs){var Du=h.WritingMode.horizontal;if(P.allowVerticalPlacement&&!Fs&&m.prevPlacement){var Bs=m.prevPlacement.placedOrientations[$n.crossTileID];Bs&&(m.placedOrientations[$n.crossTileID]=Bs,m.markUsedOrientation(P,Du=Bs,$n))}return Du},Su=function(Fs,Du){if(P.allowVerticalPlacement&&$n.numVerticalGlyphVertices>0&&zi.verticalTextBox)for(var Bs=0,Fu=P.writingModes;Bs<Fu.length&&(Fu[Bs]===h.WritingMode.vertical?(wa=Du(),rs=wa):wa=Fs(),!(wa&&wa.box&&wa.box.length));Bs+=1);else wa=Fs()};if(D.get("text-variable-anchor")){var go=D.get("text-variable-anchor");if(m.prevPlacement&&m.prevPlacement.variableOffsets[$n.crossTileID]){var Ws=m.prevPlacement.variableOffsets[$n.crossTileID];go.indexOf(Ws.anchor)>0&&(go=go.filter(function(Cu){return Cu!==Ws.anchor})).unshift(Ws.anchor)}var Es=function(Fs,Du,Bs){for(var Fu=Fs.x2-Fs.x1,vf=Fs.y2-Fs.y1,Yc=$n.textBoxScale,Kc=qt&&!Ot?Du:null,Yl={box:[],offscreen:!1},lc=$e?2*go.length:go.length,vl=0;vl<lc;++vl){var Zs=m.attemptAnchorPlacement(go[vl%go.length],Fs,Fu,vf,Yc,Mt,Sr,ge,N,Ue,vl>=go.length,$n,P,Bs,Kc);if(Zs&&(Yl=Zs.placedGlyphBoxes)&&Yl.box&&Yl.box.length){ui=!0,na=Zs.shift;break}}return Yl};Su(function(){return Es(ho,zi.iconBox,h.WritingMode.horizontal)},function(){var Cu=zi.verticalTextBox;return P.allowVerticalPlacement&&!(wa&&wa.box&&wa.box.length)&&$n.numVerticalGlyphVertices>0&&Cu?Es(Cu,zi.verticalIconBox,h.WritingMode.vertical):{box:null,offscreen:null}}),wa&&(ui=wa.box,Ai=wa.offscreen);var Lu=Yu(wa&&wa.box);if(!ui&&m.prevPlacement){var oc=m.prevPlacement.variableOffsets[$n.crossTileID];oc&&(m.variableOffsets[$n.crossTileID]=oc,m.markUsedJustification(P,oc.anchor,$n,Lu))}}else{var sc=function(Fs,Du){var Bs=m.collisionIndex.placeCollisionBox(Fs,$e,ge,N,Ue.predicate);return Bs&&Bs.box&&Bs.box.length&&(m.markUsedOrientation(P,Du,$n),m.placedOrientations[$n.crossTileID]=Du),Bs};Su(function(){return sc(ho,h.WritingMode.horizontal)},function(){var Cu=zi.verticalTextBox;return P.allowVerticalPlacement&&$n.numVerticalGlyphVertices>0&&Cu?sc(Cu,h.WritingMode.vertical):{box:null,offscreen:null}}),Yu(wa&&wa.box&&wa.box.length)}}if(ui=(Wi=wa)&&Wi.box&&Wi.box.length>0,Ai=Wi&&Wi.offscreen,$n.useRuntimeCollisionCircles){var Tc=P.text.placedSymbolArray.get($n.centerJustifiedTextSymbolIndex),ku=h.evaluateSizeForFeature(P.textSizeData,We,Tc),Xc=D.get("text-padding");ka=m.collisionIndex.placeCollisionCircles($e,Tc,P.lineVertexArray,P.glyphOffsetArray,ku,N,K,re,l,Sr,Ue.predicate,$n.collisionCircleDiameter,Xc),ui=$e||ka.circles.length>0&&!ka.collisionDetected,Ai=Ai&&ka.offscreen}if(zi.iconFeatureIndex&&(Eu=zi.iconFeatureIndex),zi.iconBox){var Ol=function(Fs){var Du=qt&&na?Tu(Fs,na.x,na.y,Mt,Sr,m.transform.angle):Fs;return m.collisionIndex.placeCollisionBox(Du,Ot,ge,N,Ue.predicate)};ea=rs&&rs.box&&rs.box.length&&zi.verticalIconBox?(ms=Ol(zi.verticalIconBox)).box.length>0:(ms=Ol(zi.iconBox)).box.length>0,Ai=Ai&&ms.offscreen}var Ps=tt||$n.numHorizontalGlyphVertices===0&&$n.numVerticalGlyphVertices===0,Ku=Ze||$n.numIconVertices===0;if(Ps||Ku?Ku?Ps||(ea=ea&&ui):ui=ea&&ui:ea=ui=ea&&ui,ui&&Wi&&Wi.box&&m.collisionIndex.insertCollisionBox(Wi.box,D.get("text-ignore-placement"),P.bucketInstanceId,rs&&rs.box&&Ja?Ja:Oo,Ue.ID),ea&&ms&&m.collisionIndex.insertCollisionBox(ms.box,D.get("icon-ignore-placement"),P.bucketInstanceId,Eu,Ue.ID),ka&&(ui&&m.collisionIndex.insertCollisionCircles(ka.circles,D.get("text-ignore-placement"),P.bucketInstanceId,Oo,Ue.ID),l)){var rh=P.bucketInstanceId,uc=m.collisionCircleArrays[rh];uc===void 0&&(uc=m.collisionCircleArrays[rh]=new wt);for(var Ss=0;Ss<ka.circles.length;Ss+=4)uc.circles.push(ka.circles[Ss+0]),uc.circles.push(ka.circles[Ss+1]),uc.circles.push(ka.circles[Ss+2]),uc.circles.push(ka.collisionDetected?1:0)}m.placements[$n.crossTileID]=new Ts(ui||Tr,ea||Dr,Ai||P.justReloaded),f[$n.crossTileID]=!0}};if(gr)for(var An=P.getSortedSymbolIndexes(this.transform.angle),Vn=An.length-1;Vn>=0;--Vn){var mi=An[Vn];nn(P.symbolInstances.get(mi),P.collisionArrays[mi])}else for(var yi=d.symbolInstanceStart;yi<d.symbolInstanceEnd;yi++)nn(P.symbolInstances.get(yi),P.collisionArrays[yi]);if(l&&P.bucketInstanceId in this.collisionCircleArrays){var Ni=this.collisionCircleArrays[P.bucketInstanceId];h.invert(Ni.invProjMatrix,N),Ni.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1},ls.prototype.markUsedJustification=function(d,f,l,m){var C;C=m===h.WritingMode.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[h.getAnchorJustification(f)];for(var P=0,D=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];P<D.length;P+=1){var N=D[P];N>=0&&(d.text.placedSymbolArray.get(N).crossTileID=C>=0&&N!==C?0:l.crossTileID)}},ls.prototype.markUsedOrientation=function(d,f,l){for(var m=f===h.WritingMode.horizontal||f===h.WritingMode.horizontalOnly?f:0,C=f===h.WritingMode.vertical?f:0,P=0,D=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];P<D.length;P+=1)d.text.placedSymbolArray.get(D[P]).placedOrientation=m;l.verticalPlacedTextSymbolIndex&&(d.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=C)},ls.prototype.commit=function(d){this.commitTime=d,this.zoomAtLastRecencyCheck=this.transform.zoom;var f=this.prevPlacement,l=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;var m=f?f.symbolFadeChange(d):1,C=f?f.opacities:{},P=f?f.variableOffsets:{},D=f?f.placedOrientations:{};for(var N in this.placements){var K=this.placements[N],re=C[N];re?(this.opacities[N]=new hn(re,m,K.text,K.icon),l=l||K.text!==re.text.placed||K.icon!==re.icon.placed):(this.opacities[N]=new hn(null,m,K.text,K.icon,K.skipFade),l=l||K.text||K.icon)}for(var ge in C){var ye=C[ge];if(!this.opacities[ge]){var we=new hn(ye,m,!1,!1);we.isHidden()||(this.opacities[ge]=we,l=l||ye.text.placed||ye.icon.placed)}}for(var We in P)this.variableOffsets[We]||!this.opacities[We]||this.opacities[We].isHidden()||(this.variableOffsets[We]=P[We]);for(var Ue in D)this.placedOrientations[Ue]||!this.opacities[Ue]||this.opacities[Ue].isHidden()||(this.placedOrientations[Ue]=D[Ue]);l?this.lastPlacementChangeTime=d:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:d)},ls.prototype.updateLayerOpacities=function(d,f){for(var l={},m=0,C=f;m<C.length;m+=1){var P=C[m],D=P.getBucket(d);D&&P.latestFeatureIndex&&d.id===D.layerIds[0]&&this.updateBucketOpacities(D,l,P.collisionBoxArray)}},ls.prototype.updateBucketOpacities=function(d,f,l){var m=this;d.hasTextData()&&d.text.opacityVertexArray.clear(),d.hasIconData()&&d.icon.opacityVertexArray.clear(),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexArray.clear(),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexArray.clear();var C=d.layers[0].layout,P=new hn(null,0,!1,!1,!0),D=C.get("text-allow-overlap"),N=C.get("icon-allow-overlap"),K=C.get("text-variable-anchor"),re=C.get("text-rotation-alignment")==="map",ge=C.get("text-pitch-alignment")==="map",ye=C.get("icon-text-fit")!=="none",we=new hn(null,0,D&&(N||!d.hasIconData()||C.get("icon-optional")),N&&(D||!d.hasTextData()||C.get("text-optional")),!0);!d.collisionArrays&&l&&(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&d.deserializeCollisionBoxes(l);for(var We=function(Ot,Mt,Sr){for(var qt=0;qt<Mt/4;qt++)Ot.opacityVertexArray.emplaceBack(Sr)},Ue=function(Ot){var Mt=d.symbolInstances.get(Ot),Sr=Mt.numHorizontalGlyphVertices,qt=Mt.numVerticalGlyphVertices,gr=Mt.crossTileID,Tr=m.opacities[gr];f[gr]?Tr=P:Tr||(m.opacities[gr]=Tr=we),f[gr]=!0;var Dr=Mt.numIconVertices>0,nn=m.placedOrientations[Mt.crossTileID],An=nn===h.WritingMode.vertical,Vn=nn===h.WritingMode.horizontal||nn===h.WritingMode.horizontalOnly;if(Sr>0||qt>0){var mi=mo(Tr.text);We(d.text,Sr,An?lo:mi),We(d.text,qt,Vn?lo:mi);var yi=Tr.text.isHidden();[Mt.rightJustifiedTextSymbolIndex,Mt.centerJustifiedTextSymbolIndex,Mt.leftJustifiedTextSymbolIndex].forEach(function(wa){wa>=0&&(d.text.placedSymbolArray.get(wa).hidden=yi||An?1:0)}),Mt.verticalPlacedTextSymbolIndex>=0&&(d.text.placedSymbolArray.get(Mt.verticalPlacedTextSymbolIndex).hidden=yi||Vn?1:0);var Ni=m.variableOffsets[Mt.crossTileID];Ni&&m.markUsedJustification(d,Ni.anchor,Mt,nn);var Ii=m.placedOrientations[Mt.crossTileID];Ii&&(m.markUsedJustification(d,"left",Mt,Ii),m.markUsedOrientation(d,Ii,Mt))}if(Dr){var $n=mo(Tr.icon),zi=!(ye&&Mt.verticalPlacedIconSymbolIndex&&An);Mt.placedIconSymbolIndex>=0&&(We(d.icon,Mt.numIconVertices,zi?$n:lo),d.icon.placedSymbolArray.get(Mt.placedIconSymbolIndex).hidden=Tr.icon.isHidden()),Mt.verticalPlacedIconSymbolIndex>=0&&(We(d.icon,Mt.numVerticalIconVertices,zi?lo:$n),d.icon.placedSymbolArray.get(Mt.verticalPlacedIconSymbolIndex).hidden=Tr.icon.isHidden())}if(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData()){var Wi=d.collisionArrays[Ot];if(Wi){var ui=new h.Point(0,0);if(Wi.textBox||Wi.verticalTextBox){var ea=!0;if(K){var Ai=m.variableOffsets[gr];Ai?(ui=ce(Ai.anchor,Ai.width,Ai.height,Ai.textOffset,Ai.textBoxScale),re&&ui._rotate(ge?m.transform.angle:-m.transform.angle)):ea=!1}Wi.textBox&&$o(d.textCollisionBox.collisionVertexArray,Tr.text.placed,!ea||An,ui.x,ui.y),Wi.verticalTextBox&&$o(d.textCollisionBox.collisionVertexArray,Tr.text.placed,!ea||Vn,ui.x,ui.y)}var na=Boolean(!Vn&&Wi.verticalIconBox);Wi.iconBox&&$o(d.iconCollisionBox.collisionVertexArray,Tr.icon.placed,na,ye?ui.x:0,ye?ui.y:0),Wi.verticalIconBox&&$o(d.iconCollisionBox.collisionVertexArray,Tr.icon.placed,!na,ye?ui.x:0,ye?ui.y:0)}}},tt=0;tt<d.symbolInstances.length;tt++)Ue(tt);if(d.sortFeatures(this.transform.angle),this.retainedQueryData[d.bucketInstanceId]&&(this.retainedQueryData[d.bucketInstanceId].featureSortOrder=d.featureSortOrder),d.hasTextData()&&d.text.opacityVertexBuffer&&d.text.opacityVertexBuffer.updateData(d.text.opacityVertexArray),d.hasIconData()&&d.icon.opacityVertexBuffer&&d.icon.opacityVertexBuffer.updateData(d.icon.opacityVertexArray),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexBuffer&&d.iconCollisionBox.collisionVertexBuffer.updateData(d.iconCollisionBox.collisionVertexArray),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexBuffer&&d.textCollisionBox.collisionVertexBuffer.updateData(d.textCollisionBox.collisionVertexArray),d.bucketInstanceId in this.collisionCircleArrays){var Ze=this.collisionCircleArrays[d.bucketInstanceId];d.placementInvProjMatrix=Ze.invProjMatrix,d.placementViewportMatrix=Ze.viewportMatrix,d.collisionCircleArray=Ze.circles,delete this.collisionCircleArrays[d.bucketInstanceId]}},ls.prototype.symbolFadeChange=function(d){return this.fadeDuration===0?1:(d-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ls.prototype.zoomAdjustment=function(d){return Math.max(0,(this.transform.zoom-d)/1.5)},ls.prototype.hasTransitions=function(d){return this.stale||d-this.lastPlacementChangeTime<this.fadeDuration},ls.prototype.stillRecent=function(d,f){var l=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*l>d},ls.prototype.setStale=function(){this.stale=!0};var Ke=Math.pow(2,25),me=Math.pow(2,24),Xe=Math.pow(2,17),Ht=Math.pow(2,16),rn=Math.pow(2,9),Yn=Math.pow(2,8),la=Math.pow(2,1);function mo(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;var f=d.placed?1:0,l=Math.floor(127*d.opacity);return l*Ke+f*me+l*Xe+f*Ht+l*rn+f*Yn+l*la+f}var lo=0,bo=function(f){this._sortAcrossTiles=f.layout.get("symbol-z-order")!=="viewport-y"&&f.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};bo.prototype.continuePlacement=function(d,f,l,m,C){for(var P=this._bucketParts;this._currentTileIndex<d.length;)if(f.getBucketParts(P,m,d[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort(function(D,N){return D.sortKey-N.sortKey}));this._currentPartIndex<P.length;)if(f.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,C())return!0;return!1};var qo=function(f,l,m,C,P,D,N){this.placement=new ls(f,P,D,N),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=C,this._done=!1};qo.prototype.isDone=function(){return this._done},qo.prototype.continuePlacement=function(d,f,l){for(var m=this,C=h.browser.now(),P=function(){var re=h.browser.now()-C;return!m._forceFullPlacement&&re>2};this._currentPlacementIndex>=0;){var D=f[d[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if(D.type==="symbol"&&(!D.minzoom||D.minzoom<=N)&&(!D.maxzoom||D.maxzoom>N)){if(this._inProgressLayer||(this._inProgressLayer=new bo(D)),this._inProgressLayer.continuePlacement(l[D.source],this.placement,this._showCollisionBoxes,D,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},qo.prototype.commit=function(d){return this.placement.commit(d),this.placement};var yc=512/h.EXTENT/2,gu=function(f,l,m){this.tileID=f,this.indexedSymbolInstances={},this.bucketInstanceId=m;for(var C=0;C<l.length;C++){var P=l.get(C),D=P.key;this.indexedSymbolInstances[D]||(this.indexedSymbolInstances[D]=[]),this.indexedSymbolInstances[D].push({crossTileID:P.crossTileID,coord:this.getScaledCoordinates(P,f)})}};gu.prototype.getScaledCoordinates=function(d,f){var l=yc/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*h.EXTENT+d.anchorX)*l),y:Math.floor((f.canonical.y*h.EXTENT+d.anchorY)*l)}},gu.prototype.findMatches=function(d,f,l){for(var m=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),C=0;C<d.length;C++){var P=d.get(C);if(!P.crossTileID){var D=this.indexedSymbolInstances[P.key];if(D)for(var N=this.getScaledCoordinates(P,f),K=0,re=D;K<re.length;K+=1){var ge=re[K];if(Math.abs(ge.coord.x-N.x)<=m&&Math.abs(ge.coord.y-N.y)<=m&&!l[ge.crossTileID]){l[ge.crossTileID]=!0,P.crossTileID=ge.crossTileID;break}}}}};var cs=function(){this.maxCrossTileID=0};cs.prototype.generate=function(){return++this.maxCrossTileID};var iu=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};iu.prototype.handleWrapJump=function(d){var f=Math.round((d-this.lng)/360);if(f!==0)for(var l in this.indexes){var m=this.indexes[l],C={};for(var P in m){var D=m[P];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+f),C[D.tileID.key]=D}this.indexes[l]=C}this.lng=d},iu.prototype.addBucket=function(d,f,l){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(var m=0;m<f.symbolInstances.length;m++)f.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]={});var C=this.usedCrossTileIDs[d.overscaledZ];for(var P in this.indexes){var D=this.indexes[P];if(Number(P)>d.overscaledZ)for(var N in D){var K=D[N];K.tileID.isChildOf(d)&&K.findMatches(f.symbolInstances,d,C)}else{var re=D[d.scaledTo(Number(P)).key];re&&re.findMatches(f.symbolInstances,d,C)}}for(var ge=0;ge<f.symbolInstances.length;ge++){var ye=f.symbolInstances.get(ge);ye.crossTileID||(ye.crossTileID=l.generate(),C[ye.crossTileID]=!0)}return this.indexes[d.overscaledZ]===void 0&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new gu(d,f.symbolInstances,f.bucketInstanceId),!0},iu.prototype.removeBucketCrossTileIDs=function(d,f){for(var l in f.indexedSymbolInstances)for(var m=0,C=f.indexedSymbolInstances[l];m<C.length;m+=1)delete this.usedCrossTileIDs[d][C[m].crossTileID]},iu.prototype.removeStaleBuckets=function(d){var f=!1;for(var l in this.indexes){var m=this.indexes[l];for(var C in m)d[m[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,m[C]),delete m[C],f=!0)}return f};var Mu=function(){this.layerIndexes={},this.crossTileIDs=new cs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Mu.prototype.addLayer=function(d,f,l){var m=this.layerIndexes[d.id];m===void 0&&(m=this.layerIndexes[d.id]=new iu);var C=!1,P={};m.handleWrapJump(l);for(var D=0,N=f;D<N.length;D+=1){var K=N[D],re=K.getBucket(d);re&&d.id===re.layerIds[0]&&(re.bucketInstanceId||(re.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(K.tileID,re,this.crossTileIDs)&&(C=!0),P[re.bucketInstanceId]=!0)}return m.removeStaleBuckets(P)&&(C=!0),C},Mu.prototype.pruneUnusedLayers=function(d){var f={};for(var l in d.forEach(function(m){f[m]=!0}),this.layerIndexes)f[l]||delete this.layerIndexes[l]};var au=function(f,l){return h.emitValidationErrors(f,l&&l.filter(function(m){return m.identifier!=="source.canvas"}))},js=h.pick(Nn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),cl=h.pick(Nn,["setCenter","setZoom","setBearing","setPitch"]),Pu=function(){var d={},f=h.styleSpec.$version;for(var l in h.styleSpec.$root){var m,C=h.styleSpec.$root[l];C.required&&(m=l==="version"?f:C.type==="array"?[]:{})!=null&&(d[l]=m)}return d}(),co=function(d){function f(l,m){var C=this;m===void 0&&(m={}),d.call(this),this.map=l,this.dispatcher=new vr(pr(),this),this.imageManager=new He,this.imageManager.setEventedParent(this),this.glyphManager=new Mr(l._requestManager,m.localIdeographFontFamily),this.lineAtlas=new Kt(256,512),this.crossTileSymbolIndex=new Mu,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",h.getReferrer());var P=this;this._rtlTextPluginCallback=f.registerForPluginStateChange(function(D){P.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:D.pluginStatus,pluginURL:D.pluginURL},function(N,K){if(h.triggerPluginCompletionEvent(N),K&&K.every(function(ge){return ge}))for(var re in P.sourceCaches)P.sourceCaches[re].reload()})}),this.on("data",function(D){if(D.dataType==="source"&&D.sourceDataType==="metadata"){var N=C.sourceCaches[D.sourceId];if(N){var K=N.getSource();if(K&&K.vectorLayerIds)for(var re in C._layers){var ge=C._layers[re];ge.source===K.id&&C._validateLayer(ge)}}}})}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.loadURL=function(l,m){var C=this;m===void 0&&(m={}),this.fire(new h.Event("dataloading",{dataType:"style"}));var P=typeof m.validate=="boolean"?m.validate:!h.isMapboxURL(l);l=this.map._requestManager.normalizeStyleURL(l,m.accessToken);var D=this.map._requestManager.transformRequest(l,h.ResourceType.Style);this._request=h.getJSON(D,function(N,K){C._request=null,N?C.fire(new h.ErrorEvent(N)):K&&C._load(K,P)})},f.prototype.loadJSON=function(l,m){var C=this;m===void 0&&(m={}),this.fire(new h.Event("dataloading",{dataType:"style"})),this._request=h.browser.frame(function(){C._request=null,C._load(l,m.validate!==!1)})},f.prototype.loadEmpty=function(){this.fire(new h.Event("dataloading",{dataType:"style"})),this._load(Pu,!1)},f.prototype._load=function(l,m){if(!m||!au(this,h.validateStyle(l))){for(var C in this._loaded=!0,this.stylesheet=l,l.sources)this.addSource(C,l.sources[C],{validate:!1});l.sprite?this._loadSprite(l.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(l.glyphs);var P=Rn(this.stylesheet.layers);this._order=P.map(function(re){return re.id}),this._layers={},this._serializedLayers={};for(var D=0,N=P;D<N.length;D+=1){var K=N[D];(K=h.createStyleLayer(K)).setEventedParent(this,{layer:{id:K.id}}),this._layers[K.id]=K,this._serializedLayers[K.id]=K.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new zt(this.stylesheet.light),this.fire(new h.Event("data",{dataType:"style"})),this.fire(new h.Event("style.load"))}},f.prototype._loadSprite=function(l){var m=this;this._spriteRequest=function(C,P,D){var N,K,re,ge=h.browser.devicePixelRatio>1?"@2x":"",ye=h.getJSON(P.transformRequest(P.normalizeSpriteURL(C,ge,".json"),h.ResourceType.SpriteJSON),function(Ue,tt){ye=null,re||(re=Ue,N=tt,We())}),we=h.getImage(P.transformRequest(P.normalizeSpriteURL(C,ge,".png"),h.ResourceType.SpriteImage),function(Ue,tt){we=null,re||(re=Ue,K=tt,We())});function We(){if(re)D(re);else if(N&&K){var Ue=h.browser.getImageData(K),tt={};for(var Ze in N){var $e=N[Ze],Ot=$e.width,Mt=$e.height,Sr=$e.x,qt=$e.y,gr=$e.sdf,Tr=$e.pixelRatio,Dr=$e.stretchX,nn=$e.stretchY,An=$e.content,Vn=new h.RGBAImage({width:Ot,height:Mt});h.RGBAImage.copy(Ue,Vn,{x:Sr,y:qt},{x:0,y:0},{width:Ot,height:Mt}),tt[Ze]={data:Vn,pixelRatio:Tr,sdf:gr,stretchX:Dr,stretchY:nn,content:An}}D(null,tt)}}return{cancel:function(){ye&&(ye.cancel(),ye=null),we&&(we.cancel(),we=null)}}}(l,this.map._requestManager,function(C,P){if(m._spriteRequest=null,C)m.fire(new h.ErrorEvent(C));else if(P)for(var D in P)m.imageManager.addImage(D,P[D]);m.imageManager.setLoaded(!0),m._availableImages=m.imageManager.listImages(),m.dispatcher.broadcast("setImages",m._availableImages),m.fire(new h.Event("data",{dataType:"style"}))})},f.prototype._validateLayer=function(l){var m=this.sourceCaches[l.source];if(m){var C=l.sourceLayer;if(C){var P=m.getSource();(P.type==="geojson"||P.vectorLayerIds&&P.vectorLayerIds.indexOf(C)===-1)&&this.fire(new h.ErrorEvent(new Error('Source layer "'+C+'" does not exist on source "'+P.id+'" as specified by style layer "'+l.id+'"')))}}},f.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()},f.prototype._serializeLayers=function(l){for(var m=[],C=0,P=l;C<P.length;C+=1){var D=this._layers[P[C]];D.type!=="custom"&&m.push(D.serialize())}return m},f.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(var m in this._layers)if(this._layers[m].hasTransition())return!0;return!1},f.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},f.prototype.update=function(l){if(this._loaded){var m=this._changed;if(this._changed){var C=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);for(var D in(C.length||P.length)&&this._updateWorkerLayers(C,P),this._updatedSources){var N=this._updatedSources[D];N==="reload"?this._reloadSource(D):N==="clear"&&this._clearSource(D)}for(var K in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[K].updateTransitions(l);this.light.updateTransitions(l),this._resetUpdates()}var re={};for(var ge in this.sourceCaches){var ye=this.sourceCaches[ge];re[ge]=ye.used,ye.used=!1}for(var we=0,We=this._order;we<We.length;we+=1){var Ue=this._layers[We[we]];Ue.recalculate(l,this._availableImages),!Ue.isHidden(l.zoom)&&Ue.source&&(this.sourceCaches[Ue.source].used=!0)}for(var tt in re){var Ze=this.sourceCaches[tt];re[tt]!==Ze.used&&Ze.fire(new h.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:tt}))}this.light.recalculate(l),this.z=l.zoom,m&&this.fire(new h.Event("data",{dataType:"style"}))}},f.prototype._updateTilesForChangedImages=function(){var l=Object.keys(this._changedImages);if(l.length){for(var m in this.sourceCaches)this.sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}},f.prototype._updateWorkerLayers=function(l,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:m})},f.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},f.prototype.setState=function(l){var m=this;if(this._checkLoaded(),au(this,h.validateStyle(l)))return!1;(l=h.clone$1(l)).layers=Rn(l.layers);var C=function(D,N){if(!D)return[{command:Nn.setStyle,args:[N]}];var K=[];try{if(!h.deepEqual(D.version,N.version))return[{command:Nn.setStyle,args:[N]}];h.deepEqual(D.center,N.center)||K.push({command:Nn.setCenter,args:[N.center]}),h.deepEqual(D.zoom,N.zoom)||K.push({command:Nn.setZoom,args:[N.zoom]}),h.deepEqual(D.bearing,N.bearing)||K.push({command:Nn.setBearing,args:[N.bearing]}),h.deepEqual(D.pitch,N.pitch)||K.push({command:Nn.setPitch,args:[N.pitch]}),h.deepEqual(D.sprite,N.sprite)||K.push({command:Nn.setSprite,args:[N.sprite]}),h.deepEqual(D.glyphs,N.glyphs)||K.push({command:Nn.setGlyphs,args:[N.glyphs]}),h.deepEqual(D.transition,N.transition)||K.push({command:Nn.setTransition,args:[N.transition]}),h.deepEqual(D.light,N.light)||K.push({command:Nn.setLight,args:[N.light]});var re={},ge=[];(function(we,We,Ue,tt){var Ze;for(Ze in We=We||{},we=we||{})we.hasOwnProperty(Ze)&&(We.hasOwnProperty(Ze)||Hn(Ze,Ue,tt));for(Ze in We)We.hasOwnProperty(Ze)&&(we.hasOwnProperty(Ze)?h.deepEqual(we[Ze],We[Ze])||(we[Ze].type==="geojson"&&We[Ze].type==="geojson"&&Sa(we,We,Ze)?Ue.push({command:Nn.setGeoJSONSourceData,args:[Ze,We[Ze].data]}):ha(Ze,We,Ue,tt)):Gi(Ze,We,Ue))})(D.sources,N.sources,ge,re);var ye=[];D.layers&&D.layers.forEach(function(we){re[we.source]?K.push({command:Nn.removeLayer,args:[we.id]}):ye.push(we)}),K=K.concat(ge),function(we,We,Ue){We=We||[];var tt,Ze,$e,Ot,Mt,Sr,qt,gr=(we=we||[]).map(ei),Tr=We.map(ei),Dr=we.reduce(ua,{}),nn=We.reduce(ua,{}),An=gr.slice(),Vn=Object.create(null);for(tt=0,Ze=0;tt<gr.length;tt++)nn.hasOwnProperty($e=gr[tt])?Ze++:(Ue.push({command:Nn.removeLayer,args:[$e]}),An.splice(An.indexOf($e,Ze),1));for(tt=0,Ze=0;tt<Tr.length;tt++)An[An.length-1-tt]!==($e=Tr[Tr.length-1-tt])&&(Dr.hasOwnProperty($e)?(Ue.push({command:Nn.removeLayer,args:[$e]}),An.splice(An.lastIndexOf($e,An.length-Ze),1)):Ze++,Ue.push({command:Nn.addLayer,args:[nn[$e],Sr=An[An.length-tt]]}),An.splice(An.length-tt,0,$e),Vn[$e]=!0);for(tt=0;tt<Tr.length;tt++)if(Ot=Dr[$e=Tr[tt]],Mt=nn[$e],!Vn[$e]&&!h.deepEqual(Ot,Mt))if(h.deepEqual(Ot.source,Mt.source)&&h.deepEqual(Ot["source-layer"],Mt["source-layer"])&&h.deepEqual(Ot.type,Mt.type)){for(qt in Ji(Ot.layout,Mt.layout,Ue,$e,null,Nn.setLayoutProperty),Ji(Ot.paint,Mt.paint,Ue,$e,null,Nn.setPaintProperty),h.deepEqual(Ot.filter,Mt.filter)||Ue.push({command:Nn.setFilter,args:[$e,Mt.filter]}),h.deepEqual(Ot.minzoom,Mt.minzoom)&&h.deepEqual(Ot.maxzoom,Mt.maxzoom)||Ue.push({command:Nn.setLayerZoomRange,args:[$e,Mt.minzoom,Mt.maxzoom]}),Ot)Ot.hasOwnProperty(qt)&&qt!=="layout"&&qt!=="paint"&&qt!=="filter"&&qt!=="metadata"&&qt!=="minzoom"&&qt!=="maxzoom"&&(qt.indexOf("paint.")===0?Ji(Ot[qt],Mt[qt],Ue,$e,qt.slice(6),Nn.setPaintProperty):h.deepEqual(Ot[qt],Mt[qt])||Ue.push({command:Nn.setLayerProperty,args:[$e,qt,Mt[qt]]}));for(qt in Mt)Mt.hasOwnProperty(qt)&&!Ot.hasOwnProperty(qt)&&qt!=="layout"&&qt!=="paint"&&qt!=="filter"&&qt!=="metadata"&&qt!=="minzoom"&&qt!=="maxzoom"&&(qt.indexOf("paint.")===0?Ji(Ot[qt],Mt[qt],Ue,$e,qt.slice(6),Nn.setPaintProperty):h.deepEqual(Ot[qt],Mt[qt])||Ue.push({command:Nn.setLayerProperty,args:[$e,qt,Mt[qt]]}))}else Ue.push({command:Nn.removeLayer,args:[$e]}),Sr=An[An.lastIndexOf($e)+1],Ue.push({command:Nn.addLayer,args:[Mt,Sr]})}(ye,N.layers,K)}catch(we){console.warn("Unable to compute style diff:",we),K=[{command:Nn.setStyle,args:[N]}]}return K}(this.serialize(),l).filter(function(D){return!(D.command in cl)});if(C.length===0)return!1;var P=C.filter(function(D){return!(D.command in js)});if(P.length>0)throw new Error("Unimplemented: "+P.map(function(D){return D.command}).join(", ")+".");return C.forEach(function(D){D.command!=="setTransition"&&m[D.command].apply(m,D.args)}),this.stylesheet=l,!0},f.prototype.addImage=function(l,m){if(this.getImage(l))return this.fire(new h.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(l,m),this._afterImageUpdated(l)},f.prototype.updateImage=function(l,m){this.imageManager.updateImage(l,m)},f.prototype.getImage=function(l){return this.imageManager.getImage(l)},f.prototype.removeImage=function(l){if(!this.getImage(l))return this.fire(new h.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(l),this._afterImageUpdated(l)},f.prototype._afterImageUpdated=function(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))},f.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},f.prototype.addSource=function(l,m,C){var P=this;if(C===void 0&&(C={}),this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error("There is already a source with this ID");if(!m.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(m).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(h.validateStyle.source,"sources."+l,m,null,C))){this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);var D=this.sourceCaches[l]=new Ye(l,m,this.dispatcher);D.style=this,D.setEventedParent(this,function(){return{isSourceLoaded:P.loaded(),source:D.serialize(),sourceId:l}}),D.onAdd(this.map),this._changed=!0}},f.prototype.removeSource=function(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(var m in this._layers)if(this._layers[m].source===l)return this.fire(new h.ErrorEvent(new Error('Source "'+l+'" cannot be removed while layer "'+m+'" is using it.')));var C=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],C.fire(new h.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),C.setEventedParent(null),C.clearTiles(),C.onRemove&&C.onRemove(this.map),this._changed=!0},f.prototype.setGeoJSONSourceData=function(l,m){this._checkLoaded(),this.sourceCaches[l].getSource().setData(m),this._changed=!0},f.prototype.getSource=function(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()},f.prototype.addLayer=function(l,m,C){C===void 0&&(C={}),this._checkLoaded();var P=l.id;if(this.getLayer(P))this.fire(new h.ErrorEvent(new Error('Layer with id "'+P+'" already exists on this map')));else{var D;if(l.type==="custom"){if(au(this,h.validateCustomStyleLayer(l)))return;D=h.createStyleLayer(l)}else{if(typeof l.source=="object"&&(this.addSource(P,l.source),l=h.clone$1(l),l=h.extend(l,{source:P})),this._validate(h.validateStyle.layer,"layers."+P,l,{arrayIndex:-1},C))return;D=h.createStyleLayer(l),this._validateLayer(D),D.setEventedParent(this,{layer:{id:P}}),this._serializedLayers[D.id]=D.serialize()}var N=m?this._order.indexOf(m):this._order.length;if(m&&N===-1)this.fire(new h.ErrorEvent(new Error('Layer with id "'+m+'" does not exist on this map.')));else{if(this._order.splice(N,0,P),this._layerOrderChanged=!0,this._layers[P]=D,this._removedLayers[P]&&D.source&&D.type!=="custom"){var K=this._removedLayers[P];delete this._removedLayers[P],K.type!==D.type?this._updatedSources[D.source]="clear":(this._updatedSources[D.source]="reload",this.sourceCaches[D.source].pause())}this._updateLayer(D),D.onAdd&&D.onAdd(this.map)}}},f.prototype.moveLayer=function(l,m){if(this._checkLoaded(),this._changed=!0,this._layers[l]){if(l!==m){var C=this._order.indexOf(l);this._order.splice(C,1);var P=m?this._order.indexOf(m):this._order.length;m&&P===-1?this.fire(new h.ErrorEvent(new Error('Layer with id "'+m+'" does not exist on this map.'))):(this._order.splice(P,0,l),this._layerOrderChanged=!0)}}else this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be moved.")))},f.prototype.removeLayer=function(l){this._checkLoaded();var m=this._layers[l];if(m){m.setEventedParent(null);var C=this._order.indexOf(l);this._order.splice(C,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=m,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],m.onRemove&&m.onRemove(this.map)}else this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be removed.")))},f.prototype.getLayer=function(l){return this._layers[l]},f.prototype.hasLayer=function(l){return l in this._layers},f.prototype.setLayerZoomRange=function(l,m,C){this._checkLoaded();var P=this.getLayer(l);P?P.minzoom===m&&P.maxzoom===C||(m!=null&&(P.minzoom=m),C!=null&&(P.maxzoom=C),this._updateLayer(P)):this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot have zoom extent.")))},f.prototype.setFilter=function(l,m,C){C===void 0&&(C={}),this._checkLoaded();var P=this.getLayer(l);if(P){if(!h.deepEqual(P.filter,m))return m==null?(P.filter=void 0,void this._updateLayer(P)):void(this._validate(h.validateStyle.filter,"layers."+P.id+".filter",m,null,C)||(P.filter=h.clone$1(m),this._updateLayer(P)))}else this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be filtered.")))},f.prototype.getFilter=function(l){return h.clone$1(this.getLayer(l).filter)},f.prototype.setLayoutProperty=function(l,m,C,P){P===void 0&&(P={}),this._checkLoaded();var D=this.getLayer(l);D?h.deepEqual(D.getLayoutProperty(m),C)||(D.setLayoutProperty(m,C,P),this._updateLayer(D)):this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getLayoutProperty=function(l,m){var C=this.getLayer(l);if(C)return C.getLayoutProperty(m);this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style.")))},f.prototype.setPaintProperty=function(l,m,C,P){P===void 0&&(P={}),this._checkLoaded();var D=this.getLayer(l);D?h.deepEqual(D.getPaintProperty(m),C)||(D.setPaintProperty(m,C,P)&&this._updateLayer(D),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new h.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getPaintProperty=function(l,m){return this.getLayer(l).getPaintProperty(m)},f.prototype.setFeatureState=function(l,m){this._checkLoaded();var C=l.source,P=l.sourceLayer,D=this.sourceCaches[C];if(D!==void 0){var N=D.getSource().type;N==="geojson"&&P?this.fire(new h.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):N!=="vector"||P?(l.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),D.setFeatureState(P,l.id,m)):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+C+"' does not exist in the map's style.")))},f.prototype.removeFeatureState=function(l,m){this._checkLoaded();var C=l.source,P=this.sourceCaches[C];if(P!==void 0){var D=P.getSource().type,N=D==="vector"?l.sourceLayer:void 0;D!=="vector"||N?m&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new h.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):P.removeFeatureState(N,l.id,m):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+C+"' does not exist in the map's style.")))},f.prototype.getFeatureState=function(l){this._checkLoaded();var m=l.source,C=l.sourceLayer,P=this.sourceCaches[m];if(P!==void 0){if(P.getSource().type!=="vector"||C)return l.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),P.getFeatureState(C,l.id);this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},f.prototype.getTransition=function(){return h.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},f.prototype.serialize=function(){return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:h.mapObject(this.sourceCaches,function(l){return l.serialize()}),layers:this._serializeLayers(this._order)},function(l){return l!==void 0})},f.prototype._updateLayer=function(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._changed=!0},f.prototype._flattenAndSortRenderedFeatures=function(l){for(var m=this,C=function(nn){return m._layers[nn].type==="fill-extrusion"},P={},D=[],N=this._order.length-1;N>=0;N--){var K=this._order[N];if(C(K)){P[K]=N;for(var re=0,ge=l;re<ge.length;re+=1){var ye=ge[re][K];if(ye)for(var we=0,We=ye;we<We.length;we+=1)D.push(We[we])}}}D.sort(function(Dr,nn){return nn.intersectionZ-Dr.intersectionZ});for(var Ue=[],tt=this._order.length-1;tt>=0;tt--){var Ze=this._order[tt];if(C(Ze))for(var $e=D.length-1;$e>=0;$e--){var Ot=D[$e].feature;if(P[Ot.layer.id]<tt)break;Ue.push(Ot),D.pop()}else for(var Mt=0,Sr=l;Mt<Sr.length;Mt+=1){var qt=Sr[Mt][Ze];if(qt)for(var gr=0,Tr=qt;gr<Tr.length;gr+=1)Ue.push(Tr[gr].feature)}}return Ue},f.prototype.queryRenderedFeatures=function(l,m,C){m&&m.filter&&this._validate(h.validateStyle.filter,"queryRenderedFeatures.filter",m.filter,null,m);var P={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new h.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var D=0,N=m.layers;D<N.length;D+=1){var K=N[D],re=this._layers[K];if(!re)return this.fire(new h.ErrorEvent(new Error("The layer '"+K+"' does not exist in the map's style and cannot be queried for features."))),[];P[re.source]=!0}}var ge=[];for(var ye in m.availableImages=this._availableImages,this.sourceCaches)m.layers&&!P[ye]||ge.push(Xt(this.sourceCaches[ye],this._layers,this._serializedLayers,l,m,C));return this.placement&&ge.push(function(we,We,Ue,tt,Ze,$e,Ot){for(var Mt={},Sr=$e.queryRenderedSymbols(tt),qt=[],gr=0,Tr=Object.keys(Sr).map(Number);gr<Tr.length;gr+=1)qt.push(Ot[Tr[gr]]);qt.sort(It);for(var Dr=function(){var Ni=An[nn],Ii=Ni.featureIndex.lookupSymbolFeatures(Sr[Ni.bucketInstanceId],We,Ni.bucketIndex,Ni.sourceLayerIndex,Ze.filter,Ze.layers,Ze.availableImages,we);for(var $n in Ii){var zi=Mt[$n]=Mt[$n]||[],Wi=Ii[$n];Wi.sort(function(Ai,na){var wa=Ni.featureSortOrder;if(wa){var rs=wa.indexOf(Ai.featureIndex);return wa.indexOf(na.featureIndex)-rs}return na.featureIndex-Ai.featureIndex});for(var ui=0,ea=Wi;ui<ea.length;ui+=1)zi.push(ea[ui])}},nn=0,An=qt;nn<An.length;nn+=1)Dr();var Vn=function(Ni){Mt[Ni].forEach(function(Ii){var $n=Ii.feature,zi=Ue[we[Ni].source].getFeatureState($n.layer["source-layer"],$n.id);$n.source=$n.layer.source,$n.layer["source-layer"]&&($n.sourceLayer=$n.layer["source-layer"]),$n.state=zi})};for(var mi in Mt)Vn(mi);return Mt}(this._layers,this._serializedLayers,this.sourceCaches,l,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(ge)},f.prototype.querySourceFeatures=function(l,m){m&&m.filter&&this._validate(h.validateStyle.filter,"querySourceFeatures.filter",m.filter,null,m);var C=this.sourceCaches[l];return C?function(P,D){for(var N=P.getRenderableIds().map(function(We){return P.getTileByID(We)}),K=[],re={},ge=0;ge<N.length;ge++){var ye=N[ge],we=ye.tileID.canonical.key;re[we]||(re[we]=!0,ye.querySourceFeatures(K,D))}return K}(C,m):[]},f.prototype.addSourceType=function(l,m,C){return f.getSourceType(l)?C(new Error('A source type called "'+l+'" already exists.')):(f.setSourceType(l,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:m.workerSourceURL},C):C(null,null))},f.prototype.getLight=function(){return this.light.getLight()},f.prototype.setLight=function(l,m){m===void 0&&(m={}),this._checkLoaded();var C=this.light.getLight(),P=!1;for(var D in l)if(!h.deepEqual(l[D],C[D])){P=!0;break}if(P){var N={now:h.browser.now(),transition:h.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,m),this.light.updateTransitions(N)}},f.prototype._validate=function(l,m,C,P,D){return D===void 0&&(D={}),(!D||D.validate!==!1)&&au(this,l.call(h.validateStyle,h.extend({key:m,style:this.serialize(),value:C,styleSpec:h.styleSpec},P)))},f.prototype._remove=function(){for(var l in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),h.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[l].setEventedParent(null);for(var m in this.sourceCaches)this.sourceCaches[m].clearTiles(),this.sourceCaches[m].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},f.prototype._clearSource=function(l){this.sourceCaches[l].clearTiles()},f.prototype._reloadSource=function(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()},f.prototype._updateSources=function(l){for(var m in this.sourceCaches)this.sourceCaches[m].update(l)},f.prototype._generateCollisionBoxes=function(){for(var l in this.sourceCaches)this._reloadSource(l)},f.prototype._updatePlacement=function(l,m,C,P,D){D===void 0&&(D=!1);for(var N=!1,K=!1,re={},ge=0,ye=this._order;ge<ye.length;ge+=1){var we=this._layers[ye[ge]];if(we.type==="symbol"){if(!re[we.source]){var We=this.sourceCaches[we.source];re[we.source]=We.getRenderableIds(!0).map(function(Ot){return We.getTileByID(Ot)}).sort(function(Ot,Mt){return Mt.tileID.overscaledZ-Ot.tileID.overscaledZ||(Ot.tileID.isLessThan(Mt.tileID)?-1:1)})}var Ue=this.crossTileSymbolIndex.addLayer(we,re[we.source],l.center.lng);N=N||Ue}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((D=D||this._layerOrderChanged||C===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(h.browser.now(),l.zoom))&&(this.pauseablePlacement=new qo(l,this._order,D,m,C,P,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,re),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(h.browser.now()),K=!0),N&&this.pauseablePlacement.placement.setStale()),K||N)for(var tt=0,Ze=this._order;tt<Ze.length;tt+=1){var $e=this._layers[Ze[tt]];$e.type==="symbol"&&this.placement.updateLayerOpacities($e,re[$e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(h.browser.now())},f.prototype._releaseSymbolFadeTiles=function(){for(var l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()},f.prototype.getImages=function(l,m,C){this.imageManager.getImages(m.icons,C),this._updateTilesForChangedImages();var P=this.sourceCaches[m.source];P&&P.setDependencies(m.tileID.key,m.type,m.icons)},f.prototype.getGlyphs=function(l,m,C){this.glyphManager.getGlyphs(m.stacks,C)},f.prototype.getResource=function(l,m,C){return h.makeRequest(m,C)},f}(h.Evented);co.getSourceType=function(d){return br[d]},co.setSourceType=function(d,f){br[d]=f},co.registerForPluginStateChange=h.registerForPluginStateChange;var Po=h.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ha=Ma(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Wa=Ma(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Yh=Ma(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Bc=Ma(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Nc=Ma("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),xl=Ma(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),bl=Ma(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),b=Ma("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),L=Ma("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),X=Ma("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),B=Ma(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),se=Ma(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Le=Ma(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ot=Ma(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Et=Ma(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Pt=Ma(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),zr=Ma(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Kr=Ma(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),oi=Ma(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ki=Ma(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Li=Ma(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Oa=Ma(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),sa=Ma(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Va=Ma(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Qo=Ma(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),yu=Ma(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Ma(d,f){var l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=f.match(/attribute ([\w]+) ([\w]+)/g),C=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),D=P?P.concat(C):C,N={};return{fragmentSource:d=d.replace(l,function(K,re,ge,ye,we){return N[we]=!0,re==="define"?`
#ifndef HAS_UNIFORM_u_`+we+`
varying `+ge+" "+ye+" "+we+`;
#else
uniform `+ge+" "+ye+" u_"+we+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+we+`
    `+ge+" "+ye+" "+we+" = u_"+we+`;
#endif
`}),vertexSource:f=f.replace(l,function(K,re,ge,ye,we){var We=ye==="float"?"vec2":"vec4",Ue=we.match(/color/)?"color":We;return N[we]?re==="define"?`
#ifndef HAS_UNIFORM_u_`+we+`
uniform lowp float u_`+we+`_t;
attribute `+ge+" "+We+" a_"+we+`;
varying `+ge+" "+ye+" "+we+`;
#else
uniform `+ge+" "+ye+" u_"+we+`;
#endif
`:Ue==="vec4"?`
#ifndef HAS_UNIFORM_u_`+we+`
    `+we+" = a_"+we+`;
#else
    `+ge+" "+ye+" "+we+" = u_"+we+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+we+`
    `+we+" = unpack_mix_"+Ue+"(a_"+we+", u_"+we+`_t);
#else
    `+ge+" "+ye+" "+we+" = u_"+we+`;
#endif
`:re==="define"?`
#ifndef HAS_UNIFORM_u_`+we+`
uniform lowp float u_`+we+`_t;
attribute `+ge+" "+We+" a_"+we+`;
#else
uniform `+ge+" "+ye+" u_"+we+`;
#endif
`:Ue==="vec4"?`
#ifndef HAS_UNIFORM_u_`+we+`
    `+ge+" "+ye+" "+we+" = a_"+we+`;
#else
    `+ge+" "+ye+" "+we+" = u_"+we+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+we+`
    `+ge+" "+ye+" "+we+" = unpack_mix_"+Ue+"(a_"+we+", u_"+we+`_t);
#else
    `+ge+" "+ye+" "+we+" = u_"+we+`;
#endif
`}),staticAttributes:m,staticUniforms:D}}var Jo=Object.freeze({__proto__:null,prelude:Ha,background:Wa,backgroundPattern:Yh,circle:Bc,clippingMask:Nc,heatmap:xl,heatmapTexture:bl,collisionBox:b,collisionCircle:L,debug:X,fill:B,fillOutline:se,fillOutlinePattern:Le,fillPattern:ot,fillExtrusion:Et,fillExtrusionPattern:Pt,hillshadePrepare:zr,hillshade:Kr,line:oi,lineGradient:Ki,linePattern:Li,lineSDF:Oa,raster:sa,symbolIcon:Va,symbolSDF:Qo,symbolTextAndIcon:yu}),_c=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function tc(d){for(var f=[],l=0;l<d.length;l++)if(d[l]!==null){var m=d[l].split(" ");f.push(m.pop())}return f}_c.prototype.bind=function(d,f,l,m,C,P,D,N){this.context=d;for(var K=this.boundPaintVertexBuffers.length!==m.length,re=0;!K&&re<m.length;re++)this.boundPaintVertexBuffers[re]!==m[re]&&(K=!0);d.extVertexArrayObject&&this.vao&&this.boundProgram===f&&this.boundLayoutVertexBuffer===l&&!K&&this.boundIndexBuffer===C&&this.boundVertexOffset===P&&this.boundDynamicVertexBuffer===D&&this.boundDynamicVertexBuffer2===N?(d.bindVertexArrayOES.set(this.vao),D&&D.bind(),C&&C.dynamicDraw&&C.bind(),N&&N.bind()):this.freshBind(f,l,m,C,P,D,N)},_c.prototype.freshBind=function(d,f,l,m,C,P,D){var N,K=d.numAttributes,re=this.context,ge=re.gl;if(re.extVertexArrayObject)this.vao&&this.destroy(),this.vao=re.extVertexArrayObject.createVertexArrayOES(),re.bindVertexArrayOES.set(this.vao),N=0,this.boundProgram=d,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=m,this.boundVertexOffset=C,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=D;else{N=re.currentNumAttributes||0;for(var ye=K;ye<N;ye++)ge.disableVertexAttribArray(ye)}f.enableAttributes(ge,d);for(var we=0,We=l;we<We.length;we+=1)We[we].enableAttributes(ge,d);P&&P.enableAttributes(ge,d),D&&D.enableAttributes(ge,d),f.bind(),f.setVertexAttribPointers(ge,d,C);for(var Ue=0,tt=l;Ue<tt.length;Ue+=1){var Ze=tt[Ue];Ze.bind(),Ze.setVertexAttribPointers(ge,d,C)}P&&(P.bind(),P.setVertexAttribPointers(ge,d,C)),m&&m.bind(),D&&(D.bind(),D.setVertexAttribPointers(ge,d,C)),re.currentNumAttributes=K},_c.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Eo=function(f,l,m,C,P,D){var N=f.gl;this.program=N.createProgram();for(var K=tc(m.staticAttributes),re=C?C.getBinderAttributes():[],ge=K.concat(re),ye=m.staticUniforms?tc(m.staticUniforms):[],we=C?C.getBinderUniforms():[],We=[],Ue=0,tt=ye.concat(we);Ue<tt.length;Ue+=1){var Ze=tt[Ue];We.indexOf(Ze)<0&&We.push(Ze)}var $e=C?C.defines():[];D&&$e.push("#define OVERDRAW_INSPECTOR;");var Ot=$e.concat(Ha.fragmentSource,m.fragmentSource).join(`
`),Mt=$e.concat(Ha.vertexSource,m.vertexSource).join(`
`),Sr=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())this.failedToCreate=!0;else{N.shaderSource(Sr,Ot),N.compileShader(Sr),N.attachShader(this.program,Sr);var qt=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())this.failedToCreate=!0;else{N.shaderSource(qt,Mt),N.compileShader(qt),N.attachShader(this.program,qt),this.attributes={};var gr={};this.numAttributes=ge.length;for(var Tr=0;Tr<this.numAttributes;Tr++)ge[Tr]&&(N.bindAttribLocation(this.program,Tr,ge[Tr]),this.attributes[ge[Tr]]=Tr);N.linkProgram(this.program),N.deleteShader(qt),N.deleteShader(Sr);for(var Dr=0;Dr<We.length;Dr++){var nn=We[Dr];if(nn&&!gr[nn]){var An=N.getUniformLocation(this.program,nn);An&&(gr[nn]=An)}}this.fixedUniforms=P(f,gr),this.binderUniforms=C?C.getUniforms(f,gr):[]}}};function El(d,f,l){var m=1/qr(l,1,f.transform.tileZoom),C=Math.pow(2,l.tileID.overscaledZ),P=l.tileSize*Math.pow(2,f.transform.tileZoom)/C,D=P*(l.tileID.canonical.x+l.tileID.wrap*C),N=P*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[m,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[D>>16,N>>16],u_pixel_coord_lower:[65535&D,65535&N]}}Eo.prototype.draw=function(d,f,l,m,C,P,D,N,K,re,ge,ye,we,We,Ue,tt){var Ze,$e=d.gl;if(!this.failedToCreate){for(var Ot in d.program.set(this.program),d.setDepthMode(l),d.setStencilMode(m),d.setColorMode(C),d.setCullFace(P),this.fixedUniforms)this.fixedUniforms[Ot].set(D[Ot]);We&&We.setUniforms(d,this.binderUniforms,ye,{zoom:we});for(var Mt=(Ze={},Ze[$e.LINES]=2,Ze[$e.TRIANGLES]=3,Ze[$e.LINE_STRIP]=1,Ze)[f],Sr=0,qt=ge.get();Sr<qt.length;Sr+=1){var gr=qt[Sr],Tr=gr.vaos||(gr.vaos={});(Tr[N]||(Tr[N]=new _c)).bind(d,this,K,We?We.getPaintVertexBuffers():[],re,gr.vertexOffset,Ue,tt),$e.drawElements(f,gr.primitiveLength*Mt,$e.UNSIGNED_SHORT,gr.primitiveOffset*Mt*2)}}};var wf=function(f,l,m,C){var P=l.style.light,D=P.properties.get("position"),N=[D.x,D.y,D.z],K=h.create$1();P.properties.get("anchor")==="viewport"&&h.fromRotation(K,-l.transform.angle),h.transformMat3(N,N,K);var re=P.properties.get("color");return{u_matrix:f,u_lightpos:N,u_lightintensity:P.properties.get("intensity"),u_lightcolor:[re.r,re.g,re.b],u_vertical_gradient:+m,u_opacity:C}},Sl=function(f,l,m,C,P,D,N){return h.extend(wf(f,l,m,C),El(D,l,N),{u_height_factor:-Math.pow(2,P.overscaledZ)/N.tileSize/8})},xa=function(f){return{u_matrix:f}},Fl=function(f,l,m,C){return h.extend(xa(f),El(m,l,C))},Ah=function(f,l){return{u_matrix:f,u_world:l}},fs=function(f,l,m,C,P){return h.extend(Fl(f,l,m,C),{u_world:P})},Af=function(f,l,m,C){var P,D,N=f.transform;if(C.paint.get("circle-pitch-alignment")==="map"){var K=qr(m,1,N.zoom);P=!0,D=[K,K]}else P=!1,D=N.pixelsToGLUnits;return{u_camera_to_center_distance:N.cameraToCenterDistance,u_scale_with_map:+(C.paint.get("circle-pitch-scale")==="map"),u_matrix:f.translatePosMatrix(l.posMatrix,m,C.paint.get("circle-translate"),C.paint.get("circle-translate-anchor")),u_pitch_with_map:+P,u_device_pixel_ratio:h.browser.devicePixelRatio,u_extrude_scale:D}},tl=function(f,l,m){var C=qr(m,1,l.zoom),P=Math.pow(2,l.zoom-m.tileID.overscaledZ),D=m.tileID.overscaleFactor();return{u_matrix:f,u_camera_to_center_distance:l.cameraToCenterDistance,u_pixels_to_tile_units:C,u_extrude_scale:[l.pixelsToGLUnits[0]/(C*P),l.pixelsToGLUnits[1]/(C*P)],u_overscale_factor:D}},fl=function(f,l,m){return{u_matrix:f,u_inv_matrix:l,u_camera_to_center_distance:m.cameraToCenterDistance,u_viewport_size:[m.width,m.height]}},xc=function(f,l,m){return m===void 0&&(m=1),{u_matrix:f,u_color:l,u_overlay:0,u_overlay_scale:m}},Bl=function(f){return{u_matrix:f}},zc=function(f,l,m,C){return{u_matrix:f,u_extrude_scale:qr(l,1,m),u_intensity:C}},Nl=function(f,l,m){var C=f.transform;return{u_matrix:Th(f,l,m),u_ratio:1/qr(l,1,C.zoom),u_device_pixel_ratio:h.browser.devicePixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},fo=function(f,l,m,C){return h.extend(Nl(f,l,m),{u_image:0,u_image_height:C})},nf=function(f,l,m,C){var P=f.transform,D=Uc(l,P);return{u_matrix:Th(f,l,m),u_texsize:l.imageAtlasTexture.size,u_ratio:1/qr(l,1,P.zoom),u_device_pixel_ratio:h.browser.devicePixelRatio,u_image:0,u_scale:[D,C.fromScale,C.toScale],u_fade:C.t,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]]}},Ap=function(f,l,m,C,P){var D=f.lineAtlas,N=Uc(l,f.transform),K=m.layout.get("line-cap")==="round",re=D.getDash(C.from,K),ge=D.getDash(C.to,K),ye=re.width*P.fromScale,we=ge.width*P.toScale;return h.extend(Nl(f,l,m),{u_patternscale_a:[N/ye,-re.height/2],u_patternscale_b:[N/we,-ge.height/2],u_sdfgamma:D.width/(256*Math.min(ye,we)*h.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:re.y,u_tex_y_b:ge.y,u_mix:P.t})};function Uc(d,f){return 1/qr(d,1,f.tileZoom)}function Th(d,f,l){return d.translatePosMatrix(f.tileID.posMatrix,f,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}var Kp=function(f,l,m,C,P){return{u_matrix:f,u_tl_parent:l,u_scale_parent:m,u_buffer_scale:1,u_fade_t:C.mix,u_opacity:C.opacity*P.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:P.paint.get("raster-brightness-min"),u_brightness_high:P.paint.get("raster-brightness-max"),u_saturation_factor:(N=P.paint.get("raster-saturation"),N>0?1-1/(1.001-N):-N),u_contrast_factor:(D=P.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:Kh(P.paint.get("raster-hue-rotate"))};var D,N};function Kh(d){d*=Math.PI/180;var f=Math.sin(d),l=Math.cos(d);return[(2*l+1)/3,(-Math.sqrt(3)*f-l+1)/3,(Math.sqrt(3)*f-l+1)/3]}var ou,zl=function(f,l,m,C,P,D,N,K,re,ge){var ye=P.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:ye.cameraToCenterDistance,u_pitch:ye.pitch/360*2*Math.PI,u_rotate_symbol:+m,u_aspect_ratio:ye.width/ye.height,u_fade_change:P.options.fadeDuration?P.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:N,u_coord_matrix:K,u_is_text:+re,u_pitch_with_map:+C,u_texsize:ge,u_texture:0}},hl=function(f,l,m,C,P,D,N,K,re,ge,ye){var we=P.transform;return h.extend(zl(f,l,m,C,P,D,N,K,re,ge),{u_gamma_scale:C?Math.cos(we._pitch)*we.cameraToCenterDistance:1,u_device_pixel_ratio:h.browser.devicePixelRatio,u_is_halo:+ye})},jc=function(f,l,m,C,P,D,N,K,re,ge){return h.extend(hl(f,l,m,C,P,D,N,K,!0,re,!0),{u_texsize_icon:ge,u_texture_icon:1})},Ul=function(f,l,m){return{u_matrix:f,u_opacity:l,u_color:m}},af=function(f,l,m,C,P,D){return h.extend(function(N,K,re,ge){var ye=re.imageManager.getPattern(N.from.toString()),we=re.imageManager.getPattern(N.to.toString()),We=re.imageManager.getPixelSize(),Ue=We.width,tt=We.height,Ze=Math.pow(2,ge.tileID.overscaledZ),$e=ge.tileSize*Math.pow(2,re.transform.tileZoom)/Ze,Ot=$e*(ge.tileID.canonical.x+ge.tileID.wrap*Ze),Mt=$e*ge.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:ye.tl,u_pattern_br_a:ye.br,u_pattern_tl_b:we.tl,u_pattern_br_b:we.br,u_texsize:[Ue,tt],u_mix:K.t,u_pattern_size_a:ye.displaySize,u_pattern_size_b:we.displaySize,u_scale_a:K.fromScale,u_scale_b:K.toScale,u_tile_units_to_pixels:1/qr(ge,1,re.transform.tileZoom),u_pixel_coord_upper:[Ot>>16,Mt>>16],u_pixel_coord_lower:[65535&Ot,65535&Mt]}}(C,D,m,P),{u_matrix:f,u_opacity:l})},Mh={fillExtrusion:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_lightpos:new h.Uniform3f(f,l.u_lightpos),u_lightintensity:new h.Uniform1f(f,l.u_lightintensity),u_lightcolor:new h.Uniform3f(f,l.u_lightcolor),u_vertical_gradient:new h.Uniform1f(f,l.u_vertical_gradient),u_opacity:new h.Uniform1f(f,l.u_opacity)}},fillExtrusionPattern:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_lightpos:new h.Uniform3f(f,l.u_lightpos),u_lightintensity:new h.Uniform1f(f,l.u_lightintensity),u_lightcolor:new h.Uniform3f(f,l.u_lightcolor),u_vertical_gradient:new h.Uniform1f(f,l.u_vertical_gradient),u_height_factor:new h.Uniform1f(f,l.u_height_factor),u_image:new h.Uniform1i(f,l.u_image),u_texsize:new h.Uniform2f(f,l.u_texsize),u_pixel_coord_upper:new h.Uniform2f(f,l.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(f,l.u_pixel_coord_lower),u_scale:new h.Uniform3f(f,l.u_scale),u_fade:new h.Uniform1f(f,l.u_fade),u_opacity:new h.Uniform1f(f,l.u_opacity)}},fill:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix)}},fillPattern:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_image:new h.Uniform1i(f,l.u_image),u_texsize:new h.Uniform2f(f,l.u_texsize),u_pixel_coord_upper:new h.Uniform2f(f,l.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(f,l.u_pixel_coord_lower),u_scale:new h.Uniform3f(f,l.u_scale),u_fade:new h.Uniform1f(f,l.u_fade)}},fillOutline:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_world:new h.Uniform2f(f,l.u_world)}},fillOutlinePattern:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_world:new h.Uniform2f(f,l.u_world),u_image:new h.Uniform1i(f,l.u_image),u_texsize:new h.Uniform2f(f,l.u_texsize),u_pixel_coord_upper:new h.Uniform2f(f,l.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(f,l.u_pixel_coord_lower),u_scale:new h.Uniform3f(f,l.u_scale),u_fade:new h.Uniform1f(f,l.u_fade)}},circle:function(f,l){return{u_camera_to_center_distance:new h.Uniform1f(f,l.u_camera_to_center_distance),u_scale_with_map:new h.Uniform1i(f,l.u_scale_with_map),u_pitch_with_map:new h.Uniform1i(f,l.u_pitch_with_map),u_extrude_scale:new h.Uniform2f(f,l.u_extrude_scale),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_matrix:new h.UniformMatrix4f(f,l.u_matrix)}},collisionBox:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_camera_to_center_distance:new h.Uniform1f(f,l.u_camera_to_center_distance),u_pixels_to_tile_units:new h.Uniform1f(f,l.u_pixels_to_tile_units),u_extrude_scale:new h.Uniform2f(f,l.u_extrude_scale),u_overscale_factor:new h.Uniform1f(f,l.u_overscale_factor)}},collisionCircle:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_inv_matrix:new h.UniformMatrix4f(f,l.u_inv_matrix),u_camera_to_center_distance:new h.Uniform1f(f,l.u_camera_to_center_distance),u_viewport_size:new h.Uniform2f(f,l.u_viewport_size)}},debug:function(f,l){return{u_color:new h.UniformColor(f,l.u_color),u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_overlay:new h.Uniform1i(f,l.u_overlay),u_overlay_scale:new h.Uniform1f(f,l.u_overlay_scale)}},clippingMask:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix)}},heatmap:function(f,l){return{u_extrude_scale:new h.Uniform1f(f,l.u_extrude_scale),u_intensity:new h.Uniform1f(f,l.u_intensity),u_matrix:new h.UniformMatrix4f(f,l.u_matrix)}},heatmapTexture:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_world:new h.Uniform2f(f,l.u_world),u_image:new h.Uniform1i(f,l.u_image),u_color_ramp:new h.Uniform1i(f,l.u_color_ramp),u_opacity:new h.Uniform1f(f,l.u_opacity)}},hillshade:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_image:new h.Uniform1i(f,l.u_image),u_latrange:new h.Uniform2f(f,l.u_latrange),u_light:new h.Uniform2f(f,l.u_light),u_shadow:new h.UniformColor(f,l.u_shadow),u_highlight:new h.UniformColor(f,l.u_highlight),u_accent:new h.UniformColor(f,l.u_accent)}},hillshadePrepare:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_image:new h.Uniform1i(f,l.u_image),u_dimension:new h.Uniform2f(f,l.u_dimension),u_zoom:new h.Uniform1f(f,l.u_zoom),u_unpack:new h.Uniform4f(f,l.u_unpack)}},line:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_ratio:new h.Uniform1f(f,l.u_ratio),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(f,l.u_units_to_pixels)}},lineGradient:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_ratio:new h.Uniform1f(f,l.u_ratio),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(f,l.u_units_to_pixels),u_image:new h.Uniform1i(f,l.u_image),u_image_height:new h.Uniform1f(f,l.u_image_height)}},linePattern:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_texsize:new h.Uniform2f(f,l.u_texsize),u_ratio:new h.Uniform1f(f,l.u_ratio),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_image:new h.Uniform1i(f,l.u_image),u_units_to_pixels:new h.Uniform2f(f,l.u_units_to_pixels),u_scale:new h.Uniform3f(f,l.u_scale),u_fade:new h.Uniform1f(f,l.u_fade)}},lineSDF:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_ratio:new h.Uniform1f(f,l.u_ratio),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(f,l.u_units_to_pixels),u_patternscale_a:new h.Uniform2f(f,l.u_patternscale_a),u_patternscale_b:new h.Uniform2f(f,l.u_patternscale_b),u_sdfgamma:new h.Uniform1f(f,l.u_sdfgamma),u_image:new h.Uniform1i(f,l.u_image),u_tex_y_a:new h.Uniform1f(f,l.u_tex_y_a),u_tex_y_b:new h.Uniform1f(f,l.u_tex_y_b),u_mix:new h.Uniform1f(f,l.u_mix)}},raster:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_tl_parent:new h.Uniform2f(f,l.u_tl_parent),u_scale_parent:new h.Uniform1f(f,l.u_scale_parent),u_buffer_scale:new h.Uniform1f(f,l.u_buffer_scale),u_fade_t:new h.Uniform1f(f,l.u_fade_t),u_opacity:new h.Uniform1f(f,l.u_opacity),u_image0:new h.Uniform1i(f,l.u_image0),u_image1:new h.Uniform1i(f,l.u_image1),u_brightness_low:new h.Uniform1f(f,l.u_brightness_low),u_brightness_high:new h.Uniform1f(f,l.u_brightness_high),u_saturation_factor:new h.Uniform1f(f,l.u_saturation_factor),u_contrast_factor:new h.Uniform1f(f,l.u_contrast_factor),u_spin_weights:new h.Uniform3f(f,l.u_spin_weights)}},symbolIcon:function(f,l){return{u_is_size_zoom_constant:new h.Uniform1i(f,l.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(f,l.u_is_size_feature_constant),u_size_t:new h.Uniform1f(f,l.u_size_t),u_size:new h.Uniform1f(f,l.u_size),u_camera_to_center_distance:new h.Uniform1f(f,l.u_camera_to_center_distance),u_pitch:new h.Uniform1f(f,l.u_pitch),u_rotate_symbol:new h.Uniform1i(f,l.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(f,l.u_aspect_ratio),u_fade_change:new h.Uniform1f(f,l.u_fade_change),u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(f,l.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(f,l.u_coord_matrix),u_is_text:new h.Uniform1i(f,l.u_is_text),u_pitch_with_map:new h.Uniform1i(f,l.u_pitch_with_map),u_texsize:new h.Uniform2f(f,l.u_texsize),u_texture:new h.Uniform1i(f,l.u_texture)}},symbolSDF:function(f,l){return{u_is_size_zoom_constant:new h.Uniform1i(f,l.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(f,l.u_is_size_feature_constant),u_size_t:new h.Uniform1f(f,l.u_size_t),u_size:new h.Uniform1f(f,l.u_size),u_camera_to_center_distance:new h.Uniform1f(f,l.u_camera_to_center_distance),u_pitch:new h.Uniform1f(f,l.u_pitch),u_rotate_symbol:new h.Uniform1i(f,l.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(f,l.u_aspect_ratio),u_fade_change:new h.Uniform1f(f,l.u_fade_change),u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(f,l.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(f,l.u_coord_matrix),u_is_text:new h.Uniform1i(f,l.u_is_text),u_pitch_with_map:new h.Uniform1i(f,l.u_pitch_with_map),u_texsize:new h.Uniform2f(f,l.u_texsize),u_texture:new h.Uniform1i(f,l.u_texture),u_gamma_scale:new h.Uniform1f(f,l.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(f,l.u_is_halo)}},symbolTextAndIcon:function(f,l){return{u_is_size_zoom_constant:new h.Uniform1i(f,l.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(f,l.u_is_size_feature_constant),u_size_t:new h.Uniform1f(f,l.u_size_t),u_size:new h.Uniform1f(f,l.u_size),u_camera_to_center_distance:new h.Uniform1f(f,l.u_camera_to_center_distance),u_pitch:new h.Uniform1f(f,l.u_pitch),u_rotate_symbol:new h.Uniform1i(f,l.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(f,l.u_aspect_ratio),u_fade_change:new h.Uniform1f(f,l.u_fade_change),u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(f,l.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(f,l.u_coord_matrix),u_is_text:new h.Uniform1i(f,l.u_is_text),u_pitch_with_map:new h.Uniform1i(f,l.u_pitch_with_map),u_texsize:new h.Uniform2f(f,l.u_texsize),u_texsize_icon:new h.Uniform2f(f,l.u_texsize_icon),u_texture:new h.Uniform1i(f,l.u_texture),u_texture_icon:new h.Uniform1i(f,l.u_texture_icon),u_gamma_scale:new h.Uniform1f(f,l.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(f,l.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(f,l.u_is_halo)}},background:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_opacity:new h.Uniform1f(f,l.u_opacity),u_color:new h.UniformColor(f,l.u_color)}},backgroundPattern:function(f,l){return{u_matrix:new h.UniformMatrix4f(f,l.u_matrix),u_opacity:new h.Uniform1f(f,l.u_opacity),u_image:new h.Uniform1i(f,l.u_image),u_pattern_tl_a:new h.Uniform2f(f,l.u_pattern_tl_a),u_pattern_br_a:new h.Uniform2f(f,l.u_pattern_br_a),u_pattern_tl_b:new h.Uniform2f(f,l.u_pattern_tl_b),u_pattern_br_b:new h.Uniform2f(f,l.u_pattern_br_b),u_texsize:new h.Uniform2f(f,l.u_texsize),u_mix:new h.Uniform1f(f,l.u_mix),u_pattern_size_a:new h.Uniform2f(f,l.u_pattern_size_a),u_pattern_size_b:new h.Uniform2f(f,l.u_pattern_size_b),u_scale_a:new h.Uniform1f(f,l.u_scale_a),u_scale_b:new h.Uniform1f(f,l.u_scale_b),u_pixel_coord_upper:new h.Uniform2f(f,l.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(f,l.u_pixel_coord_lower),u_tile_units_to_pixels:new h.Uniform1f(f,l.u_tile_units_to_pixels)}}};function of(d,f,l,m,C,P,D){for(var N=d.context,K=N.gl,re=d.useProgram("collisionBox"),ge=[],ye=0,we=0,We=0;We<m.length;We++){var Ue=m[We],tt=f.getTile(Ue),Ze=tt.getBucket(l);if(Ze){var $e=Ue.posMatrix;C[0]===0&&C[1]===0||($e=d.translatePosMatrix(Ue.posMatrix,tt,C,P));var Ot=D?Ze.textCollisionBox:Ze.iconCollisionBox,Mt=Ze.collisionCircleArray;if(Mt.length>0){var Sr=h.create(),qt=$e;h.mul(Sr,Ze.placementInvProjMatrix,d.transform.glCoordMatrix),h.mul(Sr,Sr,Ze.placementViewportMatrix),ge.push({circleArray:Mt,circleOffset:we,transform:qt,invTransform:Sr}),we=ye+=Mt.length/4}Ot&&re.draw(N,K.LINES,Me.disabled,Ve.disabled,d.colorModeForRenderPass(),Ct.disabled,tl($e,d.transform,tt),l.id,Ot.layoutVertexBuffer,Ot.indexBuffer,Ot.segments,null,d.transform.zoom,null,null,Ot.collisionVertexBuffer)}}if(D&&ge.length){var gr=d.useProgram("collisionCircle"),Tr=new h.StructArrayLayout2f1f2i16;Tr.resize(4*ye),Tr._trim();for(var Dr=0,nn=0,An=ge;nn<An.length;nn+=1)for(var Vn=An[nn],mi=0;mi<Vn.circleArray.length/4;mi++){var yi=4*mi,Ni=Vn.circleArray[yi+0],Ii=Vn.circleArray[yi+1],$n=Vn.circleArray[yi+2],zi=Vn.circleArray[yi+3];Tr.emplace(Dr++,Ni,Ii,$n,zi,0),Tr.emplace(Dr++,Ni,Ii,$n,zi,1),Tr.emplace(Dr++,Ni,Ii,$n,zi,2),Tr.emplace(Dr++,Ni,Ii,$n,zi,3)}(!ou||ou.length<2*ye)&&(ou=function(rs){var ka=2*rs,ms=new h.StructArrayLayout3ui6;ms.resize(ka),ms._trim();for(var Oo=0;Oo<ka;Oo++){var Ja=6*Oo;ms.uint16[Ja+0]=4*Oo+0,ms.uint16[Ja+1]=4*Oo+1,ms.uint16[Ja+2]=4*Oo+2,ms.uint16[Ja+3]=4*Oo+2,ms.uint16[Ja+4]=4*Oo+3,ms.uint16[Ja+5]=4*Oo+0}return ms}(ye));for(var Wi=N.createIndexBuffer(ou,!0),ui=N.createVertexBuffer(Tr,h.collisionCircleLayout.members,!0),ea=0,Ai=ge;ea<Ai.length;ea+=1){var na=Ai[ea],wa=fl(na.transform,na.invTransform,d.transform);gr.draw(N,K.TRIANGLES,Me.disabled,Ve.disabled,d.colorModeForRenderPass(),Ct.disabled,wa,l.id,ui,Wi,h.SegmentVector.simpleSegment(0,2*na.circleOffset,na.circleArray.length,na.circleArray.length/2),null,d.transform.zoom,null,null,null)}ui.destroy(),Wi.destroy()}}var es=h.identity(new Float32Array(16));function $h(d,f,l,m,C,P){var D=h.getAnchorAlignment(d),N=-(D.horizontalAlign-.5)*f,K=-(D.verticalAlign-.5)*l,re=h.evaluateVariableOffset(d,m);return new h.Point((N/C+re[0])*P,(K/C+re[1])*P)}function Vc(d,f,l,m,C,P,D,N,K,re,ge){var ye=d.text.placedSymbolArray,we=d.text.dynamicLayoutVertexArray,We=d.icon.dynamicLayoutVertexArray,Ue={};we.clear();for(var tt=0;tt<ye.length;tt++){var Ze=ye.get(tt),$e=Ze.hidden||!Ze.crossTileID||d.allowVerticalPlacement&&!Ze.placedOrientation?null:m[Ze.crossTileID];if($e){var Ot=new h.Point(Ze.anchorX,Ze.anchorY),Mt=Qi(Ot,l?N:D),Sr=Bi(P.cameraToCenterDistance,Mt.signedDistanceFromCamera),qt=C.evaluateSizeForFeature(d.textSizeData,re,Ze)*Sr/h.ONE_EM;l&&(qt*=d.tilePixelRatio/K);for(var gr=$h($e.anchor,$e.width,$e.height,$e.textOffset,$e.textBoxScale,qt),Tr=l?Qi(Ot.add(gr),D).point:Mt.point.add(f?gr.rotate(-P.angle):gr),Dr=d.allowVerticalPlacement&&Ze.placedOrientation===h.WritingMode.vertical?Math.PI/2:0,nn=0;nn<Ze.numGlyphs;nn++)h.addDynamicAttributes(we,Tr,Dr);ge&&Ze.associatedIconIndex>=0&&(Ue[Ze.associatedIconIndex]={shiftedAnchor:Tr,angle:Dr})}else vo(Ze.numGlyphs,we)}if(ge){We.clear();for(var An=d.icon.placedSymbolArray,Vn=0;Vn<An.length;Vn++){var mi=An.get(Vn);if(mi.hidden)vo(mi.numGlyphs,We);else{var yi=Ue[Vn];if(yi)for(var Ni=0;Ni<mi.numGlyphs;Ni++)h.addDynamicAttributes(We,yi.shiftedAnchor,yi.angle);else vo(mi.numGlyphs,We)}}d.icon.dynamicLayoutVertexBuffer.updateData(We)}d.text.dynamicLayoutVertexBuffer.updateData(we)}function qh(d,f,l){return l.iconsInText&&f?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function rc(d,f,l,m,C,P,D,N,K,re,ge,ye){for(var we=d.context,We=we.gl,Ue=d.transform,tt=N==="map",Ze=K==="map",$e=tt&&l.layout.get("symbol-placement")!=="point",Ot=tt&&!Ze&&!$e,Mt=l.layout.get("symbol-sort-key").constantOr(1)!==void 0,Sr=!1,qt=d.depthModeForSublayer(0,Me.ReadOnly),gr=l.layout.get("text-variable-anchor"),Tr=[],Dr=0,nn=m;Dr<nn.length;Dr+=1){var An=nn[Dr],Vn=f.getTile(An),mi=Vn.getBucket(l);if(mi){var yi=C?mi.text:mi.icon;if(yi&&yi.segments.get().length){var Ni=yi.programConfigurations.get(l.id),Ii=C||mi.sdfIcons,$n=C?mi.textSizeData:mi.iconSizeData,zi=Ze||Ue.pitch!==0,Wi=d.useProgram(qh(Ii,C,mi),Ni),ui=h.evaluateSizeForZoom($n,Ue.zoom),ea=void 0,Ai=[0,0],na=void 0,wa=void 0,rs=null,ka=void 0;if(C)na=Vn.glyphAtlasTexture,wa=We.LINEAR,ea=Vn.glyphAtlasTexture.size,mi.iconsInText&&(Ai=Vn.imageAtlasTexture.size,rs=Vn.imageAtlasTexture,ka=zi||d.options.rotating||d.options.zooming||$n.kind==="composite"||$n.kind==="camera"?We.LINEAR:We.NEAREST);else{var ms=l.layout.get("icon-size").constantOr(0)!==1||mi.iconsNeedLinear;na=Vn.imageAtlasTexture,wa=Ii||d.options.rotating||d.options.zooming||ms||zi?We.LINEAR:We.NEAREST,ea=Vn.imageAtlasTexture.size}var Oo=qr(Vn,1,d.transform.zoom),Ja=zo(An.posMatrix,Ze,tt,d.transform,Oo),Eu=Ei(An.posMatrix,Ze,tt,d.transform,Oo),ho=gr&&mi.hasTextData(),Yu=l.layout.get("icon-text-fit")!=="none"&&ho&&mi.hasIconData();$e&&Ho(mi,An.posMatrix,d,C,Ja,Eu,Ze,re);var Su=d.translatePosMatrix(An.posMatrix,Vn,P,D),go=$e||C&&gr||Yu?es:Ja,Ws=d.translatePosMatrix(Eu,Vn,P,D,!0),Es=Ii&&l.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Lu={program:Wi,buffers:yi,uniformValues:Ii?mi.iconsInText?jc($n.kind,ui,Ot,Ze,d,Su,go,Ws,ea,Ai):hl($n.kind,ui,Ot,Ze,d,Su,go,Ws,C,ea,!0):zl($n.kind,ui,Ot,Ze,d,Su,go,Ws,C,ea),atlasTexture:na,atlasTextureIcon:rs,atlasInterpolation:wa,atlasInterpolationIcon:ka,isSDF:Ii,hasHalo:Es};if(Mt&&mi.canOverlap){Sr=!0;for(var oc=0,sc=yi.segments.get();oc<sc.length;oc+=1){var Tc=sc[oc];Tr.push({segments:new h.SegmentVector([Tc]),sortKey:Tc.sortKey,state:Lu})}}else Tr.push({segments:yi.segments,sortKey:0,state:Lu})}}}Sr&&Tr.sort(function(rh,uc){return rh.sortKey-uc.sortKey});for(var ku=0,Xc=Tr;ku<Xc.length;ku+=1){var Ol=Xc[ku],Ps=Ol.state;if(we.activeTexture.set(We.TEXTURE0),Ps.atlasTexture.bind(Ps.atlasInterpolation,We.CLAMP_TO_EDGE),Ps.atlasTextureIcon&&(we.activeTexture.set(We.TEXTURE1),Ps.atlasTextureIcon&&Ps.atlasTextureIcon.bind(Ps.atlasInterpolationIcon,We.CLAMP_TO_EDGE)),Ps.isSDF){var Ku=Ps.uniformValues;Ps.hasHalo&&(Ku.u_is_halo=1,nc(Ps.buffers,Ol.segments,l,d,Ps.program,qt,ge,ye,Ku)),Ku.u_is_halo=0}nc(Ps.buffers,Ol.segments,l,d,Ps.program,qt,ge,ye,Ps.uniformValues)}}function nc(d,f,l,m,C,P,D,N,K){var re=m.context;C.draw(re,re.gl.TRIANGLES,P,D,N,Ct.disabled,K,l.id,d.layoutVertexBuffer,d.indexBuffer,f,l.paint,m.transform.zoom,d.programConfigurations.get(l.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function Tf(d,f,l,m,C,P,D){var N,K,re,ge,ye,we=d.context.gl,We=l.paint.get("fill-pattern"),Ue=We&&We.constantOr(1),tt=l.getCrossfadeParameters();D?(K=Ue&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=we.LINES):(K=Ue?"fillPattern":"fill",N=we.TRIANGLES);for(var Ze=0,$e=m;Ze<$e.length;Ze+=1){var Ot=$e[Ze],Mt=f.getTile(Ot);if(!Ue||Mt.patternsLoaded()){var Sr=Mt.getBucket(l);if(Sr){var qt=Sr.programConfigurations.get(l.id),gr=d.useProgram(K,qt);Ue&&(d.context.activeTexture.set(we.TEXTURE0),Mt.imageAtlasTexture.bind(we.LINEAR,we.CLAMP_TO_EDGE),qt.updatePaintBuffers(tt));var Tr=We.constantOr(null);if(Tr&&Mt.imageAtlas){var Dr=Mt.imageAtlas,nn=Dr.patternPositions[Tr.to.toString()],An=Dr.patternPositions[Tr.from.toString()];nn&&An&&qt.setConstantPatternPositions(nn,An)}var Vn=d.translatePosMatrix(Ot.posMatrix,Mt,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));if(D){ge=Sr.indexBuffer2,ye=Sr.segments2;var mi=[we.drawingBufferWidth,we.drawingBufferHeight];re=K==="fillOutlinePattern"&&Ue?fs(Vn,d,tt,Mt,mi):Ah(Vn,mi)}else ge=Sr.indexBuffer,ye=Sr.segments,re=Ue?Fl(Vn,d,tt,Mt):xa(Vn);gr.draw(d.context,N,C,d.stencilModeForClipping(Ot),P,Ct.disabled,re,l.id,Sr.layoutVertexBuffer,ge,ye,l.paint,d.transform.zoom,qt)}}}}function ic(d,f,l,m,C,P,D){for(var N=d.context,K=N.gl,re=l.paint.get("fill-extrusion-pattern"),ge=re.constantOr(1),ye=l.getCrossfadeParameters(),we=l.paint.get("fill-extrusion-opacity"),We=0,Ue=m;We<Ue.length;We+=1){var tt=Ue[We],Ze=f.getTile(tt),$e=Ze.getBucket(l);if($e){var Ot=$e.programConfigurations.get(l.id),Mt=d.useProgram(ge?"fillExtrusionPattern":"fillExtrusion",Ot);ge&&(d.context.activeTexture.set(K.TEXTURE0),Ze.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Ot.updatePaintBuffers(ye));var Sr=re.constantOr(null);if(Sr&&Ze.imageAtlas){var qt=Ze.imageAtlas,gr=qt.patternPositions[Sr.to.toString()],Tr=qt.patternPositions[Sr.from.toString()];gr&&Tr&&Ot.setConstantPatternPositions(gr,Tr)}var Dr=d.translatePosMatrix(tt.posMatrix,Ze,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),nn=l.paint.get("fill-extrusion-vertical-gradient"),An=ge?Sl(Dr,d,nn,we,tt,ye,Ze):wf(Dr,d,nn,we);Mt.draw(N,N.gl.TRIANGLES,C,P,D,Ct.backCCW,An,l.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,l.paint,d.transform.zoom,Ot)}}}function sf(d,f,l,m,C,P){var D=d.context,N=D.gl,K=f.fbo;if(K){var re=d.useProgram("hillshade");D.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,K.colorAttachment.get());var ge=function(ye,we,We){var Ue=We.paint.get("hillshade-shadow-color"),tt=We.paint.get("hillshade-highlight-color"),Ze=We.paint.get("hillshade-accent-color"),$e=We.paint.get("hillshade-illumination-direction")*(Math.PI/180);We.paint.get("hillshade-illumination-anchor")==="viewport"&&($e-=ye.transform.angle);var Ot,Mt,Sr,qt=!ye.options.moving;return{u_matrix:ye.transform.calculatePosMatrix(we.tileID.toUnwrapped(),qt),u_image:0,u_latrange:(Ot=we.tileID,Mt=Math.pow(2,Ot.canonical.z),Sr=Ot.canonical.y,[new h.MercatorCoordinate(0,Sr/Mt).toLngLat().lat,new h.MercatorCoordinate(0,(Sr+1)/Mt).toLngLat().lat]),u_light:[We.paint.get("hillshade-exaggeration"),$e],u_shadow:Ue,u_highlight:tt,u_accent:Ze}}(d,f,l);re.draw(D,N.TRIANGLES,m,C,P,Ct.disabled,ge,l.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}}function $f(d,f,l,m,C,P){var D=d.context,N=D.gl,K=f.dem;if(K&&K.data){var re=K.dim,ge=K.stride,ye=K.getPixels();if(D.activeTexture.set(N.TEXTURE1),D.pixelStoreUnpackPremultiplyAlpha.set(!1),f.demTexture=f.demTexture||d.getTileTexture(ge),f.demTexture){var we=f.demTexture;we.update(ye,{premultiply:!1}),we.bind(N.NEAREST,N.CLAMP_TO_EDGE)}else f.demTexture=new h.Texture(D,ye,N.RGBA,{premultiply:!1}),f.demTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE);D.activeTexture.set(N.TEXTURE0);var We=f.fbo;if(!We){var Ue=new h.Texture(D,{width:re,height:re,data:null},N.RGBA);Ue.bind(N.LINEAR,N.CLAMP_TO_EDGE),(We=f.fbo=D.createFramebuffer(re,re,!0)).colorAttachment.set(Ue.texture)}D.bindFramebuffer.set(We.framebuffer),D.viewport.set([0,0,re,re]),d.useProgram("hillshadePrepare").draw(D,N.TRIANGLES,m,C,P,Ct.disabled,function(tt,Ze){var $e=Ze.stride,Ot=h.create();return h.ortho(Ot,0,h.EXTENT,-h.EXTENT,0,0,1),h.translate(Ot,Ot,[0,-h.EXTENT,0]),{u_matrix:Ot,u_image:1,u_dimension:[$e,$e],u_zoom:tt.overscaledZ,u_unpack:Ze.getUnpackVector()}}(f.tileID,K),l.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments),f.needsHillshadePrepare=!1}}function qf(d,f,l,m,C){var P=m.paint.get("raster-fade-duration");if(P>0){var D=h.browser.now(),N=(D-d.timeAdded)/P,K=f?(D-f.timeAdded)/P:-1,re=l.getSource(),ge=C.coveringZoomLevel({tileSize:re.tileSize,roundZoom:re.roundZoom}),ye=!f||Math.abs(f.tileID.overscaledZ-ge)>Math.abs(d.tileID.overscaledZ-ge),we=ye&&d.refreshedUponExpiration?1:h.clamp(ye?N:1-K,0,1);return d.refreshedUponExpiration&&N>=1&&(d.refreshedUponExpiration=!1),f?{opacity:1,mix:1-we}:{opacity:we,mix:0}}return{opacity:1,mix:0}}var Qf=new h.Color(1,0,0,1),jl=new h.Color(0,1,0,1),Cl=new h.Color(0,0,1,1),Mf=new h.Color(1,0,1,1),Qh=new h.Color(0,1,1,1);function Jf(d,f,l,m){eh(d,0,f+l/2,d.transform.width,l,m)}function Jh(d,f,l,m){eh(d,f-l/2,0,l,d.transform.height,m)}function eh(d,f,l,m,C,P){var D=d.context,N=D.gl;N.enable(N.SCISSOR_TEST),N.scissor(f*h.browser.devicePixelRatio,l*h.browser.devicePixelRatio,m*h.browser.devicePixelRatio,C*h.browser.devicePixelRatio),D.clear({color:P}),N.disable(N.SCISSOR_TEST)}function Pf(d,f,l){var m=d.context,C=m.gl,P=l.posMatrix,D=d.useProgram("debug"),N=Me.disabled,K=Ve.disabled,re=d.colorModeForRenderPass();m.activeTexture.set(C.TEXTURE0),d.emptyTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),D.draw(m,C.LINE_STRIP,N,K,re,Ct.disabled,xc(P,h.Color.red),"$debug",d.debugBuffer,d.tileBorderIndexBuffer,d.debugSegments);var ge=f.getTileByID(l.key).latestRawTileData,ye=Math.floor((ge&&ge.byteLength||0)/1024),we=f.getTile(l).tileSize,We=512/Math.min(we,512)*(l.overscaledZ/d.transform.zoom)*.5,Ue=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(Ue+=" => "+l.overscaledZ),function(tt,Ze){tt.initDebugOverlayCanvas();var $e=tt.debugOverlayCanvas,Ot=tt.context.gl,Mt=tt.debugOverlayCanvas.getContext("2d");Mt.clearRect(0,0,$e.width,$e.height),Mt.shadowColor="white",Mt.shadowBlur=2,Mt.lineWidth=1.5,Mt.strokeStyle="white",Mt.textBaseline="top",Mt.font="bold 36px Open Sans, sans-serif",Mt.fillText(Ze,5,5),Mt.strokeText(Ze,5,5),tt.debugOverlayTexture.update($e),tt.debugOverlayTexture.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE)}(d,Ue+" "+ye+"kb"),D.draw(m,C.TRIANGLES,N,K,ft.alphaBlended,Ct.disabled,xc(P,h.Color.transparent,We),"$debug",d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments)}var wl={symbol:function(f,l,m,C,P){if(f.renderPass==="translucent"){var D=Ve.disabled,N=f.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(K,re,ge,ye,we,We,Ue){for(var tt=re.transform,Ze=we==="map",$e=We==="map",Ot=0,Mt=K;Ot<Mt.length;Ot+=1){var Sr=Mt[Ot],qt=ye.getTile(Sr),gr=qt.getBucket(ge);if(gr&&gr.text&&gr.text.segments.get().length){var Tr=h.evaluateSizeForZoom(gr.textSizeData,tt.zoom),Dr=qr(qt,1,re.transform.zoom),nn=zo(Sr.posMatrix,$e,Ze,re.transform,Dr),An=ge.layout.get("icon-text-fit")!=="none"&&gr.hasIconData();if(Tr){var Vn=Math.pow(2,tt.zoom-qt.tileID.overscaledZ);Vc(gr,Ze,$e,Ue,h.symbolSize,tt,nn,Sr.posMatrix,Vn,Tr,An)}}}}(C,f,m,l,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),P),m.paint.get("icon-opacity").constantOr(1)!==0&&rc(f,l,m,C,!1,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),m.layout.get("icon-rotation-alignment"),m.layout.get("icon-pitch-alignment"),m.layout.get("icon-keep-upright"),D,N),m.paint.get("text-opacity").constantOr(1)!==0&&rc(f,l,m,C,!0,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),m.layout.get("text-keep-upright"),D,N),l.map.showCollisionBoxes&&(of(f,l,m,C,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),of(f,l,m,C,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))}},circle:function(f,l,m,C){if(f.renderPass==="translucent"){var P=m.paint.get("circle-opacity"),D=m.paint.get("circle-stroke-width"),N=m.paint.get("circle-stroke-opacity"),K=m.layout.get("circle-sort-key").constantOr(1)!==void 0;if(P.constantOr(1)!==0||D.constantOr(1)!==0&&N.constantOr(1)!==0){for(var re=f.context,ge=re.gl,ye=f.depthModeForSublayer(0,Me.ReadOnly),we=Ve.disabled,We=f.colorModeForRenderPass(),Ue=[],tt=0;tt<C.length;tt++){var Ze=C[tt],$e=l.getTile(Ze),Ot=$e.getBucket(m);if(Ot){var Mt=Ot.programConfigurations.get(m.id),Sr={programConfiguration:Mt,program:f.useProgram("circle",Mt),layoutVertexBuffer:Ot.layoutVertexBuffer,indexBuffer:Ot.indexBuffer,uniformValues:Af(f,Ze,$e,m)};if(K)for(var qt=0,gr=Ot.segments.get();qt<gr.length;qt+=1){var Tr=gr[qt];Ue.push({segments:new h.SegmentVector([Tr]),sortKey:Tr.sortKey,state:Sr})}else Ue.push({segments:Ot.segments,sortKey:0,state:Sr})}}K&&Ue.sort(function(mi,yi){return mi.sortKey-yi.sortKey});for(var Dr=0,nn=Ue;Dr<nn.length;Dr+=1){var An=nn[Dr],Vn=An.state;Vn.program.draw(re,ge.TRIANGLES,ye,we,We,Ct.disabled,Vn.uniformValues,m.id,Vn.layoutVertexBuffer,Vn.indexBuffer,An.segments,m.paint,f.transform.zoom,Vn.programConfiguration)}}}},heatmap:function(f,l,m,C){if(m.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){var P=f.context,D=P.gl,N=Ve.disabled,K=new ft([D.ONE,D.ONE],h.Color.transparent,[!0,!0,!0,!0]);(function(Ue,tt,Ze){var $e=Ue.gl;Ue.activeTexture.set($e.TEXTURE1),Ue.viewport.set([0,0,tt.width/4,tt.height/4]);var Ot=Ze.heatmapFbo;if(Ot)$e.bindTexture($e.TEXTURE_2D,Ot.colorAttachment.get()),Ue.bindFramebuffer.set(Ot.framebuffer);else{var Mt=$e.createTexture();$e.bindTexture($e.TEXTURE_2D,Mt),$e.texParameteri($e.TEXTURE_2D,$e.TEXTURE_WRAP_S,$e.CLAMP_TO_EDGE),$e.texParameteri($e.TEXTURE_2D,$e.TEXTURE_WRAP_T,$e.CLAMP_TO_EDGE),$e.texParameteri($e.TEXTURE_2D,$e.TEXTURE_MIN_FILTER,$e.LINEAR),$e.texParameteri($e.TEXTURE_2D,$e.TEXTURE_MAG_FILTER,$e.LINEAR),Ot=Ze.heatmapFbo=Ue.createFramebuffer(tt.width/4,tt.height/4,!1),function(Sr,qt,gr,Tr){var Dr=Sr.gl;Dr.texImage2D(Dr.TEXTURE_2D,0,Dr.RGBA,qt.width/4,qt.height/4,0,Dr.RGBA,Sr.extRenderToTextureHalfFloat?Sr.extTextureHalfFloat.HALF_FLOAT_OES:Dr.UNSIGNED_BYTE,null),Tr.colorAttachment.set(gr)}(Ue,tt,Mt,Ot)}})(P,f,m),P.clear({color:h.Color.transparent});for(var re=0;re<C.length;re++){var ge=C[re];if(!l.hasRenderableParent(ge)){var ye=l.getTile(ge),we=ye.getBucket(m);if(we){var We=we.programConfigurations.get(m.id);f.useProgram("heatmap",We).draw(P,D.TRIANGLES,Me.disabled,N,K,Ct.disabled,zc(ge.posMatrix,ye,f.transform.zoom,m.paint.get("heatmap-intensity")),m.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,m.paint,f.transform.zoom,We)}}}P.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(Ue,tt){var Ze=Ue.context,$e=Ze.gl,Ot=tt.heatmapFbo;if(Ot){Ze.activeTexture.set($e.TEXTURE0),$e.bindTexture($e.TEXTURE_2D,Ot.colorAttachment.get()),Ze.activeTexture.set($e.TEXTURE1);var Mt=tt.colorRampTexture;Mt||(Mt=tt.colorRampTexture=new h.Texture(Ze,tt.colorRamp,$e.RGBA)),Mt.bind($e.LINEAR,$e.CLAMP_TO_EDGE),Ue.useProgram("heatmapTexture").draw(Ze,$e.TRIANGLES,Me.disabled,Ve.disabled,Ue.colorModeForRenderPass(),Ct.disabled,function(Sr,qt,gr,Tr){var Dr=h.create();h.ortho(Dr,0,Sr.width,Sr.height,0,0,1);var nn=Sr.context.gl;return{u_matrix:Dr,u_world:[nn.drawingBufferWidth,nn.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:qt.paint.get("heatmap-opacity")}}(Ue,tt),tt.id,Ue.viewportBuffer,Ue.quadTriangleIndexBuffer,Ue.viewportSegments,tt.paint,Ue.transform.zoom)}}(f,m))},line:function(f,l,m,C){if(f.renderPass==="translucent"){var P=m.paint.get("line-opacity"),D=m.paint.get("line-width");if(P.constantOr(1)!==0&&D.constantOr(1)!==0)for(var N=f.depthModeForSublayer(0,Me.ReadOnly),K=f.colorModeForRenderPass(),re=m.paint.get("line-dasharray"),ge=m.paint.get("line-pattern"),ye=ge.constantOr(1),we=m.paint.get("line-gradient"),We=m.getCrossfadeParameters(),Ue=ye?"linePattern":re?"lineSDF":we?"lineGradient":"line",tt=f.context,Ze=tt.gl,$e=!0,Ot=0,Mt=C;Ot<Mt.length;Ot+=1){var Sr=Mt[Ot],qt=l.getTile(Sr);if(!ye||qt.patternsLoaded()){var gr=qt.getBucket(m);if(gr){var Tr=gr.programConfigurations.get(m.id),Dr=f.context.program.get(),nn=f.useProgram(Ue,Tr),An=$e||nn.program!==Dr,Vn=ge.constantOr(null);if(Vn&&qt.imageAtlas){var mi=qt.imageAtlas,yi=mi.patternPositions[Vn.to.toString()],Ni=mi.patternPositions[Vn.from.toString()];yi&&Ni&&Tr.setConstantPatternPositions(yi,Ni)}var Ii=ye?nf(f,qt,m,We):re?Ap(f,qt,m,re,We):we?fo(f,qt,m,gr.lineClipsArray.length):Nl(f,qt,m);if(ye)tt.activeTexture.set(Ze.TEXTURE0),qt.imageAtlasTexture.bind(Ze.LINEAR,Ze.CLAMP_TO_EDGE),Tr.updatePaintBuffers(We);else if(re&&(An||f.lineAtlas.dirty))tt.activeTexture.set(Ze.TEXTURE0),f.lineAtlas.bind(tt);else if(we){var $n=gr.gradients[m.id],zi=$n.texture;if(m.gradientVersion!==$n.version){var Wi=256;if(m.stepInterpolant){var ui=l.getSource().maxzoom,ea=Sr.canonical.z===ui?Math.ceil(1<<f.transform.maxZoom-Sr.canonical.z):1;Wi=h.clamp(h.nextPowerOfTwo(gr.maxLineLength/h.EXTENT*1024*ea),256,tt.maxTextureSize)}$n.gradient=h.renderColorRamp({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:Wi,image:$n.gradient||void 0,clips:gr.lineClipsArray}),$n.texture?$n.texture.update($n.gradient):$n.texture=new h.Texture(tt,$n.gradient,Ze.RGBA),$n.version=m.gradientVersion,zi=$n.texture}tt.activeTexture.set(Ze.TEXTURE0),zi.bind(m.stepInterpolant?Ze.NEAREST:Ze.LINEAR,Ze.CLAMP_TO_EDGE)}nn.draw(tt,Ze.TRIANGLES,N,f.stencilModeForClipping(Sr),K,Ct.disabled,Ii,m.id,gr.layoutVertexBuffer,gr.indexBuffer,gr.segments,m.paint,f.transform.zoom,Tr,gr.layoutVertexBuffer2),$e=!1}}}}},fill:function(f,l,m,C){var P=m.paint.get("fill-color"),D=m.paint.get("fill-opacity");if(D.constantOr(1)!==0){var N=f.colorModeForRenderPass(),K=m.paint.get("fill-pattern"),re=f.opaquePassEnabledForLayer()&&!K.constantOr(1)&&P.constantOr(h.Color.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===re){var ge=f.depthModeForSublayer(1,f.renderPass==="opaque"?Me.ReadWrite:Me.ReadOnly);Tf(f,l,m,C,ge,N,!1)}if(f.renderPass==="translucent"&&m.paint.get("fill-antialias")){var ye=f.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,Me.ReadOnly);Tf(f,l,m,C,ye,N,!0)}}},"fill-extrusion":function(f,l,m,C){var P=m.paint.get("fill-extrusion-opacity");if(P!==0&&f.renderPass==="translucent"){var D=new Me(f.context.gl.LEQUAL,Me.ReadWrite,f.depthRangeFor3D);if(P!==1||m.paint.get("fill-extrusion-pattern").constantOr(1))ic(f,l,m,C,D,Ve.disabled,ft.disabled),ic(f,l,m,C,D,f.stencilModeFor3D(),f.colorModeForRenderPass());else{var N=f.colorModeForRenderPass();ic(f,l,m,C,D,Ve.disabled,N)}}},hillshade:function(f,l,m,C){if(f.renderPass==="offscreen"||f.renderPass==="translucent"){for(var P=f.context,D=f.depthModeForSublayer(0,Me.ReadOnly),N=f.colorModeForRenderPass(),K=f.renderPass==="translucent"?f.stencilConfigForOverlap(C):[{},C],re=K[0],ge=0,ye=K[1];ge<ye.length;ge+=1){var we=ye[ge],We=l.getTile(we);We.needsHillshadePrepare&&f.renderPass==="offscreen"?$f(f,We,m,D,Ve.disabled,N):f.renderPass==="translucent"&&sf(f,We,m,D,re[we.overscaledZ],N)}P.viewport.set([0,0,f.width,f.height])}},raster:function(f,l,m,C){if(f.renderPass==="translucent"&&m.paint.get("raster-opacity")!==0&&C.length)for(var P=f.context,D=P.gl,N=l.getSource(),K=f.useProgram("raster"),re=f.colorModeForRenderPass(),ge=N instanceof mt?[{},C]:f.stencilConfigForOverlap(C),ye=ge[0],we=ge[1],We=we[we.length-1].overscaledZ,Ue=!f.options.moving,tt=0,Ze=we;tt<Ze.length;tt+=1){var $e=Ze[tt],Ot=f.depthModeForSublayer($e.overscaledZ-We,m.paint.get("raster-opacity")===1?Me.ReadWrite:Me.ReadOnly,D.LESS),Mt=l.getTile($e),Sr=f.transform.calculatePosMatrix($e.toUnwrapped(),Ue);Mt.registerFadeDuration(m.paint.get("raster-fade-duration"));var qt=l.findLoadedParent($e,0),gr=qf(Mt,qt,l,m,f.transform),Tr=void 0,Dr=void 0,nn=m.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;P.activeTexture.set(D.TEXTURE0),Mt.texture.bind(nn,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),P.activeTexture.set(D.TEXTURE1),qt?(qt.texture.bind(nn,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),Tr=Math.pow(2,qt.tileID.overscaledZ-Mt.tileID.overscaledZ),Dr=[Mt.tileID.canonical.x*Tr%1,Mt.tileID.canonical.y*Tr%1]):Mt.texture.bind(nn,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST);var An=Kp(Sr,Dr||[0,0],Tr||1,gr,m);N instanceof mt?K.draw(P,D.TRIANGLES,Ot,Ve.disabled,re,Ct.disabled,An,m.id,N.boundsBuffer,f.quadTriangleIndexBuffer,N.boundsSegments):K.draw(P,D.TRIANGLES,Ot,ye[$e.overscaledZ],re,Ct.disabled,An,m.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments)}},background:function(f,l,m){var C=m.paint.get("background-color"),P=m.paint.get("background-opacity");if(P!==0){var D=f.context,N=D.gl,K=f.transform,re=K.tileSize,ge=m.paint.get("background-pattern");if(!f.isPatternMissing(ge)){var ye=!ge&&C.a===1&&P===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass===ye){var we=Ve.disabled,We=f.depthModeForSublayer(0,ye==="opaque"?Me.ReadWrite:Me.ReadOnly),Ue=f.colorModeForRenderPass(),tt=f.useProgram(ge?"backgroundPattern":"background"),Ze=K.coveringTiles({tileSize:re});ge&&(D.activeTexture.set(N.TEXTURE0),f.imageManager.bind(f.context));for(var $e=m.getCrossfadeParameters(),Ot=0,Mt=Ze;Ot<Mt.length;Ot+=1){var Sr=Mt[Ot],qt=f.transform.calculatePosMatrix(Sr.toUnwrapped()),gr=ge?af(qt,P,f,ge,{tileID:Sr,tileSize:re},$e):Ul(qt,P,C);tt.draw(D,N.TRIANGLES,We,we,Ue,Ct.disabled,gr,m.id,f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}}}}},debug:function(f,l,m){for(var C=0;C<m.length;C++)Pf(f,l,m[C])},custom:function(f,l,m){var C=f.context,P=m.implementation;if(f.renderPass==="offscreen"){var D=P.prerender;D&&(f.setCustomLayerDefaults(),C.setColorMode(f.colorModeForRenderPass()),D.call(P,C.gl,f.transform.customLayerMatrix()),C.setDirty(),f.setBaseState())}else if(f.renderPass==="translucent"){f.setCustomLayerDefaults(),C.setColorMode(f.colorModeForRenderPass()),C.setStencilMode(Ve.disabled);var N=P.renderingMode==="3d"?new Me(f.context.gl.LEQUAL,Me.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,Me.ReadOnly);C.setDepthMode(N),P.render(C.gl,f.transform.customLayerMatrix()),C.setDirty(),f.setBaseState(),C.bindFramebuffer.set(null)}}},At=function(f,l){this.context=new Ce(f),this.transform=l,this._tileTextures={},this.setup(),this.numSublayers=Ye.maxUnderzooming+Ye.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Mu,this.gpuTimers={}};At.prototype.resize=function(d,f){if(this.width=d*h.browser.devicePixelRatio,this.height=f*h.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var l=0,m=this.style._order;l<m.length;l+=1)this.style._layers[m[l]].resize()},At.prototype.setup=function(){var d=this.context,f=new h.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(h.EXTENT,0),f.emplaceBack(0,h.EXTENT),f.emplaceBack(h.EXTENT,h.EXTENT),this.tileExtentBuffer=d.createVertexBuffer(f,Po.members),this.tileExtentSegments=h.SegmentVector.simpleSegment(0,0,4,2);var l=new h.StructArrayLayout2i4;l.emplaceBack(0,0),l.emplaceBack(h.EXTENT,0),l.emplaceBack(0,h.EXTENT),l.emplaceBack(h.EXTENT,h.EXTENT),this.debugBuffer=d.createVertexBuffer(l,Po.members),this.debugSegments=h.SegmentVector.simpleSegment(0,0,4,5);var m=new h.StructArrayLayout4i8;m.emplaceBack(0,0,0,0),m.emplaceBack(h.EXTENT,0,h.EXTENT,0),m.emplaceBack(0,h.EXTENT,0,h.EXTENT),m.emplaceBack(h.EXTENT,h.EXTENT,h.EXTENT,h.EXTENT),this.rasterBoundsBuffer=d.createVertexBuffer(m,pt.members),this.rasterBoundsSegments=h.SegmentVector.simpleSegment(0,0,4,2);var C=new h.StructArrayLayout2i4;C.emplaceBack(0,0),C.emplaceBack(1,0),C.emplaceBack(0,1),C.emplaceBack(1,1),this.viewportBuffer=d.createVertexBuffer(C,Po.members),this.viewportSegments=h.SegmentVector.simpleSegment(0,0,4,2);var P=new h.StructArrayLayout1ui2;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=d.createIndexBuffer(P);var D=new h.StructArrayLayout3ui6;D.emplaceBack(0,1,2),D.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=d.createIndexBuffer(D),this.emptyTexture=new h.Texture(d,{width:1,height:1,data:new Uint8Array([0,0,0,0])},d.gl.RGBA);var N=this.context.gl;this.stencilClearMode=new Ve({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO)},At.prototype.clearStencil=function(){var d=this.context,f=d.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var l=h.create();h.ortho(l,0,this.width,this.height,0,0,1),h.scale(l,l,[f.drawingBufferWidth,f.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(d,f.TRIANGLES,Me.disabled,this.stencilClearMode,ft.disabled,Ct.disabled,Bl(l),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},At.prototype._renderTileClippingMasks=function(d,f){if(this.currentStencilSource!==d.source&&d.isTileClipped()&&f&&f.length){this.currentStencilSource=d.source;var l=this.context,m=l.gl;this.nextStencilID+f.length>256&&this.clearStencil(),l.setColorMode(ft.disabled),l.setDepthMode(Me.disabled);var C=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var P=0,D=f;P<D.length;P+=1){var N=D[P],K=this._tileClippingMaskIDs[N.key]=this.nextStencilID++;C.draw(l,m.TRIANGLES,Me.disabled,new Ve({func:m.ALWAYS,mask:0},K,255,m.KEEP,m.KEEP,m.REPLACE),ft.disabled,Ct.disabled,Bl(N.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},At.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var d=this.nextStencilID++,f=this.context.gl;return new Ve({func:f.NOTEQUAL,mask:255},d,255,f.KEEP,f.KEEP,f.REPLACE)},At.prototype.stencilModeForClipping=function(d){var f=this.context.gl;return new Ve({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[d.key],0,f.KEEP,f.KEEP,f.REPLACE)},At.prototype.stencilConfigForOverlap=function(d){var f,l=this.context.gl,m=d.sort(function(K,re){return re.overscaledZ-K.overscaledZ}),C=m[m.length-1].overscaledZ,P=m[0].overscaledZ-C+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();for(var D={},N=0;N<P;N++)D[N+C]=new Ve({func:l.GEQUAL,mask:255},N+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=P,[D,m]}return[(f={},f[C]=Ve.disabled,f),m]},At.prototype.colorModeForRenderPass=function(){var d=this.context.gl;return this._showOverdrawInspector?new ft([d.CONSTANT_COLOR,d.ONE],new h.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ft.unblended:ft.alphaBlended},At.prototype.depthModeForSublayer=function(d,f,l){if(!this.opaquePassEnabledForLayer())return Me.disabled;var m=1-((1+this.currentLayer)*this.numSublayers+d)*this.depthEpsilon;return new Me(l||this.context.gl.LEQUAL,f,[m,m])},At.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},At.prototype.render=function(d,f){var l=this;this.style=d,this.options=f,this.lineAtlas=d.lineAtlas,this.imageManager=d.imageManager,this.glyphManager=d.glyphManager,this.symbolFadeChange=d.placement.symbolFadeChange(h.browser.now()),this.imageManager.beginFrame();var m=this.style._order,C=this.style.sourceCaches;for(var P in C){var D=C[P];D.used&&D.prepare(this.context)}var N,K,re={},ge={},ye={};for(var we in C){var We=C[we];re[we]=We.getVisibleCoordinates(),ge[we]=re[we].slice().reverse(),ye[we]=We.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Ue=0;Ue<m.length;Ue++)if(this.style._layers[m[Ue]].is3D()){this.opaquePassCutoff=Ue;break}this.renderPass="offscreen";for(var tt=0,Ze=m;tt<Ze.length;tt+=1){var $e=this.style._layers[Ze[tt]];if($e.hasOffscreenPass()&&!$e.isHidden(this.transform.zoom)){var Ot=ge[$e.source];($e.type==="custom"||Ot.length)&&this.renderLayer(this,C[$e.source],$e,Ot)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:f.showOverdrawInspector?h.Color.black:h.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.depthRangeFor3D=[0,1-(d._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){var Mt=this.style._layers[m[this.currentLayer]],Sr=C[Mt.source],qt=re[Mt.source];this._renderTileClippingMasks(Mt,qt),this.renderLayer(this,Sr,Mt,qt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){var gr=this.style._layers[m[this.currentLayer]],Tr=C[gr.source],Dr=(gr.type==="symbol"?ye:ge)[gr.source];this._renderTileClippingMasks(gr,re[gr.source]),this.renderLayer(this,Tr,gr,Dr)}this.options.showTileBoundaries&&(h.values(this.style._layers).forEach(function(nn){nn.source&&!nn.isHidden(l.transform.zoom)&&(nn.source!==(K&&K.id)&&(K=l.style.sourceCaches[nn.source]),(!N||N.getSource().maxzoom<K.getSource().maxzoom)&&(N=K))}),N&&wl.debug(this,N,N.getVisibleCoordinates())),this.options.showPadding&&function(nn){var An=nn.transform.padding;Jf(nn,nn.transform.height-(An.top||0),3,Qf),Jf(nn,An.bottom||0,3,jl),Jh(nn,An.left||0,3,Cl),Jh(nn,nn.transform.width-(An.right||0),3,Mf);var Vn=nn.transform.centerPoint;(function(mi,yi,Ni,Ii){eh(mi,yi-1,Ni-10,2,20,Ii),eh(mi,yi-10,Ni-1,20,2,Ii)})(nn,Vn.x,nn.transform.height-Vn.y,Qh)}(this),this.context.setDefault()},At.prototype.renderLayer=function(d,f,l,m){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||m.length)&&(this.id=l.id,this.gpuTimingStart(l),wl[l.type](d,f,l,m,this.style.placement.variableOffsets),this.gpuTimingEnd())},At.prototype.gpuTimingStart=function(d){if(this.options.gpuTiming){var f=this.context.extTimerQuery,l=this.gpuTimers[d.id];l||(l=this.gpuTimers[d.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),l.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,l.query)}},At.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}},At.prototype.collectGpuTimers=function(){var d=this.gpuTimers;return this.gpuTimers={},d},At.prototype.queryGpuTimers=function(d){var f={};for(var l in d){var m=d[l],C=this.context.extTimerQuery,P=C.getQueryObjectEXT(m.query,C.QUERY_RESULT_EXT)/1e6;C.deleteQueryEXT(m.query),f[l]=P}return f},At.prototype.translatePosMatrix=function(d,f,l,m,C){if(!l[0]&&!l[1])return d;var P=C?m==="map"?this.transform.angle:0:m==="viewport"?-this.transform.angle:0;if(P){var D=Math.sin(P),N=Math.cos(P);l=[l[0]*N-l[1]*D,l[0]*D+l[1]*N]}var K=[C?l[0]:qr(f,l[0],this.transform.zoom),C?l[1]:qr(f,l[1],this.transform.zoom),0],re=new Float32Array(16);return h.translate(re,d,K),re},At.prototype.saveTileTexture=function(d){var f=this._tileTextures[d.size[0]];f?f.push(d):this._tileTextures[d.size[0]]=[d]},At.prototype.getTileTexture=function(d){var f=this._tileTextures[d];return f&&f.length>0?f.pop():null},At.prototype.isPatternMissing=function(d){if(!d)return!1;if(!d.from||!d.to)return!0;var f=this.imageManager.getPattern(d.from.toString()),l=this.imageManager.getPattern(d.to.toString());return!f||!l},At.prototype.useProgram=function(d,f){this.cache=this.cache||{};var l=""+d+(f?f.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[l]||(this.cache[l]=new Eo(this.context,d,Jo[d],f,Mh[d],this._showOverdrawInspector)),this.cache[l]},At.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},At.prototype.setBaseState=function(){var d=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(d.FUNC_ADD)},At.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=h.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new h.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},At.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Vr=function(f,l){this.points=f,this.planes=l};Vr.fromInvProjectionMatrix=function(d,f,l){var m=Math.pow(2,l),C=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(D){return h.transformMat4([],D,d)}).map(function(D){return h.scale$1([],D,1/D[3]/f*m)}),P=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(D){var N=h.sub([],C[D[0]],C[D[1]]),K=h.sub([],C[D[2]],C[D[1]]),re=h.normalize([],h.cross([],N,K)),ge=-h.dot(re,C[D[1]]);return re.concat(ge)});return new Vr(C,P)};var yr=function(f,l){this.min=f,this.max=l,this.center=h.scale$2([],h.add([],this.min,this.max),.5)};yr.prototype.quadrant=function(d){for(var f=[d%2==0,d<2],l=h.clone$2(this.min),m=h.clone$2(this.max),C=0;C<f.length;C++)l[C]=f[C]?this.min[C]:this.center[C],m[C]=f[C]?this.center[C]:this.max[C];return m[2]=this.max[2],new yr(l,m)},yr.prototype.distanceX=function(d){return Math.max(Math.min(this.max[0],d[0]),this.min[0])-d[0]},yr.prototype.distanceY=function(d){return Math.max(Math.min(this.max[1],d[1]),this.min[1])-d[1]},yr.prototype.intersects=function(d){for(var f=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],l=!0,m=0;m<d.planes.length;m++){for(var C=d.planes[m],P=0,D=0;D<f.length;D++)P+=h.dot$1(C,f[D])>=0;if(P===0)return 0;P!==f.length&&(l=!1)}if(l)return 2;for(var N=0;N<3;N++){for(var K=Number.MAX_VALUE,re=-Number.MAX_VALUE,ge=0;ge<d.points.length;ge++){var ye=d.points[ge][N]-this.min[N];K=Math.min(K,ye),re=Math.max(re,ye)}if(re<0||K>this.max[N]-this.min[N])return 0}return 1};var gi=function(f,l,m,C){if(f===void 0&&(f=0),l===void 0&&(l=0),m===void 0&&(m=0),C===void 0&&(C=0),isNaN(f)||f<0||isNaN(l)||l<0||isNaN(m)||m<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=f,this.bottom=l,this.left=m,this.right=C};gi.prototype.interpolate=function(d,f,l){return f.top!=null&&d.top!=null&&(this.top=h.number(d.top,f.top,l)),f.bottom!=null&&d.bottom!=null&&(this.bottom=h.number(d.bottom,f.bottom,l)),f.left!=null&&d.left!=null&&(this.left=h.number(d.left,f.left,l)),f.right!=null&&d.right!=null&&(this.right=h.number(d.right,f.right,l)),this},gi.prototype.getCenter=function(d,f){var l=h.clamp((this.left+d-this.right)/2,0,d),m=h.clamp((this.top+f-this.bottom)/2,0,f);return new h.Point(l,m)},gi.prototype.equals=function(d){return this.top===d.top&&this.bottom===d.bottom&&this.left===d.left&&this.right===d.right},gi.prototype.clone=function(){return new gi(this.top,this.bottom,this.left,this.right)},gi.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Qn=function(f,l,m,C,P){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=P===void 0||P,this._minZoom=f||0,this._maxZoom=l||22,this._minPitch=m==null?0:m,this._maxPitch=C==null?60:C,this.setMaxBounds(),this.width=0,this.height=0,this._center=new h.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new gi,this._posMatrixCache={},this._alignedPosMatrixCache={}},Hi={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Qn.prototype.clone=function(){var d=new Qn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return d.tileSize=this.tileSize,d.latRange=this.latRange,d.width=this.width,d.height=this.height,d._center=this._center,d.zoom=this.zoom,d.angle=this.angle,d._fov=this._fov,d._pitch=this._pitch,d._unmodified=this._unmodified,d._edgeInsets=this._edgeInsets.clone(),d._calcMatrices(),d},Hi.minZoom.get=function(){return this._minZoom},Hi.minZoom.set=function(d){this._minZoom!==d&&(this._minZoom=d,this.zoom=Math.max(this.zoom,d))},Hi.maxZoom.get=function(){return this._maxZoom},Hi.maxZoom.set=function(d){this._maxZoom!==d&&(this._maxZoom=d,this.zoom=Math.min(this.zoom,d))},Hi.minPitch.get=function(){return this._minPitch},Hi.minPitch.set=function(d){this._minPitch!==d&&(this._minPitch=d,this.pitch=Math.max(this.pitch,d))},Hi.maxPitch.get=function(){return this._maxPitch},Hi.maxPitch.set=function(d){this._maxPitch!==d&&(this._maxPitch=d,this.pitch=Math.min(this.pitch,d))},Hi.renderWorldCopies.get=function(){return this._renderWorldCopies},Hi.renderWorldCopies.set=function(d){d===void 0?d=!0:d===null&&(d=!1),this._renderWorldCopies=d},Hi.worldSize.get=function(){return this.tileSize*this.scale},Hi.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Hi.size.get=function(){return new h.Point(this.width,this.height)},Hi.bearing.get=function(){return-this.angle/Math.PI*180},Hi.bearing.set=function(d){var f=-h.wrap(d,-180,180)*Math.PI/180;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=h.create$2(),h.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Hi.pitch.get=function(){return this._pitch/Math.PI*180},Hi.pitch.set=function(d){var f=h.clamp(d,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())},Hi.fov.get=function(){return this._fov/Math.PI*180},Hi.fov.set=function(d){d=Math.max(.01,Math.min(60,d)),this._fov!==d&&(this._unmodified=!1,this._fov=d/180*Math.PI,this._calcMatrices())},Hi.zoom.get=function(){return this._zoom},Hi.zoom.set=function(d){var f=Math.min(Math.max(d,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._zoom=f,this.scale=this.zoomScale(f),this.tileZoom=Math.floor(f),this.zoomFraction=f-this.tileZoom,this._constrain(),this._calcMatrices())},Hi.center.get=function(){return this._center},Hi.center.set=function(d){d.lat===this._center.lat&&d.lng===this._center.lng||(this._unmodified=!1,this._center=d,this._constrain(),this._calcMatrices())},Hi.padding.get=function(){return this._edgeInsets.toJSON()},Hi.padding.set=function(d){this._edgeInsets.equals(d)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,d,1),this._calcMatrices())},Hi.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Qn.prototype.isPaddingEqual=function(d){return this._edgeInsets.equals(d)},Qn.prototype.interpolatePadding=function(d,f,l){this._unmodified=!1,this._edgeInsets.interpolate(d,f,l),this._constrain(),this._calcMatrices()},Qn.prototype.coveringZoomLevel=function(d){var f=(d.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/d.tileSize));return Math.max(0,f)},Qn.prototype.getVisibleUnwrappedCoordinates=function(d){var f=[new h.UnwrappedTileID(0,d)];if(this._renderWorldCopies)for(var l=this.pointCoordinate(new h.Point(0,0)),m=this.pointCoordinate(new h.Point(this.width,0)),C=this.pointCoordinate(new h.Point(this.width,this.height)),P=this.pointCoordinate(new h.Point(0,this.height)),D=Math.floor(Math.min(l.x,m.x,C.x,P.x)),N=Math.floor(Math.max(l.x,m.x,C.x,P.x)),K=D-1;K<=N+1;K++)K!==0&&f.push(new h.UnwrappedTileID(K,d));return f},Qn.prototype.coveringTiles=function(d){var f=this.coveringZoomLevel(d),l=f;if(d.minzoom!==void 0&&f<d.minzoom)return[];d.maxzoom!==void 0&&f>d.maxzoom&&(f=d.maxzoom);var m=h.MercatorCoordinate.fromLngLat(this.center),C=Math.pow(2,f),P=[C*m.x,C*m.y,0],D=Vr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f),N=d.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(N=f);var K=function(An){return{aabb:new yr([An*C,0,0],[(An+1)*C,C,0]),zoom:0,x:0,y:0,wrap:An,fullyVisible:!1}},re=[],ge=[],ye=f,we=d.reparseOverscaled?l:f;if(this._renderWorldCopies)for(var We=1;We<=3;We++)re.push(K(-We)),re.push(K(We));for(re.push(K(0));re.length>0;){var Ue=re.pop(),tt=Ue.x,Ze=Ue.y,$e=Ue.fullyVisible;if(!$e){var Ot=Ue.aabb.intersects(D);if(Ot===0)continue;$e=Ot===2}var Mt=Ue.aabb.distanceX(P),Sr=Ue.aabb.distanceY(P),qt=Math.max(Math.abs(Mt),Math.abs(Sr));if(Ue.zoom===ye||qt>3+(1<<ye-Ue.zoom)-2&&Ue.zoom>=N)ge.push({tileID:new h.OverscaledTileID(Ue.zoom===ye?we:Ue.zoom,Ue.wrap,Ue.zoom,tt,Ze),distanceSq:h.sqrLen([P[0]-.5-tt,P[1]-.5-Ze])});else for(var gr=0;gr<4;gr++){var Tr=(tt<<1)+gr%2,Dr=(Ze<<1)+(gr>>1);re.push({aabb:Ue.aabb.quadrant(gr),zoom:Ue.zoom+1,x:Tr,y:Dr,wrap:Ue.wrap,fullyVisible:$e})}}return ge.sort(function(nn,An){return nn.distanceSq-An.distanceSq}).map(function(nn){return nn.tileID})},Qn.prototype.resize=function(d,f){this.width=d,this.height=f,this.pixelsToGLUnits=[2/d,-2/f],this._constrain(),this._calcMatrices()},Hi.unmodified.get=function(){return this._unmodified},Qn.prototype.zoomScale=function(d){return Math.pow(2,d)},Qn.prototype.scaleZoom=function(d){return Math.log(d)/Math.LN2},Qn.prototype.project=function(d){var f=h.clamp(d.lat,-this.maxValidLatitude,this.maxValidLatitude);return new h.Point(h.mercatorXfromLng(d.lng)*this.worldSize,h.mercatorYfromLat(f)*this.worldSize)},Qn.prototype.unproject=function(d){return new h.MercatorCoordinate(d.x/this.worldSize,d.y/this.worldSize).toLngLat()},Hi.point.get=function(){return this.project(this.center)},Qn.prototype.setLocationAtPoint=function(d,f){var l=this.pointCoordinate(f),m=this.pointCoordinate(this.centerPoint),C=this.locationCoordinate(d),P=new h.MercatorCoordinate(C.x-(l.x-m.x),C.y-(l.y-m.y));this.center=this.coordinateLocation(P),this._renderWorldCopies&&(this.center=this.center.wrap())},Qn.prototype.locationPoint=function(d){return this.coordinatePoint(this.locationCoordinate(d))},Qn.prototype.pointLocation=function(d){return this.coordinateLocation(this.pointCoordinate(d))},Qn.prototype.locationCoordinate=function(d){return h.MercatorCoordinate.fromLngLat(d)},Qn.prototype.coordinateLocation=function(d){return d.toLngLat()},Qn.prototype.pointCoordinate=function(d){var f=[d.x,d.y,0,1],l=[d.x,d.y,1,1];h.transformMat4(f,f,this.pixelMatrixInverse),h.transformMat4(l,l,this.pixelMatrixInverse);var m=f[3],C=l[3],P=f[1]/m,D=l[1]/C,N=f[2]/m,K=l[2]/C,re=N===K?0:(0-N)/(K-N);return new h.MercatorCoordinate(h.number(f[0]/m,l[0]/C,re)/this.worldSize,h.number(P,D,re)/this.worldSize)},Qn.prototype.coordinatePoint=function(d){var f=[d.x*this.worldSize,d.y*this.worldSize,0,1];return h.transformMat4(f,f,this.pixelMatrix),new h.Point(f[0]/f[3],f[1]/f[3])},Qn.prototype.getBounds=function(){return new h.LngLatBounds().extend(this.pointLocation(new h.Point(0,0))).extend(this.pointLocation(new h.Point(this.width,0))).extend(this.pointLocation(new h.Point(this.width,this.height))).extend(this.pointLocation(new h.Point(0,this.height)))},Qn.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new h.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Qn.prototype.setMaxBounds=function(d){d?(this.lngRange=[d.getWest(),d.getEast()],this.latRange=[d.getSouth(),d.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Qn.prototype.calculatePosMatrix=function(d,f){f===void 0&&(f=!1);var l=d.key,m=f?this._alignedPosMatrixCache:this._posMatrixCache;if(m[l])return m[l];var C=d.canonical,P=this.worldSize/this.zoomScale(C.z),D=C.x+Math.pow(2,C.z)*d.wrap,N=h.identity(new Float64Array(16));return h.translate(N,N,[D*P,C.y*P,0]),h.scale(N,N,[P/h.EXTENT,P/h.EXTENT,1]),h.multiply(N,f?this.alignedProjMatrix:this.projMatrix,N),m[l]=new Float32Array(N),m[l]},Qn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Qn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var d,f,l,m,C=-90,P=90,D=-180,N=180,K=this.size,re=this._unmodified;if(this.latRange){var ge=this.latRange;C=h.mercatorYfromLat(ge[1])*this.worldSize,d=(P=h.mercatorYfromLat(ge[0])*this.worldSize)-C<K.y?K.y/(P-C):0}if(this.lngRange){var ye=this.lngRange;D=h.mercatorXfromLng(ye[0])*this.worldSize,f=(N=h.mercatorXfromLng(ye[1])*this.worldSize)-D<K.x?K.x/(N-D):0}var we=this.point,We=Math.max(f||0,d||0);if(We)return this.center=this.unproject(new h.Point(f?(N+D)/2:we.x,d?(P+C)/2:we.y)),this.zoom+=this.scaleZoom(We),this._unmodified=re,void(this._constraining=!1);if(this.latRange){var Ue=we.y,tt=K.y/2;Ue-tt<C&&(m=C+tt),Ue+tt>P&&(m=P-tt)}if(this.lngRange){var Ze=we.x,$e=K.x/2;Ze-$e<D&&(l=D+$e),Ze+$e>N&&(l=N-$e)}l===void 0&&m===void 0||(this.center=this.unproject(new h.Point(l!==void 0?l:we.x,m!==void 0?m:we.y))),this._unmodified=re,this._constraining=!1}},Qn.prototype._calcMatrices=function(){if(this.height){var d=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var f=Math.PI/2+this._pitch,l=this._fov*(.5+d.y/this.height),m=Math.sin(l)*this.cameraToCenterDistance/Math.sin(h.clamp(Math.PI-f-l,.01,Math.PI-.01)),C=this.point,P=C.x,D=C.y,N=1.01*(Math.cos(Math.PI/2-this._pitch)*m+this.cameraToCenterDistance),K=this.height/50,re=new Float64Array(16);h.perspective(re,this._fov,this.width/this.height,K,N),re[8]=2*-d.x/this.width,re[9]=2*d.y/this.height,h.scale(re,re,[1,-1,1]),h.translate(re,re,[0,0,-this.cameraToCenterDistance]),h.rotateX(re,re,this._pitch),h.rotateZ(re,re,this.angle),h.translate(re,re,[-P,-D,0]),this.mercatorMatrix=h.scale([],re,[this.worldSize,this.worldSize,this.worldSize]),h.scale(re,re,[1,1,h.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=re,this.invProjMatrix=h.invert([],this.projMatrix);var ge=this.width%2/2,ye=this.height%2/2,we=Math.cos(this.angle),We=Math.sin(this.angle),Ue=P-Math.round(P)+we*ge+We*ye,tt=D-Math.round(D)+we*ye+We*ge,Ze=new Float64Array(re);if(h.translate(Ze,Ze,[Ue>.5?Ue-1:Ue,tt>.5?tt-1:tt,0]),this.alignedProjMatrix=Ze,re=h.create(),h.scale(re,re,[this.width/2,-this.height/2,1]),h.translate(re,re,[1,-1,0]),this.labelPlaneMatrix=re,re=h.create(),h.scale(re,re,[1,-1,1]),h.translate(re,re,[-1,-1,0]),h.scale(re,re,[2/this.width,2/this.height,1]),this.glCoordMatrix=re,this.pixelMatrix=h.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(re=h.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=re,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Qn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var d=this.pointCoordinate(new h.Point(0,0)),f=[d.x*this.worldSize,d.y*this.worldSize,0,1];return h.transformMat4(f,f,this.pixelMatrix)[3]/this.cameraToCenterDistance},Qn.prototype.getCameraPoint=function(){var d=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.Point(0,d))},Qn.prototype.getCameraQueryGeometry=function(d){var f=this.getCameraPoint();if(d.length===1)return[d[0],f];for(var l=f.x,m=f.y,C=f.x,P=f.y,D=0,N=d;D<N.length;D+=1){var K=N[D];l=Math.min(l,K.x),m=Math.min(m,K.y),C=Math.max(C,K.x),P=Math.max(P,K.y)}return[new h.Point(l,m),new h.Point(C,m),new h.Point(C,P),new h.Point(l,P),new h.Point(l,m)]},Object.defineProperties(Qn.prototype,Hi);var Da=function(f){var l,m,C,P;this._hashName=f&&encodeURIComponent(f),h.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(l=this._updateHashUnthrottled.bind(this),m=!1,C=null,P=function(){C=null,m&&(l(),C=setTimeout(P,300),m=!1)},function(){return m=!0,C||P(),C})};Da.prototype.addTo=function(d){return this._map=d,h.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Da.prototype.remove=function(){return h.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Da.prototype.getHashString=function(d){var f=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,m=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,m),P=Math.round(f.lng*C)/C,D=Math.round(f.lat*C)/C,N=this._map.getBearing(),K=this._map.getPitch(),re="";if(re+=d?"/"+P+"/"+D+"/"+l:l+"/"+D+"/"+P,(N||K)&&(re+="/"+Math.round(10*N)/10),K&&(re+="/"+Math.round(K)),this._hashName){var ge=this._hashName,ye=!1,we=h.window.location.hash.slice(1).split("&").map(function(We){var Ue=We.split("=")[0];return Ue===ge?(ye=!0,Ue+"="+re):We}).filter(function(We){return We});return ye||we.push(ge+"="+re),"#"+we.join("&")}return"#"+re},Da.prototype._getCurrentHash=function(){var d,f=this,l=h.window.location.hash.replace("#","");return this._hashName?(l.split("&").map(function(m){return m.split("=")}).forEach(function(m){m[0]===f._hashName&&(d=m)}),(d&&d[1]||"").split("/")):l.split("/")},Da.prototype._onHashChange=function(){var d=this._getCurrentHash();if(d.length>=3&&!d.some(function(l){return isNaN(l)})){var f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:f,pitch:+(d[4]||0)}),!0}return!1},Da.prototype._updateHashUnthrottled=function(){var d=h.window.location.href.replace(/(#.+)?$/,this.getHashString());try{h.window.history.replaceState(h.window.history.state,null,d)}catch(f){}};var Ya={linearity:.3,easing:h.bezier(0,0,.3,1)},uf=h.extend({deceleration:2500,maxSpeed:1400},Ya),lf=h.extend({deceleration:20,maxSpeed:1400},Ya),Vl=h.extend({deceleration:1e3,maxSpeed:360},Ya),ep=h.extend({deceleration:1e3,maxSpeed:90},Ya),Ph=function(f){this._map=f,this.clear()};function ac(d,f){(!d.duration||d.duration<f.duration)&&(d.duration=f.duration,d.easing=f.easing)}function pl(d,f,l){var m=l.maxSpeed,C=l.linearity,P=l.deceleration,D=h.clamp(d*C/(f/1e3),-m,m),N=Math.abs(D)/(P*C);return{easing:l.easing,duration:1e3*N,amount:D*(N/2)}}Ph.prototype.clear=function(){this._inertiaBuffer=[]},Ph.prototype.record=function(d){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:h.browser.now(),settings:d})},Ph.prototype._drainInertiaBuffer=function(){for(var d=this._inertiaBuffer,f=h.browser.now();d.length>0&&f-d[0].time>160;)d.shift()},Ph.prototype._onMoveEnd=function(d){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var f={zoom:0,bearing:0,pitch:0,pan:new h.Point(0,0),pinchAround:void 0,around:void 0},l=0,m=this._inertiaBuffer;l<m.length;l+=1){var C=m[l].settings;f.zoom+=C.zoomDelta||0,f.bearing+=C.bearingDelta||0,f.pitch+=C.pitchDelta||0,C.panDelta&&f.pan._add(C.panDelta),C.around&&(f.around=C.around),C.pinchAround&&(f.pinchAround=C.pinchAround)}var P=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,D={};if(f.pan.mag()){var N=pl(f.pan.mag(),P,h.extend({},uf,d||{}));D.offset=f.pan.mult(N.amount/f.pan.mag()),D.center=this._map.transform.center,ac(D,N)}if(f.zoom){var K=pl(f.zoom,P,lf);D.zoom=this._map.transform.zoom+K.amount,ac(D,K)}if(f.bearing){var re=pl(f.bearing,P,Vl);D.bearing=this._map.transform.bearing+h.clamp(re.amount,-179,179),ac(D,re)}if(f.pitch){var ge=pl(f.pitch,P,ep);D.pitch=this._map.transform.pitch+ge.amount,ac(D,ge)}if(D.zoom||D.bearing){var ye=f.pinchAround===void 0?f.around:f.pinchAround;D.around=ye?this._map.unproject(ye):this._map.getCenter()}return this.clear(),h.extend(D,{noMoveStart:!0})}};var $i=function(d){function f(m,C,P,D){D===void 0&&(D={});var N=H.mousePos(C.getCanvasContainer(),P),K=C.unproject(N);d.call(this,m,h.extend({point:N,lngLat:K,originalEvent:P},D)),this._defaultPrevented=!1,this.target=C}d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f;var l={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},l.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,l),f}(h.Event),io=function(d){function f(m,C,P){var D=m==="touchend"?P.changedTouches:P.touches,N=H.touchPos(C.getCanvasContainer(),D),K=N.map(function(ye){return C.unproject(ye)}),re=N.reduce(function(ye,we,We,Ue){return ye.add(we.div(Ue.length))},new h.Point(0,0)),ge=C.unproject(re);d.call(this,m,{points:N,point:re,lngLats:K,lngLat:ge,originalEvent:P}),this._defaultPrevented=!1}d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f;var l={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},l.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,l),f}(h.Event),di=function(d){function f(m,C,P){d.call(this,m,{originalEvent:P}),this._defaultPrevented=!1}d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f;var l={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},l.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,l),f}(h.Event),qa=function(f,l){this._map=f,this._clickTolerance=l.clickTolerance};qa.prototype.reset=function(){delete this._mousedownPos},qa.prototype.wheel=function(d){return this._firePreventable(new di(d.type,this._map,d))},qa.prototype.mousedown=function(d,f){return this._mousedownPos=f,this._firePreventable(new $i(d.type,this._map,d))},qa.prototype.mouseup=function(d){this._map.fire(new $i(d.type,this._map,d))},qa.prototype.click=function(d,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||this._map.fire(new $i(d.type,this._map,d))},qa.prototype.dblclick=function(d){return this._firePreventable(new $i(d.type,this._map,d))},qa.prototype.mouseover=function(d){this._map.fire(new $i(d.type,this._map,d))},qa.prototype.mouseout=function(d){this._map.fire(new $i(d.type,this._map,d))},qa.prototype.touchstart=function(d){return this._firePreventable(new io(d.type,this._map,d))},qa.prototype.touchmove=function(d){this._map.fire(new io(d.type,this._map,d))},qa.prototype.touchend=function(d){this._map.fire(new io(d.type,this._map,d))},qa.prototype.touchcancel=function(d){this._map.fire(new io(d.type,this._map,d))},qa.prototype._firePreventable=function(d){if(this._map.fire(d),d.defaultPrevented)return{}},qa.prototype.isEnabled=function(){return!0},qa.prototype.isActive=function(){return!1},qa.prototype.enable=function(){},qa.prototype.disable=function(){};var Kn=function(f){this._map=f};Kn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Kn.prototype.mousemove=function(d){this._map.fire(new $i(d.type,this._map,d))},Kn.prototype.mousedown=function(){this._delayContextMenu=!0},Kn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $i("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Kn.prototype.contextmenu=function(d){this._delayContextMenu?this._contextMenuEvent=d:this._map.fire(new $i(d.type,this._map,d)),this._map.listens("contextmenu")&&d.preventDefault()},Kn.prototype.isEnabled=function(){return!0},Kn.prototype.isActive=function(){return!1},Kn.prototype.enable=function(){},Kn.prototype.disable=function(){};var Gu=function(f,l){this._map=f,this._el=f.getCanvasContainer(),this._container=f.getContainer(),this._clickTolerance=l.clickTolerance||1};function cf(d,f){for(var l={},m=0;m<d.length;m++)l[d[m].identifier]=f[m];return l}Gu.prototype.isEnabled=function(){return!!this._enabled},Gu.prototype.isActive=function(){return!!this._active},Gu.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Gu.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Gu.prototype.mousedown=function(d,f){this.isEnabled()&&d.shiftKey&&d.button===0&&(H.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)},Gu.prototype.mousemoveWindow=function(d,f){if(this._active){var l=f;if(!(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)){var m=this._startPos;this._lastPos=l,this._box||(this._box=H.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",d));var C=Math.min(m.x,l.x),P=Math.max(m.x,l.x),D=Math.min(m.y,l.y),N=Math.max(m.y,l.y);H.setTransform(this._box,"translate("+C+"px,"+D+"px)"),this._box.style.width=P-C+"px",this._box.style.height=N-D+"px"}}},Gu.prototype.mouseupWindow=function(d,f){var l=this;if(this._active&&d.button===0){var m=this._startPos,C=f;if(this.reset(),H.suppressClick(),m.x!==C.x||m.y!==C.y)return this._map.fire(new h.Event("boxzoomend",{originalEvent:d})),{cameraAnimation:function(D){return D.fitScreenCoordinates(m,C,l._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",d)}},Gu.prototype.keydown=function(d){this._active&&d.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",d))},Gu.prototype.blur=function(){this.reset()},Gu.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(H.remove(this._box),this._box=null),H.enableDrag(),delete this._startPos,delete this._lastPos},Gu.prototype._fireEvent=function(d,f){return this._map.fire(new h.Event(d,{originalEvent:f}))};var Gc=function(f){this.reset(),this.numTouches=f.numTouches};Gc.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Gc.prototype.touchstart=function(d,f,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=d.timeStamp),l.length===this.numTouches&&(this.centroid=function(m){for(var C=new h.Point(0,0),P=0,D=m;P<D.length;P+=1)C._add(D[P]);return C.div(m.length)}(f),this.touches=cf(l,f)))},Gc.prototype.touchmove=function(d,f,l){if(!this.aborted&&this.centroid){var m=cf(l,f);for(var C in this.touches){var P=m[C];(!P||P.dist(this.touches[C])>30)&&(this.aborted=!0)}}},Gc.prototype.touchend=function(d,f,l){if((!this.centroid||d.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){var m=!this.aborted&&this.centroid;if(this.reset(),m)return m}};var Hu=function(f){this.singleTap=new Gc(f),this.numTaps=f.numTaps,this.reset()};Hu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Hu.prototype.touchstart=function(d,f,l){this.singleTap.touchstart(d,f,l)},Hu.prototype.touchmove=function(d,f,l){this.singleTap.touchmove(d,f,l)},Hu.prototype.touchend=function(d,f,l){var m=this.singleTap.touchend(d,f,l);if(m){var C=d.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(m)<30;if(C&&P||this.reset(),this.count++,this.lastTime=d.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}};var bs=function(){this._zoomIn=new Hu({numTouches:1,numTaps:2}),this._zoomOut=new Hu({numTouches:2,numTaps:1}),this.reset()};bs.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},bs.prototype.touchstart=function(d,f,l){this._zoomIn.touchstart(d,f,l),this._zoomOut.touchstart(d,f,l)},bs.prototype.touchmove=function(d,f,l){this._zoomIn.touchmove(d,f,l),this._zoomOut.touchmove(d,f,l)},bs.prototype.touchend=function(d,f,l){var m=this,C=this._zoomIn.touchend(d,f,l),P=this._zoomOut.touchend(d,f,l);return C?(this._active=!0,d.preventDefault(),setTimeout(function(){return m.reset()},0),{cameraAnimation:function(N){return N.easeTo({duration:300,zoom:N.getZoom()+1,around:N.unproject(C)},{originalEvent:d})}}):P?(this._active=!0,d.preventDefault(),setTimeout(function(){return m.reset()},0),{cameraAnimation:function(N){return N.easeTo({duration:300,zoom:N.getZoom()-1,around:N.unproject(P)},{originalEvent:d})}}):void 0},bs.prototype.touchcancel=function(){this.reset()},bs.prototype.enable=function(){this._enabled=!0},bs.prototype.disable=function(){this._enabled=!1,this.reset()},bs.prototype.isEnabled=function(){return this._enabled},bs.prototype.isActive=function(){return this._active};var ff={0:1,2:2},Ln=function(f){this.reset(),this._clickTolerance=f.clickTolerance||1};Ln.prototype.blur=function(){this.reset()},Ln.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ln.prototype._correctButton=function(d,f){return!1},Ln.prototype._move=function(d,f){return{}},Ln.prototype.mousedown=function(d,f){if(!this._lastPoint){var l=H.mouseButton(d);this._correctButton(d,l)&&(this._lastPoint=f,this._eventButton=l)}},Ln.prototype.mousemoveWindow=function(d,f){var l=this._lastPoint;if(l){if(d.preventDefault(),function(m,C){var P=ff[C];return m.buttons===void 0||(m.buttons&P)!==P}(d,this._eventButton))this.reset();else if(this._moved||!(f.dist(l)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(l,f)}},Ln.prototype.mouseupWindow=function(d){this._lastPoint&&H.mouseButton(d)===this._eventButton&&(this._moved&&H.suppressClick(),this.reset())},Ln.prototype.enable=function(){this._enabled=!0},Ln.prototype.disable=function(){this._enabled=!1,this.reset()},Ln.prototype.isEnabled=function(){return this._enabled},Ln.prototype.isActive=function(){return this._active};var Gl=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.mousedown=function(l,m){d.prototype.mousedown.call(this,l,m),this._lastPoint&&(this._active=!0)},f.prototype._correctButton=function(l,m){return m===0&&!l.ctrlKey},f.prototype._move=function(l,m){return{around:m,panDelta:m.sub(l)}},f}(Ln),hs=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype._correctButton=function(l,m){return m===0&&l.ctrlKey||m===2},f.prototype._move=function(l,m){var C=.8*(m.x-l.x);if(C)return this._active=!0,{bearingDelta:C}},f.prototype.contextmenu=function(l){l.preventDefault()},f}(Ln),hf=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype._correctButton=function(l,m){return m===0&&l.ctrlKey||m===2},f.prototype._move=function(l,m){var C=-.5*(m.y-l.y);if(C)return this._active=!0,{pitchDelta:C}},f.prototype.contextmenu=function(l){l.preventDefault()},f}(Ln),Vs=function(f){this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset()};Vs.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new h.Point(0,0)},Vs.prototype.touchstart=function(d,f,l){return this._calculateTransform(d,f,l)},Vs.prototype.touchmove=function(d,f,l){if(this._active&&!(l.length<this._minTouches))return d.preventDefault(),this._calculateTransform(d,f,l)},Vs.prototype.touchend=function(d,f,l){this._calculateTransform(d,f,l),this._active&&l.length<this._minTouches&&this.reset()},Vs.prototype.touchcancel=function(){this.reset()},Vs.prototype._calculateTransform=function(d,f,l){l.length>0&&(this._active=!0);var m=cf(l,f),C=new h.Point(0,0),P=new h.Point(0,0),D=0;for(var N in m){var K=m[N],re=this._touches[N];re&&(C._add(K),P._add(K.sub(re)),D++,m[N]=K)}if(this._touches=m,!(D<this._minTouches)&&P.mag()){var ge=P.div(D);if(this._sum._add(ge),!(this._sum.mag()<this._clickTolerance))return{around:C.div(D),panDelta:ge}}},Vs.prototype.enable=function(){this._enabled=!0},Vs.prototype.disable=function(){this._enabled=!1,this.reset()},Vs.prototype.isEnabled=function(){return this._enabled},Vs.prototype.isActive=function(){return this._active};var Ms=function(){this.reset()};function bc(d,f,l){for(var m=0;m<d.length;m++)if(d[m].identifier===l)return f[m]}function Hl(d,f){return Math.log(d/f)/Math.LN2}Ms.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ms.prototype._start=function(d){},Ms.prototype._move=function(d,f,l){return{}},Ms.prototype.touchstart=function(d,f,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([f[0],f[1]]))},Ms.prototype.touchmove=function(d,f,l){if(this._firstTwoTouches){d.preventDefault();var m=this._firstTwoTouches,C=m[1],P=bc(l,f,m[0]),D=bc(l,f,C);if(P&&D){var N=this._aroundCenter?null:P.add(D).div(2);return this._move([P,D],N,d)}}},Ms.prototype.touchend=function(d,f,l){if(this._firstTwoTouches){var m=this._firstTwoTouches,C=m[1],P=bc(l,f,m[0]),D=bc(l,f,C);P&&D||(this._active&&H.suppressClick(),this.reset())}},Ms.prototype.touchcancel=function(){this.reset()},Ms.prototype.enable=function(d){this._enabled=!0,this._aroundCenter=!!d&&d.around==="center"},Ms.prototype.disable=function(){this._enabled=!1,this.reset()},Ms.prototype.isEnabled=function(){return this._enabled},Ms.prototype.isActive=function(){return this._active};var _u=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.reset=function(){d.prototype.reset.call(this),delete this._distance,delete this._startDistance},f.prototype._start=function(l){this._startDistance=this._distance=l[0].dist(l[1])},f.prototype._move=function(l,m){var C=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(Hl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Hl(this._distance,C),pinchAround:m}},f}(Ms);function Ec(d,f){return 180*d.angleWith(f)/Math.PI}var tp=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.reset=function(){d.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},f.prototype._start=function(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])},f.prototype._move=function(l,m){var C=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ec(this._vector,C),pinchAround:m}},f.prototype._isBelowThreshold=function(l){this._minDiameter=Math.min(this._minDiameter,l.mag());var m=25/(Math.PI*this._minDiameter)*360,C=Ec(l,this._startVector);return Math.abs(C)<m},f}(Ms);function th(d){return Math.abs(d.y)>Math.abs(d.x)}var Hc=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.reset=function(){d.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},f.prototype._start=function(l){this._lastPoints=l,th(l[0].sub(l[1]))&&(this._valid=!1)},f.prototype._move=function(l,m,C){var P=l[0].sub(this._lastPoints[0]),D=l[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(P,D,C.timeStamp),this._valid)return this._lastPoints=l,this._active=!0,{pitchDelta:(P.y+D.y)/2*-.5}},f.prototype.gestureBeginsVertically=function(l,m,C){if(this._valid!==void 0)return this._valid;var P=l.mag()>=2,D=m.mag()>=2;if(P||D){if(!P||!D)return this._firstMove===void 0&&(this._firstMove=C),C-this._firstMove<100&&void 0;var N=l.y>0==m.y>0;return th(l)&&th(m)&&N}},f}(Ms),pf={panStep:100,bearingStep:15,pitchStep:10},Wu=function(){var f=pf;this._panStep=f.panStep,this._bearingStep=f.bearingStep,this._pitchStep=f.pitchStep,this._rotationDisabled=!1};function rl(d){return d*(2-d)}Wu.prototype.blur=function(){this.reset()},Wu.prototype.reset=function(){this._active=!1},Wu.prototype.keydown=function(d){var f=this;if(!(d.altKey||d.ctrlKey||d.metaKey)){var l=0,m=0,C=0,P=0,D=0;switch(d.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:d.shiftKey?m=-1:(d.preventDefault(),P=-1);break;case 39:d.shiftKey?m=1:(d.preventDefault(),P=1);break;case 38:d.shiftKey?C=1:(d.preventDefault(),D=-1);break;case 40:d.shiftKey?C=-1:(d.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(m=0,C=0),{cameraAnimation:function(K){var re=K.getZoom();K.easeTo({duration:300,easeId:"keyboardHandler",easing:rl,zoom:l?Math.round(re)+l*(d.shiftKey?2:1):re,bearing:K.getBearing()+m*f._bearingStep,pitch:K.getPitch()+C*f._pitchStep,offset:[-P*f._panStep,-D*f._panStep],center:K.getCenter()},{originalEvent:d})}}}},Wu.prototype.enable=function(){this._enabled=!0},Wu.prototype.disable=function(){this._enabled=!1,this.reset()},Wu.prototype.isEnabled=function(){return this._enabled},Wu.prototype.isActive=function(){return this._active},Wu.prototype.disableRotation=function(){this._rotationDisabled=!0},Wu.prototype.enableRotation=function(){this._rotationDisabled=!1};var ma=function(f,l){this._map=f,this._el=f.getCanvasContainer(),this._handler=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,h.bindAll(["_onTimeout"],this)};ma.prototype.setZoomRate=function(d){this._defaultZoomRate=d},ma.prototype.setWheelZoomRate=function(d){this._wheelZoomRate=d},ma.prototype.isEnabled=function(){return!!this._enabled},ma.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},ma.prototype.isZooming=function(){return!!this._zooming},ma.prototype.enable=function(d){this.isEnabled()||(this._enabled=!0,this._aroundCenter=d&&d.around==="center")},ma.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ma.prototype.wheel=function(d){if(this.isEnabled()){var f=d.deltaMode===h.window.WheelEvent.DOM_DELTA_LINE?40*d.deltaY:d.deltaY,l=h.browser.now(),m=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,f!==0&&f%4.000244140625==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,d)):this._type||(this._type=Math.abs(m*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),d.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=d,this._delta-=f,this._active||this._start(d)),d.preventDefault()}},ma.prototype._onTimeout=function(d){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},ma.prototype._start=function(d){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var f=H.mousePos(this._el,d);this._around=h.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(f)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ma.prototype.renderFrame=function(){var d=this;if(this._frameId&&(this._frameId=null,this.isActive())){var f=this._map.transform;if(this._delta!==0){var l=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,m=2/(1+Math.exp(-Math.abs(this._delta*l)));this._delta<0&&m!==0&&(m=1/m);var C=typeof this._targetZoom=="number"?f.zoomScale(this._targetZoom):f.scale;this._targetZoom=Math.min(f.maxZoom,Math.max(f.minZoom,f.scaleZoom(C*m))),this._type==="wheel"&&(this._startZoom=f.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var P,D=typeof this._targetZoom=="number"?this._targetZoom:f.zoom,N=this._startZoom,K=this._easing,re=!1;if(this._type==="wheel"&&N&&K){var ge=Math.min((h.browser.now()-this._lastWheelEventTime)/200,1),ye=K(ge);P=h.number(N,D,ye),ge<1?this._frameId||(this._frameId=!0):re=!0}else P=D,re=!0;return this._active=!0,re&&(this._active=!1,this._finishTimeout=setTimeout(function(){d._zooming=!1,d._handler._triggerRenderFrame(),delete d._targetZoom,delete d._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!re,zoomDelta:P-f.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ma.prototype._smoothOutEasing=function(d){var f=h.ease;if(this._prevEase){var l=this._prevEase,m=(h.browser.now()-l.start)/l.duration,C=l.easing(m+.01)-l.easing(m),P=.27/Math.sqrt(C*C+1e-4)*.01,D=Math.sqrt(.0729-P*P);f=h.bezier(P,D,.25,1)}return this._prevEase={start:h.browser.now(),duration:d,easing:f},f},ma.prototype.blur=function(){this.reset()},ma.prototype.reset=function(){this._active=!1};var Al=function(f,l){this._clickZoom=f,this._tapZoom=l};Al.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Al.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Al.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Al.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Tl=function(){this.reset()};Tl.prototype.reset=function(){this._active=!1},Tl.prototype.blur=function(){this.reset()},Tl.prototype.dblclick=function(d,f){return d.preventDefault(),{cameraAnimation:function(m){m.easeTo({duration:300,zoom:m.getZoom()+(d.shiftKey?-1:1),around:m.unproject(f)},{originalEvent:d})}}},Tl.prototype.enable=function(){this._enabled=!0},Tl.prototype.disable=function(){this._enabled=!1,this.reset()},Tl.prototype.isEnabled=function(){return this._enabled},Tl.prototype.isActive=function(){return this._active};var Za=function(){this._tap=new Hu({numTouches:1,numTaps:1}),this.reset()};Za.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Za.prototype.touchstart=function(d,f,l){this._swipePoint||(this._tapTime&&d.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?l.length>0&&(this._swipePoint=f[0],this._swipeTouch=l[0].identifier):this._tap.touchstart(d,f,l))},Za.prototype.touchmove=function(d,f,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;var m=f[0],C=m.y-this._swipePoint.y;return this._swipePoint=m,d.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(d,f,l)},Za.prototype.touchend=function(d,f,l){this._tapTime?this._swipePoint&&l.length===0&&this.reset():this._tap.touchend(d,f,l)&&(this._tapTime=d.timeStamp)},Za.prototype.touchcancel=function(){this.reset()},Za.prototype.enable=function(){this._enabled=!0},Za.prototype.disable=function(){this._enabled=!1,this.reset()},Za.prototype.isEnabled=function(){return this._enabled},Za.prototype.isActive=function(){return this._active};var ts=function(f,l,m){this._el=f,this._mousePan=l,this._touchPan=m};ts.prototype.enable=function(d){this._inertiaOptions=d||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ts.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ts.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ts.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Wc=function(f,l,m){this._pitchWithRotate=f.pitchWithRotate,this._mouseRotate=l,this._mousePitch=m};Wc.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Wc.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Wc.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Wc.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Gs=function(f,l,m,C){this._el=f,this._touchZoom=l,this._touchRotate=m,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0};Gs.prototype.enable=function(d){this._touchZoom.enable(d),this._rotationDisabled||this._touchRotate.enable(d),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Gs.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Gs.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Gs.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Gs.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Gs.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var ps=function(f){return f.zoom||f.drag||f.pitch||f.rotate},Of=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f}(h.Event);function bi(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}var si=function(f,l){this._map=f,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ph(f),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(l),h.bindAll(["handleEvent","handleWindowEvent"],this);var m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[h.window.document,"mousemove",{capture:!0}],[h.window.document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[h.window,"blur",void 0]];for(var C=0,P=this._listeners;C<P.length;C+=1){var D=P[C],N=D[0];H.addEventListener(N,D[1],N===h.window.document?this.handleWindowEvent:this.handleEvent,D[2])}};si.prototype.destroy=function(){for(var d=0,f=this._listeners;d<f.length;d+=1){var l=f[d],m=l[0];H.removeEventListener(m,l[1],m===h.window.document?this.handleWindowEvent:this.handleEvent,l[2])}},si.prototype._addDefaultHandlers=function(d){var f=this._map,l=f.getCanvasContainer();this._add("mapEvent",new qa(f,d));var m=f.boxZoom=new Gu(f,d);this._add("boxZoom",m);var C=new bs,P=new Tl;f.doubleClickZoom=new Al(P,C),this._add("tapZoom",C),this._add("clickZoom",P);var D=new Za;this._add("tapDragZoom",D);var N=f.touchPitch=new Hc;this._add("touchPitch",N);var K=new hs(d),re=new hf(d);f.dragRotate=new Wc(d,K,re),this._add("mouseRotate",K,["mousePitch"]),this._add("mousePitch",re,["mouseRotate"]);var ge=new Gl(d),ye=new Vs(d);f.dragPan=new ts(l,ge,ye),this._add("mousePan",ge),this._add("touchPan",ye,["touchZoom","touchRotate"]);var we=new tp,We=new _u;f.touchZoomRotate=new Gs(l,We,we,D),this._add("touchRotate",we,["touchPan","touchZoom"]),this._add("touchZoom",We,["touchPan","touchRotate"]);var Ue=f.scrollZoom=new ma(f,this);this._add("scrollZoom",Ue,["mousePan"]);var tt=f.keyboard=new Wu;this._add("keyboard",tt),this._add("blockableMapEvent",new Kn(f));for(var Ze=0,$e=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Ze<$e.length;Ze+=1){var Ot=$e[Ze];d.interactive&&d[Ot]&&f[Ot].enable(d[Ot])}},si.prototype._add=function(d,f,l){this._handlers.push({handlerName:d,handler:f,allowed:l}),this._handlersById[d]=f},si.prototype.stop=function(d){if(!this._updatingCamera){for(var f=0,l=this._handlers;f<l.length;f+=1)l[f].handler.reset();this._inertia.clear(),this._fireEvents({},{},d),this._changes=[]}},si.prototype.isActive=function(){for(var d=0,f=this._handlers;d<f.length;d+=1)if(f[d].handler.isActive())return!0;return!1},si.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},si.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},si.prototype.isMoving=function(){return Boolean(ps(this._eventsInProgress))||this.isZooming()},si.prototype._blockedByActive=function(d,f,l){for(var m in d)if(m!==l&&(!f||f.indexOf(m)<0))return!0;return!1},si.prototype.handleWindowEvent=function(d){this.handleEvent(d,d.type+"Window")},si.prototype._getMapTouches=function(d){for(var f=[],l=0,m=d;l<m.length;l+=1){var C=m[l];this._el.contains(C.target)&&f.push(C)}return f},si.prototype.handleEvent=function(d,f){this._updatingCamera=!0;for(var l=d.type==="renderFrame"?void 0:d,m={needsRenderFrame:!1},C={},P={},D=d.touches?this._getMapTouches(d.touches):void 0,N=D?H.touchPos(this._el,D):H.mousePos(this._el,d),K=0,re=this._handlers;K<re.length;K+=1){var ge=re[K],ye=ge.handlerName,we=ge.handler,We=ge.allowed;if(we.isEnabled()){var Ue=void 0;this._blockedByActive(P,We,ye)?we.reset():we[f||d.type]&&(Ue=we[f||d.type](d,N,D),this.mergeHandlerResult(m,C,Ue,ye,l),Ue&&Ue.needsRenderFrame&&this._triggerRenderFrame()),(Ue||we.isActive())&&(P[ye]=we)}}var tt={};for(var Ze in this._previousActiveHandlers)P[Ze]||(tt[Ze]=l);this._previousActiveHandlers=P,(Object.keys(tt).length||bi(m))&&(this._changes.push([m,C,tt]),this._triggerRenderFrame()),(Object.keys(P).length||bi(m))&&this._map._stop(!0),this._updatingCamera=!1;var $e=m.cameraAnimation;$e&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$e(this._map))},si.prototype.mergeHandlerResult=function(d,f,l,m,C){if(l){h.extend(d,l);var P={handlerName:m,originalEvent:l.originalEvent||C};l.zoomDelta!==void 0&&(f.zoom=P),l.panDelta!==void 0&&(f.drag=P),l.pitchDelta!==void 0&&(f.pitch=P),l.bearingDelta!==void 0&&(f.rotate=P)}},si.prototype._applyChanges=function(){for(var d={},f={},l={},m=0,C=this._changes;m<C.length;m+=1){var P=C[m],D=P[0],N=P[1],K=P[2];D.panDelta&&(d.panDelta=(d.panDelta||new h.Point(0,0))._add(D.panDelta)),D.zoomDelta&&(d.zoomDelta=(d.zoomDelta||0)+D.zoomDelta),D.bearingDelta&&(d.bearingDelta=(d.bearingDelta||0)+D.bearingDelta),D.pitchDelta&&(d.pitchDelta=(d.pitchDelta||0)+D.pitchDelta),D.around!==void 0&&(d.around=D.around),D.pinchAround!==void 0&&(d.pinchAround=D.pinchAround),D.noInertia&&(d.noInertia=D.noInertia),h.extend(f,N),h.extend(l,K)}this._updateMapTransform(d,f,l),this._changes=[]},si.prototype._updateMapTransform=function(d,f,l){var m=this._map,C=m.transform;if(!bi(d))return this._fireEvents(f,l,!0);var P=d.panDelta,D=d.zoomDelta,N=d.bearingDelta,K=d.pitchDelta,re=d.around,ge=d.pinchAround;ge!==void 0&&(re=ge),m._stop(!0),re=re||m.transform.centerPoint;var ye=C.pointLocation(P?re.sub(P):re);N&&(C.bearing+=N),K&&(C.pitch+=K),D&&(C.zoom+=D),C.setLocationAtPoint(ye,re),this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(f,l,!0)},si.prototype._fireEvents=function(d,f,l){var m=this,C=ps(this._eventsInProgress),P=ps(d),D={};for(var N in d)this._eventsInProgress[N]||(D[N+"start"]=d[N].originalEvent),this._eventsInProgress[N]=d[N];for(var K in!C&&P&&this._fireEvent("movestart",P.originalEvent),D)this._fireEvent(K,D[K]);for(var re in P&&this._fireEvent("move",P.originalEvent),d)this._fireEvent(re,d[re].originalEvent);var ge,ye={};for(var we in this._eventsInProgress){var We=this._eventsInProgress[we],Ue=We.handlerName,tt=We.originalEvent;this._handlersById[Ue].isActive()||(delete this._eventsInProgress[we],ye[we+"end"]=ge=f[Ue]||tt)}for(var Ze in ye)this._fireEvent(Ze,ye[Ze]);var $e=ps(this._eventsInProgress);if(l&&(C||P)&&!$e){this._updatingCamera=!0;var Ot=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Mt=function(qt){return qt!==0&&-m._bearingSnap<qt&&qt<m._bearingSnap};Ot?(Mt(Ot.bearing||this._map.getBearing())&&(Ot.bearing=0),this._map.easeTo(Ot,{originalEvent:ge})):(this._map.fire(new h.Event("moveend",{originalEvent:ge})),Mt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},si.prototype._fireEvent=function(d,f){this._map.fire(new h.Event(d,f?{originalEvent:f}:{}))},si.prototype._requestFrame=function(){var d=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(f){delete d._frameId,d.handleEvent(new Of("renderFrame",{timeStamp:f})),d._applyChanges()})},si.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Zc=function(d){function f(l,m){d.call(this),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=m.bearingSnap,h.bindAll(["_renderFrameCallback"],this)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getCenter=function(){return new h.LngLat(this.transform.center.lng,this.transform.center.lat)},f.prototype.setCenter=function(l,m){return this.jumpTo({center:l},m)},f.prototype.panBy=function(l,m,C){return l=h.Point.convert(l).mult(-1),this.panTo(this.transform.center,h.extend({offset:l},m),C)},f.prototype.panTo=function(l,m,C){return this.easeTo(h.extend({center:l},m),C)},f.prototype.getZoom=function(){return this.transform.zoom},f.prototype.setZoom=function(l,m){return this.jumpTo({zoom:l},m),this},f.prototype.zoomTo=function(l,m,C){return this.easeTo(h.extend({zoom:l},m),C)},f.prototype.zoomIn=function(l,m){return this.zoomTo(this.getZoom()+1,l,m),this},f.prototype.zoomOut=function(l,m){return this.zoomTo(this.getZoom()-1,l,m),this},f.prototype.getBearing=function(){return this.transform.bearing},f.prototype.setBearing=function(l,m){return this.jumpTo({bearing:l},m),this},f.prototype.getPadding=function(){return this.transform.padding},f.prototype.setPadding=function(l,m){return this.jumpTo({padding:l},m),this},f.prototype.rotateTo=function(l,m,C){return this.easeTo(h.extend({bearing:l},m),C)},f.prototype.resetNorth=function(l,m){return this.rotateTo(0,h.extend({duration:1e3},l),m),this},f.prototype.resetNorthPitch=function(l,m){return this.easeTo(h.extend({bearing:0,pitch:0,duration:1e3},l),m),this},f.prototype.snapToNorth=function(l,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,m):this},f.prototype.getPitch=function(){return this.transform.pitch},f.prototype.setPitch=function(l,m){return this.jumpTo({pitch:l},m),this},f.prototype.cameraForBounds=function(l,m){l=h.LngLatBounds.convert(l);var C=m&&m.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),C,m)},f.prototype._cameraForBoxAndBearing=function(l,m,C,P){var D={top:0,bottom:0,right:0,left:0};if(typeof(P=h.extend({padding:D,offset:[0,0],maxZoom:this.transform.maxZoom},P)).padding=="number"){var N=P.padding;P.padding={top:N,bottom:N,right:N,left:N}}P.padding=h.extend(D,P.padding);var K=this.transform,re=K.padding,ge=K.project(h.LngLat.convert(l)),ye=K.project(h.LngLat.convert(m)),we=ge.rotate(-C*Math.PI/180),We=ye.rotate(-C*Math.PI/180),Ue=new h.Point(Math.max(we.x,We.x),Math.max(we.y,We.y)),tt=new h.Point(Math.min(we.x,We.x),Math.min(we.y,We.y)),Ze=Ue.sub(tt),$e=(K.width-(re.left+re.right+P.padding.left+P.padding.right))/Ze.x,Ot=(K.height-(re.top+re.bottom+P.padding.top+P.padding.bottom))/Ze.y;if(!(Ot<0||$e<0)){var Mt=Math.min(K.scaleZoom(K.scale*Math.min($e,Ot)),P.maxZoom),Sr=typeof P.offset.x=="number"?new h.Point(P.offset.x,P.offset.y):h.Point.convert(P.offset),qt=new h.Point((P.padding.left-P.padding.right)/2,(P.padding.top-P.padding.bottom)/2).rotate(C*Math.PI/180),gr=Sr.add(qt).mult(K.scale/K.zoomScale(Mt));return{center:K.unproject(ge.add(ye).div(2).sub(gr)),zoom:Mt,bearing:C}}h.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},f.prototype.fitBounds=function(l,m,C){return this._fitInternal(this.cameraForBounds(l,m),m,C)},f.prototype.fitScreenCoordinates=function(l,m,C,P,D){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(h.Point.convert(l)),this.transform.pointLocation(h.Point.convert(m)),C,P),P,D)},f.prototype._fitInternal=function(l,m,C){return l?(delete(m=h.extend(l,m)).padding,m.linear?this.easeTo(m,C):this.flyTo(m,C)):this},f.prototype.jumpTo=function(l,m){this.stop();var C=this.transform,P=!1,D=!1,N=!1;return"zoom"in l&&C.zoom!==+l.zoom&&(P=!0,C.zoom=+l.zoom),l.center!==void 0&&(C.center=h.LngLat.convert(l.center)),"bearing"in l&&C.bearing!==+l.bearing&&(D=!0,C.bearing=+l.bearing),"pitch"in l&&C.pitch!==+l.pitch&&(N=!0,C.pitch=+l.pitch),l.padding==null||C.isPaddingEqual(l.padding)||(C.padding=l.padding),this.fire(new h.Event("movestart",m)).fire(new h.Event("move",m)),P&&this.fire(new h.Event("zoomstart",m)).fire(new h.Event("zoom",m)).fire(new h.Event("zoomend",m)),D&&this.fire(new h.Event("rotatestart",m)).fire(new h.Event("rotate",m)).fire(new h.Event("rotateend",m)),N&&this.fire(new h.Event("pitchstart",m)).fire(new h.Event("pitch",m)).fire(new h.Event("pitchend",m)),this.fire(new h.Event("moveend",m))},f.prototype.easeTo=function(l,m){var C=this;this._stop(!1,l.easeId),((l=h.extend({offset:[0,0],duration:500,easing:h.ease},l)).animate===!1||!l.essential&&h.browser.prefersReducedMotion)&&(l.duration=0);var P=this.transform,D=this.getZoom(),N=this.getBearing(),K=this.getPitch(),re=this.getPadding(),ge="zoom"in l?+l.zoom:D,ye="bearing"in l?this._normalizeBearing(l.bearing,N):N,we="pitch"in l?+l.pitch:K,We="padding"in l?l.padding:P.padding,Ue=h.Point.convert(l.offset),tt=P.centerPoint.add(Ue),Ze=P.pointLocation(tt),$e=h.LngLat.convert(l.center||Ze);this._normalizeCenter($e);var Ot,Mt,Sr=P.project(Ze),qt=P.project($e).sub(Sr),gr=P.zoomScale(ge-D);l.around&&(Ot=h.LngLat.convert(l.around),Mt=P.locationPoint(Ot));var Tr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ge!==D,this._rotating=this._rotating||N!==ye,this._pitching=this._pitching||we!==K,this._padding=!P.isPaddingEqual(We),this._easeId=l.easeId,this._prepareEase(m,l.noMoveStart,Tr),this._ease(function(Dr){if(C._zooming&&(P.zoom=h.number(D,ge,Dr)),C._rotating&&(P.bearing=h.number(N,ye,Dr)),C._pitching&&(P.pitch=h.number(K,we,Dr)),C._padding&&(P.interpolatePadding(re,We,Dr),tt=P.centerPoint.add(Ue)),Ot)P.setLocationAtPoint(Ot,Mt);else{var nn=P.zoomScale(P.zoom-D),An=ge>D?Math.min(2,gr):Math.max(.5,gr),Vn=Math.pow(An,1-Dr),mi=P.unproject(Sr.add(qt.mult(Dr*Vn)).mult(nn));P.setLocationAtPoint(P.renderWorldCopies?mi.wrap():mi,tt)}C._fireMoveEvents(m)},function(Dr){C._afterEase(m,Dr)},l),this},f.prototype._prepareEase=function(l,m,C){C===void 0&&(C={}),this._moving=!0,m||C.moving||this.fire(new h.Event("movestart",l)),this._zooming&&!C.zooming&&this.fire(new h.Event("zoomstart",l)),this._rotating&&!C.rotating&&this.fire(new h.Event("rotatestart",l)),this._pitching&&!C.pitching&&this.fire(new h.Event("pitchstart",l))},f.prototype._fireMoveEvents=function(l){this.fire(new h.Event("move",l)),this._zooming&&this.fire(new h.Event("zoom",l)),this._rotating&&this.fire(new h.Event("rotate",l)),this._pitching&&this.fire(new h.Event("pitch",l))},f.prototype._afterEase=function(l,m){if(!this._easeId||!m||this._easeId!==m){delete this._easeId;var C=this._zooming,P=this._rotating,D=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,C&&this.fire(new h.Event("zoomend",l)),P&&this.fire(new h.Event("rotateend",l)),D&&this.fire(new h.Event("pitchend",l)),this.fire(new h.Event("moveend",l))}},f.prototype.flyTo=function(l,m){var C=this;if(!l.essential&&h.browser.prefersReducedMotion){var P=h.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(P,m)}this.stop(),l=h.extend({offset:[0,0],speed:1.2,curve:1.42,easing:h.ease},l);var D=this.transform,N=this.getZoom(),K=this.getBearing(),re=this.getPitch(),ge=this.getPadding(),ye="zoom"in l?h.clamp(+l.zoom,D.minZoom,D.maxZoom):N,we="bearing"in l?this._normalizeBearing(l.bearing,K):K,We="pitch"in l?+l.pitch:re,Ue="padding"in l?l.padding:D.padding,tt=D.zoomScale(ye-N),Ze=h.Point.convert(l.offset),$e=D.centerPoint.add(Ze),Ot=D.pointLocation($e),Mt=h.LngLat.convert(l.center||Ot);this._normalizeCenter(Mt);var Sr=D.project(Ot),qt=D.project(Mt).sub(Sr),gr=l.curve,Tr=Math.max(D.width,D.height),Dr=Tr/tt,nn=qt.mag();if("minZoom"in l){var An=h.clamp(Math.min(l.minZoom,N,ye),D.minZoom,D.maxZoom),Vn=Tr/D.zoomScale(An-N);gr=Math.sqrt(Vn/nn*2)}var mi=gr*gr;function yi(Ai){var na=(Dr*Dr-Tr*Tr+(Ai?-1:1)*mi*mi*nn*nn)/(2*(Ai?Dr:Tr)*mi*nn);return Math.log(Math.sqrt(na*na+1)-na)}function Ni(Ai){return(Math.exp(Ai)-Math.exp(-Ai))/2}function Ii(Ai){return(Math.exp(Ai)+Math.exp(-Ai))/2}var $n=yi(0),zi=function(na){return Ii($n)/Ii($n+gr*na)},Wi=function(na){return Tr*((Ii($n)*(Ni(wa=$n+gr*na)/Ii(wa))-Ni($n))/mi)/nn;var wa},ui=(yi(1)-$n)/gr;if(Math.abs(nn)<1e-6||!isFinite(ui)){if(Math.abs(Tr-Dr)<1e-6)return this.easeTo(l,m);var ea=Dr<Tr?-1:1;ui=Math.abs(Math.log(Dr/Tr))/gr,Wi=function(){return 0},zi=function(na){return Math.exp(ea*gr*na)}}return l.duration="duration"in l?+l.duration:1e3*ui/("screenSpeed"in l?+l.screenSpeed/gr:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=K!==we,this._pitching=We!==re,this._padding=!D.isPaddingEqual(Ue),this._prepareEase(m,!1),this._ease(function(Ai){var na=Ai*ui,wa=1/zi(na);D.zoom=Ai===1?ye:N+D.scaleZoom(wa),C._rotating&&(D.bearing=h.number(K,we,Ai)),C._pitching&&(D.pitch=h.number(re,We,Ai)),C._padding&&(D.interpolatePadding(ge,Ue,Ai),$e=D.centerPoint.add(Ze));var rs=Ai===1?Mt:D.unproject(Sr.add(qt.mult(Wi(na))).mult(wa));D.setLocationAtPoint(D.renderWorldCopies?rs.wrap():rs,$e),C._fireMoveEvents(m)},function(){return C._afterEase(m)},l),this},f.prototype.isEasing=function(){return!!this._easeFrameId},f.prototype.stop=function(){return this._stop()},f.prototype._stop=function(l,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var C=this._onEaseEnd;delete this._onEaseEnd,C.call(this,m)}if(!l){var P=this.handlers;P&&P.stop(!1)}return this},f.prototype._ease=function(l,m,C){C.animate===!1||C.duration===0?(l(1),m()):(this._easeStart=h.browser.now(),this._easeOptions=C,this._onEaseFrame=l,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},f.prototype._renderFrameCallback=function(){var l=Math.min((h.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},f.prototype._normalizeBearing=function(l,m){l=h.wrap(l,-180,180);var C=Math.abs(l-m);return Math.abs(l-360-m)<C&&(l-=360),Math.abs(l+360-m)<C&&(l+=360),l},f.prototype._normalizeCenter=function(l){var m=this.transform;if(m.renderWorldCopies&&!m.lngRange){var C=l.lng-m.center.lng;l.lng+=C>180?-360:C<-180?360:0}},f}(h.Evented),ko=function(f){f===void 0&&(f={}),this.options=f,h.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};ko.prototype.getDefaultPosition=function(){return"bottom-right"},ko.prototype.onAdd=function(d){var f=this.options&&this.options.compact;return this._map=d,this._container=H.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=H.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=H.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ko.prototype.onRemove=function(){H.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ko.prototype._setElementTitle=function(d,f){var l=this._map._getUIString("AttributionControl."+f);d.title=l,d.setAttribute("aria-label",l)},ko.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},ko.prototype._updateEditLink=function(){var d=this._editLink;d||(d=this._editLink=this._container.querySelector(".mapbox-improve-map"));var f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||h.config.ACCESS_TOKEN}];if(d){var l=f.reduce(function(m,C,P){return C.value&&(m+=C.key+"="+C.value+(P<f.length-1?"&":"")),m},"?");d.href=h.config.FEEDBACK_URL+"/"+l+(this._map._hash?this._map._hash.getHashString(!0):""),d.rel="noopener nofollow",this._setElementTitle(d,"MapFeedback")}},ko.prototype._updateData=function(d){!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},ko.prototype._updateAttributions=function(){if(this._map.style){var d=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?d=d.concat(this.options.customAttribution.map(function(N){return typeof N!="string"?"":N})):typeof this.options.customAttribution=="string"&&d.push(this.options.customAttribution)),this._map.style.stylesheet){var f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}var l=this._map.style.sourceCaches;for(var m in l){var C=l[m];if(C.used){var P=C.getSource();P.attribution&&d.indexOf(P.attribution)<0&&d.push(P.attribution)}}d.sort(function(N,K){return N.length-K.length});var D=(d=d.filter(function(N,K){for(var re=K+1;re<d.length;re++)if(d[re].indexOf(N)>=0)return!1;return!0})).join(" | ");D!==this._attribHTML&&(this._attribHTML=D,d.length?(this._innerContainer.innerHTML=D,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},ko.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Zu=function(){h.bindAll(["_updateLogo"],this),h.bindAll(["_updateCompact"],this)};Zu.prototype.onAdd=function(d){this._map=d,this._container=H.create("div","mapboxgl-ctrl");var f=H.create("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Zu.prototype.onRemove=function(){H.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Zu.prototype.getDefaultPosition=function(){return"bottom-left"},Zu.prototype._updateLogo=function(d){d&&d.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Zu.prototype._logoRequired=function(){if(this._map.style){var d=this._map.style.sourceCaches;for(var f in d)if(d[f].getSource().mapbox_logo)return!0;return!1}},Zu.prototype._updateCompact=function(){var d=this._container.children;if(d.length){var f=d[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}};var ds=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};ds.prototype.add=function(d){var f=++this._id;return this._queue.push({callback:d,id:f,cancelled:!1}),f},ds.prototype.remove=function(d){for(var f=this._currentlyRunning,l=0,m=f?this._queue.concat(f):this._queue;l<m.length;l+=1){var C=m[l];if(C.id===d)return void(C.cancelled=!0)}},ds.prototype.run=function(d){d===void 0&&(d=0);var f=this._currentlyRunning=this._queue;this._queue=[];for(var l=0,m=f;l<m.length;l+=1){var C=m[l];if(!C.cancelled&&(C.callback(d),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},ds.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var nl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Sc=h.window.HTMLImageElement,vs=h.window.HTMLElement,Qa=h.window.ImageBitmap,Hs={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Cc=function(d){function f(m){var C=this;if((m=h.extend({},Hs,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var P=new Qn(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies);if(d.call(this,P,m),this._interactive=m.interactive,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new ds,this._controls=[],this._mapId=h.uniqueId(),this._locale=h.extend({},nl,m.locale),this._clickTolerance=m.clickTolerance,this._requestManager=new h.RequestManager(m.transformRequest,m.accessToken),typeof m.container=="string"){if(this._container=h.window.document.getElementById(m.container),!this._container)throw new Error("Container '"+m.container+"' not found.")}else{if(!(m.container instanceof vs))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),h.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return C._update(!1)}),this.on("moveend",function(){return C._update(!1)}),this.on("zoom",function(){return C._update(!0)}),h.window!==void 0&&(h.window.addEventListener("online",this._onWindowOnline,!1),h.window.addEventListener("resize",this._onWindowResize,!1),h.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new si(this,m),this._hash=m.hash&&new Da(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,h.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new ko({customAttribution:m.customAttribution})),this.addControl(new Zu,m.logoPosition),this.on("style.load",function(){C.transform.unmodified&&C.jumpTo(C.style.stylesheet)}),this.on("data",function(D){C._update(D.dataType==="style"),C.fire(new h.Event(D.dataType+"data",D))}),this.on("dataloading",function(D){C.fire(new h.Event(D.dataType+"dataloading",D))})}d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f;var l={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return f.prototype._getMapId=function(){return this._mapId},f.prototype.addControl=function(m,C){if(C===void 0&&(C=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var P=m.onAdd(this);this._controls.push(m);var D=this._controlPositions[C];return C.indexOf("bottom")!==-1?D.insertBefore(P,D.firstChild):D.appendChild(P),this},f.prototype.removeControl=function(m){if(!m||!m.onRemove)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var C=this._controls.indexOf(m);return C>-1&&this._controls.splice(C,1),m.onRemove(this),this},f.prototype.hasControl=function(m){return this._controls.indexOf(m)>-1},f.prototype.resize=function(m){var C=this._containerDimensions(),P=C[0],D=C[1];if(P===this.transform.width&&D===this.transform.height)return this;this._resizeCanvas(P,D),this.transform.resize(P,D),this.painter.resize(P,D);var N=!this._moving;return N&&this.fire(new h.Event("movestart",m)).fire(new h.Event("move",m)),this.fire(new h.Event("resize",m)),N&&this.fire(new h.Event("moveend",m)),this},f.prototype.getBounds=function(){return this.transform.getBounds()},f.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},f.prototype.setMaxBounds=function(m){return this.transform.setMaxBounds(h.LngLatBounds.convert(m)),this._update()},f.prototype.setMinZoom=function(m){if((m=m==null?-2:m)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},f.prototype.getMinZoom=function(){return this.transform.minZoom},f.prototype.setMaxZoom=function(m){if((m=m==null?22:m)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")},f.prototype.getMaxZoom=function(){return this.transform.maxZoom},f.prototype.setMinPitch=function(m){if((m=m==null?0:m)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},f.prototype.getMinPitch=function(){return this.transform.minPitch},f.prototype.setMaxPitch=function(m){if((m=m==null?60:m)>60)throw new Error("maxPitch must be less than or equal to 60");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")},f.prototype.getMaxPitch=function(){return this.transform.maxPitch},f.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},f.prototype.setRenderWorldCopies=function(m){return this.transform.renderWorldCopies=m,this._update()},f.prototype.project=function(m){return this.transform.locationPoint(h.LngLat.convert(m))},f.prototype.unproject=function(m){return this.transform.pointLocation(h.Point.convert(m))},f.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},f.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},f.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},f.prototype._createDelegatedListener=function(m,C,P){var D,N=this;if(m==="mouseenter"||m==="mouseover"){var K=!1;return{layer:C,listener:P,delegates:{mousemove:function(ye){var we=N.getLayer(C)?N.queryRenderedFeatures(ye.point,{layers:[C]}):[];we.length?K||(K=!0,P.call(N,new $i(m,N,ye.originalEvent,{features:we}))):K=!1},mouseout:function(){K=!1}}}}if(m==="mouseleave"||m==="mouseout"){var re=!1;return{layer:C,listener:P,delegates:{mousemove:function(ye){(N.getLayer(C)?N.queryRenderedFeatures(ye.point,{layers:[C]}):[]).length?re=!0:re&&(re=!1,P.call(N,new $i(m,N,ye.originalEvent)))},mouseout:function(ye){re&&(re=!1,P.call(N,new $i(m,N,ye.originalEvent)))}}}}return{layer:C,listener:P,delegates:(D={},D[m]=function(ge){var ye=N.getLayer(C)?N.queryRenderedFeatures(ge.point,{layers:[C]}):[];ye.length&&(ge.features=ye,P.call(N,ge),delete ge.features)},D)}},f.prototype.on=function(m,C,P){if(P===void 0)return d.prototype.on.call(this,m,C);var D=this._createDelegatedListener(m,C,P);for(var N in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(D),D.delegates)this.on(N,D.delegates[N]);return this},f.prototype.once=function(m,C,P){if(P===void 0)return d.prototype.once.call(this,m,C);var D=this._createDelegatedListener(m,C,P);for(var N in D.delegates)this.once(N,D.delegates[N]);return this},f.prototype.off=function(m,C,P){var D=this;return P===void 0?d.prototype.off.call(this,m,C):(this._delegatedListeners&&this._delegatedListeners[m]&&function(N){for(var K=N[m],re=0;re<K.length;re++){var ge=K[re];if(ge.layer===C&&ge.listener===P){for(var ye in ge.delegates)D.off(ye,ge.delegates[ye]);return K.splice(re,1),D}}}(this._delegatedListeners),this)},f.prototype.queryRenderedFeatures=function(m,C){if(!this.style)return[];var P;if(C!==void 0||m===void 0||m instanceof h.Point||Array.isArray(m)||(C=m,m=void 0),C=C||{},(m=m||[[0,0],[this.transform.width,this.transform.height]])instanceof h.Point||typeof m[0]=="number")P=[h.Point.convert(m)];else{var D=h.Point.convert(m[0]),N=h.Point.convert(m[1]);P=[D,new h.Point(N.x,D.y),N,new h.Point(D.x,N.y),D]}return this.style.queryRenderedFeatures(P,C,this.transform)},f.prototype.querySourceFeatures=function(m,C){return this.style.querySourceFeatures(m,C)},f.prototype.setStyle=function(m,C){return(C=h.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},C)).diff!==!1&&C.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,C),this):(this._localIdeographFontFamily=C.localIdeographFontFamily,this._updateStyle(m,C))},f.prototype._getUIString=function(m){var C=this._locale[m];if(C==null)throw new Error("Missing UI string '"+m+"'");return C},f.prototype._updateStyle=function(m,C){return this.style&&(this.style.setEventedParent(null),this.style._remove()),m?(this.style=new co(this,C||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m),this):(delete this.style,this)},f.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new co(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},f.prototype._diffStyle=function(m,C){var P=this;if(typeof m=="string"){var D=this._requestManager.normalizeStyleURL(m),N=this._requestManager.transformRequest(D,h.ResourceType.Style);h.getJSON(N,function(K,re){K?P.fire(new h.ErrorEvent(K)):re&&P._updateDiff(re,C)})}else typeof m=="object"&&this._updateDiff(m,C)},f.prototype._updateDiff=function(m,C){try{this.style.setState(m)&&this._update(!0)}catch(P){h.warnOnce("Unable to perform style diff: "+(P.message||P.error||P)+".  Rebuilding the style from scratch."),this._updateStyle(m,C)}},f.prototype.getStyle=function(){if(this.style)return this.style.serialize()},f.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():h.warnOnce("There is no style added to the map.")},f.prototype.addSource=function(m,C){return this._lazyInitEmptyStyle(),this.style.addSource(m,C),this._update(!0)},f.prototype.isSourceLoaded=function(m){var C=this.style&&this.style.sourceCaches[m];if(C!==void 0)return C.loaded();this.fire(new h.ErrorEvent(new Error("There is no source with ID '"+m+"'")))},f.prototype.areTilesLoaded=function(){var m=this.style&&this.style.sourceCaches;for(var C in m){var P=m[C]._tiles;for(var D in P){var N=P[D];if(N.state!=="loaded"&&N.state!=="errored")return!1}}return!0},f.prototype.addSourceType=function(m,C,P){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,C,P)},f.prototype.removeSource=function(m){return this.style.removeSource(m),this._update(!0)},f.prototype.getSource=function(m){return this.style.getSource(m)},f.prototype.addImage=function(m,C,P){P===void 0&&(P={});var D=P.pixelRatio;D===void 0&&(D=1);var N=P.sdf;N===void 0&&(N=!1);var K=P.stretchX,re=P.stretchY,ge=P.content;if(this._lazyInitEmptyStyle(),C instanceof Sc||Qa&&C instanceof Qa){var ye=h.browser.getImageData(C);this.style.addImage(m,{data:new h.RGBAImage({width:ye.width,height:ye.height},ye.data),pixelRatio:D,stretchX:K,stretchY:re,content:ge,sdf:N,version:0})}else{if(C.width===void 0||C.height===void 0)return this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var we=C;this.style.addImage(m,{data:new h.RGBAImage({width:C.width,height:C.height},new Uint8Array(C.data)),pixelRatio:D,stretchX:K,stretchY:re,content:ge,sdf:N,version:0,userImage:we}),we.onAdd&&we.onAdd(this,m)}},f.prototype.updateImage=function(m,C){var P=this.style.getImage(m);if(!P)return this.fire(new h.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var D=C instanceof Sc||Qa&&C instanceof Qa?h.browser.getImageData(C):C,N=D.width,K=D.height,re=D.data;return N===void 0||K===void 0?this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):N!==P.data.width||K!==P.data.height?this.fire(new h.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(P.data.replace(re,!(C instanceof Sc||Qa&&C instanceof Qa)),void this.style.updateImage(m,P))},f.prototype.hasImage=function(m){return m?!!this.style.getImage(m):(this.fire(new h.ErrorEvent(new Error("Missing required image id"))),!1)},f.prototype.removeImage=function(m){this.style.removeImage(m)},f.prototype.loadImage=function(m,C){h.getImage(this._requestManager.transformRequest(m,h.ResourceType.Image),C)},f.prototype.listImages=function(){return this.style.listImages()},f.prototype.addLayer=function(m,C){return this._lazyInitEmptyStyle(),this.style.addLayer(m,C),this._update(!0)},f.prototype.moveLayer=function(m,C){return this.style.moveLayer(m,C),this._update(!0)},f.prototype.removeLayer=function(m){return this.style.removeLayer(m),this._update(!0)},f.prototype.getLayer=function(m){return this.style.getLayer(m)},f.prototype.setLayerZoomRange=function(m,C,P){return this.style.setLayerZoomRange(m,C,P),this._update(!0)},f.prototype.setFilter=function(m,C,P){return P===void 0&&(P={}),this.style.setFilter(m,C,P),this._update(!0)},f.prototype.getFilter=function(m){return this.style.getFilter(m)},f.prototype.setPaintProperty=function(m,C,P,D){return D===void 0&&(D={}),this.style.setPaintProperty(m,C,P,D),this._update(!0)},f.prototype.getPaintProperty=function(m,C){return this.style.getPaintProperty(m,C)},f.prototype.setLayoutProperty=function(m,C,P,D){return D===void 0&&(D={}),this.style.setLayoutProperty(m,C,P,D),this._update(!0)},f.prototype.getLayoutProperty=function(m,C){return this.style.getLayoutProperty(m,C)},f.prototype.setLight=function(m,C){return C===void 0&&(C={}),this._lazyInitEmptyStyle(),this.style.setLight(m,C),this._update(!0)},f.prototype.getLight=function(){return this.style.getLight()},f.prototype.setFeatureState=function(m,C){return this.style.setFeatureState(m,C),this._update()},f.prototype.removeFeatureState=function(m,C){return this.style.removeFeatureState(m,C),this._update()},f.prototype.getFeatureState=function(m){return this.style.getFeatureState(m)},f.prototype.getContainer=function(){return this._container},f.prototype.getCanvasContainer=function(){return this._canvasContainer},f.prototype.getCanvas=function(){return this._canvas},f.prototype._containerDimensions=function(){var m=0,C=0;return this._container&&(m=this._container.clientWidth||400,C=this._container.clientHeight||300),[m,C]},f.prototype._detectMissingCSS=function(){h.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&h.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},f.prototype._setupContainer=function(){var m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=H.create("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();var C=this._canvasContainer=H.create("div","mapboxgl-canvas-container",m);this._interactive&&C.classList.add("mapboxgl-interactive"),this._canvas=H.create("canvas","mapboxgl-canvas",C),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var P=this._containerDimensions();this._resizeCanvas(P[0],P[1]);var D=this._controlContainer=H.create("div","mapboxgl-control-container",m),N=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(K){N[K]=H.create("div","mapboxgl-ctrl-"+K,D)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},f.prototype._resizeCanvas=function(m,C){var P=h.browser.devicePixelRatio||1;this._canvas.width=P*m,this._canvas.height=P*C,this._canvas.style.width=m+"px",this._canvas.style.height=C+"px"},f.prototype._setupPainter=function(){var m=h.extend({},V.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),C=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);C?(this.painter=new At(C,this.transform),h.webpSupported.testSupport(C)):this.fire(new h.ErrorEvent(new Error("Failed to initialize WebGL")))},f.prototype._contextLost=function(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new h.Event("webglcontextlost",{originalEvent:m}))},f.prototype._contextRestored=function(m){this._setupPainter(),this.resize(),this._update(),this.fire(new h.Event("webglcontextrestored",{originalEvent:m}))},f.prototype._onMapScroll=function(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},f.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},f.prototype._update=function(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this},f.prototype._requestRenderFrame=function(m){return this._update(),this._renderTaskQueue.add(m)},f.prototype._cancelRenderFrame=function(m){this._renderTaskQueue.remove(m)},f.prototype._render=function(m){var C,P=this,D=0,N=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(C=N.createQueryEXT(),N.beginQueryEXT(N.TIME_ELAPSED_EXT,C),D=h.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),!this._removed){var K=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var re=this.transform.zoom,ge=h.browser.now();this.style.zoomHistory.update(re,ge);var ye=new h.EvaluationParameters(re,{now:ge,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),we=ye.crossFadingFactor();we===1&&we===this._crossFadingFactor||(K=!0,this._crossFadingFactor=we),this.style.update(ye)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new h.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new h.Event("load"))),this.style&&(this.style.hasTransitions()||K)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var We=h.browser.now()-D;N.endQueryEXT(N.TIME_ELAPSED_EXT,C),setTimeout(function(){var Ze=N.getQueryObjectEXT(C,N.QUERY_RESULT_EXT)/1e6;N.deleteQueryEXT(C),P.fire(new h.Event("gpu-timing-frame",{cpuTime:We,gpuTime:Ze}))},50)}if(this.listens("gpu-timing-layer")){var Ue=this.painter.collectGpuTimers();setTimeout(function(){var Ze=P.painter.queryGpuTimers(Ue);P.fire(new h.Event("gpu-timing-layer",{layerTimes:Ze}))},50)}var tt=this._sourcesDirty||this._styleDirty||this._placementDirty;return tt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.Event("idle")),!this._loaded||this._fullyLoaded||tt||(this._fullyLoaded=!0),this}},f.prototype.remove=function(){this._hash&&this._hash.remove();for(var m=0,C=this._controls;m<C.length;m+=1)C[m].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),h.window!==void 0&&(h.window.removeEventListener("resize",this._onWindowResize,!1),h.window.removeEventListener("orientationchange",this._onWindowResize,!1),h.window.removeEventListener("online",this._onWindowOnline,!1));var P=this.painter.context.gl.getExtension("WEBGL_lose_context");P&&P.loseContext(),Wl(this._canvasContainer),Wl(this._controlContainer),Wl(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new h.Event("remove"))},f.prototype.triggerRepaint=function(){var m=this;this.style&&!this._frame&&(this._frame=h.browser.frame(function(C){m._frame=null,m._render(C)}))},f.prototype._onWindowOnline=function(){this._update()},f.prototype._onWindowResize=function(m){this._trackResize&&this.resize({originalEvent:m})._update()},l.showTileBoundaries.get=function(){return!!this._showTileBoundaries},l.showTileBoundaries.set=function(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())},l.showPadding.get=function(){return!!this._showPadding},l.showPadding.set=function(m){this._showPadding!==m&&(this._showPadding=m,this._update())},l.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},l.showCollisionBoxes.set=function(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())},l.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},l.showOverdrawInspector.set=function(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())},l.repaint.get=function(){return!!this._repaint},l.repaint.set=function(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())},l.vertices.get=function(){return!!this._vertices},l.vertices.set=function(m){this._vertices=m,this._update()},f.prototype._setCacheLimits=function(m,C){h.setCacheLimits(m,C)},l.version.get=function(){return h.version},Object.defineProperties(f.prototype,l),f}(Zc);function Wl(d){d.parentNode&&d.parentNode.removeChild(d)}var dl={showCompass:!0,showZoom:!0,visualizePitch:!1},Ou=function(f){var l=this;this.options=h.extend({},dl,f),this._container=H.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(m){return m.preventDefault()}),this.options.showZoom&&(h.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(m){return l._map.zoomIn({},{originalEvent:m})}),H.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(m){return l._map.zoomOut({},{originalEvent:m})}),H.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(h.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(m){l.options.visualizePitch?l._map.resetNorthPitch({},{originalEvent:m}):l._map.resetNorth({},{originalEvent:m})}),this._compassIcon=H.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ou.prototype._updateZoomButtons=function(){var d=this._map.getZoom(),f=d===this._map.getMaxZoom(),l=d===this._map.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},Ou.prototype._rotateCompassArrow=function(){var d=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=d},Ou.prototype.onAdd=function(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Iu(this._map,this._compass,this.options.visualizePitch)),this._container},Ou.prototype.onRemove=function(){H.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ou.prototype._createButton=function(d,f){var l=H.create("button",d,this._container);return l.type="button",l.addEventListener("click",f),l},Ou.prototype._setButtonTitle=function(d,f){var l=this._map._getUIString("NavigationControl."+f);d.title=l,d.setAttribute("aria-label",l)};var Iu=function(f,l,m){m===void 0&&(m=!1),this._clickTolerance=10,this.element=l,this.mouseRotate=new hs({clickTolerance:f.dragRotate._mouseRotate._clickTolerance}),this.map=f,m&&(this.mousePitch=new hf({clickTolerance:f.dragRotate._mousePitch._clickTolerance})),h.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),H.addEventListener(l,"mousedown",this.mousedown),H.addEventListener(l,"touchstart",this.touchstart,{passive:!1}),H.addEventListener(l,"touchmove",this.touchmove),H.addEventListener(l,"touchend",this.touchend),H.addEventListener(l,"touchcancel",this.reset)};function Pe(d,f,l){if(d=new h.LngLat(d.lng,d.lat),f){var m=new h.LngLat(d.lng-360,d.lat),C=new h.LngLat(d.lng+360,d.lat),P=l.locationPoint(d).distSqr(f);l.locationPoint(m).distSqr(f)<P?d=m:l.locationPoint(C).distSqr(f)<P&&(d=C)}for(;Math.abs(d.lng-l.center.lng)>180;){var D=l.locationPoint(d);if(D.x>=0&&D.y>=0&&D.x<=l.width&&D.y<=l.height)break;d.lng>l.center.lng?d.lng-=360:d.lng+=360}return d}Iu.prototype.down=function(d,f){this.mouseRotate.mousedown(d,f),this.mousePitch&&this.mousePitch.mousedown(d,f),H.disableDrag()},Iu.prototype.move=function(d,f){var l=this.map,m=this.mouseRotate.mousemoveWindow(d,f);if(m&&m.bearingDelta&&l.setBearing(l.getBearing()+m.bearingDelta),this.mousePitch){var C=this.mousePitch.mousemoveWindow(d,f);C&&C.pitchDelta&&l.setPitch(l.getPitch()+C.pitchDelta)}},Iu.prototype.off=function(){var d=this.element;H.removeEventListener(d,"mousedown",this.mousedown),H.removeEventListener(d,"touchstart",this.touchstart,{passive:!1}),H.removeEventListener(d,"touchmove",this.touchmove),H.removeEventListener(d,"touchend",this.touchend),H.removeEventListener(d,"touchcancel",this.reset),this.offTemp()},Iu.prototype.offTemp=function(){H.enableDrag(),H.removeEventListener(h.window,"mousemove",this.mousemove),H.removeEventListener(h.window,"mouseup",this.mouseup)},Iu.prototype.mousedown=function(d){this.down(h.extend({},d,{ctrlKey:!0,preventDefault:function(){return d.preventDefault()}}),H.mousePos(this.element,d)),H.addEventListener(h.window,"mousemove",this.mousemove),H.addEventListener(h.window,"mouseup",this.mouseup)},Iu.prototype.mousemove=function(d){this.move(d,H.mousePos(this.element,d))},Iu.prototype.mouseup=function(d){this.mouseRotate.mouseupWindow(d),this.mousePitch&&this.mousePitch.mouseupWindow(d),this.offTemp()},Iu.prototype.touchstart=function(d){d.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=H.touchPos(this.element,d.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return d.preventDefault()}},this._startPos))},Iu.prototype.touchmove=function(d){d.targetTouches.length!==1?this.reset():(this._lastPos=H.touchPos(this.element,d.targetTouches)[0],this.move({preventDefault:function(){return d.preventDefault()}},this._lastPos))},Iu.prototype.touchend=function(d){d.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Iu.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var xu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function df(d,f,l){var m=d.classList;for(var C in xu)m.remove("mapboxgl-"+l+"-anchor-"+C);m.add("mapboxgl-"+l+"-anchor-"+f)}var su,Fa=function(d){function f(l,m){if(d.call(this),(l instanceof h.window.HTMLElement||m)&&(l=h.extend({element:l},m)),h.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,l&&l.element)this._element=l.element,this._offset=h.Point.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=H.create("div"),this._element.setAttribute("aria-label","Map marker");var C=H.createNS("http://www.w3.org/2000/svg","svg");C.setAttributeNS(null,"display","block"),C.setAttributeNS(null,"height","41px"),C.setAttributeNS(null,"width","27px"),C.setAttributeNS(null,"viewBox","0 0 27 41");var P=H.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"stroke","none"),P.setAttributeNS(null,"stroke-width","1"),P.setAttributeNS(null,"fill","none"),P.setAttributeNS(null,"fill-rule","evenodd");var D=H.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"fill-rule","nonzero");var N=H.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(3.0, 29.0)"),N.setAttributeNS(null,"fill","#000000");for(var K=0,re=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];K<re.length;K+=1){var ge=re[K],ye=H.createNS("http://www.w3.org/2000/svg","ellipse");ye.setAttributeNS(null,"opacity","0.04"),ye.setAttributeNS(null,"cx","10.5"),ye.setAttributeNS(null,"cy","5.80029008"),ye.setAttributeNS(null,"rx",ge.rx),ye.setAttributeNS(null,"ry",ge.ry),N.appendChild(ye)}var we=H.createNS("http://www.w3.org/2000/svg","g");we.setAttributeNS(null,"fill",this._color);var We=H.createNS("http://www.w3.org/2000/svg","path");We.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),we.appendChild(We);var Ue=H.createNS("http://www.w3.org/2000/svg","g");Ue.setAttributeNS(null,"opacity","0.25"),Ue.setAttributeNS(null,"fill","#000000");var tt=H.createNS("http://www.w3.org/2000/svg","path");tt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ue.appendChild(tt);var Ze=H.createNS("http://www.w3.org/2000/svg","g");Ze.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ze.setAttributeNS(null,"fill","#FFFFFF");var $e=H.createNS("http://www.w3.org/2000/svg","g");$e.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Ot=H.createNS("http://www.w3.org/2000/svg","circle");Ot.setAttributeNS(null,"fill","#000000"),Ot.setAttributeNS(null,"opacity","0.25"),Ot.setAttributeNS(null,"cx","5.5"),Ot.setAttributeNS(null,"cy","5.5"),Ot.setAttributeNS(null,"r","5.4999962");var Mt=H.createNS("http://www.w3.org/2000/svg","circle");Mt.setAttributeNS(null,"fill","#FFFFFF"),Mt.setAttributeNS(null,"cx","5.5"),Mt.setAttributeNS(null,"cy","5.5"),Mt.setAttributeNS(null,"r","5.4999962"),$e.appendChild(Ot),$e.appendChild(Mt),D.appendChild(N),D.appendChild(we),D.appendChild(Ue),D.appendChild(Ze),D.appendChild($e),C.appendChild(D),C.setAttributeNS(null,"height",41*this._scale+"px"),C.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(C),this._offset=h.Point.convert(l&&l.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Sr){Sr.preventDefault()}),this._element.addEventListener("mousedown",function(Sr){Sr.preventDefault()}),df(this._element,this._anchor,"marker"),this._popup=null}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.addTo=function(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},f.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),H.remove(this._element),this._popup&&this._popup.remove(),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(l){return this._lngLat=h.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},f.prototype.getElement=function(){return this._element},f.prototype.setPopup=function(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){var m=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(24.6+m)],"bottom-right":[-m,-1*(24.6+m)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=l,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},f.prototype._onKeyPress=function(l){var m=l.code,C=l.charCode||l.keyCode;m!=="Space"&&m!=="Enter"&&C!==32&&C!==13||this.togglePopup()},f.prototype._onMapClick=function(l){var m=l.originalEvent.target,C=this._element;this._popup&&(m===C||C.contains(m))&&this.togglePopup()},f.prototype.getPopup=function(){return this._popup},f.prototype.togglePopup=function(){var l=this._popup;return l?(l.isOpen()?l.remove():l.addTo(this._map),this):this},f.prototype._update=function(l){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Pe(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(m="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var C="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?C="rotateX(0deg)":this._pitchAlignment==="map"&&(C="rotateX("+this._map.getPitch()+"deg)"),l&&l.type!=="moveend"||(this._pos=this._pos.round()),H.setTransform(this._element,xu[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+C+" "+m)}},f.prototype.getOffset=function(){return this._offset},f.prototype.setOffset=function(l){return this._offset=h.Point.convert(l),this._update(),this},f.prototype._onMove=function(l){if(!this._isDragging){var m=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.Event("dragstart"))),this.fire(new h.Event("drag")))},f.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.Event("dragend")),this._state="inactive"},f.prototype._addDragHandler=function(l){this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},f.prototype.setDraggable=function(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},f.prototype.isDraggable=function(){return this._draggable},f.prototype.setRotation=function(l){return this._rotation=l||0,this._update(),this},f.prototype.getRotation=function(){return this._rotation},f.prototype.setRotationAlignment=function(l){return this._rotationAlignment=l||"auto",this._update(),this},f.prototype.getRotationAlignment=function(){return this._rotationAlignment},f.prototype.setPitchAlignment=function(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this},f.prototype.getPitchAlignment=function(){return this._pitchAlignment},f}(h.Evented),rp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Zl=0,If=!1,Xl=function(d){function f(l){d.call(this),this.options=h.extend({},rp,l),h.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.onAdd=function(l){var m;return this._map=l,this._container=H.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),m=this._setupUI,su!==void 0?m(su):h.window.navigator.permissions!==void 0?h.window.navigator.permissions.query({name:"geolocation"}).then(function(C){m(su=C.state!=="denied")}):m(su=!!h.window.navigator.geolocation),this._container},f.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(h.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),H.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Zl=0,If=!1},f.prototype._isOutOfMapMaxBounds=function(l){var m=this._map.getMaxBounds(),C=l.coords;return m&&(C.longitude<m.getWest()||C.longitude>m.getEast()||C.latitude<m.getSouth()||C.latitude>m.getNorth())},f.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},f.prototype._onSuccess=function(l){if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new h.Event("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("geolocate",l)),this._finish()}},f.prototype._updateCamera=function(l){var m=new h.LngLat(l.coords.longitude,l.coords.latitude),C=l.coords.accuracy,P=this._map.getBearing(),D=h.extend({bearing:P},this.options.fitBoundsOptions);this._map.fitBounds(m.toBounds(C),D,{geolocateSource:!0})},f.prototype._updateMarker=function(l){if(l){var m=new h.LngLat(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map),this._userLocationDotMarker.setLngLat(m).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},f.prototype._updateCircleRadius=function(){var l=this._map._container.clientHeight/2,m=this._map.unproject([0,l]),C=this._map.unproject([1,l]),P=m.distanceTo(C),D=Math.ceil(2*this._accuracy/P);this._circleElement.style.width=D+"px",this._circleElement.style.height=D+"px"},f.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},f.prototype._onError=function(l){if(this._map){if(this.options.trackUserLocation)if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&If)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("error",l)),this._finish()}},f.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},f.prototype._setupUI=function(l){var m=this;if(this._container.addEventListener("contextmenu",function(D){return D.preventDefault()}),this._geolocateButton=H.create("button","mapboxgl-ctrl-geolocate",this._container),H.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",l===!1){h.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var C=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=C,this._geolocateButton.setAttribute("aria-label",C)}else{var P=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=P,this._geolocateButton.setAttribute("aria-label",P)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=H.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Fa(this._dotElement),this._circleElement=H.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Fa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(D){D.geolocateSource||m._watchState!=="ACTIVE_LOCK"||D.originalEvent&&D.originalEvent.type==="resize"||(m._watchState="BACKGROUND",m._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),m._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),m.fire(new h.Event("trackuserlocationend")))})},f.prototype.trigger=function(){if(!this._setup)return h.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Zl--,If=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new h.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var l;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Zl>1?(l={maximumAge:6e5,timeout:0},If=!0):(l=this.options.positionOptions,If=!1),this._geolocationWatchID=h.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,l)}}else h.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},f.prototype._clearWatch=function(){h.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},f}(h.Evented),wc={maxWidth:100,unit:"metric"},Ml=function(f){this.options=h.extend({},wc,f),h.bindAll(["_onMove","setUnit"],this)};function Ac(d,f,l){var m=l&&l.maxWidth||100,C=d._container.clientHeight/2,P=d.unproject([0,C]),D=d.unproject([m,C]),N=P.distanceTo(D);if(l&&l.unit==="imperial"){var K=3.2808*N;K>5280?Pl(f,m,K/5280,d._getUIString("ScaleControl.Miles")):Pl(f,m,K,d._getUIString("ScaleControl.Feet"))}else l&&l.unit==="nautical"?Pl(f,m,N/1852,d._getUIString("ScaleControl.NauticalMiles")):N>=1e3?Pl(f,m,N/1e3,d._getUIString("ScaleControl.Kilometers")):Pl(f,m,N,d._getUIString("ScaleControl.Meters"))}function Pl(d,f,l,m){var C,P,D,N=(C=l,(P=Math.pow(10,(""+Math.floor(C)).length-1))*(D=(D=C/P)>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:function(K){var re=Math.pow(10,Math.ceil(-Math.log(K)/Math.LN10));return Math.round(K*re)/re}(D)));d.style.width=f*(N/l)+"px",d.innerHTML=N+"&nbsp;"+m}Ml.prototype.getDefaultPosition=function(){return"bottom-left"},Ml.prototype._onMove=function(){Ac(this._map,this._container,this.options)},Ml.prototype.onAdd=function(d){return this._map=d,this._container=H.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ml.prototype.onRemove=function(){H.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ml.prototype.setUnit=function(d){this.options.unit=d,Ac(this._map,this._container,this.options)};var bu=function(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof h.window.HTMLElement?this._container=f.container:h.warnOnce("Full screen control 'container' must be a DOM element.")),h.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in h.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in h.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in h.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in h.window.document&&(this._fullscreenchange="MSFullscreenChange")};bu.prototype.onAdd=function(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=H.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",h.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},bu.prototype.onRemove=function(){H.remove(this._controlContainer),this._map=null,h.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},bu.prototype._checkFullscreenSupport=function(){return!!(h.window.document.fullscreenEnabled||h.window.document.mozFullScreenEnabled||h.window.document.msFullscreenEnabled||h.window.document.webkitFullscreenEnabled)},bu.prototype._setupUI=function(){var d=this._fullscreenButton=H.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);H.create("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden",!0),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),h.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},bu.prototype._updateTitle=function(){var d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.title=d},bu.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},bu.prototype._isFullscreen=function(){return this._fullscreen},bu.prototype._changeIcon=function(){(h.window.document.fullscreenElement||h.window.document.mozFullScreenElement||h.window.document.webkitFullscreenElement||h.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},bu.prototype._onClickFullscreen=function(){this._isFullscreen()?h.window.document.exitFullscreen?h.window.document.exitFullscreen():h.window.document.mozCancelFullScreen?h.window.document.mozCancelFullScreen():h.window.document.msExitFullscreen?h.window.document.msExitFullscreen():h.window.document.webkitCancelFullScreen&&h.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Xu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ru=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Rf=function(d){function f(l){d.call(this),this.options=h.extend(Object.create(Xu),l),h.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.addTo=function(l){return this._map&&this.remove(),this._map=l,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new h.Event("open")),this},f.prototype.isOpen=function(){return!!this._map},f.prototype.remove=function(){return this._content&&H.remove(this._content),this._container&&(H.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new h.Event("close")),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(l){return this._lngLat=h.LngLat.convert(l),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},f.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},f.prototype.getElement=function(){return this._container},f.prototype.setText=function(l){return this.setDOMContent(h.window.document.createTextNode(l))},f.prototype.setHTML=function(l){var m,C=h.window.document.createDocumentFragment(),P=h.window.document.createElement("body");for(P.innerHTML=l;m=P.firstChild;)C.appendChild(m);return this.setDOMContent(C)},f.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},f.prototype.setMaxWidth=function(l){return this.options.maxWidth=l,this._update(),this},f.prototype.setDOMContent=function(l){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=H.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(l),this._createCloseButton(),this._update(),this._focusFirstElement(),this},f.prototype.addClassName=function(l){this._container&&this._container.classList.add(l)},f.prototype.removeClassName=function(l){this._container&&this._container.classList.remove(l)},f.prototype.setOffset=function(l){return this.options.offset=l,this._update(),this},f.prototype.toggleClassName=function(l){if(this._container)return this._container.classList.toggle(l)},f.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=H.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},f.prototype._onMouseUp=function(l){this._update(l.point)},f.prototype._onMouseMove=function(l){this._update(l.point)},f.prototype._onDrag=function(l){this._update(l.point)},f.prototype._update=function(l){var m=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=H.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=H.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(ye){return m._container.classList.add(ye)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Pe(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||l)){var C=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat),P=this.options.anchor,D=function ye(we){if(we){if(typeof we=="number"){var We=Math.round(Math.sqrt(.5*Math.pow(we,2)));return{center:new h.Point(0,0),top:new h.Point(0,we),"top-left":new h.Point(We,We),"top-right":new h.Point(-We,We),bottom:new h.Point(0,-we),"bottom-left":new h.Point(We,-We),"bottom-right":new h.Point(-We,-We),left:new h.Point(we,0),right:new h.Point(-we,0)}}if(we instanceof h.Point||Array.isArray(we)){var Ue=h.Point.convert(we);return{center:Ue,top:Ue,"top-left":Ue,"top-right":Ue,bottom:Ue,"bottom-left":Ue,"bottom-right":Ue,left:Ue,right:Ue}}return{center:h.Point.convert(we.center||[0,0]),top:h.Point.convert(we.top||[0,0]),"top-left":h.Point.convert(we["top-left"]||[0,0]),"top-right":h.Point.convert(we["top-right"]||[0,0]),bottom:h.Point.convert(we.bottom||[0,0]),"bottom-left":h.Point.convert(we["bottom-left"]||[0,0]),"bottom-right":h.Point.convert(we["bottom-right"]||[0,0]),left:h.Point.convert(we.left||[0,0]),right:h.Point.convert(we.right||[0,0])}}return ye(new h.Point(0,0))}(this.options.offset);if(!P){var N,K=this._container.offsetWidth,re=this._container.offsetHeight;N=C.y+D.bottom.y<re?["top"]:C.y>this._map.transform.height-re?["bottom"]:[],C.x<K/2?N.push("left"):C.x>this._map.transform.width-K/2&&N.push("right"),P=N.length===0?"bottom":N.join("-")}var ge=C.add(D[P]).round();H.setTransform(this._container,xu[P]+" translate("+ge.x+"px,"+ge.y+"px)"),df(this._container,P,"popup")}},f.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var l=this._container.querySelector(Ru);l&&l.focus()}},f.prototype._onClose=function(){this.remove()},f}(h.Evented),Oh={version:h.version,supported:V,setRTLTextPlugin:h.setRTLTextPlugin,getRTLTextPluginStatus:h.getRTLTextPluginStatus,Map:Cc,NavigationControl:Ou,GeolocateControl:Xl,AttributionControl:ko,ScaleControl:Ml,FullscreenControl:bu,Popup:Rf,Marker:Fa,Style:co,LngLat:h.LngLat,LngLatBounds:h.LngLatBounds,Point:h.Point,MercatorCoordinate:h.MercatorCoordinate,Evented:h.Evented,config:h.config,prewarm:function(){pr().acquire(dr)},clearPrewarmedResources:function(){var f=xn;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(dr),xn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return h.config.ACCESS_TOKEN},set accessToken(d){h.config.ACCESS_TOKEN=d},get baseApiUrl(){return h.config.API_URL},set baseApiUrl(d){h.config.API_URL=d},get workerCount(){return Yr.workerCount},set workerCount(d){Yr.workerCount=d},get maxParallelImageRequests(){return h.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){h.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage:function(f){h.clearTileCache(f)},workerUrl:""};return Oh}),Y})},"4cb6":function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.multiBindToService=$.getServiceIdentifierAsString=$.typeConstraint=$.namedConstraint=$.taggedConstraint=$.traverseAncerstors=$.decorate=$.id=$.MetadataReader=$.postConstruct=$.targetName=$.multiInject=$.unmanaged=$.optional=$.LazyServiceIdentifer=$.inject=$.named=$.tagged=$.injectable=$.ContainerModule=$.AsyncContainerModule=$.TargetTypeEnum=$.BindingTypeEnum=$.BindingScopeEnum=$.Container=$.METADATA_KEY=void 0;var j=M("xfSm");$.METADATA_KEY=j;var Z=M("9Fde");Object.defineProperty($,"Container",{enumerable:!0,get:function(){return Z.Container}});var Y=M("FV85");Object.defineProperty($,"BindingScopeEnum",{enumerable:!0,get:function(){return Y.BindingScopeEnum}}),Object.defineProperty($,"BindingTypeEnum",{enumerable:!0,get:function(){return Y.BindingTypeEnum}}),Object.defineProperty($,"TargetTypeEnum",{enumerable:!0,get:function(){return Y.TargetTypeEnum}});var k=M("dxzI");Object.defineProperty($,"AsyncContainerModule",{enumerable:!0,get:function(){return k.AsyncContainerModule}}),Object.defineProperty($,"ContainerModule",{enumerable:!0,get:function(){return k.ContainerModule}});var h=M("cZ5Q");Object.defineProperty($,"injectable",{enumerable:!0,get:function(){return h.injectable}});var V=M("0gSV");Object.defineProperty($,"tagged",{enumerable:!0,get:function(){return V.tagged}});var H=M("ZzCi");Object.defineProperty($,"named",{enumerable:!0,get:function(){return H.named}});var te=M("Yk9n");Object.defineProperty($,"inject",{enumerable:!0,get:function(){return te.inject}}),Object.defineProperty($,"LazyServiceIdentifer",{enumerable:!0,get:function(){return te.LazyServiceIdentifer}});var pe=M("jYx5");Object.defineProperty($,"optional",{enumerable:!0,get:function(){return pe.optional}});var Oe=M("n2J3");Object.defineProperty($,"unmanaged",{enumerable:!0,get:function(){return Oe.unmanaged}});var Ae=M("jIg/");Object.defineProperty($,"multiInject",{enumerable:!0,get:function(){return Ae.multiInject}});var vt=M("oaX6");Object.defineProperty($,"targetName",{enumerable:!0,get:function(){return vt.targetName}});var at=M("Sk89");Object.defineProperty($,"postConstruct",{enumerable:!0,get:function(){return at.postConstruct}});var gt=M("wnjb");Object.defineProperty($,"MetadataReader",{enumerable:!0,get:function(){return gt.MetadataReader}});var yt=M("d9O0");Object.defineProperty($,"id",{enumerable:!0,get:function(){return yt.id}});var St=M("Ztfv");Object.defineProperty($,"decorate",{enumerable:!0,get:function(){return St.decorate}});var He=M("RR/i");Object.defineProperty($,"traverseAncerstors",{enumerable:!0,get:function(){return He.traverseAncerstors}}),Object.defineProperty($,"taggedConstraint",{enumerable:!0,get:function(){return He.taggedConstraint}}),Object.defineProperty($,"namedConstraint",{enumerable:!0,get:function(){return He.namedConstraint}}),Object.defineProperty($,"typeConstraint",{enumerable:!0,get:function(){return He.typeConstraint}});var dt=M("ujMp");Object.defineProperty($,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return dt.getServiceIdentifierAsString}});var ct=M("78VC");Object.defineProperty($,"multiBindToService",{enumerable:!0,get:function(){return ct.multiBindToService}})},"4qC0":function(le,$,M){var j=M("NykK"),Z=M("Z0cm"),Y=M("ExA7"),k="[object String]";function h(V){return typeof V=="string"||!Z(V)&&Y(V)&&j(V)==k}le.exports=h},"5Tg0":function(le,$,M){(function(j){var Z=M("Kz5y"),Y=$&&!$.nodeType&&$,k=Y&&typeof j=="object"&&j&&!j.nodeType&&j,h=k&&k.exports===Y,V=h?Z.Buffer:void 0,H=V?V.allocUnsafe:void 0;function te(pe,Oe){if(Oe)return pe.slice();var Ae=pe.length,vt=H?H(Ae):new pe.constructor(Ae);return pe.copy(vt),vt}j.exports=te}).call(this,M("hOG+")(le))},"68d/":function(le,$,M){"use strict";M.d($,"b",function(){return _4}),M.d($,"c",function(){return wD}),M.d($,"a",function(){return AD});var j={};M.r(j),M.d(j,"getContainer",function(){return Gu}),M.d(j,"trim",function(){return cf}),M.d(j,"splitWords",function(){return Gc}),M.d(j,"create",function(){return bs}),M.d(j,"remove",function(){return ff}),M.d(j,"addClass",function(){return Ln}),M.d(j,"removeClass",function(){return Gl}),M.d(j,"hasClass",function(){return hs}),M.d(j,"setClass",function(){return hf}),M.d(j,"getClass",function(){return Vs}),M.d(j,"empty",function(){return Ms}),M.d(j,"setTransform",function(){return Hl}),M.d(j,"triggerResize",function(){return _u}),M.d(j,"printCanvas",function(){return Ec}),M.d(j,"getViewPortScale",function(){return tp}),M.d(j,"DPR",function(){return th});var Z={};M.r(Z),M.d(Z,"sum",function(){return Wi}),M.d(Z,"max",function(){return $n}),M.d(Z,"min",function(){return zi}),M.d(Z,"mean",function(){return ui}),M.d(Z,"mode",function(){return ea}),M.d(Z,"statMap",function(){return Ai}),M.d(Z,"getColumn",function(){return na}),M.d(Z,"getSatByColumn",function(){return wa});var Y={};M.r(Y),M.d(Y,"create",function(){return hv}),M.d(Y,"clone",function(){return td}),M.d(Y,"copy",function(){return pv}),M.d(Y,"identity",function(){return dv}),M.d(Y,"fromValues",function(){return $l}),M.d(Y,"set",function(){return cp}),M.d(Y,"transpose",function(){return fp}),M.d(Y,"invert",function(){return fh}),M.d(Y,"adjoint",function(){return po}),M.d(Y,"determinant",function(){return hh}),M.d(Y,"multiply",function(){return Ui}),M.d(Y,"rotate",function(){return xf}),M.d(Y,"scale",function(){return J}),M.d(Y,"fromRotation",function(){return he}),M.d(Y,"fromScaling",function(){return qe}),M.d(Y,"str",function(){return er}),M.d(Y,"frob",function(){return wr}),M.d(Y,"LDU",function(){return lr}),M.d(Y,"add",function(){return cr}),M.d(Y,"subtract",function(){return Hr}),M.d(Y,"exactEquals",function(){return tn}),M.d(Y,"equals",function(){return an}),M.d(Y,"multiplyScalar",function(){return un}),M.d(Y,"multiplyScalarAndAdd",function(){return on}),M.d(Y,"mul",function(){return kn}),M.d(Y,"sub",function(){return En});var k={};M.r(k),M.d(k,"create",function(){return Zr}),M.d(k,"clone",function(){return Vt}),M.d(k,"copy",function(){return tr}),M.d(k,"fromValues",function(){return Qr}),M.d(k,"set",function(){return zn}),M.d(k,"identity",function(){return Er}),M.d(k,"transpose",function(){return qn}),M.d(k,"invert",function(){return Bn}),M.d(k,"adjoint",function(){return pn}),M.d(k,"determinant",function(){return Rr}),M.d(k,"multiply",function(){return mr}),M.d(k,"translate",function(){return gn}),M.d(k,"scale",function(){return Sn}),M.d(k,"rotate",function(){return sn}),M.d(k,"rotateX",function(){return In}),M.d(k,"rotateY",function(){return Tn}),M.d(k,"rotateZ",function(){return ta}),M.d(k,"fromTranslation",function(){return ji}),M.d(k,"fromScaling",function(){return Fn}),M.d(k,"fromRotation",function(){return Dn}),M.d(k,"fromXRotation",function(){return Mi}),M.d(k,"fromYRotation",function(){return qi}),M.d(k,"fromZRotation",function(){return Ea}),M.d(k,"fromRotationTranslation",function(){return Ao}),M.d(k,"fromQuat2",function(){return ns}),M.d(k,"getTranslation",function(){return ia}),M.d(k,"getScaling",function(){return Zo}),M.d(k,"getRotation",function(){return Io}),M.d(k,"fromRotationTranslationScale",function(){return Os}),M.d(k,"fromRotationTranslationScaleOrigin",function(){return Is}),M.d(k,"fromQuat",function(){return lu}),M.d(k,"frustum",function(){return cu}),M.d(k,"perspectiveNO",function(){return fu}),M.d(k,"perspective",function(){return Xo}),M.d(k,"perspectiveZO",function(){return pa}),M.d(k,"perspectiveFromFieldOfView",function(){return Ns}),M.d(k,"orthoNO",function(){return Ga}),M.d(k,"ortho",function(){return Rs}),M.d(k,"orthoZO",function(){return ki}),M.d(k,"lookAt",function(){return ca}),M.d(k,"targetTo",function(){return yo}),M.d(k,"str",function(){return wu}),M.d(k,"frob",function(){return hu}),M.d(k,"add",function(){return Ge}),M.d(k,"subtract",function(){return hr}),M.d(k,"multiplyScalar",function(){return Wt}),M.d(k,"multiplyScalarAndAdd",function(){return Wn}),M.d(k,"exactEquals",function(){return va}),M.d(k,"equals",function(){return De}),M.d(k,"mul",function(){return Ee}),M.d(k,"sub",function(){return it});var h={};M.r(h),M.d(h,"create",function(){return Bt}),M.d(h,"clone",function(){return ur}),M.d(h,"fromValues",function(){return st}),M.d(h,"copy",function(){return ut}),M.d(h,"set",function(){return bt}),M.d(h,"add",function(){return Se}),M.d(h,"subtract",function(){return rt}),M.d(h,"multiply",function(){return Fe}),M.d(h,"divide",function(){return kt}),M.d(h,"ceil",function(){return $t}),M.d(h,"floor",function(){return Wr}),M.d(h,"min",function(){return bn}),M.d(h,"max",function(){return Cn}),M.d(h,"round",function(){return Un}),M.d(h,"scale",function(){return yn}),M.d(h,"scaleAndAdd",function(){return hi}),M.d(h,"distance",function(){return Zn}),M.d(h,"squaredDistance",function(){return ri}),M.d(h,"length",function(){return ii}),M.d(h,"squaredLength",function(){return li}),M.d(h,"negate",function(){return Ri}),M.d(h,"inverse",function(){return eo}),M.d(h,"normalize",function(){return Ks}),M.d(h,"dot",function(){return kl}),M.d(h,"cross",function(){return Jc}),M.d(h,"lerp",function(){return So}),M.d(h,"random",function(){return Ia}),M.d(h,"transformMat2",function(){return Oc}),M.d(h,"transformMat2d",function(){return ql}),M.d(h,"transformMat3",function(){return rd}),M.d(h,"transformMat4",function(){return hc}),M.d(h,"rotate",function(){return nd}),M.d(h,"angle",function(){return id}),M.d(h,"zero",function(){return Bh}),M.d(h,"str",function(){return hp}),M.d(h,"exactEquals",function(){return Qv}),M.d(h,"equals",function(){return $s}),M.d(h,"len",function(){return ad}),M.d(h,"sub",function(){return ph}),M.d(h,"mul",function(){return Pd}),M.d(h,"div",function(){return Od}),M.d(h,"dist",function(){return vv}),M.d(h,"sqrDist",function(){return pp}),M.d(h,"sqrLen",function(){return dh}),M.d(h,"forEach",function(){return od});var V={};M.r(V),M.d(V,"create",function(){return mv}),M.d(V,"clone",function(){return zm}),M.d(V,"length",function(){return pu}),M.d(V,"fromValues",function(){return Nh}),M.d(V,"copy",function(){return Jv}),M.d(V,"set",function(){return a}),M.d(V,"add",function(){return o}),M.d(V,"subtract",function(){return u}),M.d(V,"multiply",function(){return v}),M.d(V,"divide",function(){return _}),M.d(V,"ceil",function(){return S}),M.d(V,"floor",function(){return A}),M.d(V,"min",function(){return R}),M.d(V,"max",function(){return z}),M.d(V,"round",function(){return W}),M.d(V,"scale",function(){return q}),M.d(V,"scaleAndAdd",function(){return ne}),M.d(V,"distance",function(){return ae}),M.d(V,"squaredDistance",function(){return Te}),M.d(V,"squaredLength",function(){return je}),M.d(V,"negate",function(){return Be}),M.d(V,"inverse",function(){return Je}),M.d(V,"normalize",function(){return Qe}),M.d(V,"dot",function(){return Tt}),M.d(V,"cross",function(){return Zt}),M.d(V,"lerp",function(){return ar}),M.d(V,"hermite",function(){return Lr}),M.d(V,"bezier",function(){return xr}),M.d(V,"random",function(){return dn}),M.d(V,"transformMat4",function(){return _n}),M.d(V,"transformMat3",function(){return ci}),M.d(V,"transformQuat",function(){return _i}),M.d(V,"rotateX",function(){return vi}),M.d(V,"rotateY",function(){return ti}),M.d(V,"rotateZ",function(){return Zi}),M.d(V,"angle",function(){return Pi}),M.d(V,"zero",function(){return xi}),M.d(V,"str",function(){return Pa}),M.d(V,"exactEquals",function(){return aa}),M.d(V,"equals",function(){return to}),M.d(V,"sub",function(){return Fi}),M.d(V,"mul",function(){return Ra}),M.d(V,"div",function(){return Do}),M.d(V,"dist",function(){return Fo}),M.d(V,"sqrDist",function(){return is}),M.d(V,"len",function(){return as}),M.d(V,"sqrLen",function(){return Yo}),M.d(V,"forEach",function(){return qs});var H={};M.r(H),M.d(H,"create",function(){return Ls}),M.d(H,"clone",function(){return ol}),M.d(H,"fromValues",function(){return Qs}),M.d(H,"copy",function(){return $u}),M.d(H,"set",function(){return du}),M.d(H,"add",function(){return Js}),M.d(H,"subtract",function(){return eu}),M.d(H,"multiply",function(){return za}),M.d(H,"divide",function(){return La}),M.d(H,"ceil",function(){return To}),M.d(H,"floor",function(){return Bo}),M.d(H,"min",function(){return sl}),M.d(H,"max",function(){return Vo}),M.d(H,"round",function(){return os}),M.d(H,"scale",function(){return Bu}),M.d(H,"scaleAndAdd",function(){return Ua}),M.d(H,"distance",function(){return Nu}),M.d(H,"squaredDistance",function(){return pc}),M.d(H,"length",function(){return ef}),M.d(H,"squaredLength",function(){return Au}),M.d(H,"negate",function(){return Xi}),M.d(H,"inverse",function(){return vh}),M.d(H,"normalize",function(){return vu}),M.d(H,"dot",function(){return Ko}),M.d(H,"cross",function(){return sd}),M.d(H,"lerp",function(){return gl}),M.d(H,"random",function(){return ud}),M.d(H,"transformMat4",function(){return Lp}),M.d(H,"transformQuat",function(){return kp}),M.d(H,"zero",function(){return Id}),M.d(H,"str",function(){return ld}),M.d(H,"exactEquals",function(){return Dp}),M.d(H,"equals",function(){return zh}),M.d(H,"sub",function(){return dc}),M.d(H,"mul",function(){return cd}),M.d(H,"div",function(){return mh}),M.d(H,"dist",function(){return Go}),M.d(H,"sqrDist",function(){return Cs}),M.d(H,"len",function(){return fd}),M.d(H,"sqrLen",function(){return Rd}),M.d(H,"forEach",function(){return Fp});var te=M("q1tI"),pe=M.n(te),Oe=Object(te.createContext)({});function Ae(){return Object(te.useContext)(Oe)}var vt={},at={},gt=function(r){return at[r]},yt=function(r,t){at[r]=t},St=function(r){return vt[r]},He=function(r,t){vt[r]=t},dt={},ct={},_t=34,ee=10,rr=13;function Fr(e){return new Function("d","return {"+e.map(function(r,t){return JSON.stringify(r)+": d["+t+'] || ""'}).join(",")+"}")}function Mr(e,r){var t=Fr(e);return function(n,i){return r(t(n),i,e)}}function Nt(e){var r=Object.create(null),t=[];return e.forEach(function(n){for(var i in n)i in r||t.push(r[i]=i)}),t}function ze(e,r){var t=e+"",n=t.length;return n<r?new Array(r-n+1).join(0)+t:t}function zt(e){return e<0?"-"+ze(-e,6):e>9999?"+"+ze(e,6):ze(e,4)}function Kt(e){var r=e.getUTCHours(),t=e.getUTCMinutes(),n=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":zt(e.getUTCFullYear(),4)+"-"+ze(e.getUTCMonth()+1,2)+"-"+ze(e.getUTCDate(),2)+(i?"T"+ze(r,2)+":"+ze(t,2)+":"+ze(n,2)+"."+ze(i,3)+"Z":n?"T"+ze(r,2)+":"+ze(t,2)+":"+ze(n,2)+"Z":t||r?"T"+ze(r,2)+":"+ze(t,2)+"Z":"")}var vr=function(e){var r=new RegExp('["'+e+`
\r]`),t=e.charCodeAt(0);function n(I,F){var U,Q,ue=i(I,function(de,Re){if(U)return U(de,Re-1);Q=de,U=F?Mr(de,F):Fr(de)});return ue.columns=Q||[],ue}function i(I,F){var U=[],Q=I.length,ue=0,de=0,Re,et=Q<=0,ht=!1;I.charCodeAt(Q-1)===ee&&--Q,I.charCodeAt(Q-1)===rr&&--Q;function xt(){if(et)return ct;if(ht)return ht=!1,dt;var jt,Qt=ue,fr;if(I.charCodeAt(Qt)===_t){for(;ue++<Q&&I.charCodeAt(ue)!==_t||I.charCodeAt(++ue)===_t;);return(jt=ue)>=Q?et=!0:(fr=I.charCodeAt(ue++))===ee?ht=!0:fr===rr&&(ht=!0,I.charCodeAt(ue)===ee&&++ue),I.slice(Qt+1,jt-1).replace(/""/g,'"')}for(;ue<Q;){if((fr=I.charCodeAt(jt=ue++))===ee)ht=!0;else if(fr===rr)ht=!0,I.charCodeAt(ue)===ee&&++ue;else if(fr!==t)continue;return I.slice(Qt,jt)}return et=!0,I.slice(Qt,Q)}for(;(Re=xt())!==ct;){for(var Gt=[];Re!==dt&&Re!==ct;)Gt.push(Re),Re=xt();F&&(Gt=F(Gt,de++))==null||U.push(Gt)}return U}function s(I,F){return I.map(function(U){return F.map(function(Q){return T(U[Q])}).join(e)})}function c(I,F){return F==null&&(F=Nt(I)),[F.map(T).join(e)].concat(s(I,F)).join(`
`)}function g(I,F){return F==null&&(F=Nt(I)),s(I,F).join(`
`)}function y(I){return I.map(E).join(`
`)}function E(I){return I.map(T).join(e)}function T(I){return I==null?"":I instanceof Date?Kt(I):r.test(I+="")?'"'+I.replace(/"/g,'""')+'"':I}return{parse:n,parseRows:i,format:c,formatBody:g,formatRows:y,formatRow:E,formatValue:T}},jr=vr(","),vn=jr.parse,kr=jr.parseRows,be=jr.format,Ne=jr.formatBody,Ie=jr.formatRows,pt=jr.formatRow,mt=jr.formatValue,Dt=M("lSNA"),w=M.n(Dt),br=M("RIqP"),Ut=M.n(br),Xt=M("Aib3"),It=M.n(Xt);function Lt(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function ir(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Lt(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Lt(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Ar(e,r){var t=r.x,n=r.y,i=r.x1,s=r.y1,c=r.coordinates,g=[];return e.forEach(function(y,E){var T=[];if(t&&n&&(T=[parseFloat(y[t]),parseFloat(y[n])]),t&&n&&i&&s){var I=[parseFloat(y[t]),parseFloat(y[n])],F=[parseFloat(y[i]),parseFloat(y[s])];T=[I,F]}if(c){var U="Polygon";Array.isArray(c[0])||(U="Point"),Array.isArray(c[0])&&!Array.isArray(c[0][0])&&(U="LineString");var Q={type:U,coordinates:Ut()(y[c])};It()(Q,!0),T=Q.coordinates}var ue=ir(ir({},y),{},{_id:E,coordinates:T});g.push(ue)}),{dataArray:g}}var nr=[{lng1:100,lat1:30,lng2:130,lat2:30}],Pr={parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}};function $r(e,r){var t=vn(e);return Ar(t,r)}var Or=63710088e-1,_r={centimeters:Or*100,centimetres:Or*100,degrees:Or/111325,feet:Or*3.28084,inches:Or*39.37,kilometers:Or/1e3,kilometres:Or/1e3,meters:Or,metres:Or,miles:Or/1609.344,millimeters:Or*1e3,millimetres:Or*1e3,nauticalmiles:Or/1852,radians:1,yards:Or*1.0936},Br={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Or,yards:1.0936133},Jn={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function mn(e,r,t){t===void 0&&(t={});var n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=r||{},n.geometry=e,n}function wn(e,r,t){switch(t===void 0&&(t={}),e){case"Point":return pi(r).geometry;case"LineString":return Pn(r).geometry;case"Polygon":return fa(r).geometry;case"MultiPoint":return Jt(r).geometry;case"MultiLineString":return ys(r).geometry;case"MultiPolygon":return Ir(r).geometry;default:throw new Error(e+" is invalid")}}function pi(e,r,t){if(t===void 0&&(t={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!xo(e[0])||!xo(e[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:e};return mn(n,r,t)}function Ci(e,r,t){return t===void 0&&(t={}),ws(e.map(function(n){return pi(n,r)}),t)}function fa(e,r,t){t===void 0&&(t={});for(var n=0,i=e;n<i.length;n++){var s=i[n];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var c=0;c<s[s.length-1].length;c++)if(s[s.length-1][c]!==s[0][c])throw new Error("First and last Position are not equivalent.")}var g={type:"Polygon",coordinates:e};return mn(g,r,t)}function _e(e,r,t){return t===void 0&&(t={}),ws(e.map(function(n){return fa(n,r)}),t)}function Pn(e,r,t){if(t===void 0&&(t={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:e};return mn(n,r,t)}function oa(e,r,t){return t===void 0&&(t={}),ws(e.map(function(n){return Pn(n,r)}),t)}function ws(e,r){r===void 0&&(r={});var t={type:"FeatureCollection"};return r.id&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.features=e,t}function ys(e,r,t){t===void 0&&(t={});var n={type:"MultiLineString",coordinates:e};return mn(n,r,t)}function Jt(e,r,t){t===void 0&&(t={});var n={type:"MultiPoint",coordinates:e};return mn(n,r,t)}function Ir(e,r,t){t===void 0&&(t={});var n={type:"MultiPolygon",coordinates:e};return mn(n,r,t)}function en(e,r,t){t===void 0&&(t={});var n={type:"GeometryCollection",geometries:e};return mn(n,r,t)}function On(e,r){if(r===void 0&&(r=0),r&&!(r>=0))throw new Error("precision must be a positive number");var t=Math.pow(10,r||0);return Math.round(e*t)/t}function ln(e,r){r===void 0&&(r="kilometers");var t=_r[r];if(!t)throw new Error(r+" units is invalid");return e*t}function Ka(e,r){r===void 0&&(r="kilometers");var t=_r[r];if(!t)throw new Error(r+" units is invalid");return e/t}function wi(e,r){return Ti(Ka(e,r))}function fi(e){var r=e%360;return r<0&&(r+=360),r}function Ti(e){var r=e%(2*Math.PI);return r*180/Math.PI}function da(e){var r=e%360;return r*Math.PI/180}function ya(e,r,t){if(r===void 0&&(r="kilometers"),t===void 0&&(t="kilometers"),!(e>=0))throw new Error("length must be a positive number");return ln(Ka(e,r),t)}function _s(e,r,t){if(r===void 0&&(r="meters"),t===void 0&&(t="kilometers"),!(e>=0))throw new Error("area must be a positive number");var n=Jn[r];if(!n)throw new Error("invalid original units");var i=Jn[t];if(!i)throw new Error("invalid final units");return e/n*i}function xo(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function $a(e){return!!e&&e.constructor===Object}function Vu(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(r){if(!xo(r))throw new Error("bbox must only contain numbers")})}function ec(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}function wo(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function oe(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ie(e){if(e.length>1&&xo(e[0])&&xo(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return ie(e[0]);throw new Error("coordinates must only contain numbers")}function xe(e,r,t){if(!r||!t)throw new Error("type and name required");if(!e||e.type!==r)throw new Error("Invalid input to "+t+": must be a "+r+", given "+e.type)}function Me(e,r,t){if(!e)throw new Error("No feature passed");if(!t)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!e.geometry||e.geometry.type!==r)throw new Error("Invalid input to "+t+": must be a "+r+", given "+e.geometry.type)}function Ve(e,r,t){if(!e)throw new Error("No featureCollection passed");if(!t)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+t+", FeatureCollection required");for(var n=0,i=e.features;n<i.length;n++){var s=i[n];if(!s||s.type!=="Feature"||!s.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!s.geometry||s.geometry.type!==r)throw new Error("Invalid input to "+t+": must be a "+r+", given "+s.geometry.type)}}function ft(e){return e.type==="Feature"?e.geometry:e}function Ct(e,r){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}function Ce(e,r,t){if(e!==null)for(var n,i,s,c,g,y,E,T=0,I=0,F,U=e.type,Q=U==="FeatureCollection",ue=U==="Feature",de=Q?e.features.length:1,Re=0;Re<de;Re++){E=Q?e.features[Re].geometry:ue?e.geometry:e,F=E?E.type==="GeometryCollection":!1,g=F?E.geometries.length:1;for(var et=0;et<g;et++){var ht=0,xt=0;if(c=F?E.geometries[et]:E,c!==null){y=c.coordinates;var Gt=c.type;switch(T=t&&(Gt==="Polygon"||Gt==="MultiPolygon")?1:0,Gt){case null:break;case"Point":if(r(y,I,Re,ht,xt)===!1)return!1;I++,ht++;break;case"LineString":case"MultiPoint":for(n=0;n<y.length;n++){if(r(y[n],I,Re,ht,xt)===!1)return!1;I++,Gt==="MultiPoint"&&ht++}Gt==="LineString"&&ht++;break;case"Polygon":case"MultiLineString":for(n=0;n<y.length;n++){for(i=0;i<y[n].length-T;i++){if(r(y[n][i],I,Re,ht,xt)===!1)return!1;I++}Gt==="MultiLineString"&&ht++,Gt==="Polygon"&&xt++}Gt==="Polygon"&&ht++;break;case"MultiPolygon":for(n=0;n<y.length;n++){for(xt=0,i=0;i<y[n].length;i++){for(s=0;s<y[n][i].length-T;s++){if(r(y[n][i][s],I,Re,ht,xt)===!1)return!1;I++}xt++}ht++}break;case"GeometryCollection":for(n=0;n<c.geometries.length;n++)if(Ce(c.geometries[n],r,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Ye(e,r,t,n){var i=t;return Ce(e,function(s,c,g,y,E){c===0&&t===void 0?i=s:i=r(i,s,c,g,y,E)},n),i}function nt(e,r){var t;switch(e.type){case"FeatureCollection":for(t=0;t<e.features.length&&r(e.features[t].properties,t)!==!1;t++);break;case"Feature":r(e.properties,0);break}}function Nr(e,r,t){var n=t;return nt(e,function(i,s){s===0&&t===void 0?n=i:n=r(n,i,s)}),n}function Xr(e,r){if(e.type==="Feature")r(e,0);else if(e.type==="FeatureCollection")for(var t=0;t<e.features.length&&r(e.features[t],t)!==!1;t++);}function dr(e,r,t){var n=t;return Xr(e,function(i,s){s===0&&t===void 0?n=i:n=r(n,i,s)}),n}function Yr(e){var r=[];return Ce(e,function(t){r.push(t)}),r}function xn(e,r){var t,n,i,s,c,g,y,E,T,I,F=0,U=e.type==="FeatureCollection",Q=e.type==="Feature",ue=U?e.features.length:1;for(t=0;t<ue;t++){for(g=U?e.features[t].geometry:Q?e.geometry:e,E=U?e.features[t].properties:Q?e.properties:{},T=U?e.features[t].bbox:Q?e.bbox:void 0,I=U?e.features[t].id:Q?e.id:void 0,y=g?g.type==="GeometryCollection":!1,c=y?g.geometries.length:1,i=0;i<c;i++){if(s=y?g.geometries[i]:g,s===null){if(r(null,F,E,T,I)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(r(s,F,E,T,I)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<s.geometries.length;n++)if(r(s.geometries[n],F,E,T,I)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}F++}}function Gn(e,r,t){var n=t;return xn(e,function(i,s,c,g,y){s===0&&t===void 0?n=i:n=r(n,i,s,c,g,y)}),n}function pr(e,r){xn(e,function(t,n,i,s,c){var g=t===null?null:t.type;switch(g){case null:case"Point":case"LineString":case"Polygon":return r(mn(t,i,{bbox:s,id:c}),n,0)===!1?!1:void 0}var y;switch(g){case"MultiPoint":y="Point";break;case"MultiLineString":y="LineString";break;case"MultiPolygon":y="Polygon";break}for(var E=0;E<t.coordinates.length;E++){var T=t.coordinates[E],I={type:y,coordinates:T};if(r(mn(I,i),n,E)===!1)return!1}})}function jn(e,r,t){var n=t;return pr(e,function(i,s,c){s===0&&c===0&&t===void 0?n=i:n=r(n,i,s,c)}),n}function Rn(e,r){pr(e,function(t,n,i){var s=0;if(!!t.geometry){var c=t.geometry.type;if(!(c==="Point"||c==="MultiPoint")){var g,y=0,E=0,T=0;if(Ce(t,function(I,F,U,Q,ue){if(g===void 0||n>y||Q>E||ue>T){g=I,y=n,E=Q,T=ue,s=0;return}var de=Pn([g,I],t.properties);if(r(de,n,i,ue,s)===!1)return!1;s++,g=I})===!1)return!1}}})}function Nn(e,r,t){var n=t,i=!1;return Rn(e,function(s,c,g,y,E){i===!1&&t===void 0?n=s:n=r(n,s,c,g,y,E),i=!0}),n}function Gi(e,r){if(!e)throw new Error("geojson is required");pr(e,function(t,n,i){if(t.geometry!==null){var s=t.geometry.type,c=t.geometry.coordinates;switch(s){case"LineString":if(r(t,n,i,0,0)===!1)return!1;break;case"Polygon":for(var g=0;g<c.length;g++)if(r(Pn(c[g],t.properties),n,i,g)===!1)return!1;break}}})}function Hn(e,r,t){var n=t;return Gi(e,function(i,s,c,g){s===0&&t===void 0?n=i:n=r(n,i,s,c,g)}),n}function ha(e,r){if(r=r||{},!$a(r))throw new Error("options is invalid");var t=r.featureIndex||0,n=r.multiFeatureIndex||0,i=r.geometryIndex||0,s=r.segmentIndex||0,c=r.properties,g;switch(e.type){case"FeatureCollection":t<0&&(t=e.features.length+t),c=c||e.features[t].properties,g=e.features[t].geometry;break;case"Feature":c=c||e.properties,g=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":g=e;break;default:throw new Error("geojson is invalid")}if(g===null)return null;var y=g.coordinates;switch(g.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=y.length+s-1),Pn([y[s],y[s+1]],c,r);case"Polygon":return i<0&&(i=y.length+i),s<0&&(s=y[i].length+s-1),Pn([y[i][s],y[i][s+1]],c,r);case"MultiLineString":return n<0&&(n=y.length+n),s<0&&(s=y[n].length+s-1),Pn([y[n][s],y[n][s+1]],c,r);case"MultiPolygon":return n<0&&(n=y.length+n),i<0&&(i=y[n].length+i),s<0&&(s=y[n][i].length-s-1),Pn([y[n][i][s],y[n][i][s+1]],c,r)}throw new Error("geojson is invalid")}function Sa(e,r){if(r=r||{},!$a(r))throw new Error("options is invalid");var t=r.featureIndex||0,n=r.multiFeatureIndex||0,i=r.geometryIndex||0,s=r.coordIndex||0,c=r.properties,g;switch(e.type){case"FeatureCollection":t<0&&(t=e.features.length+t),c=c||e.features[t].properties,g=e.features[t].geometry;break;case"Feature":c=c||e.properties,g=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":g=e;break;default:throw new Error("geojson is invalid")}if(g===null)return null;var y=g.coordinates;switch(g.type){case"Point":return pi(y,c,r);case"MultiPoint":return n<0&&(n=y.length+n),pi(y[n],c,r);case"LineString":return s<0&&(s=y.length+s),pi(y[s],c,r);case"Polygon":return i<0&&(i=y.length+i),s<0&&(s=y[i].length+s),pi(y[i][s],c,r);case"MultiLineString":return n<0&&(n=y.length+n),s<0&&(s=y[n].length+s),pi(y[n][s],c,r);case"MultiPolygon":return n<0&&(n=y.length+n),i<0&&(i=y[n].length+i),s<0&&(s=y[n][i].length-s),pi(y[n][i][s],c,r)}throw new Error("geojson is invalid")}function Ji(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function ei(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Ji(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ji(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function ua(e,r){var t=[],n={};if(e.features=e.features.filter(function(s){var c=s.geometry;return s!=null&&c&&c.type&&c.coordinates&&c.coordinates.length>0}),It()(e,!0),e.features.length===0)return{dataArray:[],featureKeys:n};var i=0;return pr(e,function(s,c){var g=oe(s),y=c,E=ei(ei({},s.properties),{},{coordinates:g,_id:y});t.push(E)}),{dataArray:t,featureKeys:n}}function Ds(e){var r=131,t=137,n=0;e+="x";for(var i=Math.floor(9007199254740991/t),s=0;s<e.length;s++)n>i&&(n=Math.floor(n/t)),n=n*r+e.charCodeAt(s);return n}function Ca(e){e=e.toString();for(var r=5381,t=e.length;t;)r=r*33^e.charCodeAt(--t);return r>>>0}var zo=M("J4zp"),Ei=M.n(zo),Qi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Bi(e){this.message=e}Bi.prototype=new Error,Bi.prototype.name="InvalidCharacterError";function Uo(e){var r=String(e).replace(/=+$/,"");if(r.length%4==1)throw new Bi("'atob' failed: The string to be decoded is not correctly encoded.");for(var t="",n=0,i,s,c=0;s=r.charAt(c++);~s&&(i=n%4?i*64+s:s,n++%4)?t+=String.fromCharCode(255&i>>(-2*n&6)):0)s=Qi.indexOf(s);return t}function Ho(e){e=String(e);for(var r,t,n,i,s="",c=0,g=e.length%3;c<e.length;){if((t=e.charCodeAt(c++))>255||(n=e.charCodeAt(c++))>255||(i=e.charCodeAt(c++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");r=t<<16|n<<8|i,s+=Qi.charAt(r>>18&63)+Qi.charAt(r>>12&63)+Qi.charAt(r>>6&63)+Qi.charAt(r&63)}return g?s.slice(0,g-3)+"===".substring(g):s}var so=M("lwsE"),Ft=M.n(so),nu=M("W8MJ"),Yt=M.n(nu),uo=function(){function e(r,t){Ft()(this,e),this.buffers=r,this.type=t}return Yt()(e,[{key:"arraybuffer",value:function(){return Promise.resolve(this.buffers[0])}},{key:"stream",value:function(){throw new Error("not implemented")}},{key:"text",value:function(){throw new Error("not implemented")}},{key:"slice",value:function(t,n,i){throw new Error("not implemented")}}]),e}(),jo;typeof window=="undefined"?jo={devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(r){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(r){return null},clearMeasures:function(r){return null},clearMarks:function(r){return null},measure:function(r,t,n){return{duration:0}},now:function(){return new Date().getTime()}},Blob:"",dispatchEvent:function(r){return!0},Event:function(r,t){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:jo=window;var vo=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,no=vo?my.getSystemInfoSync().pixelRatio:jo.devicePixelRatio,As=M("7W2i"),qr=M.n(As),xs=M("a1gu"),hn=M.n(xs),Ts=M("Nsbk"),wt=M.n(Ts),_l=Yt()(function e(r,t){Ft()(this,e),w()(this,"cancelBubble",void 0),w()(this,"cancelable",void 0),w()(this,"target",void 0),w()(this,"currentTarget",void 0),w()(this,"preventDefault",void 0),w()(this,"stopPropagation",void 0),w()(this,"type",void 0),w()(this,"timeStamp",void 0),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=r,this.timeStamp=Date.now()}),Us=M("PJYZ"),ce=M.n(Us);function Tu(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=ls(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function ls(e,r){if(!!e){if(typeof e=="string")return $o(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return $o(e,r)}}function $o(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Ke=new WeakMap,me=function(){function e(){Ft()(this,e),Ke.set(this,{})}return Yt()(e,[{key:"addEventListener",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=Ke.get(this);s||(s={}),s[t]||(s[t]=[]),s[t].push(n),Ke.set(this,s),i.capture,i.once,i.passive}},{key:"removeEventListener",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=Ke.get(this);if(s){var c=s[t];if(c&&c.length>0){for(var g=c.length;g--;g>0)if(c[g]===n){c.splice(g,1);break}}}}},{key:"dispatchEvent",value:function(t){var n=Ke.get(this)[t.type];if(n){var i=Tu(n),s;try{for(i.s();!(s=i.n()).done;){var c=s.value;c(t)}}catch(g){i.e(g)}finally{i.f()}}}}]),e}();function Xe(e){var r=Ht();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Ht(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var rn=function(e){qr()(t,e);var r=Xe(t);function t(){var n;return Ft()(this,t),n=r.call(this),w()(ce()(n),"childNodes",void 0),n.childNodes=[],n}return Yt()(t,[{key:"appendChild",value:function(i){this.childNodes.push(i)}},{key:"cloneNode",value:function(){var i=Object.create(this);return Object.assign(i,this),i}},{key:"removeChild",value:function(i){var s=this.childNodes.findIndex(function(c){return c===i});return s>-1?this.childNodes.splice(s,1):null}}]),t}(me);function Yn(e){var r=la();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function la(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var mo=function(e){qr()(t,e);var r=Yn(t);function t(){var n;return Ft()(this,t),n=r.call(this),w()(ce()(n),"className",void 0),w()(ce()(n),"children",void 0),n.className="",n.children=[],n}return Yt()(t,[{key:"setAttribute",value:function(i,s){this[i]=s}},{key:"getAttribute",value:function(i){return this[i]}},{key:"setAttributeNS",value:function(i,s){this[i]=s}},{key:"getAttributeNS",value:function(i){return this[i]}}]),t}(rn),lo=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,bo,qo,yc,gu;if(lo){var cs=my.getSystemInfoSync();bo=cs.screenWidth,qo=cs.screenHeight,yc=cs.windowWidth,gu=cs.windowHeight}else{var iu=jo.innerWidth,Mu=jo.innerHeight;bo=iu,qo=Mu,yc=iu,gu=Mu}var au={width:bo,height:qo,availWidth:yc,availHeight:gu,availLeft:0,availTop:0},js=au.availWidth,cl=au.availHeight,Pu={style:[]};function co(e,r){if(!("parentNode"in e)){var t;r===0?t=function(){return null}:r===1?t=function(){return Pu}:t=function(){return null},Object.defineProperty(e,"parentNode",{enumerable:!0,get:t})}if(!("parentElement"in e)){var n;r===0?n=function(){return null}:r===1?n=function(){return Pu}:n=function(){return null},Object.defineProperty(e,"parentElement",{enumerable:!0,get:n})}}function Po(e){e.style=e.style||{},Object.assign(e.style,{top:"0px",left:"0px",width:js+"px",height:cl+"px",margin:"0px",padding:"0px"})}function Ha(e){"clientLeft"in e||(e.clientLeft=0,e.clientTop=0),"clientWidth"in e||(e.clientWidth=js,e.clientHeight=cl),"getBoundingClientRect"in e||(e.getBoundingClientRect=function(){var r={x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight};return r})}function Wa(e){"offsetLeft"in e||(e.offsetLeft=0,e.offsetTop=0),"offsetWidth"in e||(e.offsetWidth=js,e.offsetHeight=cl)}function Yh(e){"scrollLeft"in e||(e.scrollLeft=0,e.scrollTop=0),"scrollWidth"in e||(e.scrollWidth=js,e.scrollHeight=cl)}function Bc(e){var r=function(){return!0};e.classList=[],e.classList.add=r,e.classList.remove=r,e.classList.contains=r,e.classList.toggle=r}function Nc(e){var r=xl();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function xl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function bl(){}var b=function(e){qr()(t,e);var r=Nc(t);function t(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",s=arguments.length>1?arguments[1]:void 0;return Ft()(this,t),n=r.call(this),w()(ce()(n),"className",void 0),w()(ce()(n),"children",void 0),w()(ce()(n),"focus",void 0),w()(ce()(n),"blur",void 0),w()(ce()(n),"insertBefore",void 0),w()(ce()(n),"appendChild",void 0),w()(ce()(n),"removeChild",void 0),w()(ce()(n),"remove",void 0),w()(ce()(n),"innerHTML",void 0),w()(ce()(n),"tagName",void 0),n.className="",n.children=[],n.focus=bl,n.blur=bl,n.insertBefore=bl,n.appendChild=bl,n.removeChild=bl,n.remove=bl,n.innerHTML="",n.tagName=i.toUpperCase(),co(ce()(n),s),Po(ce()(n)),Bc(ce()(n)),Ha(ce()(n)),Wa(ce()(n)),Yh(ce()(n)),n}return Yt()(t)}(mo);function L(e){var r=X();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function X(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var B=function(e){qr()(t,e);var r=L(t);function t(n){return Ft()(this,t),r.call(this,n)}return Yt()(t,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),t}(b);function se(e){var r=Le();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Le(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ot=function(e){qr()(t,e);var r=se(t);function t(){return Ft()(this,t),r.call(this,"video")}return Yt()(t)}(B),Et={},Pt={};function zr(e,r){Et=e,Et.id=r,"tagName"in Et||(Et.tagName="CANVAS"),Et.type="canvas",co(Et),Po(Et),Bc(Et),Ha(Et),Wa(Et),Et.focus=function(){},Et.blur=function(){}}function Kr(e,r){var t=1024,n=1024;Pt={width:t,height:n,clientWidth:t/no,clientHeight:n/no,id:r,type:"canvas"},"tagName"in Pt||(Pt.tagName="CANVAS"),co(Pt),Po(Pt),Bc(Pt),Ha(Pt),Wa(Pt),Pt.getContext=function(i){if(i==="2d")return e},Pt.focus=function(){},Pt.blur=function(){}}function oi(){return Et}function Ki(){return Pt}var Li=Yt()(function e(){Ft()(this,e);var r=oi(),t=r.createImage&&r.createImage()||{};return"tagName"in t||(t.tagName="IMG",t.__proto__=e.prototype),co(t),Bc(t),Object.assign(t,{addEventListener:function(i,s){t["on".concat(i)]=s.bind(t)},removeEventListener:function(i){t["on".concat(i)]=null}}),t}),Oa={href:"",protocol:"",host:""};function sa(e){var r=Va();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Va(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Qo=function(e){qr()(t,e);var r=sa(t);function t(){return Ft()(this,t),r.call(this,"body",0)}return Yt()(t,[{key:"addEventListener",value:function(i,s){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(i,s,c){}},{key:"dispatchEvent",value:function(i){}}]),t}(b),yu=function(e){qr()(t,e);var r=sa(t);function t(){return Ft()(this,t),r.call(this,"html",0)}return Yt()(t,[{key:"addEventListener",value:function(i,s){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(i,s){}},{key:"dispatchEvent",value:function(i){}}]),t}(b),Ma={},Jo={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:Oa,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(r){return r=r.toLowerCase(),r==="canvas"?my.createOffscreenCanvas(1024,128,"2d"):r==="img"?new Li:r==="video"?new ot:new b(r)},createElementNS:function(r,t){return this.createElement(t)},createTextNode:function(r){return r},getElementById:function(r){return null},getElementsByTagName:function(r){return r=r.toLowerCase(),[]},getElementsByTagNameNS:function(r,t){return this.getElementsByTagName(t)},getElementsByName:function(r){return[]},querySelector:function(r){return null},querySelectorAll:function(r){return[]},addEventListener:function(r,t,n){Ma[r]||(Ma[r]=[]),Ma[r].push(t)},removeEventListener:function(r,t){var n=Ma[r];if(n&&n.length>0){for(var i=n.length;i--;i>0)if(n[i]===t){n.splice(i,1);break}}},dispatchEvent:function(r){var t=r.type,n=Ma[t];if(n)for(var i=0;i<n.length;i++)n[i](r);r.target&&typeof r.target["on"+t]=="function"&&r.target["on"+t](r)},createEvent:function(r){return new _l(r)}};Jo.documentElement=new yu,Jo.head=new b("head"),Jo.body=new Qo;var _c=Object,tc=M("cDf5"),Eo=M.n(tc),El=function(){function e(){Ft()(this,e),w()(this,"_w",void 0),w()(this,"_h",void 0),w()(this,"_data",void 0);var r=arguments.length;if(r===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){this._w=arguments[0],this._h=arguments[1],this._data=new Uint8ClampedArray(this._w*this._h*4);return}}else r===3&&Eo()(arguments[0])==="object"&&typeof arguments[1]=="number"&&typeof arguments[2]=="number"&&(this._data=arguments[0],this._w=arguments[1],this._h=arguments[2]);throw new Error("ImageData: params error")}return Yt()(e,[{key:"width",get:function(){return this._w}},{key:"height",get:function(){return this._h}},{key:"data",get:function(){return this._data}}]),e}(),wf=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Sl,xa,Fl;if(wf){var Ah=my.getSystemInfoSync();Sl=Ah.system,xa=Ah.platform,Fl=Ah.language}else{var fs={versions:function(){var e=jo.navigator.userAgent;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")===-1,mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:e.indexOf("Safari")===-1,weixin:e.indexOf("MicroMessenger")>-1,qq:e.match(/\sQQ/i)===" qq"}}(),language:(jo.navigator.browserLanguage||jo.navigator.language).toLowerCase()};fs.versions.android?xa="android":fs.versions.trident?xa="IE":fs.versions.presto?xa="Opera":fs.versions.webKit?xa="webKit":fs.versions.gecko?xa="Firefox":fs.versions.mobile?xa="mobile":fs.versions.ios?xa="ios":fs.versions.iPhone?xa="iPhone":fs.versions.iPad?xa="ipad":fs.versions.webApp?xa="webApp":fs.versions.weixin?xa="weixin":fs.versions.qq&&(xa="qq"),Sl=jo.navigator.userAgent,Fl=fs.language}var Af=Sl.toLowerCase().indexOf("android")!==-1,tl=Af?"Android; CPU Android 6.0":"iPhone; CPU iPhone OS 10_3_1 like Mac OS X",fl="Mozilla/5.0 (".concat(tl,") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/").concat(Fl),xc={platform:xa,language:Fl,appVersion:"5.0 (".concat(tl,") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"),userAgent:fl},Bl={mark:function(r){return null},clearMeasures:function(r){return null},clearMarks:function(r){return null},measure:function(r,t,n){return{duration:0}},now:function(){}},zc=0,Nl=0;function fo(e){var r=Date.now(),t=Math.max(zc+23,r);return Nl=setTimeout(function(){e(zc=t)},t-r),Nl}function nf(e){var r=oi();return r.requestAnimationFrame?r.requestAnimationFrame(e):fo(e)}function Ap(e){var r=oi();return r.cancelAnimationFrame?r.cancelAnimationFrame(e):clearTimeout(e)}var Uc=function(){function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(Ft()(this,e),w()(this,"href",void 0),r.indexOf("http://")==0||r.indexOf("https://")==0){this.href=r;return}this.href=t+r}return Yt()(e,null,[{key:"createObjectURL",value:function(t){var n=t.buffers[0],i=t.type,s=Th(n),c="data:".concat(i,";base64, ");return c+s}}]),e}();function Th(e){for(var r="",t=new Uint8Array(e),n=t.byteLength,i=0;i<n;i++)r+=String.fromCharCode(t[i]);return Ho(r)}var Kp={GCCSO_SHADER_BINARY_FJ:37472,_3DC_XY_AMD:34810,_3DC_X_AMD:34809,ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_PROGRAM_EXT:33369,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALL_COMPLETED_NV:34034,ALL_SHADER_BITS_EXT:4294967295,ALPHA:6406,ALPHA16F_EXT:34844,ALPHA32F_EXT:34838,ALPHA8_EXT:32828,ALPHA8_OES:32828,ALPHA_BITS:3413,ALPHA_TEST_FUNC_QCOM:3009,ALPHA_TEST_QCOM:3008,ALPHA_TEST_REF_QCOM:3010,ALREADY_SIGNALED_APPLE:37146,ALWAYS:519,AMD_compressed_3DC_texture:1,AMD_compressed_ATC_texture:1,AMD_performance_monitor:1,AMD_program_binary_Z400:1,ANGLE_depth_texture:1,ANGLE_framebuffer_blit:1,ANGLE_framebuffer_multisample:1,ANGLE_instanced_arrays:1,ANGLE_pack_reverse_row_order:1,ANGLE_program_binary:1,ANGLE_texture_compression_dxt3:1,ANGLE_texture_compression_dxt5:1,ANGLE_texture_usage:1,ANGLE_translated_shader_source:1,ANY_SAMPLES_PASSED_CONSERVATIVE_EXT:36202,ANY_SAMPLES_PASSED_EXT:35887,APPLE_copy_texture_levels:1,APPLE_framebuffer_multisample:1,APPLE_rgb_422:1,APPLE_sync:1,APPLE_texture_format_BGRA8888:1,APPLE_texture_max_level:1,ARM_mali_program_binary:1,ARM_mali_shader_binary:1,ARM_rgba8:1,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATC_RGBA_EXPLICIT_ALPHA_AMD:35987,ATC_RGBA_INTERPOLATED_ALPHA_AMD:34798,ATC_RGB_AMD:35986,ATTACHED_SHADERS:35717,BACK:1029,BGRA8_EXT:37793,BGRA_EXT:32993,BGRA_IMG:32993,BINNING_CONTROL_HINT_QCOM:36784,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER:33504,BUFFER_ACCESS_OES:35003,BUFFER_MAPPED_OES:35004,BUFFER_MAP_POINTER_OES:35005,BUFFER_OBJECT_EXT:37201,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_BORDER_NV:33069,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_ATTACHMENT0_NV:36064,COLOR_ATTACHMENT10_NV:36074,COLOR_ATTACHMENT11_NV:36075,COLOR_ATTACHMENT12_NV:36076,COLOR_ATTACHMENT13_NV:36077,COLOR_ATTACHMENT14_NV:36078,COLOR_ATTACHMENT15_NV:36079,COLOR_ATTACHMENT1_NV:36065,COLOR_ATTACHMENT2_NV:36066,COLOR_ATTACHMENT3_NV:36067,COLOR_ATTACHMENT4_NV:36068,COLOR_ATTACHMENT5_NV:36069,COLOR_ATTACHMENT6_NV:36070,COLOR_ATTACHMENT7_NV:36071,COLOR_ATTACHMENT8_NV:36072,COLOR_ATTACHMENT9_NV:36073,COLOR_ATTACHMENT_EXT:37104,COLOR_BUFFER_BIT:16384,COLOR_BUFFER_BIT0_QCOM:1,COLOR_BUFFER_BIT1_QCOM:2,COLOR_BUFFER_BIT2_QCOM:4,COLOR_BUFFER_BIT3_QCOM:8,COLOR_BUFFER_BIT4_QCOM:16,COLOR_BUFFER_BIT5_QCOM:32,COLOR_BUFFER_BIT6_QCOM:64,COLOR_BUFFER_BIT7_QCOM:128,COLOR_CLEAR_VALUE:3106,COLOR_EXT:6144,COLOR_WRITEMASK:3107,COMPARE_REF_TO_TEXTURE_EXT:34894,COMPILE_STATUS:35713,COMPRESSED_RGBA_ASTC_10x10_KHR:37819,COMPRESSED_RGBA_ASTC_10x5_KHR:37816,COMPRESSED_RGBA_ASTC_10x6_KHR:37817,COMPRESSED_RGBA_ASTC_10x8_KHR:37818,COMPRESSED_RGBA_ASTC_12x10_KHR:37820,COMPRESSED_RGBA_ASTC_12x12_KHR:37821,COMPRESSED_RGBA_ASTC_4x4_KHR:37808,COMPRESSED_RGBA_ASTC_5x4_KHR:37809,COMPRESSED_RGBA_ASTC_5x5_KHR:37810,COMPRESSED_RGBA_ASTC_6x5_KHR:37811,COMPRESSED_RGBA_ASTC_6x6_KHR:37812,COMPRESSED_RGBA_ASTC_8x5_KHR:37813,COMPRESSED_RGBA_ASTC_8x6_KHR:37814,COMPRESSED_RGBA_ASTC_8x8_KHR:37815,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_PVRTC_2BPPV2_IMG:37175,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_4BPPV2_IMG:37176,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_ANGLE:33778,COMPRESSED_RGBA_S3TC_DXT5_ANGLE:33779,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:37853,COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:37847,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_NV:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_NV:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_NV:35919,COMPRESSED_SRGB_S3TC_DXT1_NV:35916,COMPRESSED_TEXTURE_FORMATS:34467,CONDITION_SATISFIED_APPLE:37148,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_FLAG_DEBUG_BIT:2,CONTEXT_ROBUST_ACCESS_EXT:37107,COUNTER_RANGE_AMD:35777,COUNTER_TYPE_AMD:35776,COVERAGE_ALL_FRAGMENTS_NV:36565,COVERAGE_ATTACHMENT_NV:36562,COVERAGE_AUTOMATIC_NV:36567,COVERAGE_BUFFERS_NV:36563,COVERAGE_BUFFER_BIT_NV:32768,COVERAGE_COMPONENT4_NV:36561,COVERAGE_COMPONENT_NV:36560,COVERAGE_EDGE_FRAGMENTS_NV:36566,COVERAGE_SAMPLES_NV:36564,CPU_OPTIMIZED_QCOM:36785,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_QUERY_EXT:34917,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DEBUG_CALLBACK_FUNCTION:33348,DEBUG_CALLBACK_USER_PARAM:33349,DEBUG_GROUP_STACK_DEPTH:33389,DEBUG_LOGGED_MESSAGES:37189,DEBUG_NEXT_LOGGED_MESSAGE_LENGTH:33347,DEBUG_OUTPUT:37600,DEBUG_OUTPUT_SYNCHRONOUS:33346,DEBUG_SEVERITY_HIGH:37190,DEBUG_SEVERITY_LOW:37192,DEBUG_SEVERITY_MEDIUM:37191,DEBUG_SEVERITY_NOTIFICATION:33387,DEBUG_SOURCE_API:33350,DEBUG_SOURCE_APPLICATION:33354,DEBUG_SOURCE_OTHER:33355,DEBUG_SOURCE_SHADER_COMPILER:33352,DEBUG_SOURCE_THIRD_PARTY:33353,DEBUG_SOURCE_WINDOW_SYSTEM:33351,DEBUG_TYPE_DEPRECATED_BEHAVIOR:33357,DEBUG_TYPE_ERROR:33356,DEBUG_TYPE_MARKER:33384,DEBUG_TYPE_OTHER:33361,DEBUG_TYPE_PERFORMANCE:33360,DEBUG_TYPE_POP_GROUP:33386,DEBUG_TYPE_PORTABILITY:33359,DEBUG_TYPE_PUSH_GROUP:33385,DEBUG_TYPE_UNDEFINED_BEHAVIOR:33358,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH24_STENCIL8_OES:35056,DEPTH_ATTACHMENT:36096,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_BUFFER_BIT0_QCOM:256,DEPTH_BUFFER_BIT1_QCOM:512,DEPTH_BUFFER_BIT2_QCOM:1024,DEPTH_BUFFER_BIT3_QCOM:2048,DEPTH_BUFFER_BIT4_QCOM:4096,DEPTH_BUFFER_BIT5_QCOM:8192,DEPTH_BUFFER_BIT6_QCOM:16384,DEPTH_BUFFER_BIT7_QCOM:32768,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_COMPONENT16_NONLINEAR_NV:36396,DEPTH_COMPONENT16_OES:33189,DEPTH_COMPONENT24_OES:33190,DEPTH_COMPONENT32_OES:33191,DEPTH_EXT:6145,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_OES:34041,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DMP_shader_binary:1,DONT_CARE:4352,DRAW_BUFFER0_NV:34853,DRAW_BUFFER10_NV:34863,DRAW_BUFFER11_NV:34864,DRAW_BUFFER12_NV:34865,DRAW_BUFFER13_NV:34866,DRAW_BUFFER14_NV:34867,DRAW_BUFFER15_NV:34868,DRAW_BUFFER1_NV:34854,DRAW_BUFFER2_NV:34855,DRAW_BUFFER3_NV:34856,DRAW_BUFFER4_NV:34857,DRAW_BUFFER5_NV:34858,DRAW_BUFFER6_NV:34859,DRAW_BUFFER7_NV:34860,DRAW_BUFFER8_NV:34861,DRAW_BUFFER9_NV:34862,DRAW_BUFFER_EXT:3073,DRAW_FRAMEBUFFER_ANGLE:36009,DRAW_FRAMEBUFFER_APPLE:36009,DRAW_FRAMEBUFFER_BINDING_ANGLE:36006,DRAW_FRAMEBUFFER_BINDING_APPLE:36006,DRAW_FRAMEBUFFER_BINDING_NV:36006,DRAW_FRAMEBUFFER_NV:36009,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,ES_VERSION_2_0:1,ETC1_RGB8_OES:36196,ETC1_SRGB8_NV:35054,EXTENSIONS:7939,EXT_blend_minmax:1,EXT_color_buffer_half_float:1,EXT_debug_label:1,EXT_debug_marker:1,EXT_discard_framebuffer:1,EXT_map_buffer_range:1,EXT_multi_draw_arrays:1,EXT_multisampled_render_to_texture:1,EXT_multiview_draw_buffers:1,EXT_occlusion_query_boolean:1,EXT_read_format_bgra:1,EXT_robustness:1,EXT_sRGB:1,EXT_separate_shader_objects:1,EXT_shader_framebuffer_fetch:1,EXT_shader_texture_lod:1,EXT_shadow_samplers:1,EXT_texture_compression_dxt1:1,EXT_texture_filter_anisotropic:1,EXT_texture_format_BGRA8888:1,EXT_texture_rg:1,EXT_texture_storage:1,EXT_texture_type_2_10_10_10_REV:1,EXT_unpack_subimage:1,FALSE:0,FASTEST:4353,FENCE_CONDITION_NV:34036,FENCE_STATUS_NV:34035,FIXED:5132,FJ_shader_binary_GCCSO:1,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAGMENT_SHADER_BIT_EXT:2,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,FRAGMENT_SHADER_DISCARDS_SAMPLES_EXT:35410,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_ANGLE:37795,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_3D_ZOFFSET_OES:36052,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_SAMPLES_EXT:36204,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_ANGLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_APPLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_EXT:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_IMG:37172,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_NV:36182,FRAMEBUFFER_UNDEFINED_OES:33305,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GPU_OPTIMIZED_QCOM:36786,GREATER:516,GREEN_BITS:3411,GUILTY_CONTEXT_RESET_EXT:33363,HALF_FLOAT_OES:36193,HIGH_FLOAT:36338,HIGH_INT:36341,IMG_multisampled_render_to_texture:1,IMG_program_binary:1,IMG_read_format:1,IMG_shader_binary:1,IMG_texture_compression_pvrtc:1,IMG_texture_compression_pvrtc2:1,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INNOCENT_CONTEXT_RESET_EXT:33364,INT:5124,INT_10_10_10_2_OES:36343,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,KHR_debug:1,KHR_texture_compression_astc_ldr:1,LEFT:1030,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOSE_CONTEXT_ON_RESET_EXT:33362,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE16F_EXT:34846,LUMINANCE32F_EXT:34840,LUMINANCE4_ALPHA4_OES:32835,LUMINANCE8_ALPHA8_EXT:32837,LUMINANCE8_ALPHA8_OES:32837,LUMINANCE8_EXT:32832,LUMINANCE8_OES:32832,LUMINANCE_ALPHA:6410,LUMINANCE_ALPHA16F_EXT:34847,LUMINANCE_ALPHA32F_EXT:34841,MALI_PROGRAM_BINARY_ARM:36705,MALI_SHADER_BINARY_ARM:36704,MAP_FLUSH_EXPLICIT_BIT_EXT:16,MAP_INVALIDATE_BUFFER_BIT_EXT:8,MAP_INVALIDATE_RANGE_BIT_EXT:4,MAP_READ_BIT_EXT:1,MAP_UNSYNCHRONIZED_BIT_EXT:32,MAP_WRITE_BIT_EXT:2,MAX_3D_TEXTURE_SIZE_OES:32883,MAX_COLOR_ATTACHMENTS_NV:36063,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_DEBUG_GROUP_STACK_DEPTH:33388,MAX_DEBUG_LOGGED_MESSAGES:37188,MAX_DEBUG_MESSAGE_LENGTH:37187,MAX_DRAW_BUFFERS_NV:34852,MAX_EXT:32776,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_LABEL_LENGTH:33512,MAX_MULTIVIEW_BUFFERS_EXT:37106,MAX_RENDERBUFFER_SIZE:34024,MAX_SAMPLES_ANGLE:36183,MAX_SAMPLES_APPLE:36183,MAX_SAMPLES_EXT:36183,MAX_SAMPLES_IMG:37173,MAX_SAMPLES_NV:36183,MAX_SERVER_WAIT_TIMEOUT_APPLE:37137,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIN_EXT:32775,MIRRORED_REPEAT:33648,MULTISAMPLE_BUFFER_BIT0_QCOM:16777216,MULTISAMPLE_BUFFER_BIT1_QCOM:33554432,MULTISAMPLE_BUFFER_BIT2_QCOM:67108864,MULTISAMPLE_BUFFER_BIT3_QCOM:134217728,MULTISAMPLE_BUFFER_BIT4_QCOM:268435456,MULTISAMPLE_BUFFER_BIT5_QCOM:536870912,MULTISAMPLE_BUFFER_BIT6_QCOM:1073741824,MULTISAMPLE_BUFFER_BIT7_QCOM:2147483648,MULTIVIEW_EXT:37105,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NO_RESET_NOTIFICATION_EXT:33377,NUM_COMPRESSED_TEXTURE_FORMATS:34466,NUM_PROGRAM_BINARY_FORMATS_OES:34814,NUM_SHADER_BINARY_FORMATS:36345,NV_coverage_sample:1,NV_depth_nonlinear:1,NV_draw_buffers:1,NV_draw_instanced:1,NV_fbo_color_attachments:1,NV_fence:1,NV_framebuffer_blit:1,NV_framebuffer_multisample:1,NV_generate_mipmap_sRGB:1,NV_instanced_arrays:1,NV_read_buffer:1,NV_read_buffer_front:1,NV_read_depth:1,NV_read_depth_stencil:1,NV_read_stencil:1,NV_sRGB_formats:1,NV_shadow_samplers_array:1,NV_shadow_samplers_cube:1,NV_texture_border_clamp:1,NV_texture_compression_s3tc_update:1,NV_texture_npot_2D_mipmap:1,OBJECT_TYPE_APPLE:37138,OES_EGL_image:1,OES_EGL_image_external:1,OES_compressed_ETC1_RGB8_texture:1,OES_compressed_paletted_texture:1,OES_depth24:1,OES_depth32:1,OES_depth_texture:1,OES_element_index_uint:1,OES_fbo_render_mipmap:1,OES_fragment_precision_high:1,OES_get_program_binary:1,OES_mapbuffer:1,OES_packed_depth_stencil:1,OES_required_internalformat:1,OES_rgb8_rgba8:1,OES_standard_derivatives:1,OES_stencil1:1,OES_stencil4:1,OES_surfaceless_context:1,OES_texture_3D:1,OES_texture_float:1,OES_texture_float_linear:1,OES_texture_half_float:1,OES_texture_half_float_linear:1,OES_texture_npot:1,OES_vertex_array_object:1,OES_vertex_half_float:1,OES_vertex_type_10_10_10_2:1,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,PACK_REVERSE_ROW_ORDER_ANGLE:37796,PALETTE4_R5_G6_B5_OES:35730,PALETTE4_RGB5_A1_OES:35732,PALETTE4_RGB8_OES:35728,PALETTE4_RGBA4_OES:35731,PALETTE4_RGBA8_OES:35729,PALETTE8_R5_G6_B5_OES:35735,PALETTE8_RGB5_A1_OES:35737,PALETTE8_RGB8_OES:35733,PALETTE8_RGBA4_OES:35736,PALETTE8_RGBA8_OES:35734,PERCENTAGE_AMD:35779,PERFMON_GLOBAL_MODE_QCOM:36768,PERFMON_RESULT_AMD:35782,PERFMON_RESULT_AVAILABLE_AMD:35780,PERFMON_RESULT_SIZE_AMD:35781,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,PROGRAM:33506,PROGRAM_BINARY_ANGLE:37798,PROGRAM_BINARY_FORMATS_OES:34815,PROGRAM_BINARY_LENGTH_OES:34625,PROGRAM_OBJECT_EXT:35648,PROGRAM_PIPELINE_BINDING_EXT:33370,PROGRAM_PIPELINE_OBJECT_EXT:35407,PROGRAM_SEPARABLE_EXT:33368,QCOM_alpha_test:1,QCOM_binning_control:1,QCOM_driver_control:1,QCOM_extended_get:1,QCOM_extended_get2:1,QCOM_perfmon_global_mode:1,QCOM_tiled_rendering:1,QCOM_writeonly_rendering:1,QUERY:33507,QUERY_OBJECT_EXT:37203,QUERY_RESULT_AVAILABLE_EXT:34919,QUERY_RESULT_EXT:34918,R16F_EXT:33325,R32F_EXT:33326,R8_EXT:33321,READ_BUFFER_EXT:3074,READ_BUFFER_NV:3074,READ_FRAMEBUFFER_ANGLE:36008,READ_FRAMEBUFFER_APPLE:36008,READ_FRAMEBUFFER_BINDING_ANGLE:36010,READ_FRAMEBUFFER_BINDING_APPLE:36010,READ_FRAMEBUFFER_BINDING_NV:36010,READ_FRAMEBUFFER_NV:36008,RED_BITS:3410,RED_EXT:6403,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_SAMPLES_ANGLE:36011,RENDERBUFFER_SAMPLES_APPLE:36011,RENDERBUFFER_SAMPLES_EXT:36011,RENDERBUFFER_SAMPLES_IMG:37171,RENDERBUFFER_SAMPLES_NV:36011,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,RENDER_DIRECT_TO_FRAMEBUFFER_QCOM:36787,REPEAT:10497,REPLACE:7681,REQUIRED_TEXTURE_IMAGE_UNITS_OES:36200,RESET_NOTIFICATION_STRATEGY_EXT:33366,RG16F_EXT:33327,RG32F_EXT:33328,RG8_EXT:33323,RGB:6407,RGB10_A2_EXT:32857,RGB10_EXT:32850,RGB16F_EXT:34843,RGB32F_EXT:34837,RGB565:36194,RGB565_OES:36194,RGB5_A1:32855,RGB5_A1_OES:32855,RGB8_OES:32849,RGBA:6408,RGBA16F_EXT:34842,RGBA32F_EXT:34836,RGBA4:32854,RGBA4_OES:32854,RGBA8_OES:32856,RGB_422_APPLE:35359,RG_EXT:33319,RIGHT:1031,SAMPLER:33510,SAMPLER_2D:35678,SAMPLER_2D_ARRAY_SHADOW_NV:36292,SAMPLER_2D_SHADOW_EXT:35682,SAMPLER_3D_OES:35679,SAMPLER_CUBE:35680,SAMPLER_CUBE_SHADOW_NV:36293,SAMPLER_EXTERNAL_OES:36198,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SGX_BINARY_IMG:35850,SGX_PROGRAM_BINARY_IMG:37168,SHADER:33505,SHADER_BINARY_DMP:37456,SHADER_BINARY_FORMATS:36344,SHADER_BINARY_VIV:36804,SHADER_COMPILER:36346,SHADER_OBJECT_EXT:35656,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SIGNALED_APPLE:37145,SLUMINANCE8_ALPHA8_NV:35909,SLUMINANCE8_NV:35911,SLUMINANCE_ALPHA_NV:35908,SLUMINANCE_NV:35910,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,SRGB8_ALPHA8_EXT:35907,SRGB8_NV:35905,SRGB_ALPHA_EXT:35906,SRGB_EXT:35904,STACK_OVERFLOW:1283,STACK_UNDERFLOW:1284,STATE_RESTORE:35804,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_BUFFER_BIT0_QCOM:65536,STENCIL_BUFFER_BIT1_QCOM:131072,STENCIL_BUFFER_BIT2_QCOM:262144,STENCIL_BUFFER_BIT3_QCOM:524288,STENCIL_BUFFER_BIT4_QCOM:1048576,STENCIL_BUFFER_BIT5_QCOM:2097152,STENCIL_BUFFER_BIT6_QCOM:4194304,STENCIL_BUFFER_BIT7_QCOM:8388608,STENCIL_CLEAR_VALUE:2961,STENCIL_EXT:6146,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX1_OES:36166,STENCIL_INDEX4_OES:36167,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,SYNC_CONDITION_APPLE:37139,SYNC_FENCE_APPLE:37142,SYNC_FLAGS_APPLE:37141,SYNC_FLUSH_COMMANDS_BIT_APPLE:1,SYNC_GPU_COMMANDS_COMPLETE_APPLE:37143,SYNC_OBJECT_APPLE:35411,SYNC_STATUS_APPLE:37140,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_3D_OES:32879,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_3D_OES:32874,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_BINDING_EXTERNAL_OES:36199,TEXTURE_BORDER_COLOR_NV:4100,TEXTURE_COMPARE_FUNC_EXT:34893,TEXTURE_COMPARE_MODE_EXT:34892,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_DEPTH_QCOM:35796,TEXTURE_EXTERNAL_OES:36197,TEXTURE_FORMAT_QCOM:35798,TEXTURE_HEIGHT_QCOM:35795,TEXTURE_IMAGE_VALID_QCOM:35800,TEXTURE_IMMUTABLE_FORMAT_EXT:37167,TEXTURE_INTERNAL_FORMAT_QCOM:35797,TEXTURE_MAG_FILTER:10240,TEXTURE_MAX_ANISOTROPY_EXT:34046,TEXTURE_MAX_LEVEL_APPLE:33085,TEXTURE_MIN_FILTER:10241,TEXTURE_NUM_LEVELS_QCOM:35801,TEXTURE_OBJECT_VALID_QCOM:35803,TEXTURE_SAMPLES_IMG:37174,TEXTURE_TARGET_QCOM:35802,TEXTURE_TYPE_QCOM:35799,TEXTURE_USAGE_ANGLE:37794,TEXTURE_WIDTH_QCOM:35794,TEXTURE_WRAP_R_OES:32882,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TIMEOUT_EXPIRED_APPLE:37147,TIMEOUT_IGNORED_APPLE:18446744073709552e3,TRANSLATED_SHADER_SOURCE_LENGTH_ANGLE:37792,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRUE:1,UNKNOWN_CONTEXT_RESET_EXT:33365,UNPACK_ALIGNMENT:3317,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_PIXELS:3316,UNPACK_SKIP_ROWS:3315,UNSIGNALED_APPLE:37144,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_INT64_AMD:35778,UNSIGNED_INT_10_10_10_2_OES:36342,UNSIGNED_INT_24_8_OES:34042,UNSIGNED_INT_2_10_10_10_REV_EXT:33640,UNSIGNED_NORMALIZED_EXT:35863,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_1_5_5_5_REV_EXT:33638,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_4_4_4_4_REV_EXT:33637,UNSIGNED_SHORT_4_4_4_4_REV_IMG:33637,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_8_8_APPLE:34234,UNSIGNED_SHORT_8_8_REV_APPLE:34235,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ARRAY_BINDING_OES:34229,VERTEX_ARRAY_OBJECT_EXT:37204,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,VERTEX_ATTRIB_ARRAY_DIVISOR_NV:35070,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VERTEX_SHADER_BIT_EXT:1,VIEWPORT:2978,VIV_shader_binary:1,WAIT_FAILED_APPLE:37149,WRITEONLY_RENDERING_QCOM:34851,WRITE_ONLY_OES:35001,Z400_BINARY_AMD:34624,ZERO:0,RASTERIZER_DISCARD:35977,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444},Kh={};function ou(e){var r=zl();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function zl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var hl=new Map,jc=new Map,Ul=new Map,af={json:"application/json",text:"application/text",arraybuffer:"application/octet-stream"};function Mh(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:this};typeof this["on".concat(e)]=="function"&&this["on".concat(e)].call(this,r)}function of(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{readyState:e};this.readyState=e,Mh.call(this,"readystatechange",r)}var es=function(e){qr()(t,e);var r=ou(t);function t(){var n;return Ft()(this,t),n=r.call(this),w()(ce()(n),"onabort",void 0),w()(ce()(n),"onerror",void 0),w()(ce()(n),"onload",void 0),w()(ce()(n),"onloadstart",void 0),w()(ce()(n),"onprogress",void 0),w()(ce()(n),"ontimeout",void 0),w()(ce()(n),"onloadend",void 0),w()(ce()(n),"onreadystatechange",void 0),w()(ce()(n),"readyState",void 0),w()(ce()(n),"response",void 0),w()(ce()(n),"responseText",void 0),w()(ce()(n),"_responseType",void 0),w()(ce()(n),"responseXML",void 0),w()(ce()(n),"status",void 0),w()(ce()(n),"statusText",void 0),w()(ce()(n),"upload",void 0),w()(ce()(n),"withCredentials",void 0),w()(ce()(n),"timeout",void 0),w()(ce()(n),"_url",void 0),w()(ce()(n),"_method",void 0),n.onabort=null,n.onerror=null,n.onload=null,n.onloadstart=null,n.onprogress=null,n.ontimeout=null,n.onloadend=null,n.onreadystatechange=null,n.readyState=0,n.response=null,n.responseText=null,n._responseType="text",n.responseXML=null,n.status=0,n.statusText="",n.upload={},n.withCredentials=!1,hl.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),n}return Yt()(t,[{key:"responseType",set:function(i){this._responseType=i}},{key:"abort",value:function(){var i=Ul.get("requestTask");i&&i.abort()}},{key:"getAllResponseHeaders",value:function(){var i=jc.get("responseHeader");return Object.keys(i).map(function(s){return"".concat(s,": ").concat(i[s])}).join(`
`)}},{key:"getResponseHeader",value:function(i){return jc.get("responseHeader")[i]}},{key:"open",value:function(i,s,c){this._method=i,this._url=s}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:""}},{key:"setRequestHeader",value:function(i,s){var c=hl.get("requestHeader");c[i]=s,hl.set("requestHeader",c)}},{key:"addEventListener",value:function(i,s){var c=this;typeof s=="function"&&(this["on"+i]=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};g.target=g.target||c,s.call(c,g)})}},{key:"removeEventListener",value:function(i,s){this["on"+i]===s&&(this["on"+i]=null)}}]),t}(me);w()(es,"UNSEND",void 0),w()(es,"OPENED",void 0),w()(es,"HEADERS_RECEIVED",void 0),w()(es,"LOADING",void 0),w()(es,"DONE",void 0),es.UNSEND=0,es.OPENED=1,es.HEADERS_RECEIVED=2,es.LOADING=3,es.DONE=4;function $h(e){var r=Vc();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Vc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var qh=function(e){qr()(t,e);var r=$h(t);function t(n){var i;return Ft()(this,t),i=r.call(this,n),w()(ce()(i),"touches",void 0),w()(ce()(i),"targetTouches",void 0),w()(ce()(i),"changedTouches",void 0),i.touches=[],i.targetTouches=[],i.changedTouches=[],i.target=oi(),i.currentTarget=oi(),i}return Yt()(t)}(_l);function rc(e){var r=e||{},t=r.x,n=t===void 0?0:t,i=r.y,s=i===void 0?0:i,c=r.clientX,g=c===void 0?0:c,y=r.clientY,E=y===void 0?0:y;Object.keys(e).indexOf("x")!==-1?(e.pageX=e.clientX=n,e.pageY=e.clientY=s):(e.x=g,e.y=E)}function nc(e){return function(r){var t=new qh(e);t.changedTouches=r.changedTouches,t.touches=r.touches,t.targetTouches=Array.prototype.slice.call(r.touches),t.timeStamp=r.timeStamp,t.changedTouches.forEach(function(n){return rc(n)}),t.touches.forEach(function(n){return rc(n)}),t.targetTouches.forEach(function(n){return rc(n)}),Jo.dispatchEvent(t)}}function Tf(e){return function(r){r.type=e,Jo.dispatchEvent(r)}}var ic=nc("touchstart"),sf=nc("touchmove"),$f=nc("touchend"),qf=Tf("mapCameaParams");function Qf(e){var r=jl();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function jl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Cl=function(e){qr()(t,e);var r=Qf(t);function t(n){var i;return Ft()(this,t),i=r.call(this,n),w()(ce()(i),"buttons",void 0),w()(ce()(i),"which",void 0),w()(ce()(i),"pointerId",void 0),w()(ce()(i),"bubbles",void 0),w()(ce()(i),"button",void 0),w()(ce()(i),"width",void 0),w()(ce()(i),"height",void 0),w()(ce()(i),"pressure",void 0),w()(ce()(i),"isPrimary",void 0),w()(ce()(i),"pointerType",void 0),w()(ce()(i),"altKey",void 0),w()(ce()(i),"ctrlKey",void 0),w()(ce()(i),"metaKey",void 0),w()(ce()(i),"shiftKey",void 0),i.target=oi(),i.currentTarget=oi(),i}return Yt()(t)}(_l),Mf=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","pageX","pageY","timeStamp"],Qh=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,0,0,0],Jf="touch";function Jh(e,r,t){for(var n=new Cl(e),i=0;i<Mf.length;i++){var s=Mf[i];n[s]=r[s]||Qh[i]}return n.type=e,n.target=oi(),n.currentTarget=oi(),n.buttons=eh(e),n.which=n.buttons,n.pointerId=(r.identifier||0)+2,n.bubbles=!0,n.cancelable=!0,n.button=0,n.width=(r.radiusX||.5)*2,n.height=(r.radiusY||.5)*2,n.pressure=r.force||.5,n.isPrimary=wl(r),n.pointerType=Jf,n.altKey=t.altKey,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,t.preventDefault&&(n.preventDefault=function(){t.preventDefault()}),n}function eh(e){var r=0;return(e==="touchstart"||e==="touchmove"||e==="pointerdown"||e==="pointermove")&&(r=1),r}var Pf=null;function wl(e){return Pf===e.identifier}function At(e){Pf===null&&(Pf=e.identifier)}function Vr(e){Pf===e.identifier&&(Pf=null)}function yr(e){return function(r){for(var t=r.changedTouches,n=0;n<t.length;n++){var i=t[n];n===0&&e==="pointerdown"?At(i):(e==="pointerup"||e==="pointercancel")&&Vr(i);var s=Jh(e,i,r);Jo.dispatchEvent(s)}}}var gi=yr("pointerdown"),Qn=yr("pointermove"),Hi=yr("pointerup");function Da(e){var r=Ya();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Ya(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var uf=function(e){qr()(t,e);var r=Da(t);function t(n){return Ft()(this,t),r.call(this,n)}return Yt()(t)}(_l);function lf(e){return function(r){r.type=e,Jo.dispatchEvent(r)}}var Vl=lf("mousedown"),ep=lf("mousemove"),Ph=lf("mouseup"),ac=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,pl=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),$i=ac||pl,io={atob:Uo,btoa:Ho,devicePixelRatio:no,Blob:uo,document:Jo,Element:mo,Event:_l,EventTarget:me,HTMLCanvasElement:_c,HTMLElement:b,HTMLMediaElement:B,HTMLVideoElement:ot,Image:Li,ImageData:El,navigator:xc,Node:rn,requestAnimationFrame:nf,cancelAnimationFrame:Ap,screen:au,XMLHttpRequest:es,performance:Bl,URL:Uc,WebGLRenderingContext:Kp,WebGL2RenderingContext:Kh,addEventListener:function(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Jo.addEventListener(r,t,n)},removeEventListener:function(r,t,n){Jo.removeEventListener(r,t)},dispatchEvent:function(r){Jo.dispatchEvent(r)},innerWidth:au.availWidth,innerHeight:au.availHeight,setTimeout,clearTimeout,setInterval,clearInterval},di=$i?io:jo,qa=$i?es:jo.XMLHttpRequest,Kn=$i?Oa:jo.location;function Gu(e){var r=e;return typeof e=="string"&&(r=di.document.getElementById(e)),r}function cf(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Gc(e){return cf(e).split(/\s+/)}function Hu(e){var r,t,n=di==null||(r=di.document)===null||r===void 0||(t=r.documentElement)===null||t===void 0?void 0:t.style;if(!n)return e[0];for(var i in e)if(e[i]&&e[i]in n)return e[i];return e[0]}function bs(e,r,t){var n=di.document.createElement(e);return n.className=r||"",t&&t.appendChild(n),n}function ff(e){var r=e.parentNode;r&&r.removeChild(e)}function Ln(e,r){if(e.classList!==void 0)for(var t=Gc(r),n=0,i=t.length;n<i;n++)e.classList.add(t[n]);else if(!hs(e,r)){var s=Vs(e);hf(e,(s?s+" ":"")+r)}}function Gl(e,r){e.classList!==void 0?e.classList.remove(r):hf(e,cf((" "+Vs(e)+" ").replace(" "+r+" "," ")))}function hs(e,r){if(e.classList!==void 0)return e.classList.contains(r);var t=Vs(e);return t.length>0&&new RegExp("(^|\\s)"+r+"(\\s|$)").test(t)}function hf(e,r){e instanceof HTMLElement?e.className=r:e.className.baseVal=r}function Vs(e){return e instanceof SVGElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function Ms(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}var bc=Hu(["transform","WebkitTransform"]);function Hl(e,r){e.style[bc]=r}function _u(){if(typeof Event=="function")di.dispatchEvent(new Event("resize"));else{var e=di.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,di,0),di.dispatchEvent(e)}}function Ec(e){var r=["padding: "+(e.height/2-8)+"px "+e.width/2+"px;","line-height: "+e.height+"px;","background-image: url("+e.toDataURL()+");"];console.log(`%c
`,r.join(""))}function tp(){var e,r=di.document.querySelector('meta[name="viewport"]');if(!r)return 1;var t=(e=r.content)===null||e===void 0?void 0:e.split(","),n=t.find(function(i){var s=i.split("="),c=Ei()(s,2),g=c[0],y=c[1];return g==="initial-scale"});return n?n.split("=")[1]*1:1}var th=tp()<1?1:di.devicePixelRatio,Hc=M("oShl"),pf=M.n(Hc);function Wu(e){var r=rl();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function rl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ma=function(e){qr()(t,e);var r=Wu(t);function t(n,i,s){var c;return Ft()(this,t),c=r.call(this,n),w()(ce()(c),"status",void 0),w()(ce()(c),"url",void 0),c.status=i,c.url=s,c.name=c.constructor.name,c.message=n,c}return Yt()(t,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),t}(pf()(Error));function Al(e){var r=new qa;r.open("GET",e.url,!0);for(var t in e.headers)e.headers.hasOwnProperty(t)&&r.setRequestHeader(t,e.headers[t]);return r.withCredentials=e.credentials==="include",r}var Tl=function(r,t){var n=Al(r);return n.setRequestHeader("Accept","application/json"),n.onerror=function(){t(new Error(n.statusText))},n.onload=function(){if(n.status>=200&&n.status<300&&n.response){var i;try{i=JSON.parse(n.response)}catch(s){return t(s)}t(null,i)}else n.status===401?t(new ma("".concat(n.statusText),n.status,r.url)):t(new ma(n.statusText,n.status,r.url))},n.send(),n},Za=function(r,t){var n=Al(r);return n.responseType="arraybuffer",n.onerror=function(){t(new Error(n.statusText))},n.onload=function(){var i=n.response;if(i.byteLength===0&&n.status===200)return t(new Error("http status 200 returned without content."));n.status>=200&&n.status<300&&n.response?t(null,{data:i,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")}):t(new ma(n.statusText,n.status,r.url))},n.send(),n};function ts(e){var r=di.document.createElement("a");return r.href=e,r.protocol===di.document.location.protocol&&r.host===di.document.location.host}var Wc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",Gs=function(r,t){return Za(r,function(n,i){if(n)t(n);else if(i){var s=new di.Image;s.crossOrigin="anonymous";var c=di.URL||di.webkitURL;s.onload=function(){t(null,s),c.revokeObjectURL(s.src)};var g=new di.Blob([new Uint8Array(i.data)],{type:"image/png"});s.src=i.data.byteLength?c.createObjectURL(g):Wc}})},ps=2*Math.PI*6378137/2;function Of(e){var r=[Infinity,Infinity,-Infinity,-Infinity];return e.forEach(function(t){var n=t.coordinates;bi(r,n)}),r}function bi(e,r){return Array.isArray(r[0])?r.forEach(function(t){bi(e,t)}):(e[0]>r[0]&&(e[0]=r[0]),e[1]>r[1]&&(e[1]=r[1]),e[2]<r[0]&&(e[2]=r[0]),e[3]<r[1]&&(e[3]=r[1])),e}function si(e,r){return Zc(e,r)}function Zc(e,r){return Array.isArray(e[0])?e.map(function(t){return Zc(t,r)}):r(e)}function ko(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};e=Sc(e,r);var n=e[0],i=e[1],s=n*ps/180,c=Math.log(Math.tan((90+i)*Math.PI/360))/(Math.PI/180);return c=c*ps/180,t.enable&&(s=Number(s.toFixed(t.decimal)),c=Number(c.toFixed(t.decimal))),e.length===3?[s,c,e[2]]:[s,c]}function Zu(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,t=e[0],n=e[1],i=t/ps*180,s=n/ps*180;return s=180/Math.PI*(2*Math.atan(Math.exp(s*Math.PI/180))-Math.PI/2),r!=null&&(i=Number(i.toFixed(r)),s=Number(s.toFixed(r))),e.length===3?[i,s,e[2]]:[i,s]}function ds(e){if(e==null)throw new Error("lng is required");return(e>180||e<-180)&&(e=e%360,e>180&&(e=-360+e),e<-180&&(e=360+e),e===0&&(e=0)),e}function nl(e){if(e==null)throw new Error("lat is required");return(e>90||e<-90)&&(e=e%180,e>90&&(e=-180+e),e<-90&&(e=180+e),e===0&&(e=0)),e}function Sc(e,r){if(r===!1)return e;var t=ds(e[0]),n=nl(e[1]);return n>85&&(n=85),n<-85&&(n=-85),e.length===3?[t,n,e[2]]:[t,n]}function vs(e){var r=85.0511287798,t=Math.max(Math.min(r,e[1]),-r),n=256<<20,i=Math.PI/180,s=e[0]*i,c=t*i;c=Math.log(Math.tan(Math.PI/4+c/2));var g=.5/Math.PI,y=.5,E=-.5/Math.PI;return i=.5,s=n*(g*s+y),c=n*(E*c+i),[Math.floor(s),Math.floor(c)]}function Qa(e){var r=.5/Math.PI,t=.5,n=-.5/Math.PI,i=.5,s=256<<20,c=Ei()(e,2),g=c[0],y=c[1];g=(g/s-t)/r,y=(y/s-i)/n,y=(Math.atan(Math.pow(Math.E,y))-Math.PI/4)*2,i=Math.PI/180;var E=y/i,T=g/i;return[T,E]}function Hs(e,r,t){var n=da(r[1]-e[1]),i=da(r[0]-e[0]),s=da(e[1]),c=da(r[1]),g=Math.pow(Math.sin(n/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(s)*Math.cos(c);return ln(2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g)),t="meters")}function Cc(e){var r=Math.PI/180,t=85.0511287798,n=6378137,i=Math.max(Math.min(t,e[1]),-t),s=Math.sin(i*r),c=n*e[0]*r,g=n*Math.log((1+s)/(1-s))/2;return[c,g]}function Wl(e,r){var t=Math.abs(e[1][1]-e[0][1])*r,n=Math.abs(e[1][0]-e[0][0])*r;return[[e[0][0]-n,e[0][1]-t],[e[1][0]+n,e[1][1]+t]]}function dl(e,r){return e[0][0]<=r[0][0]&&e[0][1]<=r[0][1]&&e[1][0]>=r[1][0]&&e[1][1]>=r[1][1]}function Ou(e){return[[e[0],e[1]],[e[2],e[3]]]}function Iu(e,r){return Math.sqrt(Math.pow(e[0]-r[0],2)+Math.pow(e[1]-r[1],2))}function Pe(e,r){return e[0]*r[0]+e[1]*r[1]}function xu(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function df(e,r){return Math.acos(Pe(e,r)/(xu(e)*xu(r)))*180/Math.PI}function su(e,r){return r[0]>0?r[1]>0?90-Math.atan(r[1]/r[0])*180/Math.PI:90+Math.atan(-r[1]/r[0])*180/Math.PI:r[1]<0?180+(90-Math.atan(r[1]/r[0])*180/Math.PI):270+Math.atan(r[1]/-r[0])*180/Math.PI}function Fa(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!e||e.length<2)){for(var t=[0,1],n=0,i=[],s=0;s<e.length-1;s++){var c=e[s],g=e[s+1],y=Iu(c,g);n+=y;var E=[c[0]-g[0],c[1]-g[1]],T=su(t,E);if(s>0){var I=i[s-1].rotation;I-T>360-I+T&&(T=T+360)}i.push({start:c,end:g,dis:y,rotation:T,duration:0})}return i.map(function(F){F.duration=r*(F.dis/n)}),i}}var rp=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,t=arguments.length>1?arguments[1]:void 0;Ft()(this,e),w()(this,"limit",void 0),w()(this,"cache",void 0),w()(this,"destroy",void 0),w()(this,"order",void 0),this.limit=r,this.destroy=t||this.defaultDestroy,this.order=[],this.clear()}return Yt()(e,[{key:"clear",value:function(){var t=this;this.order.forEach(function(n){t.delete(n)}),this.cache={},this.order=[]}},{key:"get",value:function(t){var n=this.cache[t];return n&&(this.deleteOrder(t),this.appendOrder(t)),n}},{key:"set",value:function(t,n){this.cache[t]?(this.delete(t),this.cache[t]=n,this.appendOrder(t)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[t]=n,this.appendOrder(t))}},{key:"delete",value:function(t){var n=this.cache[t];n&&(this.deleteCache(t),this.deleteOrder(t),this.destroy(n,t))}},{key:"deleteCache",value:function(t){delete this.cache[t]}},{key:"deleteOrder",value:function(t){var n=this.order.findIndex(function(i){return i===t});n>=0&&this.order.splice(n,1)}},{key:"appendOrder",value:function(t){this.order.push(t)}},{key:"defaultDestroy",value:function(t,n){return null}}]),e}();function Zl(e,r){e.forEach(function(t){!r[t]||(r[t]=r[t].bind(r))})}var If=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16;Ft()(this,e),w()(this,"duration",16),w()(this,"timestamp",new Date().getTime()),this.duration=r}return Yt()(e,[{key:"run",value:function(t){var n=new Date().getTime(),i=n-this.timestamp;this.timestamp=n,i>=this.duration&&t()}}]),e}(),Xl=function(e,r,t){e.prototype=r.prototype=t,t.constructor=e};function wc(e,r){var t=Object.create(e.prototype);for(var n in r)t[n]=r[n];return t}function Ml(){}var Ac=.7,Pl=1/Ac,bu="\\s*([+-]?\\d+)\\s*",Xu="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ru="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Rf=/^#([0-9a-f]{3,8})$/,Oh=new RegExp("^rgb\\("+[bu,bu,bu]+"\\)$"),d=new RegExp("^rgb\\("+[Ru,Ru,Ru]+"\\)$"),f=new RegExp("^rgba\\("+[bu,bu,bu,Xu]+"\\)$"),l=new RegExp("^rgba\\("+[Ru,Ru,Ru,Xu]+"\\)$"),m=new RegExp("^hsl\\("+[Xu,Ru,Ru]+"\\)$"),C=new RegExp("^hsla\\("+[Xu,Ru,Ru,Xu]+"\\)$"),P={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Xl(Ml,re,{copy:function(r){return Object.assign(new this.constructor,this,r)},displayable:function(){return this.rgb().displayable()},hex:D,formatHex:D,formatHsl:N,formatRgb:K,toString:K});function D(){return this.rgb().formatHex()}function N(){return Mt(this).formatHsl()}function K(){return this.rgb().formatRgb()}function re(e){var r,t;return e=(e+"").trim().toLowerCase(),(r=Rf.exec(e))?(t=r[1].length,r=parseInt(r[1],16),t===6?ge(r):t===3?new Ue(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):t===8?ye(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):t===4?ye(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=Oh.exec(e))?new Ue(r[1],r[2],r[3],1):(r=d.exec(e))?new Ue(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=f.exec(e))?ye(r[1],r[2],r[3],r[4]):(r=l.exec(e))?ye(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=m.exec(e))?Ot(r[1],r[2]/100,r[3]/100,1):(r=C.exec(e))?Ot(r[1],r[2]/100,r[3]/100,r[4]):P.hasOwnProperty(e)?ge(P[e]):e==="transparent"?new Ue(NaN,NaN,NaN,0):null}function ge(e){return new Ue(e>>16&255,e>>8&255,e&255,1)}function ye(e,r,t,n){return n<=0&&(e=r=t=NaN),new Ue(e,r,t,n)}function we(e){return e instanceof Ml||(e=re(e)),e?(e=e.rgb(),new Ue(e.r,e.g,e.b,e.opacity)):new Ue}function We(e,r,t,n){return arguments.length===1?we(e):new Ue(e,r,t,n==null?1:n)}function Ue(e,r,t,n){this.r=+e,this.g=+r,this.b=+t,this.opacity=+n}Xl(Ue,We,wc(Ml,{brighter:function(r){return r=r==null?Pl:Math.pow(Pl,r),new Ue(this.r*r,this.g*r,this.b*r,this.opacity)},darker:function(r){return r=r==null?Ac:Math.pow(Ac,r),new Ue(this.r*r,this.g*r,this.b*r,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:tt,formatHex:tt,formatRgb:Ze,toString:Ze}));function tt(){return"#"+$e(this.r)+$e(this.g)+$e(this.b)}function Ze(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function $e(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Ot(e,r,t,n){return n<=0?e=r=t=NaN:t<=0||t>=1?e=r=NaN:r<=0&&(e=NaN),new qt(e,r,t,n)}function Mt(e){if(e instanceof qt)return new qt(e.h,e.s,e.l,e.opacity);if(e instanceof Ml||(e=re(e)),!e)return new qt;if(e instanceof qt)return e;e=e.rgb();var r=e.r/255,t=e.g/255,n=e.b/255,i=Math.min(r,t,n),s=Math.max(r,t,n),c=NaN,g=s-i,y=(s+i)/2;return g?(r===s?c=(t-n)/g+(t<n)*6:t===s?c=(n-r)/g+2:c=(r-t)/g+4,g/=y<.5?s+i:2-s-i,c*=60):g=y>0&&y<1?0:c,new qt(c,g,y,e.opacity)}function Sr(e,r,t,n){return arguments.length===1?Mt(e):new qt(e,r,t,n==null?1:n)}function qt(e,r,t,n){this.h=+e,this.s=+r,this.l=+t,this.opacity=+n}Xl(qt,Sr,wc(Ml,{brighter:function(r){return r=r==null?Pl:Math.pow(Pl,r),new qt(this.h,this.s,this.l*r,this.opacity)},darker:function(r){return r=r==null?Ac:Math.pow(Ac,r),new qt(this.h,this.s,this.l*r,this.opacity)},rgb:function(){var r=this.h%360+(this.h<0)*360,t=isNaN(r)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,s=2*n-i;return new Ue(gr(r>=240?r-240:r+120,s,i),gr(r,s,i),gr(r<120?r+240:r-120,s,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var r=this.opacity;return r=isNaN(r)?1:Math.max(0,Math.min(1,r)),(r===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(r===1?")":", "+r+")")}}));function gr(e,r,t){return(e<60?r+(t-r)*e/60:e<180?t:e<240?r+(t-r)*(240-e)/60:r)*255}function Tr(e){return typeof e=="string"?!!re(e):!1}function Dr(e){var r=re(e),t=[0,0,0,0];return r!=null&&(t[0]=r.r/255,t[1]=r.g/255,t[2]=r.b/255,t[3]=r.opacity),t}function nn(e){var r=e&&e[0],t=e&&e[1],n=e&&e[2],i=r+t*256+n*65536-1;return i}function An(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}function Vn(e){var r=di.document.createElement("canvas"),t=r.getContext("2d");r.width=256,r.height=1;for(var n=t.createLinearGradient(0,0,256,1),i=null,s=e.positions[0],c=e.positions[e.positions.length-1],g=0;g<e.colors.length;++g){var y=(e.positions[g]-s)/(c-s);n.addColorStop(y,e.colors[g])}return t.fillStyle=n,t.fillRect(0,0,256,1),i=new Uint8ClampedArray(t.getImageData(0,0,256,1).data),$i?{data:i,width:256,height:1}:new ImageData(i,256,1)}var mi;(function(e){e.CENTER="center",e.TOP="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e.BOTTOM="bottom",e["BOTTOM-LEFT"]="bottom-left",e.LEFT="left",e.RIGHT="right"})(mi||(mi={}));var yi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ni(e,r,t){var n=e.classList;for(var i in yi)yi.hasOwnProperty(i)&&n.remove("l7-".concat(t,"-anchor-").concat(i));n.add("l7-".concat(t,"-anchor-").concat(r))}function Ii(e,r){return{enable:e,mask:255,func:{cmp:514,ref:r?1:0,mask:255}}}function $n(e){if(e.length===0)throw new Error("max requires at least one data point");for(var r=e[0],t=1;t<e.length;t++)e[t]>r&&(r=e[t]);return r*1}function zi(e){if(e.length===0)throw new Error("min requires at least one data point");for(var r=e[0],t=1;t<e.length;t++)e[t]<r&&(r=e[t]);return r*1}function Wi(e){if(e.length===0)return 0;for(var r=e[0]*1,t=1;t<e.length;t++)r+=e[t]*1;return r}function ui(e){if(e.length===0)throw new Error("mean requires at least one data point");return Wi(e)/e.length}function ea(e){if(e.length===0)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();for(var r=e[0],t=NaN,n=0,i=1,s=1;s<e.length+1;s++)e[s]!==r?(i>n&&(n=i,t=r),i=1,r=e[s]):i++;return t*1}var Ai={min:zi,max:$n,mean:ui,sum:Wi,mode:ea};function na(e,r){return e.map(function(t){return t[r]})}function wa(e,r){return Ai[e](r)}function rs(e,r){var t=r.extent,n=t===void 0?[121.168,30.2828,121.384,30.4219]:t,i=new Promise(function(c){ka(e,function(g){c(g)})}),s={originData:e,images:i,_id:1,dataArray:[{_id:0,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return s}function ka(e,r){var t=e,n=[];if(typeof t=="string")Gs({url:t},function(c,g){n.push(g),r(n)});else{var i=t.length,s=0;t.forEach(function(c){Gs({url:c},function(g,y){s++,n.push(y),s===i&&r(n)})})}return rs}function ms(e,r){var t=r.extent,n=r.width,i=r.height,s=r.min,c=r.max,g={_id:1,dataArray:[{_id:1,data:Array.from(e),width:n,height:i,min:s,max:c,coordinates:[[t[0],t[1]],[t[2],t[3]]]}]};return g}var Oo=M("JBE3"),Ja=M.n(Oo),Eu=M("4qC0"),ho=M.n(Eu),Yu=M("lSCD"),Su=M.n(Yu),go=M("BkRI"),Ws=M.n(go),Es=M("xp6e"),Lu=M("uhBA"),oc=M.n(Lu),sc=M("mpbz"),Tc=M.n(sc);function ku(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Xc(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ku(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ku(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Ol(e,r){var t=r.radius,n=t===void 0?40:t,i=r.maxZoom,s=i===void 0?18:i,c=r.minZoom,g=c===void 0?0:c,y=r.zoom,E=y===void 0?2:y;if(e.pointIndex){var T=e.pointIndex.getClusters(e.extent,Math.floor(E));return e.dataArray=Ps(T),e}var I=new Tc.a({radius:n,minZoom:g,maxZoom:s}),F={type:"FeatureCollection",features:[]};return F.features=e.dataArray.map(function(U){return{type:"Feature",geometry:{type:"Point",coordinates:U.coordinates},properties:Xc({},U)}}),I.load(F.features),I}function Ps(e){return e.map(function(r,t){return Xc({coordinates:r.geometry.coordinates,_id:t+1},r.properties)})}function Ku(e){if(e.length===0)throw new Error("max requires at least one data point");for(var r=e[0],t=1;t<e.length;t++)e[t]>r&&(r=e[t]);return r}function rh(e){if(e.length===0)throw new Error("min requires at least one data point");for(var r=e[0],t=1;t<e.length;t++)e[t]<r&&(r=e[t]);return r}function uc(e){if(e.length===0)return 0;for(var r=e[0],t=0,n,i=1;i<e.length;i++)n=r+e[i]*1,Math.abs(r)>=Math.abs(e[i])?t+=r-n+e[i]:t+=e[i]-n+r,r=n;return r+t*1}function Ss(e){if(e.length===0)throw new Error("mean requires at least one data point");return uc(e)/e.length}var Cu={min:rh,max:Ku,mean:Ss,sum:uc};function Fs(e,r){return e.map(function(t){return t[r]*1})}function Du(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Bs(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Du(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Du(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Fu(e){var r=vf();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function vf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Yc(e,r){if(Array.isArray(r))return r}var Kc=function(e){qr()(t,e);var r=Fu(t);function t(n,i){var s;return Ft()(this,t),s=r.call(this),w()(ce()(s),"data",void 0),w()(ce()(s),"extent",void 0),w()(ce()(s),"hooks",{init:new Es.c}),w()(ce()(s),"parser",{type:"geojson"}),w()(ce()(s),"transforms",[]),w()(ce()(s),"cluster",!1),w()(ce()(s),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),w()(ce()(s),"mapService",void 0),w()(ce()(s),"invalidExtent",!1),w()(ce()(s),"dataArrayChanged",!1),w()(ce()(s),"originData",void 0),w()(ce()(s),"rawData",void 0),w()(ce()(s),"cfg",{}),w()(ce()(s),"clusterIndex",void 0),s.originData=n,s.initCfg(i),s.hooks.init.tap("parser",function(){s.excuteParser()}),s.hooks.init.tap("cluster",function(){s.initCluster()}),s.hooks.init.tap("transform",function(){s.executeTrans()}),s.init(),s}return Yt()(t,[{key:"setData",value:function(i,s){this.originData=i,this.dataArrayChanged=!1,this.initCfg(s),this.init(),this.emit("update")}},{key:"getClusters",value:function(i){return this.clusterIndex.getClusters(this.caculClusterExtent(2),i)}},{key:"getClustersLeaves",value:function(i){return this.clusterIndex.getLeaves(i,Infinity)}},{key:"updateClusterData",value:function(i){var s=this,c=this.clusterOptions,g=c.method,y=g===void 0?"sum":g,E=c.field,T=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(i));this.clusterOptions.zoom=i,T.forEach(function(I){I.id||(I.properties.point_count=1)}),(E||Su()(y))&&(T=T.map(function(I){var F=I.id;if(F){var U=s.clusterIndex.getLeaves(F,Infinity),Q=U.map(function(Re){return Re.properties}),ue;if(ho()(y)&&E){var de=Fs(Q,E);ue=Cu[y](de)}Su()(y)&&(ue=y(Q)),I.properties.stat=ue}else I.properties.point_count=1;return I})),this.data=gt("geojson")({type:"FeatureCollection",features:T}),this.executeTrans()}},{key:"getFeatureById",value:function(i){var s=this.parser.type,c=s===void 0?"geojson":s;if(c==="geojson"&&!this.cluster){var g=i<this.originData.features.length?this.originData.features[i]:"null",y=Ws()(g);if(this.transforms.length!==0||this.dataArrayChanged){var E=this.data.dataArray.find(function(T){return T._id===i});y.properties=E}return y}else return i<this.data.dataArray.length?this.data.dataArray[i]:"null"}},{key:"updateFeaturePropertiesById",value:function(i,s){this.data.dataArray=this.data.dataArray.map(function(c){return c._id===i?Bs(Bs({},c),s):c}),this.dataArrayChanged=!0,this.emit("update")}},{key:"getFeatureId",value:function(i,s){var c=this.data.dataArray.find(function(g){return g[i]===s});return c==null?void 0:c._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"caculClusterExtent",value:function(i){var s=[[-Infinity,-Infinity],[Infinity,Infinity]];return this.invalidExtent||(s=Wl(Ou(this.extent),i)),s[0].concat(s[1])}},{key:"initCfg",value:function(i){this.cfg=Ja()(this.cfg,i,Yc);var s=this.cfg;s&&(s.parser&&(this.parser=s.parser),s.transforms&&(this.transforms=s.transforms),this.cluster=s.cluster||!1,s.clusterOptions&&(this.cluster=!0,this.clusterOptions=Bs(Bs({},this.clusterOptions),s.clusterOptions)))}},{key:"excuteParser",value:function(){var i=this.parser,s=i.type||"geojson";if(s==="imagetile"){this.data={tileurl:this.originData,dataArray:[]};return}var c=gt(s);this.data=c(this.originData,i),this.extent=Of(this.data.dataArray),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3]}},{key:"executeTrans",value:function(){var i=this,s=this.transforms;s.forEach(function(c){var g=c.type,y=St(g)(i.data,c);Object.assign(i.data,y)})}},{key:"initCluster",value:function(){if(!!this.cluster){var i=this.clusterOptions||{};this.clusterIndex=Ol(this.data,i)}}},{key:"init",value:function(){this.hooks.init.call(this)}}]),t}(Lu.EventEmitter);function Yl(e,r){var t=r.callback;return t&&(e.dataArray=e.dataArray.filter(t)),e}function lc(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=vl(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function vl(e,r){if(!!e){if(typeof e=="string")return Zs(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Zs(e,r)}}function Zs(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Xs=6378e3;function np(e,r){var t=e.dataArray,n=r.size,i=n===void 0?10:n,s=i/(2*Math.PI*Xs)*(256<<20)/2,c=nh(t,i),g=c.gridHash,y=c.gridOffset,E=Lf(g,y,r);return{yOffset:s,xOffset:s,radius:s,type:"grid",dataArray:E}}function nh(e,r){var t=Infinity,n=-Infinity,i,s=lc(e),c;try{for(s.s();!(c=s.n()).done;){var g=c.value;i=g.coordinates[1],Number.isFinite(i)&&(t=i<t?i:t,n=i>n?i:n)}}catch(ht){s.e(ht)}finally{s.f()}var y=(t+n)/2,E=$p(r,y);if(E.xOffset<=0||E.yOffset<=0)return{gridHash:{},gridOffset:E};var T={},I=lc(e),F;try{for(I.s();!(F=I.n()).done;){var U=F.value,Q=U.coordinates[1],ue=U.coordinates[0];if(Number.isFinite(Q)&&Number.isFinite(ue)){var de=Math.floor((Q+90)/E.yOffset),Re=Math.floor((ue+180)/E.xOffset),et="".concat(de,"-").concat(Re);T[et]=T[et]||{count:0,points:[]},T[et].count+=1,T[et].points.push(U)}}}catch(ht){I.e(ht)}finally{I.f()}return{gridHash:T,gridOffset:E}}function $p(e,r){var t=Tp(e),n=Ih(r,e);return{yOffset:t,xOffset:n}}function Tp(e){return e/Xs*(180/Math.PI)}function Ih(e,r){return r/Xs*(180/Math.PI)/Math.cos(e*Math.PI/180)}function Lf(e,r,t){return Object.keys(e).reduce(function(n,i,s){var c=i.split("-"),g=parseInt(c[0],10),y=parseInt(c[1],10),E={};if(t.field&&t.method){var T=Z.getColumn(e[i].points,t.field);E[t.method]=Z.statMap[t.method](T)}return Object.assign(E,{_id:s,coordinates:vs([-180+r.xOffset*(y+.5),-90+r.yOffset*(g+.5)]),rawData:e[i].points,count:e[i].count}),n.push(E),n},[])}var mf=Math.PI/3,qp=[0,mf,2*mf,3*mf,4*mf,5*mf];function ip(e){return e[0]}function ap(e){return e[1]}var ba=function(){var e=0,r=0,t=1,n=1,i=ip,s=ap,c,g,y;function E(I){var F={},U=[],Q,ue=I.length;for(Q=0;Q<ue;++Q)if(!(isNaN(Re=+i.call(null,de=I[Q],Q,I))||isNaN(et=+s.call(null,de,Q,I)))){var de,Re,et,ht=Math.round(et=et/y),xt=Math.round(Re=Re/g-(ht&1)/2),Gt=et-ht;if(Math.abs(Gt)*3>1){var jt=Re-xt,Qt=xt+(Re<xt?-1:1)/2,fr=ht+(et<ht?-1:1),Gr=Re-Qt,Jr=et-fr;jt*jt+Gt*Gt>Gr*Gr+Jr*Jr&&(xt=Qt+(ht&1?1:-1)/2,ht=fr)}var Ur=xt+"-"+ht,Xn=F[Ur];Xn?Xn.push(de):(U.push(Xn=F[Ur]=[de]),Xn.x=(xt+(ht&1)/2)*g,Xn.y=ht*y)}return U}function T(I){var F=0,U=0;return qp.map(function(Q){var ue=Math.sin(Q)*I,de=-Math.cos(Q)*I,Re=ue-F,et=de-U;return F=ue,U=de,[Re,et]})}return E.hexagon=function(I){return"m"+T(I==null?c:+I).join("l")+"z"},E.centers=function(){for(var I=[],F=Math.round(r/y),U=Math.round(e/g),Q=F*y;Q<n+c;Q+=y,++F)for(var ue=U*g+(F&1)*g/2;ue<t+g/2;ue+=g)I.push([ue,Q]);return I},E.mesh=function(){var I=T(c).slice(0,4).join("l");return E.centers().map(function(F){return"M"+F+"m"+I}).join("")},E.x=function(I){return arguments.length?(i=I,E):i},E.y=function(I){return arguments.length?(s=I,E):s},E.radius=function(I){return arguments.length?(c=+I,g=c*2*Math.sin(mf),y=c*1.5,E):c},E.size=function(I){return arguments.length?(e=r=0,t=+I[0],n=+I[1],E):[t-e,n-r]},E.extent=function(I){return arguments.length?(e=+I[0][0],r=+I[0][1],t=+I[1][0],n=+I[1][1],E):[[e,r],[t,n]]},E.radius(1)};function Rh(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function ih(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Rh(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Rh(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var ah=6378e3;function wd(e,r){var t=e.dataArray,n=r.size,i=n===void 0?10:n,s=r.method,c=s===void 0?"sum":s,g=i/(2*Math.PI*ah)*(256<<20)/2,y=t.map(function(F){var U=vs(F.coordinates),Q=Ei()(U,2),ue=Q[0],de=Q[1];return ih(ih({},F),{},{coordinates:[ue,de]})}),E=ba().radius(g).x(function(F){return F.coordinates[0]}).y(function(F){return F.coordinates[1]}),T=E(y),I={dataArray:T.map(function(F,U){var Q;if(r.field&&c){var ue=Z.getColumn(F,r.field);F[c]=Z.statMap[c](ue)}return Q={},w()(Q,r.method,F[c]),w()(Q,"count",F.length),w()(Q,"rawData",F),w()(Q,"coordinates",[F.x,F.y]),w()(Q,"_id",U),Q}),radius:g,xOffset:g,yOffset:g,type:"hexagon"};return I}function Ad(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Qp(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Ad(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ad(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function cc(e,r){var t=r.sourceField,n=r.targetField,i=r.data,s={};return i.forEach(function(c){s[c[t]]=c}),e.dataArray=e.dataArray.map(function(c){var g=c[n];return Qp(Qp({},c),s[g])}),e}function sv(e,r){var t=r.callback;return t&&(e.dataArray=e.dataArray.map(t)),e}yt("geojson",ua),yt("image",rs),yt("csv",$r),yt("json",Ar),yt("raster",ms),He("cluster",Ol),He("filter",Yl),He("join",cc),He("map",sv),He("grid",np),He("hexagon",wd);var Lh=nr,Jp=Pr,oh=Kc,uv=M("mNvP"),Cr=M("4cb6"),Mc=M("APxj"),Mp=M.n(Mc),sr={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")},gf=M("TIQr"),yf=M.n(gf);function kf(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function sh(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?kf(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):kf(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function $c(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Df(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function Df(e,r){if(!!e){if(typeof e=="string")return Il(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Il(e,r)}}function Il(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Ff=30;function Rl(e){var r=e.characterSet,t=e.getFontWidth,n=e.fontHeight,i=e.buffer,s=e.maxCanvasWidth,c=e.mapping,g=c===void 0?{}:c,y=e.xOffset,E=y===void 0?0:y,T=e.yOffset,I=T===void 0?0:T,F=0,U=E;Array.from(r).forEach(function(ue,de){if(!g[ue]){var Re=t(ue,de);U+Ff>s&&(U=0,F++),g[ue]={x:U,y:I+F*Ff,width:Ff,height:Ff,advance:Re},U+=Ff}});var Q=n+i*2;return{mapping:g,xOffset:U,yOffset:I+F*Q,canvasHeight:uh(I+(F+1)*Q)}}function op(e,r,t){var n=0,i=0,s=0,c=[],g={},y=$c(e),E;try{for(y.s();!(E=y.n()).done;){var T=E.value;if(!g[T.id]){var I=T.size;n+I+r>t&&(Bf(g,c,i),n=0,i=s+i+r,s=0,c=[]),c.push({icon:T,xOffset:n}),n=n+I+r,s=Math.max(s,I)}}}catch(U){y.e(U)}finally{y.f()}c.length>0&&Bf(g,c,i);var F=uh(s+i+r);return{mapping:g,canvasHeight:F}}function Bf(e,r,t){var n=$c(r),i;try{for(n.s();!(i=n.n()).done;){var s=i.value,c=s.icon,g=s.xOffset;e[c.id]=sh(sh({},c),{},{x:g,y:t,image:c.image,width:c.width,height:c.height})}}catch(y){n.e(y)}finally{n.f()}}function uh(e){return Math.pow(2,Math.ceil(Math.log2(e)))}var Nf,zf;function il(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=kh(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function kh(e,r){if(!!e){if(typeof e=="string")return lh(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return lh(e,r)}}function lh(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Pp(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Uf(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Pp(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Pp(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var _f=ml(),uu="sans-serif",fc="normal",lv=24,Td=3,sp=.25,Kl=8,Op=1024,jf=1,ed=1,Ip=3,qc=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function ml(){for(var e=[],r=32;r<128;r++)e.push(String.fromCharCode(r));return e}function Pc(e,r,t,n){e.font="".concat(n," ").concat(t,"px ").concat(r),e.fillStyle="black",e.textBaseline="middle"}function Rp(e,r){for(var t=0;t<e.length;t++)r.data[4*t+3]=e[t]}var ch=(Nf=Object(Cr.injectable)(),Nf(zf=function(){function e(){Ft()(this,e),w()(this,"fontAtlas",void 0),w()(this,"iconFontMap",void 0),w()(this,"iconFontGlyphs",{}),w()(this,"fontOptions",void 0),w()(this,"key",void 0),w()(this,"cache",new rp(Ip))}return Yt()(e,[{key:"scale",get:function(){return ed}},{key:"canvas",get:function(){var t=this.cache.get(this.key);return t&&t.data}},{key:"mapping",get:function(){var t=this.cache.get(this.key);return t&&t.mapping}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:uu,fontWeight:fc,characterSet:_f,fontSize:lv,buffer:Td,sdf:!0,cutoff:sp,radius:Kl,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(t){var n=this;t.forEach(function(i){n.iconFontGlyphs[i.name]=i.unicode})}},{key:"addIconFont",value:function(t,n){this.iconFontMap.set(t,n)}},{key:"getIconFontKey",value:function(t){return this.iconFontMap.get(t)||t}},{key:"getGlyph",value:function(t){return this.iconFontGlyphs[t]?String.fromCharCode(parseInt(this.iconFontGlyphs[t],16)):""}},{key:"setFontOptions",value:function(t){this.fontOptions=Uf(Uf({},this.fontOptions),t),this.key=this.getKey();var n=this.getNewChars(this.key,this.fontOptions.characterSet),i=this.cache.get(this.key);if(!(i&&n.length===0)){var s=this.generateFontAtlas(this.key,n,i);this.fontAtlas=s,this.cache.set(this.key,s)}}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(t,n,i){var s=this.fontOptions,c=s.fontFamily,g=s.fontWeight,y=s.fontSize,E=s.buffer,T=s.sdf,I=s.radius,F=s.cutoff,U=s.iconfont,Q=i&&i.data;Q||(Q=di.document.createElement("canvas"),Q.width=Op);var ue=Q.getContext("2d");Pc(ue,c,y,g);var de=Rl(Uf({getFontWidth:function(ll){return ue.measureText(ll).width},fontHeight:y*ed,buffer:E,characterSet:n,maxCanvasWidth:Op},i&&{mapping:i.mapping,xOffset:i.xOffset,yOffset:i.yOffset})),Re=de.mapping,et=de.canvasHeight,ht=de.xOffset,xt=de.yOffset,Gt=ue.getImageData(0,0,Q.width,Q.height);if(Q.height=et,ue.putImageData(Gt,0,0),Pc(ue,c,y,g),T){var jt=new yf.a(y,E,I,F,c,g),Qt=ue.getImageData(0,0,jt.size,jt.size),fr=il(n),Gr;try{for(fr.s();!(Gr=fr.n()).done;){var Jr=Gr.value;if(U){var Ur=String.fromCharCode(parseInt(Jr.replace("&#x","").replace(";",""),16)),Xn=jt.draw(Ur);Rp(Xn,Qt)}else Rp(jt.draw(Jr),Qt);ue.putImageData(Qt,Re[Jr].x,Re[Jr].y)}}catch(zs){fr.e(zs)}finally{fr.f()}}else{var ni=il(n),Oi;try{for(ni.s();!(Oi=ni.n()).done;){var No=Oi.value;ue.fillText(No,Re[No].x,Re[No].y+y*jf)}}catch(zs){ni.e(zs)}finally{ni.f()}}return{xOffset:ht,yOffset:xt,mapping:Re,data:Q,width:Q.width,height:Q.height}}},{key:"getKey",value:function(){return"key";var t,n,i,s,c,g,y,E}},{key:"getNewChars",value:function(t,n){var i=this.cache.get(t);if(!i)return n;var s=[],c=i.mapping,g=new Set(Object.keys(c)),y=new Set(n);return y.forEach(function(E){g.has(E)||s.push(E)}),s}}]),e}())||zf),al,up;function Dh(e){var r=Fh();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Fh(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var lp=3,Ys=1024,Ll=64,Ba=(al=Object(Cr.injectable)(),al(up=function(e){qr()(t,e);var r=Dh(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"canvasHeight",128),w()(ce()(n),"texture",void 0),w()(ce()(n),"canvas",void 0),w()(ce()(n),"iconData",void 0),w()(ce()(n),"iconMap",void 0),w()(ce()(n),"ctx",void 0),w()(ce()(n),"loadingImageCount",0),n}return Yt()(t,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=di.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(i,s){var c=this,g=new Image;if(this.loadingImageCount++,this.hasImage(i))throw new Error("Image Id already exists");this.iconData.push({id:i,size:Ll}),this.updateIconMap(),this.loadImage(s).then(function(y){g=y;var E=c.iconData.find(function(T){return T.id===i});E&&(E.image=g,E.width=g.width,E.height=g.height),c.update()})}},{key:"addImageMini",value:function(i,s,c){var g=this,y=c.getSceneConfig().canvas,E=y.createImage();if(this.loadingImageCount++,this.hasImage(i))throw new Error("Image Id already exists");this.iconData.push({id:i,size:Ll}),this.updateIconMap(),this.loadImageMini(s,y).then(function(T){E=T;var I=g.iconData.find(function(F){return F.id===i});I&&(I.image=E,I.width=E.width,I.height=E.height),g.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(i){return this.iconMap.hasOwnProperty(i)}},{key:"removeImage",value:function(i){this.hasImage(i)&&(this.iconData=this.iconData.filter(function(s){return s.id!==i}),delete this.iconMap[i],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var i=this;this.canvas.width=Ys,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(s){var c=i.iconMap[s],g=c.x,y=c.y,E=c.image,T=c.width,I=T===void 0?64:T,F=c.height,U=F===void 0?64:F,Q=Math.max(I,U),ue=Q/Ll,de=U/ue,Re=I/ue;E&&i.ctx.drawImage(E,g+(Ll-Re)/2,y+(Ll-de)/2,Re,de)})}},{key:"updateIconMap",value:function(){var i=op(this.iconData,lp,Ys),s=i.mapping,c=i.canvasHeight;this.iconMap=s,this.canvasHeight=c}},{key:"loadImage",value:function(i){return new Promise(function(s,c){if(i instanceof HTMLImageElement){s(i);return}var g=new Image;g.crossOrigin="anonymous",g.onload=function(){s(g)},g.onerror=function(){c(new Error("Could not load image at "+i))},g.src=i instanceof File?URL.createObjectURL(i):i})}},{key:"loadImageMini",value:function(i,s){return new Promise(function(c,g){var y=s.createImage();y.crossOrigin="anonymous",y.onload=function(){c(y)},y.onerror=function(){g(new Error("Could not load image at "+i))},y.src=i})}}]),t}(Lu.EventEmitter))||up),ga=1e-6,Wo=typeof Float32Array!="undefined"?Float32Array:Array,Vf=Math.random;function cv(e){Wo=e}var Qc=Math.PI/180;function fv(e){return e*Qc}function Md(e,r){return Math.abs(e-r)<=ga*Math.max(1,Math.abs(e),Math.abs(r))}Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});function hv(){var e=new Wo(4);return Wo!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function td(e){var r=new Wo(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function pv(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function dv(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function $l(e,r,t,n){var i=new Wo(4);return i[0]=e,i[1]=r,i[2]=t,i[3]=n,i}function cp(e,r,t,n,i){return e[0]=r,e[1]=t,e[2]=n,e[3]=i,e}function fp(e,r){if(e===r){var t=r[1];e[1]=r[2],e[2]=t}else e[0]=r[0],e[1]=r[2],e[2]=r[1],e[3]=r[3];return e}function fh(e,r){var t=r[0],n=r[1],i=r[2],s=r[3],c=t*s-i*n;return c?(c=1/c,e[0]=s*c,e[1]=-n*c,e[2]=-i*c,e[3]=t*c,e):null}function po(e,r){var t=r[0];return e[0]=r[3],e[1]=-r[1],e[2]=-r[2],e[3]=t,e}function hh(e){return e[0]*e[3]-e[2]*e[1]}function Ui(e,r,t){var n=r[0],i=r[1],s=r[2],c=r[3],g=t[0],y=t[1],E=t[2],T=t[3];return e[0]=n*g+s*y,e[1]=i*g+c*y,e[2]=n*E+s*T,e[3]=i*E+c*T,e}function xf(e,r,t){var n=r[0],i=r[1],s=r[2],c=r[3],g=Math.sin(t),y=Math.cos(t);return e[0]=n*y+s*g,e[1]=i*y+c*g,e[2]=n*-g+s*y,e[3]=i*-g+c*y,e}function J(e,r,t){var n=r[0],i=r[1],s=r[2],c=r[3],g=t[0],y=t[1];return e[0]=n*g,e[1]=i*g,e[2]=s*y,e[3]=c*y,e}function he(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=-t,e[3]=n,e}function qe(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=r[1],e}function er(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function wr(e){return Math.hypot(e[0],e[1],e[2],e[3])}function lr(e,r,t,n){return e[2]=n[2]/n[0],t[0]=n[0],t[1]=n[1],t[3]=n[3]-e[2]*t[1],[e,r,t]}function cr(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e}function Hr(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e}function tn(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]}function an(e,r){var t=e[0],n=e[1],i=e[2],s=e[3],c=r[0],g=r[1],y=r[2],E=r[3];return Math.abs(t-c)<=ga*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(n-g)<=ga*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(i-y)<=ga*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(s-E)<=ga*Math.max(1,Math.abs(s),Math.abs(E))}function un(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e}function on(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e}var kn=Ui,En=Hr;function Zr(){var e=new Wo(16);return Wo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Vt(e){var r=new Wo(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function tr(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Qr(e,r,t,n,i,s,c,g,y,E,T,I,F,U,Q,ue){var de=new Wo(16);return de[0]=e,de[1]=r,de[2]=t,de[3]=n,de[4]=i,de[5]=s,de[6]=c,de[7]=g,de[8]=y,de[9]=E,de[10]=T,de[11]=I,de[12]=F,de[13]=U,de[14]=Q,de[15]=ue,de}function zn(e,r,t,n,i,s,c,g,y,E,T,I,F,U,Q,ue,de){return e[0]=r,e[1]=t,e[2]=n,e[3]=i,e[4]=s,e[5]=c,e[6]=g,e[7]=y,e[8]=E,e[9]=T,e[10]=I,e[11]=F,e[12]=U,e[13]=Q,e[14]=ue,e[15]=de,e}function Er(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qn(e,r){if(e===r){var t=r[1],n=r[2],i=r[3],s=r[6],c=r[7],g=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=t,e[6]=r[9],e[7]=r[13],e[8]=n,e[9]=s,e[11]=r[14],e[12]=i,e[13]=c,e[14]=g}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}function Bn(e,r){var t=r[0],n=r[1],i=r[2],s=r[3],c=r[4],g=r[5],y=r[6],E=r[7],T=r[8],I=r[9],F=r[10],U=r[11],Q=r[12],ue=r[13],de=r[14],Re=r[15],et=t*g-n*c,ht=t*y-i*c,xt=t*E-s*c,Gt=n*y-i*g,jt=n*E-s*g,Qt=i*E-s*y,fr=T*ue-I*Q,Gr=T*de-F*Q,Jr=T*Re-U*Q,Ur=I*de-F*ue,Xn=I*Re-U*ue,ni=F*Re-U*de,Oi=et*ni-ht*Xn+xt*Ur+Gt*Jr-jt*Gr+Qt*fr;return Oi?(Oi=1/Oi,e[0]=(g*ni-y*Xn+E*Ur)*Oi,e[1]=(i*Xn-n*ni-s*Ur)*Oi,e[2]=(ue*Qt-de*jt+Re*Gt)*Oi,e[3]=(F*jt-I*Qt-U*Gt)*Oi,e[4]=(y*Jr-c*ni-E*Gr)*Oi,e[5]=(t*ni-i*Jr+s*Gr)*Oi,e[6]=(de*xt-Q*Qt-Re*ht)*Oi,e[7]=(T*Qt-F*xt+U*ht)*Oi,e[8]=(c*Xn-g*Jr+E*fr)*Oi,e[9]=(n*Jr-t*Xn-s*fr)*Oi,e[10]=(Q*jt-ue*xt+Re*et)*Oi,e[11]=(I*xt-T*jt-U*et)*Oi,e[12]=(g*Gr-c*Ur-y*fr)*Oi,e[13]=(t*Ur-n*Gr+i*fr)*Oi,e[14]=(ue*ht-Q*Gt-de*et)*Oi,e[15]=(T*Gt-I*ht+F*et)*Oi,e):null}function pn(e,r){var t=r[0],n=r[1],i=r[2],s=r[3],c=r[4],g=r[5],y=r[6],E=r[7],T=r[8],I=r[9],F=r[10],U=r[11],Q=r[12],ue=r[13],de=r[14],Re=r[15];return e[0]=g*(F*Re-U*de)-I*(y*Re-E*de)+ue*(y*U-E*F),e[1]=-(n*(F*Re-U*de)-I*(i*Re-s*de)+ue*(i*U-s*F)),e[2]=n*(y*Re-E*de)-g*(i*Re-s*de)+ue*(i*E-s*y),e[3]=-(n*(y*U-E*F)-g*(i*U-s*F)+I*(i*E-s*y)),e[4]=-(c*(F*Re-U*de)-T*(y*Re-E*de)+Q*(y*U-E*F)),e[5]=t*(F*Re-U*de)-T*(i*Re-s*de)+Q*(i*U-s*F),e[6]=-(t*(y*Re-E*de)-c*(i*Re-s*de)+Q*(i*E-s*y)),e[7]=t*(y*U-E*F)-c*(i*U-s*F)+T*(i*E-s*y),e[8]=c*(I*Re-U*ue)-T*(g*Re-E*ue)+Q*(g*U-E*I),e[9]=-(t*(I*Re-U*ue)-T*(n*Re-s*ue)+Q*(n*U-s*I)),e[10]=t*(g*Re-E*ue)-c*(n*Re-s*ue)+Q*(n*E-s*g),e[11]=-(t*(g*U-E*I)-c*(n*U-s*I)+T*(n*E-s*g)),e[12]=-(c*(I*de-F*ue)-T*(g*de-y*ue)+Q*(g*F-y*I)),e[13]=t*(I*de-F*ue)-T*(n*de-i*ue)+Q*(n*F-i*I),e[14]=-(t*(g*de-y*ue)-c*(n*de-i*ue)+Q*(n*y-i*g)),e[15]=t*(g*F-y*I)-c*(n*F-i*I)+T*(n*y-i*g),e}function Rr(e){var r=e[0],t=e[1],n=e[2],i=e[3],s=e[4],c=e[5],g=e[6],y=e[7],E=e[8],T=e[9],I=e[10],F=e[11],U=e[12],Q=e[13],ue=e[14],de=e[15],Re=r*c-t*s,et=r*g-n*s,ht=r*y-i*s,xt=t*g-n*c,Gt=t*y-i*c,jt=n*y-i*g,Qt=E*Q-T*U,fr=E*ue-I*U,Gr=E*de-F*U,Jr=T*ue-I*Q,Ur=T*de-F*Q,Xn=I*de-F*ue;return Re*Xn-et*Ur+ht*Jr+xt*Gr-Gt*fr+jt*Qt}function mr(e,r,t){var n=r[0],i=r[1],s=r[2],c=r[3],g=r[4],y=r[5],E=r[6],T=r[7],I=r[8],F=r[9],U=r[10],Q=r[11],ue=r[12],de=r[13],Re=r[14],et=r[15],ht=t[0],xt=t[1],Gt=t[2],jt=t[3];return e[0]=ht*n+xt*g+Gt*I+jt*ue,e[1]=ht*i+xt*y+Gt*F+jt*de,e[2]=ht*s+xt*E+Gt*U+jt*Re,e[3]=ht*c+xt*T+Gt*Q+jt*et,ht=t[4],xt=t[5],Gt=t[6],jt=t[7],e[4]=ht*n+xt*g+Gt*I+jt*ue,e[5]=ht*i+xt*y+Gt*F+jt*de,e[6]=ht*s+xt*E+Gt*U+jt*Re,e[7]=ht*c+xt*T+Gt*Q+jt*et,ht=t[8],xt=t[9],Gt=t[10],jt=t[11],e[8]=ht*n+xt*g+Gt*I+jt*ue,e[9]=ht*i+xt*y+Gt*F+jt*de,e[10]=ht*s+xt*E+Gt*U+jt*Re,e[11]=ht*c+xt*T+Gt*Q+jt*et,ht=t[12],xt=t[13],Gt=t[14],jt=t[15],e[12]=ht*n+xt*g+Gt*I+jt*ue,e[13]=ht*i+xt*y+Gt*F+jt*de,e[14]=ht*s+xt*E+Gt*U+jt*Re,e[15]=ht*c+xt*T+Gt*Q+jt*et,e}function gn(e,r,t){var n=t[0],i=t[1],s=t[2],c,g,y,E,T,I,F,U,Q,ue,de,Re;return r===e?(e[12]=r[0]*n+r[4]*i+r[8]*s+r[12],e[13]=r[1]*n+r[5]*i+r[9]*s+r[13],e[14]=r[2]*n+r[6]*i+r[10]*s+r[14],e[15]=r[3]*n+r[7]*i+r[11]*s+r[15]):(c=r[0],g=r[1],y=r[2],E=r[3],T=r[4],I=r[5],F=r[6],U=r[7],Q=r[8],ue=r[9],de=r[10],Re=r[11],e[0]=c,e[1]=g,e[2]=y,e[3]=E,e[4]=T,e[5]=I,e[6]=F,e[7]=U,e[8]=Q,e[9]=ue,e[10]=de,e[11]=Re,e[12]=c*n+T*i+Q*s+r[12],e[13]=g*n+I*i+ue*s+r[13],e[14]=y*n+F*i+de*s+r[14],e[15]=E*n+U*i+Re*s+r[15]),e}function Sn(e,r,t){var n=t[0],i=t[1],s=t[2];return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*i,e[5]=r[5]*i,e[6]=r[6]*i,e[7]=r[7]*i,e[8]=r[8]*s,e[9]=r[9]*s,e[10]=r[10]*s,e[11]=r[11]*s,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function sn(e,r,t,n){var i=n[0],s=n[1],c=n[2],g=Math.hypot(i,s,c),y,E,T,I,F,U,Q,ue,de,Re,et,ht,xt,Gt,jt,Qt,fr,Gr,Jr,Ur,Xn,ni,Oi,No;return g<ga?null:(g=1/g,i*=g,s*=g,c*=g,y=Math.sin(t),E=Math.cos(t),T=1-E,I=r[0],F=r[1],U=r[2],Q=r[3],ue=r[4],de=r[5],Re=r[6],et=r[7],ht=r[8],xt=r[9],Gt=r[10],jt=r[11],Qt=i*i*T+E,fr=s*i*T+c*y,Gr=c*i*T-s*y,Jr=i*s*T-c*y,Ur=s*s*T+E,Xn=c*s*T+i*y,ni=i*c*T+s*y,Oi=s*c*T-i*y,No=c*c*T+E,e[0]=I*Qt+ue*fr+ht*Gr,e[1]=F*Qt+de*fr+xt*Gr,e[2]=U*Qt+Re*fr+Gt*Gr,e[3]=Q*Qt+et*fr+jt*Gr,e[4]=I*Jr+ue*Ur+ht*Xn,e[5]=F*Jr+de*Ur+xt*Xn,e[6]=U*Jr+Re*Ur+Gt*Xn,e[7]=Q*Jr+et*Ur+jt*Xn,e[8]=I*ni+ue*Oi+ht*No,e[9]=F*ni+de*Oi+xt*No,e[10]=U*ni+Re*Oi+Gt*No,e[11]=Q*ni+et*Oi+jt*No,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}function In(e,r,t){var n=Math.sin(t),i=Math.cos(t),s=r[4],c=r[5],g=r[6],y=r[7],E=r[8],T=r[9],I=r[10],F=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=s*i+E*n,e[5]=c*i+T*n,e[6]=g*i+I*n,e[7]=y*i+F*n,e[8]=E*i-s*n,e[9]=T*i-c*n,e[10]=I*i-g*n,e[11]=F*i-y*n,e}function Tn(e,r,t){var n=Math.sin(t),i=Math.cos(t),s=r[0],c=r[1],g=r[2],y=r[3],E=r[8],T=r[9],I=r[10],F=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=s*i-E*n,e[1]=c*i-T*n,e[2]=g*i-I*n,e[3]=y*i-F*n,e[8]=s*n+E*i,e[9]=c*n+T*i,e[10]=g*n+I*i,e[11]=y*n+F*i,e}function ta(e,r,t){var n=Math.sin(t),i=Math.cos(t),s=r[0],c=r[1],g=r[2],y=r[3],E=r[4],T=r[5],I=r[6],F=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=s*i+E*n,e[1]=c*i+T*n,e[2]=g*i+I*n,e[3]=y*i+F*n,e[4]=E*i-s*n,e[5]=T*i-c*n,e[6]=I*i-g*n,e[7]=F*i-y*n,e}function ji(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Fn(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=r[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Dn(e,r,t){var n=t[0],i=t[1],s=t[2],c=Math.hypot(n,i,s),g,y,E;return c<ga?null:(c=1/c,n*=c,i*=c,s*=c,g=Math.sin(r),y=Math.cos(r),E=1-y,e[0]=n*n*E+y,e[1]=i*n*E+s*g,e[2]=s*n*E-i*g,e[3]=0,e[4]=n*i*E-s*g,e[5]=i*i*E+y,e[6]=s*i*E+n*g,e[7]=0,e[8]=n*s*E+i*g,e[9]=i*s*E-n*g,e[10]=s*s*E+y,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Mi(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qi(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ea(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ao(e,r,t){var n=r[0],i=r[1],s=r[2],c=r[3],g=n+n,y=i+i,E=s+s,T=n*g,I=n*y,F=n*E,U=i*y,Q=i*E,ue=s*E,de=c*g,Re=c*y,et=c*E;return e[0]=1-(U+ue),e[1]=I+et,e[2]=F-Re,e[3]=0,e[4]=I-et,e[5]=1-(T+ue),e[6]=Q+de,e[7]=0,e[8]=F+Re,e[9]=Q-de,e[10]=1-(T+U),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function ns(e,r){var t=new Wo(3),n=-r[0],i=-r[1],s=-r[2],c=r[3],g=r[4],y=r[5],E=r[6],T=r[7],I=n*n+i*i+s*s+c*c;return I>0?(t[0]=(g*c+T*n+y*s-E*i)*2/I,t[1]=(y*c+T*i+E*n-g*s)*2/I,t[2]=(E*c+T*s+g*i-y*n)*2/I):(t[0]=(g*c+T*n+y*s-E*i)*2,t[1]=(y*c+T*i+E*n-g*s)*2,t[2]=(E*c+T*s+g*i-y*n)*2),Ao(e,r,t),e}function ia(e,r){return e[0]=r[12],e[1]=r[13],e[2]=r[14],e}function Zo(e,r){var t=r[0],n=r[1],i=r[2],s=r[4],c=r[5],g=r[6],y=r[8],E=r[9],T=r[10];return e[0]=Math.hypot(t,n,i),e[1]=Math.hypot(s,c,g),e[2]=Math.hypot(y,E,T),e}function Io(e,r){var t=new Wo(3);Zo(t,r);var n=1/t[0],i=1/t[1],s=1/t[2],c=r[0]*n,g=r[1]*i,y=r[2]*s,E=r[4]*n,T=r[5]*i,I=r[6]*s,F=r[8]*n,U=r[9]*i,Q=r[10]*s,ue=c+T+Q,de=0;return ue>0?(de=Math.sqrt(ue+1)*2,e[3]=.25*de,e[0]=(I-U)/de,e[1]=(F-y)/de,e[2]=(g-E)/de):c>T&&c>Q?(de=Math.sqrt(1+c-T-Q)*2,e[3]=(I-U)/de,e[0]=.25*de,e[1]=(g+E)/de,e[2]=(F+y)/de):T>Q?(de=Math.sqrt(1+T-c-Q)*2,e[3]=(F-y)/de,e[0]=(g+E)/de,e[1]=.25*de,e[2]=(I+U)/de):(de=Math.sqrt(1+Q-c-T)*2,e[3]=(g-E)/de,e[0]=(F+y)/de,e[1]=(I+U)/de,e[2]=.25*de),e}function Os(e,r,t,n){var i=r[0],s=r[1],c=r[2],g=r[3],y=i+i,E=s+s,T=c+c,I=i*y,F=i*E,U=i*T,Q=s*E,ue=s*T,de=c*T,Re=g*y,et=g*E,ht=g*T,xt=n[0],Gt=n[1],jt=n[2];return e[0]=(1-(Q+de))*xt,e[1]=(F+ht)*xt,e[2]=(U-et)*xt,e[3]=0,e[4]=(F-ht)*Gt,e[5]=(1-(I+de))*Gt,e[6]=(ue+Re)*Gt,e[7]=0,e[8]=(U+et)*jt,e[9]=(ue-Re)*jt,e[10]=(1-(I+Q))*jt,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Is(e,r,t,n,i){var s=r[0],c=r[1],g=r[2],y=r[3],E=s+s,T=c+c,I=g+g,F=s*E,U=s*T,Q=s*I,ue=c*T,de=c*I,Re=g*I,et=y*E,ht=y*T,xt=y*I,Gt=n[0],jt=n[1],Qt=n[2],fr=i[0],Gr=i[1],Jr=i[2],Ur=(1-(ue+Re))*Gt,Xn=(U+xt)*Gt,ni=(Q-ht)*Gt,Oi=(U-xt)*jt,No=(1-(F+Re))*jt,zs=(de+et)*jt,ll=(Q+ht)*Qt,Fc=(de-et)*Qt,el=(1-(F+ue))*Qt;return e[0]=Ur,e[1]=Xn,e[2]=ni,e[3]=0,e[4]=Oi,e[5]=No,e[6]=zs,e[7]=0,e[8]=ll,e[9]=Fc,e[10]=el,e[11]=0,e[12]=t[0]+fr-(Ur*fr+Oi*Gr+ll*Jr),e[13]=t[1]+Gr-(Xn*fr+No*Gr+Fc*Jr),e[14]=t[2]+Jr-(ni*fr+zs*Gr+el*Jr),e[15]=1,e}function lu(e,r){var t=r[0],n=r[1],i=r[2],s=r[3],c=t+t,g=n+n,y=i+i,E=t*c,T=n*c,I=n*g,F=i*c,U=i*g,Q=i*y,ue=s*c,de=s*g,Re=s*y;return e[0]=1-I-Q,e[1]=T+Re,e[2]=F-de,e[3]=0,e[4]=T-Re,e[5]=1-E-Q,e[6]=U+ue,e[7]=0,e[8]=F+de,e[9]=U-ue,e[10]=1-E-I,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function cu(e,r,t,n,i,s,c){var g=1/(t-r),y=1/(i-n),E=1/(s-c);return e[0]=s*2*g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*y,e[6]=0,e[7]=0,e[8]=(t+r)*g,e[9]=(i+n)*y,e[10]=(c+s)*E,e[11]=-1,e[12]=0,e[13]=0,e[14]=c*s*2*E,e[15]=0,e}function fu(e,r,t,n,i){var s=1/Math.tan(r/2),c;return e[0]=s/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(c=1/(n-i),e[10]=(i+n)*c,e[14]=2*i*n*c):(e[10]=-1,e[14]=-2*n),e}var Xo=fu;function pa(e,r,t,n,i){var s=1/Math.tan(r/2),c;return e[0]=s/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(c=1/(n-i),e[10]=i*c,e[14]=i*n*c):(e[10]=-1,e[14]=-n),e}function Ns(e,r,t,n){var i=Math.tan(r.upDegrees*Math.PI/180),s=Math.tan(r.downDegrees*Math.PI/180),c=Math.tan(r.leftDegrees*Math.PI/180),g=Math.tan(r.rightDegrees*Math.PI/180),y=2/(c+g),E=2/(i+s);return e[0]=y,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=E,e[6]=0,e[7]=0,e[8]=-((c-g)*y*.5),e[9]=(i-s)*E*.5,e[10]=n/(t-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*t/(t-n),e[15]=0,e}function Ga(e,r,t,n,i,s,c){var g=1/(r-t),y=1/(n-i),E=1/(s-c);return e[0]=-2*g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*E,e[11]=0,e[12]=(r+t)*g,e[13]=(i+n)*y,e[14]=(c+s)*E,e[15]=1,e}var Rs=Ga;function ki(e,r,t,n,i,s,c){var g=1/(r-t),y=1/(n-i),E=1/(s-c);return e[0]=-2*g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=E,e[11]=0,e[12]=(r+t)*g,e[13]=(i+n)*y,e[14]=s*E,e[15]=1,e}function ca(e,r,t,n){var i,s,c,g,y,E,T,I,F,U,Q=r[0],ue=r[1],de=r[2],Re=n[0],et=n[1],ht=n[2],xt=t[0],Gt=t[1],jt=t[2];return Math.abs(Q-xt)<ga&&Math.abs(ue-Gt)<ga&&Math.abs(de-jt)<ga?Er(e):(T=Q-xt,I=ue-Gt,F=de-jt,U=1/Math.hypot(T,I,F),T*=U,I*=U,F*=U,i=et*F-ht*I,s=ht*T-Re*F,c=Re*I-et*T,U=Math.hypot(i,s,c),U?(U=1/U,i*=U,s*=U,c*=U):(i=0,s=0,c=0),g=I*c-F*s,y=F*i-T*c,E=T*s-I*i,U=Math.hypot(g,y,E),U?(U=1/U,g*=U,y*=U,E*=U):(g=0,y=0,E=0),e[0]=i,e[1]=g,e[2]=T,e[3]=0,e[4]=s,e[5]=y,e[6]=I,e[7]=0,e[8]=c,e[9]=E,e[10]=F,e[11]=0,e[12]=-(i*Q+s*ue+c*de),e[13]=-(g*Q+y*ue+E*de),e[14]=-(T*Q+I*ue+F*de),e[15]=1,e)}function yo(e,r,t,n){var i=r[0],s=r[1],c=r[2],g=n[0],y=n[1],E=n[2],T=i-t[0],I=s-t[1],F=c-t[2],U=T*T+I*I+F*F;U>0&&(U=1/Math.sqrt(U),T*=U,I*=U,F*=U);var Q=y*F-E*I,ue=E*T-g*F,de=g*I-y*T;return U=Q*Q+ue*ue+de*de,U>0&&(U=1/Math.sqrt(U),Q*=U,ue*=U,de*=U),e[0]=Q,e[1]=ue,e[2]=de,e[3]=0,e[4]=I*de-F*ue,e[5]=F*Q-T*de,e[6]=T*ue-I*Q,e[7]=0,e[8]=T,e[9]=I,e[10]=F,e[11]=0,e[12]=i,e[13]=s,e[14]=c,e[15]=1,e}function wu(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function hu(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Ge(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e[6]=r[6]+t[6],e[7]=r[7]+t[7],e[8]=r[8]+t[8],e[9]=r[9]+t[9],e[10]=r[10]+t[10],e[11]=r[11]+t[11],e[12]=r[12]+t[12],e[13]=r[13]+t[13],e[14]=r[14]+t[14],e[15]=r[15]+t[15],e}function hr(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e[4]=r[4]-t[4],e[5]=r[5]-t[5],e[6]=r[6]-t[6],e[7]=r[7]-t[7],e[8]=r[8]-t[8],e[9]=r[9]-t[9],e[10]=r[10]-t[10],e[11]=r[11]-t[11],e[12]=r[12]-t[12],e[13]=r[13]-t[13],e[14]=r[14]-t[14],e[15]=r[15]-t[15],e}function Wt(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e[6]=r[6]*t,e[7]=r[7]*t,e[8]=r[8]*t,e[9]=r[9]*t,e[10]=r[10]*t,e[11]=r[11]*t,e[12]=r[12]*t,e[13]=r[13]*t,e[14]=r[14]*t,e[15]=r[15]*t,e}function Wn(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e[4]=r[4]+t[4]*n,e[5]=r[5]+t[5]*n,e[6]=r[6]+t[6]*n,e[7]=r[7]+t[7]*n,e[8]=r[8]+t[8]*n,e[9]=r[9]+t[9]*n,e[10]=r[10]+t[10]*n,e[11]=r[11]+t[11]*n,e[12]=r[12]+t[12]*n,e[13]=r[13]+t[13]*n,e[14]=r[14]+t[14]*n,e[15]=r[15]+t[15]*n,e}function va(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]&&e[8]===r[8]&&e[9]===r[9]&&e[10]===r[10]&&e[11]===r[11]&&e[12]===r[12]&&e[13]===r[13]&&e[14]===r[14]&&e[15]===r[15]}function De(e,r){var t=e[0],n=e[1],i=e[2],s=e[3],c=e[4],g=e[5],y=e[6],E=e[7],T=e[8],I=e[9],F=e[10],U=e[11],Q=e[12],ue=e[13],de=e[14],Re=e[15],et=r[0],ht=r[1],xt=r[2],Gt=r[3],jt=r[4],Qt=r[5],fr=r[6],Gr=r[7],Jr=r[8],Ur=r[9],Xn=r[10],ni=r[11],Oi=r[12],No=r[13],zs=r[14],ll=r[15];return Math.abs(t-et)<=ga*Math.max(1,Math.abs(t),Math.abs(et))&&Math.abs(n-ht)<=ga*Math.max(1,Math.abs(n),Math.abs(ht))&&Math.abs(i-xt)<=ga*Math.max(1,Math.abs(i),Math.abs(xt))&&Math.abs(s-Gt)<=ga*Math.max(1,Math.abs(s),Math.abs(Gt))&&Math.abs(c-jt)<=ga*Math.max(1,Math.abs(c),Math.abs(jt))&&Math.abs(g-Qt)<=ga*Math.max(1,Math.abs(g),Math.abs(Qt))&&Math.abs(y-fr)<=ga*Math.max(1,Math.abs(y),Math.abs(fr))&&Math.abs(E-Gr)<=ga*Math.max(1,Math.abs(E),Math.abs(Gr))&&Math.abs(T-Jr)<=ga*Math.max(1,Math.abs(T),Math.abs(Jr))&&Math.abs(I-Ur)<=ga*Math.max(1,Math.abs(I),Math.abs(Ur))&&Math.abs(F-Xn)<=ga*Math.max(1,Math.abs(F),Math.abs(Xn))&&Math.abs(U-ni)<=ga*Math.max(1,Math.abs(U),Math.abs(ni))&&Math.abs(Q-Oi)<=ga*Math.max(1,Math.abs(Q),Math.abs(Oi))&&Math.abs(ue-No)<=ga*Math.max(1,Math.abs(ue),Math.abs(No))&&Math.abs(de-zs)<=ga*Math.max(1,Math.abs(de),Math.abs(zs))&&Math.abs(Re-ll)<=ga*Math.max(1,Math.abs(Re),Math.abs(ll))}var Ee=mr,it=hr;function Bt(){var e=new Wo(2);return Wo!=Float32Array&&(e[0]=0,e[1]=0),e}function ur(e){var r=new Wo(2);return r[0]=e[0],r[1]=e[1],r}function st(e,r){var t=new Wo(2);return t[0]=e,t[1]=r,t}function ut(e,r){return e[0]=r[0],e[1]=r[1],e}function bt(e,r,t){return e[0]=r,e[1]=t,e}function Se(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e}function rt(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e}function Fe(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e}function kt(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e}function $t(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e}function Wr(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e}function bn(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e}function Cn(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e}function Un(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e}function yn(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e}function hi(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e}function Zn(e,r){var t=r[0]-e[0],n=r[1]-e[1];return Math.hypot(t,n)}function ri(e,r){var t=r[0]-e[0],n=r[1]-e[1];return t*t+n*n}function ii(e){var r=e[0],t=e[1];return Math.hypot(r,t)}function li(e){var r=e[0],t=e[1];return r*r+t*t}function Ri(e,r){return e[0]=-r[0],e[1]=-r[1],e}function eo(e,r){return e[0]=1/r[0],e[1]=1/r[1],e}function Ks(e,r){var t=r[0],n=r[1],i=t*t+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=r[0]*i,e[1]=r[1]*i,e}function kl(e,r){return e[0]*r[0]+e[1]*r[1]}function Jc(e,r,t){var n=r[0]*t[1]-r[1]*t[0];return e[0]=e[1]=0,e[2]=n,e}function So(e,r,t,n){var i=r[0],s=r[1];return e[0]=i+n*(t[0]-i),e[1]=s+n*(t[1]-s),e}function Ia(e,r){r=r||1;var t=Vf()*2*Math.PI;return e[0]=Math.cos(t)*r,e[1]=Math.sin(t)*r,e}function Oc(e,r,t){var n=r[0],i=r[1];return e[0]=t[0]*n+t[2]*i,e[1]=t[1]*n+t[3]*i,e}function ql(e,r,t){var n=r[0],i=r[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}function rd(e,r,t){var n=r[0],i=r[1];return e[0]=t[0]*n+t[3]*i+t[6],e[1]=t[1]*n+t[4]*i+t[7],e}function hc(e,r,t){var n=r[0],i=r[1];return e[0]=t[0]*n+t[4]*i+t[12],e[1]=t[1]*n+t[5]*i+t[13],e}function nd(e,r,t,n){var i=r[0]-t[0],s=r[1]-t[1],c=Math.sin(n),g=Math.cos(n);return e[0]=i*g-s*c+t[0],e[1]=i*c+s*g+t[1],e}function id(e,r){var t=e[0],n=e[1],i=r[0],s=r[1],c=Math.sqrt(t*t+n*n)*Math.sqrt(i*i+s*s),g=c&&(t*i+n*s)/c;return Math.acos(Math.min(Math.max(g,-1),1))}function Bh(e){return e[0]=0,e[1]=0,e}function hp(e){return"vec2("+e[0]+", "+e[1]+")"}function Qv(e,r){return e[0]===r[0]&&e[1]===r[1]}function $s(e,r){var t=e[0],n=e[1],i=r[0],s=r[1];return Math.abs(t-i)<=ga*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(n-s)<=ga*Math.max(1,Math.abs(n),Math.abs(s))}var ad=ii,ph=rt,Pd=Fe,Od=kt,vv=Zn,pp=ri,dh=li,od=function(){var e=Bt();return function(r,t,n,i,s,c){var g,y;for(t||(t=2),n||(n=0),i?y=Math.min(i*t+n,r.length):y=r.length,g=n;g<y;g+=t)e[0]=r[g],e[1]=r[g+1],s(e,e,c),r[g]=e[0],r[g+1]=e[1];return r}}();function mv(){var e=new Wo(3);return Wo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function zm(e){var r=new Wo(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function pu(e){var r=e[0],t=e[1],n=e[2];return Math.hypot(r,t,n)}function Nh(e,r,t){var n=new Wo(3);return n[0]=e,n[1]=r,n[2]=t,n}function Jv(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function a(e,r,t,n){return e[0]=r,e[1]=t,e[2]=n,e}function o(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e}function u(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e}function v(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e[2]=r[2]*t[2],e}function _(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e[2]=r[2]/t[2],e}function S(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e}function A(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e}function R(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e[2]=Math.min(r[2],t[2]),e}function z(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e[2]=Math.max(r[2],t[2]),e}function W(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e}function q(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e}function ne(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e}function ae(e,r){var t=r[0]-e[0],n=r[1]-e[1],i=r[2]-e[2];return Math.hypot(t,n,i)}function Te(e,r){var t=r[0]-e[0],n=r[1]-e[1],i=r[2]-e[2];return t*t+n*n+i*i}function je(e){var r=e[0],t=e[1],n=e[2];return r*r+t*t+n*n}function Be(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e}function Je(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e}function Qe(e,r){var t=r[0],n=r[1],i=r[2],s=t*t+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=r[0]*s,e[1]=r[1]*s,e[2]=r[2]*s,e}function Tt(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function Zt(e,r,t){var n=r[0],i=r[1],s=r[2],c=t[0],g=t[1],y=t[2];return e[0]=i*y-s*g,e[1]=s*c-n*y,e[2]=n*g-i*c,e}function ar(e,r,t,n){var i=r[0],s=r[1],c=r[2];return e[0]=i+n*(t[0]-i),e[1]=s+n*(t[1]-s),e[2]=c+n*(t[2]-c),e}function Lr(e,r,t,n,i,s){var c=s*s,g=c*(2*s-3)+1,y=c*(s-2)+s,E=c*(s-1),T=c*(3-2*s);return e[0]=r[0]*g+t[0]*y+n[0]*E+i[0]*T,e[1]=r[1]*g+t[1]*y+n[1]*E+i[1]*T,e[2]=r[2]*g+t[2]*y+n[2]*E+i[2]*T,e}function xr(e,r,t,n,i,s){var c=1-s,g=c*c,y=s*s,E=g*c,T=3*s*g,I=3*y*c,F=y*s;return e[0]=r[0]*E+t[0]*T+n[0]*I+i[0]*F,e[1]=r[1]*E+t[1]*T+n[1]*I+i[1]*F,e[2]=r[2]*E+t[2]*T+n[2]*I+i[2]*F,e}function dn(e,r){r=r||1;var t=Vf()*2*Math.PI,n=Vf()*2-1,i=Math.sqrt(1-n*n)*r;return e[0]=Math.cos(t)*i,e[1]=Math.sin(t)*i,e[2]=n*r,e}function _n(e,r,t){var n=r[0],i=r[1],s=r[2],c=t[3]*n+t[7]*i+t[11]*s+t[15];return c=c||1,e[0]=(t[0]*n+t[4]*i+t[8]*s+t[12])/c,e[1]=(t[1]*n+t[5]*i+t[9]*s+t[13])/c,e[2]=(t[2]*n+t[6]*i+t[10]*s+t[14])/c,e}function ci(e,r,t){var n=r[0],i=r[1],s=r[2];return e[0]=n*t[0]+i*t[3]+s*t[6],e[1]=n*t[1]+i*t[4]+s*t[7],e[2]=n*t[2]+i*t[5]+s*t[8],e}function _i(e,r,t){var n=t[0],i=t[1],s=t[2],c=t[3],g=r[0],y=r[1],E=r[2],T=i*E-s*y,I=s*g-n*E,F=n*y-i*g,U=i*F-s*I,Q=s*T-n*F,ue=n*I-i*T,de=c*2;return T*=de,I*=de,F*=de,U*=2,Q*=2,ue*=2,e[0]=g+T+U,e[1]=y+I+Q,e[2]=E+F+ue,e}function vi(e,r,t,n){var i=[],s=[];return i[0]=r[0]-t[0],i[1]=r[1]-t[1],i[2]=r[2]-t[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=s[0]+t[0],e[1]=s[1]+t[1],e[2]=s[2]+t[2],e}function ti(e,r,t,n){var i=[],s=[];return i[0]=r[0]-t[0],i[1]=r[1]-t[1],i[2]=r[2]-t[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=s[0]+t[0],e[1]=s[1]+t[1],e[2]=s[2]+t[2],e}function Zi(e,r,t,n){var i=[],s=[];return i[0]=r[0]-t[0],i[1]=r[1]-t[1],i[2]=r[2]-t[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],e[0]=s[0]+t[0],e[1]=s[1]+t[1],e[2]=s[2]+t[2],e}function Pi(e,r){var t=e[0],n=e[1],i=e[2],s=r[0],c=r[1],g=r[2],y=Math.sqrt(t*t+n*n+i*i),E=Math.sqrt(s*s+c*c+g*g),T=y*E,I=T&&Tt(e,r)/T;return Math.acos(Math.min(Math.max(I,-1),1))}function xi(e){return e[0]=0,e[1]=0,e[2]=0,e}function Pa(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function aa(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]}function to(e,r){var t=e[0],n=e[1],i=e[2],s=r[0],c=r[1],g=r[2];return Math.abs(t-s)<=ga*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(n-c)<=ga*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-g)<=ga*Math.max(1,Math.abs(i),Math.abs(g))}var Fi=u,Ra=v,Do=_,Fo=ae,is=Te,as=pu,Yo=je,qs=function(){var e=mv();return function(r,t,n,i,s,c){var g,y;for(t||(t=3),n||(n=0),i?y=Math.min(i*t+n,r.length):y=r.length,g=n;g<y;g+=t)e[0]=r[g],e[1]=r[g+1],e[2]=r[g+2],s(e,e,c),r[g]=e[0],r[g+1]=e[1],r[g+2]=e[2];return r}}();function Ls(){var e=new Wo(4);return Wo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function ol(e){var r=new Wo(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function Qs(e,r,t,n){var i=new Wo(4);return i[0]=e,i[1]=r,i[2]=t,i[3]=n,i}function $u(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function du(e,r,t,n,i){return e[0]=r,e[1]=t,e[2]=n,e[3]=i,e}function Js(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e}function eu(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e}function za(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e[2]=r[2]*t[2],e[3]=r[3]*t[3],e}function La(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e[2]=r[2]/t[2],e[3]=r[3]/t[3],e}function To(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e[3]=Math.ceil(r[3]),e}function Bo(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e[3]=Math.floor(r[3]),e}function sl(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e[2]=Math.min(r[2],t[2]),e[3]=Math.min(r[3],t[3]),e}function Vo(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e[2]=Math.max(r[2],t[2]),e[3]=Math.max(r[3],t[3]),e}function os(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e[3]=Math.round(r[3]),e}function Bu(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e}function Ua(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e}function Nu(e,r){var t=r[0]-e[0],n=r[1]-e[1],i=r[2]-e[2],s=r[3]-e[3];return Math.hypot(t,n,i,s)}function pc(e,r){var t=r[0]-e[0],n=r[1]-e[1],i=r[2]-e[2],s=r[3]-e[3];return t*t+n*n+i*i+s*s}function ef(e){var r=e[0],t=e[1],n=e[2],i=e[3];return Math.hypot(r,t,n,i)}function Au(e){var r=e[0],t=e[1],n=e[2],i=e[3];return r*r+t*t+n*n+i*i}function Xi(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=-r[3],e}function vh(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e[3]=1/r[3],e}function vu(e,r){var t=r[0],n=r[1],i=r[2],s=r[3],c=t*t+n*n+i*i+s*s;return c>0&&(c=1/Math.sqrt(c)),e[0]=t*c,e[1]=n*c,e[2]=i*c,e[3]=s*c,e}function Ko(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]}function sd(e,r,t,n){var i=t[0]*n[1]-t[1]*n[0],s=t[0]*n[2]-t[2]*n[0],c=t[0]*n[3]-t[3]*n[0],g=t[1]*n[2]-t[2]*n[1],y=t[1]*n[3]-t[3]*n[1],E=t[2]*n[3]-t[3]*n[2],T=r[0],I=r[1],F=r[2],U=r[3];return e[0]=I*E-F*y+U*g,e[1]=-(T*E)+F*c-U*s,e[2]=T*y-I*c+U*i,e[3]=-(T*g)+I*s-F*i,e}function gl(e,r,t,n){var i=r[0],s=r[1],c=r[2],g=r[3];return e[0]=i+n*(t[0]-i),e[1]=s+n*(t[1]-s),e[2]=c+n*(t[2]-c),e[3]=g+n*(t[3]-g),e}function ud(e,r){r=r||1;var t,n,i,s,c,g;do t=Vf()*2-1,n=Vf()*2-1,c=t*t+n*n;while(c>=1);do i=Vf()*2-1,s=Vf()*2-1,g=i*i+s*s;while(g>=1);var y=Math.sqrt((1-c)/g);return e[0]=r*t,e[1]=r*n,e[2]=r*i*y,e[3]=r*s*y,e}function Lp(e,r,t){var n=r[0],i=r[1],s=r[2],c=r[3];return e[0]=t[0]*n+t[4]*i+t[8]*s+t[12]*c,e[1]=t[1]*n+t[5]*i+t[9]*s+t[13]*c,e[2]=t[2]*n+t[6]*i+t[10]*s+t[14]*c,e[3]=t[3]*n+t[7]*i+t[11]*s+t[15]*c,e}function kp(e,r,t){var n=r[0],i=r[1],s=r[2],c=t[0],g=t[1],y=t[2],E=t[3],T=E*n+g*s-y*i,I=E*i+y*n-c*s,F=E*s+c*i-g*n,U=-c*n-g*i-y*s;return e[0]=T*E+U*-c+I*-y-F*-g,e[1]=I*E+U*-g+F*-c-T*-y,e[2]=F*E+U*-y+T*-g-I*-c,e[3]=r[3],e}function Id(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function ld(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Dp(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]}function zh(e,r){var t=e[0],n=e[1],i=e[2],s=e[3],c=r[0],g=r[1],y=r[2],E=r[3];return Math.abs(t-c)<=ga*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(n-g)<=ga*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(i-y)<=ga*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(s-E)<=ga*Math.max(1,Math.abs(s),Math.abs(E))}var dc=eu,cd=za,mh=La,Go=Nu,Cs=pc,fd=ef,Rd=Au,Fp=function(){var e=Ls();return function(r,t,n,i,s,c){var g,y;for(t||(t=4),n||(n=0),i?y=Math.min(i*t+n,r.length):y=r.length,g=n;g<y;g+=t)e[0]=r[g],e[1]=r[g+1],e[2]=r[g+2],e[3]=r[g+3],s(e,e,c),r[g]=e[0],r[g+1]=e[1],r[g+2]=e[2],r[g+3]=e[3];return r}}(),hd,pd,Bp=(hd=Object(Cr.injectable)(),hd(pd=function(){function e(){Ft()(this,e),w()(this,"viewport",void 0),w()(this,"overridedViewProjectionMatrix",void 0),w()(this,"jitteredViewProjectionMatrix",void 0),w()(this,"jitteredProjectionMatrix",void 0),w()(this,"viewMatrixInverse",void 0),w()(this,"cameraPosition",void 0)}return Yt()(e,[{key:"init",value:function(){}},{key:"update",value:function(t){this.viewport=t,this.viewMatrixInverse=k.create(),k.invert(this.viewMatrixInverse,t.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var t=this.viewport.getCenter(),n=Ei()(t,2),i=n[0],s=n[1];return[i,s]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(t,n){return this.viewport.projectFlat(t,n)}},{key:"setViewProjectionMatrix",value:function(t){this.overridedViewProjectionMatrix=t}},{key:"jitterProjectionMatrix",value:function(t,n){var i=k.fromTranslation(k.create(),[t,n,0]);this.jitteredProjectionMatrix=k.multiply(k.create(),i,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=k.multiply(k.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),e}())||pd),dd,dp;function gh(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=vp(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function vp(e,r){if(!!e){if(typeof e=="string")return mp(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return mp(e,r)}}function mp(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Np=(dd=Object(Cr.injectable)(),dd(dp=function(){function e(){Ft()(this,e),w()(this,"container",void 0),w()(this,"controlCorners",void 0),w()(this,"controlContainer",void 0),w()(this,"scene",void 0),w()(this,"mapsService",void 0),w()(this,"controls",[]),w()(this,"unAddControls",[])}return Yt()(e,[{key:"init",value:function(t,n){this.container=t.container,this.scene=n,this.mapsService=n.get(sr.IMapService),this.initControlPos()}},{key:"addControl",value:function(t,n){var i=n.get(sr.IMapService);i.map?(t.addTo(this.scene),this.controls.push(t)):this.unAddControls.push(t)}},{key:"getControlByName",value:function(t){return this.controls.find(function(n){return n.controlOption.name===t})}},{key:"removeControl",value:function(t){var n=this.controls.indexOf(t);return n>-1&&this.controls.splice(n,1),t.remove(),this}},{key:"addControls",value:function(){var t=this;this.unAddControls.forEach(function(n){n.addTo(t.scene),t.controls.push(n)}),this.unAddControls=[]}},{key:"destroy",value:function(){var t=gh(this.controls),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;i.remove()}}catch(s){t.e(s)}finally{t.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var t=this.controlCorners={},n="l7-",i=this.controlContainer=j.create("div",n+"control-container",this.container);function s(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],g=c.map(function(y){return n+y}).join(" ");t[c.join("")]=j.create("div",g,i)}s(["top","left"]),s(["top","right"]),s(["bottom","left"]),s(["bottom","right"]),s(["top","center"]),s(["right","center"]),s(["left","center"]),s(["bottom","center"])}},{key:"clearControlPos",value:function(){for(var t in this.controlCorners)this.controlCorners[t]&&j.remove(this.controlCorners[t]);this.controlContainer&&j.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),e}())||dp),Gf,qu,Hf=(Gf=Object(Cr.injectable)(),Gf(qu=function(){function e(){Ft()(this,e),w()(this,"container",void 0),w()(this,"scene",void 0),w()(this,"mapsService",void 0),w()(this,"markers",[]),w()(this,"markerLayers",[]),w()(this,"unAddMarkers",[]),w()(this,"unAddMarkerLayers",[])}return Yt()(e,[{key:"addMarkerLayer",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(t),t.addTo(this.scene)):this.unAddMarkerLayers.push(t)}},{key:"removeMarkerLayer",value:function(t){t.destroy(),this.markerLayers.indexOf(t);var n=this.markerLayers.indexOf(t);n>-1&&this.markerLayers.splice(n,1)}},{key:"addMarker",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(t),t.addTo(this.scene)):this.unAddMarkers.push(t)}},{key:"addMarkers",value:function(){var t=this;this.unAddMarkers.forEach(function(n){n.addTo(t.scene),t.markers.push(n)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var t=this;this.unAddMarkerLayers.forEach(function(n){t.markerLayers.push(n),n.addTo(t.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(t){t.remove(),this.markers.indexOf(t);var n=this.markers.indexOf(t);n>-1&&this.markers.splice(n,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(sr.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(t){t.remove()}),this.markers=[],this.markerLayers.forEach(function(t){t.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(t){t.destroy()}}]),e}())||qu),Ld,kd,em=(Ld=Object(Cr.injectable)(),Ld(kd=function(){function e(){Ft()(this,e),w()(this,"scene",void 0),w()(this,"popup",void 0),w()(this,"mapsService",void 0),w()(this,"unAddPopup",void 0)}return Yt()(e,[{key:"removePopup",value:function(t){t.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(t){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(t.addTo(this.scene),this.popup=t):this.unAddPopup=t}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(sr.IMapService)}}]),e}())||kd),gv=M("QkVN"),gs=M.n(gv),Dd={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Uh=Dd,ja,gp;function ao(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function vc(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ao(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ao(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Um={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},oo={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},yv=(ja=Object(Cr.injectable)(),ja(gp=function(){function e(){Ft()(this,e),w()(this,"sceneConfigCache",{}),w()(this,"layerConfigCache",{})}return Yt()(e,[{key:"getSceneConfig",value:function(t){return this.sceneConfigCache[t]}},{key:"getSceneWarninfo",value:function(t){return Uh[t]}},{key:"setSceneConfig",value:function(t,n){this.sceneConfigCache[t]=vc(vc({},Um),n)}},{key:"getLayerConfig",value:function(t){return this.layerConfigCache[t]}},{key:"setLayerConfig",value:function(t,n,i){this.layerConfigCache[n]=vc({},gs()({},this.sceneConfigCache[t],oo,i))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),e}())||gp),_v=M("yG8O"),Di=M.n(_v),Wf=M("U+yc"),Vi=M.n(Wf),Fd=M("1ABj"),zp=Math.PI/180,Bd=512,Nd=4003e4;function xv(e){var r=e.latitude,t=r===void 0?0:r,n=e.zoom,i=n===void 0?0:n,s=e.scale,c=e.highPrecision,g=c===void 0?!1:c,y=e.flipY,E=y===void 0?!1:y;s=s!==void 0?s:Math.pow(2,i);var T={},I=Bd*s,F=Math.cos(t*zp),U=I/360,Q=U/F,ue=I/Nd/F;if(T.pixelsPerMeter=[ue,-ue,ue],T.metersPerPixel=[1/ue,-1/ue,1/ue],T.pixelsPerDegree=[U,-Q,ue],T.degreesPerPixel=[1/U,-1/Q,1/ue],g){var de=zp*Math.tan(t*zp)/F,Re=U*de/2,et=I/Nd*de,ht=et/Q*ue;T.pixelsPerDegree2=[0,-Re,et],T.pixelsPerMeter2=[ht,0,ht],E&&(T.pixelsPerDegree2[1]=-T.pixelsPerDegree2[1],T.pixelsPerMeter2[1]=-T.pixelsPerMeter2[1])}return E&&(T.pixelsPerMeter[1]=-T.pixelsPerMeter[1],T.metersPerPixel[1]=-T.metersPerPixel[1],T.pixelsPerDegree[1]=-T.pixelsPerDegree[1],T.degreesPerPixel[1]=-T.degreesPerPixel[1]),T}var zu;(function(e){e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.P20=5]="P20",e[e.P20_OFFSET=6]="P20_OFFSET",e[e.METER_OFFSET=7]="METER_OFFSET",e[e.P20_2=8]="P20_2"})(zu||(zu={}));var jh={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},bv,Ev,Sv,zd,yl,Ud=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],jd=(bv=Object(Cr.injectable)(),Ev=Object(Cr.inject)(sr.ICameraService),bv(Sv=(zd=function(){function e(){Ft()(this,e),w()(this,"needRefresh",!0),Di()(this,"cameraService",yl,this),w()(this,"coordinateSystem",void 0),w()(this,"viewportCenter",void 0),w()(this,"viewportCenterProjection",void 0),w()(this,"pixelsPerDegree",void 0),w()(this,"pixelsPerDegree2",void 0),w()(this,"pixelsPerMeter",void 0)}return Yt()(e,[{key:"refresh",value:function(){var t=this.cameraService.getZoom(),n=this.cameraService.getZoomScale(),i=this.cameraService.getCenter(),s=xv({latitude:i[1],zoom:t}),c=s.pixelsPerMeter,g=s.pixelsPerDegree;this.viewportCenter=i,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=c,this.pixelsPerDegree=g,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===zu.LNGLAT||this.coordinateSystem===zu.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===zu.LNGLAT_OFFSET?this.calculateLnglatOffset(i,t):this.coordinateSystem===zu.P20_OFFSET&&this.calculateLnglatOffset(i,t,n,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(t){this.coordinateSystem=t}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(t,n,i,s){var c=xv({latitude:t[1],zoom:n,scale:i,flipY:s,highPrecision:!0}),g=c.pixelsPerMeter,y=c.pixelsPerDegree,E=c.pixelsPerDegree2,T=this.cameraService.getViewMatrix(),I=this.cameraService.getProjectionMatrix(),F=k.multiply([],I,T),U=this.cameraService.projectFlat([Math.fround(t[0]),Math.fround(t[1])],Math.pow(2,n));this.viewportCenterProjection=H.transformMat4([],[U[0],U[1],0,1],F),T=this.cameraService.getViewMatrixUncentered()||T,F=k.multiply([],I,T),F=k.multiply([],F,Ud),this.cameraService.setViewProjectionMatrix(F),this.pixelsPerMeter=g,this.pixelsPerDegree=y,this.pixelsPerDegree2=E}}]),e}(),yl=Vi()(zd.prototype,"cameraService",[Ev],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zd))||Sv),Zf=M("AfwI"),vd=M.n(Zf),ul;(function(e){e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag"})(ul||(ul={}));var ks,Uu,yp,Vh,_p;function Cv(e){var r=tm();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function tm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var rm={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},nm=(ks=Object(Cr.injectable)(),Uu=Object(Cr.inject)(sr.IMapService),ks(yp=(Vh=function(e){qr()(t,e);var r=Cv(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),Di()(ce()(n),"mapService",_p,ce()(n)),w()(ce()(n),"hammertime",void 0),w()(ce()(n),"lastClickTime",0),w()(ce()(n),"lastClickXY",[-1,-1]),w()(ce()(n),"clickTimer",void 0),w()(ce()(n),"$containter",void 0),w()(ce()(n),"onDrag",function(g){var y=n.interactionEvent(g);y.type=rm[y.type],n.emit(ul.Drag,y)}),w()(ce()(n),"onHammer",function(g){g.srcEvent.stopPropagation();var y=n.interactionEvent(g);n.emit(ul.Hover,y)}),w()(ce()(n),"onTouch",function(g){var y=g.touches[0];n.onHover({x:y.pageX,y:y.pageY,type:"touch"})}),w()(ce()(n),"onHover",function(g){var y=g.clientX,E=g.clientY,T=y,I=E,F=g.type,U=n.mapService.getMapContainer();if(U)if($i)T=T-U.left-0,I=I-U.top-0;else{var Q=U.getBoundingClientRect(),ue=Q.top,de=Q.left;T=T-de-U.clientLeft,I=I-ue-U.clientTop}var Re=n.mapService.containerToLngLat([T,I]);if(F==="click"){if(!$i&&"ontouchstart"in document.documentElement)return;n.isDoubleTap(T,I,Re);return}if(F==="touch"){n.isDoubleTap(T,I,Re);return}F!=="click"&&F!=="dblclick"&&n.emit(ul.Hover,{x:T,y:I,lngLat:Re,type:F,target:g})}),n}return Yt()(t,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(ul.Hover)}},{key:"triggerHover",value:function(i){var s=i.x,c=i.y;this.emit(ul.Hover,{x:s,y:c})}},{key:"triggerSelect",value:function(i){this.emit(ul.Select,{featureId:i})}},{key:"triggerActive",value:function(i){this.emit(ul.Active,{featureId:i})}},{key:"handleMiniEvent",value:function(i){this.onHover({clientX:i.touches[0].pageX,clientY:i.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var i=this.mapService.getMapContainer();if(i)if($i)di.document.addEventListener("touchstart",this.handleMiniEvent.bind(this));else{var s=new vd.a.Manager(i);s.add(new vd.a.Tap({event:"dblclick",taps:2})),s.add(new vd.a.Tap({event:"click"})),s.add(new vd.a.Pan({threshold:0,pointers:0})),s.add(new vd.a.Press({})),s.on("dblclick click",this.onHammer),s.on("panstart panmove panend pancancel",this.onDrag),i.addEventListener("mousemove",this.onHover),i.addEventListener("mousedown",this.onHover,!0),i.addEventListener("mouseup",this.onHover),i.addEventListener("contextmenu",this.onHover),this.hammertime=s}}},{key:"removeEventListenerOnMap",value:function(){if($i)di.document.removeEventListener("touchstart",this.handleMiniEvent.bind(this));else{var i=this.mapService.getMapContainer();i&&(i.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),i.removeEventListener("mousedown",this.onHover),i.removeEventListener("mouseup",this.onHover),i.removeEventListener("contextmenu",this.onHover))}}},{key:"interactionEvent",value:function(i){var s=i.type,c=i.pointerType,g,y;c==="touch"?(y=Math.floor(i.pointers[0].clientY),g=Math.floor(i.pointers[0].clientX)):(y=Math.floor(i.srcEvent.y),g=Math.floor(i.srcEvent.x));var E=this.mapService.getMapContainer();if(E){var T=E.getBoundingClientRect(),I=T.top,F=T.left;g-=F,y-=I}var U=this.mapService.containerToLngLat([g,y]);return{x:g,y,lngLat:U,type:s,target:i.srcEvent}}},{key:"isDoubleTap",value:function(i,s,c){var g=this,y=new Date().getTime(),E="click";y-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-i)<10&&Math.abs(this.lastClickXY[1]-s)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),E="dblclick",this.emit(ul.Hover,{x:i,y:s,lngLat:c,type:E})):(this.lastClickTime=y,this.lastClickXY=[i,s],this.clickTimer=setTimeout(function(){E="click",g.emit(ul.Hover,{x:i,y:s,lngLat:c,type:E})},400))}}]),t}(oc.a),_p=Vi()(Vh.prototype,"mapService",[Uu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vh))||yp),Vd=M("yXPU"),tu=M.n(Vd),yh=M("o0o1"),Na=M.n(yh),Gd=0;function Hd(e){if($i)return null;var r=e;if(typeof e=="string"&&(r=document.getElementById(e)),r){var t=document.createElement("div");return t.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,t.id="l7-scene-".concat(Gd++),t.classList.add("l7-scene"),r.appendChild(t),t}return null}function im(e){var r,t,n=!0;return e==null||(r=e.target)===null||r===void 0||(t=r.path)===null||t===void 0||t.map(function(i){if(i!=null&&i.classList){var s;i==null||(s=i.classList)===null||s===void 0||s.forEach(function(c){(c==="l7-marker"||c==="l7-popup")&&(n=!1)})}}),n}var ve;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(ve||(ve={}));var wv,Av,_h,Tv,Up,Mv,xh,am,Wd,Pv,om;function sm(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Zd(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?sm(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):sm(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var jm=(wv=Object(Cr.injectable)(),Av=Object(Cr.inject)(sr.IRendererService),_h=Object(Cr.inject)(sr.IGlobalConfigService),Tv=Object(Cr.inject)(sr.IInteractionService),Up=Object(Cr.inject)(sr.ILayerService),wv(Mv=(xh=function(){function e(){var r=this;Ft()(this,e),Di()(this,"rendererService",am,this),Di()(this,"configService",Wd,this),Di()(this,"interactionService",Pv,this),Di()(this,"layerService",om,this),w()(this,"pickingFBO",void 0),w()(this,"width",0),w()(this,"height",0),w()(this,"alreadyInPicking",!1),w()(this,"pickBufferScale",1),w()(this,"lastPickTime",new Date().getTime()),w()(this,"pickFromPickingFBO",function(t,n){var i,s=n.x,c=n.y,g=n.lngLat,y=n.type,E=n.target,T=!1,I=r.rendererService,F=I.getViewportSize,U=I.readPixels,Q=I.getContainer,ue=r.getContainerSize(Q()),de=ue.width,Re=ue.height;de*=j.DPR,Re*=j.DPR;var et=t.getLayerConfig(),ht=et.enableHighlight,xt=et.enableSelect,Gt=s*j.DPR,jt=c*j.DPR;if(Gt>de-1*j.DPR||Gt<0||jt>Re-1*j.DPR||jt<0)return!1;var Qt;if(Qt=U({x:Math.floor(Gt/r.pickBufferScale),y:Math.floor((Re-(c+1)*j.DPR)/r.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:r.pickingFBO}),Qt[0]!==0||Qt[1]!==0||Qt[2]!==0){var fr=nn(Qt),Gr=t.getSource().getFeatureById(fr);fr!==t.getCurrentPickId()&&y==="mousemove"&&(y="mouseenter");var Jr={x:s,y:c,type:y,lngLat:g,featureId:fr,feature:Gr,target:E};Gr&&(T=!0,t.setCurrentPickId(fr),r.triggerHoverOnLayer(t,Jr))}else{var Ur={x:s,y:c,lngLat:g,type:t.getCurrentPickId()!==null&&y==="mousemove"?"mouseout":"un"+y,featureId:null,target:E,feature:null};r.triggerHoverOnLayer(t,Zd(Zd({},Ur),{},{type:"unpick"})),r.triggerHoverOnLayer(t,Ur),t.setCurrentPickId(null)}if(ht&&r.highlightPickedFeature(t,Qt),xt&&y==="click"&&((i=Qt)===null||i===void 0?void 0:i.toString())!==[0,0,0,0].toString()){var Xn=nn(Qt);t.getCurrentSelectedId()===null||Xn!==t.getCurrentSelectedId()?(r.selectFeature(t,Qt),t.setCurrentSelectedId(Xn)):(r.selectFeature(t,new Uint8Array([0,0,0,0])),t.setCurrentSelectedId(null))}return T})}return Yt()(e,[{key:"init",value:function(t){var n=this.rendererService,i=n.createTexture2D,s=n.createFramebuffer,c=n.getViewportSize,g=n.getContainer,y=this.getContainerSize(g()),E=y.width,T=y.height;E*=j.DPR,T*=j.DPR,this.pickBufferScale=this.configService.getSceneConfig(t).pickBufferScale||1,this.pickingFBO=s({color:i({width:Math.round(E/this.pickBufferScale),height:Math.round(T/this.pickBufferScale),wrapS:ve.CLAMP_TO_EDGE,wrapT:ve.CLAMP_TO_EDGE})}),this.interactionService.on(ul.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var r=tu()(Na.a.mark(function n(i,s,c){var g=this,y,E,T,I;return Na.a.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:y=this.rendererService,E=y.useFramebuffer,T=y.clear,I=y.getContainer,this.resizePickingFBO(),E(this.pickingFBO,function(){T({framebuffer:g.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),i.hooks.beforePickingEncode.call(),i.renderModels(),i.hooks.afterPickingEncode.call();var Q=g.pickBox(i,s);c(Q)});case 3:case"end":return U.stop()}},n,this)}));function t(n,i,s){return r.apply(this,arguments)}return t}()},{key:"pickBox",value:function(t,n){var i=this,s=n.map(function(Ur){var Xn=Ur<0?0:Ur;return Math.floor(Xn*j.DPR/i.pickBufferScale)}),c=Ei()(s,4),g=c[0],y=c[1],E=c[2],T=c[3],I=this.rendererService,F=I.getViewportSize,U=I.readPixels,Q=I.getContainer,ue=this.getContainerSize(Q()),de=ue.width,Re=ue.height;if(de*=j.DPR,Re*=j.DPR,g>(de-1)*j.DPR/this.pickBufferScale||E<0||y>(Re-1)*j.DPR/this.pickBufferScale||T<0)return[];var et,ht=Math.min(de/this.pickBufferScale,E)-g,xt=Math.min(Re/this.pickBufferScale,T)-y;et=U({x:g,y:Math.floor(Re/this.pickBufferScale-(T+1)),width:ht,height:xt,data:new Uint8Array(ht*xt*4),framebuffer:this.pickingFBO});for(var Gt=[],jt={},Qt=0;Qt<et.length/4;Qt=Qt+1){var fr=et.slice(Qt*4,Qt*4+4),Gr=nn(fr);if(Gr!==-1&&!jt[Gr]){var Jr=t.getSource().getFeatureById(Gr);Gt.push(Zd(Zd({},Jr),{},{pickedFeatureIdx:Gr})),jt[Gr]=!0}}return Gt}},{key:"getContainerSize",value:function(t){return t.getContext?{width:t.width/j.DPR,height:t.height/j.DPR}:t.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var r=tu()(Na.a.mark(function n(i){var s;return Na.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.layerService.isMapDragging()||!this.layerService.getShaderPickStat())){g.next=2;break}return g.abrupt("return");case 2:if(this.alreadyInPicking=!0,s=new Date().getTime(),!(s-this.lastPickTime>10||i.type==="contextmenu"||i.type==="click")){g.next=7;break}return g.next=7,this.pickingLayers(i);case 7:this.lastPickTime=s,this.layerService.renderLayers(),this.alreadyInPicking=!1;case 10:case"end":return g.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"resizePickingFBO",value:function(){var t=this.rendererService.getContainer,n=this.getContainerSize(t()),i=n.width,s=n.height;i*=j.DPR,s*=j.DPR,(this.width!==i||this.height!==s)&&(this.pickingFBO.resize({width:Math.round(i/this.pickBufferScale),height:Math.round(s/this.pickBufferScale)}),this.width=i,this.height=s)}},{key:"pickingLayers",value:function(){var r=tu()(Na.a.mark(function n(i){var s=this,c,g,y,E,T;return Na.a.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:c=this.rendererService,g=c.getViewportSize,y=c.useFramebuffer,E=c.clear,T=c.getContainer,this.resizePickingFBO(),y(this.pickingFBO,function(){var U=s.layerService.getRenderList();U.filter(function(Q){return Q.needPick(i.type)}).reverse().some(function(Q){E({framebuffer:s.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Q.hooks.beforePickingEncode.call(),Q.renderModels(!0),Q.hooks.afterPickingEncode.call();var ue=s.pickFromPickingFBO(Q,i);return ue&&!Q.getLayerConfig().enablePropagation})});case 3:case"end":return F.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"triggerHoverOnLayer",value:function(t,n){im(n)&&t.emit(n.type,n)}},{key:"highlightPickedFeature",value:function(t,n){var i=Ei()(n,3),s=i[0],c=i[1],g=i[2];t.hooks.beforeHighlight.call([s,c,g])}},{key:"selectFeature",value:function(t,n){var i=Ei()(n,3),s=i[0],c=i[1],g=i[2];t.hooks.beforeSelect.call([s,c,g])}}]),e}(),am=Vi()(xh.prototype,"rendererService",[Av],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wd=Vi()(xh.prototype,"configService",[_h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pv=Vi()(xh.prototype,"interactionService",[Tv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),om=Vi()(xh.prototype,"layerService",[Up],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xh))||Mv),Vm=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;Ft()(this,e),w()(this,"autoStart",void 0),w()(this,"startTime",0),w()(this,"oldTime",0),w()(this,"running",!1),w()(this,"elapsedTime",0),this.autoStart=r}return Yt()(e,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=(typeof performance=="undefined"?Date:performance).now();t=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=t}return t}}]),e}(),um,lm,bf,md,Ov,jp,Xd,Iv,b0;function gy(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=yy(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function yy(e,r){if(!!e){if(typeof e=="string")return E0(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return E0(e,r)}}function E0(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var _y=(um=Object(Cr.injectable)(),lm=Object(Cr.inject)(sr.IRendererService),bf=Object(Cr.inject)(sr.IMapService),md=Object(Cr.inject)(sr.IGlobalConfigService),um(Ov=(jp=function(){function e(){Ft()(this,e),w()(this,"clock",new Vm),w()(this,"alreadyInRendering",!1),w()(this,"layers",[]),w()(this,"layerList",[]),w()(this,"layerRenderID",void 0),w()(this,"sceneInited",!1),w()(this,"animateInstanceCount",0),w()(this,"shaderPicking",!0),w()(this,"enableRender",!0),Di()(this,"renderService",Xd,this),Di()(this,"mapService",Iv,this),Di()(this,"configService",b0,this)}return Yt()(e,[{key:"add",value:function(t){this.sceneInited&&t.init(),this.layers.push(t),this.updateLayerRenderList()}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(t){t.inited||t.init()}),this.updateLayerRenderList()}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(t){return this.layers.find(function(n){return n.id===t})}},{key:"getLayerByName",value:function(t){return this.layers.find(function(n){return n.name===t})}},{key:"cleanRemove",value:function(t,n){if(n){var i=n.layerChildren.indexOf(t);i>-1&&n.layerChildren.splice(i,1)}else{var s=this.layers.indexOf(t);s>-1&&this.layers.splice(s,1)}this.updateLayerRenderList(),this.renderLayers()}},{key:"remove",value:function(t,n){if(n){var i=n.layerChildren.indexOf(t);i>-1&&n.layerChildren.splice(i,1)}else{var s=this.layers.indexOf(t);s>-1&&this.layers.splice(s,1)}this.updateLayerRenderList(),t.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"setEnableRender",value:function(t){this.enableRender=t}},{key:"renderLayers",value:function(){var r=tu()(Na.a.mark(function n(){var i,s,c;return Na.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){y.next=2;break}return y.abrupt("return");case 2:this.alreadyInRendering=!0,this.clear(),i=gy(this.layerList),y.prev=5,i.s();case 7:if((s=i.n()).done){y.next=20;break}if(c=s.value,c.hooks.beforeRenderData.call(),c.hooks.beforeRender.call(),!c.getLayerConfig().enableMultiPassRenderer){y.next=16;break}return y.next=14,c.renderMultiPass();case 14:y.next=17;break;case 16:c.render();case 17:c.hooks.afterRender.call();case 18:y.next=7;break;case 20:y.next=25;break;case 22:y.prev=22,y.t0=y.catch(5),i.e(y.t0);case 25:return y.prev=25,i.f(),y.finish(25);case 28:this.alreadyInRendering=!1;case 29:case"end":return y.stop()}},n,this,[[5,22,25,28]])}));function t(){return r.apply(this,arguments)}return t}()},{key:"updateLayerRenderList",value:function(){var t=this;this.layerList=[],this.layers.filter(function(n){return n.inited}).filter(function(n){return n.isVisible()}).forEach(function(n){t.layerList.push(n),n.layerChildren.filter(function(i){return i.inited}).filter(function(i){return i.isVisible()}).forEach(function(i){t.layerList.push(i)})}),this.layerList.sort(function(n,i){return n.zIndex-i.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(t){t.layerChildren&&(t.layerChildren.forEach(function(n){return n.destroy()}),t.layerChildren=[]),t.destroy()}),this.layers=[],this.layerList=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++==0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount==0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"isMapDragging",value:function(){return this.mapService.dragging}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=di.requestAnimationFrame(this.runRender.bind(this))}},{key:"clear",value:function(){var t=Dr(this.mapService.bgColor);this.renderService.clear({color:t,depth:1,stencil:0,framebuffer:null})}},{key:"stopRender",value:function(){di.cancelAnimationFrame(this.layerRenderID)}}]),e}(),Xd=Vi()(jp.prototype,"renderService",[lm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iv=Vi()(jp.prototype,"mapService",[bf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b0=Vi()(jp.prototype,"configService",[md],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jp))||Ov),xy=M("QILm"),xp=M.n(xy),by=M("J2iB"),bp=M.n(by),Ey=function(){function e(r){var t=this;Ft()(this,e),w()(this,"name",void 0),w()(this,"type",void 0),w()(this,"scale",void 0),w()(this,"descriptor",void 0),w()(this,"featureBufferLayout",[]),w()(this,"needRescale",!1),w()(this,"needRemapping",!1),w()(this,"needRegenerateVertices",!1),w()(this,"featureRange",{startIndex:0,endIndex:Infinity}),w()(this,"vertexAttribute",void 0),w()(this,"defaultCallback",function(n){if(n.length===0){var i;return((i=t.scale)===null||i===void 0?void 0:i.defaultValues)||[]}return n.map(function(s,c){var g,y=(g=t.scale)===null||g===void 0?void 0:g.scalers[c].func,E=y(s);return E})}),this.setProps(r)}return Yt()(e,[{key:"setProps",value:function(t){Object.assign(this,t)}},{key:"mapping",value:function(t){var n;if((n=this.scale)!==null&&n!==void 0&&n.callback){var i,s=(i=this.scale)===null||i===void 0?void 0:i.callback.apply(i,Ut()(t));if(!bp()(s))return[s]}return this.defaultCallback(t)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),e}(),Sy=["buffer","update","name"],Rv,cm,Gm,Hm,Wm,S0;function C0(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Lv(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?C0(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C0(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Z_(e){return new Promise(function(r){return setTimeout(r,e)})}var Cy=(Rv={},w()(Rv,ve.FLOAT,4),w()(Rv,ve.UNSIGNED_BYTE,1),w()(Rv,ve.UNSIGNED_SHORT,2),Rv),wy=(cm=Object(Cr.injectable)(),Gm=Object(Cr.inject)(sr.IRendererService),cm(Hm=(Wm=function(){function e(){Ft()(this,e),w()(this,"attributesAndIndices",void 0),Di()(this,"rendererService",S0,this),w()(this,"attributes",[]),w()(this,"triangulation",void 0),w()(this,"featureLayout",{sizePerElement:0,elements:[]})}return Yt()(e,[{key:"registerStyleAttribute",value:function(t){var n=this.getLayerStyleAttribute(t.name||"");return n?n.setProps(t):(n=new Ey(t),this.attributes.push(n)),n}},{key:"updateStyleAttribute",value:function(t,n,i){var s=this.getLayerStyleAttribute(t);s||(s=this.registerStyleAttribute(Lv(Lv({},n),{},{name:t})));var c=n.scale;c&&s&&(s.scale=c,s.needRescale=!0,s.needRemapping=!0,s.needRegenerateVertices=!0,i&&i.featureRange&&(s.featureRange=i.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(t){return this.attributes.find(function(n){return n.name===t})}},{key:"getLayerAttributeScale",value:function(t){var n,i=this.getLayerStyleAttribute(t),s=i==null||(n=i.scale)===null||n===void 0?void 0:n.scalers;return s&&s[0]?s[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3?arguments[3]:void 0,c=this.attributes.find(function(xt){return xt.name===t});if(c&&c.descriptor){var g=c.descriptor,y=g.update,E=g.buffer,T=g.size,I=T===void 0?0:T,F=Cy[E.type||ve.FLOAT];if(y){var U=this.featureLayout,Q=U.elements,ue=U.sizePerElement,de=Q.slice(i,s);if(!de.length)return;var Re=de[0].offset,et=Re*I*F,ht=de.map(function(xt,Gt){for(var jt=xt.featureIdx,Qt=xt.vertices,fr=xt.normals,Gr=Qt.length/ue,Jr=[],Ur=0;Ur<Gr;Ur++){var Xn=fr?fr.slice(Ur*3,Ur*3+3):[];Jr.push.apply(Jr,Ut()(y(n[jt],jt,Qt.slice(Ur*ue,Ur*ue+ue),Gt,Xn)))}return Jr}).reduce(function(xt,Gt){return xt.push.apply(xt,Ut()(Gt)),xt},[]);c.vertexAttribute.updateBuffer({data:ht,offset:et})}}}},{key:"createAttributesAndIndices",value:function(t,n,i){var s=this;this.featureLayout={sizePerElement:0,elements:[]},n&&(this.triangulation=n);var c=this.attributes.map(function(et){return et.resetDescriptor(),et.descriptor}),g=0,y=[],E=[],T=[],I=3;t.forEach(function(et,ht){var xt=s.triangulation(et,i),Gt=xt.indices,jt=xt.vertices,Qt=xt.normals,fr=xt.size;Gt.forEach(function(Xn){E.push(Xn+g)}),I=fr;var Gr=jt.length/fr;s.featureLayout.sizePerElement=I,s.featureLayout.elements.push({featureIdx:ht,vertices:jt,normals:Qt,offset:g}),g+=Gr;for(var Jr=function(ni){var Oi=(Qt==null?void 0:Qt.slice(ni*3,ni*3+3))||[],No=jt.slice(ni*fr,ni*fr+fr);c.forEach(function(zs,ll){if(zs&&zs.update){var Fc;(Fc=zs.buffer.data).push.apply(Fc,Ut()(zs.update(et,ht,No,ni,Oi)))}})},Ur=0;Ur<Gr;Ur++)Jr(Ur)});var F=this.rendererService,U=F.createAttribute,Q=F.createBuffer,ue=F.createElements,de={};c.forEach(function(et,ht){if(et){var xt=et.buffer,Gt=et.update,jt=et.name,Qt=xp()(et,Sy),fr=U(Lv({buffer:Q(xt)},Qt));de[et.name||""]=fr,s.attributes[ht].vertexAttribute=fr}});var Re=ue({data:E,type:ve.UNSIGNED_INT,count:E.length});return this.attributesAndIndices={attributes:de,elements:Re},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var t;this.attributes.forEach(function(n){n.vertexAttribute&&n.vertexAttribute.destroy()}),(t=this.attributesAndIndices)===null||t===void 0||t.elements.destroy(),this.attributes=[]}}]),e}(),S0=Vi()(Wm.prototype,"rendererService",[Gm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wm))||Hm),Ic=M("iegG"),Zm=M.n(Ic),w0,A0,T0,M0,fm,P0,hm,O0,I0,R0,L0,Xm,k0,D0,F0,pm,dm,Ql,B0,N0,z0,U0,j0,V0,G0,H0,W0,Z0,X0,Y0,K0,$0,q0;function Ay(e){var r=Ty();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Ty(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var My=(w0=Object(Cr.injectable)(),A0=Object(Cr.inject)(sr.SceneID),T0=Object(Cr.inject)(sr.IIconService),M0=Object(Cr.inject)(sr.IFontService),fm=Object(Cr.inject)(sr.IControlService),P0=Object(Cr.inject)(sr.IGlobalConfigService),hm=Object(Cr.inject)(sr.IMapService),O0=Object(Cr.inject)(sr.ICoordinateSystemService),I0=Object(Cr.inject)(sr.IRendererService),R0=Object(Cr.inject)(sr.ILayerService),L0=Object(Cr.inject)(sr.ICameraService),Xm=Object(Cr.inject)(sr.IInteractionService),k0=Object(Cr.inject)(sr.IPickingService),D0=Object(Cr.inject)(sr.IShaderModuleService),F0=Object(Cr.inject)(sr.IMarkerService),pm=Object(Cr.inject)(sr.IPopupService),w0(dm=(Ql=function(e){qr()(t,e);var r=Ay(t);function t(){var n;return Ft()(this,t),n=r.call(this),w()(ce()(n),"destroyed",!1),w()(ce()(n),"loaded",!1),w()(ce()(n),"loadFont",!1),w()(ce()(n),"fontFamily",""),Di()(ce()(n),"id",B0,ce()(n)),Di()(ce()(n),"iconService",N0,ce()(n)),Di()(ce()(n),"fontService",z0,ce()(n)),Di()(ce()(n),"controlService",U0,ce()(n)),Di()(ce()(n),"configService",j0,ce()(n)),Di()(ce()(n),"map",V0,ce()(n)),Di()(ce()(n),"coordinateSystemService",G0,ce()(n)),Di()(ce()(n),"rendererService",H0,ce()(n)),Di()(ce()(n),"layerService",W0,ce()(n)),Di()(ce()(n),"cameraService",Z0,ce()(n)),Di()(ce()(n),"interactionService",X0,ce()(n)),Di()(ce()(n),"pickingService",Y0,ce()(n)),Di()(ce()(n),"shaderModuleService",K0,ce()(n)),Di()(ce()(n),"markerService",$0,ce()(n)),Di()(ce()(n),"popupService",q0,ce()(n)),w()(ce()(n),"inited",!1),w()(ce()(n),"initPromise",void 0),w()(ce()(n),"rendering",!1),w()(ce()(n),"$container",void 0),w()(ce()(n),"canvas",void 0),w()(ce()(n),"markerContainer",void 0),w()(ce()(n),"hooks",void 0),w()(ce()(n),"handleWindowResized",function(){n.emit("resize"),n.$container&&(n.initContainer(),j.triggerResize(),n.coordinateSystemService.needRefresh=!0,n.render())}),w()(ce()(n),"handleMapCameraChanged",function(i){n.cameraService.update(i),n.render()}),n.hooks={init:new Es.a},n}return Yt()(t,[{key:"init",value:function(i){var s=this;this.configService.setSceneConfig(this.id,i),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return s.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",tu()(Na.a.mark(function c(){return Na.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,new Promise(function(E){s.map.onCameraChanged(function(T){s.cameraService.init(),s.cameraService.update(T),s.map.version!=="GAODE2.x"&&E()}),s.map.version!=="GAODE2.x"?s.map.init():E()});case 2:if(!(s.map.version==="GAODE2.x"&&s.map.initViewPort)){y.next=6;break}return y.next=5,s.map.init();case 5:s.map.initViewPort();case 6:s.map.onCameraChanged(s.handleMapCameraChanged),s.map.addMarkerContainer(),s.markerService.addMarkers(),s.markerService.addMarkerLayers(),s.popupService.initPopup(),s.interactionService.init(),s.interactionService.on(ul.Drag,s.addSceneEvent.bind(s));case 13:case"end":return y.stop()}},c)}))),this.hooks.init.tapPromise("initRenderer",tu()(Na.a.mark(function c(){var g,y;return Na.a.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(g=Hd(s.configService.getSceneConfig(s.id).id||""),s.$container=g,!g){T.next=11;break}return s.canvas=j.create("canvas","",g),s.setCanvas(),T.next=7,s.rendererService.init(s.canvas,s.configService.getSceneConfig(s.id));case 7:Zm()(s.$container,s.handleWindowResized),di.matchMedia&&((y=di.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||y===void 0||y.addListener(s.handleWindowResized)),T.next=12;break;case 11:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:s.pickingService.init(s.id);case 13:case"end":return T.stop()}},c)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"initMiniScene",value:function(i){var s=this;this.configService.setSceneConfig(this.id,i),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return s.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",tu()(Na.a.mark(function c(){return Na.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,new Promise(function(E){s.map.onCameraChanged(function(T){s.cameraService.init(),s.cameraService.update(T),s.map.version!=="GAODE2.x"&&E()}),s.map.initMiniMap()});case 2:s.map.onCameraChanged(s.handleMapCameraChanged),s.interactionService.init(),s.interactionService.on(ul.Drag,s.addSceneEvent.bind(s));case 5:case"end":return y.stop()}},c)}))),this.hooks.init.tapPromise("initRenderer",tu()(Na.a.mark(function c(){var g;return Na.a.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(g=i.canvas,s.$container=g||null,!s.$container){E.next=7;break}return E.next=5,s.rendererService.init(i.canvas,s.configService.getSceneConfig(s.id));case 5:E.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:s.pickingService.init(s.id);case 9:case"end":return E.stop()}},c)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(i){this.layerService.sceneService=this,this.layerService.add(i),this.render()}},{key:"render",value:function(){var n=tu()(Na.a.mark(function s(){return Na.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(this.rendering||this.destroyed)){g.next=2;break}return g.abrupt("return");case 2:if(this.rendering=!0,this.inited){g.next=15;break}return g.next=6,this.initPromise;case 6:if(this.destroyed&&this.destroy(),!(this.loadFont&&document.fonts)){g.next=10;break}return g.next=10,document.fonts.load("24px ".concat(this.fontFamily),"L7text");case 10:this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 15:this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this.rendering=!1;case 18:case"end":return g.stop()}},s,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"addFontFace",value:function(i,s){this.fontFamily=i;var c=document.createElement("style");c.type="text/css",c.innerText=`
        @font-face{
            font-family: '`.concat(i,`';
            src: url('`).concat(s,`') format('woff2'),
            url('`).concat(s,`') format('woff'),
            url('`).concat(s,`') format('truetype');
        }`),document.getElementsByTagName("head")[0].appendChild(c),this.loadFont=!0}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(i){var s,c=(s=this.$container)===null||s===void 0?void 0:s.getElementsByTagName("canvas")[0];this.render();var g=i==="jpg"?c==null?void 0:c.toDataURL("image/jpeg"):c==null?void 0:c.toDataURL("image/png");return g}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var i=this.$container.parentElement;i!==null&&(this.markerContainer=j.create("div","l7-marker-container",i))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var i=this,s,c;if(!this.inited){this.destroyed=!0;return}if(this.emit("destroy"),this.layerService.destroy(),setTimeout(function(){i.rendererService.destroy()}),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),(s=this.$container)===null||s===void 0||(c=s.parentNode)===null||c===void 0||c.removeChild(this.$container),this.removeAllListeners(),this.inited=!1,Object(Ic.unbind)(this.$container,this.handleWindowResized),di.matchMedia){var g;(g=di.matchMedia("screen and (min-resolution: 2dppx)"))===null||g===void 0||g.removeListener(this.handleWindowResized)}}},{key:"initContainer",value:function(){var i,s,c=j.DPR,g=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,y=((s=this.$container)===null||s===void 0?void 0:s.clientHeight)||300,E=this.canvas;E&&(E.width=g*c,E.height=y*c),this.rendererService.viewport({x:0,y:0,width:c*g,height:c*y})}},{key:"setCanvas",value:function(){var i,s,c=j.DPR,g=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,y=((s=this.$container)===null||s===void 0?void 0:s.clientHeight)||300,E=this.canvas;E.width=g*c,E.height=y*c,E.style.width="100%",E.style.height="100%"}},{key:"addSceneEvent",value:function(i){this.emit(i.type,i)}}]),t}(Lu.EventEmitter),B0=Vi()(Ql.prototype,"id",[A0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N0=Vi()(Ql.prototype,"iconService",[T0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z0=Vi()(Ql.prototype,"fontService",[M0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U0=Vi()(Ql.prototype,"controlService",[fm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j0=Vi()(Ql.prototype,"configService",[P0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V0=Vi()(Ql.prototype,"map",[hm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G0=Vi()(Ql.prototype,"coordinateSystemService",[O0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H0=Vi()(Ql.prototype,"rendererService",[I0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W0=Vi()(Ql.prototype,"layerService",[R0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z0=Vi()(Ql.prototype,"cameraService",[L0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X0=Vi()(Ql.prototype,"interactionService",[Xm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y0=Vi()(Ql.prototype,"pickingService",[k0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K0=Vi()(Ql.prototype,"shaderModuleService",[D0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$0=Vi()(Ql.prototype,"markerService",[F0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q0=Vi()(Ql.prototype,"popupService",[pm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ql))||dm),Py=M("7tbW"),Q0=M.n(Py);function p(e){var r=0;switch(e){case"vec2":case"ivec2":r=2;break;case"vec3":case"ivec3":r=3;break;case"vec4":case"ivec4":case"mat2":r=4;break;case"mat3":r=9;break;case"mat4":r=16;break;default:}return r}var x=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function O(e){var r={};return e=e.replace(x,function(t,n,i){var s=i.split(":"),c=s[0].trim(),g="";switch(s.length>1&&(g=s[1].trim()),n){case"bool":g=g==="true";break;case"float":case"int":g=Number(g);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":g?g=g.replace("[","").replace("]","").split(",").reduce(function(y,E){return y.push(Number(E.trim())),y},[]):g=new Array(p(n)).fill(0);break;default:}return r[c]=g,"uniform ".concat(n," ").concat(c,`;
`)}),{content:e,uniforms:r}}var G,fe;function ke(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function lt(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ke(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ke(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Rt="#define PI 3.14159265359",or=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,cn=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,fn=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Mn=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_shaderPick;

uniform float u_activeMix: 0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // TODO: \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

// TODO: \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
vec4 filterColorAnimate(vec4 color) {
  // TODO: \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, color.a));
  }
}

vec4 filterColorWithLight(vec4 color, float lightWeight) {
  // TODO: \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, lightWeight));
  }
}

`,Si=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec3 u_CurrentSelectedId : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;
uniform float u_shaderPick;
uniform float u_EnableSelect: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {
  //   // \u9009\u4E2D\u6001
  //   v_PickingResult.a = SELECT;
  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {
  //   // \u9AD8\u4EAE\u6001
  //   v_PickingResult.a = HIGHLIGHT;
  // } else {
  //   v_PickingResult.a = NORMAL;
  // }

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,ra=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,Aa=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // return vec4(
    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), 
    //   project_scale(position.z), 
    //   position.w);

     return vec4(
      position.xy, 
      project_scale(position.z), 
      position.w);
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom));
  }
  return pixel * 2.0;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}`,ro=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Ta=`attribute float a_vertexId;

uniform mat4 u_cellTypeLayout;      // \u63CF\u8FF0\u6570\u636E\u7EB9\u7406 cell \u7ED3\u6784\u7684\u77E9\u9635
uniform sampler2D u_dataTexture;    // \u6570\u636E\u7EB9\u7406

bool hasOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 opacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeOpacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeWidth() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeWidth \u7684\u6570\u636E
  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStroke() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 stroke \u7684\u6570\u636E
  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasOffsets() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 offsets \u7684\u6570\u636E
  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasThetaOffset() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 thetaOffset \u7684\u6570\u636E
  return u_cellTypeLayout[2][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

// \u6839\u636E\u5750\u6807\u4F4D\u7F6E\u5148\u662F\u8BA1\u7B97 uv \uFF0C\u7136\u540E\u6839\u636E uv \u4ECE\u6570\u636E\u7EB9\u7406\u4E2D\u53D6\u503C
float pos2value(vec2 pos, float columnWidth, float rowHeight) {
  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;
  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);
  return texture2D(u_dataTexture, vec2(u, v)).r;
}

/*
  currentRow \u5F53\u524D\u884C
  currentColumn \u5F53\u524D\u5217
  columnCount \u6709\u591A\u5C11\u5217
  nextStep \u9700\u8981\u8BA1\u7B97\u5F53\u524D cell \u540E\u7684\u7B2C\u51E0\u4E2A cell \uFF08\u5F53\u524D cell \u5219 nextStep = 0\uFF09
*/
vec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {
  float nextColumn = currentColumn;
  float nextRow = currentRow;
  if(currentColumn + nextStep <= columnCount){
    nextColumn = currentColumn + nextStep;
  } else {
    nextColumn = mod(currentColumn + nextStep, columnCount); // \u4E0D\u4F1A\u51FA\u73B0\u8DE8\u4E24\u884C
    nextRow = currentRow + 1.0;
  }
  return vec2(nextColumn, nextRow);
}

// \u8BA1\u7B97\u5F53\u524D\u5355\u4E2A cell \u7684\u5927\u5C0F
float calCellCount() { 
  //   u_cellTypeLayout
  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - \u51E0\u884C\u51E0\u5217
  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 \u8868\u793A\u6709\u6570\u636E\u6620\u5C04\u30010.0 \u8868\u793A\u6CA1\u6709
  //   1.0, 1.0, 0.0, 0.0, // offsets thetaOffset
  //   0.0, 0.0, 0.0, 0.0
  
  return  u_cellTypeLayout[1][0] +        // opacity
          u_cellTypeLayout[1][1] +        // strokeOpacity
          u_cellTypeLayout[1][2] +        // strokeWidth
          u_cellTypeLayout[1][3] * 4.0 +  // stroke
          u_cellTypeLayout[2][0] * 2.0 +  // offsets
          u_cellTypeLayout[2][1];         // thetaOffset
}`,_o=`
// \u8BA1\u7B97 opacity \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasOpacity()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 opacity \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureOpacity, textureOffset + 1.0);
  }
}
`,Mo=`
// \u8BA1\u7B97 strokeOpaicty \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeOpacity()) {
    return vec2(u_stroke_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeOpacity, textureOffset + 1.0);
  }
}
`,Ef=`
// \u8BA1\u7B97 strokeWidth \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeWidth()) {
    return vec2(u_stroke_width, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeWidth, textureOffset + 1.0);
  }
}
`,Rc=`
// \u8BA1\u7B97 thetaOffset \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calThetaOffsetAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasThetaOffset()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 thetaOffset \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_thetaOffset, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureThetaOffset = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureThetaOffset, textureOffset + 1.0);
  }
}
`,Sf=/precision\s+(high|low|medium)p\s+float/,Qu=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,bh=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,Ep=(G=Object(Cr.injectable)(),G(fe=function(){function e(){Ft()(this,e),w()(this,"moduleCache",{}),w()(this,"rawContentCache",{})}return Yt()(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:Rt,fs:Rt}),this.registerModule("decode",{vs:or,fs:""}),this.registerModule("projection",{vs:Aa,fs:""}),this.registerModule("project",{vs:ra,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:ro}),this.registerModule("lighting",{vs:fn,fs:""}),this.registerModule("light",{vs:cn,fs:""}),this.registerModule("picking",{vs:Si,fs:Mn}),this.registerModule("styleMapping",{vs:Ta,fs:""}),this.registerModule("styleMappingCalThetaOffset",{vs:Rc,fs:""}),this.registerModule("styleMappingCalOpacity",{vs:_o,fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:Mo,fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:Ef,fs:""})}},{key:"registerModule",value:function(t,n){if(!this.rawContentCache[t]){var i=n.vs,s=n.fs,c=n.uniforms,g=O(i),y=g.content,E=g.uniforms,T=O(s),I=T.content,F=T.uniforms;this.rawContentCache[t]={fs:I,uniforms:lt(lt(lt({},E),F),c),vs:y}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(t){var n=this;if(this.moduleCache[t])return this.moduleCache[t];var i=this.rawContentCache[t].vs,s=this.rawContentCache[t].fs,c=this.processModule(i,[],"vs"),g=c.content,y=c.includeList,E=this.processModule(s,[],"fs"),T=E.content,I=E.includeList,F=T,U=Q0()(y.concat(I).concat(t)).reduce(function(Q,ue){return lt(lt({},Q),n.rawContentCache[ue].uniforms)},{});return Sf.test(T)||(F=Qu+T),this.moduleCache[t]={fs:F.trim(),uniforms:U,vs:g.trim()},this.moduleCache[t]}},{key:"processModule",value:function(t,n,i){var s=this,c=t.replace(bh,function(g,y){var E=y.split(" "),T=E[0].replace(/"/g,"");if(n.indexOf(T)>-1)return"";var I=s.rawContentCache[T][i];n.push(T);var F=s.processModule(I,n,i),U=F.content;return U});return{content:c,includeList:n}}}]),e}())||fe),J0=M("iWIM"),Yd=M.n(J0),Kd;(function(e){e.Normal="normal",e.PostProcessing="post-processing"})(Kd||(Kd={}));var X_,Y_,eg=(X_=Object(Cr.injectable)(),X_(Y_=function(){function e(){Ft()(this,e),w()(this,"shaderModuleService",void 0),w()(this,"rendererService",void 0),w()(this,"cameraService",void 0),w()(this,"mapService",void 0),w()(this,"interactionService",void 0),w()(this,"layerService",void 0),w()(this,"config",void 0)}return Yt()(e,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Kd.Normal}},{key:"init",value:function(t,n){this.config=n,this.rendererService=t.getContainer().get(sr.IRendererService),this.cameraService=t.getContainer().get(sr.ICameraService),this.mapService=t.getContainer().get(sr.IMapService),this.interactionService=t.getContainer().get(sr.IInteractionService),this.layerService=t.getContainer().get(sr.ILayerService),this.shaderModuleService=t.getContainer().get(sr.IShaderModuleService)}},{key:"render",value:function(t){}}]),e}())||Y_),K_,$_;function pw(e){var r=dw();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function dw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vw=(K_=Object(Cr.injectable)(),K_($_=function(e){qr()(t,e);var r=pw(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(i,s){Yd()(wt()(t.prototype),"init",this).call(this,i,s)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),t}(eg))||$_),q_,Q_,J_,Oy,e1;function mw(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=gw(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function gw(e,r){if(!!e){if(typeof e=="string")return t1(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return t1(e,r)}}function t1(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var yw=(q_=Object(Cr.injectable)(),Q_=Object(Cr.inject)(sr.IPostProcessor),q_(J_=(Oy=function(){function e(){Ft()(this,e),w()(this,"passes",[]),Di()(this,"postProcessor",e1,this),w()(this,"layer",void 0),w()(this,"renderFlag",void 0),w()(this,"width",0),w()(this,"height",0)}return Yt()(e,[{key:"setLayer",value:function(t){this.layer=t}},{key:"setRenderFlag",value:function(t){this.renderFlag=t}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var r=tu()(Na.a.mark(function n(){var i,s,c;return Na.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:i=mw(this.passes),y.prev=1,i.s();case 3:if((s=i.n()).done){y.next=9;break}return c=s.value,y.next=7,c.render(this.layer);case 7:y.next=3;break;case 9:y.next=14;break;case 11:y.prev=11,y.t0=y.catch(1),i.e(y.t0);case 14:return y.prev=14,i.f(),y.finish(14);case 17:return y.next=19,this.postProcessor.render(this.layer);case 19:case"end":return y.stop()}},n,this,[[1,11,14,17]])}));function t(){return r.apply(this,arguments)}return t}()},{key:"resize",value:function(t,n){(this.width!==t||this.height!==n)&&(this.postProcessor.resize(t,n),this.width=t,this.height=n)}},{key:"add",value:function(t,n){t.getType()===Kd.PostProcessing?this.postProcessor.add(t,this.layer,n):(t.init(this.layer,n),this.passes.push(t))}},{key:"insert",value:function(t,n,i){t.init(this.layer,n),this.passes.splice(i,0,t)}},{key:"destroy",value:function(){this.passes.length=0}}]),e}(),e1=Vi()(Oy.prototype,"postProcessor",[Q_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oy))||J_),r1,n1;function i1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function a1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?i1(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function _w(e){var r=xw();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function xw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var bw=(r1=Object(Cr.injectable)(),r1(n1=function(e){qr()(t,e);var r=_w(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"pickingFBO",void 0),w()(ce()(n),"layer",void 0),w()(ce()(n),"width",0),w()(ce()(n),"height",0),w()(ce()(n),"alreadyInRendering",!1),w()(ce()(n),"pickFromPickingFBO",function(g){var y=g.x,E=g.y,T=g.lngLat,I=g.type;if(!(!n.layer.isVisible()||!n.layer.needPick(I))){var F=n.rendererService,U=F.getViewportSize,Q=F.readPixels,ue=F.useFramebuffer,de=U(),Re=de.width,et=de.height,ht=n.layer.getLayerConfig(),xt=ht.enableHighlight,Gt=ht.enableSelect,jt=y*j.DPR,Qt=E*j.DPR;if(!(jt>Re||jt<0||Qt>et||Qt<0)){var fr;ue(n.pickingFBO,function(){var Gr;if(fr=Q({x:Math.round(jt),y:Math.round(et-(E+1)*j.DPR),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:n.pickingFBO}),fr[0]!==0||fr[1]!==0||fr[2]!==0){var Jr=nn(fr),Ur=n.layer.getSource().getFeatureById(Jr),Xn={x:y,y:E,type:I,lngLat:T,featureId:Jr,feature:Ur};Ur&&(n.layer.setCurrentPickId(Jr),n.triggerHoverOnLayer(Xn))}else{var ni={x:y,y:E,lngLat:T,type:n.layer.getCurrentPickId()===null?"un"+I:"mouseout",featureId:null,feature:null};n.triggerHoverOnLayer(a1(a1({},ni),{},{type:"unpick"})),n.triggerHoverOnLayer(ni),n.layer.setCurrentPickId(null)}xt&&n.highlightPickedFeature(fr),Gt&&I==="click"&&((Gr=fr)===null||Gr===void 0?void 0:Gr.toString())!==[0,0,0,0].toString()&&n.selectFeature(fr)})}}}),n}return Yt()(t,[{key:"getType",value:function(){return Kd.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(i,s){Yd()(wt()(t.prototype),"init",this).call(this,i,s),this.layer=i;var c=this.rendererService,g=c.createTexture2D,y=c.createFramebuffer,E=c.getViewportSize,T=E(),I=T.width,F=T.height;this.pickingFBO=y({color:g({width:I,height:F,wrapS:ve.CLAMP_TO_EDGE,wrapT:ve.CLAMP_TO_EDGE})}),this.interactionService.on(ul.Hover,this.pickFromPickingFBO),this.interactionService.on(ul.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(ul.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(i){var s=this;if(!this.alreadyInRendering){var c=this.rendererService,g=c.getViewportSize,y=c.useFramebuffer,E=c.clear,T=g(),I=T.width,F=T.height;this.alreadyInRendering=!0,(this.width!==I||this.height!==F)&&(this.pickingFBO.resize({width:I,height:F}),this.width=I,this.height=F),y(this.pickingFBO,function(){E({framebuffer:s.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var U=s.layer.multiPassRenderer.getRenderFlag();s.layer.multiPassRenderer.setRenderFlag(!1),i.hooks.beforePickingEncode.call(),i.render(),i.hooks.afterPickingEncode.call(),s.layer.multiPassRenderer.setRenderFlag(U),s.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(i){this.layer.emit(i.type,i)}},{key:"highlightPickedFeature",value:function(i){var s=Ei()(i,3),c=s[0],g=s[1],y=s[2];this.layer.hooks.beforeHighlight.call([c,g,y]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(i){var s=Ei()(i,3),c=s[0],g=s[1],y=s[2];this.layer.hooks.beforeSelect.call([c,g,y]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(i){var s=i.featureId,c=An(s);this.selectFeature(new Uint8Array(c))}},{key:"highlightFeatureHandle",value:function(i){var s=i.featureId,c=An(s);this.highlightPickedFeature(new Uint8Array(c))}}]),t}(eg))||n1),Ew=M("gQMU"),Sw=M.n(Ew),Cw=M("u6S6"),ww=M.n(Cw),o1,s1,u1,Iy,l1;function c1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Ym(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?c1(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Aw=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,gd=(o1=Object(Cr.injectable)(),s1=Object(Cr.inject)(sr.IShaderModuleService),o1(u1=(Iy=function(){function e(){Ft()(this,e),Di()(this,"shaderModuleService",l1,this),w()(this,"rendererService",void 0),w()(this,"config",void 0),w()(this,"quad",Aw),w()(this,"enabled",!0),w()(this,"renderToScreen",!1),w()(this,"model",void 0),w()(this,"name",void 0),w()(this,"optionsToUpdate",{})}return Yt()(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(t){this.name=t}},{key:"getType",value:function(){return Kd.PostProcessing}},{key:"init",value:function(t,n){this.config=n,this.rendererService=t.getContainer().get(sr.IRendererService),this.shaderModuleService=t.getContainer().get(sr.IShaderModuleService);var i=this.rendererService,s=i.createAttribute,c=i.createBuffer,g=i.createModel,y=this.setupShaders(),E=y.vs,T=y.fs,I=y.uniforms;this.model=g({vs:E,fs:T,attributes:{a_Position:s({buffer:c({data:[-4,-4,4,-4,0,4],type:ve.FLOAT}),size:2})},uniforms:Ym(Ym({u_Texture:null},I),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(t,n){var i=this,s=t.multiPassRenderer.getPostProcessor(),c=this.rendererService,g=c.useFramebuffer,y=c.getViewportSize,E=c.clear,T=y(),I=T.width,F=T.height;g(this.renderToScreen?null:s.getWriteFBO(),function(){E({framebuffer:s.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var U=Ym({u_BloomFinal:0,u_Texture:s.getReadFBO(),u_ViewportSize:[I,F]},i.convertOptionsToUniforms(i.optionsToUpdate));n&&(U.u_BloomFinal=1,U.u_Texture2=n),i.model.draw({uniforms:U})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(t){this.enabled=t}},{key:"setRenderToScreen",value:function(t){this.renderToScreen=t}},{key:"updateOptions",value:function(t){this.optionsToUpdate=Ym(Ym({},this.optionsToUpdate),t)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(t){var n={};return Object.keys(t).forEach(function(i){bp()(t[i])||(n["u_".concat(Sw()(ww()(i)))]=t[i])}),n}}]),e}(),l1=Vi()(Iy.prototype,"shaderModuleService",[s1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iy))||u1),f1,h1;function p1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function d1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?p1(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Tw(e){var r=Mw();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Mw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Pw=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);
  // float lum = luminance(baseColor);
  // baseColor.a *= lum;

  // gl_FragColor = baseColor;

  // if(u_BloomFinal > 0.0) { // 
  //   gl_FragColor = baseColor; //-- 
  // }

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    // float lum = luminance(inbloomColor);
    // vec4 bloom = vec4(lum);
    // inbloomColor.a *= lum;
    // gl_FragColor = inbloomColor * u_intensity + texture2D(u_Texture2, v_UV);
    // gl_FragColor = inbloomColor * 0.5 + texture2D(u_Texture2, v_UV);
    // gl_FragColor = baseColor;
    // gl_FragColor = inbloomColor;
    // vec4 mixColor = mix(baseColor, inbloomColor, max(u_intensity - 0.3, 0.0));
    // mixColor.a = max(baseColor.a, mixColor.a);
    gl_FragColor = mix(inbloomColor, baseColor, max(1.0 - u_intensity, u_baseRadio));
    // gl_FragColor = mixColor;
    // gl_FragColor = baseColor;
    
    if(baselum <= 0.0) {
      // float lum = luminance(inbloomColor);
      // inbloomColor.rgb *= lum;
      gl_FragColor += inbloomColor * u_intensity;
    }
    // gl_FragColor = inbloomColor * baseColor + baseColor;
    // gl_FragColor = baseColor + bloom * 0.5;
  } else {
    gl_FragColor = inbloomColor;
  }
  // gl_FragColor = inbloomColor;

  // float h = 0.01;
  
  // vec4 color11 = texture2D( u_Texture, vec2( v_UV.x - 1.0 * h, v_UV.y + 1.0 * h) );
  // vec4 color12 = texture2D( u_Texture, vec2( v_UV.x - 0.0 * h, v_UV.y + 1.0 * h) );
  // vec4 color13 = texture2D( u_Texture, vec2( v_UV.x + 1.0 * h, v_UV.y + 1.0 * h) );

  // vec4 color21 = texture2D( u_Texture, vec2( v_UV.x - 1.0 * h, v_UV.y) );
  // vec4 color23 = texture2D( u_Texture, vec2( v_UV.x + 1.0 * h, v_UV.y) );

  // vec4 color31 = texture2D( u_Texture, vec2( v_UV.x - 1.0 * h, v_UV.y-1.0*h) );
  // vec4 color32 = texture2D( u_Texture, vec2( v_UV.x - 0.0 * h, v_UV.y-1.0*h) );
  // vec4 color33 = texture2D( u_Texture, vec2( v_UV.x + 1.0 * h, v_UV.y-1.0*h) );

  // vec4 bloomColor =
  //   color11 + 
  //   color12 + 
  //   color13 + 
  //   color21 + 
  //   color21 + 
  //   color23 + 
  //   color31 + 
  //   color32 + 
  //   color33;

  //   if(baseColor.a > 0.0) {
      
  //     gl_FragColor.r = min(bloomColor.r, baseColor.r);
  //     gl_FragColor.g = min(bloomColor.g, baseColor.g);
  //     gl_FragColor.b = min(bloomColor.b, baseColor.b);
  //     gl_FragColor.a = min(bloomColor.a, baseColor.a);

  //     gl_FragColor = mix(inbloomColor, gl_FragColor, 0.7);
  //   } else {
  //     gl_FragColor = bloomColor/9.0;
  //   } 
}`,Ow=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Iw=(f1=Object(Cr.injectable)(),f1(h1=function(e){qr()(t,e);var r=Tw(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Ow,fs:Pw});var i=this.shaderModuleService.getModule("blur-pass"),s=i.vs,c=i.fs,g=i.uniforms,y=this.rendererService.getViewportSize(),E=y.width,T=y.height;return{vs:s,fs:c,uniforms:d1(d1({},g),{},{u_ViewportSize:[E,T]})}}},{key:"convertOptionsToUniforms",value:function(i){var s={};return bp()(i.bloomRadius)||(s.u_radius=i.bloomRadius),bp()(i.bloomIntensity)||(s.u_intensity=i.bloomIntensity),bp()(i.bloomBaseRadio)||(s.u_baseRadio=i.bloomBaseRadio),s}}]),t}(gd))||h1),v1,m1;function g1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function y1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?g1(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Rw(e){var r=Lw();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Lw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var kw=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Dw=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Fw=(v1=Object(Cr.injectable)(),v1(m1=function(e){qr()(t,e);var r=Rw(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Dw,fs:kw});var i=this.shaderModuleService.getModule("blur-pass"),s=i.vs,c=i.fs,g=i.uniforms,y=this.rendererService.getViewportSize(),E=y.width,T=y.height;return{vs:s,fs:c,uniforms:y1(y1({},g),{},{u_ViewportSize:[E,T]})}}},{key:"convertOptionsToUniforms",value:function(i){var s={};return bp()(i.blurRadius)||(s.u_BlurDir=[i.blurRadius,0]),s}}]),t}(gd))||m1),_1,x1;function b1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function E1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?b1(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Bw(e){var r=Nw();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Nw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var zw=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Uw=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,jw=(_1=Object(Cr.injectable)(),_1(x1=function(e){qr()(t,e);var r=Bw(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Uw,fs:zw});var i=this.shaderModuleService.getModule("blur-pass"),s=i.vs,c=i.fs,g=i.uniforms,y=this.rendererService.getViewportSize(),E=y.width,T=y.height;return{vs:s,fs:c,uniforms:E1(E1({},g),{},{u_ViewportSize:[E,T]})}}},{key:"convertOptionsToUniforms",value:function(i){var s={};return bp()(i.blurRadius)||(s.u_BlurDir=[0,i.blurRadius]),s}}]),t}(gd))||x1),S1,C1;function w1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function A1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?w1(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Vw(e){var r=Gw();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Gw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Hw=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,Ww=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Zw=(S1=Object(Cr.injectable)(),S1(C1=function(e){qr()(t,e);var r=Vw(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:Ww,fs:Hw});var i=this.shaderModuleService.getModule("colorhalftone-pass"),s=i.vs,c=i.fs,g=i.uniforms,y=this.rendererService.getViewportSize(),E=y.width,T=y.height;return{vs:s,fs:c,uniforms:A1(A1({},g),{},{u_ViewportSize:[E,T]})}}}]),t}(gd))||C1),T1,M1;function Xw(e){var r=Yw();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Yw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Kw=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,$w=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,qw=(T1=Object(Cr.injectable)(),T1(M1=function(e){qr()(t,e);var r=Xw(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:$w,fs:Kw}),this.shaderModuleService.getModule("copy-pass")}}]),t}(gd))||M1),P1,O1;function I1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function R1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?I1(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):I1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Qw(e){var r=Jw();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Jw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var eA=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,tA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,rA=(P1=Object(Cr.injectable)(),P1(O1=function(e){qr()(t,e);var r=Qw(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:tA,fs:eA});var i=this.shaderModuleService.getModule("hexagonalpixelate-pass"),s=i.vs,c=i.fs,g=i.uniforms,y=this.rendererService.getViewportSize(),E=y.width,T=y.height;return{vs:s,fs:c,uniforms:R1(R1({},g),{},{u_ViewportSize:[E,T]})}}}]),t}(gd))||O1),L1,k1;function D1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function F1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?D1(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):D1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function nA(e){var r=iA();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function iA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var aA=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,oA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,sA=(L1=Object(Cr.injectable)(),L1(k1=function(e){qr()(t,e);var r=nA(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:oA,fs:aA});var i=this.shaderModuleService.getModule("ink-pass"),s=i.vs,c=i.fs,g=i.uniforms,y=this.rendererService.getViewportSize(),E=y.width,T=y.height;return{vs:s,fs:c,uniforms:F1(F1({},g),{},{u_ViewportSize:[E,T]})}}}]),t}(gd))||k1),B1,N1;function uA(e){var r=lA();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function lA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var cA=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,fA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,hA=(B1=Object(Cr.injectable)(),B1(N1=function(e){qr()(t,e);var r=uA(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:fA,fs:cA}),this.shaderModuleService.getModule("noise-pass")}}]),t}(gd))||N1),z1,U1;function pA(e){var r=dA();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function dA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,mA=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,gA=(z1=Object(Cr.injectable)(),z1(U1=function(e){qr()(t,e);var r=pA(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:vA,fs:mA}),this.shaderModuleService.getModule("sepia-pass")}}]),t}(gd))||U1),j1,V1,G1,H1,vm,W1,yA=(j1=Object(Cr.injectable)(),V1=Object(Cr.inject)(sr.IRendererService),G1=Object(Cr.postConstruct)(),j1(H1=(vm=function(){function e(){Ft()(this,e),Di()(this,"rendererService",W1,this),w()(this,"passes",[]),w()(this,"readFBO",void 0),w()(this,"writeFBO",void 0)}return Yt()(e,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var t=this.rendererService,n=t.getViewportSize,i=t.createTexture2D,s=n(),c=s.width,g=s.height;return i({x:0,y:0,width:c,height:g,copy:!0})}},{key:"getReadFBOTex",value:function(){var t=this,n=this.rendererService.useFramebuffer;return new Promise(function(i,s){n(t.readFBO,tu()(Na.a.mark(function c(){return Na.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:i(t.getCurrentFBOTex());case 1:case"end":return y.stop()}},c)})))})}},{key:"renderBloomPass",value:function(){var r=tu()(Na.a.mark(function n(i,s){var c,g;return Na.a.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this.getReadFBOTex();case 2:c=E.sent,g=0;case 4:if(!(g<4)){E.next=11;break}return E.next=7,s.render(i,c);case 7:this.swap(),g++,E.next=4;break;case 11:case"end":return E.stop()}},n,this)}));function t(n,i){return r.apply(this,arguments)}return t}()},{key:"render",value:function(){var r=tu()(Na.a.mark(function n(i){var s,c;return Na.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:s=0;case 1:if(!(s<this.passes.length)){y.next=15;break}if(c=this.passes[s],c.setRenderToScreen(this.isLastEnabledPass(s)),c.getName()!=="bloom"){y.next=9;break}return y.next=7,this.renderBloomPass(i,c);case 7:y.next=12;break;case 9:return y.next=11,c.render(i);case 11:s!==this.passes.length-1&&this.swap();case 12:s++,y.next=1;break;case 15:case"end":return y.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"resize",value:function(t,n){this.readFBO.resize({width:t,height:n}),this.writeFBO.resize({width:t,height:n})}},{key:"add",value:function(t,n,i){t.init(n,i),this.passes.push(t)}},{key:"insert",value:function(t,n,i,s){t.init(i,s),this.passes.splice(n,0,t)}},{key:"getPostProcessingPassByName",value:function(t){return this.passes.find(function(n){return n.getName()===t})}},{key:"init",value:function(){var t=this.rendererService,n=t.createFramebuffer,i=t.createTexture2D;this.readFBO=n({color:i({width:1,height:1,wrapS:ve.CLAMP_TO_EDGE,wrapT:ve.CLAMP_TO_EDGE})}),this.writeFBO=n({color:i({width:1,height:1,wrapS:ve.CLAMP_TO_EDGE,wrapT:ve.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(t){for(var n=t+1;n<this.passes.length;n++)if(this.passes[n].isEnabled())return!1;return!0}},{key:"swap",value:function(){var t=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=t}}]),e}(),W1=Vi()(vm.prototype,"rendererService",[V1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vi()(vm.prototype,"init",[G1],Object.getOwnPropertyDescriptor(vm.prototype,"init"),vm.prototype),vm))||H1),Z1,X1;function _A(e){var r=xA();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function xA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var bA=(Z1=Object(Cr.injectable)(),Z1(X1=function(e){qr()(t,e);var r=_A(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getType",value:function(){return Kd.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(i,s){Yd()(wt()(t.prototype),"init",this).call(this,i,s)}},{key:"render",value:function(i){var s=this.rendererService,c=s.useFramebuffer,g=s.clear,y=i.multiPassRenderer.getPostProcessor().getReadFBO();c(y,function(){g({color:[0,0,0,0],depth:1,stencil:0,framebuffer:y}),i.multiPassRenderer.setRenderFlag(!1),i.models.forEach(function(E){E.draw({uniforms:i.layerModel.getUninforms()})}),i.multiPassRenderer.setRenderFlag(!0)})}}]),t}(eg))||X1),Y1,K1,$1,Ry,q1;function Q1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function J1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Q1(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Q1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function EA(e){var r=SA();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function SA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var CA=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,ex=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,wA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function tx(e,r){for(var t=0,n=1/r,i=e;i>0;)t=t+n*(i%r),i=Math.floor(i/r),n=n/r;return t}var AA=1,TA=(Y1=Object(Cr.injectable)(),K1=Object(Cr.inject)(sr.IShaderModuleService),Y1($1=(Ry=function(e){qr()(t,e);var r=EA(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),Di()(ce()(n),"shaderModuleService",q1,ce()(n)),w()(ce()(n),"haltonSequence",[]),w()(ce()(n),"accumulatingId",0),w()(ce()(n),"frame",0),w()(ce()(n),"timer",void 0),w()(ce()(n),"sampleRenderTarget",void 0),w()(ce()(n),"prevRenderTarget",void 0),w()(ce()(n),"outputRenderTarget",void 0),w()(ce()(n),"copyRenderTarget",void 0),w()(ce()(n),"blendModel",void 0),w()(ce()(n),"outputModel",void 0),w()(ce()(n),"copyModel",void 0),n}return Yt()(t,[{key:"getType",value:function(){return Kd.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(i,s){Yd()(wt()(t.prototype),"init",this).call(this,i,s);var c=this.rendererService,g=c.createFramebuffer,y=c.createTexture2D;this.sampleRenderTarget=g({color:y({width:1,height:1,wrapS:ve.CLAMP_TO_EDGE,wrapT:ve.CLAMP_TO_EDGE})}),this.prevRenderTarget=g({color:y({width:1,height:1,wrapS:ve.CLAMP_TO_EDGE,wrapT:ve.CLAMP_TO_EDGE})}),this.outputRenderTarget=g({color:y({width:1,height:1,wrapS:ve.CLAMP_TO_EDGE,wrapT:ve.CLAMP_TO_EDGE})}),this.copyRenderTarget=g({color:y({width:1,height:1,wrapS:ve.CLAMP_TO_EDGE,wrapT:ve.CLAMP_TO_EDGE})});for(var E=0;E<30;E++)this.haltonSequence.push([tx(E,2),tx(E,3)]);this.blendModel=this.createTriangleModel("blend-pass",CA),this.outputModel=this.createTriangleModel("copy-pass",ex,{blend:{enable:!0,func:{srcRGB:ve.ONE,dstRGB:ve.ONE_MINUS_SRC_ALPHA,srcAlpha:ve.ONE,dstAlpha:ve.ONE_MINUS_SRC_ALPHA},equation:{rgb:ve.FUNC_ADD,alpha:ve.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",ex)}},{key:"render",value:function(i){var s=this,c=this.rendererService,g=c.clear,y=c.getViewportSize,E=c.useFramebuffer,T=y(),I=T.width,F=T.height;this.sampleRenderTarget.resize({width:I,height:F}),this.prevRenderTarget.resize({width:I,height:F}),this.outputRenderTarget.resize({width:I,height:F}),this.copyRenderTarget.resize({width:I,height:F}),this.resetFrame(),this.stopAccumulating();var U=i.multiPassRenderer.getPostProcessor().getReadFBO();E(U,function(){g({color:[0,0,0,0],depth:1,stencil:0,framebuffer:U}),i.multiPassRenderer.setRenderFlag(!1),i.render(),i.multiPassRenderer.setRenderFlag(!0)});var Q=function ue(de){!s.accumulatingId||de!==s.accumulatingId||s.isFinished()||(s.doRender(i),di.requestAnimationFrame(function(){ue(de)}))};this.accumulatingId=AA++,this.timer=di.setTimeout(function(){Q(s.accumulatingId)},50)}},{key:"doRender",value:function(i){var s=this,c=this.rendererService,g=c.clear,y=c.getViewportSize,E=c.useFramebuffer,T=y(),I=T.width,F=T.height,U=i.getLayerConfig(),Q=U.jitterScale,ue=Q===void 0?1:Q,de=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((de[0]*2-1)/I*ue,(de[1]*2-1)/F*ue),i.multiPassRenderer.setRenderFlag(!1),i.hooks.beforeRender.call(),E(this.sampleRenderTarget,function(){g({color:[0,0,0,0],depth:1,stencil:0,framebuffer:s.sampleRenderTarget}),i.render()}),i.hooks.afterRender.call(),i.multiPassRenderer.setRenderFlag(!0);var Re=i.getLayerConfig();E(this.outputRenderTarget,function(){s.blendModel.draw({uniforms:{u_opacity:Re.opacity||1,u_MixRatio:s.frame===0?1:.9,u_Diffuse1:s.sampleRenderTarget,u_Diffuse2:s.frame===0?i.multiPassRenderer.getPostProcessor().getReadFBO():s.prevRenderTarget}})}),this.frame===0&&g({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(E(this.copyRenderTarget,function(){s.outputModel.draw({uniforms:{u_Texture:s.outputRenderTarget}})}),E(i.multiPassRenderer.getPostProcessor().getReadFBO(),function(){s.copyModel.draw({uniforms:{u_Texture:s.copyRenderTarget}})}),i.multiPassRenderer.getPostProcessor().render(i));var et=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=et,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,di.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(i,s,c){this.shaderModuleService.registerModule(i,{vs:wA,fs:s});var g=this.shaderModuleService.getModule(i),y=g.vs,E=g.fs,T=g.uniforms,I=this.rendererService,F=I.createAttribute,U=I.createBuffer,Q=I.createModel;return Q(J1({vs:y,fs:E,attributes:{a_Position:F({buffer:U({data:[-4,-4,4,-4,0,4],type:ve.FLOAT}),size:2})},uniforms:J1({},T),depth:{enable:!1},count:3},c))}}]),t}(eg),q1=Vi()(Ry.prototype,"shaderModuleService",[K1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ry))||$1),Km=new Cr.Container;Km.bind(sr.IGlobalConfigService).to(yv).inSingletonScope(),Object(Cr.decorate)(Object(Cr.injectable)(),Lu.EventEmitter),Km.bind(sr.IEventEmitter).to(Lu.EventEmitter);var rx=Mp()(Km,!1),Ly=function(r){var t=rx.lazyInject(r);return function(n,i,s){t.call(this,n,i),s&&(s.initializer=function(){return n[i]})}},ZD=function(r){var t=rx.lazyMultiInject(r);return function(n,i,s){t.call(this,n,i),s&&(s.initializer=function(){return n[i]})}},Eh=Km,MA=0;function PA(){var e=new Cr.Container;return e.parent=Km,e.bind(sr.SceneID).toConstantValue("".concat(MA++)),e.bind(sr.IShaderModuleService).to(Ep).inSingletonScope(),e.bind(sr.ILayerService).to(_y).inSingletonScope(),e.bind(sr.ISceneService).to(My).inSingletonScope(),e.bind(sr.ICameraService).to(Bp).inSingletonScope(),e.bind(sr.ICoordinateSystemService).to(jd).inSingletonScope(),e.bind(sr.IInteractionService).to(nm).inSingletonScope(),e.bind(sr.IPickingService).to(jm).inSingletonScope(),e.bind(sr.IControlService).to(Np).inSingletonScope(),e.bind(sr.IMarkerService).to(Hf).inSingletonScope(),e.bind(sr.IIconService).to(Ba).inSingletonScope(),e.bind(sr.IFontService).to(ch).inSingletonScope(),e.bind(sr.IPopupService).to(em).inSingletonScope(),e.bind(sr.INormalPass).to(vw).whenTargetNamed("clear"),e.bind(sr.INormalPass).to(bw).whenTargetNamed("pixelPicking"),e.bind(sr.INormalPass).to(bA).whenTargetNamed("render"),e.bind(sr.INormalPass).to(TA).whenTargetNamed("taa"),e.bind(sr.IFactoryNormalPass).toFactory(function(r){return function(t){return r.container.getNamed(sr.INormalPass,t)}}),e.bind(sr.IPostProcessingPass).to(qw).whenTargetNamed("copy"),e.bind(sr.IPostProcessingPass).to(Iw).whenTargetNamed("bloom"),e.bind(sr.IPostProcessingPass).to(Fw).whenTargetNamed("blurH"),e.bind(sr.IPostProcessingPass).to(jw).whenTargetNamed("blurV"),e.bind(sr.IPostProcessingPass).to(hA).whenTargetNamed("noise"),e.bind(sr.IPostProcessingPass).to(gA).whenTargetNamed("sepia"),e.bind(sr.IPostProcessingPass).to(Zw).whenTargetNamed("colorHalftone"),e.bind(sr.IPostProcessingPass).to(rA).whenTargetNamed("hexagonalPixelate"),e.bind(sr.IPostProcessingPass).to(sA).whenTargetNamed("ink"),e.bind(sr.IFactoryPostProcessingPass).toFactory(function(r){return function(t){var n=r.container.getNamed(sr.IPostProcessingPass,t);return n.setName(t),n}}),e}function OA(e){var r=new Cr.Container;return r.parent=e,r.bind(sr.IStyleAttributeService).to(wy).inSingletonScope(),r.bind(sr.IMultiPassRenderer).to(yw).inSingletonScope(),r.bind(sr.IPostProcessor).to(yA).inSingletonScope(),r}var IA=M("9nhX"),nx=M.n(IA),RA=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function LA(e){return RA.indexOf(e)}var kA=2,XD=4,DA=64,YD=128,FA=256,BA=512,KD=8192,$D=16384,qD=32768,NA=32768*2,ix=131072,QD=262144,zA=524288,JD=1048576,UA=2097152,eF=4194304,jA=8388608,VA=16777216,GA=16777216*2;function tg(e,r){return e=nx()(Math.floor(e),0,255),r=nx()(Math.floor(r),0,255),256*e+r}function tF(e){var r=e.color,t=e.radius,n=e.tileX,i=e.tileY,s=e.shape,c=e.opacity,g=e.stroke,y=e.strokeWidth,E=e.strokeOpacity,T=[],I=[],F=[],U=[tg(r[0],r[1]),tg(r[2],r[3])],Q=[tg(g[0],g[1]),tg(g[2],g[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ue){var de=Ei()(ue,2),Re=de[0],et=de[1];T.push([].concat(U,[(Re+1)*jA+(et+1)*UA+LA(s)*ix+t,(n+512)*zA+(i+512)*DA])),I.push([].concat(Q,[y,E])),F.push([c,0,0,0])}),{packedBuffer:T,packedBuffer2:I,packedBuffer3:F}}function rF(e,r){if(e===0&&!r)return 0;if(e===1&&r)return 4294967295;var t=r?1:0,n=Math.floor(e*127);return n*GA+t*VA+n*ix+t*NA+n*BA+t*FA+n*kA+t}var Gh;(function(e){e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none"})(Gh||(Gh={}));var Jl;(function(e){e.LINEAR="linear",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat"})(Jl||(Jl={}));var $d;(function(e){e.CONSTANT="constant",e.VARIABLE="variable"})($d||($d={}));var Yi;(function(e){e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform"})(Yi||(Yi={}));var mm=["mapload","mapchange"],kv={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},ky=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],qd;(function(e){e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft",e.TOPCENTER="topcenter",e.BOTTOMCENTER="bottomcenter",e.LEFTCENTER="leftcenter",e.RIGHTCENTER="rightcenter"})(qd||(qd={}));function ax(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function ox(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ax(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ax(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function HA(e){var r=WA();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function WA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ZA=0,$m=function(e){qr()(t,e);var r=HA(t);function t(n){var i;return Ft()(this,t),i=r.call(this),w()(ce()(i),"controlOption",void 0),w()(ce()(i),"container",void 0),w()(ce()(i),"sceneContainer",void 0),w()(ce()(i),"mapsService",void 0),w()(ce()(i),"renderService",void 0),w()(ce()(i),"layerService",void 0),w()(ce()(i),"controlService",void 0),w()(ce()(i),"isShow",void 0),i.controlOption=ox(ox({},i.getDefault()),n||{}),i}return Yt()(t,[{key:"getDefault",value:function(){return{position:qd.TOPRIGHT,name:"".concat(ZA++)}}},{key:"setPosition",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qd.BOTTOMRIGHT,s=this.controlService;return s&&s.removeControl(this),this.controlOption.position=i,s&&s.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(i){this.mapsService=i.get(sr.IMapService),this.renderService=i.get(sr.IRendererService),this.layerService=i.get(sr.ILayerService),this.controlService=i.get(sr.IControlService),this.sceneContainer=i,this.isShow=!0,this.container=this.onAdd();var s=this.container,c=this.controlOption.position,g=this.controlService.controlCorners[c];return j.addClass(s,"l7-control"),c.indexOf("bottom")!==-1?g.insertBefore(s,g.firstChild):g.appendChild(s),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var i=this.container;j.addClass(i,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var i=this.container;j.removeClass(i,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;j.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(i){if(this.mapsService&&i&&i.screenX>0&&i.screenY>0){var s=this.mapsService.getContainer();s!==null&&s.focus()}}}]),t}(Lu.EventEmitter);function XA(e){var r=YA();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function YA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var KA=function(e){qr()(t,e);var r=XA(t);function t(n){var i;return Ft()(this,t),i=r.call(this,n),w()(ce()(i),"layerControlInputs",void 0),w()(ce()(i),"layers",void 0),w()(ce()(i),"lastZIndex",void 0),w()(ce()(i),"handlingClick",void 0),w()(ce()(i),"layersLink",void 0),w()(ce()(i),"baseLayersList",void 0),w()(ce()(i),"separator",void 0),w()(ce()(i),"overlaysList",void 0),w()(ce()(i),"form",void 0),i.layerControlInputs=[],i.layers=[],i.lastZIndex=0,i.handlingClick=!1,i.initLayers(),Zl(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],ce()(i)),i}return Yt()(t,[{key:"getDefault",value:function(){return{collapsed:!0,position:qd.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var i=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(s){s.layer.on("remove",i.onLayerChange),s.layer.on("add",i.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(i,s){return this.addLayer(i,s,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var i=this.renderService.getViewportSize(),s=i.height;j.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var c=s-(this.container.offsetTop+50);return c<this.form.clientHeight?(j.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=c+"px"):j.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return j.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var i=this;!this.mapsService||(this.mapsService.off("click",this.collapse),this.layers.forEach(function(s){s.layer.off("remove",i.onLayerChange),s.layer.off("add",i.onLayerChange)}))}},{key:"initLayout",value:function(){var i="l7-control-layers",s=this.container=j.create("div",i),c=this.controlOption.collapsed;s.setAttribute("aria-haspopup","true");var g=this.form=j.create("form",i+"-list");c&&(this.mapsService.on("click",this.collapse),s.addEventListener("mouseenter",this.expand),s.addEventListener("mouseleave",this.collapse)),this.layersLink=j.create("a",i+"-toggle",s);var y=this.layersLink;y.title="Layers",c||this.expand(),this.baseLayersList=j.create("div",i+"-base",g),this.separator=j.create("div",i+"-separator",g),this.overlaysList=j.create("div",i+"-overlays",g),s.appendChild(g)}},{key:"initLayers",value:function(){var i=this,s=this.controlOption,c=s.baseLayers,g=c===void 0?{}:c,y=s.overlayers,E=y===void 0?{}:y;Object.keys(g).forEach(function(T,I){i.addLayer(g[T],T,!1)}),Object.keys(E).forEach(function(T,I){i.addLayer(E[T],T,!0)})}},{key:"update",value:function(){if(!this.container)return this;j.empty(this.baseLayersList),j.empty(this.overlaysList),this.layerControlInputs=[];var i,s,c,g,y=0;for(c=0;c<this.layers.length;c++)g=this.layers[c],this.addItem(g),s=s||g.overlay,i=i||!g.overlay,y+=g.overlay?0:1;return this.controlOption.hideSingleBase&&(i=i&&y>1,this.baseLayersList.style.display=i?"":"none"),this.separator.style.display=s&&i?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var i=this.layerControlInputs,s,c,g=this.mapsService.getZoom(),y=i.length-1;y>=0;y--)if(s=i[y],c=this.layerService.getLayer(s.layerId),c&&c.inited){var E=c.getMinZoom(),T=c.getMaxZoom();s.disabled=g<E||g>T}}},{key:"addLayer",value:function(i,s,c){this.mapsService&&(i.on("add",this.onLayerChange),i.on("remove",this.onLayerChange)),this.layers.push({layer:i,name:s,overlay:c});var g=this.controlOption,y=g.sortLayers,E=g.sortFunction,T=g.autoZIndex;y&&this.layers.sort(function(I,F){return E(I.layer,F.layer,I.name,F.name)}),T&&i.setZIndex&&(this.lastZIndex++,i.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(i){this.handlingClick||this.update();var s=this.layerService.getLayer(i.target.layerId),c=s!=null&&s.overlay?i.type==="add"?"overlayadd":"overlayremove":i.type==="add"?"baselayerchange":null;c&&this.emit(c,s)}},{key:"createRadioElement",value:function(i,s){var c='<input type="radio" class="l7-control-layers-selector" name="'+i+'"'+(s?' checked="checked"':"")+"/>",g=document.createElement("div");return g.innerHTML=c,g.firstChild}},{key:"addItem",value:function(i){var s=document.createElement("label"),c=this.layerService.getLayer(i.layer.id),g=c&&c.inited&&i.layer.isVisible(),y;i.overlay?(y=document.createElement("input"),y.type="checkbox",y.className="l7-control-layers-selector",y.defaultChecked=g):y=this.createRadioElement("l7-base-layers",g),this.layerControlInputs.push(y),y.layerId=i.layer.id,y.addEventListener("click",this.onInputClick);var E=document.createElement("span");E.innerHTML=" "+i.name;var T=document.createElement("div");s.appendChild(T),T.appendChild(y),T.appendChild(E);var I=i.overlay?this.overlaysList:this.baseLayersList;return I.appendChild(s),this.checkDisabledLayers(),s}},{key:"onInputClick",value:function(){var i=this.layerControlInputs,s,c,g=[],y=[];this.handlingClick=!0;for(var E=i.length-1;E>=0;E--)s=i[E],c=this.layerService.getLayer(s.layerId),s.checked?g.push(c):s.checked||y.push(c);y.forEach(function(T){T.hide()}),g.forEach(function(T){T.show()}),this.handlingClick=!1}}]),t}($m);function $A(e){var r=qA();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function qA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var sx=function(e){qr()(t,e);var r=$A(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getDefault",value:function(){return{position:qd.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var i="l7-control-logo",s=j.create("div",i),c=j.create("a","l7-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://antv.alipay.com/l7",c.setAttribute("aria-label","AntV logo"),c.setAttribute("rel","noopener nofollow"),s.appendChild(c),s}},{key:"onRemove",value:function(){return null}}]),t}($m);function QA(e){var r=JA();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function JA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var eT=function(e){qr()(t,e);var r=QA(t);function t(n){var i;return Ft()(this,t),i=r.call(this,n),w()(ce()(i),"mScale",void 0),w()(ce()(i),"iScale",void 0),Zl(["update"],ce()(i)),i}return Yt()(t,[{key:"getDefault",value:function(){return{position:qd.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var i="l7-control-scale",s=j.create("div",i);this.addScales(i+"-line",s);var c=this.controlOption.updateWhenIdle;return this.mapsService.on(c?"moveend":"mapmove",this.update),this.mapsService.on(c?"zoomend":"zoomchange",this.update),this.update(),s}},{key:"onRemove",value:function(){var i=this.controlOption.updateWhenIdle;this.mapsService.off(i?"zoomend":"zoomchange",this.update),this.mapsService.off(i?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var i=this.mapsService,s=this.controlOption.maxWidth,c=i.getSize()[1]/2,g=i.containerToLngLat([0,c]),y=i.containerToLngLat([s,c]),E=Hs([g.lng,g.lat],[y.lng,y.lat]);this.updateScales(E)}},{key:"updateScales",value:function(i){var s=this.controlOption,c=s.metric,g=s.imperial;c&&i&&this.updateMetric(i),g&&i&&this.updateImperial(i)}},{key:"updateMetric",value:function(i){var s=this.getRoundNum(i),c=s<1e3?s+" m":s/1e3+" km";this.updateScale(this.mScale,c,s/i)}},{key:"updateImperial",value:function(i){var s=i*3.2808399,c,g,y;s>5280?(c=s/5280,g=this.getRoundNum(c),this.updateScale(this.iScale,g+" mi",g/c)):(y=this.getRoundNum(s),this.updateScale(this.iScale,y+" ft",y/s))}},{key:"updateScale",value:function(i,s,c){var g=this.controlOption.maxWidth;i.style.width=Math.round(g*c)+"px",i.innerHTML=s}},{key:"getRoundNum",value:function(i){var s=Math.pow(10,(Math.floor(i)+"").length-1),c=i/s;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,s*c}},{key:"addScales",value:function(i,s){var c=this.controlOption,g=c.metric,y=c.imperial;g&&(this.mScale=j.create("div",i,s)),y&&(this.iScale=j.create("div",i,s))}}]),t}($m);function tT(e){var r=rT();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function rT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var nT=function(e){qr()(t,e);var r=tT(t);function t(n){var i;return Ft()(this,t),i=r.call(this,n),w()(ce()(i),"disabled",void 0),w()(ce()(i),"zoomInButton",void 0),w()(ce()(i),"zoomOutButton",void 0),Zl(["updateDisabled","zoomIn","zoomOut"],ce()(i)),i}return Yt()(t,[{key:"getDefault",value:function(){return{position:qd.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var i="l7-control-zoom",s=j.create("div",i+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,i+"-in",s,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,i+"-out",s,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),s}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(i,s,c,g,y){var E=j.create("a",c,g);return E.innerHTML=i,E.title=s,E.href="javascript:void(0)",E.addEventListener("click",y),E}},{key:"updateDisabled",value:function(){var i=this.mapsService,s="l7-disabled";j.removeClass(this.zoomInButton,s),j.removeClass(this.zoomOutButton,s),(this.disabled||i.getZoom()<=i.getMinZoom())&&j.addClass(this.zoomOutButton,s),(this.disabled||i.getZoom()>=i.getMaxZoom())&&j.addClass(this.zoomInButton,s)}}]),t}($m);function ux(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function lx(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ux(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ux(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function iT(e){var r=aT();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function aT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var cx=function(e){qr()(t,e);var r=iT(t);function t(n){var i;return Ft()(this,t),i=r.call(this),w()(ce()(i),"markerOption",void 0),w()(ce()(i),"defaultMarker",void 0),w()(ce()(i),"popup",void 0),w()(ce()(i),"mapsService",void 0),w()(ce()(i),"sceneSerive",void 0),w()(ce()(i),"lngLat",void 0),w()(ce()(i),"scene",void 0),w()(ce()(i),"added",!1),w()(ce()(i),"eventHandle",function(s){i.emit(s.type,{target:s,data:i.markerOption.extData,lngLat:i.lngLat})}),i.markerOption=lx(lx({},i.getDefault()),n),Zl(["update","onMove","onUp","addDragHandler","onMapClick"],ce()(i)),i.init(),i}return Yt()(t,[{key:"getDefault",value:function(){return{element:void 0,anchor:mi.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(i){this.scene=i,this.mapsService=i.get(sr.IMapService),this.sceneSerive=i.get(sr.ISceneService);var s=this.markerOption,c=s.element,g=s.draggable;return this.mapsService.getMarkerContainer().appendChild(c),this.registerMarkerEvent(c),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var i=this.markerOption.element;return i&&j.remove(i),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(i){return this.lngLat=i,Array.isArray(i)&&(this.lngLat={lng:i[0],lat:i[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(i){var s=this;if(!this.added)return this.once("added",function(){s.setElement(i)}),this;var c=this.markerOption.element;return c&&j.remove(c),this.markerOption.element=i,this.init(),this.mapsService.getMarkerContainer().appendChild(i),this.registerMarkerEvent(i),this.update(),this}},{key:"openPopup",value:function(){var i=this;if(!this.added)return this.once("added",function(){i.openPopup()}),this;var s=this.popup;return s?(s.isOpen()||s.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var i=this;this.added||this.once("added",function(){i.closePopup()});var s=this.popup;return s&&s.remove(),this}},{key:"setPopup",value:function(i){return this.popup=i,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var i=this.popup;if(i)i.isOpen()?i.remove():i.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(i){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(i){this.markerOption.extData=i}},{key:"update",value:function(){if(!!this.mapsService){var i=this.markerOption,s=i.element,c=i.anchor;this.updatePosition(),j.setTransform(s,"".concat(yi[c]))}}},{key:"onMapClick",value:function(i){var s=this.markerOption.element;this.popup&&s&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!!this.mapsService){var i=this.markerOption,s=i.element,c=i.offsets,g=this.lngLat,y=g.lng,E=g.lat,T=this.mapsService.getBounds(),I=this.mapsService.lngLatToContainer([y,E]);if(s){s.style.display="block",s.style.whiteSpace="nowrap";var F=this.mapsService.getContainer(),U=0,Q=0;if(F&&(U=F.scrollWidth,Q=F.scrollHeight),Math.abs(T[0][0])>180||Math.abs(T[1][0])>180){if(I.x>U){var ue=this.mapsService.lngLatToContainer([y-360,E]);I.x=ue.x}if(I.x<0){var de=this.mapsService.lngLatToContainer([y+360,E]);I.x=de.x}}(I.x>U||I.x<0||I.y>Q||I.y<0)&&(s.style.display="none"),s.style.left=I.x+c[0]+"px",s.style.top=I.y-c[1]+"px"}}}},{key:"init",value:function(){var i=this,s=this.markerOption.element,c=this.markerOption,g=c.color,y=c.anchor;if(!s){this.defaultMarker=!0,s=j.create("div"),this.markerOption.element=s;var E=document.createElementNS("http://www.w3.org/2000/svg","svg");E.setAttributeNS(null,"display","block"),E.setAttributeNS(null,"height","48px"),E.setAttributeNS(null,"width","48px"),E.setAttributeNS(null,"viewBox","0 0 1024 1024");var T=document.createElementNS("http://www.w3.org/2000/svg","path");T.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),T.setAttributeNS(null,"fill",g),E.appendChild(T),s.appendChild(E)}j.addClass(s,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(I){var F,U,Q=((F=i.markerOption)===null||F===void 0?void 0:F.style)&&((U=i.markerOption)===null||U===void 0?void 0:U.style[I]);s&&(s.style[I]=Q)}),s.addEventListener("click",function(I){i.onMapClick(I)}),s.addEventListener("click",this.eventHandle),Ni(s,y,"marker")}},{key:"registerMarkerEvent",value:function(i){i.addEventListener("mousemove",this.eventHandle),i.addEventListener("click",this.eventHandle),i.addEventListener("mousedown",this.eventHandle),i.addEventListener("mouseup",this.eventHandle),i.addEventListener("dblclick",this.eventHandle),i.addEventListener("contextmenu",this.eventHandle),i.addEventListener("mouseover",this.eventHandle),i.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var i=this.getElement();i.removeEventListener("mousemove",this.eventHandle),i.removeEventListener("click",this.eventHandle),i.removeEventListener("mousedown",this.eventHandle),i.removeEventListener("mouseup",this.eventHandle),i.removeEventListener("dblclick",this.eventHandle),i.removeEventListener("contextmenu",this.eventHandle),i.removeEventListener("mouseover",this.eventHandle),i.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(i){throw new Error("Method not implemented.")}},{key:"onUp",value:function(i){throw new Error("Method not implemented.")}}]),t}(Lu.EventEmitter);function fx(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function hx(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?fx(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):fx(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function oT(e){var r=sT();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function sT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var nF=function(e){qr()(t,e);var r=oT(t);function t(n){var i,s;return Ft()(this,t),s=r.call(this),w()(ce()(s),"markers",[]),w()(ce()(s),"markerLayerOption",void 0),w()(ce()(s),"clusterIndex",void 0),w()(ce()(s),"points",[]),w()(ce()(s),"clusterMarkers",[]),w()(ce()(s),"mapsService",void 0),w()(ce()(s),"scene",void 0),w()(ce()(s),"zoom",void 0),w()(ce()(s),"bbox",void 0),s.markerLayerOption=gs()(s.getDefault(),n),Zl(["update"],ce()(s)),s.zoom=((i=s.markerLayerOption.clusterOption)===null||i===void 0?void 0:i.zoom)||-99,s}return Yt()(t,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(i){return this.scene=i,this.mapsService=i.get(sr.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(i){var s=this.markerLayerOption.cluster;s&&this.addPoint(i,this.markers.length),this.markers.push(i)}},{key:"removeMarker",value:function(i){this.markers.indexOf(i);var s=this.markers.indexOf(i);s>-1&&this.markers.splice(s,1)}},{key:"hide",value:function(){this.markers.map(function(i){i.getElement().style.opacity="0"}),this.clusterMarkers.map(function(i){i.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(i){i.getElement().style.opacity="1"}),this.clusterMarkers.map(function(i){i.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){var i=this.markerLayerOption.cluster;return i?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var i=this;this.getMarkers().forEach(function(s){s.addTo(i.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(i){i.remove()}),this.clusterMarkers.forEach(function(i){i.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(i,s){var c=i.getLnglat(),g=c.lng,y=c.lat,E={geometry:{type:"Point",coordinates:[g,y]},properties:hx(hx({},i.getExtData()),{},{marker_id:s})};this.points.push(E)}},{key:"initCluster",value:function(){if(!!this.markerLayerOption.cluster){var i=this.markerLayerOption.clusterOption,s=i.radius,c=i.minZoom,g=c===void 0?0:c,y=i.maxZoom;this.clusterIndex=new Tc.a({radius:s,minZoom:g,maxZoom:y}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(i,s){var c=this,g=i[0].concat(i[1]),y=this.clusterIndex.getClusters(g,s);this.clusterMarkers.forEach(function(E){E.remove()}),this.clusterMarkers=[],y.forEach(function(E){var T,I=c.markerLayerOption.clusterOption,F=I.field,U=I.method;if(E.properties&&(T=E.properties)!==null&&T!==void 0&&T.cluster_id){var Q,ue=c.getLeaves((Q=E.properties)===null||Q===void 0?void 0:Q.cluster_id);if(E.properties.clusterData=ue,F&&U){var de=ue==null?void 0:ue.map(function(Gt){var jt=w()({},F,Gt.properties[F]);return jt}),Re=Z.getColumn(de,F),et=Z.getSatByColumn(U,Re),ht="point_"+U;E.properties[ht]=et.toFixed(2)}}var xt=c.clusterMarker(E);c.clusterMarkers.push(xt),xt.addTo(c.scene)})}},{key:"getLeaves",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return i?this.clusterIndex.getLeaves(i,s,c):null}},{key:"clusterMarker",value:function(i){var s=this.markerLayerOption.clusterOption,c=s,g=c.element,y=g===void 0?this.generateElement.bind(this):g,E=new cx({element:y(i)}).setLnglat({lng:i.geometry.coordinates[0],lat:i.geometry.coordinates[1]});return E}},{key:"normalMarker",value:function(i){var s=i.properties.marker_id;return this.markers[s]}},{key:"update",value:function(){var i=this.mapsService.getZoom(),s=this.mapsService.getBounds();(!this.bbox||Math.abs(i-this.zoom)>=1||!dl(this.bbox,s))&&(this.bbox=Wl(s,.5),this.zoom=Math.floor(i),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(i){var s=j.create("div","l7-marker-cluster"),c=j.create("div","",s),g=j.create("span","",c),y=this.markerLayerOption.clusterOption,E=y.field,T=y.method;i.properties.point_count=i.properties.point_count||1;var I=E&&T?i.properties["point_"+T]||i.properties[E]:i.properties.point_count;return g.textContent=I,s}}]),t}(Lu.EventEmitter);function px(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function dx(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?px(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):px(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function uT(e){var r=lT();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function lT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vx=function(e){qr()(t,e);var r=uT(t);function t(n){var i;return Ft()(this,t),i=r.call(this),w()(ce()(i),"popupOption",void 0),w()(ce()(i),"mapsService",void 0),w()(ce()(i),"sceneSerive",void 0),w()(ce()(i),"lngLat",void 0),w()(ce()(i),"content",void 0),w()(ce()(i),"closeButton",void 0),w()(ce()(i),"timeoutInstance",void 0),w()(ce()(i),"container",void 0),w()(ce()(i),"tip",void 0),w()(ce()(i),"scene",void 0),i.popupOption=dx(dx({},i.getdefault()),n),Zl(["update","onClickClose","remove"],ce()(i)),i}return Yt()(t,[{key:"addTo",value:function(i){var s=this;return this.mapsService=i.get(sr.IMapService),this.sceneSerive=i.get(sr.ISceneService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=i,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){s.mapsService.on("click",s.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(i){var s=window.document.createDocumentFragment(),c=window.document.createElement("body"),g;for(c.innerHTML=i;g=c.firstChild,!!g;)s.appendChild(g);return this.setDOMContent(s)}},{key:"setLnglat",value:function(i){return this.lngLat=i,Array.isArray(i)&&(this.lngLat={lng:i[0],lat:i[1]}),this.mapsService&&(this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(i){return this.setDOMContent(window.document.createTextNode(i))}},{key:"setMaxWidth",value:function(i){return this.popupOption.maxWidth=i,this.update(),this}},{key:"setDOMContent",value:function(i){return this.createContent(),this.content.appendChild(i),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&j.remove(this.content),this.content=j.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=j.create("button","l7-popup-close-button",this.content),this.popupOption.closeButtonOffsets&&(this.closeButton.style.right=this.popupOption.closeButtonOffsets[0]+"px",this.closeButton.style.top=this.popupOption.closeButtonOffsets[1]+"px"),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(i,s,c){var g=window.document.createElement(i);return s!==void 0&&(g.className=s),c&&c.appendChild(g),g}},{key:"removeDom",value:function(i){i.parentNode&&i.parentNode.removeChild(i)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:mi.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(i){i.stopPropagation&&i.stopPropagation(),this.remove()}},{key:"update",value:function(){var i=this,s=this.lngLat,c=this.popupOption,g=c.className,y=c.maxWidth,E=c.anchor;if(!(!this.mapsService||!s||!this.content)){var T=this.mapsService.getMarkerContainer();if(!this.container&&T){this.container=this.creatDom("div","l7-popup",T),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),g&&g.split(" ").forEach(function(F){return i.container.classList.add(F)});var I=this.popupOption.stopPropagation;I&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(F){i.container.addEventListener(F,function(U){U.stopPropagation()})}),this.container.style.whiteSpace="nowrap"}y&&this.container.style.maxWidth!==y&&(this.container.style.maxWidth=y),this.updatePosition(),j.setTransform(this.container,"".concat(yi[E])),Ni(this.container,E,"popup")}}},{key:"updatePosition",value:function(){if(!!this.mapsService){var i=this.lngLat,s=i.lng,c=i.lat,g=this.popupOption.offsets,y=this.mapsService.lngLatToContainer([s,c]);this.container.style.left=y.x+g[0]+"px",this.container.style.top=y.y-g[1]+"px"}}}]),t}(Lu.EventEmitter);function cT(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}cT(`.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
}

.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* layers control */

.l7-control-layers {
  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);
          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);
  background: #fff;
  border-radius: 5px;
}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}

.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}

.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-left: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-bottom: none;
  border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-bottom: none;
  border-left: none;
  border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-bottom: none;
  border-right: none;
  border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-left: none;
  border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  padding: 0;
  font-size: 25px;
  line-height: 20px;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
  display: none;
}

.l7-popup-track-pointer * {
  pointer-events: none;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}

.l7-map:active .l7-popup-track-pointer {
  display: none;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);
          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);
  border-radius: 4px;
}
.l7-bar a,
.l7-bar a:hover {
  background-color: #fff;
  width: 30px;
  height: 30px;
  font-size: 20px;
  display: block;
  text-align: center;
  text-decoration: none;
  color: #8e9dab;
}
.l7-bar a,
.l7-control-layers-toggle {
  background-position: 50% 50%;
  background-repeat: no-repeat;
  display: block;
}
.l7-bar a:hover {
  background-color: #f4f4f4;
}
.l7-bar a:first-child {
  border-top-left-radius: 2px;
  border-top-right-radius: 2px;
}
.l7-bar a:last-child {
  border-bottom-left-radius: 2px;
  border-bottom-right-radius: 2px;
  border-bottom: none;
}
.l7-bar a.l7-disabled {
  cursor: default;
  background-color: #f4f4f4;
  color: #bbb;
}

/* control positioning */

.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-hide {
  display: none;
}
.l7-control {
  position: relative;
  z-index: 800;
  pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control {
  float: left;
  clear: both;
}
.l7-top,
.l7-bottom {
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-top {
  top: 0;
}
.l7-right {
  right: 0;
}
.l7-bottom {
  bottom: 0;
}
.l7-left {
  left: 0;
}
.l7-center {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-bottom.l7-center,
.l7-top.l7-center {
  width: 100%;
}
.l7-right.l7-center,
.l7-left.l7-center {
  height: 100%;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}

.l7-top.l7-center,
.l7-left.l7-center {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}

.l7-bottom.l7-center,
.l7-right.l7-center {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}

.l7-center .l7-control {
  margin-right: 10px;
  margin-bottom: 10px;
}

.l7-control {
  float: left;
  clear: both;
}
.l7-right .l7-control {
  float: right;
}
.l7-top .l7-control {
  margin-top: 10px;
}
.l7-bottom .l7-control {
  margin-bottom: 10px;
}
.l7-left .l7-control {
  margin-left: 10px;
}
.l7-right .l7-control {
  margin-right: 10px;
}

/* attribution and scale controls */

.l7-control-container .l7-control-attribution {
  background: #fff;
  background: rgba(59, 58, 58, 0.7);
  margin: 0;
}
.l7-control-attribution,
.l7-control-scale-line {
  padding: 0 5px;
  color: #333;
}
.l7-control-attribution a {
  text-decoration: none;
}
.l7-control-attribution a:hover {
  text-decoration: underline;
}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
}
.l7-left .l7-control-scale {
  margin-left: 5px;
}
.l7-bottom .l7-control-scale {
  margin-bottom: 5px;
}
.l7-control-scale-line {
  border: 2px solid #000;
  border-top: none;
  color: #000;
  line-height: 1.1;
  padding: 2px 5px 1px;
  font-size: 11px;
  white-space: nowrap;
  overflow: hidden;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;

  background: #fff;
}
.l7-control-scale-line:not(:first-child) {
  border-top: 2px solid #777;
  border-bottom: none;
  margin-top: -2px;
}
.l7-control-scale-line:not(:first-child):not(:last-child) {
  border-bottom: 2px solid #777;
}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  border: 2px solid rgba(0, 0, 0, 0.2);
  background-clip: padding-box;
}
/*logo */

.l7-ctrl-logo {
  background-size: 100% 100%;
  width: 89px;
  height: 16px;
  margin: 0 0 -3px -3px;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  background-repeat: no-repeat;
  cursor: pointer;
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}

/* layers control */

.l7-control-layers {
  -webkit-box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);
          box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);
  background: #fff;
  border-radius: 2px;
}
.l7-control-layers-toggle {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
  width: 30px;
  height: 30px;
  background-size: 20px 20px;
}

.l7-touch .l7-control-layers-toggle {
  width: 44px;
  height: 44px;
}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
  display: none;
}
.l7-control-layers-expanded .l7-control-layers-list {
  display: block;
  position: relative;
}
.l7-control-layers-expanded {
  padding: 6px 10px 6px 6px;
  color: #59626b;
  background: #fff;
}
.l7-control-layers-scrollbar {
  overflow-y: scroll;
  overflow-x: hidden;
  padding-right: 5px;
}
.l7-control-layers-selector {
  margin-top: 2px;
  position: relative;
  top: 1px;
}
.l7-control-layers label {
  display: block;
  padding: 8px;
}
.l7-control-layers label input[type='radio'],
.l7-control-layers label input[type='checkbox'] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
  height: 0;
  border-top: 1px solid #d8d8d8;
  margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
}
.amap-logo {
  display: none !important;
}
`);var fT=M("SUU4"),hT=M.n(fT),pT=function(){function e(r,t){Ft()(this,e),w()(this,"attribute",void 0),w()(this,"buffer",void 0);var n=t.buffer,i=t.offset,s=t.stride,c=t.normalized,g=t.size,y=t.divisor;this.buffer=n,this.attribute={buffer:n.get(),offset:i||0,stride:s||0,normalized:c||!1,divisor:y||0},g&&(this.attribute.size=g)}return Yt()(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),yd,qm,_d,Hh,Qm,Qd,Jm,rg,Vp,Dv,Lc,Gp,Hp,ng,dT=(yd={},w()(yd,ve.POINTS,"points"),w()(yd,ve.LINES,"lines"),w()(yd,ve.LINE_LOOP,"line loop"),w()(yd,ve.LINE_STRIP,"line strip"),w()(yd,ve.TRIANGLES,"triangles"),w()(yd,ve.TRIANGLE_FAN,"triangle fan"),w()(yd,ve.TRIANGLE_STRIP,"triangle strip"),yd),mx=(qm={},w()(qm,ve.STATIC_DRAW,"static"),w()(qm,ve.DYNAMIC_DRAW,"dynamic"),w()(qm,ve.STREAM_DRAW,"stream"),qm),Dy=(_d={},w()(_d,ve.BYTE,"int8"),w()(_d,ve.UNSIGNED_INT,"int16"),w()(_d,ve.INT,"int32"),w()(_d,ve.UNSIGNED_BYTE,"uint8"),w()(_d,ve.UNSIGNED_SHORT,"uint16"),w()(_d,ve.UNSIGNED_INT,"uint32"),w()(_d,ve.FLOAT,"float"),_d),vT=(Hh={},w()(Hh,ve.ALPHA,"alpha"),w()(Hh,ve.LUMINANCE,"luminance"),w()(Hh,ve.LUMINANCE_ALPHA,"luminance alpha"),w()(Hh,ve.RGB,"rgb"),w()(Hh,ve.RGBA,"rgba"),w()(Hh,ve.RGBA4,"rgba4"),w()(Hh,ve.RGB5_A1,"rgb5 a1"),w()(Hh,ve.RGB565,"rgb565"),w()(Hh,ve.DEPTH_COMPONENT,"depth"),w()(Hh,ve.DEPTH_STENCIL,"depth stencil"),Hh),mT=(Qm={},w()(Qm,ve.DONT_CARE,"dont care"),w()(Qm,ve.NICEST,"nice"),w()(Qm,ve.FASTEST,"fast"),Qm),gx=(Qd={},w()(Qd,ve.NEAREST,"nearest"),w()(Qd,ve.LINEAR,"linear"),w()(Qd,ve.LINEAR_MIPMAP_LINEAR,"mipmap"),w()(Qd,ve.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),w()(Qd,ve.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),w()(Qd,ve.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Qd),yx=(Jm={},w()(Jm,ve.REPEAT,"repeat"),w()(Jm,ve.CLAMP_TO_EDGE,"clamp"),w()(Jm,ve.MIRRORED_REPEAT,"mirror"),Jm),gT=(rg={},w()(rg,ve.NONE,"none"),w()(rg,ve.BROWSER_DEFAULT_WEBGL,"browser"),rg),yT=(Vp={},w()(Vp,ve.NEVER,"never"),w()(Vp,ve.ALWAYS,"always"),w()(Vp,ve.LESS,"less"),w()(Vp,ve.LEQUAL,"lequal"),w()(Vp,ve.GREATER,"greater"),w()(Vp,ve.GEQUAL,"gequal"),w()(Vp,ve.EQUAL,"equal"),w()(Vp,ve.NOTEQUAL,"notequal"),Vp),_x=(Dv={},w()(Dv,ve.FUNC_ADD,"add"),w()(Dv,ve.MIN_EXT,"min"),w()(Dv,ve.MAX_EXT,"max"),w()(Dv,ve.FUNC_SUBTRACT,"subtract"),w()(Dv,ve.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Dv),ig=(Lc={},w()(Lc,ve.ZERO,"zero"),w()(Lc,ve.ONE,"one"),w()(Lc,ve.SRC_COLOR,"src color"),w()(Lc,ve.ONE_MINUS_SRC_COLOR,"one minus src color"),w()(Lc,ve.SRC_ALPHA,"src alpha"),w()(Lc,ve.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),w()(Lc,ve.DST_COLOR,"dst color"),w()(Lc,ve.ONE_MINUS_DST_COLOR,"one minus dst color"),w()(Lc,ve.DST_ALPHA,"dst alpha"),w()(Lc,ve.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),w()(Lc,ve.CONSTANT_COLOR,"constant color"),w()(Lc,ve.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),w()(Lc,ve.CONSTANT_ALPHA,"constant alpha"),w()(Lc,ve.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),w()(Lc,ve.SRC_ALPHA_SATURATE,"src alpha saturate"),Lc),_T=(Gp={},w()(Gp,ve.NEVER,"never"),w()(Gp,ve.ALWAYS,"always"),w()(Gp,ve.LESS,"less"),w()(Gp,ve.LEQUAL,"lequal"),w()(Gp,ve.GREATER,"greater"),w()(Gp,ve.GEQUAL,"gequal"),w()(Gp,ve.EQUAL,"equal"),w()(Gp,ve.NOTEQUAL,"notequal"),Gp),gm=(Hp={},w()(Hp,ve.ZERO,"zero"),w()(Hp,ve.KEEP,"keep"),w()(Hp,ve.REPLACE,"replace"),w()(Hp,ve.INVERT,"invert"),w()(Hp,ve.INCR,"increment"),w()(Hp,ve.DECR,"decrement"),w()(Hp,ve.INCR_WRAP,"increment wrap"),w()(Hp,ve.DECR_WRAP,"decrement wrap"),Hp),xT=(ng={},w()(ng,ve.FRONT,"front"),w()(ng,ve.BACK,"back"),ng),bT=function(){function e(r,t){Ft()(this,e),w()(this,"buffer",void 0);var n=t.data,i=t.usage,s=t.type;this.buffer=r.buffer({data:n,usage:mx[i||ve.STATIC_DRAW],type:Dy[s||ve.UNSIGNED_BYTE]})}return Yt()(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(t){var n=t.data,i=t.offset;this.buffer.subdata(n,i)}}]),e}(),ET=function(){function e(r,t){Ft()(this,e),w()(this,"elements",void 0);var n=t.data,i=t.usage,s=t.type,c=t.count;this.elements=r.elements({data:n,usage:mx[i||ve.STATIC_DRAW],type:Dy[s||ve.UNSIGNED_BYTE],count:c})}return Yt()(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(t){var n=t.data;this.elements.subdata(n)}},{key:"destroy",value:function(){}}]),e}(),ST=function(){function e(r,t){Ft()(this,e),w()(this,"framebuffer",void 0);var n=t.width,i=t.height,s=t.color,c=t.colors,g=t.depth,y=t.stencil,E={width:n,height:i};Array.isArray(c)&&(E.colors=c.map(function(T){return T.get()})),s&&typeof s!="boolean"&&(E.color=s.get()),this.framebuffer=r.framebuffer(E)}return Yt()(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(t){var n=t.width,i=t.height;this.framebuffer.resize(n,i)}}]),e}(),CT=M("c6wG"),wT=M.n(CT),AT=M("YO3V"),TT=M.n(AT);function xx(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Wp(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?xx(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):xx(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var MT=function(){function e(r,t){Ft()(this,e),w()(this,"reGl",void 0),w()(this,"destroyed",!1),w()(this,"drawCommand",void 0),w()(this,"drawPickCommand",void 0),w()(this,"drawParams",void 0),w()(this,"options",void 0),w()(this,"uniforms",{}),this.reGl=r;var n=t.vs,i=t.fs,s=t.attributes,c=t.uniforms,g=t.primitive,y=t.count,E=t.elements,T=t.depth,I=t.blend,F=t.stencil,U=t.cull,Q=t.instances,ue={};this.options=t,c&&(this.uniforms=this.extractUniforms(c),Object.keys(c).forEach(function(ht){ue[ht]=r.prop(ht)}));var de={};Object.keys(s).forEach(function(ht){de[ht]=s[ht].get()});var Re={attributes:de,frag:i,uniforms:ue,vert:n,blend:{},primitive:dT[g===void 0?ve.TRIANGLES:g]};Q&&(Re.instances=Q),y&&(Re.count=y),E&&(Re.elements=E.get()),this.initDepthDrawParams({depth:T},Re),this.initBlendDrawParams({blend:I},Re),this.initStencilDrawParams({stencil:F},Re),this.initCullDrawParams({cull:U},Re),this.drawCommand=r(Re);var et=Ws()(Re);et.blend=Wp(Wp({},et.blend),{},{enable:!1}),et.stencil=Wp(Wp({},et.stencil),{},{enable:!1}),this.drawPickCommand=r(et),this.drawParams=Re}return Yt()(e,[{key:"addUniforms",value:function(t){this.uniforms=Wp(Wp({},this.uniforms),this.extractUniforms(t))}},{key:"draw",value:function(t,n){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var i=Wp(Wp({},this.uniforms),this.extractUniforms(t.uniforms||{})),s={};Object.keys(i).forEach(function(c){var g=Eo()(i[c]);g==="boolean"||g==="number"||Array.isArray(i[c])||i[c].BYTES_PER_ELEMENT?s[c]=i[c]:s[c]=i[c].get()}),n?this.drawPickCommand(s):this.drawCommand(s)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(t){t.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(t,n){var i=t.depth;i&&(n.depth={enable:i.enable===void 0?!0:!!i.enable,mask:i.mask===void 0?!0:!!i.mask,func:yT[i.func||ve.LESS],range:i.range||[0,1]})}},{key:"initBlendDrawParams",value:function(t,n){var i=t.blend;if(i){var s=i.enable,c=i.func,g=i.equation,y=i.color,E=y===void 0?[0,0,0,0]:y;n.blend={enable:!!s,func:{srcRGB:ig[c&&c.srcRGB||ve.SRC_ALPHA],srcAlpha:ig[c&&c.srcAlpha||ve.SRC_ALPHA],dstRGB:ig[c&&c.dstRGB||ve.ONE_MINUS_SRC_ALPHA],dstAlpha:ig[c&&c.dstAlpha||ve.ONE_MINUS_SRC_ALPHA]},equation:{rgb:_x[g&&g.rgb||ve.FUNC_ADD],alpha:_x[g&&g.alpha||ve.FUNC_ADD]},color:E}}}},{key:"initStencilDrawParams",value:function(t,n){var i=t.stencil;if(i){var s=i.enable,c=i.mask,g=c===void 0?-1:c,y=i.func,E=y===void 0?{cmp:ve.ALWAYS,ref:0,mask:-1}:y,T=i.opFront,I=T===void 0?{fail:ve.KEEP,zfail:ve.KEEP,zpass:ve.KEEP}:T,F=i.opBack,U=F===void 0?{fail:ve.KEEP,zfail:ve.KEEP,zpass:ve.KEEP}:F;n.stencil={enable:!!s,mask:g,func:Wp(Wp({},E),{},{cmp:_T[E.cmp]}),opFront:{fail:gm[I.fail],zfail:gm[I.zfail],zpass:gm[I.zpass]},opBack:{fail:gm[U.fail],zfail:gm[U.zfail],zpass:gm[U.zpass]}}}}},{key:"initCullDrawParams",value:function(t,n){var i=t.cull;if(i){var s=i.enable,c=i.face,g=c===void 0?ve.BACK:c;n.cull={enable:!!s,face:xT[g]}}}},{key:"extractUniforms",value:function(t){var n=this,i={};return Object.keys(t).forEach(function(s){n.extractUniformsRecursively(s,t[s],i,"")}),i}},{key:"extractUniformsRecursively",value:function(t,n,i,s){var c=this;if(n===null||typeof n=="number"||typeof n=="boolean"||Array.isArray(n)&&typeof n[0]=="number"||wT()(n)||n===""||"resize"in n){i["".concat(s&&s+".").concat(t)]=n;return}TT()(n)&&Object.keys(n).forEach(function(g){c.extractUniformsRecursively(g,n[g],i,"".concat(s&&s+".").concat(t))}),Array.isArray(n)&&n.forEach(function(g,y){Object.keys(g).forEach(function(E){c.extractUniformsRecursively(E,g[E],i,"".concat(s&&s+".").concat(t,"[").concat(y,"]"))})})}}]),e}(),PT=function(){function e(r,t){Ft()(this,e),w()(this,"texture",void 0),w()(this,"width",void 0),w()(this,"height",void 0),w()(this,"isDistroy",!1);var n=t.data,i=t.type,s=i===void 0?ve.UNSIGNED_BYTE:i,c=t.width,g=t.height,y=t.flipY,E=y===void 0?!1:y,T=t.format,I=T===void 0?ve.RGBA:T,F=t.mipmap,U=F===void 0?!1:F,Q=t.wrapS,ue=Q===void 0?ve.CLAMP_TO_EDGE:Q,de=t.wrapT,Re=de===void 0?ve.CLAMP_TO_EDGE:de,et=t.aniso,ht=et===void 0?0:et,xt=t.alignment,Gt=xt===void 0?1:xt,jt=t.premultiplyAlpha,Qt=jt===void 0?!1:jt,fr=t.mag,Gr=fr===void 0?ve.NEAREST:fr,Jr=t.min,Ur=Jr===void 0?ve.NEAREST:Jr,Xn=t.colorSpace,ni=Xn===void 0?ve.BROWSER_DEFAULT_WEBGL:Xn,Oi=t.x,No=Oi===void 0?0:Oi,zs=t.y,ll=zs===void 0?0:zs,Fc=t.copy,el=Fc===void 0?!1:Fc;this.width=c,this.height=g;var Cd={width:c,height:g,type:Dy[s],format:vT[I],wrapS:yx[ue],wrapT:yx[Re],mag:gx[Gr],min:gx[Ur],alignment:Gt,flipY:E,colorSpace:gT[ni],premultiplyAlpha:Qt,aniso:ht,x:No,y:ll,copy:el};n&&(Cd.data=n),typeof U=="number"?Cd.mipmap=mT[U]:typeof U=="boolean"&&(Cd.mipmap=U),this.texture=r.texture(Cd)}return Yt()(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(t)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(t){var n=t.width,i=t.height;this.texture.resize(n,i),this.width=n,this.height=i}},{key:"destroy",value:function(){this.isDistroy||this.texture.destroy(),this.isDistroy=!0}}]),e}(),bx,Ex,OT=(bx=Object(Cr.injectable)(),bx(Ex=function(){function e(){var r=this;Ft()(this,e),w()(this,"extensionObject",void 0),w()(this,"gl",void 0),w()(this,"$container",void 0),w()(this,"canvas",void 0),w()(this,"width",void 0),w()(this,"height",void 0),w()(this,"isDirty",void 0),w()(this,"createModel",function(t){return new MT(r.gl,t)}),w()(this,"createAttribute",function(t){return new pT(r.gl,t)}),w()(this,"createBuffer",function(t){return new bT(r.gl,t)}),w()(this,"createElements",function(t){return new ET(r.gl,t)}),w()(this,"createTexture2D",function(t){return new PT(r.gl,t)}),w()(this,"createFramebuffer",function(t){return new ST(r.gl,t)}),w()(this,"useFramebuffer",function(t,n){r.gl({framebuffer:t?t.get():null})(n)}),w()(this,"clear",function(t){var n=t.color,i=t.depth,s=t.stencil,c=t.framebuffer,g=c===void 0?null:c,y={color:n,depth:i,stencil:s};y.framebuffer=g===null?g:g.get(),r.gl.clear(y)}),w()(this,"viewport",function(t){var n=t.x,i=t.y,s=t.width,c=t.height;r.gl._gl.viewport(n,i,s,c),r.width=s,r.height=c,r.gl._refresh()}),w()(this,"readPixels",function(t){var n=t.framebuffer,i=t.x,s=t.y,c=t.width,g=t.height,y={x:i,y:s,width:c,height:g};return n&&(y.framebuffer=n.get()),r.gl.read(y)}),w()(this,"getViewportSize",function(){return{width:r.gl._gl.drawingBufferWidth,height:r.gl._gl.drawingBufferHeight}}),w()(this,"getContainer",function(){if($i)return r.canvas;var t;return(t=r.canvas)===null||t===void 0?void 0:t.parentElement}),w()(this,"getCanvas",function(){return r.canvas}),w()(this,"getGLContext",function(){return r.gl._gl}),w()(this,"destroy",function(){r.gl.destroy()})}return Yt()(e,[{key:"init",value:function(){var r=tu()(Na.a.mark(function n(i,s){var c=this;return Na.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return this.canvas=i,y.next=3,new Promise(function(E,T){hT()({canvas:c.canvas,attributes:{alpha:!0,antialias:s.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:s.preserveDrawingBuffer,stencil:s.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(F,U){(F||!U)&&T(F),E(U)}})});case 3:this.gl=y.sent,this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 5:case"end":return y.stop()}},n,this)}));function t(n,i){return r.apply(this,arguments)}return t}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(t){return!!this.getGLContext().getExtension(t)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var t=this.getGLContext();t.disable(t.CULL_FACE)}},{key:"setDirty",value:function(t){this.isDirty=t}},{key:"getDirty",value:function(){return this.isDirty}}]),e}())||Ex);function Sx(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Cx(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Sx(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Sx(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var e0=function(){function e(r){Ft()(this,e),w()(this,"sceneService",void 0),w()(this,"mapService",void 0),w()(this,"controlService",void 0),w()(this,"layerService",void 0),w()(this,"iconService",void 0),w()(this,"markerService",void 0),w()(this,"popupService",void 0),w()(this,"fontService",void 0),w()(this,"interactionService",void 0),w()(this,"container",void 0);var t=r.id,n=r.map,i=r.canvas,s=r.hasBaseMap,c=PA();this.container=c,n.setContainer(c,t,i,s),c.bind(sr.IRendererService).to(OT).inSingletonScope(),this.sceneService=c.get(sr.ISceneService),this.mapService=c.get(sr.IMapService),this.iconService=c.get(sr.IIconService),this.fontService=c.get(sr.IFontService),this.controlService=c.get(sr.IControlService),this.layerService=c.get(sr.ILayerService),this.markerService=c.get(sr.IMarkerService),this.interactionService=c.get(sr.IInteractionService),this.popupService=c.get(sr.IPopupService),$i?this.sceneService.initMiniScene(r):(this.initComponent(t),this.sceneService.init(r),this.initControl())}return Yt()(e,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(t){return this.sceneService.exportPng(t)}},{key:"exportMap",value:function(t){return this.sceneService.exportPng(t)}},{key:"registerRenderService",value:function(t){var n=this;if(this.sceneService.loaded){var i=new t(this);i.init()}else this.on("loaded",function(){var s=new t(n);s.init()})}},{key:"setBgColor",value:function(t){this.mapService.setBgColor(t)}},{key:"addLayer",value:function(t){var n=OA(this.container);t.setContainer(n,this.container),this.sceneService.addLayer(t)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(t){return this.layerService.getLayer(t)}},{key:"getLayerByName",value:function(t){return this.layerService.getLayerByName(t)}},{key:"removeLayer",value:function(t,n){this.layerService.remove(t,n)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(t){this.layerService.setEnableRender(t)}},{key:"addIconFont",value:function(t,n){this.fontService.addIconFont(t,n)}},{key:"addIconFonts",value:function(t){var n=this;t.forEach(function(i){var s=Ei()(i,2),c=s[0],g=s[1];n.fontService.addIconFont(c,g)})}},{key:"addFontFace",value:function(t,n){this.sceneService.addFontFace(t,n)}},{key:"addImage",value:function(t,n){$i?this.iconService.addImageMini(t,n,this.sceneService):this.iconService.addImage(t,n)}},{key:"hasImage",value:function(t){return this.iconService.hasImage(t)}},{key:"removeImage",value:function(t){this.iconService.removeImage(t)}},{key:"addIconFontGlyphs",value:function(t,n){this.fontService.addIconGlyphs(n)}},{key:"addControl",value:function(t){this.controlService.addControl(t,this.container)}},{key:"removeControl",value:function(t){this.controlService.removeControl(t)}},{key:"getControlByName",value:function(t){return this.controlService.getControlByName(t)}},{key:"addMarker",value:function(t){this.markerService.addMarker(t)}},{key:"addMarkerLayer",value:function(t){this.markerService.addMarkerLayer(t)}},{key:"removeMarkerLayer",value:function(t){this.markerService.removeMarkerLayer(t)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(t){this.popupService.addPopup(t)}},{key:"on",value:function(t,n){ky.indexOf(t)===-1?this.mapService.on(t,n):this.sceneService.on(t,n)}},{key:"once",value:function(t,n){ky.indexOf(t)===-1?this.mapService.once(t,n):this.sceneService.once(t,n)}},{key:"off",value:function(t,n){ky.indexOf(t)===-1?this.mapService.off(t,n):this.sceneService.off(t,n)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(t){return this.mapService.getCenter(t)}},{key:"setCenter",value:function(t,n){return this.mapService.setCenter(t,n)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(t){return this.mapService.setPitch(t)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(t){this.mapService.setRotation(t)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(t){this.mapService.panTo(t)}},{key:"panBy",value:function(t,n){this.mapService.panBy(t,n)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(t){this.mapService.setZoom(t)}},{key:"fitBounds",value:function(t,n){var i=this.sceneService.getSceneConfig(),s=i.fitBoundsOptions,c=i.animate;this.mapService.fitBounds(t,n||Cx(Cx({},s),{},{animate:c}))}},{key:"setZoomAndCenter",value:function(t,n){this.mapService.setZoomAndCenter(t,n)}},{key:"setMapStyle",value:function(t){this.mapService.setMapStyle(t)}},{key:"setMapStatus",value:function(t){this.mapService.setMapStatus(t)}},{key:"pixelToLngLat",value:function(t){return this.mapService.pixelToLngLat(t)}},{key:"lngLatToPixel",value:function(t){return this.mapService.lngLatToPixel(t)}},{key:"containerToLngLat",value:function(t){return this.mapService.containerToLngLat(t)}},{key:"lngLatToContainer",value:function(t){return this.mapService.lngLatToContainer(t)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(t,n){this.container.bind(sr.IPostProcessingPass).to(t).whenTargetNamed(n)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(t){this.controlService.init({container:j.getContainer(t)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var t=this.sceneService.getSceneConfig(),n=t.logoVisible,i=t.logoPosition;n&&this.addControl(new sx({position:i}))}}]),e}(),IT=M("GoyQ"),tf=M.n(IT),Ax,Tx,Mx,Fy,Px;function Ox(e){return e.map(function(r){return typeof r=="string"&&(r=[r,{}]),r})}var RT=(Ax=Object(Cr.injectable)(),Tx=Object(Cr.inject)(sr.IGlobalConfigService),Ax(Mx=(Fy=function(){function e(){Ft()(this,e),Di()(this,"configService",Px,this),w()(this,"enabled",void 0)}return Yt()(e,[{key:"apply",value:function(t,n){var i=this,s=n.rendererService,c=n.postProcessingPassFactory,g=n.normalPassFactory;t.hooks.init.tap("MultiPassRendererPlugin",function(){var y=t.getLayerConfig(),E=y.enableMultiPassRenderer,T=y.passes,I=T===void 0?[]:T;i.enabled=!!E&&t.getLayerConfig().enableMultiPassRenderer!==!1,i.enabled&&(t.multiPassRenderer=i.createMultiPassRenderer(t,I,c,g),t.multiPassRenderer.setRenderFlag(!0))}),t.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(i.enabled){var y=s.getViewportSize(),E=y.width,T=y.height;t.multiPassRenderer.resize(E,T)}})}},{key:"createMultiPassRenderer",value:function(t,n,i,s){var c=t.multiPassRenderer,g=t.getLayerConfig(),y=g.enablePicking,E=g.enableTAA;return E?c.add(s("taa")):c.add(s("render")),Ox(n).forEach(function(T){var I=Ei()(T,2),F=I[0],U=I[1];c.add(i(F),U)}),c.add(i("copy")),c}}]),e}(),Px=Vi()(Fy.prototype,"configService",[Tx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fy))||Mx),Jd,Ix=(Jd={},w()(Jd,Gh.additive,{enable:!0,func:{srcRGB:ve.ONE,dstRGB:ve.ONE,srcAlpha:1,dstAlpha:1}}),w()(Jd,Gh.none,{enable:!1}),w()(Jd,Gh.normal,{enable:!0,func:{srcRGB:ve.SRC_ALPHA,dstRGB:ve.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),w()(Jd,Gh.subtractive,{enable:!0,func:{srcRGB:ve.ONE,dstRGB:ve.ONE,srcAlpha:ve.ZERO,dstAlpha:ve.ONE_MINUS_SRC_COLOR},equation:{rgb:ve.FUNC_SUBTRACT,alpha:ve.FUNC_SUBTRACT}}),w()(Jd,Gh.max,{enable:!0,func:{srcRGB:ve.ONE,dstRGB:ve.ONE},equation:{rgb:ve.MAX_EXT}}),w()(Jd,Gh.min,{enable:!0,func:{srcRGB:ve.ONE,dstRGB:ve.ONE},equation:{rgb:ve.MIN_EXT}}),Jd),LT=M("UB5X"),Ro=M.n(LT),kT=M("Z0cm"),Fv=M.n(kT),iF=1024;function Cf(e,r,t,n,i){r.updateStyleAttribute(e,t,n,i)}function DT(e,r){e.opacity&&ag("opacity",r,e.opacity),e.strokeWidth&&ag("strokeWidth",r,e.strokeWidth),e.strokeOpacity&&ag("strokeOpacity",r,e.strokeOpacity),e.stroke&&FT("stroke",r,e.stroke),e.offsets&&Rx("offsets",r,e.offsets),e.textOffset&&Rx("textOffset",r,e.textOffset),e.thetaOffset&&ag("thetaOffset",r,e.thetaOffset)}function ag(e,r,t){ho()(t)?Cf(e,r,t,function(n){return n}):Ro()(t)?Cf(e,r,[t],void 0):Fv()(t)&&t.length===2?ho()(t[0])&&Su()(t[1])||ho()(t[0])&&Fv()(t[1])&&Ro()(t[1][0])&&Ro()(t[1][1])?Cf(e,r,t[0],t[1]):Cf(e,r,[1],void 0):Cf(e,r,[1],void 0)}function Rx(e,r,t){ho()(t)?Cf(e,r,t,function(n){return n}):Fv()(t)&&t.length===2&&ho()(t[0])&&Su()(t[1])?Cf(e,r,t[0],t[1]):Fv()(t)&&t.length===2&&Ro()(t[0])&&Ro()(t[1])?Cf(e,r,t,void 0):Cf(e,r,[0,0],void 0)}function FT(e,r,t){ho()(t)?Cf(e,r,t,void 0):Fv()(t)&&t.length===2&&(ho()(t[0])&&Su()(t[1])||ho()(t[0])&&Fv()(t[1])&&t[1].length>0)?Cf(e,r,t[0],t[1]):Cf(e,r,"#fff",void 0)}var BT=[["circle","cylinder"],["square","cylinder"],["triangle","cylinder"],["pentagon","cylinder"],["hexagon","cylinder"],["octogon","cylinder"],["hexagram","cylinder"],["rhombus","cylinder"],["vesica","cylinder"]];function NT(e,r,t){typeof r=="string"&&typeof t=="string"&&r!==t&&BT.map(function(n){n.includes(r)&&n.includes(t)&&(e.dataState.dataSourceNeedUpdate=!0)})}var zT=["passes"],UT=["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber"],Lx,By,kx;function jT(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=VT(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function VT(e,r){if(!!e){if(typeof e=="string")return Dx(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Dx(e,r)}}function Dx(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Fx(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function rf(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Fx(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Fx(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function GT(e){var r=HT();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function HT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Bx=0,Bv=(Lx=Ly(sr.IGlobalConfigService),By=function(e){qr()(t,e);var r=GT(t);function t(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ft()(this,t),n=r.call(this),w()(ce()(n),"id","".concat(Bx++)),w()(ce()(n),"name","".concat(Bx)),w()(ce()(n),"type",void 0),w()(ce()(n),"visible",!0),w()(ce()(n),"zIndex",0),w()(ce()(n),"minZoom",void 0),w()(ce()(n),"maxZoom",void 0),w()(ce()(n),"inited",!1),w()(ce()(n),"layerModelNeedUpdate",!1),w()(ce()(n),"pickedFeatureID",null),w()(ce()(n),"selectedFeatureID",null),w()(ce()(n),"styleNeedUpdate",!1),w()(ce()(n),"rendering",void 0),w()(ce()(n),"clusterZoom",0),w()(ce()(n),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),w()(ce()(n),"hooks",{init:new Es.b,afterInit:new Es.b,beforeRender:new Es.b,beforeRenderData:new Es.d,afterRender:new Es.c,beforePickingEncode:new Es.c,afterPickingEncode:new Es.c,beforeHighlight:new Es.c(["pickedColor"]),afterHighlight:new Es.c,beforeSelect:new Es.c(["pickedColor"]),afterSelect:new Es.c,beforeDestroy:new Es.c,afterDestroy:new Es.c}),w()(ce()(n),"models",[]),w()(ce()(n),"multiPassRenderer",void 0),w()(ce()(n),"plugins",void 0),w()(ce()(n),"sourceOption",void 0),w()(ce()(n),"layerModel",void 0),w()(ce()(n),"sceneContainer",void 0),w()(ce()(n),"layerChildren",[]),Di()(ce()(n),"configService",kx,ce()(n)),w()(ce()(n),"shaderModuleService",void 0),w()(ce()(n),"cameraService",void 0),w()(ce()(n),"coordinateService",void 0),w()(ce()(n),"iconService",void 0),w()(ce()(n),"fontService",void 0),w()(ce()(n),"pickingService",void 0),w()(ce()(n),"rendererService",void 0),w()(ce()(n),"layerService",void 0),w()(ce()(n),"interactionService",void 0),w()(ce()(n),"mapService",void 0),w()(ce()(n),"styleAttributeService",void 0),w()(ce()(n),"layerSource",void 0),w()(ce()(n),"postProcessingPassFactory",void 0),w()(ce()(n),"normalPassFactory",void 0),w()(ce()(n),"animateOptions",{enable:!1}),w()(ce()(n),"container",void 0),w()(ce()(n),"encodedData",void 0),w()(ce()(n),"configSchema",void 0),w()(ce()(n),"currentPickId",null),w()(ce()(n),"rawConfig",void 0),w()(ce()(n),"needUpdateConfig",void 0),w()(ce()(n),"pendingStyleAttributes",[]),w()(ce()(n),"scaleOptions",{}),w()(ce()(n),"animateStartTime",void 0),w()(ce()(n),"aniamateStatus",!1),w()(ce()(n),"bottomColor","rgba(0, 0, 0, 0)"),w()(ce()(n),"isDestroied",!1),w()(ce()(n),"sourceEvent",function(){n.dataState.dataSourceNeedUpdate=!0;var s=n.getLayerConfig(),c=s.autoFit,g=s.fitBoundsOptions;c&&n.fitBounds(g),n.emit("dataUpdate"),n.reRender()}),n.name=i.name||n.id,n.zIndex=i.zIndex||0,n.rawConfig=i,n}return Yt()(t,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(i){if(!this.inited)this.needUpdateConfig=rf(rf({},this.needUpdateConfig),i);else{var s=this.container.get(sr.SceneID);DT(i,this),this.configService.setLayerConfig(s,this.id,rf(rf(rf({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),i)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(i,s){this.container=i,this.sceneContainer=s}},{key:"getContainer",value:function(){return this.container}},{key:"setBottomColor",value:function(i){this.bottomColor=i}},{key:"getBottomColor",value:function(){return this.bottomColor}},{key:"addPlugin",value:function(i){return this.plugins.push(i),this}},{key:"init",value:function(){var i=this,s=this.container.get(sr.SceneID);this.configService.setLayerConfig(s,this.id,this.rawConfig),this.iconService=this.container.get(sr.IIconService),this.fontService=this.container.get(sr.IFontService),this.rendererService=this.container.get(sr.IRendererService),this.layerService=this.container.get(sr.ILayerService),this.interactionService=this.container.get(sr.IInteractionService),this.pickingService=this.container.get(sr.IPickingService),this.mapService=this.container.get(sr.IMapService),this.cameraService=this.container.get(sr.ICameraService),this.coordinateService=this.container.get(sr.ICoordinateSystemService),this.shaderModuleService=this.container.get(sr.IShaderModuleService),this.postProcessingPassFactory=this.container.get(sr.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(sr.IFactoryNormalPass),this.styleAttributeService=this.container.get(sr.IStyleAttributeService),this.multiPassRenderer=this.container.get(sr.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(E){var T=E.attributeName,I=E.attributeField,F=E.attributeValues,U=E.updateOptions;i.styleAttributeService.updateStyleAttribute(T,{scale:rf({field:I},i.splitValuesAndCallbackInAttribute(F,i.getLayerConfig()[T]))},U)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(sr.ILayerPlugin);var c=jT(this.plugins),g;try{for(c.s();!(g=c.n()).done;){var y=g.value;y.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(E){c.e(E)}finally{c.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(rf(rf({},this.getDefaultConfig()),this.rawConfig));var i=this.getLayerConfig(),s=i.animateOption;s!=null&&s.enable&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(i,s,c){return this.updateStyleAttribute("color",i,s,c),this}},{key:"texture",value:function(i,s,c){return this.updateStyleAttribute("texture",i,s,c),this}},{key:"rotate",value:function(i,s,c){return this.updateStyleAttribute("rotate",i,s,c),this}},{key:"size",value:function(i,s,c){return this.updateStyleAttribute("size",i,s,c),this}},{key:"filter",value:function(i,s,c){return this.updateStyleAttribute("filter",i,s,c),this}},{key:"shape",value:function(i,s,c){var g,y,E,T=(g=this.styleAttributeService)===null||g===void 0||(y=g.getLayerStyleAttribute("shape"))===null||y===void 0||(E=y.scale)===null||E===void 0?void 0:E.field,I=i;return this.updateStyleAttribute("shape",i,s,c),NT(this,T,I),this}},{key:"label",value:function(i,s,c){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:i,attributeValues:s,updateOptions:c}),this}},{key:"animate",value:function(i){var s={};return tf()(i)?(s.enable=!0,s=rf(rf({},s),i)):s.enable=i,this.updateLayerConfig({animateOption:s}),this}},{key:"source",value:function(i,s){return i!=null&&i.data?(this.setSource(i),this):(this.sourceOption={data:i,options:s},this.clusterZoom=0,this)}},{key:"setData",value:function(i,s){var c=this;return this.inited?this.layerSource.setData(i,s):this.on("inited",function(){c.layerSource.setData(i,s)}),this}},{key:"style",value:function(i){var s=this,c=i.passes,g=xp()(i,zT);return c&&Ox(c).forEach(function(y){var E=s.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(y[0]);E&&E.updateOptions(y[1])}),this.rawConfig=rf(rf({},this.rawConfig),g),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(i,s){return tf()(i)?this.scaleOptions=rf(rf({},this.scaleOptions),i):this.scaleOptions[i]=s,this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return this.getEncodedData().length!==0&&this.renderModels(),this}},{key:"renderMultiPass",value:function(){var n=tu()(Na.a.mark(function s(){return Na.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.getEncodedData().length===0){g.next=7;break}if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){g.next=6;break}return g.next=4,this.multiPassRenderer.render();case 4:g.next=7;break;case 6:this.multiPassRenderer?this.renderModels():this.renderModels();case 7:case"end":return g.stop()}},s,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"active",value:function(i){var s={};return s.enableHighlight=tf()(i)?!0:i,tf()(i)?(s.enableHighlight=!0,i.color&&(s.highlightColor=i.color),i.mix&&(s.activeMix=i.mix)):s.enableHighlight=!!i,this.updateLayerConfig(s),this}},{key:"setActive",value:function(i,s){var c=this;if(tf()(i)){var g=i.x,y=g===void 0?0:g,E=i.y,T=E===void 0?0:E;this.updateLayerConfig({highlightColor:tf()(s)?s.color:this.getLayerConfig().highlightColor,activeMix:tf()(s)?s.mix:this.getLayerConfig().activeMix}),this.pick({x:y,y:T})}else this.updateLayerConfig({pickedFeatureID:i,highlightColor:tf()(s)?s.color:this.getLayerConfig().highlightColor,activeMix:tf()(s)?s.mix:this.getLayerConfig().activeMix}),this.hooks.beforeSelect.call(An(i)).then(function(){setTimeout(function(){c.reRender()},1)})}},{key:"select",value:function(i){var s={};return s.enableSelect=tf()(i)?!0:i,tf()(i)?(s.enableSelect=!0,i.color&&(s.selectColor=i.color),i.mix&&(s.selectMix=i.mix)):s.enableSelect=!!i,this.updateLayerConfig(s),this}},{key:"setSelect",value:function(i,s){var c=this;if(tf()(i)){var g=i.x,y=g===void 0?0:g,E=i.y,T=E===void 0?0:E;this.updateLayerConfig({selectColor:tf()(s)?s.color:this.getLayerConfig().selectColor,selectMix:tf()(s)?s.mix:this.getLayerConfig().selectMix}),this.pick({x:y,y:T})}else this.updateLayerConfig({pickedFeatureID:i,selectColor:tf()(s)?s.color:this.getLayerConfig().selectColor,selectMix:tf()(s)?s.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(An(i)).then(function(){setTimeout(function(){c.reRender()},1)})}},{key:"setBlend",value:function(i){this.updateLayerConfig({blend:i}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(i){return this.zIndex=i,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(i){this.currentPickId=i}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(i){this.selectedFeatureID=i}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var i=this.mapService.getZoom(),s=this.getLayerConfig(),c=s.visible,g=s.minZoom,y=g===void 0?-Infinity:g,E=s.maxZoom,T=E===void 0?Infinity:E;return!!c&&i>=y&&i<=T}},{key:"setMinZoom",value:function(i){return this.updateLayerConfig({minZoom:i}),this}},{key:"getMinZoom",value:function(){var i=this.getLayerConfig(),s=i.minZoom;return s}},{key:"getMaxZoom",value:function(){var i=this.getLayerConfig(),s=i.maxZoom;return s}},{key:"get",value:function(i){var s=this.getLayerConfig();return s[i]}},{key:"setMaxZoom",value:function(i){return this.updateLayerConfig({maxZoom:i}),this}},{key:"fitBounds",value:function(i){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var s=this.getSource(),c=s.extent,g=c.some(function(y){return Math.abs(y)===Infinity});return g?this:(this.mapService.fitBounds([[c[0],c[1]],[c[2],c[3]]],i),this)}},{key:"destroy",value:function(){this.isDestroied||(this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.models=[],this.layerService.cleanRemove(this),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroied=!0)}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(i){return i.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(i){return i.needRescale||i.needRemapping||i.needRegenerateVertices}).length}},{key:"setSource",value:function(i){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=i,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var s=this.mapService.getZoom();this.layerSource.updateClusterData(s)}this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(i){this.encodedData=i}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(i){return this.styleAttributeService.getLayerAttributeScale(i)}},{key:"getLegendItems",value:function(i){var s=this.styleAttributeService.getLayerAttributeScale(i);if(s){if(s.ticks){var c=s.ticks().map(function(E){return w()({value:E},i,s(E))});return c}else if(s.invertExtent){var g=s.range().map(function(E){return w()({value:s.invertExtent(E)},i,E)});return g}else if(s!=null&&s.domain){var y=s.domain().map(function(E){return{value:E||"\u65E0",color:s(E)}});return y}}else return[]}},{key:"pick",value:function(i){var s=i.x,c=i.y;this.interactionService.triggerHover({x:s,y:c})}},{key:"boxSelect",value:function(i,s){this.pickingService.boxPickLayer(this,i,s)}},{key:"buildLayerModel",value:function(i){var s=i.moduleName,c=i.vertexShader,g=i.fragmentShader,y=i.triangulation,E=i.segmentNumber,T=xp()(i,UT);this.shaderModuleService.registerModule(s,{vs:c,fs:g});var I=this.shaderModuleService.getModule(s),F=I.vs,U=I.fs,Q=I.uniforms,ue=this.rendererService.createModel,de=this.styleAttributeService.createAttributesAndIndices(this.encodedData,y,E),Re=de.attributes,et=de.elements;return ue(rf({attributes:Re,uniforms:Q,fs:U,vs:F,elements:et,blend:Ix[Gh.normal]},T))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(i){var s=this.getLayerConfig(),c=s.enableHighlight,g=c===void 0?!0:c,y=s.enableSelect,E=y===void 0?!0:y,T=this.eventNames().indexOf(i)!==-1||this.eventNames().indexOf("un"+i)!==-1;return(i==="click"||i==="dblclick")&&E&&(T=!0),i==="mousemove"&&(g||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(T=!0),this.isVisible()&&T}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderMulPass",value:function(){var n=tu()(Na.a.mark(function s(c){return Na.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,c.render();case 2:case"end":return y.stop()}},s)}));function i(s){return n.apply(this,arguments)}return i}()},{key:"renderModels",value:function(i){var s=this;return this.getEncodedData().length>0&&(this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(c){c.draw({uniforms:s.layerModel.getUninforms()},i)})),this}},{key:"updateStyleAttribute",value:function(i,s,c,g){this.inited?this.styleAttributeService.updateStyleAttribute(i,{scale:rf({field:s},this.splitValuesAndCallbackInAttribute(c,this.getLayerConfig()[s]))},g):this.pendingStyleAttributes.push({attributeName:i,attributeField:s,attributeValues:c,updateOptions:g})}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(i){console.warn("empty fn")}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&(this.layerService.updateLayerRenderList(),this.layerService.renderLayers())}},{key:"splitValuesAndCallbackInAttribute",value:function(i,s){return{values:Su()(i)?void 0:i||s,callback:Su()(i)?i:void 0}}}]),t}(Lu.EventEmitter),kx=Vi()(By.prototype,"configService",[Lx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),By),WT=M("Y+p1"),ym=M.n(WT),Nx,Ny,zx;function ZT(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=XT(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function XT(e,r){if(!!e){if(typeof e=="string")return Ux(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ux(e,r)}}function Ux(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Ju=(Nx=Ly(sr.IGlobalConfigService),Ny=function(){function e(r){Ft()(this,e),w()(this,"triangulation",void 0),w()(this,"createTexture2D",void 0),w()(this,"layer",void 0),w()(this,"dataTexture",void 0),w()(this,"DATA_TEXTURE_WIDTH",void 0),w()(this,"rowCount",void 0),w()(this,"cacheStyleProperties",void 0),w()(this,"cellLength",void 0),w()(this,"cellProperties",void 0),w()(this,"cellTypeLayout",void 0),w()(this,"stylePropertyesExist",void 0),w()(this,"dataTextureTest",void 0),Di()(this,"configService",zx,this),w()(this,"shaderModuleService",void 0),w()(this,"rendererService",void 0),w()(this,"iconService",void 0),w()(this,"fontService",void 0),w()(this,"styleAttributeService",void 0),w()(this,"mapService",void 0),w()(this,"cameraService",void 0),w()(this,"layerService",void 0),this.layer=r,this.rendererService=r.getContainer().get(sr.IRendererService),this.shaderModuleService=r.getContainer().get(sr.IShaderModuleService),this.styleAttributeService=r.getContainer().get(sr.IStyleAttributeService),this.mapService=r.getContainer().get(sr.IMapService),this.iconService=r.getContainer().get(sr.IIconService),this.fontService=r.getContainer().get(sr.IFontService),this.cameraService=r.getContainer().get(sr.ICameraService),this.layerService=r.getContainer().get(sr.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate();var t=this.rendererService.createTexture2D;this.createTexture2D=t,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={thetaOffset:void 0,opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertyesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new Uint8ClampedArray(4),mag:ve.NEAREST,min:ve.NEAREST,width:1,height:1}))}return Yt()(e,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertyesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertyesExist.hasOpacity,this.stylePropertyesExist.hasStrokeOpacity,this.stylePropertyesExist.hasStrokeWidth,this.stylePropertyesExist.hasStroke,this.stylePropertyesExist.hasOffsets,this.stylePropertyesExist.hasThetaOffset,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(t){var n=!1;return ym()(t.thetaOffset,this.cacheStyleProperties.thetaOffset)||(n=!0,this.cacheStyleProperties.thetaOffset=t.thetaOffset),ym()(t.opacity,this.cacheStyleProperties.opacity)||(n=!0,this.cacheStyleProperties.opacity=t.opacity),ym()(t.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(n=!0,this.cacheStyleProperties.strokeOpacity=t.strokeOpacity),ym()(t.strokeWidth,this.cacheStyleProperties.strokeWidth)||(n=!0,this.cacheStyleProperties.strokeWidth=t.strokeWidth),ym()(t.stroke,this.cacheStyleProperties.stroke)||(n=!0,this.cacheStyleProperties.stroke=t.stroke),ym()(t.offsets,this.cacheStyleProperties.offsets)||(n=!0,this.cacheStyleProperties.offsets=t.offsets),this.dataTexture===void 0&&(n=!0),n}},{key:"judgeStyleAttributes",value:function(t){this.clearLastCalRes(),t.opacity!==void 0&&!Ro()(t.opacity)&&(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertyesExist.hasOpacity=1,this.cellLength+=1),t.strokeOpacity!==void 0&&!Ro()(t.strokeOpacity)&&(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertyesExist.hasStrokeOpacity=1,this.cellLength+=1),t.strokeWidth!==void 0&&!Ro()(t.strokeWidth)&&(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertyesExist.hasStrokeWidth=1,this.cellLength+=1),t.stroke!==void 0&&!this.isStaticColor(t.stroke)&&(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertyesExist.hasStroke=1,this.cellLength+=4),t.offsets!==void 0&&!this.isOffsetStatic(t.offsets)&&(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertyesExist.hasOffsets=1,this.cellLength+=2),t.thetaOffset!==void 0&&!Ro()(t.thetaOffset)&&(this.cellProperties.push({attr:"thetaOffset",count:1}),this.stylePropertyesExist.hasThetaOffset=1,this.cellLength+=1)}},{key:"isStaticColor",value:function(t){return ho()(t)?!!re(t):!1}},{key:"getStrokeColor",value:function(t){if(this.isStaticColor(t)){var n=Dr(t);return n[0]=n[0]?n[0]:0,n[1]=n[1]?n[1]:0,n[2]=n[2]?n[2]:0,n[3]=n[3]?n[3]:0,n}else return[0,0,0,0]}},{key:"isOffsetStatic",value:function(t){return!!(Fv()(t)&&t.length===2&&Ro()(t[0])&&Ro()(t[1]))}},{key:"patchMod",value:function(t,n){for(var i=0;i<n;i++)t.push(-1)}},{key:"patchData",value:function(t,n,i){var s=ZT(i),c;try{for(s.s();!(c=s.n()).done;){var g=c.value,y=g.attr,E=g.count,T=n[y];T!==void 0?y==="stroke"?t.push.apply(t,Ut()(Dr(T))):y==="offsets"?this.isOffsetStatic(T)?t.push(-T[0],T[1]):t.push(0,0):t.push(Ro()(T)?T:1):this.patchMod(t,E)}}catch(I){s.e(I)}finally{s.f()}}},{key:"calDataFrame",value:function(t,n,i){for(var s=n.length,c=Math.ceil(s*t/this.DATA_TEXTURE_WIDTH),g=c*this.DATA_TEXTURE_WIDTH,y=[],E=0;E<s;E++){var T=n[E];this.patchData(y,T,i)}for(var I=y.length;I<g;I++)y.push(-1);return{data:y,width:this.DATA_TEXTURE_WIDTH,height:c}}},{key:"getBlend",value:function(){var t=this.layer.getLayerConfig(),n=t.blend,i=n===void 0?"normal":n;return Ix[Gh[i]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.duration||4,t.interval||.2,t.trailLength||.1]}},{key:"startModelAnimate",value:function(){var t=this.layer.getLayerConfig(),n=t.animateOption;n.enable&&this.layer.setAnimateStartTime()}}]),e}(),zx=Vi()(Ny.prototype,"configService",[Nx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ny),YT=M("VmRL"),Zp=M.n(YT),og=100,jx=36,KT=40;function Vx(e){return e/180*Math.acos(-1)}function Gx(e){var r=Vx(e[0])+Math.PI/2,t=Vx(e[1]),n=og+Math.random()*.4,i=n*Math.cos(t)*Math.cos(r),s=n*Math.cos(t)*Math.sin(r),c=n*Math.sin(t);return[s,c,i]}function Hx(e,r){var t=k.create(),n=k.create(),i=V.fromValues(0,1,0),s=V.fromValues(0,0,0);r=r||{},e=typeof e!="undefined"?e:1;for(var c=typeof r.segments!="undefined"?r.segments:32,g=2+c,y=2*g,E=[],T=[],I=[],F=[],U=[],Q=[],ue=0;ue<=g;ue++){for(var de=ue/g,Re=de*Math.PI,et=0;et<=y;et++){var ht=et/y,xt=ht*Math.PI*2;k.identity(n),k.rotateZ(n,n,-Re),k.identity(t),k.rotateY(t,t,xt),V.transformMat4(s,i,n),V.transformMat4(s,s,t),V.scale(s,s,-e),I.push(s.slice()),F.push.apply(F,Ut()(s.slice())),V.normalize(s,s),U.push.apply(U,Ut()(s.slice())),Q.push([ht,1-de]),F.push(ht,1-de)}if(ue>0)for(var Gt=I.length,jt=Gt-2*(y+1);jt+y+2<Gt;jt++)E.push([jt,jt+1,jt+y+1]),T.push(jt,jt+1,jt+y+1),E.push([jt+y+1,jt+1,jt+y+2]),T.push(jt+y+1,jt+1,jt+y+2)}return{cells:E,positions:I,uvs:Q,positionsArr:F,indicesArr:T,normalArr:U}}var sg=h.create(),aF=h.create(),Dl=h.create(),ev=h.create(),_m=h.create();function zy(e,r,t,n,i){h.add(e,t,n),h.normalize(e,e),r=h.fromValues(-e[1],e[0]);var s=h.fromValues(-t[1],t[0]);return[i/h.dot(r,s),r]}function tv(e,r){return h.set(e,-r[1],r[0])}function xm(e,r,t){return h.sub(e,r,t),h.normalize(e,e),e}function Uy(e,r){return e[0]===r[0]&&e[1]===r[1]}function oF(e){for(var r=new Map,t=0;t<e.length;t++){var n=e[0].toString()+"-"+e[1].toString();r.get(n)?(e.splice(t,1),t++):r.set(n,n)}return e}var Wx=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ft()(this,e),w()(this,"complex",void 0),w()(this,"join",void 0),w()(this,"cap",void 0),w()(this,"miterLimit",void 0),w()(this,"thickness",void 0),w()(this,"normal",void 0),w()(this,"lastFlip",-1),w()(this,"miter",h.fromValues(0,0)),w()(this,"started",!1),w()(this,"dash",!1),w()(this,"totalDistance",0),this.join=r.join||"miter",this.cap=r.cap||"butt",this.miterLimit=r.miterLimit||10,this.thickness=r.thickness||1,this.dash=r.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return Yt()(e,[{key:"extrude_gaode2",value:function(t,n){var i=this.complex;if(t.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var s=t.length,c=i.startIndex,g=1;g<s;g++){var y,E,T,I=t[g-1];I.push((y=n[g-1][2])!==null&&y!==void 0?y:0);var F=n[g-1],U=t[g];U.push((E=n[g][2])!==null&&E!==void 0?E:0);var Q=n[g],ue=g<t.length-1?[].concat(Ut()(t[g+1]),[(T=n[g+1][2])!==null&&T!==void 0?T:0]):null,de=g<n.length-1?n[g+1]:null,Re=this.segment_gaode2(i,c,I,U,ue,F,Q,de);c+=Re}if(this.dash)for(var et=0;et<i.positions.length/6;et++)i.positions[et*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"simpleExtrude_gaode2",value:function(t,n){var i=this.complex;if(t.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var s=t.length,c=i.startIndex,g=1;g<s;g++){var y,E,T,I=t[g-1];I.push((y=n[g-1][2])!==null&&y!==void 0?y:0);var F=n[g-1],U=t[g];U.push((E=n[g][2])!==null&&E!==void 0?E:0);var Q=n[g],ue=g<t.length-1?[].concat(Ut()(t[g+1]),[(T=n[g+1][2])!==null&&T!==void 0?T:0]):null,de=g<n.length-1?n[g+1]:null,Re=this.simpleSegment(i,c,I,U,ue,F,Q,de);c+=Re}if(this.dash)for(var et=0;et<i.positions.length/6;et++)i.positions[et*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"extrude",value:function(t){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=t.length,s=n.startIndex,c=1;c<i;c++){var g=t[c-1],y=t[c],E=c<t.length-1?t[c+1]:null,T=this.segment(n,s,g,y,E);s+=T}if(this.dash)for(var I=0;I<n.positions.length/6;I++)n.positions[I*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude",value:function(t){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=t.length,s=n.startIndex,c=1;c<i;c++){var g=t[c-1],y=t[c],E=c<t.length-1?t[c+1]:null,T=this.simpleSegment(n,s,g,y,E);s+=T}if(this.dash)for(var I=0;I<n.positions.length/6;I++)n.positions[I*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"segment_gaode2",value:function(t,n,i,s,c,g,y,E){var T=0,I=t.indices,F=t.positions,U=t.normals,Q=this.cap==="square",ue=this.join==="bevel",de=vs([y[0],y[1]]),Re=vs([g[0],g[1]]);xm(Dl,s,i);var et=0;if(this.dash&&(et=this.lineSegmentDistance(de,Re),this.totalDistance+=et),this.normal||(this.normal=h.create(),tv(this.normal,Dl)),!this.started)if(this.started=!0,Q){var ht=h.create(),xt=h.create();h.add(ht,this.normal,Dl),h.add(xt,this.normal,Dl),U.push(xt[0],xt[1],0),U.push(ht[0],ht[1],0),F.push(i[0],i[1],i[2]|0,this.totalDistance-et,-this.thickness,i[2]|0),F.push(i[0],i[1],i[2]|0,this.totalDistance-et,this.thickness,i[2]|0)}else this.extrusions(F,U,i,this.normal,this.thickness,this.totalDistance-et);if(I.push(n+0,n+1,n+2),c){Uy(s,c)&&h.add(c,s,h.normalize(c,h.subtract(c,s,i))),xm(ev,c,s);var Qt=zy(_m,h.create(),Dl,ev,this.thickness),fr=Ei()(Qt,2),Gr=fr[0],Jr=fr[1],Ur=h.dot(_m,this.normal)<0?-1:1,Xn=ue;if(!Xn&&this.join==="miter"){var ni=Gr;ni>this.miterLimit&&(Xn=!0)}Xn?(U.push(this.normal[0],this.normal[1],0),U.push(Jr[0],Jr[1],0),F.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*Ur,s[2]|0),F.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness*Ur,s[2]|0),I.push.apply(I,Ut()(this.lastFlip!==-Ur?[n,n+2,n+3]:[n+2,n+1,n+3])),I.push(n+2,n+3,n+4),tv(sg,ev),h.copy(this.normal,sg),U.push(this.normal[0],this.normal[1],0),F.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*Ur,s[2]|0),T+=3):(this.extrusions(F,U,s,Jr,Gr,this.totalDistance),I.push.apply(I,Ut()(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),Ur=-1,h.copy(this.normal,Jr),T+=2),this.lastFlip=Ur}else{if(tv(this.normal,Dl),Q){var Gt=h.create(),jt=h.create();h.sub(jt,Dl,this.normal),h.add(Gt,Dl,this.normal),U.push(jt[0],jt[1],0),U.push(Gt[0],Gt[1],0),F.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0),F.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0)}else this.extrusions(F,U,s,this.normal,this.thickness,this.totalDistance);I.push.apply(I,Ut()(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),T+=2}return T}},{key:"simpleSegment",value:function(t,n,i,s,c){var g=0,y=t.indices,E=t.positions,T=t.normals,I=vs([s[0],s[1]]),F=vs([i[0],i[1]]);xm(Dl,I,F);var U=0;if(this.dash&&(U=this.lineSegmentDistance(I,F),this.totalDistance+=U),this.normal||(this.normal=h.create(),tv(this.normal,Dl)),this.started||(this.started=!0,this.extrusions(E,T,i,this.normal,this.thickness,this.totalDistance-U)),y.push(n+0,n+1,n+2),!c)tv(this.normal,Dl),this.extrusions(E,T,s,this.normal,this.thickness,this.totalDistance),y.push.apply(y,Ut()(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),g+=2;else{var Q=vs([c[0],c[1]]);Uy(I,Q)&&h.add(Q,I,h.normalize(Q,h.subtract(Q,I,F))),xm(ev,Q,I);var ue=zy(_m,h.create(),Dl,ev,this.thickness),de=Ei()(ue,2),Re=de[0],et=de[1],ht=h.dot(_m,this.normal)<0?-1:1;this.extrusions(E,T,s,et,Re,this.totalDistance),y.push.apply(y,Ut()(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),ht=-1,h.copy(this.normal,et),g+=2,this.lastFlip=ht}return g}},{key:"segment",value:function(t,n,i,s,c){var g=0,y=t.indices,E=t.positions,T=t.normals,I=this.cap==="square",F=this.join==="bevel",U=vs([s[0],s[1]]),Q=vs([i[0],i[1]]);xm(Dl,U,Q);var ue=0;if(this.dash&&(ue=this.lineSegmentDistance(U,Q),this.totalDistance+=ue),this.normal||(this.normal=h.create(),tv(this.normal,Dl)),!this.started)if(this.started=!0,I){var de=h.create(),Re=h.create();h.add(de,this.normal,Dl),h.add(Re,this.normal,Dl),T.push(Re[0],Re[1],0),T.push(de[0],de[1],0),E.push(i[0],i[1],i[2]|0,this.totalDistance-ue,-this.thickness,i[2]|0),E.push(i[0],i[1],i[2]|0,this.totalDistance-ue,this.thickness,i[2]|0)}else this.extrusions(E,T,i,this.normal,this.thickness,this.totalDistance-ue);if(y.push(n+0,n+1,n+2),c){var xt=vs([c[0],c[1]]);Uy(U,xt)&&h.add(xt,U,h.normalize(xt,h.subtract(xt,U,Q))),xm(ev,xt,U);var Gt=zy(_m,h.create(),Dl,ev,this.thickness),jt=Ei()(Gt,2),Qt=jt[0],fr=jt[1],Gr=h.dot(_m,this.normal)<0?-1:1,Jr=F;if(!Jr&&this.join==="miter"){var Ur=Qt;Ur>this.miterLimit&&(Jr=!0)}Jr?(T.push(this.normal[0],this.normal[1],0),T.push(fr[0],fr[1],0),E.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*Gr,s[2]|0),E.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness*Gr,s[2]|0),y.push.apply(y,Ut()(this.lastFlip!==-Gr?[n,n+2,n+3]:[n+2,n+1,n+3])),y.push(n+2,n+3,n+4),tv(sg,ev),h.copy(this.normal,sg),T.push(this.normal[0],this.normal[1],0),E.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*Gr,s[2]|0),g+=3):(this.extrusions(E,T,s,fr,Qt,this.totalDistance),y.push.apply(y,Ut()(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),Gr=-1,h.copy(this.normal,fr),g+=2),this.lastFlip=Gr}else{if(tv(this.normal,Dl),I){var et=h.create(),ht=h.create();h.sub(ht,Dl,this.normal),h.add(et,Dl,this.normal),T.push(ht[0],ht[1],0),T.push(et[0],et[1],0),E.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0),E.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0)}else this.extrusions(E,T,s,this.normal,this.thickness,this.totalDistance);y.push.apply(y,Ut()(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),g+=2}return g}},{key:"extrusions",value:function(t,n,i,s,c,g){n.push(s[0],s[1],0),n.push(s[0],s[1],0),t.push(i[0],i[1],i[2]|0,g,-c,i[2]|0),t.push(i[0],i[1],i[2]|0,g,c,i[2]|0)}},{key:"lineSegmentDistance",value:function(t,n){var i=n[0]-t[0],s=n[1]-t[1];return Math.sqrt(i*i+s*s)}}]),e}();function Nv(e){if(Ro()(e[0]))return e;if(Ro()(e[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Ro()(e[0][0][0])){var r=e,t=0,n=0,i=0;return r.forEach(function(s){s.forEach(function(c){t+=c[0],n+=c[1],i++})}),[t/i,n/i,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function $T(e){for(var r=e[0],t=e[1],n=e[0],i=e[1],s=0,c=0,g=0,y=0;y<e.length;y+=2){var E=e[y],T=e[y+1];E&&T&&(r=Math.max(E,r),t=Math.max(T,t),n=Math.min(E,n),i=Math.min(T,i),s+=E,c+=T,g++)}return{center:[s/g,c/g],radius:Math.sqrt(Math.pow(r-n,2)+Math.pow(t-i,2))/2}}function qT(e){var r=e[0][0],t=e[0][e[0].length-1];r[0]===t[0]&&r[1]===t[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var n=e[0].length,i=Zp.a.flatten(e),s=i.vertices,c=i.dimensions,g=[],y=[],E=0;E<s.length/c;E++)c===2?g.push(s[E*2],s[E*2+1],1):g.push(s[E*3],s[E*3+1],1);var T=Zp()(i.vertices,i.holes,i.dimensions);y.push.apply(y,Ut()(T));for(var I=function(Q){var ue=i.vertices.slice(Q*c,(Q+1)*c),de=i.vertices.slice((Q+1)*c,(Q+2)*c);de.length===0&&(de=i.vertices.slice(0,c));var Re=g.length/3;g.push(ue[0],ue[1],1,de[0],de[1],1,ue[0],ue[1],0,de[0],de[1],0),y.push.apply(y,Ut()([0,2,1,2,3,1].map(function(et){return et+Re})))},F=0;F<n;F++)I(F);return{positions:g,index:y}}function QT(e){var r=Zp.a.flatten(e),t=Zp()(r.vertices,r.holes,r.dimensions);return{positions:r.vertices,index:t}}function Zx(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=e[0][0],n=e[0][e[0].length-1];t[0]===n[0]&&t[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var i=e[0].length,s=Zp.a.flatten(e),c=s.vertices,g=s.dimensions,y=[],E=[],T=[],I=0;I<c.length/g;I++)g===2?y.push(c[I*2],c[I*2+1],1,-1,-1):y.push(c[I*3],c[I*3+1],1,-1,-1),T.push(0,0,1);var F=Zp()(s.vertices,s.holes,s.dimensions);E.push.apply(E,Ut()(F));for(var U=function(de){var Re=s.vertices.slice(de*g,(de+1)*g),et=s.vertices.slice((de+1)*g,(de+2)*g);et.length===0&&(et=s.vertices.slice(0,g));var ht=y.length/5;y.push(Re[0],Re[1],1,0,0,et[0],et[1],1,.1,0,Re[0],Re[1],0,0,.8,et[0],et[1],0,.1,.8);var xt=JT([et[0],et[1],1],[Re[0],Re[1],0],[Re[0],Re[1],1],r);T.push.apply(T,Ut()(xt).concat(Ut()(xt),Ut()(xt),Ut()(xt))),E.push.apply(E,Ut()([1,2,0,3,2,1].map(function(Gt){return Gt+ht})))},Q=0;Q<i;Q++)U(Q);return{positions:y,index:E,normals:T}}function JT(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=V.create(),s=V.create(),c=V.create();n&&(e=ko(e),r=ko(r),t=ko(t));var g=V.fromValues.apply(V,Ut()(e)),y=V.fromValues.apply(V,Ut()(r)),E=V.fromValues.apply(V,Ut()(t));V.sub(i,E,y),V.sub(s,g,y),V.cross(c,i,s);var T=V.create();return V.normalize(T,c),T}var Wh,zv;(function(e){e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn"})(zv||(zv={}));var Uv;(function(e){e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon"})(Uv||(Uv={}));function t0(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=Math.PI*2/e,n=[],i=0;i<e;i++)n.push(t*i+r*Math.PI/12);var s=n.map(function(c){var g=Math.sin(c+Math.PI/4),y=Math.cos(c+Math.PI/4);return[g,y,0]});return s}function Xx(){return t0(30)}function Yx(){return t0(4)}function Kx(){return t0(3)}function $x(){return t0(6,1)}function qx(){return t0(5)}var bm=(Wh={},w()(Wh,Uv.CIRCLE,Xx),w()(Wh,Uv.HEXAGON,$x),w()(Wh,Uv.TRIANGLE,Kx),w()(Wh,Uv.SQUARE,Yx),w()(Wh,Uv.PENTAGON,qx),w()(Wh,zv.CYLINDER,Xx),w()(Wh,zv.HEXAGONCOLUMN,$x),w()(Wh,zv.TRIANGLECOLUMN,Kx),w()(Wh,zv.SQUARECOLUMN,Yx),w()(Wh,zv.PENTAGONCOLUMN,qx),Wh),ug={};function Qx(e){var r=Nv(e.coordinates);return{vertices:[].concat(Ut()(r),Ut()(r),Ut()(r),Ut()(r)),indices:[0,1,2,2,3,0],size:r.length}}function eM(e){var r=Nv(e.coordinates),t=Gx(r);return{vertices:[].concat(Ut()(t),Ut()(t),Ut()(t),Ut()(t)),indices:[0,1,2,2,3,0],size:t.length}}function Jx(e){var r=e.shape,t=oM(r,!1),n=t.positions,i=t.index,s=t.normals;return{vertices:n,indices:i,normals:s,size:5}}function eb(e){var r=Nv(e.coordinates);return{vertices:Ut()(r),indices:[0],size:r.length}}function tb(e){var r=e.coordinates,t=e.originCoordinates,n=e.version,i=new Wx({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var s=r;Array.isArray(s[0][0])||(s=[r]);var c=t;Array.isArray(c[0][0])||(c=[t]);for(var g=0;g<s.length;g++){var y=s[g],E=c[g];i.extrude_gaode2(y,E)}}else{var T=r;Array.isArray(T[0][0])||(T=[r]),T.forEach(function(F){i.extrude(F)})}var I=i.complex;return{vertices:I.positions,indices:I.indices,normals:I.normals,size:6}}function tM(e){var r=e.coordinates,t=e.originCoordinates,n=e.version,i=new Wx({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var s=r;Array.isArray(s[0][0])||(s=[r]);var c=t;Array.isArray(c[0][0])||(c=[t]);for(var g=0;g<s.length;g++){var y=s[g],E=c[g];i.simpleExtrude_gaode2(y,E)}}else{var T=r;Array.isArray(T[0][0])||(T=[r]),T.forEach(function(F){i.simpleExtrude(F)})}var I=i.complex;return{vertices:I.positions,indices:I.indices,normals:I.normals,size:6}}function rM(e){var r=e.coordinates,t=Zp.a.flatten(r),n=t.vertices,i=t.dimensions,s=t.holes;return{indices:Zp()(n,s,i),vertices:n,size:i}}function nM(e){var r=e.coordinates,t=Zp.a.flatten(r),n=t.vertices,i=t.dimensions,s=t.holes;return{indices:Zp()(n,s,i),vertices:iM(n),size:i+4}}function iM(e){for(var r=[],t=$T(e),n=t.center,i=t.radius,s=0;s<e.length;s+=2){var c=e[s],g=e[s+1];r.push.apply(r,[c,g,0].concat(Ut()(n),[i]))}return r}function rb(e){var r=e.coordinates,t=Zx(r,!0),n=t.positions,i=t.index,s=t.normals;return{vertices:n,indices:i,normals:s,size:5}}function nb(e){var r=e.shape,t=uM(r),n=t.positions,i=t.index;return{vertices:n,indices:i,size:3}}function ib(e){var r=e.coordinates,t=[].concat(Ut()(r[0]),[0,0,1,r[1][0],r[0][1],0,1,1],Ut()(r[1]),[0,1,0],Ut()(r[0]),[0,0,1],Ut()(r[1]),[0,1,0,r[0][0],r[1][1],0,0,0]),n=[0,1,2,3,4,5];return{vertices:t,indices:n,size:5}}function lg(e,r){for(var t=r||30,n=e.coordinates,i=[],s=[],c=function(E){i.push(E,1,E,n[0][0],n[0][1],n[1][0],n[1][1],E,-1,E,n[0][0],n[0][1],n[1][0],n[1][1]),E!==t-1&&s.push.apply(s,Ut()([0,1,2,1,3,2].map(function(T){return E*2+T})))},g=0;g<t;g++)c(g);return{vertices:i,indices:s,size:7}}function aM(e){var r=e.coordinates;r.length===2&&r.push(0);var t=e.size,n=cg(-1,1),i=cg(1,1),s=cg(-1,-1),c=cg(1,-1),g=[].concat(Ut()(r),Ut()(n),Ut()(r),Ut()(s),Ut()(r),Ut()(c),Ut()(r),Ut()(i)),y=[0,1,2,3,0,2];return{vertices:g,indices:y,size:5}}function oM(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(ug&&ug[e])return ug[e];var t=bm[e]?bm[e]():bm.cylinder(),n=Zx([t],r);return ug[e]=n,n}function sF(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=new Float32Array(e.length/t*3),s,c,g,y=V.create(),E=V.create(),T=V.create(),I=0,F=r.length;I<F;I+=3){s=r[I+0]*3,c=r[I+1]*3,g=r[I+2]*3;var U=[e[s],e[s+1]],Q=[e[c],e[c+1]],ue=[e[g],e[g+1]];n&&(U=ko(U),Q=ko(Q),ue=ko(ue));var de=U,Re=Ei()(de,2),et=Re[0],ht=Re[1],xt=V.fromValues(et,ht,e[s+2]),Gt=Q,jt=Ei()(Gt,2),Qt=jt[0],fr=jt[1],Gr=V.fromValues(Qt,fr,e[c+2]),Jr=ue,Ur=Ei()(Jr,2),Xn=Ur[0],ni=Ur[1],Oi=V.fromValues(Xn,ni,e[g+2]);V.sub(y,Oi,Gr),V.sub(E,xt,Gr),V.cross(T,y,E),i[s]+=y[0],i[s+1]+=y[1],i[s+2]+=y[2],i[c]+=y[0],i[c+1]+=y[1],i[c+2]+=y[2],i[g]+=y[0],i[g+1]+=y[1],i[g+2]+=y[2]}return sM(i),i}function sM(e){for(var r=0,t=e.length;r<t;r+=3){var n=V.fromValues(e[r],e[r+1],e[r+2]),i=V.create();V.normalize(i,n),e.set(i,r)}}function uF(e){var r=e[0][0],t=e[0][e[0].length-1];return r[0]===t[0]&&r[1]===t[1]}function uM(e){var r=["cylinder","triangleColumn","hexagonColumn","squareColumn"],t=bm[e]?bm[e]():bm.circle(),n=r.indexOf(e)===-1?QT([t]):qT([t]);return n}function cg(e,r){var t=(e+1)/2,n=(r+1)/2;return[t,n]}function lF(){var e=Hx(og,{segments:jx}),r=e.positionsArr,t=e.indicesArr,n=e.normalArr;return{vertices:r,indices:t,size:5,normals:n}}function cF(){var e=Hx(og+KT,{segments:jx}),r=e.positionsArr,t=e.indicesArr,n=e.normalArr;return{vertices:r,indices:t,size:5,normals:n}}function lM(e){var r=cM();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function cM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fM=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

uniform float u_circleSweep;
uniform float u_cityMinSize;
uniform vec3 u_circleSweepColor;
uniform float u_circleSweepSpeed;

varying float v_worldDis;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }


  if(u_circleSweep > 0.0 && v_worldDis < u_cityMinSize) {
    float r = fract(((v_worldDis/u_cityMinSize) - u_time * u_circleSweepSpeed) * 2.0);
    gl_FragColor.rgb += r * r * u_circleSweepColor;
  }
   
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,hM=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;
uniform mat4 u_Mvp;

uniform float u_circleSweep;
uniform vec2 u_cityCenter;

varying float v_worldDis;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"


void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

   v_texCoord = a_Uv;

  if(u_circleSweep > 0.0) {
     vec2 lnglatscale = vec2(0.0);
    if(u_CoordinateSystem != COORDINATE_SYSTEM_P20_2) {
      lnglatscale = (a_Position.xy - u_cityCenter) * vec2(0.0, 0.135);
    }
    v_worldDis = length(a_Position.xy + lnglatscale - u_cityCenter);
  }
 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,pM=function(e){qr()(t,e);var r=lM(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"cityCenter",void 0),w()(ce()(n),"cityMinSize",void 0),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,g=i.baseColor,y=g===void 0?"rgb(16,16,16)":g,E=i.brightColor,T=E===void 0?"rgb(255,176,38)":E,I=i.windowColor,F=I===void 0?"rgb(30,60,89)":I,U=i.time,Q=U===void 0?0:U,ue=i.sweep,de=ue===void 0?{enable:!1,sweepRadius:1,sweepColor:"rgb(255, 255, 255)",sweepSpeed:.4,sweepCenter:this.cityCenter}:ue;return{u_cityCenter:de.sweepCenter||this.cityCenter,u_cityMinSize:this.cityMinSize*de.sweepRadius,u_circleSweep:de.enable?1:0,u_circleSweepColor:Dr(de.sweepColor).slice(0,3),u_circleSweepSpeed:de.sweepSpeed,u_opacity:c,u_baseColor:Dr(y),u_brightColor:Dr(T),u_windowColor:Dr(F),u_time:this.layer.getLayerAnimateTime()||Q}}},{key:"calCityGeo",value:function(){var i=Ei()(this.layer.getSource().extent,4),s=i[0],c=i[1],g=i[2],y=i[3];if(this.mapService.version==="GAODE2.x"){this.cityCenter=this.mapService.lngLatToCoord([(g+s)/2,(y+c)/2]);var E=this.mapService.lngLatToCoord([g,y]),T=this.mapService.lngLatToCoord([s,c]);this.cityMinSize=Math.sqrt(Math.pow(E[0]-T[0],2)+Math.pow(E[1]-T[1],2))/4}else{var I=g-s,F=y-c;this.cityCenter=[(g+s)/2,(y+c)/2],this.cityMinSize=Math.sqrt(Math.pow(I,2)+Math.pow(F,2))/4}}},{key:"initModels",value:function(){return this.calCityGeo(),this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:hM,fragmentShader:fM,triangulation:rb})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:Yi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(s,c,g,y,E){return E}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(s,c,g,y){var E=s.size,T=E===void 0?10:E;return Array.isArray(T)?[T[0]]:[T]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Yi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(s,c,g,y){var E=s.size;return[g[3],g[4]]}}})}}]),t}(Ju);function dM(e){var r=vM();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function vM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var mM=function(e){qr()(t,e);var r=dM(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"type","PolygonLayer"),n}return Yt()(t,[{key:"buildModels",value:function(){this.layerModel=new pM(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(i){this.updateLayerConfig({time:i})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),t}(Bv);function gM(e){var r=yM();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function yM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var _M=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
uniform mat4 u_Mvp;\r
varying vec4 v_color;\r
\r
uniform vec2 u_SceneCenterMKT;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  // vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  // gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\r
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807\r
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));\r
    gl_Position = u_Mvp * (project_pos);\r
  } else {\r
     vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
    gl_Position = project_common_position_to_clipspace(project_pos);\r
  }\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,xM=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,bM=function(e){qr()(t,e);var r=gM(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.coverage,g=i.angle;return{u_opacity:s||1,u_coverage:c||.9,u_angle:g||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g;return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:_M,fragmentShader:xM,triangulation:nb,depth:{enable:!1},primitive:ve.TRIANGLES,blend:this.getBlend(),stencil:Ii(c,y)})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:Yi.Attribute,descriptor:{name:"a_Pos",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(s,c){var g=s.version==="GAODE2.x"?s.originCoordinates:s.coordinates;return[g[0],g[1],0]}}})}}]),t}(Ju);function EM(e){var r=SM();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function SM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var CM=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_SceneCenterMKT;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"


void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  // vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6
  // vec2 lnglat = (a_Pos.xy + offset); 
  // vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  // gl_Position = project_common_position_to_clipspace(project_pos);
  // float lightWeight = calc_lighting(project_pos);
  // v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // vec2 lnglat = (a_Pos.xy + offset); 
    // vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));

    // float lightWeight = calc_lighting(project_pos);
    // v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
  
    // gl_Position = u_Mvp * vec4(lnglat , a_Position.z * a_Size, 1.0);
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u7ECF\u7EAC\u5EA6
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807
    vec4 project_pos = project_position(vec4(customLnglat, a_Position.z * a_Size, 1.0));

    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
  
    gl_Position = u_Mvp * vec4(customLnglat , a_Position.z * a_Size, 1.0);
  } else {
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6
    vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
    
    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
    
    gl_Position = project_common_position_to_clipspace(project_pos);
  }



  setPickingColor(a_PickingColor);
}
`,wM=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,AM=function(e){qr()(t,e);var r=EM(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.coverage,g=i.angle;return{u_opacity:s||1,u_coverage:c||1,u_angle:g||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g;return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:CM,fragmentShader:wM,triangulation:Jx,depth:{enable:!0},blend:this.getBlend(),stencil:Ii(c,y)})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(s,c,g,y){var E=s.size;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Yi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(s,c,g,y,E){return E}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Yi.Attribute,descriptor:{name:"a_Pos",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(s,c){var g=s.version==="GAODE2.x"?s.originCoordinates:s.coordinates;return[g[0],g[1],0]}}})}}]),t}(Ju);function TM(e,r){for(var t=[],n=[],i=[],s=e+1,c=r+1,g=e/2,y=r/2,E=0;E<c;E++)for(var T=E-y,I=0;I<s;I++){var F=I-g;n.push(F/g,-T/y,0),i.push(I/e),i.push(1-E/r)}for(var U=0;U<r;U++)for(var Q=0;Q<e;Q++){var ue=Q+s*U,de=Q+s*(U+1),Re=Q+1+s*(U+1),et=Q+1+s*U;t.push(ue,de,et),t.push(de,Re,et)}return{vertices:n,indices:t,uvs:i}}var ab,ob;function sb(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function ub(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?sb(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):sb(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function MM(e){var r=PM();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function PM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var OM=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;
}
`,IM=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;


vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos = a_Uv * vec2(2.0) - vec2(1.0); // \u5C06\u539F\u672C 0 -> 1 \u7684 uv \u8F6C\u6362\u4E3A -1 -> 1 \u7684\u6807\u51C6\u5750\u6807\u7A7A\u95F4\uFF08NDC\uFF09

  vec4 p1 = vec4(pos, 0.0, 1.0); // x/y \u5E73\u9762\u4E0A\u7684\u70B9\uFF08z == 0\uFF09\u53EF\u4EE5\u8BA4\u4E3A\u662F\u4E09\u7EF4\u4E0A\u7684\u70B9\u88AB\u6295\u5F71\u5230\u5E73\u9762\u540E\u7684\u70B9
	vec4 p2 = vec4(pos, 1.0, 1.0); // \u5E73\u884C\u4E8Ex/y\u5E73\u9762\u3001z==1 \u7684\u5E73\u9762\u4E0A\u7684\u70B9

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1; // \u6839\u636E\u89C6\u56FE\u6295\u5F71\u77E9\u9635\u7684\u9006\u77E9\u9635\u5E73\u9762\u4E0A\u7684\u53CD\u7B97\u51FA\u4E09\u7EF4\u7A7A\u95F4\u4E2D\u7684\u70B9\uFF08p1\u5E73\u9762\u4E0A\u7684\u70B9\uFF09
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w; // \u5F52\u4E00\u5316\u64CD\u4F5C\uFF08\u5F52\u4E00\u5316\u540E\u4E3A\u4E16\u754C\u5750\u6807\uFF09
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z); // ??
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0.0, 1.0, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);
 
}
`,RM=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,LM=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,kM=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 2.5;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
        gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
    } else {
        gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
    }
}
`,DM=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,lb=(ab=Object(Cr.injectable)(),ab(ob=function(e){qr()(t,e);var r=MM(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"texture",void 0),w()(ce()(n),"colorTexture",void 0),w()(ce()(n),"heatmapFramerBuffer",void 0),w()(ce()(n),"intensityModel",void 0),w()(ce()(n),"colorModel",void 0),w()(ce()(n),"shapeType",void 0),n}return Yt()(t,[{key:"render",value:function(){var i=this,s=this.rendererService,c=s.clear,g=s.useFramebuffer;g(this.heatmapFramerBuffer,function(){c({color:[0,0,0,0],depth:1,stencil:0,framebuffer:i.heatmapFramerBuffer}),i.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var i,s=this.rendererService,c=s.createFramebuffer,g=s.clear,y=s.getViewportSize,E=s.createTexture2D,T=s.useFramebuffer,I=this.styleAttributeService.getLayerStyleAttribute("shape"),F=(I==null||(i=I.scale)===null||i===void 0?void 0:i.field)||"heatmap";this.shapeType=F,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=F==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var U=y(),Q=U.width,ue=U.height;return this.heatmapFramerBuffer=c({color:E({width:Math.floor(Q/4),height:Math.floor(ue/4),wrapS:ve.CLAMP_TO_EDGE,wrapT:ve.CLAMP_TO_EDGE,min:ve.LINEAR,mag:ve.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:Yi.Attribute,descriptor:{name:"a_Dir",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(s,c,g,y){return[g[3],g[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(s,c,g,y){var E=s.size,T=E===void 0?1:E;return[T]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:kM,fragmentShader:LM,triangulation:aM,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:ve.ONE,srcAlpha:1,dstRGB:ve.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g;this.shaderModuleService.registerModule("heatmapColor",{vs:DM,fs:RM});var E=this.shaderModuleService.getModule("heatmapColor"),T=E.vs,I=E.fs,F=E.uniforms,U=this.rendererService,Q=U.createAttribute,ue=U.createElements,de=U.createBuffer,Re=U.createModel;return Re({vs:T,fs:I,attributes:{a_Position:Q({buffer:de({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:ve.FLOAT}),size:3}),a_Uv:Q({buffer:de({data:[0,1,1,1,0,0,1,0],type:ve.FLOAT}),size:2})},uniforms:ub({},F),depth:{enable:!1},blend:this.getBlend(),count:6,elements:ue({data:[0,2,1,2,3,1],type:ve.UNSIGNED_INT,count:6}),stencil:Ii(c,y)})}},{key:"drawIntensityMode",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.intensity,g=c===void 0?10:c,y=i.radius,E=y===void 0?5:y;this.intensityModel.draw({uniforms:{u_opacity:s||1,u_radius:E,u_intensity:g}})}},{key:"drawColorMode",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity;this.colorModel.draw({uniforms:{u_opacity:s||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=k.create();k.invert(c,this.cameraService.getViewProjectionMatrixUncentered()),this.colorModel.draw({uniforms:{u_opacity:s||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:Ut()(c)}})}},{key:"build3dHeatMap",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g,E=this.rendererService.getViewportSize,T=E(),I=T.width,F=T.height,U=TM(I/4,F/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:IM,fs:OM});var Q=this.shaderModuleService.getModule("heatmap3dColor"),ue=Q.vs,de=Q.fs,Re=Q.uniforms,et=this.rendererService,ht=et.createAttribute,xt=et.createElements,Gt=et.createBuffer,jt=et.createModel;return jt({vs:ue,fs:de,attributes:{a_Position:ht({buffer:Gt({data:U.vertices,type:ve.FLOAT}),size:3}),a_Uv:ht({buffer:Gt({data:U.uvs,type:ve.FLOAT}),size:2})},primitive:ve.TRIANGLES,uniforms:ub({},Re),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:ve.SRC_ALPHA,srcAlpha:1,dstRGB:ve.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:xt({data:U.indices,type:ve.UNSIGNED_INT,count:U.indices.length}),stencil:Ii(c,y)})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var i=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var s=this.layer.getLayerConfig(),c=s.rampColors,g=Vn(c);this.colorTexture=i({data:new Uint8Array(g.data),width:g.width,height:g.height,wrapS:ve.CLAMP_TO_EDGE,wrapT:ve.CLAMP_TO_EDGE,min:ve.NEAREST,mag:ve.NEAREST,flipY:!1})}}]),t}(Ju))||ob);function FM(e){var r=BM();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function BM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var NM=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,zM=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_SceneCenterMKT;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
 
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xy, 0., 1.0));
    // gl_Position = u_Mvp * (vec4(a_Pos.xy + offset, 0., 1.0));
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT;
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));
    gl_Position = u_Mvp * vec4(project_pos.xy, 0.0, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,UM=function(e){qr()(t,e);var r=FM(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.coverage,g=i.angle;return{u_opacity:s||1,u_coverage:c||.9,u_angle:g||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g;return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:zM,fragmentShader:NM,triangulation:nb,depth:{enable:!1},primitive:ve.TRIANGLES,blend:this.getBlend(),stencil:Ii(c,y)})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:Yi.Attribute,descriptor:{name:"a_Pos",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(s,c){var g=s.version==="GAODE2.x"?s.originCoordinates:s.coordinates;return[g[0],g[1],0]}}})}}]),t}(Ju),jM={heatmap:lb,heatmap3d:lb,grid:bM,grid3d:AM,hexagon:UM},VM=jM;function GM(e){var r=HM();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function HM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var WM=function(e){qr()(t,e);var r=GM(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"type","HeatMapLayer"),n}return Yt()(t,[{key:"buildModels",value:function(){var i=this.getModelType();this.layerModel=new VM[i](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var i=this,s=this.getModelType();return s==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(c){return c.draw({uniforms:i.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var i,s=this.styleAttributeService.getLayerStyleAttribute("shape"),c=this.getLayerConfig(),g=c.shape3d,y=this.getSource(),E=y.data.type,T=(s==null||(i=s.scale)===null||i===void 0?void 0:i.field)||"heatmap";return T==="heatmap"||T==="heatmap3d"?"heatmap":E==="hexagon"?(g==null?void 0:g.indexOf(T))===-1?"hexagon":"grid3d":E==="grid"?(g==null?void 0:g.indexOf(T))===-1?"grid":"grid3d":"heatmap"}}]),t}(Bv);function ZM(e){var r=XM();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function XM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var YM=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,KM=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,$M=function(e){qr()(t,e);var r=ZM(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"texture",void 0),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity;return{u_opacity:s||1,u_texture:this.texture}}},{key:"initModels",value:function(){var i=this,s=this.layer.getLayerConfig(),c=s.mask,g=c===void 0?!1:c,y=s.maskInside,E=y===void 0?!0:y,T=this.layer.getSource(),I=this.rendererService.createTexture2D;if(this.texture=I({height:0,width:0}),$i){var F=this.layerService.sceneService.getSceneConfig().canvas,U=F.createImage();U.crossOrigin="anonymous",U.src=T.data.originData,U.onload=function(){i.texture=I({data:U,width:U.width,height:U.height}),i.layerService.updateLayerRenderList(),i.layerService.renderLayers()}}else T.data.images.then(function(Q){i.texture=I({data:Q[0],width:Q[0].width,height:Q[0].height}),i.layerService.updateLayerRenderList(),i.layerService.renderLayers()});return[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:KM,fragmentShader:YM,triangulation:ib,primitive:ve.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:Ii(g,E)})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Yi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(s,c,g,y){return[g[3],g[4]]}}})}}]),t}(Ju),qM={image:$M},QM=qM;function JM(e){var r=eP();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function eP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tP=function(e){qr()(t,e);var r=JM(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"type","ImageLayer"),n}return Yt()(t,[{key:"buildModels",value:function(){var i=this.getModelType();this.layerModel=new QM[i](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),s={image:{}};return s[i]}},{key:"getModelType",value:function(){return"image"}}]),t}(Bv);function rP(e){var r=nP();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function nP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var iP=`
uniform float u_opacity;

varying vec4 v_dash_array;
varying vec4 v_color;

uniform float segmentNumber;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;

  float flag = 0.;
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  }
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,aP=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  

   styleMappingMat[3].b = segmentIndex / segmentNumber;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,oP=`
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  
  gl_FragColor.a *= opacity;

  if(u_aimate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = styleMappingMat[3].g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_aimate.x == Animate) {
      time = u_time / u_aimate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = styleMappingMat[3].a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_aimate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_aimate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
  // gl_FragColor = filterColor(gl_FragColor);
}`,sP=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_aimate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
     styleMappingMat[3].g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
     styleMappingMat[3].a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,uP=`#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}`,lP=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,cP={solid:0,dash:1},fP=function(e){qr()(t,e);var r=rP(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"texture",void 0),w()(ce()(n),"updateTexture",function(){var g=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=g({data:n.iconService.getCanvas(),mag:ve.NEAREST,min:ve.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,g=i.targetColor,y=i.textureBlend,E=y===void 0?"normal":y,T=i.lineType,I=T===void 0?"solid":T,F=i.dashArray,U=F===void 0?[10,5]:F,Q=i.forward,ue=Q===void 0?!0:Q,de=i.lineTexture,Re=de===void 0?!1:de,et=i.iconStep,ht=et===void 0?100:et,xt=i.segmentNumber,Gt=xt===void 0?30:xt,jt=i.thetaOffset,Qt=jt===void 0?.314:jt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s,thetaOffset:Qt})){this.judgeStyleAttributes({opacity:s,thetaOffset:Qt});var fr=this.layer.getEncodedData(),Gr=this.calDataFrame(this.cellLength,fr,this.cellProperties),Jr=Gr.data,Ur=Gr.width,Xn=Gr.height;this.rowCount=Xn,this.dataTexture=this.cellLength>0&&Jr.length>0?this.createTexture2D({flipY:!0,data:Jr,format:ve.LUMINANCE,type:ve.FLOAT,width:Ur,height:Xn}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}U.length===2&&U.push(0,0);var ni=0,Oi=[0,0,0,0],No=[0,0,0,0];return c&&g&&(Oi=Dr(c),No=Dr(g),ni=1),this.rendererService.getDirty()&&this.texture.bind(),{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_thetaOffset:Ro()(Qt)?Qt:0,u_opacity:Ro()(s)?s:1,u_textureBlend:E==="normal"?0:1,segmentNumber:Gt,u_line_type:cP[I||"solid"],u_dash_array:U,u_blur:.9,u_lineDir:ue?1:-1,u_texture:this.texture,u_line_texture:Re?1:0,u_icon_step:ht,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:ni,u_sourceColor:Oi,u_targetColor:No}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.dataTexture)===null||s===void 0||s.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),s=i.sourceColor,c=i.targetColor,g=i.lineType;return g==="dash"?{frag:iP,vert:aP,type:"dash"}:s&&c?{frag:uP,vert:lP,type:"linear"}:{frag:oP,vert:sP,type:"normal"}}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.segmentNumber,c=s===void 0?30:s,g=i.mask,y=g===void 0?!1:g,E=i.maskInside,T=E===void 0?!0:E,I=this.getShaders(),F=I.frag,U=I.vert,Q=I.type;return[this.layer.buildLayerModel({moduleName:"arc2dline"+Q,vertexShader:U,fragmentShader:F,triangulation:lg,depth:{enable:!1},blend:this.getBlend(),segmentNumber:c,stencil:Ii(y,T)})]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(c,g,y,E){var T=c.size,I=T===void 0?1:T;return Array.isArray(I)?[I[0]]:[I]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Yi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:4,update:function(c,g,y,E){return[y[3],y[4],y[5],y[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Yi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(c,g,y,E){var T=i.iconService.getIconMap(),I=c.texture,F=T[I]||{x:0,y:0},U=F.x,Q=F.y;return[U,Q]}}})}}]),t}(Ju);function hP(e){var r=pP();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function pP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var dP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);

      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_aimate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_aimate.x == Animate) {
      time = u_time / u_aimate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_aimate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_aimate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,vP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
// varying vec2 v_normal;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // TODO: + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // TODO: \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,mP=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;


uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);

      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_aimate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,gP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
// varying vec2 v_normal;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // TODO: + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // TODO: \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,yP={solid:0,dash:1},_P=function(e){qr()(t,e);var r=hP(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"texture",void 0),w()(ce()(n),"updateTexture",function(){var g=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=g({data:n.iconService.getCanvas(),mag:ve.NEAREST,min:ve.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,g=i.targetColor,y=i.textureBlend,E=y===void 0?"normal":y,T=i.lineType,I=T===void 0?"solid":T,F=i.dashArray,U=F===void 0?[10,5]:F,Q=i.lineTexture,ue=Q===void 0?!1:Q,de=i.iconStep,Re=de===void 0?100:de,et=i.segmentNumber,ht=et===void 0?30:et,xt=i.globalArcHeight,Gt=xt===void 0?10:xt;U.length===2&&U.push(0,0);var jt=0,Qt=[0,0,0,0],fr=[0,0,0,0];if(c&&g&&(Qt=Dr(c),fr=Dr(g),jt=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var Gr=this.layer.getEncodedData(),Jr=this.calDataFrame(this.cellLength,Gr,this.cellProperties),Ur=Jr.data,Xn=Jr.width,ni=Jr.height;this.rowCount=ni,this.dataTexture=this.cellLength>0&&Ur.length>0?this.createTexture2D({flipY:!0,data:Ur,format:ve.LUMINANCE,type:ve.FLOAT,width:Xn,height:ni}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}return{u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:og,u_global_height:Gt,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Ro()(s)?s:1,u_textureBlend:E==="normal"?0:1,segmentNumber:ht,u_line_type:yP[I]||0,u_dash_array:U,u_texture:this.texture,u_line_texture:ue?1:0,u_icon_step:Re,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:jt,u_sourceColor:Qt,u_targetColor:fr}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.dataTexture)===null||s===void 0||s.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),s=i.sourceColor,c=i.targetColor,g=i.lineType;return s&&c?{frag:mP,vert:gP,type:"linear"}:{frag:dP,vert:vP,type:"normal"}}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.segmentNumber,c=s===void 0?30:s,g=i.mask,y=g===void 0?!1:g,E=i.maskInside,T=E===void 0?!0:E,I=this.getShaders(),F=I.frag,U=I.vert,Q=I.type;return[this.layer.buildLayerModel({moduleName:"arc3Dline"+Q,vertexShader:U,fragmentShader:F,triangulation:lg,blend:this.getBlend(),segmentNumber:c,stencil:Ii(y,T)})]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(c,g,y,E){var T=c.size,I=T===void 0?1:T;return Array.isArray(I)?[I[0]]:[I]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Yi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:4,update:function(c,g,y,E){return[y[3],y[4],y[5],y[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Yi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(c,g,y,E){var T=i.iconService.getIconMap(),I=c.texture,F=T[I]||{x:0,y:0},U=F.x,Q=F.y;return[U,Q]}}})}}]),t}(Ju);function xP(e){var r=bP();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function bP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var EP=`#define LineTypeSolid 0.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
// varying vec2 v_normal;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float segmentNumber;
varying float v_distance_ratio;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

void main() {

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v_distance_ratio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }
  
 
  gl_FragColor.a *= u_opacity;

  if(u_aimate.x == Animate) {
      float animateSpeed = u_time / u_aimate.y; // \u8FD0\u52A8\u901F\u5EA6
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }
}`,SP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
// varying vec2 v_normal;

uniform float u_lineDir: 1.0;

// \u504F\u79FB\u91CF
uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = u_thetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  v_distance_ratio = segmentIndex / segmentNumber;
  
  if(u_aimate.x == Animate && u_lineDir != 1.0) {
      v_distance_ratio = 1.0 - v_distance_ratio;
  }

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
}
`,CP=function(e){qr()(t,e);var r=xP(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,g=i.targetColor,y=i.forward,E=y===void 0?!0:y,T=i.segmentNumber,I=T===void 0?30:T,F=i.thetaOffset,U=F===void 0?.314:F,Q=0,ue=[0,0,0,0],de=[0,0,0,0];return c&&g&&(ue=Dr(c),de=Dr(g),Q=1),{u_thetaOffset:U,u_opacity:Ro()(s)?s:1,segmentNumber:I,u_blur:.9,u_lineDir:E?1:-1,u_linearColor:Q,u_sourceColor:ue,u_targetColor:de}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.segmentNumber,c=s===void 0?30:s;return[this.layer.buildLayerModel({moduleName:"arc2dminiline",vertexShader:SP,fragmentShader:EP,triangulation:lg,depth:{enable:!1},blend:this.getBlend(),segmentNumber:c})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(s,c,g,y){var E=s.size,T=E===void 0?1:E;return Array.isArray(T)?[T[0]]:[T]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Yi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:4,update:function(s,c,g,y){return[g[3],g[4],g[5],g[6]]}}})}}]),t}(Ju);function wP(e){var r=AP();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function AP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var TP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0;
  float d_segmentIndex = styleMappingMat[3].g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- smoothstep(0.0, 1.0, v_distance_ratio), u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_aimate.x == Animate) {
      u = gl_FragColor.a/opacity;
    }

    float v = styleMappingMat[3].a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,MP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
// varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*8.0;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  styleMappingMat[3].g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
    styleMappingMat[3].b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  }
  setPickingColor(a_PickingColor);
}

`,PP={solid:0,dash:1},OP=function(e){qr()(t,e);var r=wP(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"texture",void 0),w()(ce()(n),"updateTexture",function(){var g=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=g({data:n.iconService.getCanvas(),mag:ve.NEAREST,min:ve.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,g=i.targetColor,y=i.textureBlend,E=y===void 0?"normal":y,T=i.lineType,I=T===void 0?"solid":T,F=i.dashArray,U=F===void 0?[10,5]:F,Q=i.lineTexture,ue=Q===void 0?!1:Q,de=i.iconStep,Re=de===void 0?100:de,et=i.segmentNumber,ht=et===void 0?30:et;U.length===2&&U.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var xt=0,Gt=[0,0,0,0],jt=[0,0,0,0];if(c&&g&&(Gt=Dr(c),jt=Dr(g),xt=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var Qt=this.layer.getEncodedData(),fr=this.calDataFrame(this.cellLength,Qt,this.cellProperties),Gr=fr.data,Jr=fr.width,Ur=fr.height;this.rowCount=Ur,this.dataTexture=this.cellLength>0&&Gr.length>0?this.createTexture2D({flipY:!0,data:Gr,format:ve.LUMINANCE,type:ve.FLOAT,width:Jr,height:Ur}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Ro()(s)?s:1,u_textureBlend:E==="normal"?0:1,segmentNumber:ht,u_line_type:PP[I]||0,u_dash_array:U,u_texture:this.texture,u_line_texture:ue?1:0,u_icon_step:Re,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:xt,u_sourceColor:Gt,u_targetColor:jt}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.dataTexture)===null||s===void 0||s.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g;return[this.layer.buildLayerModel({moduleName:"greatcircleline",vertexShader:MP,fragmentShader:TP,triangulation:lg,depth:{enable:!1},blend:this.getBlend(),stencil:Ii(c,y)})]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(c,g,y,E){var T=c.size,I=T===void 0?1:T;return Array.isArray(I)?[I[0]]:[I]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Yi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:4,update:function(c,g,y,E){return[y[3],y[4],y[5],y[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Yi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(c,g,y,E){var T=i.iconService.getIconMap(),I=c.texture,F=T[I]||{x:0,y:0},U=F.x,Q=F.y;return[U,Q]}}})}}]),t}(Ju);function IP(e){var r=RP();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function RP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var LP=`#define LineTypeSolid 0.0
uniform float u_opacity : 1.0;

varying vec4 v_color;

// dash
varying vec4 v_dash_array;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
 // dash line
 
  float flag = 0.;
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  }
  gl_FragColor.a *=flag;

  gl_FragColor = filterColor(gl_FragColor);
}
`,kP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = a_Distance / a_Total_Distance; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y), 1.0));
  } else {
    float lineHeight = a_Size.y;
 
    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,DP=`#define Animate 0.0
#define LineTexture 1.0
uniform float u_blur : 0.99;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;

uniform float u_borderWidth: 0.0;
uniform vec4 u_borderColor;
varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying vec2 v_iconMapUV;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + animateSpeed);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = styleMappingMat[3].g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = styleMappingMat[3].b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = styleMappingMat[3].a;
  float borderWidth = min(0.5, u_borderWidth);
  // \u7ED8\u5236 border
  if(borderWidth > 0.01) {
    float borderOuterWidth = borderWidth/2.0;

    if(v >= 1.0 - borderWidth || v <= borderWidth) {
      if(v > borderWidth) {
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, u_borderColor.rgb, linear);
      } else if(v <= borderWidth) {
        float linear = smoothstep(0.0, 1.0, v/borderWidth);
        gl_FragColor.rgb = mix(u_borderColor.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,cb=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);

  vec2 offset = project_pixel(size.xy);

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = a_Distance / a_Total_Distance;; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  styleMappingMat[3][2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,FP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;

varying vec4 v_color;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"


varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,BP={solid:0,dash:1},fb=function(e){qr()(t,e);var r=IP(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"texture",void 0),w()(ce()(n),"updateTexture",function(){var g=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=g({data:n.iconService.getCanvas(),mag:ve.NEAREST,min:ve.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,g=i.targetColor,y=i.textureBlend,E=y===void 0?"normal":y,T=i.lineType,I=T===void 0?"solid":T,F=i.dashArray,U=F===void 0?[10,5,0,0]:F,Q=i.lineTexture,ue=Q===void 0?!1:Q,de=i.iconStep,Re=de===void 0?100:de,et=i.vertexHeightScale,ht=et===void 0?20:et,xt=i.borderWidth,Gt=xt===void 0?0:xt,jt=i.borderColor,Qt=jt===void 0?"#ccc":jt;U.length===2&&U.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var fr=0,Gr=[0,0,0,0],Jr=[0,0,0,0];if(c&&g&&(Gr=Dr(c),Jr=Dr(g),fr=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var Ur=this.layer.getEncodedData(),Xn=this.calDataFrame(this.cellLength,Ur,this.cellProperties),ni=Xn.data,Oi=Xn.width,No=Xn.height;this.rowCount=No,this.dataTexture=this.cellLength>0&&ni.length>0?this.createTexture2D({flipY:!0,data:ni,format:ve.LUMINANCE,type:ve.FLOAT,width:Oi,height:No}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Ro()(s)?s:1,u_textureBlend:E==="normal"?0:1,u_line_type:BP[I],u_dash_array:U,u_texture:this.texture,u_line_texture:ue?1:0,u_icon_step:Re,u_textSize:[1024,this.iconService.canvasHeight||128],u_borderWidth:Gt,u_borderColor:Dr(Qt),u_linearColor:fr,u_sourceColor:Gr,u_targetColor:Jr,u_vertexScale:ht}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.dataTexture)===null||s===void 0||s.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g,E=this.getShaders(),T=E.frag,I=E.vert,F=E.type;return[this.layer.buildLayerModel({moduleName:"line"+F,vertexShader:I,fragmentShader:T,triangulation:tb,primitive:ve.TRIANGLES,blend:this.getBlend(),depth:{enable:!1},stencil:Ii(c,y)})]}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),s=i.sourceColor,c=i.targetColor,g=i.lineType;return g==="dash"?{frag:LP,vert:kP,type:"dash"}:s&&c?{frag:FP,vert:cb,type:"linear"}:{frag:DP,vert:cb,type:"normal"}}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:Yi.Attribute,descriptor:{name:"a_Distance",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(c,g,y,E){return[y[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Yi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(c,g,y,E){return[y[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(c,g,y,E){var T=c.size,I=T===void 0?1:T;return Array.isArray(I)?[I[0],I[1]]:[I,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Yi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(c,g,y,E,T){return T}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Yi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(c,g,y,E){return[y[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Yi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(c,g,y,E){var T=i.iconService.getIconMap(),I=c.texture,F=T[I]||{x:0,y:0},U=F.x,Q=F.y;return[U,Q]}}})}}]),t}(Ju);function NP(e){var r=zP();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function zP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var UP=`

uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,jP=`
varying vec4 v_color;
varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,hb=`
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;


// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_vertexScale: 1.0;

#pragma include "projection"

varying vec4 v_color;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_color = a_Color;  

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
  }
}
`,VP=function(e){qr()(t,e);var r=NP(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,g=i.targetColor,y=i.vertexHeightScale,E=y===void 0?20:y,T=0,I=[0,0,0,0],F=[0,0,0,0];if(c&&g&&(I=Dr(c),F=Dr(g),T=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var U=this.layer.getEncodedData(),Q=this.calDataFrame(this.cellLength,U,this.cellProperties),ue=Q.data,de=Q.width,Re=Q.height;this.rowCount=Re,this.dataTexture=this.cellLength>0&&ue.length>0?this.createTexture2D({flipY:!0,data:ue,format:ve.LUMINANCE,type:ve.FLOAT,width:de,height:Re}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Ro()(s)?s:1,u_linearColor:T,u_sourceColor:I,u_targetColor:F,u_vertexScale:E}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),s=i.sourceColor,c=i.targetColor;return s&&c?{frag:UP,vert:hb,type:"linear"}:{frag:jP,vert:hb,type:"normal"}}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g,E=this.getShaders(),T=E.frag,I=E.vert,F=E.type;return[this.layer.buildLayerModel({moduleName:"simpleline"+F,vertexShader:I,fragmentShader:T,triangulation:tM,primitive:ve.LINES,blend:this.getBlend(),depth:{enable:!1},stencil:Ii(c,y)})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:Yi.Attribute,descriptor:{name:"a_Distance",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(s,c,g,y){return[g[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Yi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(s,c,g,y){return[g[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(s,c,g,y){var E=s.size,T=E===void 0?1:E;return Array.isArray(T)?[T[0],T[1]]:[T,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Yi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(s,c,g,y,E){return E}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Yi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(s,c,g,y){return[g[4]]}}})}}]),t}(Ju);function GP(e){var r=HP();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function HP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var WP=`#define LineTypeSolid 0.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;

varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;

varying vec2 v_iconMapUV;
varying float v_blur;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = styleMappingMat[3].a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + animateSpeed);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = styleMappingMat[3].g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = styleMappingMat[3].b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);

    
  
  
}
`,ZP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

varying vec4 v_color;
varying float v_blur;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "light"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_aimate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  styleMappingMat[3][2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  styleMappingMat[3][3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);

  // v_lightWeight = lightWeight;
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);
  // v_color = a_Color;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,XP=function(e){qr()(t,e);var r=GP(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"texture",void 0),w()(ce()(n),"updateTexture",function(){var g=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=g({data:n.iconService.getCanvas(),mag:ve.NEAREST,min:ve.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.sourceColor,g=i.targetColor,y=i.textureBlend,E=y===void 0?"normal":y,T=i.heightfixed,I=T===void 0?!1:T,F=i.lineTexture,U=F===void 0?!1:F,Q=i.iconStep,ue=Q===void 0?100:Q,de=i.iconStepCount,Re=de===void 0?1:de;this.rendererService.getDirty()&&this.texture.bind();var et=0,ht=[0,0,0,0],xt=[0,0,0,0];if(c&&g&&(ht=Dr(c),xt=Dr(g),et=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var Gt=this.layer.getEncodedData(),jt=this.calDataFrame(this.cellLength,Gt,this.cellProperties),Qt=jt.data,fr=jt.width,Gr=jt.height;this.rowCount=Gr,this.dataTexture=this.cellLength>0&&Qt.length>0?this.createTexture2D({flipY:!0,data:Qt,format:ve.LUMINANCE,type:ve.FLOAT,width:fr,height:Gr}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}return{u_heightfixed:Number(I),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Ro()(s)?s:1,u_textureBlend:E==="normal"?0:1,u_texture:this.texture,u_line_texture:U?1:0,u_iconStepCount:Re,u_icon_step:ue,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:et,u_sourceColor:ht,u_targetColor:xt}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption;return{u_aimate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.dataTexture)===null||s===void 0||s.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"linewall",vertexShader:ZP,fragmentShader:WP,triangulation:tb,primitive:ve.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var i=this,s=this.layer.getLayerConfig(),c=s.lineType,g=c===void 0?"solid":c;this.styleAttributeService.registerStyleAttribute({name:"distance",type:Yi.Attribute,descriptor:{name:"a_Distance",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(E,T,I,F){return[I[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Yi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(E,T,I,F){return[I[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(E,T,I,F){var U=E.size,Q=U===void 0?1:U;return Array.isArray(Q)?[Q[0],Q[1]]:[Q,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Yi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(E,T,I,F,U){return U}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Yi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(E,T,I,F){return[I[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Yi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(E,T,I,F){var U=i.iconService.getIconMap(),Q=E.texture,ue=U[Q]||{x:0,y:0},de=ue.x,Re=ue.y;return[de,Re]}}})}}]),t}(Ju),YP={arc:fP,arcmini:CP,arc3d:_P,greatcircle:OP,wall:XP,line:fb,simple:VP},KP=YP;function $P(e){var r=qP();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function qP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var QP=function(e){qr()(t,e);var r=$P(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"type","LineLayer"),n}return Yt()(t,[{key:"buildModels",value:function(){var i=this.getModelType();this.layerModel=new KP[i](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),s={line:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},arcmini:{blend:"additive"},greatcircle:{blend:"additive"}};return s[i]}},{key:"getModelType",value:function(){var i,s=this.styleAttributeService.getLayerStyleAttribute("shape"),c=s==null||(i=s.scale)===null||i===void 0?void 0:i.field;return c||"line"}}]),t}(Bv);function JP(e){var r=eO();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function eO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tO=`varying vec4 v_color;
uniform float u_opacity: 1.0;

varying float v_z;
varying float v_lightWeight;
uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v_z);
    gl_FragColor.rgb *= v_lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_z): v_z;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorWithLight(gl_FragColor, v_lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,rO=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

varying float v_z;
varying float v_lightWeight;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_z = a_Position.z;

 

  // vec2 offset = project_pixel(size.xy);
  // vec2 offset = (size.xy);

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    offset = project_pixel(offset);
  }

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z) * u_r, 1.0);
  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  // float lightWeight = u_lightEnable > 0.0 ? calc_lighting(pos): 1.0;
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  // gl_Position = project_common_position_to_clipspace(pos);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * pos;
  } else {
    gl_Position = project_common_position_to_clipspace(pos);
  }
  
  if(u_globel > 0.0) {
    // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
    //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
    float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
    float xRadian = getXRadian(a_Pos.y, r);
    float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
    float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
    mat4 mx = mat4(
      1,0,0,0,  
      0,xcos,-xsin,0,  
      0,xsin,xcos,0,  
      0,0,0,1);

    //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
    float yRadian = getYRadian(a_Pos.x, a_Pos.z);
    float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
    float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
    mat4 my = mat4(
      ycos,0,-ysin,0,  
      0,1,0,0,  
      ysin,0,ycos,0,  
      0,0,0,1);

    gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  }

  setPickingColor(a_PickingColor);
}
`,pb=function(e){qr()(t,e);var r=JP(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"raiseCount",0),w()(ce()(n),"raiserepeat",0),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption,c=s===void 0?{enable:!1,speed:.01,repeat:!1}:s,g=i.opacity,y=g===void 0?1:g,E=i.sourceColor,T=i.targetColor,I=i.pickLight,F=I===void 0?!1:I,U=i.heightfixed,Q=U===void 0?!1:U,ue=i.opacityLinear,de=ue===void 0?{enable:!1,dir:"up"}:ue,Re=i.lightEnable,et=Re===void 0?!0:Re;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:y})){this.judgeStyleAttributes({opacity:y});var ht=this.layer.getEncodedData(),xt=this.calDataFrame(this.cellLength,ht,this.cellProperties),Gt=xt.data,jt=xt.width,Qt=xt.height;this.rowCount=Qt,this.dataTexture=this.cellLength>0&&Gt.length>0?this.createTexture2D({flipY:!0,data:Gt,format:ve.LUMINANCE,type:ve.FLOAT,width:jt,height:Qt}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}var fr=0,Gr=[0,0,0,0],Jr=[0,0,0,0];if(E&&T&&(Gr=Dr(E),Jr=Dr(T),fr=1),this.raiseCount<1&&this.raiserepeat>0&&c.enable){var Ur=c.speed,Xn=Ur===void 0?.01:Ur,ni=c.repeat,Oi=ni===void 0?!1:ni;this.raiseCount+=Xn,this.raiseCount>=1&&(this.raiserepeat>1?(this.raiseCount=0,this.raiserepeat--):this.raiseCount=1)}return{u_pickLight:Number(F),u_heightfixed:Number(Q),u_r:c.enable&&this.raiserepeat>0?this.raiseCount:1,u_globel:this.mapService.version==="GLOBEL"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Ro()(y)?y:1,u_linearColor:fr,u_sourceColor:Gr,u_targetColor:Jr,u_opacitylinear:Number(de.enable),u_opacitylinear_dir:de.dir==="up"?1:0,u_lightEnable:Number(et)}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.depth,c=s===void 0?!0:s,g=i.animateOption.repeat,y=g===void 0?1:g;return this.raiserepeat=y,[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:rO,fragmentShader:tO,triangulation:Jx,blend:this.getBlend(),cull:{enable:!0,face:this.mapService.version==="MAPBOX"?ve.FRONT:ve.BACK},depth:{enable:c}})]}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.mapService.version==="GLOBEL";this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(c,g,y,E){var T=c.size;if(T){var I=[];return Array.isArray(T)&&(I=T.length===2?[T[0],T[0],T[1]]:T),Array.isArray(T)||(I=[T,T,T]),I}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Yi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(c,g,y,E,T){return T}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Yi.Attribute,descriptor:{name:"a_Pos",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(c,g){var y=Nv(c.coordinates);return i?Gx([y[0],y[1]]):[y[0],y[1],0]}}})}}]),t}(Ju),Xp;(function(e){e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.L7MAP="L7MAP",e.GLOBEL="GLOBEL"})(Xp||(Xp={}));function nO(e){var r=iO();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function iO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var db=`
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"


void main() {

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  float r = v_radius / (v_radius + strokeWidth);

  // 'circle'
  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);
 
  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float PI = 3.14159;
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);

  // TODO: \u6839\u636E\u53E0\u52A0\u6C34\u6CE2\u6548\u679C
  gl_FragColor = vec4(v_color.xyz, v_color.a * opacity * intensity);

  // TODO: \u4F18\u5316\u5728\u6C34\u6CE2\u7EB9\u60C5\u51B5\u4E0B\u7684\u62FE\u53D6
  if(d < 0.5) {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,aO=`
uniform float u_globel;
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(u_globel > 0.0) {
    // TODO: \u5730\u7403\u6A21\u5F0F\u4E0B\u907F\u514D\u591A\u4F59\u7247\u5143\u7ED8\u5236\uFF0C\u540C\u65F6\u4E5F\u80FD\u907F\u514D\u6709\u7528\u7247\u5143\u5728\u900F\u660E\u4E14\u91CD\u53E0\u7684\u60C5\u51B5\u4E0B\u65E0\u6CD5\u5199\u5165
    // \u4ED8\u51FA\u7684\u4EE3\u4EF7\u662F\u8FB9\u7F18\u4F1A\u6709\u4E00\u4E9B\u952F\u9F7F
    if(outer_df > antialiasblur + 0.018) discard;
  }
  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,jy=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_globel;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_isMeter;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  float newSize = setPickingSize(a_Size);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // TODO: billboard
  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, u_blur);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    antialiasblur *= pow(19.0 - u_Zoom, 2.0);
    antialiasblur = max(antialiasblur, -0.01);
    // offset *= 0.5;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }

  if(u_globel > 0.0) {
    gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,vb=function(e){qr()(t,e);var r=nO(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"meter2coord",1),w()(ce()(n),"isMeter",!1),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,g=i.strokeOpacity,y=g===void 0?1:g,E=i.strokeWidth,T=E===void 0?0:E,I=i.stroke,F=I===void 0?"rgba(0,0,0,0)":I,U=i.offsets,Q=U===void 0?[0,0]:U,ue=i.blend;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:c,strokeOpacity:y,strokeWidth:T,stroke:F,offsets:Q})){this.judgeStyleAttributes({opacity:c,strokeOpacity:y,strokeWidth:T,stroke:F,offsets:Q});var de=this.layer.getEncodedData(),Re=this.calDataFrame(this.cellLength,de,this.cellProperties),et=Re.data,ht=Re.width,xt=Re.height;this.rowCount=xt,this.dataTexture=this.cellLength>0&&et.length>0?this.createTexture2D({flipY:!0,data:et,format:ve.LUMINANCE,type:ve.FLOAT,width:ht,height:xt}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}return{u_isMeter:Number(this.isMeter),u_additive:ue==="additive"?1:0,u_globel:this.mapService.version===Xp.GLOBEL?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Ro()(c)?c:1,u_stroke_opacity:Ro()(y)?y:1,u_stroke_width:Ro()(T)?T:0,u_stroke_color:this.getStrokeColor(F),u_offsets:this.isOffsetStatic(Q)?Q:[0,0]}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),s=i.animateOption,c=s===void 0?{enable:!1}:s;return{u_aimate:this.animateOption2Array(c),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Qx)}},{key:"initModels",value:function(){var i=this.layer.getLayerConfig(),s=i.unit,c=s===void 0?"l7size":s,g=this.mapService.version;return c==="meter"&&g!==Xp.L7MAP&&g!==Xp.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),this.buildModels()}},{key:"calMeter2Coord",value:function(){var i=Ei()(this.layer.getSource().extent,4),s=i[0],c=i[1],g=i[2],y=i[3],E=[(s+g)/2,(c+y)/2],T=this.mapService.version;if(T===Xp.MAPBOX&&window.mapboxgl.MercatorCoordinate){var I=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:E[0],lat:E[1]},0),F=1,U=F*I.meterInMercatorCoordinateUnits(),Q=new window.mapboxgl.MercatorCoordinate(I.x-U,I.y,I.z),ue=Q.toLngLat();this.meter2coord=E[0]-ue.lng;return}var de=this.mapService.meterToCoord(E,[s,c]),Re=this.mapService.meterToCoord(E,[g===s?g+.1:g,y===c?c+.1:y]);this.meter2coord=(de+Re)/2,Boolean(this.meter2coord)||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g,E=i.animateOption,T=E===void 0?{enable:!1}:E,I=this.getShaders(T),F=I.frag,U=I.vert,Q=I.type,ue=this.mapService.version==="GLOBEL";return[this.layer.buildLayerModel({moduleName:"pointfill-"+Q,vertexShader:U,fragmentShader:F,triangulation:ue?eM:Qx,depth:{enable:ue},blend:this.getBlend(),stencil:Ii(c,y)})]}},{key:"getShaders",value:function(i){if(i.enable)switch(i.type){case"wave":return{frag:db,vert:jy,type:"wave"};default:return{frag:db,vert:jy,type:"wave"}}else return{frag:aO,vert:jy,type:"normal"}}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var i=this,s=this.mapService.version==="GLOBEL";this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Yi.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(g,y,E,T){var I;if(s){var F=Ei()(E,3),U=F[0],Q=F[1],ue=F[2],de=V.fromValues(0,0,1),Re=V.fromValues(U,0,ue),et=U>=0?V.angle(de,Re):Math.PI*2-V.angle(de,Re),ht=Math.PI*2-Math.asin(Q/100),xt=k.create();k.rotateY(xt,xt,et),k.rotateX(xt,xt,ht);var Gt=V.fromValues(1,1,0);V.transformMat4(Gt,Gt,xt),V.normalize(Gt,Gt);var jt=V.fromValues(-1,1,0);V.transformMat4(jt,jt,xt),V.normalize(jt,jt);var Qt=V.fromValues(-1,-1,0);V.transformMat4(Qt,Qt,xt),V.normalize(Qt,Qt);var fr=V.fromValues(1,-1,0);V.transformMat4(fr,fr,xt),V.normalize(fr,fr),I=[].concat(Ut()(Gt),Ut()(jt),Ut()(Qt),Ut()(fr))}else I=[1,1,0,-1,1,0,-1,-1,0,1,-1,0];var Gr=T%4*3;return[I[Gr],I[Gr+1],I[Gr+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(g,y,E,T){var I=g.size,F=I===void 0?5:I;return Array.isArray(F)?[F[0]*i.meter2coord]:[F*i.meter2coord]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Yi.Attribute,descriptor:{name:"a_Shape",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(g,y,E,T){var I=g.shape,F=I===void 0?2:I,U=i.layer.getLayerConfig().shape2d,Q=U.indexOf(F);return[Q]}}})}}]),t}(Ju);function oO(e){var r=sO();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function sO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var uO=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main(){
      float opacity = styleMappingMat[0][0];
      float size = styleMappingMat[1][0];
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,lO=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;

uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  styleMappingMat[1][0] = a_Size;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  //  vec2 offset = project_pixel(u_offsets);
  vec2 offset = project_pixel(textrueOffsets);

  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
    }
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,cO=function(e){qr()(t,e);var r=oO(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"texture",void 0),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity;return{u_opacity:s||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var i=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){i.updateTexture(),i.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:lO,fragmentShader:uO,triangulation:eb,primitive:ve.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(c,g,y,E){var T=c.size;return Array.isArray(T)?[T[0]]:[T]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Yi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(c,g,y,E){var T=i.fontService.mapping,I=c.shape,F=i.fontService.getGlyph(I),U=T[F],Q=U.x,ue=U.y;return[Q,ue]}}})}},{key:"updateTexture",value:function(){var i=this.rendererService.createTexture2D,s=this.fontService.canvas;this.texture=i({data:s,mag:ve.LINEAR,min:ve.LINEAR,width:s.width,height:s.height})}},{key:"initIconFontGlyphs",value:function(){var i=this,s=this.layer.getLayerConfig(),c=s.fontWeight,g=c===void 0?"normal":c,y=s.fontFamily,E=y===void 0?"sans-serif":y,T=this.layer.getEncodedData(),I=[];T.forEach(function(F){var U=F.shape,Q=U===void 0?"":U;Q=Q.toString();var ue=i.fontService.getGlyph(Q);I.indexOf(ue)===-1&&I.push(ue)}),this.fontService.setFontOptions({characterSet:I,fontWeight:g,fontFamily:E,fontSize:48})}}]),t}(Ju);function fO(e){var r=hO();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function hO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var pO=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main(){
      float opacity = styleMappingMat[0][0];
      float size = styleMappingMat[1][0];
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,dO=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;

uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  styleMappingMat[1][0] = a_Size;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  //  vec2 offset = project_pixel(u_offsets);
  vec2 offset = project_pixel(textrueOffsets);

  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
    }
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,mb=function(e){qr()(t,e);var r=fO(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"texture",void 0),w()(ce()(n),"updateTexture",function(){var g=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),n.layer.renderLayers();return}n.texture=g({data:n.iconService.getCanvas(),mag:ve.LINEAR,min:ve.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128,mipmap:!0})}),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=i.offsets,g=c===void 0?[0,0]:c;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s,offsets:g})){this.judgeStyleAttributes({opacity:s,offsets:g});var y=this.layer.getEncodedData(),E=this.calDataFrame(this.cellLength,y,this.cellProperties),T=E.data,I=E.width,F=E.height;this.rowCount=F,this.dataTexture=this.cellLength>0&&T.length>0?this.createTexture2D({flipY:!0,data:T,format:ve.LUMINANCE,type:ve.FLOAT,width:I,height:F}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:Ro()(s)?s:1,u_offsets:this.isOffsetStatic(g)?g:[0,0]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.dataTexture)===null||s===void 0||s.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g;return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:dO,fragmentShader:pO,triangulation:eb,primitive:ve.POINTS,depth:{enable:!1},blend:this.getBlend(),stencil:Ii(c,y)})]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(c,g,y,E){var T=c.size,I=T===void 0?5:T;return Array.isArray(I)?[I[0]]:[I]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Yi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(c,g,y,E){var T=i.iconService.getIconMap(),I=c.shape,F=T[I]||{x:0,y:0},U=F.x,Q=F.y;return[U,Q]}}})}}]),t}(Ju);function vO(e){var r=mO();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function mO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var gO=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
void main() {
  float opacity = styleMappingMat[0][0];

  gl_FragColor = v_color;
  // gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor.a =gl_FragColor.a * opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,yO=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping
  
  // vec2 offset = project_pixel(u_offsets);
  vec2 offset = project_pixel(textrueOffsets);
  // vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  // gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\\
  // 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // vec2 offset = project_pixel((u_offsets));
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    // vec2 offset = project_pixel(u_offsets);
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function _O(e){var r=e.coordinates;return{vertices:Ut()(r),indices:[0],size:r.length}}var gb=function(e){qr()(t,e);var r=vO(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,g=i.offsets,y=g===void 0?[0,0]:g;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:c,offsets:y})){this.judgeStyleAttributes({opacity:c,offsets:y});var E=this.layer.getEncodedData(),T=this.calDataFrame(this.cellLength,E,this.cellProperties),I=T.data,F=T.width,U=T.height;this.rowCount=U,this.dataTexture=this.cellLength>0&&I.length>0?this.createTexture2D({flipY:!0,data:I,format:ve.LUMINANCE,type:ve.FLOAT,width:F,height:U}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Ro()(c)?c:1,u_offsets:this.isOffsetStatic(y)?y:[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g;return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:yO,fragmentShader:gO,triangulation:_O,depth:{enable:!1},primitive:ve.POINTS,blend:this.getBlend(),stencil:Ii(c,y)})]}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(s,c,g,y){var E=s.size,T=E===void 0?1:E;return Array.isArray(T)?[T[0]]:[T]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:Gh.additive}}}]),t}(Ju);function xO(e){var r=bO();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function bO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var EO=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_additive;

uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  float opacity = styleMappingMat[0][0];
  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);

  

  
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,SO=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143
varying float v_blur;
varying float v_innerRadius;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = a_Color;
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping
  
  // vec2 offset = project_pixel(u_offsets);
  vec2 offset = project_pixel(textrueOffsets);
  // vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  // gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\\
  // 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // vec2 offset = project_pixel((u_offsets));
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    // vec2 offset = project_pixel(u_offsets);
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function CO(e){var r=e.coordinates;return{vertices:Ut()(r),indices:[0],size:r.length}}var wO=function(e){qr()(t,e);var r=xO(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,g=i.offsets,y=g===void 0?[0,0]:g,E=i.blend,T=i.strokeOpacity,I=T===void 0?1:T,F=i.strokeWidth,U=F===void 0?0:F,Q=i.stroke,ue=Q===void 0?"#fff":Q;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:c,offsets:y})){this.judgeStyleAttributes({opacity:c,offsets:y});var de=this.layer.getEncodedData(),Re=this.calDataFrame(this.cellLength,de,this.cellProperties),et=Re.data,ht=Re.width,xt=Re.height;this.rowCount=xt,this.dataTexture=this.cellLength>0&&et.length>0?this.createTexture2D({flipY:!0,data:et,format:ve.LUMINANCE,type:ve.FLOAT,width:ht,height:xt}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}return{u_additive:E==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Ro()(c)?c:1,u_offsets:this.isOffsetStatic(y)?y:[0,0],u_stroke_opacity:Ro()(I)?I:1,u_stroke_width:Ro()(U)?U:0,u_stroke_color:this.getStrokeColor(ue)}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g;return[this.layer.buildLayerModel({moduleName:"simplepoint",vertexShader:SO,fragmentShader:EO,triangulation:CO,depth:{enable:!1},primitive:ve.POINTS,blend:this.getBlend(),stencil:Ii(c,y)})]}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(s,c,g,y){var E=s.size,T=E===void 0?1:E;return Array.isArray(T)?[T[0]]:[T]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:Gh.additive}}}]),t}(Ju);function AO(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=TO(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function TO(e,r){if(!!e){if(typeof e=="string")return yb(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return yb(e,r)}}function yb(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var MO=function(){function e(r,t,n){Ft()(this,e),w()(this,"boxCells",[]),w()(this,"xCellCount",void 0),w()(this,"yCellCount",void 0),w()(this,"boxKeys",void 0),w()(this,"bboxes",void 0),w()(this,"width",void 0),w()(this,"height",void 0),w()(this,"xScale",void 0),w()(this,"yScale",void 0),w()(this,"boxUid",void 0);var i=this.boxCells;this.xCellCount=Math.ceil(r/n),this.yCellCount=Math.ceil(t/n);for(var s=0;s<this.xCellCount*this.yCellCount;s++)i.push([]);this.boxKeys=[],this.bboxes=[],this.width=r,this.height=t,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/t,this.boxUid=0}return Yt()(e,[{key:"insert",value:function(t,n,i,s,c){this.forEachCell(n,i,s,c,this.insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(c)}},{key:"query",value:function(t,n,i,s,c){return this.queryHitTest(t,n,i,s,!1,c)}},{key:"hitTest",value:function(t,n,i,s,c){return this.queryHitTest(t,n,i,s,!0,c)}},{key:"insertBoxCell",value:function(t,n,i,s,c,g){this.boxCells[c].push(g)}},{key:"queryHitTest",value:function(t,n,i,s,c,g){if(i<0||t>this.width||s<0||n>this.height)return c?!1:[];var y=[];if(t<=0&&n<=0&&this.width<=i&&this.height<=s){if(c)return!0;for(var E=0;E<this.boxKeys.length;E++)y.push({key:this.boxKeys[E],x1:this.bboxes[E*4],y1:this.bboxes[E*4+1],x2:this.bboxes[E*4+2],y2:this.bboxes[E*4+3]});return g?y.filter(g):y}var T={hitTest:c,seenUids:{box:{},circle:{}}};return this.forEachCell(t,n,i,s,this.queryCell,y,T,g),c?y.length>0:y}},{key:"queryCell",value:function(t,n,i,s,c,g,y,E){var T=y.seenUids,I=this.boxCells[c];if(I!==null){var F=this.bboxes,U=AO(I),Q;try{for(U.s();!(Q=U.n()).done;){var ue=Q.value;if(!T.box[ue]){T.box[ue]=!0;var de=ue*4;if(t<=F[de+2]&&n<=F[de+3]&&i>=F[de+0]&&s>=F[de+1]&&(!E||E(this.boxKeys[ue]))){if(y.hitTest)return g.push(!0),!0;g.push({key:this.boxKeys[ue],x1:F[de],y1:F[de+1],x2:F[de+2],y2:F[de+3]})}}}}catch(Re){U.e(Re)}finally{U.f()}}return!1}},{key:"forEachCell",value:function(t,n,i,s,c,g,y,E){for(var T=this.convertToXCellCoord(t),I=this.convertToYCellCoord(n),F=this.convertToXCellCoord(i),U=this.convertToYCellCoord(s),Q=T;Q<=F;Q++)for(var ue=I;ue<=U;ue++){var de=this.xCellCount*ue+Q;if(c.call(this,t,n,i,s,de,g,y,E))return}}},{key:"convertToXCellCoord",value:function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}},{key:"convertToYCellCoord",value:function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}}]),e}(),PO=MO,OO=function(){function e(r,t){Ft()(this,e),w()(this,"width",void 0),w()(this,"height",void 0),w()(this,"grid",void 0),w()(this,"viewportPadding",100),w()(this,"screenRightBoundary",void 0),w()(this,"screenBottomBoundary",void 0),w()(this,"gridRightBoundary",void 0),w()(this,"gridBottomBoundary",void 0),this.width=r,this.height=t,this.viewportPadding=Math.max(r,t),this.grid=new PO(r+this.viewportPadding,t+this.viewportPadding,25),this.screenRightBoundary=r+this.viewportPadding,this.screenBottomBoundary=t+this.viewportPadding,this.gridRightBoundary=r+2*this.viewportPadding,this.gridBottomBoundary=t+2*this.viewportPadding}return Yt()(e,[{key:"placeCollisionBox",value:function(t){var n=t.x1+t.anchorPointX+this.viewportPadding,i=t.y1+t.anchorPointY+this.viewportPadding,s=t.x2+t.anchorPointX+this.viewportPadding,c=t.y2+t.anchorPointY+this.viewportPadding;return!this.isInsideGrid(n,i,s,c)||this.grid.hitTest(n,i,s,c)?{box:[]}:{box:[n,i,s,c]}}},{key:"insertCollisionBox",value:function(t,n){var i={featureIndex:n};this.grid.insert(i,t[0],t[1],t[2],t[3])}},{key:"project",value:function(t,n,i){var s=H.fromValues(n,i,0,1),c=H.create(),g=k.fromValues.apply(k,Ut()(t));return H.transformMat4(c,s,g),{x:(c[0]/c[3]+1)/2*this.width+this.viewportPadding,y:(-c[1]/c[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(t,n,i,s){return i>=0&&t<this.gridRightBoundary&&s>=0&&n<this.gridBottomBoundary}}]),e}();function _b(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=IO(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function IO(e,r){if(!!e){if(typeof e=="string")return xb(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xb(e,r)}}function xb(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function bb(e){var r=.5,t=.5;switch(e){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0;break;default:r=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":t=1;break;case"top":case"top-right":case"top-left":t=0;break;default:t=.5}return{horizontalAlign:r,verticalAlign:t}}function Eb(e,r,t,n,i){if(!!i){var s=e[n],c=s.glyph;if(c)for(var g=r[c].advance*s.scale,y=(e[n].x+g)*i,E=t;E<=n;E++)e[E].x-=y}}function Sb(e,r,t,n,i,s,c){var g=(r-t)*i,y=(-n*c+.5)*s,E=_b(e),T;try{for(E.s();!(T=E.n()).done;){var I=T.value;I.x+=g,I.y+=y}}catch(F){E.e(F)}finally{E.f()}}function RO(e,r,t,n,i,s,c){var g=-8,y=0,E=g,T=0,I=e.positionedGlyphs,F=s==="right"?1:s==="left"?0:.5,U=I.length;t.forEach(function(et){if(et.split("").forEach(function(xt){var Gt=r[xt],jt=0;Gt&&(I.push({glyph:xt,x:y,y:E+jt,vertical:!1,scale:1,metrics:Gt}),y+=Gt.advance+c)}),I.length!==U){var ht=y-c;T=Math.max(ht,T),Eb(I,r,U,I.length-1,F)}y=0,E-=n+5});var Q=bb(i),ue=Q.horizontalAlign,de=Q.verticalAlign;Sb(I,F,ue,de,T,n,t.length);var Re=E-g;e.top+=-de*Re,e.bottom=e.top-Re,e.left+=-ue*T,e.right=e.left+T}function LO(e,r,t,n,i,s,c){var g=-8,y=0,E=g,T=0,I=e.positionedGlyphs,F=s==="right"?1:s==="left"?0:.5,U=I.length;t.forEach(function(et){var ht=r[et],xt=0;if(ht&&(I.push({glyph:et,x:y,y:E+xt,vertical:!1,scale:1,metrics:ht}),y+=ht.advance+c),I.length!==U){var Gt=y-c;T=Math.max(Gt,T),Eb(I,r,U,I.length-1,F)}y=0,E-=n+5});var Q=bb(i),ue=Q.horizontalAlign,de=Q.verticalAlign;Sb(I,F,ue,de,T,n,t.length);var Re=E-g;e.top+=-de*Re,e.bottom=e.top-Re,e.left+=-ue*T,e.right=e.left+T}function kO(e,r,t,n,i,s){var c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],g=arguments.length>7?arguments[7]:void 0,y=e.split(`
`),E=[],T={positionedGlyphs:E,top:c[1],bottom:c[1],left:c[0],right:c[0],lineCount:y.length,text:e};return g?LO(T,r,y,t,n,i,s):RO(T,r,y,t,n,i,s),E.length?T:!1}function DO(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],t=arguments.length>2?arguments[2]:void 0,n=e.positionedGlyphs,i=n===void 0?[]:n,s=[],c=_b(i),g;try{for(c.s();!(g=c.n()).done;){var y=g.value,E=y.metrics,T=4,I=E.advance*y.scale/2,F=t?[y.x+I,y.y]:[0,0],U=t?[0,0]:[y.x+I+r[0],y.y+r[1]],Q=(0-T)*y.scale-I+U[0],ue=(0-T)*y.scale+U[1],de=Q+E.width*y.scale,Re=ue+E.height*y.scale,et={x:Q,y:ue},ht={x:de,y:ue},xt={x:Q,y:Re},Gt={x:de,y:Re};s.push({tl:et,tr:ht,bl:xt,br:Gt,tex:E,glyphOffset:F})}}catch(jt){c.e(jt)}finally{c.f()}return s}function FO(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=BO(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function BO(e,r){if(!!e){if(typeof e=="string")return Cb(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Cb(e,r)}}function Cb(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function NO(e){var r=zO();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function zO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var wb=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
void main() {
  // get style data mapping
  float opacity = styleMappingMat[0][0];
  float strokeWidth = styleMappingMat[0][2];
  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ab=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Tb(e){var r=this,t=e.id,n=[],i=[];if(!r.glyphInfoMap||!r.glyphInfoMap[t])return{vertices:[],indices:[],size:7};var s=r.glyphInfoMap[t].centroid,c=s.length===2?[s[0],s[1],0]:s;return r.glyphInfoMap[t].glyphQuads.forEach(function(g,y){n.push.apply(n,Ut()(c).concat([g.tex.x,g.tex.y+g.tex.height,g.tl.x,g.tl.y],Ut()(c),[g.tex.x+g.tex.width,g.tex.y+g.tex.height,g.tr.x,g.tr.y],Ut()(c),[g.tex.x+g.tex.width,g.tex.y,g.br.x,g.br.y],Ut()(c),[g.tex.x,g.tex.y,g.bl.x,g.bl.y])),i.push(0+y*4,1+y*4,2+y*4,2+y*4,3+y*4,0+y*4)}),{vertices:n,indices:i,size:7}}var Mb=function(e){qr()(t,e);var r=NO(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"glyphInfo",void 0),w()(ce()(n),"glyphInfoMap",{}),w()(ce()(n),"texture",void 0),w()(ce()(n),"currentZoom",-1),w()(ce()(n),"extent",void 0),w()(ce()(n),"textureHeight",0),w()(ce()(n),"textCount",0),w()(ce()(n),"preTextStyle",{}),w()(ce()(n),"buildModels",function(){var g=n.layer.getLayerConfig(),y=g.mask,E=y===void 0?!1:y,T=g.maskInside,I=T===void 0?!0:T;return n.initGlyph(),n.updateTexture(),n.filterGlyphs(),n.reBuildModel(),[n.layer.buildLayerModel({moduleName:"pointText",vertexShader:Ab,fragmentShader:wb,triangulation:Tb.bind(ce()(n)),depth:{enable:!1},blend:n.getBlend(),stencil:Ii(E,I)})]}),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,g=i.stroke,y=g===void 0?"#fff":g,E=i.strokeWidth,T=E===void 0?0:E,I=i.textAnchor,F=I===void 0?"center":I,U=i.textAllowOverlap,Q=U===void 0?!1:U,ue=i.halo,de=ue===void 0?.5:ue,Re=i.gamma,et=Re===void 0?2:Re,ht=this.fontService,xt=ht.canvas,Gt=ht.mapping;if(Object.keys(Gt).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(Gt).length),this.preTextStyle={textAnchor:F,textAllowOverlap:Q},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:c,strokeWidth:T,stroke:y})){this.judgeStyleAttributes({opacity:c,strokeWidth:T,stroke:y});var jt=this.layer.getEncodedData(),Qt=this.calDataFrame(this.cellLength,jt,this.cellProperties),fr=Qt.data,Gr=Qt.width,Jr=Qt.height;this.rowCount=Jr,this.dataTexture=this.cellLength>0&&fr.length>0?this.createTexture2D({flipY:!0,data:fr,format:ve.LUMINANCE,type:ve.FLOAT,width:Gr,height:Jr}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Ro()(c)?c:1,u_stroke_width:Ro()(T)?T:0,u_stroke_color:this.getStrokeColor(y),u_sdf_map:this.texture,u_halo_blur:de,u_gamma_scale:et,u_sdf_map_size:[xt.width,xt.height]}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var i=this.layer.getLayerConfig(),s=i.textAnchor,c=s===void 0?"center":s,g=i.textAllowOverlap,y=g===void 0?!0:g;return this.preTextStyle={textAnchor:c,textAllowOverlap:y},this.buildModels()}},{key:"needUpdate",value:function(){var i=this.layer.getLayerConfig(),s=i.textAllowOverlap,c=s===void 0?!1:s,g=this.mapService.getZoom(),y=this.mapService.getBounds(),E=dl(this.extent,y);return!c&&(Math.abs(this.currentZoom-g)>1||!E)||c!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy(),this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Yi.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(s,c,g,y){var E=s.rotate,T=E===void 0?0:E;return Array.isArray(T)?[T[0]]:[T]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Yi.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(s,c,g,y){return[g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(s,c,g,y){var E=s.size,T=E===void 0?12:E;return Array.isArray(T)?[T[0]]:[T]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Yi.Attribute,descriptor:{name:"a_tex",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(s,c,g,y){return[g[3],g[4]]}}})}},{key:"textExtent",value:function(){var i=this.mapService.getBounds();return Wl(i,.5)}},{key:"initTextFont",value:function(){var i=this.layer.getLayerConfig(),s=i.fontWeight,c=s===void 0?"400":s,g=i.fontFamily,y=g===void 0?"sans-serif":g,E=this.layer.getEncodedData(),T=[];E.forEach(function(I){var F=I.shape,U=F===void 0?"":F;U=U.toString();var Q=FO(U),ue;try{for(Q.s();!(ue=Q.n()).done;){var de=ue.value;T.indexOf(de)===-1&&T.push(de)}}catch(Re){Q.e(Re)}finally{Q.f()}}),this.fontService.setFontOptions({characterSet:T,fontWeight:c,fontFamily:y,iconfont:!1})}},{key:"initIconFontTex",value:function(){var i=this.layer.getLayerConfig(),s=i.fontWeight,c=s===void 0?"400":s,g=i.fontFamily,y=g===void 0?"sans-serif":g,E=this.layer.getEncodedData(),T=[];E.forEach(function(I){var F=I.shape,U=F===void 0?"":F;U="".concat(U),T.indexOf(U)===-1&&T.push(U)}),this.fontService.setFontOptions({characterSet:T,fontWeight:c,fontFamily:y,iconfont:!0})}},{key:"generateGlyphLayout",value:function(i){var s=this,c=this.fontService.mapping,g=this.layer.getLayerConfig(),y=g.spacing,E=y===void 0?2:y,T=g.textAnchor,I=T===void 0?"center":T,F=this.layer.getEncodedData();this.glyphInfo=F.map(function(U){var Q=U.shape,ue=Q===void 0?"":Q,de=U.id,Re=U.size,et=Re===void 0?1:Re,ht=U.textOffset,xt=ht===void 0?[0,0]:ht,Gt=kO(ue.toString(),c,et,I,"left",E,xt,i),jt=DO(Gt,xt,!1);return U.shaping=Gt,U.glyphQuads=jt,U.centroid=Nv(U.coordinates),U.originCentroid=U.version==="GAODE2.x"?Nv(U.originCoordinates):U.originCentroid=U.centroid,s.glyphInfoMap[de]={shaping:Gt,glyphQuads:jt,centroid:Nv(U.coordinates)},U})}},{key:"filterGlyphs",value:function(){var i=this,s=this.layer.getLayerConfig(),c=s.padding,g=c===void 0?[4,4]:c,y=s.textAllowOverlap,E=y===void 0?!1:y;if(!E){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var T=this.rendererService.getViewportSize(),I=T.width,F=T.height,U=new OO(I,F),Q=this.glyphInfo.filter(function(ue){var de=ue.shaping,Re=ue.id,et=Re===void 0?0:Re,ht=ue.version==="GAODE2.x"?ue.originCentroid:ue.centroid,xt=ue.size,Gt=xt/24,jt=i.mapService.lngLatToContainer(ht),Qt=U.placeCollisionBox({x1:de.left*Gt-g[0],x2:de.right*Gt+g[0],y1:de.top*Gt-g[1],y2:de.bottom*Gt+g[1],anchorPointX:jt.x,anchorPointY:jt.y}),fr=Qt.box;return fr&&fr.length?(U.insertCollisionBox(fr,et),!0):!1});Q.forEach(function(ue){i.glyphInfoMap[ue.id]=ue})}}},{key:"initGlyph",value:function(){var i=this.layer.getLayerConfig(),s=i.iconfont,c=s===void 0?!1:s;c?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(c)}},{key:"updateTexture",value:function(){var i=this.rendererService.createTexture2D,s=this.fontService.canvas;this.textureHeight=s.height,this.texture&&this.texture.destroy(),this.texture=i({data:s,mag:ve.LINEAR,min:ve.LINEAR,width:s.width,height:s.height})}},{key:"reBuildModel",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g;this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Ab,fragmentShader:wb,triangulation:Tb.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:Ii(c,y)})]}}]),t}(Ju),UO={fill:vb,image:mb,normal:gb,simplePoint:wO,extrude:pb,text:Mb,icon:cO},jO=UO;function VO(e){var r=GO();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function GO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var HO=function(e){qr()(t,e);var r=VO(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"type","PointLayer"),n}return Yt()(t,[{key:"buildModels",value:function(){var i=this.getModelType();this.layerModel=new jO[i](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),s={normal:{blend:"additive"},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return s[i]}},{key:"getModelType",value:function(){var i=this.getEncodedData(),s=this.getLayerConfig(),c=s.shape2d,g=s.shape3d,y=this.iconService.getIconMap(),E=i.find(function(I){return I.hasOwnProperty("shape")});if(E){var T=E.shape;return T==="dot"?"normal":T==="simple"?"simplePoint":(c==null?void 0:c.indexOf(T))!==-1?"fill":(g==null?void 0:g.indexOf(T))!==-1?"extrude":y.hasOwnProperty(T)?"image":this.fontService.getGlyph(T)!==""?"icon":"text"}else return"normal"}}]),t}(Bv);function WO(e){var r=ZO();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function ZO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var XO=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  // gl_FragColor.a *= u_opacity;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,YO=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"
varying float v_lightWeight;

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  // gl_FragColor.a *= u_opacity;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorWithLight(gl_FragColor, v_lightWeight);
}
`,KO=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

varying float v_lightWeight;

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      project_pos.z *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  v_lightWeight = lightWeight;
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,$O=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      project_pos.z *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,qO=function(e){qr()(t,e);var r=WO(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,g=i.heightfixed,y=g===void 0?!1:g;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:c})){this.judgeStyleAttributes({opacity:c});var E=this.layer.getEncodedData(),T=this.calDataFrame(this.cellLength,E,this.cellProperties),I=T.data,F=T.width,U=T.height;this.rowCount=U,this.dataTexture=this.cellLength>0&&I.length>0?this.createTexture2D({flipY:!0,data:I,format:ve.LUMINANCE,type:ve.FLOAT,width:F,height:U}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}return{u_heightfixed:Number(y),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Ro()(c)?c:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.pickLight,c=s===void 0?!1:s,g=i.mask,y=g===void 0?!1:g,E=i.maskInside,T=E===void 0?!0:E;return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:c?KO:$O,fragmentShader:c?YO:XO,triangulation:rb,stencil:Ii(y,T)})]}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:Yi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(s,c,g,y,E){return E}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Yi.Attribute,descriptor:{name:"a_Size",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(s,c,g,y){var E=s.size,T=E===void 0?10:E;return Array.isArray(T)?[T[0]]:[T]}}})}}]),t}(Ju);function QO(e){var r=JO();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function JO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var eI=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,tI=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;


void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,rI=`attribute vec4 a_Color;
attribute vec3 a_Position;



uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}`,nI=`attribute vec4 a_Color;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,iI=function(e){qr()(t,e);var r=QO(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,g=i.opacityLinear,y=g===void 0?{enable:!1,dir:"in"}:g;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:c})){this.judgeStyleAttributes({opacity:c});var E=this.layer.getEncodedData(),T=this.calDataFrame(this.cellLength,E,this.cellProperties),I=T.data,F=T.width,U=T.height;this.rowCount=U,this.dataTexture=this.cellLength>0&&I.length>0?this.createTexture2D({flipY:!0,data:I,format:ve.LUMINANCE,type:ve.FLOAT,width:F,height:U}):this.createTexture2D({flipY:!0,data:[1],format:ve.LUMINANCE,type:ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Ro()(c)?c:1,u_opacitylinear:Number(y.enable),u_dir:y.dir==="in"?1:0}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var i=this.layer.getLayerConfig(),s=i.opacityLinear,c=s===void 0?{enable:!1,dir:"in"}:s,g=i.mask,y=g===void 0?!1:g,E=i.maskInside,T=E===void 0?!0:E;return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:c.enable?rI:nI,fragmentShader:c.enable?tI:eI,triangulation:c.enable?nM:rM,blend:this.getBlend(),depth:{enable:!1},stencil:Ii(y,T)})]}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getLayerConfig(),s=i.opacityLinear,c=s===void 0?{enable:!1,dir:"in"}:s;c.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:Yi.Attribute,descriptor:{name:"a_linear",buffer:{usage:ve.STATIC_DRAW,data:[],type:ve.FLOAT},size:3,update:function(y,E,T,I,F){return[T[3],T[4],T[5]]}}})}}]),t}(Ju),aI={fill:iI,line:fb,extrude:qO,text:Mb,point_fill:vb,point_image:mb,point_normal:gb,point_extrude:pb},oI=aI;function sI(e){var r=uI();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function uI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Pb=function(e){qr()(t,e);var r=sI(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"type","PolygonLayer"),n}return Yt()(t,[{key:"buildModels",value:function(){var i=this.getModelType();this.layerModel=new oI[i](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var i,s=this.styleAttributeService.getLayerStyleAttribute("shape"),c=s==null||(i=s.scale)===null||i===void 0?void 0:i.field;return c==="fill"?"fill":c==="extrude"?"extrude":c==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var i=this.getEncodedData(),s=this.getLayerConfig(),c=s.shape2d,g=s.shape3d,y=this.iconService.getIconMap(),E=i.find(function(I){return I.hasOwnProperty("shape")});if(E){var T=E.shape;return T==="dot"?"point_normal":(c==null?void 0:c.indexOf(T))!==-1?"point_fill":(g==null?void 0:g.indexOf(T))!==-1?"point_extrude":y.hasOwnProperty(T)?"point_image":"text"}else return"fill"}}]),t}(Bv);function lI(e){var r=cI();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function cI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fI=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,hI=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,Ob=function(e){qr()(t,e);var r=lI(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"texture",void 0),w()(ce()(n),"colorTexture",void 0),n}return Yt()(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),s=i.opacity,c=s===void 0?1:s,g=i.clampLow,y=g===void 0?!0:g,E=i.clampHigh,T=E===void 0?!0:E,I=i.noDataValue,F=I===void 0?-9999999:I,U=i.domain,Q=U===void 0?[0,1]:U;return this.updateColorTexure(),{u_opacity:c||1,u_texture:this.texture,u_domain:Q,u_clampLow:y,u_clampHigh:typeof T!="undefined"?T:y,u_noDataValue:F,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var i=this.layer.getLayerConfig(),s=i.mask,c=s===void 0?!1:s,g=i.maskInside,y=g===void 0?!0:g,E=this.layer.getSource(),T=this.rendererService.createTexture2D,I=E.data.dataArray[0];this.texture=T({data:I.data,width:I.width,height:I.height,format:ve.LUMINANCE,type:ve.FLOAT});var F=this.layer.getLayerConfig(),U=F.rampColors,Q=Vn(U);return this.colorTexture=T({data:Q.data,width:Q.width,height:Q.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:hI,fragmentShader:fI,triangulation:ib,primitive:ve.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:Ii(c,y)})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Yi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:2,update:function(s,c,g,y){return[g[3],g[4]]}}})}},{key:"updateColorTexure",value:function(){var i=this.rendererService.createTexture2D,s=this.layer.getLayerConfig(),c=s.rampColors,g=Vn(c);this.colorTexture=i({data:g.data,width:g.width,height:g.height,flipY:!1})}}]),t}(Ju),pI={raster:Ob,raster3d:Ob},dI=pI;function vI(e){var r=mI();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function mI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var gI=function(e){qr()(t,e);var r=vI(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"type","RasterLayer"),n}return Yt()(t,[{key:"buildModels",value:function(){var i=this.getModelType();this.layerModel=new dI[i](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),s={raster:{},raster3d:{}};return s[i]}},{key:"getModelType",value:function(){return"raster"}}]),t}(Bv),Ib,Rb,Lb,kb,Db,r0,Fb,Bb,Nb;function zb(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function yI(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?zb(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):zb(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var _I=(Ib=Object(Cr.injectable)(),Rb=Object(Cr.inject)(sr.IGlobalConfigService),Lb=Object(Cr.inject)(sr.IMapService),kb=Object(Cr.inject)(sr.IFontService),Ib(Db=(r0=function(){function e(){Ft()(this,e),Di()(this,"configService",Fb,this),Di()(this,"mapService",Bb,this),Di()(this,"fontService",Nb,this)}return Yt()(e,[{key:"apply",value:function(t,n){var i=this,s=n.styleAttributeService;t.hooks.init.tap("DataMappingPlugin",function(){i.generateMaping(t,{styleAttributeService:s})}),t.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return t.dataState.dataMappingNeedUpdate=!1,i.generateMaping(t,{styleAttributeService:s}),!0}),t.hooks.beforeRender.tap("DataMappingPlugin",function(){if(!t.layerModelNeedUpdate){var c=t.getBottomColor(),g=s.getLayerStyleAttributes()||[],y=s.getLayerStyleAttribute("filter"),E=t.getSource().data.dataArray,T=g.filter(function(F){return F.needRemapping}),I=E;y!=null&&y.needRemapping&&y!==null&&y!==void 0&&y.scale&&(I=E.filter(function(F){return i.applyAttributeMapping(y,F,c)[0]})),T.length&&(y!=null&&y.needRemapping?(t.setEncodedData(i.mapping(g,I,void 0,c)),y.needRemapping=!1):t.setEncodedData(i.mapping(T,I,t.getEncodedData(),c)),t.emit("remapping",null))}})}},{key:"generateMaping",value:function(t,n){var i=this,s=n.styleAttributeService,c=t.getBottomColor(),g=s.getLayerStyleAttributes()||[],y=s.getLayerStyleAttribute("filter"),E=t.getSource().data.dataArray,T=E;y!=null&&y.scale&&(T=E.filter(function(I){return i.applyAttributeMapping(y,I,c)[0]})),t.setEncodedData(this.mapping(g,T,void 0,c))}},{key:"mapping",value:function(t,n,i,s){var c=this,g=n.map(function(y,E){var T=i?i[E]:{},I=yI({id:y._id,coordinates:y.coordinates},T);return t.filter(function(F){return F.scale!==void 0}).forEach(function(F){var U=c.applyAttributeMapping(F,y,s);F.needRemapping=!1,F.name==="color"&&(U=U.map(function(Q){return Dr(Q)})),I[F.name]=Array.isArray(U)&&U.length===1?U[0]:U,F.name==="shape"&&(I.shape=c.fontService.getIconFontKey(I[F.name]))}),I});return g.length>0&&this.mapService.version==="GAODE2.x"&&(typeof g[0].coordinates[0]=="number"?g.filter(function(y){return!y.originCoordinates}).map(function(y){y.version="GAODE2.x",y.originCoordinates=Ws()(y.coordinates),y.coordinates=c.mapService.lngLatToCoord(y.coordinates)}):g.filter(function(y){return!y.originCoordinates}).map(function(y){y.version="GAODE2.x",y.originCoordinates=Ws()(y.coordinates),y.coordinates=c.mapService.lngLatToCoords(y.coordinates)})),g}},{key:"applyAttributeMapping",value:function(t,n,i){var s;if(!t.scale)return[];var c=(t==null||(s=t.scale)===null||s===void 0?void 0:s.scalers)||[],g=[];c.forEach(function(E){var T,I=E.field;(n.hasOwnProperty(I)||((T=t.scale)===null||T===void 0?void 0:T.type)==="variable")&&g.push(n[I])});var y=t.mapping?t.mapping(g):[];return t.name==="color"&&!Tr(y[0])?[i]:y}}]),e}(),Fb=Vi()(r0.prototype,"configService",[Rb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bb=Vi()(r0.prototype,"mapService",[Lb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nb=Vi()(r0.prototype,"fontService",[kb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r0))||Db),Ub,jb,xI=(Ub=Object(Cr.injectable)(),Ub(jb=function(){function e(){Ft()(this,e),w()(this,"mapService",void 0)}return Yt()(e,[{key:"apply",value:function(t){var n=this;this.mapService=t.getContainer().get(sr.IMapService),t.hooks.init.tap("DataSourcePlugin",function(){var i=t.getSource();if(!i){var s=t.sourceOption||{data:Lh,options:Jp},c=s.data,g=s.options;t.setSource(new oh(c,g))}n.updateClusterData(t)}),t.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var i=n.updateClusterData(t),s=t.dataState.dataSourceNeedUpdate;return t.dataState.dataSourceNeedUpdate=!1,i||s})}},{key:"updateClusterData",value:function(t){var n=t.getSource(),i=n.cluster,s=n.clusterOptions,c=s.zoom,g=c===void 0?0:c,y=s.maxZoom,E=y===void 0?16:y,T=this.mapService.getZoom()-1,I=t.dataState.dataSourceNeedUpdate;return i&&(I||Math.abs(t.clusterZoom-T)>=1)?(g!==Math.floor(T)&&n.updateClusterData(Math.floor(T)),t.clusterZoom=T,!0):!1}}]),e}())||jb),n0=function(e,r){return e<r?-1:e>r?1:e>=r?0:NaN},bI=function(e){return e.length===1&&(e=EI(e)),{left:function(t,n,i,s){for(i==null&&(i=0),s==null&&(s=t.length);i<s;){var c=i+s>>>1;e(t[c],n)<0?i=c+1:s=c}return i},right:function(t,n,i,s){for(i==null&&(i=0),s==null&&(s=t.length);i<s;){var c=i+s>>>1;e(t[c],n)>0?s=c:i=c+1}return i}}};function EI(e){return function(r,t){return n0(e(r),t)}}var Vb=bI(n0),SI=Vb.right,fF=Vb.left,CI=SI,hF=function(e,r){r==null&&(r=Gb);for(var t=0,n=e.length-1,i=e[0],s=new Array(n<0?0:n);t<n;)s[t]=r(i,i=e[++t]);return s};function Gb(e,r){return[e,r]}var pF=function(e,r,t){var n=e.length,i=r.length,s=new Array(n*i),c,g,y,E;for(t==null&&(t=Gb),c=y=0;c<n;++c)for(E=e[c],g=0;g<i;++g,++y)s[y]=t(E,r[g]);return s},dF=function(e,r){return r<e?-1:r>e?1:r>=e?0:NaN},rv=function(e){return e===null?NaN:+e},wI=function(e,r){var t=e.length,n=0,i=-1,s=0,c,g,y=0;if(r==null)for(;++i<t;)isNaN(c=rv(e[i]))||(g=c-s,s+=g/++n,y+=g*(c-s));else for(;++i<t;)isNaN(c=rv(r(e[i],i,e)))||(g=c-s,s+=g/++n,y+=g*(c-s));if(n>1)return y/(n-1)},AI=function(e,r){var t=wI(e,r);return t&&Math.sqrt(t)},Hb=function(e,r){var t=e.length,n=-1,i,s,c;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(s=c=i;++n<t;)(i=e[n])!=null&&(s>i&&(s=i),c<i&&(c=i))}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(s=c=i;++n<t;)(i=r(e[n],n,e))!=null&&(s>i&&(s=i),c<i&&(c=i));return[s,c]},Wb=Array.prototype,TI=Wb.slice,MI=Wb.map,fg=function(e){return function(){return e}},PI=function(e){return e},OI=function(e,r,t){e=+e,r=+r,t=(i=arguments.length)<2?(r=e,e=0,1):i<3?1:+t;for(var n=-1,i=Math.max(0,Math.ceil((r-e)/t))|0,s=new Array(i);++n<i;)s[n]=e+n*t;return s},Vy=Math.sqrt(50),Gy=Math.sqrt(10),Hy=Math.sqrt(2),vF=function(e,r,t){var n,i=-1,s,c,g;if(r=+r,e=+e,t=+t,e===r&&t>0)return[e];if((n=r<e)&&(s=e,e=r,r=s),(g=II(e,r,t))===0||!isFinite(g))return[];if(g>0)for(e=Math.ceil(e/g),r=Math.floor(r/g),c=new Array(s=Math.ceil(r-e+1));++i<s;)c[i]=(e+i)*g;else for(e=Math.floor(e*g),r=Math.ceil(r*g),c=new Array(s=Math.ceil(e-r+1));++i<s;)c[i]=(e-i)/g;return n&&c.reverse(),c};function II(e,r,t){var n=(r-e)/Math.max(0,t),i=Math.floor(Math.log(n)/Math.LN10),s=n/Math.pow(10,i);return i>=0?(s>=Vy?10:s>=Gy?5:s>=Hy?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=Vy?10:s>=Gy?5:s>=Hy?2:1)}function RI(e,r,t){var n=Math.abs(r-e)/Math.max(0,t),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),s=n/i;return s>=Vy?i*=10:s>=Gy?i*=5:s>=Hy&&(i*=2),r<e?-i:i}var LI=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1},mF=function(){var e=PI,r=Hb,t=LI;function n(i){var s,c=i.length,g,y=new Array(c);for(s=0;s<c;++s)y[s]=e(i[s],s,i);var E=r(y),T=E[0],I=E[1],F=t(y,T,I);Array.isArray(F)||(F=RI(T,I,F),F=OI(Math.ceil(T/F)*F,I,F));for(var U=F.length;F[0]<=T;)F.shift(),--U;for(;F[U-1]>I;)F.pop(),--U;var Q=new Array(U+1),ue;for(s=0;s<=U;++s)ue=Q[s]=[],ue.x0=s>0?F[s-1]:T,ue.x1=s<U?F[s]:I;for(s=0;s<c;++s)g=y[s],T<=g&&g<=I&&Q[CI(F,g,0,U)].push(i[s]);return Q}return n.value=function(i){return arguments.length?(e=typeof i=="function"?i:fg(i),n):e},n.domain=function(i){return arguments.length?(r=typeof i=="function"?i:fg([i[0],i[1]]),n):r},n.thresholds=function(i){return arguments.length?(t=typeof i=="function"?i:Array.isArray(i)?fg(TI.call(i)):fg(i),n):t},n},Wy=function(e,r,t){if(t==null&&(t=rv),!!(n=e.length)){if((r=+r)<=0||n<2)return+t(e[0],0,e);if(r>=1)return+t(e[n-1],n-1,e);var n,i=(n-1)*r,s=Math.floor(i),c=+t(e[s],s,e),g=+t(e[s+1],s+1,e);return c+(g-c)*(i-s)}},gF=function(e,r,t){return e=MI.call(e,rv).sort(n0),Math.ceil((t-r)/(2*(Wy(e,.75)-Wy(e,.25))*Math.pow(e.length,-1/3)))},yF=function(e,r,t){return Math.ceil((t-r)/(3.5*AI(e)*Math.pow(e.length,-1/3)))},_F=function(e,r){var t=e.length,n=-1,i,s;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(s=i;++n<t;)(i=e[n])!=null&&i>s&&(s=i)}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(s=i;++n<t;)(i=r(e[n],n,e))!=null&&i>s&&(s=i);return s},xF=function(e,r){var t=e.length,n=t,i=-1,s,c=0;if(r==null)for(;++i<t;)isNaN(s=rv(e[i]))?--n:c+=s;else for(;++i<t;)isNaN(s=rv(r(e[i],i,e)))?--n:c+=s;if(n)return c/n},bF=function(e,r){var t=e.length,n=-1,i,s=[];if(r==null)for(;++n<t;)isNaN(i=rv(e[n]))||s.push(i);else for(;++n<t;)isNaN(i=rv(r(e[n],n,e)))||s.push(i);return Wy(s.sort(n0),.5)},EF=function(e){for(var r=e.length,t,n=-1,i=0,s,c;++n<r;)i+=e[n].length;for(s=new Array(i);--r>=0;)for(c=e[r],t=c.length;--t>=0;)s[--i]=c[t];return s},kI=function(e,r){var t=e.length,n=-1,i,s;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(s=i;++n<t;)(i=e[n])!=null&&s>i&&(s=i)}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(s=i;++n<t;)(i=r(e[n],n,e))!=null&&s>i&&(s=i);return s},SF=function(e,r){for(var t=r.length,n=new Array(t);t--;)n[t]=e[r[t]];return n},CF=function(e,r){if(!!(t=e.length)){var t,n=0,i=0,s,c=e[i];for(r==null&&(r=n0);++n<t;)(r(s=e[n],c)<0||r(c,c)!==0)&&(c=s,i=n);if(r(c,c)===0)return i}},wF=function(e,r,t){for(var n=(t==null?e.length:t)-(r=r==null?0:+r),i,s;n;)s=Math.random()*n--|0,i=e[n+r],e[n+r]=e[s+r],e[s+r]=i;return e},AF=function(e,r){var t=e.length,n=-1,i,s=0;if(r==null)for(;++n<t;)(i=+e[n])&&(s+=i);else for(;++n<t;)(i=+r(e[n],n,e))&&(s+=i);return s},DI=function(e){if(!(s=e.length))return[];for(var r=-1,t=kI(e,FI),n=new Array(t);++r<t;)for(var i=-1,s,c=n[r]=new Array(s);++i<s;)c[i]=e[i][r];return n};function FI(e){return e.length}var TF=function(){return DI(arguments)},jv=function(e,r){return e<r?-1:e>r?1:e>=r?0:NaN},Zb=function(e){return e.length===1&&(e=BI(e)),{left:function(t,n,i,s){for(i==null&&(i=0),s==null&&(s=t.length);i<s;){var c=i+s>>>1;e(t[c],n)<0?i=c+1:s=c}return i},right:function(t,n,i,s){for(i==null&&(i=0),s==null&&(s=t.length);i<s;){var c=i+s>>>1;e(t[c],n)>0?s=c:i=c+1}return i}}};function BI(e){return function(r,t){return jv(e(r),t)}}var Xb=Zb(jv),NI=Xb.right,MF=Xb.left,Em=NI,PF=function(e,r){r==null&&(r=Yb);for(var t=0,n=e.length-1,i=e[0],s=new Array(n<0?0:n);t<n;)s[t]=r(i,i=e[++t]);return s};function Yb(e,r){return[e,r]}var OF=function(e,r,t){var n=e.length,i=r.length,s=new Array(n*i),c,g,y,E;for(t==null&&(t=Yb),c=y=0;c<n;++c)for(E=e[c],g=0;g<i;++g,++y)s[y]=t(E,r[g]);return s},IF=function(e,r){return r<e?-1:r>e?1:r>=e?0:NaN},nv=function(e){return e===null?NaN:+e},zI=function(e,r){var t=e.length,n=0,i=-1,s=0,c,g,y=0;if(r==null)for(;++i<t;)isNaN(c=nv(e[i]))||(g=c-s,s+=g/++n,y+=g*(c-s));else for(;++i<t;)isNaN(c=nv(r(e[i],i,e)))||(g=c-s,s+=g/++n,y+=g*(c-s));if(n>1)return y/(n-1)},UI=function(e,r){var t=zI(e,r);return t&&Math.sqrt(t)},jI=function(e,r){var t=e.length,n=-1,i,s,c;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(s=c=i;++n<t;)(i=e[n])!=null&&(s>i&&(s=i),c<i&&(c=i))}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(s=c=i;++n<t;)(i=r(e[n],n,e))!=null&&(s>i&&(s=i),c<i&&(c=i));return[s,c]},Kb=Array.prototype,VI=Kb.slice,GI=Kb.map,hg=function(e){return function(){return e}},HI=function(e){return e},$b=function(e,r,t){e=+e,r=+r,t=(i=arguments.length)<2?(r=e,e=0,1):i<3?1:+t;for(var n=-1,i=Math.max(0,Math.ceil((r-e)/t))|0,s=new Array(i);++n<i;)s[n]=e+n*t;return s},Zy=Math.sqrt(50),Xy=Math.sqrt(10),Yy=Math.sqrt(2),qb=function(e,r,t){var n,i=-1,s,c,g;if(r=+r,e=+e,t=+t,e===r&&t>0)return[e];if((n=r<e)&&(s=e,e=r,r=s),(g=pg(e,r,t))===0||!isFinite(g))return[];if(g>0)for(e=Math.ceil(e/g),r=Math.floor(r/g),c=new Array(s=Math.ceil(r-e+1));++i<s;)c[i]=(e+i)*g;else for(e=Math.floor(e*g),r=Math.ceil(r*g),c=new Array(s=Math.ceil(e-r+1));++i<s;)c[i]=(e-i)/g;return n&&c.reverse(),c};function pg(e,r,t){var n=(r-e)/Math.max(0,t),i=Math.floor(Math.log(n)/Math.LN10),s=n/Math.pow(10,i);return i>=0?(s>=Zy?10:s>=Xy?5:s>=Yy?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=Zy?10:s>=Xy?5:s>=Yy?2:1)}function dg(e,r,t){var n=Math.abs(r-e)/Math.max(0,t),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),s=n/i;return s>=Zy?i*=10:s>=Xy?i*=5:s>=Yy&&(i*=2),r<e?-i:i}var WI=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1},RF=function(){var e=HI,r=jI,t=WI;function n(i){var s,c=i.length,g,y=new Array(c);for(s=0;s<c;++s)y[s]=e(i[s],s,i);var E=r(y),T=E[0],I=E[1],F=t(y,T,I);Array.isArray(F)||(F=dg(T,I,F),F=$b(Math.ceil(T/F)*F,I,F));for(var U=F.length;F[0]<=T;)F.shift(),--U;for(;F[U-1]>I;)F.pop(),--U;var Q=new Array(U+1),ue;for(s=0;s<=U;++s)ue=Q[s]=[],ue.x0=s>0?F[s-1]:T,ue.x1=s<U?F[s]:I;for(s=0;s<c;++s)g=y[s],T<=g&&g<=I&&Q[Em(F,g,0,U)].push(i[s]);return Q}return n.value=function(i){return arguments.length?(e=typeof i=="function"?i:hg(i),n):e},n.domain=function(i){return arguments.length?(r=typeof i=="function"?i:hg([i[0],i[1]]),n):r},n.thresholds=function(i){return arguments.length?(t=typeof i=="function"?i:Array.isArray(i)?hg(VI.call(i)):hg(i),n):t},n},vg=function(e,r,t){if(t==null&&(t=nv),!!(n=e.length)){if((r=+r)<=0||n<2)return+t(e[0],0,e);if(r>=1)return+t(e[n-1],n-1,e);var n,i=(n-1)*r,s=Math.floor(i),c=+t(e[s],s,e),g=+t(e[s+1],s+1,e);return c+(g-c)*(i-s)}},LF=function(e,r,t){return e=GI.call(e,nv).sort(jv),Math.ceil((t-r)/(2*(vg(e,.75)-vg(e,.25))*Math.pow(e.length,-1/3)))},kF=function(e,r,t){return Math.ceil((t-r)/(3.5*UI(e)*Math.pow(e.length,-1/3)))},DF=function(e,r){var t=e.length,n=-1,i,s;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(s=i;++n<t;)(i=e[n])!=null&&i>s&&(s=i)}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(s=i;++n<t;)(i=r(e[n],n,e))!=null&&i>s&&(s=i);return s},FF=function(e,r){var t=e.length,n=t,i=-1,s,c=0;if(r==null)for(;++i<t;)isNaN(s=nv(e[i]))?--n:c+=s;else for(;++i<t;)isNaN(s=nv(r(e[i],i,e)))?--n:c+=s;if(n)return c/n},BF=function(e,r){var t=e.length,n=-1,i,s=[];if(r==null)for(;++n<t;)isNaN(i=nv(e[n]))||s.push(i);else for(;++n<t;)isNaN(i=nv(r(e[n],n,e)))||s.push(i);return vg(s.sort(jv),.5)},NF=function(e){for(var r=e.length,t,n=-1,i=0,s,c;++n<r;)i+=e[n].length;for(s=new Array(i);--r>=0;)for(c=e[r],t=c.length;--t>=0;)s[--i]=c[t];return s},ZI=function(e,r){var t=e.length,n=-1,i,s;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(s=i;++n<t;)(i=e[n])!=null&&s>i&&(s=i)}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(s=i;++n<t;)(i=r(e[n],n,e))!=null&&s>i&&(s=i);return s},zF=function(e,r){for(var t=r.length,n=new Array(t);t--;)n[t]=e[r[t]];return n},UF=function(e,r){if(!!(t=e.length)){var t,n=0,i=0,s,c=e[i];for(r==null&&(r=jv);++n<t;)(r(s=e[n],c)<0||r(c,c)!==0)&&(c=s,i=n);if(r(c,c)===0)return i}},jF=function(e,r,t){for(var n=(t==null?e.length:t)-(r=r==null?0:+r),i,s;n;)s=Math.random()*n--|0,i=e[n+r],e[n+r]=e[s+r],e[s+r]=i;return e},VF=function(e,r){var t=e.length,n=-1,i,s=0;if(r==null)for(;++n<t;)(i=+e[n])&&(s+=i);else for(;++n<t;)(i=+r(e[n],n,e))&&(s+=i);return s},XI=function(e){if(!(s=e.length))return[];for(var r=-1,t=ZI(e,YI),n=new Array(t);++r<t;)for(var i=-1,s,c=n[r]=new Array(s);++i<s;)c[i]=e[i][r];return n};function YI(e){return e.length}var GF=function(){return XI(arguments)};function Sp(e,r){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(r).domain(e);break}return this}function xd(e,r){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(r).domain(e);break}return this}var Zh="$";function mg(){}mg.prototype=Qb.prototype={constructor:mg,has:function(r){return Zh+r in this},get:function(r){return this[Zh+r]},set:function(r,t){return this[Zh+r]=t,this},remove:function(r){var t=Zh+r;return t in this&&delete this[t]},clear:function(){for(var r in this)r[0]===Zh&&delete this[r]},keys:function(){var r=[];for(var t in this)t[0]===Zh&&r.push(t.slice(1));return r},values:function(){var r=[];for(var t in this)t[0]===Zh&&r.push(this[t]);return r},entries:function(){var r=[];for(var t in this)t[0]===Zh&&r.push({key:t.slice(1),value:this[t]});return r},size:function(){var r=0;for(var t in this)t[0]===Zh&&++r;return r},empty:function(){for(var r in this)if(r[0]===Zh)return!1;return!0},each:function(r){for(var t in this)t[0]===Zh&&r(this[t],t.slice(1),this)}};function Qb(e,r){var t=new mg;if(e instanceof mg)e.each(function(g,y){t.set(y,g)});else if(Array.isArray(e)){var n=-1,i=e.length,s;if(r==null)for(;++n<i;)t.set(n,e[n]);else for(;++n<i;)t.set(r(s=e[n],n,e),s)}else if(e)for(var c in e)t.set(c,e[c]);return t}var i0=Qb,HF=function(){var e=[],r=[],t,n,i;function s(g,y,E,T){if(y>=e.length)return t!=null&&g.sort(t),n!=null?n(g):g;for(var I=-1,F=g.length,U=e[y++],Q,ue,de=i0(),Re,et=E();++I<F;)(Re=de.get(Q=U(ue=g[I])+""))?Re.push(ue):de.set(Q,[ue]);return de.each(function(ht,xt){T(et,xt,s(ht,y,E,T))}),et}function c(g,y){if(++y>e.length)return g;var E,T=r[y-1];return n!=null&&y>=e.length?E=g.entries():(E=[],g.each(function(I,F){E.push({key:F,values:c(I,y)})})),T!=null?E.sort(function(I,F){return T(I.key,F.key)}):E}return i={object:function(y){return s(y,0,KI,$I)},map:function(y){return s(y,0,Jb,eE)},entries:function(y){return c(s(y,0,Jb,eE),0)},key:function(y){return e.push(y),i},sortKeys:function(y){return r[e.length-1]=y,i},sortValues:function(y){return t=y,i},rollup:function(y){return n=y,i}}};function KI(){return{}}function $I(e,r,t){e[r]=t}function Jb(){return i0()}function eE(e,r,t){e.set(r,t)}function gg(){}var Vv=i0.prototype;gg.prototype=tE.prototype={constructor:gg,has:Vv.has,add:function(r){return r+="",this[Zh+r]=r,this},remove:Vv.remove,clear:Vv.clear,values:Vv.keys,size:Vv.size,empty:Vv.empty,each:Vv.each};function tE(e,r){var t=new gg;if(e instanceof gg)e.each(function(s){t.add(s)});else if(e){var n=-1,i=e.length;if(r==null)for(;++n<i;)t.add(e[n]);else for(;++n<i;)t.add(r(e[n],n,e))}return t}var WF=tE,ZF=function(e){var r=[];for(var t in e)r.push(t);return r},XF=function(e){var r=[];for(var t in e)r.push(e[t]);return r},YF=function(e){var r=[];for(var t in e)r.push({key:t,value:e[t]});return r},rE=Array.prototype,yg=rE.map,Gv=rE.slice,nE={name:"implicit"};function a0(){var e=i0(),r=[],t=[],n=nE;function i(s){var c=s+"",g=e.get(c);if(!g){if(n!==nE)return n;e.set(c,g=r.push(s))}return t[(g-1)%t.length]}return i.domain=function(s){if(!arguments.length)return r.slice();r=[],e=i0();for(var c=-1,g=s.length,y,E;++c<g;)e.has(E=(y=s[c])+"")||e.set(E,r.push(y));return i},i.range=function(s){return arguments.length?(t=Gv.call(s),i):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return a0(r,t).unknown(n)},Sp.apply(i,arguments),i}function iE(){var e=a0().unknown(void 0),r=e.domain,t=e.range,n=[0,1],i,s,c=!1,g=0,y=0,E=.5;delete e.unknown;function T(){var I=r().length,F=n[1]<n[0],U=n[F-0],Q=n[1-F];i=(Q-U)/Math.max(1,I-g+y*2),c&&(i=Math.floor(i)),U+=(Q-U-i*(I-g))*E,s=i*(1-g),c&&(U=Math.round(U),s=Math.round(s));var ue=$b(I).map(function(de){return U+i*de});return t(F?ue.reverse():ue)}return e.domain=function(I){return arguments.length?(r(I),T()):r()},e.range=function(I){return arguments.length?(n=[+I[0],+I[1]],T()):n.slice()},e.rangeRound=function(I){return n=[+I[0],+I[1]],c=!0,T()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(I){return arguments.length?(c=!!I,T()):c},e.padding=function(I){return arguments.length?(g=Math.min(1,y=+I),T()):g},e.paddingInner=function(I){return arguments.length?(g=Math.min(1,I),T()):g},e.paddingOuter=function(I){return arguments.length?(y=+I,T()):y},e.align=function(I){return arguments.length?(E=Math.max(0,Math.min(1,I)),T()):E},e.copy=function(){return iE(r(),n).round(c).paddingInner(g).paddingOuter(y).align(E)},Sp.apply(T(),arguments)}function aE(e){var r=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return aE(r())},e}function KF(){return aE(iE.apply(null,arguments).paddingInner(1))}function oE(e,r,t,n,i){var s=e*e,c=s*e;return((1-3*e+3*s-c)*r+(4-6*s+3*c)*t+(1+3*e+3*s-3*c)*n+c*i)/6}var qI=function(e){var r=e.length-1;return function(t){var n=t<=0?t=0:t>=1?(t=1,r-1):Math.floor(t*r),i=e[n],s=e[n+1],c=n>0?e[n-1]:2*i-s,g=n<r-1?e[n+2]:2*s-i;return oE((t-n/r)*r,c,i,s,g)}},QI=function(e){var r=e.length;return function(t){var n=Math.floor(((t%=1)<0?++t:t)*r),i=e[(n+r-1)%r],s=e[n%r],c=e[(n+1)%r],g=e[(n+2)%r];return oE((t-n/r)*r,i,s,c,g)}},_g=function(e){return function(){return e}};function sE(e,r){return function(t){return e+t*r}}function JI(e,r,t){return e=Math.pow(e,t),r=Math.pow(r,t)-e,t=1/t,function(n){return Math.pow(e+n*r,t)}}function $F(e,r){var t=r-e;return t?sE(e,t>180||t<-180?t-360*Math.round(t/360):t):_g(isNaN(e)?r:e)}function e5(e){return(e=+e)==1?uE:function(r,t){return t-r?JI(r,t,e):_g(isNaN(r)?t:r)}}function uE(e,r){var t=r-e;return t?sE(e,t):_g(isNaN(e)?r:e)}var lE=function e(r){var t=e5(r);function n(i,s){var c=t((i=We(i)).r,(s=We(s)).r),g=t(i.g,s.g),y=t(i.b,s.b),E=uE(i.opacity,s.opacity);return function(T){return i.r=c(T),i.g=g(T),i.b=y(T),i.opacity=E(T),i+""}}return n.gamma=e,n}(1);function cE(e){return function(r){var t=r.length,n=new Array(t),i=new Array(t),s=new Array(t),c,g;for(c=0;c<t;++c)g=We(r[c]),n[c]=g.r||0,i[c]=g.g||0,s[c]=g.b||0;return n=e(n),i=e(i),s=e(s),g.opacity=1,function(y){return g.r=n(y),g.g=i(y),g.b=s(y),g+""}}}var qF=cE(qI),QF=cE(QI),fE=function(e,r){r||(r=[]);var t=e?Math.min(r.length,e.length):0,n=r.slice(),i;return function(s){for(i=0;i<t;++i)n[i]=e[i]*(1-s)+r[i]*s;return n}};function hE(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var JF=function(e,r){return(hE(r)?fE:pE)(e,r)};function pE(e,r){var t=r?r.length:0,n=e?Math.min(t,e.length):0,i=new Array(n),s=new Array(t),c;for(c=0;c<n;++c)i[c]=qy(e[c],r[c]);for(;c<t;++c)s[c]=r[c];return function(g){for(c=0;c<n;++c)s[c]=i[c](g);return s}}var t5=function(e,r){var t=new Date;return e=+e,r=+r,function(n){return t.setTime(e*(1-n)+r*n),t}},xg=function(e,r){return e=+e,r=+r,function(t){return e*(1-t)+r*t}},r5=function(e,r){var t={},n={},i;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(i in r)i in e?t[i]=qy(e[i],r[i]):n[i]=r[i];return function(s){for(i in t)n[i]=t[i](s);return n}},Ky=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$y=new RegExp(Ky.source,"g");function n5(e){return function(){return e}}function i5(e){return function(r){return e(r)+""}}var a5=function(e,r){var t=Ky.lastIndex=$y.lastIndex=0,n,i,s,c=-1,g=[],y=[];for(e=e+"",r=r+"";(n=Ky.exec(e))&&(i=$y.exec(r));)(s=i.index)>t&&(s=r.slice(t,s),g[c]?g[c]+=s:g[++c]=s),(n=n[0])===(i=i[0])?g[c]?g[c]+=i:g[++c]=i:(g[++c]=null,y.push({i:c,x:xg(n,i)})),t=$y.lastIndex;return t<r.length&&(s=r.slice(t),g[c]?g[c]+=s:g[++c]=s),g.length<2?y[0]?i5(y[0].x):n5(r):(r=y.length,function(E){for(var T=0,I;T<r;++T)g[(I=y[T]).i]=I.x(E);return g.join("")})},qy=function(e,r){var t=typeof r,n;return r==null||t==="boolean"?_g(r):(t==="number"?xg:t==="string"?(n=re(r))?(r=n,lE):a5:r instanceof re?lE:r instanceof Date?t5:hE(r)?fE:Array.isArray(r)?pE:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?r5:xg)(e,r)},o5=function(e,r){return e=+e,r=+r,function(t){return Math.round(e*(1-t)+r*t)}},s5=function(e){return function(){return e}},Qy=function(e){return+e},dE=[0,1];function kc(e){return e}function Jy(e,r){return(r-=e=+e)?function(t){return(t-e)/r}:s5(isNaN(r)?NaN:.5)}function vE(e){var r=e[0],t=e[e.length-1],n;return r>t&&(n=r,r=t,t=n),function(i){return Math.max(r,Math.min(t,i))}}function u5(e,r,t){var n=e[0],i=e[1],s=r[0],c=r[1];return i<n?(n=Jy(i,n),s=t(c,s)):(n=Jy(n,i),s=t(s,c)),function(g){return s(n(g))}}function l5(e,r,t){var n=Math.min(e.length,r.length)-1,i=new Array(n),s=new Array(n),c=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),r=r.slice().reverse());++c<n;)i[c]=Jy(e[c],e[c+1]),s[c]=t(r[c],r[c+1]);return function(g){var y=Em(e,g,1,n)-1;return s[y](i[y](g))}}function o0(e,r){return r.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function bg(){var e=dE,r=dE,t=qy,n,i,s,c=kc,g,y,E;function T(){return g=Math.min(e.length,r.length)>2?l5:u5,y=E=null,I}function I(F){return isNaN(F=+F)?s:(y||(y=g(e.map(n),r,t)))(n(c(F)))}return I.invert=function(F){return c(i((E||(E=g(r,e.map(n),xg)))(F)))},I.domain=function(F){return arguments.length?(e=yg.call(F,Qy),c===kc||(c=vE(e)),T()):e.slice()},I.range=function(F){return arguments.length?(r=Gv.call(F),T()):r.slice()},I.rangeRound=function(F){return r=Gv.call(F),t=o5,T()},I.clamp=function(F){return arguments.length?(c=F?vE(e):kc,I):c!==kc},I.interpolate=function(F){return arguments.length?(t=F,T()):t},I.unknown=function(F){return arguments.length?(s=F,I):s},function(F,U){return n=F,i=U,T()}}function mE(e,r){return bg()(e,r)}var c5=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Eg(e){if(!(r=c5.exec(e)))throw new Error("invalid format: "+e);var r;return new e_({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}Eg.prototype=e_.prototype;function e_(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}e_.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var f5=function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)};function Sg(e,r){if((t=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"))<0)return null;var t,n=e.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+e.slice(t+1)]}var Sm=function(e){return e=Sg(Math.abs(e)),e?e[1]:NaN},h5=function(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Sm(r)/3)))*3-Sm(Math.abs(e)))},p5=function(e,r){return function(t,n){for(var i=t.length,s=[],c=0,g=e[0],y=0;i>0&&g>0&&(y+g+1>n&&(g=Math.max(1,n-y)),s.push(t.substring(i-=g,i+g)),!((y+=g+1)>n));)g=e[c=(c+1)%e.length];return s.reverse().join(r)}},d5=function(e){return function(r){return r.replace(/[0-9]/g,function(t){return e[+t]})}},v5=function(e){e:for(var r=e.length,t=1,n=-1,i;t<r;++t)switch(e[t]){case".":n=i=t;break;case"0":n===0&&(n=t),i=t;break;default:if(!+e[t])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e},gE,m5=function(e,r){var t=Sg(e,r);if(!t)return e+"";var n=t[0],i=t[1],s=i-(gE=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,c=n.length;return s===c?n:s>c?n+new Array(s-c+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Sg(e,Math.max(0,r+s-1))[0]},yE=function(e,r){var t=Sg(e,r);if(!t)return e+"";var n=t[0],i=t[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")},_E={"%":function(r,t){return(r*100).toFixed(t)},b:function(r){return Math.round(r).toString(2)},c:function(r){return r+""},d:f5,e:function(r,t){return r.toExponential(t)},f:function(r,t){return r.toFixed(t)},g:function(r,t){return r.toPrecision(t)},o:function(r){return Math.round(r).toString(8)},p:function(r,t){return yE(r*100,t)},r:yE,s:m5,X:function(r){return Math.round(r).toString(16).toUpperCase()},x:function(r){return Math.round(r).toString(16)}},xE=function(e){return e},bE=Array.prototype.map,EE=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],g5=function(e){var r=e.grouping===void 0||e.thousands===void 0?xE:p5(bE.call(e.grouping,Number),e.thousands+""),t=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?xE:d5(bE.call(e.numerals,String)),c=e.percent===void 0?"%":e.percent+"",g=e.minus===void 0?"-":e.minus+"",y=e.nan===void 0?"NaN":e.nan+"";function E(I){I=Eg(I);var F=I.fill,U=I.align,Q=I.sign,ue=I.symbol,de=I.zero,Re=I.width,et=I.comma,ht=I.precision,xt=I.trim,Gt=I.type;Gt==="n"?(et=!0,Gt="g"):_E[Gt]||(ht===void 0&&(ht=12),xt=!0,Gt="g"),(de||F==="0"&&U==="=")&&(de=!0,F="0",U="=");var jt=ue==="$"?t:ue==="#"&&/[boxX]/.test(Gt)?"0"+Gt.toLowerCase():"",Qt=ue==="$"?n:/[%p]/.test(Gt)?c:"",fr=_E[Gt],Gr=/[defgprs%]/.test(Gt);ht=ht===void 0?6:/[gprs]/.test(Gt)?Math.max(1,Math.min(21,ht)):Math.max(0,Math.min(20,ht));function Jr(Ur){var Xn=jt,ni=Qt,Oi,No,zs;if(Gt==="c")ni=fr(Ur)+ni,Ur="";else{Ur=+Ur;var ll=Ur<0||1/Ur<0;if(Ur=isNaN(Ur)?y:fr(Math.abs(Ur),ht),xt&&(Ur=v5(Ur)),ll&&+Ur==0&&Q!=="+"&&(ll=!1),Xn=(ll?Q==="("?Q:g:Q==="-"||Q==="("?"":Q)+Xn,ni=(Gt==="s"?EE[8+gE/3]:"")+ni+(ll&&Q==="("?")":""),Gr){for(Oi=-1,No=Ur.length;++Oi<No;)if(zs=Ur.charCodeAt(Oi),48>zs||zs>57){ni=(zs===46?i+Ur.slice(Oi+1):Ur.slice(Oi))+ni,Ur=Ur.slice(0,Oi);break}}}et&&!de&&(Ur=r(Ur,Infinity));var Fc=Xn.length+Ur.length+ni.length,el=Fc<Re?new Array(Re-Fc+1).join(F):"";switch(et&&de&&(Ur=r(el+Ur,el.length?Re-ni.length:Infinity),el=""),U){case"<":Ur=Xn+Ur+ni+el;break;case"=":Ur=Xn+el+Ur+ni;break;case"^":Ur=el.slice(0,Fc=el.length>>1)+Xn+Ur+ni+el.slice(Fc);break;default:Ur=el+Xn+Ur+ni;break}return s(Ur)}return Jr.toString=function(){return I+""},Jr}function T(I,F){var U=E((I=Eg(I),I.type="f",I)),Q=Math.max(-8,Math.min(8,Math.floor(Sm(F)/3)))*3,ue=Math.pow(10,-Q),de=EE[8+Q/3];return function(Re){return U(ue*Re)+de}}return{format:E,formatPrefix:T}},Cg,t_,SE;y5({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function y5(e){return Cg=g5(e),t_=Cg.format,SE=Cg.formatPrefix,Cg}var _5=function(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,Sm(r)-Sm(e))+1},x5=function(e){return Math.max(0,-Sm(Math.abs(e)))},b5=function(e,r,t,n){var i=dg(e,r,t),s;switch(n=Eg(n==null?",f":n),n.type){case"s":{var c=Math.max(Math.abs(e),Math.abs(r));return n.precision==null&&!isNaN(s=h5(i,c))&&(n.precision=s),SE(n,c)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=_5(i,Math.max(Math.abs(e),Math.abs(r))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=x5(i))&&(n.precision=s-(n.type==="%")*2);break}}return t_(n)};function Hv(e){var r=e.domain;return e.ticks=function(t){var n=r();return qb(n[0],n[n.length-1],t==null?10:t)},e.tickFormat=function(t,n){var i=r();return b5(i[0],i[i.length-1],t==null?10:t,n)},e.nice=function(t){t==null&&(t=10);var n=r(),i=0,s=n.length-1,c=n[i],g=n[s],y;return g<c&&(y=c,c=g,g=y,y=i,i=s,s=y),y=pg(c,g,t),y>0?(c=Math.floor(c/y)*y,g=Math.ceil(g/y)*y,y=pg(c,g,t)):y<0&&(c=Math.ceil(c*y)/y,g=Math.floor(g*y)/y,y=pg(c,g,t)),y>0?(n[i]=Math.floor(c/y)*y,n[s]=Math.ceil(g/y)*y,r(n)):y<0&&(n[i]=Math.ceil(c*y)/y,n[s]=Math.floor(g*y)/y,r(n)),e},e}function CE(){var e=mE(kc,kc);return e.copy=function(){return o0(e,CE())},Sp.apply(e,arguments),Hv(e)}function wE(e){var r;function t(n){return isNaN(n=+n)?r:n}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=yg.call(n,Qy),t):e.slice()},t.unknown=function(n){return arguments.length?(r=n,t):r},t.copy=function(){return wE(e).unknown(r)},e=arguments.length?yg.call(e,Qy):[0,1],Hv(t)}var AE=function(e,r){e=e.slice();var t=0,n=e.length-1,i=e[t],s=e[n],c;return s<i&&(c=t,t=n,n=c,c=i,i=s,s=c),e[t]=r.floor(i),e[n]=r.ceil(s),e};function TE(e){return Math.log(e)}function ME(e){return Math.exp(e)}function E5(e){return-Math.log(-e)}function S5(e){return-Math.exp(-e)}function C5(e){return isFinite(e)?+("1e"+e):e<0?0:e}function w5(e){return e===10?C5:e===Math.E?Math.exp:function(r){return Math.pow(e,r)}}function A5(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(r){return Math.log(r)/e})}function PE(e){return function(r){return-e(-r)}}function r_(e){var r=e(TE,ME),t=r.domain,n=10,i,s;function c(){return i=A5(n),s=w5(n),t()[0]<0?(i=PE(i),s=PE(s),e(E5,S5)):e(TE,ME),r}return r.base=function(g){return arguments.length?(n=+g,c()):n},r.domain=function(g){return arguments.length?(t(g),c()):t()},r.ticks=function(g){var y=t(),E=y[0],T=y[y.length-1],I;(I=T<E)&&(F=E,E=T,T=F);var F=i(E),U=i(T),Q,ue,de,Re=g==null?10:+g,et=[];if(!(n%1)&&U-F<Re){if(F=Math.round(F)-1,U=Math.round(U)+1,E>0){for(;F<U;++F)for(ue=1,Q=s(F);ue<n;++ue)if(de=Q*ue,!(de<E)){if(de>T)break;et.push(de)}}else for(;F<U;++F)for(ue=n-1,Q=s(F);ue>=1;--ue)if(de=Q*ue,!(de<E)){if(de>T)break;et.push(de)}}else et=qb(F,U,Math.min(U-F,Re)).map(s);return I?et.reverse():et},r.tickFormat=function(g,y){if(y==null&&(y=n===10?".0e":","),typeof y!="function"&&(y=t_(y)),g===Infinity)return y;g==null&&(g=10);var E=Math.max(1,n*g/r.ticks().length);return function(T){var I=T/s(Math.round(i(T)));return I*n<n-.5&&(I*=n),I<=E?y(T):""}},r.nice=function(){return t(AE(t(),{floor:function(y){return s(Math.floor(i(y)))},ceil:function(y){return s(Math.ceil(i(y)))}}))},r}function OE(){var e=r_(bg()).domain([1,10]);return e.copy=function(){return o0(e,OE()).base(e.base())},Sp.apply(e,arguments),e}function IE(e){return function(r){return Math.sign(r)*Math.log1p(Math.abs(r/e))}}function RE(e){return function(r){return Math.sign(r)*Math.expm1(Math.abs(r))*e}}function n_(e){var r=1,t=e(IE(r),RE(r));return t.constant=function(n){return arguments.length?e(IE(r=+n),RE(r)):r},Hv(t)}function T5(){var e=n_(bg());return e.copy=function(){return o0(e,T5()).constant(e.constant())},Sp.apply(e,arguments)}function LE(e){return function(r){return r<0?-Math.pow(-r,e):Math.pow(r,e)}}function M5(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function P5(e){return e<0?-e*e:e*e}function i_(e){var r=e(kc,kc),t=1;function n(){return t===1?e(kc,kc):t===.5?e(M5,P5):e(LE(t),LE(1/t))}return r.exponent=function(i){return arguments.length?(t=+i,n()):t},Hv(r)}function a_(){var e=i_(bg());return e.copy=function(){return o0(e,a_()).exponent(e.exponent())},Sp.apply(e,arguments),e}function e6(){return a_.apply(null,arguments).exponent(.5)}function kE(){var e=[],r=[],t=[],n;function i(){var c=0,g=Math.max(1,r.length);for(t=new Array(g-1);++c<g;)t[c-1]=vg(e,c/g);return s}function s(c){return isNaN(c=+c)?n:r[Em(t,c)]}return s.invertExtent=function(c){var g=r.indexOf(c);return g<0?[NaN,NaN]:[g>0?t[g-1]:e[0],g<t.length?t[g]:e[e.length-1]]},s.domain=function(c){if(!arguments.length)return e.slice();e=[];for(var g=0,y=c.length,E;g<y;++g)E=c[g],E!=null&&!isNaN(E=+E)&&e.push(E);return e.sort(jv),i()},s.range=function(c){return arguments.length?(r=Gv.call(c),i()):r.slice()},s.unknown=function(c){return arguments.length?(n=c,s):n},s.quantiles=function(){return t.slice()},s.copy=function(){return kE().domain(e).range(r).unknown(n)},Sp.apply(s,arguments)}function DE(){var e=0,r=1,t=1,n=[.5],i=[0,1],s;function c(y){return y<=y?i[Em(n,y,0,t)]:s}function g(){var y=-1;for(n=new Array(t);++y<t;)n[y]=((y+1)*r-(y-t)*e)/(t+1);return c}return c.domain=function(y){return arguments.length?(e=+y[0],r=+y[1],g()):[e,r]},c.range=function(y){return arguments.length?(t=(i=Gv.call(y)).length-1,g()):i.slice()},c.invertExtent=function(y){var E=i.indexOf(y);return E<0?[NaN,NaN]:E<1?[e,n[0]]:E>=t?[n[t-1],r]:[n[E-1],n[E]]},c.unknown=function(y){return arguments.length&&(s=y),c},c.thresholds=function(){return n.slice()},c.copy=function(){return DE().domain([e,r]).range(i).unknown(s)},Sp.apply(Hv(c),arguments)}function FE(){var e=[.5],r=[0,1],t,n=1;function i(s){return s<=s?r[Em(e,s,0,n)]:t}return i.domain=function(s){return arguments.length?(e=Gv.call(s),n=Math.min(e.length,r.length-1),i):e.slice()},i.range=function(s){return arguments.length?(r=Gv.call(s),n=Math.min(e.length,r.length-1),i):r.slice()},i.invertExtent=function(s){var c=r.indexOf(s);return[e[c-1],e[c]]},i.unknown=function(s){return arguments.length?(t=s,i):t},i.copy=function(){return FE().domain(e).range(r).unknown(t)},Sp.apply(i,arguments)}var o_=new Date,s_=new Date;function mc(e,r,t,n){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=function(s){return e(s=new Date(+s)),s},i.ceil=function(s){return e(s=new Date(s-1)),r(s,1),e(s),s},i.round=function(s){var c=i(s),g=i.ceil(s);return s-c<g-s?c:g},i.offset=function(s,c){return r(s=new Date(+s),c==null?1:Math.floor(c)),s},i.range=function(s,c,g){var y=[],E;if(s=i.ceil(s),g=g==null?1:Math.floor(g),!(s<c)||!(g>0))return y;do y.push(E=new Date(+s)),r(s,g),e(s);while(E<s&&s<c);return y},i.filter=function(s){return mc(function(c){if(c>=c)for(;e(c),!s(c);)c.setTime(c-1)},function(c,g){if(c>=c)if(g<0)for(;++g<=0;)for(;r(c,-1),!s(c););else for(;--g>=0;)for(;r(c,1),!s(c););})},t&&(i.count=function(s,c){return o_.setTime(+s),s_.setTime(+c),e(o_),e(s_),Math.floor(t(o_,s_))},i.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(n?function(c){return n(c)%s==0}:function(c){return i.count(0,c)%s==0}):i}),i}var u_=mc(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,r){e.setFullYear(e.getFullYear()+r)},function(e,r){return r.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});u_.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:mc(function(r){r.setFullYear(Math.floor(r.getFullYear()/e)*e),r.setMonth(0,1),r.setHours(0,0,0,0)},function(r,t){r.setFullYear(r.getFullYear()+t*e)})};var Cm=u_,t6=u_.range,BE=mc(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,r){e.setMonth(e.getMonth()+r)},function(e,r){return r.getMonth()-e.getMonth()+(r.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),O5=BE,r6=BE.range,wg=1e3,Wv=6e4,Ag=36e5,NE=864e5,zE=6048e5;function Zv(e){return mc(function(r){r.setDate(r.getDate()-(r.getDay()+7-e)%7),r.setHours(0,0,0,0)},function(r,t){r.setDate(r.getDate()+t*7)},function(r,t){return(t-r-(t.getTimezoneOffset()-r.getTimezoneOffset())*Wv)/zE})}var l_=Zv(0),Tg=Zv(1),I5=Zv(2),R5=Zv(3),wm=Zv(4),L5=Zv(5),k5=Zv(6),n6=l_.range,i6=Tg.range,a6=I5.range,o6=R5.range,s6=wm.range,u6=L5.range,l6=k5.range,UE=mc(function(e){e.setHours(0,0,0,0)},function(e,r){e.setDate(e.getDate()+r)},function(e,r){return(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Wv)/NE},function(e){return e.getDate()-1}),c_=UE,c6=UE.range,jE=mc(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*wg-e.getMinutes()*Wv)},function(e,r){e.setTime(+e+r*Ag)},function(e,r){return(r-e)/Ag},function(e){return e.getHours()}),D5=jE,f6=jE.range,VE=mc(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*wg)},function(e,r){e.setTime(+e+r*Wv)},function(e,r){return(r-e)/Wv},function(e){return e.getMinutes()}),F5=VE,h6=VE.range,GE=mc(function(e){e.setTime(e-e.getMilliseconds())},function(e,r){e.setTime(+e+r*wg)},function(e,r){return(r-e)/wg},function(e){return e.getUTCSeconds()}),HE=GE,p6=GE.range,Mg=mc(function(){},function(e,r){e.setTime(+e+r)},function(e,r){return r-e});Mg.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?mc(function(r){r.setTime(Math.floor(r/e)*e)},function(r,t){r.setTime(+r+t*e)},function(r,t){return(t-r)/e}):Mg};var WE=Mg,d6=Mg.range;function Xv(e){return mc(function(r){r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-e)%7),r.setUTCHours(0,0,0,0)},function(r,t){r.setUTCDate(r.getUTCDate()+t*7)},function(r,t){return(t-r)/zE})}var f_=Xv(0),Pg=Xv(1),B5=Xv(2),N5=Xv(3),Am=Xv(4),z5=Xv(5),U5=Xv(6),v6=f_.range,m6=Pg.range,g6=B5.range,y6=N5.range,_6=Am.range,x6=z5.range,b6=U5.range,ZE=mc(function(e){e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCDate(e.getUTCDate()+r)},function(e,r){return(r-e)/NE},function(e){return e.getUTCDate()-1}),h_=ZE,E6=ZE.range,p_=mc(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCFullYear(e.getUTCFullYear()+r)},function(e,r){return r.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});p_.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:mc(function(r){r.setUTCFullYear(Math.floor(r.getUTCFullYear()/e)*e),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},function(r,t){r.setUTCFullYear(r.getUTCFullYear()+t*e)})};var Tm=p_,S6=p_.range;function d_(e){if(0<=e.y&&e.y<100){var r=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return r.setFullYear(e.y),r}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function v_(e){if(0<=e.y&&e.y<100){var r=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return r.setUTCFullYear(e.y),r}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function s0(e,r,t){return{y:e,m:r,d:t,H:0,M:0,S:0,L:0}}function j5(e){var r=e.dateTime,t=e.date,n=e.time,i=e.periods,s=e.days,c=e.shortDays,g=e.months,y=e.shortMonths,E=u0(i),T=l0(i),I=u0(s),F=l0(s),U=u0(c),Q=l0(c),ue=u0(g),de=l0(g),Re=u0(y),et=l0(y),ht={a:ll,A:Fc,b:el,B:Cd,c:null,d:QE,e:QE,f:c3,g:x3,G:E3,H:s3,I:u3,j:l3,L:JE,m:f3,M:h3,p:py,q:Nm,Q:a2,s:o2,S:p3,u:d3,U:v3,V:m3,w:g3,W:y3,x:null,X:null,y:_3,Y:b3,Z:S3,"%":i2},xt={a:H_,A:W_,b:ju,B:Yf,c:null,d:t2,e:t2,f:T3,g:B3,G:z3,H:C3,I:w3,j:A3,L:r2,m:M3,M:P3,p:dy,q:vy,Q:a2,s:o2,S:O3,u:I3,U:R3,V:L3,w:k3,W:D3,x:null,X:null,y:F3,Y:N3,Z:U3,"%":i2},Gt={a:Jr,A:Ur,b:Xn,B:ni,c:Oi,d:$E,e:$E,f:n3,g:KE,G:YE,H:qE,I:qE,j:J5,L:r3,m:Q5,M:e3,p:Gr,q:q5,Q:a3,s:o3,S:t3,u:Z5,U:X5,V:Y5,w:W5,W:K5,x:No,X:zs,y:KE,Y:YE,Z:$5,"%":i3};ht.x=jt(t,ht),ht.X=jt(n,ht),ht.c=jt(r,ht),xt.x=jt(t,xt),xt.X=jt(n,xt),xt.c=jt(r,xt);function jt(_a,Lo){return function(Xa){var ai=[],Kf=-1,mu=0,Ch=_a.length,wh,qv,hw;for(Xa instanceof Date||(Xa=new Date(+Xa));++Kf<Ch;)_a.charCodeAt(Kf)===37&&(ai.push(_a.slice(mu,Kf)),(qv=XE[wh=_a.charAt(++Kf)])!=null?wh=_a.charAt(++Kf):qv=wh==="e"?" ":"0",(hw=Lo[wh])&&(wh=hw(Xa,qv)),ai.push(wh),mu=Kf+1);return ai.push(_a.slice(mu,Kf)),ai.join("")}}function Qt(_a,Lo){return function(Xa){var ai=s0(1900,void 0,1),Kf=fr(ai,_a,Xa+="",0),mu,Ch;if(Kf!=Xa.length)return null;if("Q"in ai)return new Date(ai.Q);if("s"in ai)return new Date(ai.s*1e3+("L"in ai?ai.L:0));if(Lo&&!("Z"in ai)&&(ai.Z=0),"p"in ai&&(ai.H=ai.H%12+ai.p*12),ai.m===void 0&&(ai.m="q"in ai?ai.q:0),"V"in ai){if(ai.V<1||ai.V>53)return null;"w"in ai||(ai.w=1),"Z"in ai?(mu=v_(s0(ai.y,0,1)),Ch=mu.getUTCDay(),mu=Ch>4||Ch===0?Pg.ceil(mu):Pg(mu),mu=h_.offset(mu,(ai.V-1)*7),ai.y=mu.getUTCFullYear(),ai.m=mu.getUTCMonth(),ai.d=mu.getUTCDate()+(ai.w+6)%7):(mu=d_(s0(ai.y,0,1)),Ch=mu.getDay(),mu=Ch>4||Ch===0?Tg.ceil(mu):Tg(mu),mu=c_.offset(mu,(ai.V-1)*7),ai.y=mu.getFullYear(),ai.m=mu.getMonth(),ai.d=mu.getDate()+(ai.w+6)%7)}else("W"in ai||"U"in ai)&&("w"in ai||(ai.w="u"in ai?ai.u%7:"W"in ai?1:0),Ch="Z"in ai?v_(s0(ai.y,0,1)).getUTCDay():d_(s0(ai.y,0,1)).getDay(),ai.m=0,ai.d="W"in ai?(ai.w+6)%7+ai.W*7-(Ch+5)%7:ai.w+ai.U*7-(Ch+6)%7);return"Z"in ai?(ai.H+=ai.Z/100|0,ai.M+=ai.Z%100,v_(ai)):d_(ai)}}function fr(_a,Lo,Xa,ai){for(var Kf=0,mu=Lo.length,Ch=Xa.length,wh,qv;Kf<mu;){if(ai>=Ch)return-1;if(wh=Lo.charCodeAt(Kf++),wh===37){if(wh=Lo.charAt(Kf++),qv=Gt[wh in XE?Lo.charAt(Kf++):wh],!qv||(ai=qv(_a,Xa,ai))<0)return-1}else if(wh!=Xa.charCodeAt(ai++))return-1}return ai}function Gr(_a,Lo,Xa){var ai=E.exec(Lo.slice(Xa));return ai?(_a.p=T[ai[0].toLowerCase()],Xa+ai[0].length):-1}function Jr(_a,Lo,Xa){var ai=U.exec(Lo.slice(Xa));return ai?(_a.w=Q[ai[0].toLowerCase()],Xa+ai[0].length):-1}function Ur(_a,Lo,Xa){var ai=I.exec(Lo.slice(Xa));return ai?(_a.w=F[ai[0].toLowerCase()],Xa+ai[0].length):-1}function Xn(_a,Lo,Xa){var ai=Re.exec(Lo.slice(Xa));return ai?(_a.m=et[ai[0].toLowerCase()],Xa+ai[0].length):-1}function ni(_a,Lo,Xa){var ai=ue.exec(Lo.slice(Xa));return ai?(_a.m=de[ai[0].toLowerCase()],Xa+ai[0].length):-1}function Oi(_a,Lo,Xa){return fr(_a,r,Lo,Xa)}function No(_a,Lo,Xa){return fr(_a,t,Lo,Xa)}function zs(_a,Lo,Xa){return fr(_a,n,Lo,Xa)}function ll(_a){return c[_a.getDay()]}function Fc(_a){return s[_a.getDay()]}function el(_a){return y[_a.getMonth()]}function Cd(_a){return g[_a.getMonth()]}function py(_a){return i[+(_a.getHours()>=12)]}function Nm(_a){return 1+~~(_a.getMonth()/3)}function H_(_a){return c[_a.getUTCDay()]}function W_(_a){return s[_a.getUTCDay()]}function ju(_a){return y[_a.getUTCMonth()]}function Yf(_a){return g[_a.getUTCMonth()]}function dy(_a){return i[+(_a.getUTCHours()>=12)]}function vy(_a){return 1+~~(_a.getUTCMonth()/3)}return{format:function(Lo){var Xa=jt(Lo+="",ht);return Xa.toString=function(){return Lo},Xa},parse:function(Lo){var Xa=Qt(Lo+="",!1);return Xa.toString=function(){return Lo},Xa},utcFormat:function(Lo){var Xa=jt(Lo+="",xt);return Xa.toString=function(){return Lo},Xa},utcParse:function(Lo){var Xa=Qt(Lo+="",!0);return Xa.toString=function(){return Lo},Xa}}}var XE={"-":"",_:" ","0":"0"},gc=/^\s*\d+/,V5=/^%/,G5=/[\\^$*+?|[\]().{}]/g;function ss(e,r,t){var n=e<0?"-":"",i=(n?-e:e)+"",s=i.length;return n+(s<t?new Array(t-s+1).join(r)+i:i)}function H5(e){return e.replace(G5,"\\$&")}function u0(e){return new RegExp("^(?:"+e.map(H5).join("|")+")","i")}function l0(e){for(var r={},t=-1,n=e.length;++t<n;)r[e[t].toLowerCase()]=t;return r}function W5(e,r,t){var n=gc.exec(r.slice(t,t+1));return n?(e.w=+n[0],t+n[0].length):-1}function Z5(e,r,t){var n=gc.exec(r.slice(t,t+1));return n?(e.u=+n[0],t+n[0].length):-1}function X5(e,r,t){var n=gc.exec(r.slice(t,t+2));return n?(e.U=+n[0],t+n[0].length):-1}function Y5(e,r,t){var n=gc.exec(r.slice(t,t+2));return n?(e.V=+n[0],t+n[0].length):-1}function K5(e,r,t){var n=gc.exec(r.slice(t,t+2));return n?(e.W=+n[0],t+n[0].length):-1}function YE(e,r,t){var n=gc.exec(r.slice(t,t+4));return n?(e.y=+n[0],t+n[0].length):-1}function KE(e,r,t){var n=gc.exec(r.slice(t,t+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),t+n[0].length):-1}function $5(e,r,t){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(t,t+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),t+n[0].length):-1}function q5(e,r,t){var n=gc.exec(r.slice(t,t+1));return n?(e.q=n[0]*3-3,t+n[0].length):-1}function Q5(e,r,t){var n=gc.exec(r.slice(t,t+2));return n?(e.m=n[0]-1,t+n[0].length):-1}function $E(e,r,t){var n=gc.exec(r.slice(t,t+2));return n?(e.d=+n[0],t+n[0].length):-1}function J5(e,r,t){var n=gc.exec(r.slice(t,t+3));return n?(e.m=0,e.d=+n[0],t+n[0].length):-1}function qE(e,r,t){var n=gc.exec(r.slice(t,t+2));return n?(e.H=+n[0],t+n[0].length):-1}function e3(e,r,t){var n=gc.exec(r.slice(t,t+2));return n?(e.M=+n[0],t+n[0].length):-1}function t3(e,r,t){var n=gc.exec(r.slice(t,t+2));return n?(e.S=+n[0],t+n[0].length):-1}function r3(e,r,t){var n=gc.exec(r.slice(t,t+3));return n?(e.L=+n[0],t+n[0].length):-1}function n3(e,r,t){var n=gc.exec(r.slice(t,t+6));return n?(e.L=Math.floor(n[0]/1e3),t+n[0].length):-1}function i3(e,r,t){var n=V5.exec(r.slice(t,t+1));return n?t+n[0].length:-1}function a3(e,r,t){var n=gc.exec(r.slice(t));return n?(e.Q=+n[0],t+n[0].length):-1}function o3(e,r,t){var n=gc.exec(r.slice(t));return n?(e.s=+n[0],t+n[0].length):-1}function QE(e,r){return ss(e.getDate(),r,2)}function s3(e,r){return ss(e.getHours(),r,2)}function u3(e,r){return ss(e.getHours()%12||12,r,2)}function l3(e,r){return ss(1+c_.count(Cm(e),e),r,3)}function JE(e,r){return ss(e.getMilliseconds(),r,3)}function c3(e,r){return JE(e,r)+"000"}function f3(e,r){return ss(e.getMonth()+1,r,2)}function h3(e,r){return ss(e.getMinutes(),r,2)}function p3(e,r){return ss(e.getSeconds(),r,2)}function d3(e){var r=e.getDay();return r===0?7:r}function v3(e,r){return ss(l_.count(Cm(e)-1,e),r,2)}function e2(e){var r=e.getDay();return r>=4||r===0?wm(e):wm.ceil(e)}function m3(e,r){return e=e2(e),ss(wm.count(Cm(e),e)+(Cm(e).getDay()===4),r,2)}function g3(e){return e.getDay()}function y3(e,r){return ss(Tg.count(Cm(e)-1,e),r,2)}function _3(e,r){return ss(e.getFullYear()%100,r,2)}function x3(e,r){return e=e2(e),ss(e.getFullYear()%100,r,2)}function b3(e,r){return ss(e.getFullYear()%1e4,r,4)}function E3(e,r){var t=e.getDay();return e=t>=4||t===0?wm(e):wm.ceil(e),ss(e.getFullYear()%1e4,r,4)}function S3(e){var r=e.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+ss(r/60|0,"0",2)+ss(r%60,"0",2)}function t2(e,r){return ss(e.getUTCDate(),r,2)}function C3(e,r){return ss(e.getUTCHours(),r,2)}function w3(e,r){return ss(e.getUTCHours()%12||12,r,2)}function A3(e,r){return ss(1+h_.count(Tm(e),e),r,3)}function r2(e,r){return ss(e.getUTCMilliseconds(),r,3)}function T3(e,r){return r2(e,r)+"000"}function M3(e,r){return ss(e.getUTCMonth()+1,r,2)}function P3(e,r){return ss(e.getUTCMinutes(),r,2)}function O3(e,r){return ss(e.getUTCSeconds(),r,2)}function I3(e){var r=e.getUTCDay();return r===0?7:r}function R3(e,r){return ss(f_.count(Tm(e)-1,e),r,2)}function n2(e){var r=e.getUTCDay();return r>=4||r===0?Am(e):Am.ceil(e)}function L3(e,r){return e=n2(e),ss(Am.count(Tm(e),e)+(Tm(e).getUTCDay()===4),r,2)}function k3(e){return e.getUTCDay()}function D3(e,r){return ss(Pg.count(Tm(e)-1,e),r,2)}function F3(e,r){return ss(e.getUTCFullYear()%100,r,2)}function B3(e,r){return e=n2(e),ss(e.getUTCFullYear()%100,r,2)}function N3(e,r){return ss(e.getUTCFullYear()%1e4,r,4)}function z3(e,r){var t=e.getUTCDay();return e=t>=4||t===0?Am(e):Am.ceil(e),ss(e.getUTCFullYear()%1e4,r,4)}function U3(){return"+0000"}function i2(){return"%"}function a2(e){return+e}function o2(e){return Math.floor(+e/1e3)}var Mm,s2,j3,u2,V3;G3({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function G3(e){return Mm=j5(e),s2=Mm.format,j3=Mm.parse,u2=Mm.utcFormat,V3=Mm.utcParse,Mm}var c0=1e3,f0=c0*60,h0=f0*60,p0=h0*24,H3=p0*7,l2=p0*30,m_=p0*365;function W3(e){return new Date(e)}function Z3(e){return e instanceof Date?+e:+new Date(+e)}function g_(e,r,t,n,i,s,c,g,y){var E=mE(kc,kc),T=E.invert,I=E.domain,F=y(".%L"),U=y(":%S"),Q=y("%I:%M"),ue=y("%I %p"),de=y("%a %d"),Re=y("%b %d"),et=y("%B"),ht=y("%Y"),xt=[[c,1,c0],[c,5,5*c0],[c,15,15*c0],[c,30,30*c0],[s,1,f0],[s,5,5*f0],[s,15,15*f0],[s,30,30*f0],[i,1,h0],[i,3,3*h0],[i,6,6*h0],[i,12,12*h0],[n,1,p0],[n,2,2*p0],[t,1,H3],[r,1,l2],[r,3,3*l2],[e,1,m_]];function Gt(Qt){return(c(Qt)<Qt?F:s(Qt)<Qt?U:i(Qt)<Qt?Q:n(Qt)<Qt?ue:r(Qt)<Qt?t(Qt)<Qt?de:Re:e(Qt)<Qt?et:ht)(Qt)}function jt(Qt,fr,Gr,Jr){if(Qt==null&&(Qt=10),typeof Qt=="number"){var Ur=Math.abs(Gr-fr)/Qt,Xn=Zb(function(ni){return ni[2]}).right(xt,Ur);Xn===xt.length?(Jr=dg(fr/m_,Gr/m_,Qt),Qt=e):Xn?(Xn=xt[Ur/xt[Xn-1][2]<xt[Xn][2]/Ur?Xn-1:Xn],Jr=Xn[1],Qt=Xn[0]):(Jr=Math.max(dg(fr,Gr,Qt),1),Qt=g)}return Jr==null?Qt:Qt.every(Jr)}return E.invert=function(Qt){return new Date(T(Qt))},E.domain=function(Qt){return arguments.length?I(yg.call(Qt,Z3)):I().map(W3)},E.ticks=function(Qt,fr){var Gr=I(),Jr=Gr[0],Ur=Gr[Gr.length-1],Xn=Ur<Jr,ni;return Xn&&(ni=Jr,Jr=Ur,Ur=ni),ni=jt(Qt,Jr,Ur,fr),ni=ni?ni.range(Jr,Ur+1):[],Xn?ni.reverse():ni},E.tickFormat=function(Qt,fr){return fr==null?Gt:y(fr)},E.nice=function(Qt,fr){var Gr=I();return(Qt=jt(Qt,Gr[0],Gr[Gr.length-1],fr))?I(AE(Gr,Qt)):E},E.copy=function(){return o0(E,g_(e,r,t,n,i,s,c,g,y))},E}var X3=function(){return Sp.apply(g_(Cm,O5,l_,c_,D5,F5,HE,WE,s2).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},c2=mc(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCMonth(e.getUTCMonth()+r)},function(e,r){return r.getUTCMonth()-e.getUTCMonth()+(r.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),Y3=c2,C6=c2.range,f2=mc(function(e){e.setUTCMinutes(0,0,0)},function(e,r){e.setTime(+e+r*Ag)},function(e,r){return(r-e)/Ag},function(e){return e.getUTCHours()}),K3=f2,w6=f2.range,h2=mc(function(e){e.setUTCSeconds(0,0)},function(e,r){e.setTime(+e+r*Wv)},function(e,r){return(r-e)/Wv},function(e){return e.getUTCMinutes()}),$3=h2,A6=h2.range,T6=function(){return Sp.apply(g_(Tm,Y3,f_,h_,K3,$3,HE,WE,u2).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function Og(){var e=0,r=1,t,n,i,s,c=kc,g=!1,y;function E(T){return isNaN(T=+T)?y:c(i===0?.5:(T=(s(T)-t)*i,g?Math.max(0,Math.min(1,T)):T))}return E.domain=function(T){return arguments.length?(t=s(e=+T[0]),n=s(r=+T[1]),i=t===n?0:1/(n-t),E):[e,r]},E.clamp=function(T){return arguments.length?(g=!!T,E):g},E.interpolator=function(T){return arguments.length?(c=T,E):c},E.unknown=function(T){return arguments.length?(y=T,E):y},function(T){return s=T,t=T(e),n=T(r),i=t===n?0:1/(n-t),E}}function iv(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function q3(){var e=Hv(Og()(kc));return e.copy=function(){return iv(e,q3())},xd.apply(e,arguments)}function Q3(){var e=r_(Og()).domain([1,10]);return e.copy=function(){return iv(e,Q3()).base(e.base())},xd.apply(e,arguments)}function J3(){var e=n_(Og());return e.copy=function(){return iv(e,J3()).constant(e.constant())},xd.apply(e,arguments)}function p2(){var e=i_(Og());return e.copy=function(){return iv(e,p2()).exponent(e.exponent())},xd.apply(e,arguments)}function M6(){return p2.apply(null,arguments).exponent(.5)}function eR(){var e=[],r=kc;function t(n){if(!isNaN(n=+n))return r((Em(e,n)-1)/(e.length-1))}return t.domain=function(n){if(!arguments.length)return e.slice();e=[];for(var i=0,s=n.length,c;i<s;++i)c=n[i],c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(jv),t},t.interpolator=function(n){return arguments.length?(r=n,t):r},t.copy=function(){return eR(r).domain(e)},xd.apply(t,arguments)}function Ig(){var e=0,r=.5,t=1,n,i,s,c,g,y=kc,E,T=!1,I;function F(U){return isNaN(U=+U)?I:(U=.5+((U=+E(U))-i)*(U<i?c:g),y(T?Math.max(0,Math.min(1,U)):U))}return F.domain=function(U){return arguments.length?(n=E(e=+U[0]),i=E(r=+U[1]),s=E(t=+U[2]),c=n===i?0:.5/(i-n),g=i===s?0:.5/(s-i),F):[e,r,t]},F.clamp=function(U){return arguments.length?(T=!!U,F):T},F.interpolator=function(U){return arguments.length?(y=U,F):y},F.unknown=function(U){return arguments.length?(I=U,F):I},function(U){return E=U,n=U(e),i=U(r),s=U(t),c=n===i?0:.5/(i-n),g=i===s?0:.5/(s-i),F}}function tR(){var e=Hv(Ig()(kc));return e.copy=function(){return iv(e,tR())},xd.apply(e,arguments)}function rR(){var e=r_(Ig()).domain([.1,1,10]);return e.copy=function(){return iv(e,rR()).base(e.base())},xd.apply(e,arguments)}function nR(){var e=n_(Ig());return e.copy=function(){return iv(e,nR()).constant(e.constant())},xd.apply(e,arguments)}function d2(){var e=i_(Ig());return e.copy=function(){return iv(e,d2()).exponent(e.exponent())},xd.apply(e,arguments)}function P6(){return d2.apply(null,arguments).exponent(.5)}var Cp,v2,m2,g2,y_,y2,iR=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,aR=(Cp={},w()(Cp,Jl.LINEAR,CE),w()(Cp,Jl.POWER,a_),w()(Cp,Jl.LOG,OE),w()(Cp,Jl.IDENTITY,wE),w()(Cp,Jl.TIME,X3),w()(Cp,Jl.QUANTILE,kE),w()(Cp,Jl.QUANTIZE,DE),w()(Cp,Jl.THRESHOLD,FE),w()(Cp,Jl.CAT,a0),Cp),oR=(v2=Object(Cr.injectable)(),m2=Object(Cr.inject)(sr.IGlobalConfigService),v2(g2=(y_=function(){function e(){Ft()(this,e),Di()(this,"configService",y2,this),w()(this,"scaleCache",{}),w()(this,"scaleOptions",{})}return Yt()(e,[{key:"apply",value:function(t,n){var i=this,s=n.styleAttributeService;t.hooks.init.tap("FeatureScalePlugin",function(){i.scaleOptions=t.getScaleOptions();var c=s.getLayerStyleAttributes(),g=t.getSource().data.dataArray;g.length!==0&&i.caculateScalesForAttributes(c||[],g)}),t.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){i.scaleOptions=t.getScaleOptions();var c=s.getLayerStyleAttributes(),g=t.getSource().data.dataArray;return i.caculateScalesForAttributes(c||[],g),t.layerModelNeedUpdate=!0,!0}),t.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!t.layerModelNeedUpdate){i.scaleOptions=t.getScaleOptions();var c=s.getLayerStyleAttributes();if(c){var g=t.getSource().data.dataArray;if(g.length===0)return;var y=c.filter(function(E){return E.needRescale});y.length&&i.caculateScalesForAttributes(y,g)}}})}},{key:"isNumber",value:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},{key:"caculateScalesForAttributes",value:function(t,n){var i=this;this.scaleCache={},t.forEach(function(s){if(s.scale){var c=s.scale,g=s.name;c.names=i.parseFields(s.scale.field||[]);var y=[];c.names.forEach(function(E){y.push(i.getOrCreateScale(E,s,n))}),y.some(function(E){return E.type===$d.VARIABLE})?(c.type=$d.VARIABLE,y.forEach(function(E){if(!c.callback){var T;if(c.values&&c.values!=="text"){var I;if(((I=E.option)===null||I===void 0?void 0:I.type)==="linear"&&c.values.length>2){var F=E.scale.ticks(c.values.length);g==="color"&&E.scale.domain(F)}E.scale.range(c.values)}else((T=E.option)===null||T===void 0?void 0:T.type)==="cat"&&E.scale.range(E.option.domain)}})):(c.type=$d.CONSTANT,c.defaultValues=y.map(function(E,T){return E.scale(c.names[T])})),c.scalers=y.map(function(E){return{field:E.field,func:E.scale,option:E.option}}),s.needRescale=!1}})}},{key:"getOrCreateScale",value:function(t,n,i){var s,c=[t,n.name].join("_"),g=(s=n.scale)===null||s===void 0?void 0:s.values,y=this.createScale(t,n.name,g,i);return y}},{key:"parseFields",value:function(t){return Array.isArray(t)?t:ho()(t)?t.split("*"):[t]}},{key:"createScale",value:function(t,n,i,s){var c,g,y=this.scaleOptions[n]&&((c=this.scaleOptions[n])===null||c===void 0?void 0:c.field)===t?this.scaleOptions[n]:this.scaleOptions[t],E={field:t,scale:void 0,type:$d.VARIABLE,option:y};if(!s||!s.length)return y&&y.type?E.scale=this.createDefaultScale(y):(E.scale=a0([t]),E.type=$d.CONSTANT),E;var T=(g=s.find(function(U){return!bp()(U[t])}))===null||g===void 0?void 0:g[t];if(this.isNumber(t)||bp()(T)&&!y)E.scale=a0([t]),E.type=$d.CONSTANT;else{var I=y&&y.type||this.getDefaultType(T);i==="text"&&(I=Jl.CAT);var F=this.createDefaultScaleConfig(I,t,s);Object.assign(F,y),E.scale=this.createDefaultScale(F),E.option=F}return E}},{key:"getDefaultType",value:function(t){var n=Jl.LINEAR;return typeof t=="string"&&(n=iR.test(t)?Jl.TIME:Jl.CAT),n}},{key:"createDefaultScaleConfig",value:function(t,n,i){var s={type:t},c=(i==null?void 0:i.map(function(g){return g[n]}))||[];return t!==Jl.CAT&&t!==Jl.QUANTILE?s.domain=Hb(c):t===Jl.CAT?s.domain=Q0()(c):t===Jl.QUANTILE&&(s.domain=c),s}},{key:"createDefaultScale",value:function(t){var n=t.type,i=t.domain,s=aR[n]();return i&&s.domain(i),s}}]),e}(),y2=Vi()(y_.prototype,"configService",[m2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y_))||g2),_2,x2,b2,E2,Rg,S2,C2;function w2(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function sR(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?w2(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w2(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var uR=(_2=Object(Cr.injectable)(),x2=Object(Cr.inject)(sr.ICameraService),b2=Object(Cr.inject)(sr.IRendererService),_2(E2=(Rg=function(){function e(){Ft()(this,e),Di()(this,"cameraService",S2,this),Di()(this,"rendererService",C2,this)}return Yt()(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){t.models.forEach(function(n){n.addUniforms(sR({},t.layerModel.getAnimateUniforms()))})})}}]),e}(),S2=Vi()(Rg.prototype,"cameraService",[x2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C2=Vi()(Rg.prototype,"rendererService",[b2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rg))||E2),A2,T2,lR=(A2=Object(Cr.injectable)(),A2(T2=function(){function e(){Ft()(this,e)}return Yt()(e,[{key:"apply",value:function(t){t.hooks.init.tap("LayerModelPlugin",function(){t.prepareBuildModel(),t.buildModels(),t.styleNeedUpdate=!1}),t.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return t.prepareBuildModel(),t.clearModels(),t.buildModels(),t.layerModelNeedUpdate=!1,!1})}}]),e}())||T2),M2,P2,cR=(M2=Object(Cr.injectable)(),M2(P2=function(){function e(){Ft()(this,e)}return Yt()(e,[{key:"apply",value:function(t){t.hooks.afterInit.tap("LayerStylePlugin",function(){t.updateLayerConfig({});var n=t.getLayerConfig(),i=n.autoFit,s=n.fitBoundsOptions;i&&setTimeout(function(){t.fitBounds(s)},100)})}}]),e}())||P2),O2,I2,fR=["type"];function R2(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function d0(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?R2(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R2(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var L2={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},hR={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},pR={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},dR={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},O6=["ambient","diffuse","specular"];function vR(e){var r={u_DirectionalLights:new Array(3).fill(d0({},pR)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(d0({},dR)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[hR]),e.forEach(function(t,n){var i=t.type,s=i===void 0?"directional":i,c=xp()(t,fR),g=L2[s].lights,y=L2[s].num,E=r[y];r[g][E]=d0(d0({},r[g][E]),c),r[y]++}),r}var mR=(O2=Object(Cr.injectable)(),O2(I2=function(){function e(){Ft()(this,e)}return Yt()(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LightingPlugin",function(){var n=t.getLayerConfig(),i=n.enableLighting;i&&t.models.forEach(function(s){return s.addUniforms(d0({},vR()))})})}}]),e}())||I2),k2,D2,Lg={NONE:0,ENCODE:1,HIGHLIGHT:2},gR=(k2=Object(Cr.injectable)(),k2(D2=function(){function e(){Ft()(this,e)}return Yt()(e,[{key:"apply",value:function(t,n){var i=n.rendererService,s=n.styleAttributeService;t.hooks.init.tap("PixelPickingPlugin",function(){var c=!0;s.registerStyleAttribute({name:"pickingColor",type:Yi.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:ve.FLOAT},size:3,update:function(y,E){var T=y.id;return c?An(T):[0,0,0]}}})}),t.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var c=t.getLayerConfig(),g=c.enablePicking;g&&t.isVisible()&&t.models.forEach(function(y){return y.addUniforms({u_PickingStage:Lg.ENCODE})})}),t.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var c=t.getLayerConfig(),g=c.enablePicking;g&&t.isVisible()&&t.models.forEach(function(y){return y.addUniforms({u_PickingStage:Lg.HIGHLIGHT})})}),t.hooks.beforeHighlight.tap("PixelPickingPlugin",function(c){var g=t.getLayerConfig(),y=g.highlightColor,E=g.activeMix,T=E===void 0?0:E,I=typeof y=="string"?Dr(y):y||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:nn(new Uint8Array(c))}),t.models.forEach(function(F){return F.addUniforms({u_PickingStage:Lg.HIGHLIGHT,u_PickingColor:c,u_HighlightColor:I.map(function(U){return U*255}),u_activeMix:T})})}),t.hooks.beforeSelect.tap("PixelPickingPlugin",function(c){var g=t.getLayerConfig(),y=g.selectColor,E=g.selectMix,T=E===void 0?0:E,I=typeof y=="string"?Dr(y):y||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:nn(new Uint8Array(c))}),t.models.forEach(function(F){return F.addUniforms({u_PickingStage:Lg.HIGHLIGHT,u_PickingColor:c,u_HighlightColor:I.map(function(U){return U*255}),u_activeMix:T,u_CurrentSelectedId:c,u_SelectColor:I.map(function(U){return U*255}),u_EnableSelect:1})})})}}]),e}())||D2),F2,B2,yR=(F2=Object(Cr.injectable)(),F2(B2=function(){function e(){Ft()(this,e)}return Yt()(e,[{key:"apply",value:function(t,n){var i=this,s=n.styleAttributeService;t.hooks.init.tap("RegisterStyleAttributePlugin",function(){i.registerBuiltinAttributes(s)})}},{key:"registerBuiltinAttributes",value:function(t){t.registerStyleAttribute({name:"position",type:Yi.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:ve.FLOAT},size:3,update:function(i,s,c){return c.length===2?[c[0],c[1],0]:[c[0],c[1],c[2]]}}}),t.registerStyleAttribute({name:"filter",type:Yi.Attribute,descriptor:{name:"filter",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(i,s){var c=i.filter;return c?[1]:[0]}}}),t.registerStyleAttribute({name:"color",type:Yi.Attribute,descriptor:{name:"a_Color",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:4,update:function(i,s){var c=i.color;return!c||!c.length?[1,1,1,1]:c}}}),t.registerStyleAttribute({name:"vertexId",type:Yi.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:ve.DYNAMIC_DRAW,data:[],type:ve.FLOAT},size:1,update:function(i,s,c,g){return[s]}}})}}]),e}())||B2),N2,z2,U2,j2,V2,G2,Pm,H2,W2,Z2,X2,_R=(N2=Object(Cr.injectable)(),z2=Object(Cr.inject)(sr.ICameraService),U2=Object(Cr.inject)(sr.ICoordinateSystemService),j2=Object(Cr.inject)(sr.IRendererService),V2=Object(Cr.inject)(sr.IMapService),N2(G2=(Pm=function(){function e(){Ft()(this,e),Di()(this,"cameraService",H2,this),Di()(this,"coordinateSystemService",W2,this),Di()(this,"rendererService",Z2,this),Di()(this,"mapService",X2,this)}return Yt()(e,[{key:"apply",value:function(t){var n=this,i=this.mapService.version,s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],c=[0,0];t.hooks.beforeRender.tap("ShaderUniformPlugin",function(){n.coordinateSystemService.refresh(),i==="GAODE2.x"&&(s=n.mapService.map.customCoords.getMVPMatrix(),c=n.mapService.getCustomCoordCenter());var g=n.rendererService.getViewportSize(),y=g.width,E=g.height;t.models.forEach(function(T){var I;T.addUniforms((I={},w()(I,kv.ProjectionMatrix,n.cameraService.getProjectionMatrix()),w()(I,kv.ViewMatrix,n.cameraService.getViewMatrix()),w()(I,kv.ViewProjectionMatrix,n.cameraService.getViewProjectionMatrix()),w()(I,kv.Zoom,n.cameraService.getZoom()),w()(I,kv.ZoomScale,n.cameraService.getZoomScale()),w()(I,kv.FocalDistance,n.cameraService.getFocalDistance()),w()(I,kv.CameraPosition,n.cameraService.getCameraPosition()),w()(I,jh.CoordinateSystem,n.coordinateSystemService.getCoordinateSystem()),w()(I,jh.ViewportCenter,n.coordinateSystemService.getViewportCenter()),w()(I,jh.ViewportCenterProjection,n.coordinateSystemService.getViewportCenterProjection()),w()(I,jh.PixelsPerDegree,n.coordinateSystemService.getPixelsPerDegree()),w()(I,jh.PixelsPerDegree2,n.coordinateSystemService.getPixelsPerDegree2()),w()(I,jh.PixelsPerMeter,n.coordinateSystemService.getPixelsPerMeter()),w()(I,jh.Mvp,s),w()(I,"u_SceneCenterMKT",c),w()(I,"u_ViewportSize",[y,E]),w()(I,"u_ModelMatrix",n.cameraService.getModelMatrix()),w()(I,"u_DevicePixelRatio",di.devicePixelRatio),w()(I,"u_PickingBuffer",t.getLayerConfig().pickingBuffer||0),w()(I,"u_shaderPick",Number(t.getShaderPickStat())),I))})})}}]),e}(),H2=Vi()(Pm.prototype,"cameraService",[z2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W2=Vi()(Pm.prototype,"coordinateSystemService",[U2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z2=Vi()(Pm.prototype,"rendererService",[j2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X2=Vi()(Pm.prototype,"mapService",[V2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pm))||G2),Y2,K2,xR=(Y2=Object(Cr.injectable)(),Y2(K2=function(){function e(){Ft()(this,e)}return Yt()(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("UpdateModelPlugin",function(){t.layerModel&&t.layerModel.needUpdate()})}}]),e}())||K2),$2,q2,bR=($2=Object(Cr.injectable)(),$2(q2=function(){function e(){Ft()(this,e)}return Yt()(e,[{key:"apply",value:function(t,n){var i=this,s=n.styleAttributeService;t.hooks.init.tap("UpdateStyleAttributePlugin",function(){i.initStyleAttribute(t,{styleAttributeService:s})}),t.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){t.layerModelNeedUpdate||i.updateStyleAtrribute(t,{styleAttributeService:s})})}},{key:"updateStyleAtrribute",value:function(t,n){var i=n.styleAttributeService,s=i.getLayerStyleAttributes()||[],c=i.getLayerStyleAttribute("filter"),g=i.getLayerStyleAttribute("shape");if(c&&c.needRegenerateVertices){t.layerModelNeedUpdate=!0,s.forEach(function(y){return y.needRegenerateVertices=!1});return}s.filter(function(y){return y.needRegenerateVertices}).forEach(function(y){i.updateAttributeByFeatureRange(y.name,t.getEncodedData(),y.featureRange.startIndex,y.featureRange.endIndex),y.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(t,n){var i=n.styleAttributeService,s=i.getLayerStyleAttributes()||[];s.filter(function(c){return c.needRegenerateVertices}).forEach(function(c){i.updateAttributeByFeatureRange(c.name,t.getEncodedData(),c.featureRange.startIndex,c.featureRange.endIndex),c.needRegenerateVertices=!1})}}]),e}())||q2);Eh.bind(sr.ILayerPlugin).to(xI).inRequestScope(),Eh.bind(sr.ILayerPlugin).to(yR).inRequestScope(),Eh.bind(sr.ILayerPlugin).to(oR).inRequestScope(),Eh.bind(sr.ILayerPlugin).to(_I).inRequestScope(),Eh.bind(sr.ILayerPlugin).to(cR).inRequestScope(),Eh.bind(sr.ILayerPlugin).to(bR).inRequestScope(),Eh.bind(sr.ILayerPlugin).to(xR).inRequestScope(),Eh.bind(sr.ILayerPlugin).to(RT).inRequestScope(),Eh.bind(sr.ILayerPlugin).to(_R).inRequestScope(),Eh.bind(sr.ILayerPlugin).to(uR).inRequestScope(),Eh.bind(sr.ILayerPlugin).to(mR).inRequestScope(),Eh.bind(sr.ILayerPlugin).to(gR).inRequestScope(),Eh.bind(sr.ILayerPlugin).to(lR).inRequestScope();var I6="2.7.18",Q2,__,J2;function eS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function tS(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?eS(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):eS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var kg=(Q2=Ly(sr.IGlobalConfigService),__=function(){function e(r){Ft()(this,e),Di()(this,"configService",J2,this),w()(this,"config",void 0),this.config=r}return Yt()(e,[{key:"setContainer",value:function(t,n,i,s){t.bind(sr.MapConfig).toConstantValue(tS(tS({},this.config),{},{id:n,canvas:i,hasBaseMap:s})),t.bind(sr.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),e}(),J2=Vi()(__.prototype,"configService",[Q2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),__),ER=M("sXyB"),Dg=M.n(ER),SR=M("hi0z"),rS=M.n(SR);function nS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function iS(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?nS(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Fg(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r={top:0,right:0,bottom:0,left:0};if(typeof e=="number")return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(e.length===4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]}}return iS(iS({},r),e)}var aS={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},oS=Math.PI/180,CR=function(){function e(){Ft()(this,e),w()(this,"projectionMatrix",k.create()),w()(this,"viewMatrix",k.create()),w()(this,"viewProjectionMatrix",k.create()),w()(this,"ViewProjectionMatrixUncentered",k.create()),w()(this,"viewUncenteredMatrix",k.create()),w()(this,"zoom",void 0),w()(this,"center",void 0)}return Yt()(e,[{key:"syncWithMapCamera",value:function(t){var n=t.zoom,i=n===void 0?1:n,s=t.pitch,c=s===void 0?0:s,g=t.bearing,y=g===void 0?0:g,E=t.center,T=E===void 0?[0,0]:E,I=t.offsetOrigin,F=I===void 0?[0,0]:I,U=t.cameraHeight,Q=U===void 0?1:U,ue=t.aspect,de=ue===void 0?1:ue,Re=t.near,et=Re===void 0?.1:Re,ht=t.far,xt=ht===void 0?1e3:ht,Gt=t.fov,jt=Gt===void 0?0:Gt;this.zoom=i,this.center=T;var Qt=c*oS,fr=(360-y)*oS;k.perspective(this.projectionMatrix,jt,de,et,xt);var Gr=V.fromValues(Q*Math.sin(Qt)*Math.sin(fr),-Q*Math.sin(Qt)*Math.cos(fr),Q*Math.cos(Qt)),Jr=V.fromValues(-Math.cos(Qt)*Math.sin(fr),Math.cos(Qt)*Math.cos(fr),Math.sin(Qt));k.lookAt(this.viewMatrix,Gr,V.fromValues(0,0,0),Jr),this.viewUncenteredMatrix=k.clone(this.viewMatrix),k.translate(this.viewMatrix,this.viewMatrix,V.fromValues(-F[0],F[1],0)),k.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),k.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var t=Ei()(this.center,2),n=t[0],i=t[1];return[n,i]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,n){var i=85.0511287798,s=Math.max(Math.min(i,t[1]),-i),c=256<<20,g=Math.PI/180,y=t[0]*g,E=s*g;E=Math.log(Math.tan(Math.PI/4+E/2));var T=.5/Math.PI,I=.5,F=-.5/Math.PI;return g=.5,y=c*(T*y+I)-215440491,E=-(c*(F*E+g)-106744817),[y,E]}}]),e}(),wR=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],sS,uS,lS,cS,fS,hS,Om,pS,dS,vS,mS;function gS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function AR(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?gS(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):gS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function TR(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}TR(`.amap-logo{
 display: none !important;
}
`);var MR=0;window.forceWebGL=!0;var yS="15cd8a57710d40c9b7c0e3cc120f1200",PR="1.4.15",OR="amap-script",x_=!1,Bg=[],IR=12,RR=(sS=Object(Cr.injectable)(),uS=Object(Cr.inject)(sr.IGlobalConfigService),lS=Object(Cr.inject)(sr.MapConfig),cS=Object(Cr.inject)(sr.ICoordinateSystemService),fS=Object(Cr.inject)(sr.IEventEmitter),sS(hS=(Om=function(){function e(){var r=this;Ft()(this,e),w()(this,"version",Xp["GAODE1.x"]),w()(this,"map",void 0),w()(this,"dragging",!1),w()(this,"bgColor","rgba(0, 0, 0, 0)"),Di()(this,"configService",pS,this),Di()(this,"config",dS,this),Di()(this,"coordinateSystemService",vS,this),Di()(this,"eventEmitter",mS,this),w()(this,"markerContainer",void 0),w()(this,"$mapContainer",void 0),w()(this,"viewport",void 0),w()(this,"cameraChangedCallback",void 0),w()(this,"handleCameraChanged",function(t){var n=t.camera,i=n.fov,s=n.near,c=n.far,g=n.height,y=n.pitch,E=n.rotation,T=n.aspect,I=n.position,F=r.getCenter(),U=F.lng,Q=F.lat;if(r.emit("mapchange"),r.cameraChangedCallback){r.viewport.syncWithMapCamera({aspect:T,bearing:360-E,far:c,fov:i,cameraHeight:g,near:s,pitch:y,zoom:r.map.getZoom()-1,center:[U,Q],offsetOrigin:[I.x,I.y]});var ue=r.config.offsetZoom,de=ue===void 0?IR:ue;r.viewport.getZoom()>de?r.coordinateSystemService.setCoordinateSystem(zu.P20_OFFSET):r.coordinateSystemService.setCoordinateSystem(zu.P20),r.cameraChangedCallback(r.viewport)}})}return Yt()(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"addMarkerContainer",value:function(){var t=this.map.getContainer();if(t!==null){var n=t.getElementsByClassName("amap-maps")[0];this.markerContainer=j.create("div","l7-marker-container",n)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,n){mm.indexOf(t)!==-1?this.eventEmitter.on(t,n):this.map.on(t,n)}},{key:"off",value:function(t,n){mm.indexOf(t)!==-1?this.eventEmitter.off(t,n):this.map.off(t,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var t;return(t=this.map.getContainer())===null||t===void 0?void 0:t.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var t=this.map.getSize();return[t.getWidth(),t.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(t){return this.map.setZoom(t+1)}},{key:"getCenter",value:function(t){if(t!=null&&t.padding){var n=this.getCenter(),i=this.getSize(),s=Ei()(i,2),c=s[0],g=s[1],y=Fg(t.padding),E=this.lngLatToPixel([n.lng,n.lat]),T=[(y.right-y.left)/2,(y.bottom-y.top)/2],I=this.pixelToLngLat([E.x-T[0],E.y-T[1]]);return I}var F=this.map.getCenter();return{lng:F.getLng(),lat:F.getLat()}}},{key:"setCenter",value:function(t,n){if(n!=null&&n.padding){var i=Fg(n.padding),s=this.lngLatToPixel(t),c=[(i.right-i.left)/2,(i.bottom-i.top)/2],g=this.pixelToLngLat([s.x+c[0],s.y+c[1]]);this.map.setCenter([g.lng,g.lat])}else this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var t=this.map.getBounds().toBounds(),n=t.getNorthEast(),i=t.getSouthWest(),s=this.getCenter(),c=s.lng>n.getLng()||s.lng<i.getLng()?180-n.getLng():n.getLng(),g=s.lng<i.getLng()?i.getLng()-180:i.getLng();return[[g,i.getLat()],[c,n.getLat()]]}},{key:"getMinZoom",value:function(){var t=this.map.get("zooms");return t[0]-1}},{key:"getMaxZoom",value:function(){var t=this.map.get("zooms");return t[1]-1}},{key:"setRotation",value:function(t){return this.map.setRotation(t)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(t,n)}},{key:"fitBounds",value:function(t){this.map.setBounds(new AMap.Bounds([t[0][0],t[0][1],t[1][0],t[1][1]]))}},{key:"setZoomAndCenter",value:function(t,n){this.map.setZoomAndCenter(t,n)}},{key:"setMapStyle",value:function(t){this.map.setMapStyle(this.getMapStyle(t))}},{key:"setMapStatus",value:function(t){this.map.setStatus(t)}},{key:"pixelToLngLat",value:function(t){var n=this.map.pixelToLngLat(new AMap.Pixel(t[0],t[1]));return{lng:n.getLng(),lat:n.getLat()}}},{key:"lngLatToPixel",value:function(t){var n=this.map.lnglatToPixel(new AMap.LngLat(t[0],t[1]));return{x:n.getX(),y:n.getY()}}},{key:"containerToLngLat",value:function(t){var n=new AMap.Pixel(t[0],t[1]),i=this.map.containerToLngLat(n);return{lng:i==null?void 0:i.getLng(),lat:i==null?void 0:i.getLat()}}},{key:"lngLatToContainer",value:function(t){var n=new AMap.LngLat(t[0],t[1]),i=this.map.lngLatToContainer(n);return{x:i.getX(),y:i.getY()}}},{key:"lngLatToCoord",value:function(t){var n=this.map.lngLatToGeodeticCoord(t),i=n.x,s=n.y;return[i,-s]}},{key:"lngLatToMercator",value:function(t,n){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},g=this.viewport.projectFlat(t),y=k.create();return k.translate(y,y,V.fromValues(g[0],g[1],n)),k.scale(y,y,V.fromValues(s[0],s[1],s[2])),k.rotateX(y,y,i[0]),k.rotateY(y,y,i[1]),k.rotateZ(y,y,i[2]),y}},{key:"init",value:function(){var r=tu()(Na.a.mark(function n(){var i=this,s,c,g,y,E,T,I,F,U,Q,ue,de,Re,et;return Na.a.wrap(function(xt){for(;;)switch(xt.prev=xt.next){case 0:return s=this.config,c=s.id,g=s.style,y=g===void 0?"light":g,E=s.minZoom,T=E===void 0?0:E,I=s.maxZoom,F=I===void 0?18:I,U=s.token,Q=U===void 0?yS:U,ue=s.mapInstance,de=s.plugin,Re=de===void 0?[]:de,et=xp()(s,wR),xt.next=3,new Promise(function(Gt){var jt=function(){if(ue)i.map=ue,i.$mapContainer=i.map.getContainer(),setTimeout(function(){i.map.on("camerachange",i.handleCameraChanged),Gt()},30);else{i.$mapContainer=i.creatAmapContainer(c);var fr=AR({mapStyle:i.getMapStyle(y),zooms:[T,F],viewMode:"3D"},et);fr.zoom&&(fr.zoom+=1);var Gr=new AMap.Map(i.$mapContainer,fr);Gr.on("camerachange",i.handleCameraChanged),i.map=Gr,setTimeout(function(){Gt()},10)}};!x_&&!ue?(Q===yS&&console.warn(i.configService.getSceneWarninfo("MapToken")),x_=!0,Re.push("Map3D"),rS.a.load({key:Q,version:PR,plugins:Re}).then(function(Qt){jt(),Bg.length&&(Bg.forEach(function(fr){return fr()}),Bg=[])}).catch(function(Qt){throw new Error(Qt)})):x_&&window.AMap||ue?jt():Bg.push(jt)});case 3:this.map.on("dragstart",function(){return i.dragging=!0,""}),this.map.on("dragend",function(){return i.dragging=!1,""}),this.viewport=new CR;case 6:case"end":return xt.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"meterToCoord",value:function(t,n){var i=AMap.GeometryUtil.distance(Dg()(AMap.LngLat,Ut()(t)),Dg()(AMap.LngLat,Ut()(n))),s=this.lngLatToCoord(t),c=Ei()(s,2),g=c[0],y=c[1],E=this.lngLatToCoord(n),T=Ei()(E,2),I=T[0],F=T[1],U=Math.sqrt(Math.pow(g-I,2)+Math.pow(y-F,2));return U/i}},{key:"exportMap",value:function(t){var n,i=(n=this.getContainer())===null||n===void 0?void 0:n.getElementsByClassName("amap-layer")[0],s=t==="jpg"?i==null?void 0:i.toDataURL("image/jpeg"):i==null?void 0:i.toDataURL("image/png");return s}},{key:"emit",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).emit.apply(n,[t].concat(s))}},{key:"once",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).once.apply(n,[t].concat(s))}},{key:"destroy",value:function(){var t,n;this.map.destroy(),(t=this.$mapContainer)===null||t===void 0||(n=t.parentNode)===null||n===void 0||n.removeChild(this.$mapContainer),delete window.initAMap;var i=document.getElementById(OR);i&&document.head.removeChild(i)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"getMapStyle",value:function(t){return aS[t]?aS[t]:t}},{key:"creatAmapContainer",value:function(t){var n=t;typeof t=="string"&&(n=document.getElementById(t));var i=document.createElement("div");return i.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,i.id="l7_amap_div"+MR++,n.appendChild(i),i}}]),e}(),pS=Vi()(Om.prototype,"configService",[uS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dS=Vi()(Om.prototype,"config",[lS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vS=Vi()(Om.prototype,"coordinateSystemService",[cS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mS=Vi()(Om.prototype,"eventEmitter",[fS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Om))||hS);function LR(e){var r=kR();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function kR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var DR=function(e){qr()(t,e);var r=LR(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getServiceConstructor",value:function(){return RR}}]),t}(kg);function _S(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function xS(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?_S(Object(t),!0).forEach(function(n){FR(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_S(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function FR(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function BR(e,r){return jR(e)||UR(e,r)||zR(e,r)||NR()}function NR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zR(e,r){if(!!e){if(typeof e=="string")return bS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return bS(e,r)}}function bS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function UR(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,g;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(y){s=!0,g=y}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw g}}return n}}function jR(e){if(Array.isArray(e))return e}var VR=pe.a.memo(function(e){var r=e.style,t=e.className,n=e.map,i=e.option,s=e.onSceneLoaded,c=e.children,g=Object(te.useRef)(null),y=Object(te.useState)(),E=BR(y,2),T=E[0],I=E[1];return Object(te.useEffect)(function(){var F=new e0(xS(xS({id:g.current},i),{},{map:new DR(n)}));return F.on("loaded",function(){I(F),s&&s(F)}),function(){F.destroy()}},[]),Object(te.useEffect)(function(){T&&n.style&&T.setMapStyle(n.style)},[JSON.stringify(n.style)]),Object(te.useEffect)(function(){T&&n.zoom&&T.setZoom(n.zoom)},[n.zoom]),Object(te.useEffect)(function(){T&&n.center&&T.setCenter(n.center)},[JSON.stringify(n.center)]),Object(te.useEffect)(function(){T&&n.pitch&&T.setPitch(n.pitch)},[n.pitch]),Object(te.useEffect)(function(){T&&n.rotation&&T.setRotation(n.rotation)},[n.rotation]),pe.a.createElement(Oe.Provider,{value:T},pe.a.createElement("div",{ref:g,className:t,style:r},T&&c))}),R6=VR,GR=M("4ZJM"),v0=M.n(GR),ES=M("1OyB"),SS=M("vuIU"),HR=M("md7G"),WR=M("foSv"),ZR=M("Ji7U"),Ng=M("JX7q"),Xf=M("ODXe");function m0(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function zg(e,r){var t=Lp([],r,e);return Bu(t,t,1/t[3]),t}function L6(e,r){var t=e%r;return t<0?r+t:t}function k6(e,r,t){return t*r+(1-t)*e}function av(e,r){if(!e)throw new Error(r||"viewport-mercator-project: assertion failed.")}var wp=Math.PI,CS=wp/4,bd=wp/180,wS=180/wp,b_=512,E_=4003e4,XR=1.5;function AS(e){return Math.pow(2,e)}function YR(e){return Math.log2(e)}function Ug(e,r){var t=Object(Xf.a)(e,2),n=t[0],i=t[1];av(Number.isFinite(n)&&Number.isFinite(r)),av(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude"),r*=b_;var s=n*bd,c=i*bd,g=r*(s+wp)/(2*wp),y=r*(wp-Math.log(Math.tan(CS+c*.5)))/(2*wp);return[g,y]}function S_(e,r){var t=Object(Xf.a)(e,2),n=t[0],i=t[1];r*=b_;var s=n/r*(2*wp)-wp,c=2*(Math.atan(Math.exp(wp-i/r*(2*wp)))-CS);return[s*wS,c*wS]}function D6(e){var r=e.latitude;av(Number.isFinite(r));var t=Math.cos(r*bd);return YR(E_*t)-9}function TS(e){var r=e.latitude,t=e.longitude,n=e.zoom,i=e.scale,s=e.highPrecision,c=s===void 0?!1:s;i=i!==void 0?i:AS(n),av(Number.isFinite(r)&&Number.isFinite(t)&&Number.isFinite(i));var g={},y=b_*i,E=Math.cos(r*bd),T=y/360,I=T/E,F=y/E_/E;if(g.pixelsPerMeter=[F,-F,F],g.metersPerPixel=[1/F,-1/F,1/F],g.pixelsPerDegree=[T,-I,F],g.degreesPerPixel=[1/T,-1/I,1/F],c){var U=bd*Math.tan(r*bd)/E,Q=T*U/2,ue=y/E_*U,de=ue/I*F;g.pixelsPerDegree2=[0,-Q,ue],g.pixelsPerMeter2=[de,0,de]}return g}function F6(e,r){var t=Object(Xf.a)(e,3),n=t[0],i=t[1],s=t[2],c=Object(Xf.a)(r,3),g=c[0],y=c[1],E=c[2],T=1,I=TS({longitude:n,latitude:i,scale:T,highPrecision:!0}),F=I.pixelsPerMeter,U=I.pixelsPerMeter2,Q=Ug(e,T);Q[0]+=g*(F[0]+U[0]*y),Q[1]+=y*(F[1]+U[1]*y);var ue=S_(Q,T),de=(s||0)+(E||0);return Number.isFinite(s)||Number.isFinite(E)?[ue[0],ue[1],de]:ue}function KR(e){var r=e.height,t=e.pitch,n=e.bearing,i=e.altitude,s=e.center,c=s===void 0?null:s,g=e.flipY,y=g===void 0?!1:g,E=m0();return gn(E,E,[0,0,-i]),Sn(E,E,[1,1,1/r]),In(E,E,-t*bd),ta(E,E,n*bd),y&&Sn(E,E,[1,-1,1]),c&&gn(E,E,Be([],c)),E}function $R(e){var r=e.width,t=e.height,n=e.altitude,i=n===void 0?XR:n,s=e.pitch,c=s===void 0?0:s,g=e.nearZMultiplier,y=g===void 0?1:g,E=e.farZMultiplier,T=E===void 0?1:E,I=c*bd,F=Math.atan(.5/i),U=Math.sin(F)*i/Math.sin(Math.PI/2-I-F),Q=Math.cos(Math.PI/2-I)*U+i;return{fov:2*Math.atan(t/2/i),aspect:r/t,focalDistance:i,near:y,far:Q*T}}function qR(e){var r=e.width,t=e.height,n=e.pitch,i=e.altitude,s=e.nearZMultiplier,c=e.farZMultiplier,g=$R({width:r,height:t,altitude:i,pitch:n,nearZMultiplier:s,farZMultiplier:c}),y=g.fov,E=g.aspect,T=g.near,I=g.far,F=Xo([],y,E,T,I);return F}function QR(e,r){var t=Object(Xf.a)(e,3),n=t[0],i=t[1],s=t[2],c=s===void 0?0:s;return av(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(c)),zg(r,[n,i,c,1])}function MS(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=Object(Xf.a)(e,3),i=n[0],s=n[1],c=n[2];if(av(Number.isFinite(i)&&Number.isFinite(s),"invalid pixel coordinate"),Number.isFinite(c)){var g=zg(r,[i,s,c,1]);return g}var y=zg(r,[i,s,0,1]),E=zg(r,[i,s,1,1]),T=y[2],I=E[2],F=T===I?0:((t||0)-T)/(I-T);return So([],y,E,F)}var PS=m0(),JR=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=r.width,n=r.height,i=r.viewMatrix,s=i===void 0?PS:i,c=r.projectionMatrix,g=c===void 0?PS:c;Object(ES.a)(this,e),this.width=t||1,this.height=n||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=s,this.projectionMatrix=g;var y=m0();mr(y,y,this.projectionMatrix),mr(y,y,this.viewMatrix),this.viewProjectionMatrix=y;var E=m0();Sn(E,E,[this.width/2,-this.height/2,1]),gn(E,E,[1,-1,0]),mr(E,E,this.viewProjectionMatrix);var T=Bn(m0(),E);if(!T)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=E,this.pixelUnprojectionMatrix=T,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(SS.a)(e,[{key:"equals",value:function(t){return t instanceof e?t.width===this.width&&t.height===this.height&&De(t.projectionMatrix,this.projectionMatrix)&&De(t.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,s=i===void 0?!0:i,c=this.projectPosition(t),g=QR(c,this.pixelProjectionMatrix),y=Object(Xf.a)(g,2),E=y[0],T=y[1],I=s?T:this.height-T;return t.length===2?[E,I]:[E,I,g[2]]}},{key:"unproject",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,s=i===void 0?!0:i,c=n.targetZ,g=Object(Xf.a)(t,3),y=g[0],E=g[1],T=g[2],I=s?E:this.height-E,F=c&&c*this.pixelsPerMeter,U=MS([y,I,T],this.pixelUnprojectionMatrix,F),Q=this.unprojectPosition(U),ue=Object(Xf.a)(Q,3),de=ue[0],Re=ue[1],et=ue[2];return Number.isFinite(T)?[de,Re,et]:Number.isFinite(c)?[de,Re,c]:[de,Re]}},{key:"projectPosition",value:function(t){var n=this.projectFlat(t),i=Object(Xf.a)(n,2),s=i[0],c=i[1],g=(t[2]||0)*this.pixelsPerMeter;return[s,c,g]}},{key:"unprojectPosition",value:function(t){var n=this.unprojectFlat(t),i=Object(Xf.a)(n,2),s=i[0],c=i[1],g=(t[2]||0)/this.pixelsPerMeter;return[s,c,g]}},{key:"projectFlat",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return t}},{key:"unprojectFlat",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return t}}]),e}();function e4(e){var r=e.width,t=e.height,n=e.bounds,i=e.minExtent,s=i===void 0?0:i,c=e.maxZoom,g=c===void 0?24:c,y=e.padding,E=y===void 0?0:y,T=e.offset,I=T===void 0?[0,0]:T,F=Object(Xf.a)(n,2),U=Object(Xf.a)(F[0],2),Q=U[0],ue=U[1],de=Object(Xf.a)(F[1],2),Re=de[0],et=de[1];if(Number.isFinite(E)){var ht=E;E={top:ht,bottom:ht,left:ht,right:ht}}else av(Number.isFinite(E.top)&&Number.isFinite(E.bottom)&&Number.isFinite(E.left)&&Number.isFinite(E.right));var xt=new C_({width:r,height:t,longitude:0,latitude:0,zoom:0}),Gt=xt.project([Q,et]),jt=xt.project([Re,ue]),Qt=[Math.max(Math.abs(jt[0]-Gt[0]),s),Math.max(Math.abs(jt[1]-Gt[1]),s)],fr=[r-E.left-E.right-Math.abs(I[0])*2,t-E.top-E.bottom-Math.abs(I[1])*2];av(fr[0]>0&&fr[1]>0);var Gr=fr[0]/Qt[0],Jr=fr[1]/Qt[1],Ur=(E.right-E.left)/2/Gr,Xn=(E.bottom-E.top)/2/Jr,ni=[(jt[0]+Gt[0])/2+Ur,(jt[1]+Gt[1])/2+Xn],Oi=xt.unproject(ni),No=xt.zoom+Math.log2(Math.abs(Math.min(Gr,Jr)));return{longitude:Oi[0],latitude:Oi[1],zoom:Math.min(No,g)}}var C_=function(e){Object(ZR.a)(r,e);function r(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.width,s=n.height,c=n.latitude,g=c===void 0?0:c,y=n.longitude,E=y===void 0?0:y,T=n.zoom,I=T===void 0?0:T,F=n.pitch,U=F===void 0?0:F,Q=n.bearing,ue=Q===void 0?0:Q,de=n.altitude,Re=de===void 0?1.5:de,et=n.nearZMultiplier,ht=n.farZMultiplier;Object(ES.a)(this,r),i=i||1,s=s||1;var xt=AS(I);Re=Math.max(.75,Re);var Gt=Ug([E,g],xt);Gt[2]=0;var jt=qR({width:i,height:s,pitch:U,bearing:ue,altitude:Re,nearZMultiplier:et||1/s,farZMultiplier:ht||1.01}),Qt=KR({height:s,center:Gt,pitch:U,bearing:ue,altitude:Re,flipY:!0});return t=Object(HR.a)(this,Object(WR.a)(r).call(this,{width:i,height:s,viewMatrix:Qt,projectionMatrix:jt})),t.latitude=g,t.longitude=E,t.zoom=I,t.pitch=U,t.bearing=ue,t.altitude=Re,t.scale=xt,t.center=Gt,t.pixelsPerMeter=TS(Object(Ng.a)(Object(Ng.a)(t))).pixelsPerMeter[2],Object.freeze(Object(Ng.a)(Object(Ng.a)(t))),t}return Object(SS.a)(r,[{key:"projectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Ug(n,i)}},{key:"unprojectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return S_(n,i)}},{key:"getMapCenterByLngLatPosition",value:function(n){var i=n.lngLat,s=n.pos,c=MS(s,this.pixelUnprojectionMatrix),g=Ug(i,this.scale),y=Se([],g,Ri([],c)),E=Se([],this.center,y);return S_(E,this.scale)}},{key:"getLocationAtPoint",value:function(n){var i=n.lngLat,s=n.pos;return this.getMapCenterByLngLatPosition({lngLat:i,pos:s})}},{key:"fitBounds",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=this.width,c=this.height,g=e4(Object.assign({width:s,height:c,bounds:n},i)),y=g.longitude,E=g.latitude,T=g.zoom;return new r({width:s,height:c,longitude:y,latitude:E,zoom:T})}}]),r}(JR),t4=function(){function e(){Ft()(this,e),w()(this,"viewport",void 0)}return Yt()(e,[{key:"syncWithMapCamera",value:function(t){var n=t.center,i=t.zoom,s=t.pitch,c=t.bearing,g=t.viewportHeight,y=t.viewportWidth;this.viewport=new C_({width:y,height:g,longitude:n&&n[0],latitude:n&&n[1],zoom:i,pitch:s,bearing:c})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,n){return this.viewport.projectFlat(t,n)}}]),e}(),OS={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},r4=["id","attributionControl","style","token","rotation","mapInstance"],IS,RS,LS,kS,DS,FS,Im,BS,NS,zS,US;function jS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function n4(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?jS(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):jS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function i4(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}i4(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=v0.a;var VS={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},a4=0,o4=12,GS="pk.eyJ1IjoibHp4dWUiLCJhIjoiY2tvaWZuM2s4MWZuYjJ1dHI5ZGduYTlrdiJ9.DQCfMRbZzx0VSwecQ69McA",s4=(IS=Object(Cr.injectable)(),RS=Object(Cr.inject)(sr.MapConfig),LS=Object(Cr.inject)(sr.IGlobalConfigService),kS=Object(Cr.inject)(sr.ICoordinateSystemService),DS=Object(Cr.inject)(sr.IEventEmitter),IS(FS=(Im=function(){function e(){var r=this;Ft()(this,e),w()(this,"version",Xp.MAPBOX),w()(this,"map",void 0),w()(this,"dragging",!1),w()(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),Di()(this,"config",BS,this),Di()(this,"configService",NS,this),Di()(this,"coordinateSystemService",zS,this),Di()(this,"eventEmitter",US,this),w()(this,"viewport",void 0),w()(this,"markerContainer",void 0),w()(this,"cameraChangedCallback",void 0),w()(this,"$mapContainer",void 0),w()(this,"handleCameraChanged",function(){var t=r.map.getCenter().wrap(),n=t.lat,i=t.lng;r.emit("mapchange"),r.viewport.syncWithMapCamera({bearing:r.map.getBearing(),center:[i,n],viewportHeight:r.map.transform.height,pitch:r.map.getPitch(),viewportWidth:r.map.transform.width,zoom:r.map.getZoom(),cameraHeight:0});var s=r.config.offsetZoom,c=s===void 0?o4:s;r.viewport.getZoom()>c?r.coordinateSystemService.setCoordinateSystem(zu.LNGLAT_OFFSET):r.coordinateSystemService.setCoordinateSystem(zu.LNGLAT),r.cameraChangedCallback(r.viewport)})}return Yt()(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"addMarkerContainer",value:function(){var t=this.map.getCanvasContainer();this.markerContainer=j.create("div","l7-marker-container",t),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,n){mm.indexOf(t)!==-1?this.eventEmitter.on(t,n):this.map.on(VS[t]||t,n)}},{key:"off",value:function(t,n){this.map.off(VS[t]||t,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var t=this.map.transform;return[t.width,t.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(t){return this.map.setZoom(t)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(t){this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(t){this.map.setBearing(t)}},{key:"zoomIn",value:function(t,n){this.map.zoomIn(t,n)}},{key:"zoomOut",value:function(t,n){this.map.zoomOut(t,n)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(t,n){this.panTo([t,n])}},{key:"fitBounds",value:function(t,n){this.map.fitBounds(t,n)}},{key:"setMaxZoom",value:function(t){this.map.setMaxZoom(t)}},{key:"setMinZoom",value:function(t){this.map.setMinZoom(t)}},{key:"setMapStatus",value:function(t){t.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),t.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),t.dragEnable===!1&&this.map.dragPan.disable(),t.dragEnable===!0&&this.map.dragPan.enable(),t.rotateEnable===!1&&this.map.dragRotate.disable(),t.rotateEnable===!0&&this.map.dragRotate.enable(),t.keyboardEnable===!1&&this.map.keyboard.disable(),t.keyboardEnable===!0&&this.map.keyboard.enable(),t.zoomEnable===!1&&this.map.scrollZoom.disable(),t.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(t,n){this.map.flyTo({zoom:t,center:n})}},{key:"setMapStyle",value:function(t){this.map.setStyle(this.getMapStyle(t))}},{key:"pixelToLngLat",value:function(t){return this.map.unproject(t)}},{key:"lngLatToPixel",value:function(t){return this.map.project(t)}},{key:"containerToLngLat",value:function(t){return this.map.unproject(t)}},{key:"lngLatToContainer",value:function(t){return this.map.project(t)}},{key:"lngLatToCoord",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{x:0,y:0,z:0},i=this.lngLatToMercator(t,0),s=i.x,c=i.y;return[s-n.x,c-n.y]}},{key:"lngLatToMercator",value:function(t,n){var i=window.mapboxgl.MercatorCoordinate.fromLngLat(t,n),s=i.x,c=s===void 0?0:s,g=i.y,y=g===void 0?0:g,E=i.z,T=E===void 0?0:E;return{x:c,y,z:T}}},{key:"getModelMatrix",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},g=window.mapboxgl.MercatorCoordinate.fromLngLat(t,n),y=g.meterInMercatorCoordinateUnits(),E=k.create();return k.translate(E,E,V.fromValues(g.x-c.x,g.y-c.y,g.z||0-c.z)),k.scale(E,E,V.fromValues(y*s[0],-y*s[1],y*s[2])),k.rotateX(E,E,i[0]),k.rotateY(E,E,i[1]),k.rotateZ(E,E,i[2]),E}},{key:"init",value:function(){var r=tu()(Na.a.mark(function n(){var i=this,s,c,g,y,E,T,I,F,U,Q,ue,de,Re;return Na.a.wrap(function(ht){for(;;)switch(ht.prev=ht.next){case 0:s=this.config,c=s.id,g=c===void 0?"map":c,y=s.attributionControl,E=y===void 0?!1:y,T=s.style,I=T===void 0?"light":T,F=s.token,U=F===void 0?GS:F,Q=s.rotation,ue=Q===void 0?0:Q,de=s.mapInstance,Re=xp()(s,r4),this.viewport=new t4,!de&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),U===GS&&I!=="blank"&&!window.mapboxgl.accessToken&&!de&&console.warn(this.configService.getSceneWarninfo("MapToken")),!de&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=U),de?(this.map=de,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(g),this.map=new window.mapboxgl.Map(n4({container:this.$mapContainer,style:this.getMapStyle(I),attributionControl:E,bearing:ue},Re))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.map.on("dragstart",function(){return i.dragging=!0,""}),this.map.on("dragend",function(){return i.dragging=!1,""}),this.handleCameraChanged();case 11:case"end":return ht.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"destroy",value:function(){var t,n;(t=this.$mapContainer)===null||t===void 0||(n=t.parentNode)===null||n===void 0||n.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).emit.apply(n,[t].concat(s))}},{key:"once",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).once.apply(n,[t].concat(s))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"meterToCoord",value:function(t,n){var i=new v0.a.LngLat(t[0],t[1]),s=new v0.a.LngLat(n[0],n[1]),c=i.distanceTo(s),g=v0.a.MercatorCoordinate.fromLngLat({lng:t[0],lat:t[1]}),y=v0.a.MercatorCoordinate.fromLngLat({lng:n[0],lat:n[1]}),E=g.x,T=g.y,I=y.x,F=y.y,U=Math.sqrt(Math.pow(E-I,2)+Math.pow(T-F,2))*4194304*2;return U/c}},{key:"exportMap",value:function(t){var n=this.map.getCanvas(),i=t==="jpg"?n==null?void 0:n.toDataURL("image/jpeg"):n==null?void 0:n.toDataURL("image/png");return i}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"creatAmapContainer",value:function(t){var n=t;typeof t=="string"&&(n=document.getElementById(t));var i=document.createElement("div");return i.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,i.id="l7_mapbox_div"+a4++,n.appendChild(i),i}},{key:"getMapStyle",value:function(t){return typeof t!="string"?t:OS[t]?OS[t]:t}}]),e}(),BS=Vi()(Im.prototype,"config",[RS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NS=Vi()(Im.prototype,"configService",[LS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zS=Vi()(Im.prototype,"coordinateSystemService",[kS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),US=Vi()(Im.prototype,"eventEmitter",[DS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Im))||FS);function u4(e){var r=l4();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function l4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function c4(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}c4(`.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var f4=function(e){qr()(t,e);var r=u4(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getServiceConstructor",value:function(){return s4}}]),t}(kg);function HS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function WS(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?HS(Object(t),!0).forEach(function(n){h4(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):HS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function h4(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function p4(e,r){return g4(e)||m4(e,r)||v4(e,r)||d4()}function d4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v4(e,r){if(!!e){if(typeof e=="string")return ZS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ZS(e,r)}}function ZS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function m4(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,g;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(y){s=!0,g=y}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw g}}return n}}function g4(e){if(Array.isArray(e))return e}var y4=pe.a.memo(function(e){var r=e.style,t=e.className,n=e.map,i=e.option,s=e.onSceneLoaded,c=Object(te.createRef)(),g=Object(te.useState)(),y=p4(g,2),E=y[0],T=y[1];return Object(te.useEffect)(function(){var I=new e0(WS(WS({id:c.current},i),{},{map:new f4(n)}));return I.on("loaded",function(){T(I),s&&s(I)}),function(){I.destroy()}},[]),Object(te.useEffect)(function(){E&&n.style&&E.setMapStyle(n.style)},[JSON.stringify(n.style)]),Object(te.useEffect)(function(){E&&n.zoom&&E.setZoom(n.zoom)},[n.zoom]),Object(te.useEffect)(function(){E&&n.center&&E.setCenter(n.center)},[JSON.stringify(n.center)]),Object(te.useEffect)(function(){E&&n.pitch!==void 0&&E.setPitch(n.pitch||0)},[n.pitch]),Object(te.useEffect)(function(){E&&n.rotation&&E.setRotation(n.rotation)},[n.rotation]),pe.a.createElement(Oe.Provider,{value:E},Object(te.createElement)("div",{ref:c,style:r,className:t},E&&e.children))}),_4=y4,XS={dark:"amap://styles/dark",light:"amap://styles/light",normal:"amap://styles/normal",blank:"amap://styles/1a91e7ec761981d85b35f3099ff781a3"},x4=function(){function e(){Ft()(this,e),w()(this,"projectionMatrix",k.create()),w()(this,"viewMatrix",k.create()),w()(this,"viewProjectionMatrix",k.create()),w()(this,"ViewProjectionMatrixUncentered",k.create()),w()(this,"viewUncenteredMatrix",k.create()),w()(this,"zoom",void 0),w()(this,"center",void 0)}return Yt()(e,[{key:"syncWithMapCamera",value:function(t){var n=t.zoom,i=n===void 0?1:n,s=t.center,c=s===void 0?[0,0]:s,g=t.offsetOrigin,y=g===void 0?[0,0]:g,E=t.cameraPosition,T=E===void 0?[0,0,0]:E,I=t.up,F=I===void 0?[0,1,0]:I,U=t.lookAt,Q=U===void 0?[0,0,0]:U,ue=t.aspect,de=ue===void 0?1:ue,Re=t.near,et=Re===void 0?.1:Re,ht=t.far,xt=ht===void 0?1e3:ht,Gt=t.fov,jt=Gt===void 0?45:Gt;this.zoom=i,this.center=c,k.perspective(this.projectionMatrix,jt/180*Math.PI,de,et,xt);var Qt=V.fromValues.apply(V,Ut()(T)),fr=V.fromValues.apply(V,Ut()(Q)),Gr=V.fromValues.apply(V,Ut()(F));k.lookAt(this.viewMatrix,Qt,fr,Gr),this.viewUncenteredMatrix=k.clone(this.viewMatrix),k.translate(this.viewMatrix,this.viewMatrix,V.fromValues(-y[0],y[1],0)),k.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),k.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var t=Ei()(this.center,2),n=t[0],i=t[1];return[n,i]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,n){var i=85.0511287798,s=Math.max(Math.min(i,t[1]),-i),c=256<<20,g=Math.PI/180,y=t[0]*g,E=s*g;E=Math.log(Math.tan(Math.PI/4+E/2));var T=.5/Math.PI,I=.5,F=-.5/Math.PI;return g=.5,y=c*(T*y+I)-215440491,E=-(c*(F*E+g)-106744817),[y,E]}}]),e}(),b4=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],YS,KS,$S,qS,QS,JS,Rm,eC,tC,rC,nC;function iC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function E4(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?iC(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):iC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function S4(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}S4(`.amap-logo{
 display: none !important;
}
`);var C4=0;window.forceWebGL=!0;var aC="ff533602d57df6f8ab3b0fea226ae52f",w4="2.0",A4="amap-script",w_=!1,jg=[],T4=(YS=Object(Cr.injectable)(),KS=Object(Cr.inject)(sr.IGlobalConfigService),$S=Object(Cr.inject)(sr.MapConfig),qS=Object(Cr.inject)(sr.ICoordinateSystemService),QS=Object(Cr.inject)(sr.IEventEmitter),YS(JS=(Rm=function(){function e(){var r=this;Ft()(this,e),w()(this,"version",Xp["GAODE2.x"]),w()(this,"map",void 0),w()(this,"dragging",!1),w()(this,"sceneCenter",void 0),w()(this,"sceneCenterMKT",void 0),w()(this,"bgColor","rgba(0, 0, 0, 0)"),Di()(this,"configService",eC,this),Di()(this,"config",tC,this),Di()(this,"coordinateSystemService",rC,this),Di()(this,"eventEmitter",nC,this),w()(this,"markerContainer",void 0),w()(this,"$mapContainer",void 0),w()(this,"viewport",void 0),w()(this,"cameraChangedCallback",void 0),w()(this,"handleViewChanged",function(t){var n=r.map.customCoords.getCameraParams(),i=n.fov,s=n.near,c=n.far,g=n.aspect,y=n.position,E=n.lookAt,T=n.up;r.emit("mapchange");var I=t.zoom,F=r.map.customCoords.getCenter();r.cameraChangedCallback&&(r.viewport.syncWithMapCamera({aspect:g,far:c,fov:i,cameraPosition:y,lookAt:E,up:T,near:s,zoom:I-1,center:F,offsetOrigin:[y[0],y[1]]}),r.coordinateSystemService.setCoordinateSystem(zu.P20_2),r.cameraChangedCallback(r.viewport))})}return Yt()(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"setCustomCoordCenter",value:function(t){var n;this.sceneCenter=t,this.sceneCenterMKT=(n=this.map.getProjection()).project.apply(n,Ut()(this.sceneCenter))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMKT}},{key:"lngLatToCoord",value:function(t){var n=this.map.getProjection(),i=n.project;return this.sceneCenter||(this.map.customCoords.setCenter(t),this.setCustomCoordCenter(t)),this._sub(i(t[0],t[1]),this.sceneCenterMKT)}},{key:"lngLatToCoords",value:function(t){var n=this;return t.map(function(i){return typeof i[0]=="number"?n.lngLatToCoord(i):i.map(function(s){return n.lngLatToCoord(s)})})}},{key:"addMarkerContainer",value:function(){if(!!this.map){var t=this.map.getContainer();if(t!==null){var n=t.getElementsByClassName("amap-maps")[0];n.style.zIndex="auto",this.markerContainer=j.create("div","l7-marker-container2",n)}}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,n){mm.indexOf(t)!==-1?this.eventEmitter.on(t,n):this.map.on(t,n)}},{key:"off",value:function(t,n){mm.indexOf(t)!==-1?this.eventEmitter.off(t,n):this.map.off(t,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var t;return(t=this.map.getContainer())===null||t===void 0?void 0:t.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var t=this.map.getSize();return[t.getWidth(),t.getHeight()]}},{key:"getType",value:function(){return"amap2"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(t){return this.map.setZoom(t+1)}},{key:"getCenter",value:function(t){if(t!=null&&t.padding){var n=this.getCenter(),i=this.getSize(),s=Ei()(i,2),c=s[0],g=s[1],y=Fg(t.padding),E=this.lngLatToPixel([n.lng,n.lat]),T=[(y.right-y.left)/2,(y.bottom-y.top)/2],I=this.pixelToLngLat([E.x-T[0],E.y-T[1]]);return I}var F=this.map.getCenter();return{lng:F.getLng(),lat:F.getLat()}}},{key:"setCenter",value:function(t,n){if(n!=null&&n.padding){var i=Fg(n.padding),s=this.lngLatToPixel(t),c=[(i.right-i.left)/2,(i.bottom-i.top)/2],g=this.pixelToLngLat([s.x+c[0],s.y+c[1]]);this.map.setCenter([g.lng,g.lat])}else this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var t=this.map.getBounds(),n=t.getNorthEast(),i=t.getSouthWest(),s=this.getCenter(),c=s.lng>n.getLng()||s.lng<i.getLng()?180-n.getLng():n.getLng(),g=s.lng<i.getLng()?i.getLng()-180:i.getLng();return[[g,i.getLat()],[c,n.getLat()]]}},{key:"getMinZoom",value:function(){var t=this.map.getZooms();return t[0]-1}},{key:"getMaxZoom",value:function(){var t=this.map.getZooms();return t[1]-1}},{key:"setRotation",value:function(t){return this.map.setRotation(t)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(t,n)}},{key:"fitBounds",value:function(t){this.map.setBounds(new AMap.Bounds([t[0][0],t[0][1],t[1][0],t[1][1]]))}},{key:"setZoomAndCenter",value:function(t,n){this.map.setZoomAndCenter(t,n)}},{key:"setMapStyle",value:function(t){this.map.setMapStyle(this.getMapStyle(t))}},{key:"setMapStatus",value:function(t){this.map.setStatus(t)}},{key:"pixelToLngLat",value:function(t){var n=this.map.pixelToLngLat(new AMap.Pixel(t[0],t[1]));return{lng:n.getLng(),lat:n.getLat()}}},{key:"lngLatToPixel",value:function(t){var n=this.map.lnglatToPixel(new AMap.LngLat(t[0],t[1]));return{x:n.getX(),y:n.getY()}}},{key:"containerToLngLat",value:function(t){var n=new AMap.Pixel(t[0],t[1]),i=this.map.containerToLngLat(n);return{lng:i==null?void 0:i.getLng(),lat:i==null?void 0:i.getLat()}}},{key:"lngLatToContainer",value:function(t){var n=new AMap.LngLat(t[0],t[1]),i=this.map.lngLatToContainer(n);return{x:i.getX(),y:i.getY()}}},{key:"lngLatToMercator",value:function(t,n){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},g=this.map.customCoords.lngLatToCoord(t),y=k.create();return k.translate(y,y,V.fromValues(g[0],g[1],n)),k.scale(y,y,V.fromValues(s[0],s[1],s[2])),k.rotateX(y,y,i[0]),k.rotateY(y,y,i[1]),k.rotateZ(y,y,i[2]),y}},{key:"init",value:function(){var r=tu()(Na.a.mark(function n(){var i=this,s,c,g,y,E,T,I,F,U,Q,ue,de,Re,et,ht,xt;return Na.a.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return s=this.config,c=s.id,g=s.style,y=g===void 0?"light":g,E=s.minZoom,T=E===void 0?0:E,I=s.maxZoom,F=I===void 0?18:I,U=s.token,Q=U===void 0?aC:U,ue=s.mapInstance,de=s.plugin,Re=de===void 0?[]:de,et=s.version,ht=et===void 0?w4:et,xt=xp()(s,b4),jt.next=3,new Promise(function(Qt){var fr=function(){if(ue){var Jr;i.map=ue,i.$mapContainer=i.map.getContainer();var Ur=i.map.getCenter();(Jr=i.map.customCoords)===null||Jr===void 0||Jr.setCenter([Ur.lng,Ur.lat]),i.setCustomCoordCenter([Ur.lng,Ur.lat]),setTimeout(function(){i.map.on("viewchange",i.handleViewChanged),Qt()},30)}else{i.$mapContainer=i.creatAmapContainer(c);var Xn=E4({mapStyle:i.getMapStyle(y),zooms:[T,F],viewMode:"3D"},xt);Xn.zoom&&(Xn.zoom+=1);var ni=new AMap.Map(i.$mapContainer,Xn);i.map=ni;var Oi=ni.getCenter();ni.customCoords.setCenter([Oi.lng,Oi.lat]),i.setCustomCoordCenter([Oi.lng,Oi.lat]),ni.on("viewchange",i.handleViewChanged),setTimeout(function(){Qt()},10)}};i.viewport=new x4,!w_&&!ue?(Q===aC&&console.warn(i.configService.getSceneWarninfo("MapToken")),w_=!0,Re.push("Map3D"),rS.a.load({key:Q,version:ht,plugins:Re}).then(function(Gr){fr(),jg.length&&(jg.forEach(function(Jr){return Jr()}),jg=[])}).catch(function(Gr){throw new Error(Gr)})):w_&&window.AMap||ue?fr():jg.push(fr)});case 3:this.map.on("dragstart",function(){return i.dragging=!0,""}),this.map.on("dragend",function(){return i.dragging=!1,""});case 5:case"end":return jt.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"meterToCoord",value:function(t,n){var i=AMap.GeometryUtil.distance(Dg()(AMap.LngLat,Ut()(t)),Dg()(AMap.LngLat,Ut()(n))),s=this.lngLatToCoord(t),c=Ei()(s,2),g=c[0],y=c[1],E=this.lngLatToCoord(n),T=Ei()(E,2),I=T[0],F=T[1],U=Math.sqrt(Math.pow(g-I,2)+Math.pow(y-F,2));return U/i}},{key:"exportMap",value:function(t){var n,i=(n=this.getContainer())===null||n===void 0?void 0:n.getElementsByClassName("amap-layer")[0],s=t==="jpg"?i==null?void 0:i.toDataURL("image/jpeg"):i==null?void 0:i.toDataURL("image/png");return s}},{key:"emit",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).emit.apply(n,[t].concat(s))}},{key:"once",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).once.apply(n,[t].concat(s))}},{key:"destroy",value:function(){var t,n;this.map.destroy(),(t=this.$mapContainer)===null||t===void 0||(n=t.parentNode)===null||n===void 0||n.removeChild(this.$mapContainer),delete window.initAMap;var i=document.getElementById(A4);i&&document.head.removeChild(i)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"initViewPort",value:function(){var t,n=(t=this.map.customCoords)===null||t===void 0?void 0:t.getCameraParams(),i=n.fov,s=n.near,c=n.far,g=n.aspect,y=n.position,E=n.lookAt,T=n.up;this.emit("mapchange");var I=this.map.customCoords.getCenter(),F=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:g,far:c,fov:i,cameraPosition:y,lookAt:E,near:s,up:T,zoom:F-1,center:I,offsetOrigin:[y[0],y[1]]}),this.coordinateSystemService.setCoordinateSystem(zu.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(t,n){var i=[0,0];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i}},{key:"getMapStyle",value:function(t){return XS[t]?XS[t]:t}},{key:"creatAmapContainer",value:function(t){var n=t;typeof t=="string"&&(n=document.getElementById(t));var i=document.createElement("div");return i.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,i.id="l7_amap_div"+C4++,n.appendChild(i),i}}]),e}(),eC=Vi()(Rm.prototype,"configService",[KS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tC=Vi()(Rm.prototype,"config",[$S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rC=Vi()(Rm.prototype,"coordinateSystemService",[qS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nC=Vi()(Rm.prototype,"eventEmitter",[QS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rm))||JS);function M4(e){var r=P4();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function P4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var O4=function(e){qr()(t,e);var r=M4(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getServiceConstructor",value:function(){return T4}}]),t}(kg);function oC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function sC(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?oC(Object(t),!0).forEach(function(n){I4(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):oC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function I4(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function R4(e,r){return F4(e)||D4(e,r)||k4(e,r)||L4()}function L4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k4(e,r){if(!!e){if(typeof e=="string")return uC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return uC(e,r)}}function uC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function D4(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,g;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(y){s=!0,g=y}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw g}}return n}}function F4(e){if(Array.isArray(e))return e}var B4=pe.a.memo(function(e){var r=e.style,t=e.className,n=e.map,i=e.option,s=e.onSceneLoaded,c=e.children,g=Object(te.useRef)(null),y=Object(te.useState)(),E=R4(y,2),T=E[0],I=E[1];return Object(te.useEffect)(function(){var F=new e0(sC(sC({id:g.current},i),{},{map:new O4(n)}));return F.on("loaded",function(){I(F),s&&s(F)}),function(){F.destroy()}},[]),Object(te.useEffect)(function(){T&&n.style&&T.setMapStyle(n.style)},[JSON.stringify(n.style)]),Object(te.useEffect)(function(){T&&n.zoom&&T.setZoom(n.zoom)},[n.zoom]),Object(te.useEffect)(function(){T&&n.center&&T.setCenter(n.center)},[JSON.stringify(n.center)]),Object(te.useEffect)(function(){T&&n.pitch&&T.setPitch(n.pitch)},[n.pitch]),Object(te.useEffect)(function(){T&&n.rotation&&T.setRotation(n.rotation)},[n.rotation]),pe.a.createElement(Oe.Provider,{value:T},pe.a.createElement("div",{ref:g,className:t,style:r},T&&c))}),B6=B4,N4=M("zvhG"),z4=M.n(N4);function U4(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=j4(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function j4(e,r){if(!!e){if(typeof e=="string")return lC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return lC(e,r)}}function lC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var A_;function T_(e,r,t){var n=t-r,i=((e-r)%n+n)%n+r;return i===r?t:i}function Ed(e,r,t){return Math.min(t,Math.max(r,e))}function Xh(e,r,t){return e*(1-t)+r*t}function M_(e,r,t,n){var i=new z4.a(e,r,t,n);return function(s){return i.solve(s)}}var P_=M_(.25,.1,.25,1);function cC(){return $i||!di.matchMedia?!1:(A_==null&&(A_=di.matchMedia("(prefers-reduced-motion: reduce)")),A_.matches)}function V4(e,r){var t={},n=U4(r),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;s in e&&(t[s]=e[s])}}catch(c){n.e(c)}finally{n.f()}return t}var ov=$i?Date.now.bind(Date):di.performance&&di.performance.now?di.performance.now.bind(di.performance):Date.now.bind(Date),G4=di.requestAnimationFrame||di.mozRequestAnimationFrame||di.webkitRequestAnimationFrame||di.msRequestAnimationFrame,H4=di.cancelAnimationFrame||di.mozCancelAnimationFrame||di.webkitCancelAnimationFrame||di.msCancelAnimationFrame;function Vg(e){var r=G4(e);return{cancel:function(){return H4(r)}}}var fC=63710088e-1,ru=function(){function e(r,t){if(Ft()(this,e),w()(this,"lng",void 0),w()(this,"lat",void 0),isNaN(r)||isNaN(t))throw new Error("Invalid LngLat object: (".concat(r,", ").concat(t,")"));if(this.lng=+r,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return Yt()(e,[{key:"wrap",value:function(){return new e(T_(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(t){var n=Math.PI/180,i=this.lat*n,s=t.lat*n,c=Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos((t.lng-this.lng)*n),g=fC*Math.acos(Math.min(c,1));return g}}],[{key:"convert",value:function(t){if(t instanceof e)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new e(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&Eo()(t)==="object"&&t!==null){var n="lng"in t?t.lng:t.lon;return new e(Number(n),Number(t.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]),e}(),g0=function(){function e(r,t){Ft()(this,e),w()(this,"ne",void 0),w()(this,"sw",void 0),r&&(t?this.setSouthWest(r).setNorthEast(t):r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}return Yt()(e,[{key:"setNorthEast",value:function(t){return this.ne=t instanceof ru?new ru(t.lng,t.lat):ru.convert(t),this}},{key:"setSouthWest",value:function(t){return this.sw=t instanceof ru?new ru(t.lng,t.lat):ru.convert(t),this}},{key:"extend",value:function(t){var n=this.sw,i=this.ne,s,c;if(t instanceof ru)s=t,c=t;else if(t instanceof e){if(s=t.sw,c=t.ne,!s||!c)return this}else{if(Array.isArray(t))if(t.length===4||t.every(Array.isArray)){var g=t;return this.extend(e.convert(g))}else{var y=t;return this.extend(ru.convert(y))}return this}return!n&&!i?(this.sw=new ru(s.lng,s.lat),this.ne=new ru(c.lng,c.lat)):(n.lng=Math.min(s.lng,n.lng),n.lat=Math.min(s.lat,n.lat),i.lng=Math.max(c.lng,i.lng),i.lat=Math.max(c.lat,i.lat)),this}},{key:"getCenter",value:function(){return new ru((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new ru(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new ru(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(t){var n=ru.convert(t),i=n.lng,s=n.lat,c=this.sw.lat<=s&&s<=this.ne.lat,g=this.sw.lng<=i&&i<=this.ne.lng;return this.sw.lng>this.ne.lng&&(g=this.sw.lng>=i&&i>=this.ne.lng),c&&g}}],[{key:"convert",value:function(t){return t instanceof e?t:new e(t)}}]),e}(),Co=function(){function e(r,t){Ft()(this,e),w()(this,"x",void 0),w()(this,"y",void 0),this.x=r,this.y=t}return Yt()(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"_add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"add",value:function(t){return this.clone()._add(t)}},{key:"_sub",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"sub",value:function(t){return this.clone()._sub(t)}},{key:"_multByPoint",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"multByPoint",value:function(t){return this.clone()._multByPoint(t)}},{key:"_divByPoint",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"divByPoint",value:function(t){return this.clone()._divByPoint(t)}},{key:"_mult",value:function(t){return this.x*=t,this.y*=t,this}},{key:"mult",value:function(t){return this.clone()._mult(t)}},{key:"_div",value:function(t){return this.x/=t,this.y/=t,this}},{key:"div",value:function(t){return this.clone()._div(t)}},{key:"_rotate",value:function(t){var n=Math.cos(t),i=Math.sin(t),s=n*this.x-i*this.y,c=i*this.x+n*this.y;return this.x=s,this.y=c,this}},{key:"rotate",value:function(t){return this.clone()._rotate(t)}},{key:"_rotateAround",value:function(t,n){var i=Math.cos(t),s=Math.sin(t),c=n.x+i*(this.x-n.x)-s*(this.y-n.y),g=n.y+s*(this.x-n.x)+i*(this.y-n.y);return this.x=c,this.y=g,this}},{key:"roateAround",value:function(t,n){return this.clone()._rotateAround(t,n)}},{key:"_matMult",value:function(t){var n=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=n,this.y=i,this}},{key:"matMult",value:function(t){return this.clone()._matMult(t)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var t=this.y;return this.y=this.x,this.x=-t,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"dist",value:function(t){return Math.sqrt(this.distSqr(t))}},{key:"distSqr",value:function(t){var n=t.x-this.x,i=t.y-this.y;return n*n+i*i}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(t){return Math.atan2(this.y-t.y,this.x-t.x)}},{key:"angleWith",value:function(t){return this.angleWithSep(t.x,t.y)}},{key:"angleWithSep",value:function(t,n){return Math.atan2(this.x*n-this.y*t,this.x*t+this.y*n)}}],[{key:"convert",value:function(t){return t instanceof e?t:Array.isArray(t)?new e(t[0],t[1]):t}}]),e}(),W4=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(Ft()(this,e),w()(this,"top",void 0),w()(this,"bottom",void 0),w()(this,"left",void 0),w()(this,"right",void 0),isNaN(r)||r<0||isNaN(t)||t<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=t,this.left=n,this.right=i}return Yt()(e,[{key:"interpolate",value:function(t,n,i){return n.top!=null&&t.top!=null&&(this.top=Xh(t.top,n.top,i)),n.bottom!=null&&t.bottom!=null&&(this.bottom=Xh(t.bottom,n.bottom,i)),n.left!=null&&t.left!=null&&(this.left=Xh(t.left,n.left,i)),n.right!=null&&t.right!=null&&(this.right=Xh(t.right,n.right,i)),this}},{key:"getCenter",value:function(t,n){var i=Ed((this.left+t-this.right)/2,0,t),s=Ed((this.top+n-this.bottom)/2,0,n);return new Co(i,s)}},{key:"equals",value:function(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}},{key:"clone",value:function(){return new e(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),e}(),hC=2*Math.PI*fC;function pC(e){return hC*Math.cos(e*Math.PI/180)}function Gg(e){return(180+e)/360}function Hg(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function dC(e,r){return e/pC(r)}function Z4(e){return e*360-180}function O_(e){var r=180-e*360;return 360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90}function X4(e,r){return e*pC(O_(r))}function Y4(e){return 1/Math.cos(e*Math.PI/180)}var Wg=function(){function e(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;Ft()(this,e),w()(this,"x",void 0),w()(this,"y",void 0),w()(this,"z",void 0),this.x=+r,this.y=+t,this.z=+n}return Yt()(e,[{key:"toLngLat",value:function(){return new ru(Z4(this.x),O_(this.y))}},{key:"toAltitude",value:function(){return X4(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/hC*Y4(O_(this.y))}}],[{key:"fromLngLat",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=ru.convert(t);return new e(Gg(i.lng),Hg(i.lat),dC(n,i.lat))}}]),e}();function K4(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=$4(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function $4(e,r){if(!!e){if(typeof e=="string")return vC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return vC(e,r)}}function vC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var N6=8192,q4=function(){function e(r,t,n,i,s){Ft()(this,e),w()(this,"tileSize",void 0),w()(this,"tileZoom",void 0),w()(this,"lngRange",void 0),w()(this,"latRange",void 0),w()(this,"maxValidLatitude",void 0),w()(this,"scale",void 0),w()(this,"width",void 0),w()(this,"height",void 0),w()(this,"angle",void 0),w()(this,"rotationMatrix",void 0),w()(this,"pixelsToGLUnits",void 0),w()(this,"cameraToCenterDistance",void 0),w()(this,"mercatorMatrix",void 0),w()(this,"projMatrix",void 0),w()(this,"invProjMatrix",void 0),w()(this,"alignedProjMatrix",void 0),w()(this,"pixelMatrix",void 0),w()(this,"pixelMatrixInverse",void 0),w()(this,"glCoordMatrix",void 0),w()(this,"labelPlaneMatrix",void 0),w()(this,"_fov",void 0),w()(this,"_pitch",void 0),w()(this,"_zoom",void 0),w()(this,"_renderWorldCopies",void 0),w()(this,"_minZoom",void 0),w()(this,"_maxZoom",void 0),w()(this,"_minPitch",void 0),w()(this,"_maxPitch",void 0),w()(this,"_center",void 0),w()(this,"zoomFraction",void 0),w()(this,"unmodified",void 0),w()(this,"edgeInsets",void 0),w()(this,"constraining",void 0),w()(this,"posMatrixCache",void 0),w()(this,"alignedPosMatrixCache",void 0),this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=s===void 0?!0:s,this._minZoom=r||0,this._maxZoom=t||22,this._minPitch=n==null?0:n,this._maxPitch=i==null?60:i,this.setMaxBounds(),this.width=0,this.height=0,this._center=new ru(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new W4,this.posMatrixCache={},this.alignedPosMatrixCache={}}return Yt()(e,[{key:"minZoom",get:function(){return this._minZoom},set:function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}},{key:"minPitch",get:function(){return this._minPitch},set:function(t){this._minPitch!==t&&(this._minPitch=t,this._pitch=Math.max(this._pitch,t))}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(t){this._maxPitch!==t&&(this._maxPitch=t,this._pitch=Math.min(this._pitch,t))}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new Co(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(t){var n=-T_(t,-180,180)*Math.PI/180;this.angle!==n&&(this.unmodified=!1,this.angle=n,this.calcMatrices(),this.rotationMatrix=Y.create(),Y.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(t){var n=Ed(t,this._minPitch,this._maxPitch)/180*Math.PI;this._pitch!==n&&(this.unmodified=!1,this._pitch=n,this.calcMatrices())}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this.unmodified=!1,this._fov=t/180*Math.PI,this.calcMatrices())}},{key:"zoom",get:function(){return this._zoom},set:function(t){var n=Math.min(Math.max(t,this._minZoom),this._maxZoom);this._zoom!==n&&(this.unmodified=!1,this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom,this.constrain(),this.calcMatrices())}},{key:"center",get:function(){return this._center},set:function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this.unmodified=!1,this._center=t,this.constrain(),this.calcMatrices())}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(t){this.edgeInsets.equals(t)||(this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,t,1),this.calcMatrices())}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}},{key:"clone",value:function(){var t=new e(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t.center=this._center,t.zoom=this.zoom,t.angle=this.angle,t.fov=this._fov,t.pitch=this._pitch,t.unmodified=this.unmodified,t.edgeInsets=this.edgeInsets.clone(),t.calcMatrices(),t}},{key:"isPaddingEqual",value:function(t){return this.edgeInsets.equals(t)}},{key:"interpolatePadding",value:function(t,n,i){this.unmodified=!1,this.edgeInsets.interpolate(t,n,i),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(t){var n=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,n)}},{key:"resize",value:function(t,n){this.width=t,this.height=n,this.pixelsToGLUnits=[2/t,-2/n],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(t){return Math.pow(2,t)}},{key:"scaleZoom",value:function(t){return Math.log(t)/Math.LN2}},{key:"project",value:function(t){var n=Ed(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new Co(Gg(t.lng)*this.worldSize,Hg(n)*this.worldSize)}},{key:"unproject",value:function(t){return new Wg(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(t,n){var i=this.pointCoordinate(n),s=this.pointCoordinate(this.centerPoint),c=this.locationCoordinate(t),g=new Wg(c.x-(i.x-s.x),c.y-(i.y-s.y));this.center=this.coordinateLocation(g),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(t){var n=0,i=new Float64Array([t.x,t.y,0,1]),s=new Float64Array([t.x,t.y,1,1]);H.transformMat4(i,i,this.pixelMatrixInverse),H.transformMat4(s,s,this.pixelMatrixInverse);var c=i[3],g=s[3],y=i[0]/c,E=s[0]/g,T=i[1]/c,I=s[1]/g,F=i[2]/c,U=s[2]/g,Q=F===U?0:(n-F)/(U-F);return new Wg(Xh(y,E,Q)/this.worldSize,Xh(T,I,Q)/this.worldSize)}},{key:"getBounds",value:function(){return new g0().extend(this.pointLocation(new Co(0,0))).extend(this.pointLocation(new Co(this.width,0))).extend(this.pointLocation(new Co(this.width,this.height))).extend(this.pointLocation(new Co(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new g0([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new Co(0,0)),n=new Float32Array([t.x*this.worldSize,t.y*this.worldSize,0,1]),i=H.transformMat4(n,n,this.pixelMatrix);return i[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var t=this._pitch,n=Math.tan(t)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Co(0,n))}},{key:"getCameraQueryGeometry",value:function(t){var n=this.getCameraPoint();if(t.length===1)return[t[0],n];var i=n.x,s=n.y,c=n.x,g=n.y,y=K4(t),E;try{for(y.s();!(E=y.n()).done;){var T=E.value;i=Math.min(i,T.x),s=Math.min(s,T.y),c=Math.max(c,T.x),g=Math.max(g,T.y)}}catch(I){y.e(I)}finally{y.f()}return[new Co(i,s),new Co(c,s),new Co(c,g),new Co(i,g),new Co(i,s)]}},{key:"coordinatePoint",value:function(t){var n=H.fromValues(t.x*this.worldSize,t.y*this.worldSize,0,1);return H.transformMat4(n,n,this.pixelMatrix),new Co(n[0]/n[3],n[1]/n[3])}},{key:"locationPoint",value:function(t){return this.coordinatePoint(this.locationCoordinate(t))}},{key:"pointLocation",value:function(t){return this.coordinateLocation(this.pointCoordinate(t))}},{key:"locationCoordinate",value:function(t){return Wg.fromLngLat(t)}},{key:"coordinateLocation",value:function(t){return t.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!(!this.center||!this.width||!this.height||this.constraining)){this.constraining=!0;var t=-90,n=90,i=-180,s=180,c,g,y,E,T=this.size,I=this.unmodified;if(this.latRange){var F=this.latRange;t=Hg(F[1])*this.worldSize,n=Hg(F[0])*this.worldSize,c=n-t<T.y?T.y/(n-t):0}if(this.lngRange){var U=this.lngRange;i=Gg(U[0])*this.worldSize,s=Gg(U[1])*this.worldSize,g=s-i<T.x?T.x/(s-i):0}var Q=this.point,ue=Math.max(g||0,c||0);if(ue){this.center=this.unproject(new Co(g?(s+i)/2:Q.x,c?(n+t)/2:Q.y)),$i?this.zoom=Math.max(this.zoom,Math.max(-1,this.minZoom)):this.zoom+=this.scaleZoom(ue),this.unmodified=I,this.constraining=!1;return}if(this.latRange){var de=Q.y,Re=T.y/2;de-Re<t&&(E=t+Re),de+Re>n&&(E=n-Re)}if(this.lngRange){var et=Q.x,ht=T.x/2;et-ht<i&&(y=i+ht),et+ht>s&&(y=s-ht)}(y!==void 0||E!==void 0)&&(this.center=this.unproject(new Co(y!==void 0?y:Q.x,E!==void 0?E:Q.y))),this.unmodified=I,this.constraining=!1}}},{key:"calcMatrices",value:function(){if(!!this.height){var t=this._fov/2,n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(t)*this.height;var i=Math.PI/2+this._pitch,s=this._fov*(.5+n.y/this.height),c=Math.sin(s)*this.cameraToCenterDistance/Math.sin(Ed(Math.PI-i-s,.01,Math.PI-.01)),g=this.point,y=g.x,E=g.y,T=Math.cos(Math.PI/2-this._pitch)*c+this.cameraToCenterDistance,I=T*1.01,F=this.height/50,U=new Float64Array(16);k.perspective(U,this._fov,this.width/this.height,F,I),U[8]=-n.x*2/this.width,U[9]=n.y*2/this.height,k.scale(U,U,[1,-1,1]),k.translate(U,U,[0,0,-this.cameraToCenterDistance]),k.rotateX(U,U,this._pitch),k.rotateZ(U,U,this.angle),k.translate(U,U,[-y,-E,0]),this.mercatorMatrix=k.scale([],U,[this.worldSize,this.worldSize,this.worldSize]),k.scale(U,U,[1,1,dC(1,this.center.lat)*this.worldSize,1]),this.projMatrix=U,this.invProjMatrix=k.invert([],this.projMatrix);var Q=this.width%2/2,ue=this.height%2/2,de=Math.cos(this.angle),Re=Math.sin(this.angle),et=y-Math.round(y)+de*Q+Re*ue,ht=E-Math.round(E)+de*ue+Re*Q,xt=new Float64Array(U);if(k.translate(xt,xt,[et>.5?et-1:et,ht>.5?ht-1:ht,0]),this.alignedProjMatrix=xt,U=k.create(),k.scale(U,U,[this.width/2,-this.height/2,1]),k.translate(U,U,[1,-1,0]),this.labelPlaneMatrix=U,U=k.create(),k.scale(U,U,[1,-1,1]),k.translate(U,U,[-1,-1,0]),k.scale(U,U,[2/this.width,2/this.height,1]),this.glCoordMatrix=U,this.pixelMatrix=k.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),U=k.invert(new Float64Array(16),this.pixelMatrix),!U)throw new Error("failed to invert matrix");this.pixelMatrixInverse=U,this.posMatrixCache={},this.alignedPosMatrixCache={}}}}]),e}(),us=Yt()(function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ft()(this,e),w()(this,"type",void 0),gs()(this,t),this.type=r});function Q4(e){var r=J4();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function J4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var mC=function(e){qr()(t,e);var r=Q4(t);function t(n){var i;Ft()(this,t),i=r.call(this),w()(ce()(i),"transform",void 0),w()(ce()(i),"options",void 0),w()(ce()(i),"moving",void 0),w()(ce()(i),"zooming",void 0),w()(ce()(i),"rotating",void 0),w()(ce()(i),"pitching",void 0),w()(ce()(i),"padding",void 0),w()(ce()(i),"bearingSnap",void 0),w()(ce()(i),"easeEndTimeoutID",void 0),w()(ce()(i),"easeStart",void 0),w()(ce()(i),"easeOptions",void 0),w()(ce()(i),"easeId",void 0),w()(ce()(i),"onEaseFrame",void 0),w()(ce()(i),"onEaseEnd",void 0),w()(ce()(i),"easeFrameId",void 0),w()(ce()(i),"renderFrameCallback",function(){var T=Math.min((ov()-i.easeStart)/i.easeOptions.duration,1);i.onEaseFrame(i.easeOptions.easing(T)),T<1?i.easeFrameId=i.requestRenderFrame(i.renderFrameCallback):i.stop()}),i.options=n;var s=n.minZoom,c=n.maxZoom,g=n.minPitch,y=n.maxPitch,E=n.renderWorldCopies;return i.moving=!1,i.zooming=!1,i.bearingSnap=n.bearingSnap,i.transform=new q4(s,c,g,y,E),i}return Yt()(t,[{key:"requestRenderFrame",value:function(i){return 0}},{key:"cancelRenderFrame",value:function(i){}},{key:"getCenter",value:function(){var i=this.transform.center,s=i.lng,c=i.lat;return new ru(s,c)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(i,s){return this.jumpTo({center:i},s)}},{key:"setPitch",value:function(i,s){return this.jumpTo({pitch:i},s),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(i,s,c){return this.easeTo(gs()({center:i},s),c)}},{key:"zoomOut",value:function(i,s){return this.zoomTo(this.getZoom()-1,i,s),this}},{key:"setBearing",value:function(i,s){return this.jumpTo({bearing:i},s),this}},{key:"setZoom",value:function(i,s){return this.jumpTo({zoom:i},s),this}},{key:"zoomIn",value:function(i,s){return this.zoomTo(this.getZoom()+1,i,s),this}},{key:"zoomTo",value:function(i,s,c){return this.easeTo(gs()({zoom:i},s),c)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(i,s){return this.jumpTo({padding:i},s),this}},{key:"rotateTo",value:function(i,s,c){return this.easeTo(gs()({bearing:i},s),c)}},{key:"resetNorth",value:function(i,s){return this.rotateTo(0,gs()({duration:1e3},i),s),this}},{key:"resetNorthPitch",value:function(i,s){return this.easeTo(gs()({bearing:0,pitch:0,duration:1e3},i),s),this}},{key:"fitBounds",value:function(i,s,c){return this.fitInternal(this.cameraForBounds(i,s),s,c)}},{key:"cameraForBounds",value:function(i,s){return i=g0.convert(i),this.cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),0,s)}},{key:"snapToNorth",value:function(i,s){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(i,s):this}},{key:"jumpTo",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;this.stop();var c=this.transform,g=!1,y=!1,E=!1;return i.zoom&&c.zoom!==+i.zoom&&(g=!0,c.zoom=+i.zoom),i.center!==void 0&&(c.center=ru.convert(i.center)),i.bearing&&c.bearing!==+i.bearing&&(y=!0,c.bearing=+i.bearing),i.pitch&&c.pitch!==+i.pitch&&(E=!0,c.pitch=+i.pitch),i.padding!=null&&!c.isPaddingEqual(i.padding)&&(c.padding=i.padding),this.emit("movestart",new us("movestart",s)),this.emit("move",new us("move",s)),g&&(this.emit("zoomstart",new us("zoomstart",s)),this.emit("zoom",new us("zoom",s)),this.emit("zoomend",new us("zoomend",s))),y&&(this.emit("rotatestart",new us("rotatestart",s)),this.emit("rotate",new us("rotate",s)),this.emit("rotateend",new us("rotateend",s))),E&&(this.emit("pitchstart",new us("pitchstart",s)),this.emit("pitch",new us("pitch",s)),this.emit("pitchend",new us("pitchend",s))),this.emit("moveend",new us("moveend",s))}},{key:"easeTo",value:function(){var i=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;s=gs()({offset:[0,0],duration:500,easing:P_},s),(s.animate===!1||!s.essential&&cC())&&(s.duration=0);var g=this.transform,y=this.getZoom(),E=this.getBearing(),T=this.getPitch(),I=this.getPadding(),F=s.zoom?+s.zoom:y,U=s.bearing?this.normalizeBearing(s.bearing,E):E,Q=s.pitch?+s.pitch:T,ue=s.padding?s.padding:g.padding,de=Co.convert(s.offset),Re=g.centerPoint.add(de),et=g.pointLocation(Re),ht=ru.convert(s.center||et);this.normalizeCenter(ht);var xt=g.project(et),Gt=g.project(ht).sub(xt),jt=g.zoomScale(F-y),Qt,fr;s.around&&(Qt=ru.convert(s.around),fr=g.locationPoint(Qt));var Gr={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||F!==y,this.rotating=this.rotating||E!==U,this.pitching=this.pitching||Q!==T,this.padding=!g.isPaddingEqual(ue),this.easeId=s.easeId,this.prepareEase(c,s.noMoveStart,Gr),clearTimeout(this.easeEndTimeoutID),this.ease(function(Jr){if(i.zooming&&(g.zoom=Xh(y,F,Jr)),i.rotating&&(g.bearing=Xh(E,U,Jr)),i.pitching&&(g.pitch=Xh(T,Q,Jr)),i.padding&&(g.interpolatePadding(I,ue,Jr),Re=g.centerPoint.add(de)),Qt)g.setLocationAtPoint(Qt,fr);else{var Ur=g.zoomScale(g.zoom-y),Xn=F>y?Math.min(2,jt):Math.max(.5,jt),ni=Math.pow(Xn,1-Jr),Oi=g.unproject(xt.add(Gt.mult(Jr*ni)).mult(Ur));g.setLocationAtPoint(g.renderWorldCopies?Oi.wrap():Oi,Re)}i.fireMoveEvents(c)},function(Jr){i.afterEase(c,Jr)},s),this}},{key:"flyTo",value:function(){var i=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;if(!s.essential&&cC()){var g=V4(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(g,c)}this.stop(),s=gs()({offset:[0,0],speed:1.2,curve:1.42,easing:P_},s);var y=this.transform,E=this.getZoom(),T=this.getBearing(),I=this.getPitch(),F=this.getPadding(),U=s.zoom?Ed(+s.zoom,y.minZoom,y.maxZoom):E,Q=s.bearing?this.normalizeBearing(s.bearing,T):T,ue=s.pitch?+s.pitch:I,de="padding"in s?s.padding:y.padding,Re=y.zoomScale(U-E),et=Co.convert(s.offset),ht=y.centerPoint.add(et),xt=y.pointLocation(ht),Gt=ru.convert(s.center||xt);this.normalizeCenter(Gt);var jt=y.project(xt),Qt=y.project(Gt).sub(jt),fr=s.curve,Gr=Math.max(y.width,y.height),Jr=Gr/Re,Ur=Qt.mag();if("minZoom"in s){var Xn=Ed(Math.min(s.minZoom,E,U),y.minZoom,y.maxZoom),ni=Gr/y.zoomScale(Xn-E);fr=Math.sqrt(ni/Ur*2)}var Oi=fr*fr;function No(ju){var Yf=(Jr*Jr-Gr*Gr+(ju?-1:1)*Oi*Oi*Ur*Ur)/(2*(ju?Jr:Gr)*Oi*Ur);return Math.log(Math.sqrt(Yf*Yf+1)-Yf)}function zs(ju){return(Math.exp(ju)-Math.exp(-ju))/2}function ll(ju){return(Math.exp(ju)+Math.exp(-ju))/2}function Fc(ju){return zs(ju)/ll(ju)}var el=No(0),Cd=function(Yf){return ll(el)/ll(el+fr*Yf)},py=function(Yf){return Gr*((ll(el)*Fc(el+fr*Yf)-zs(el))/Oi)/Ur},Nm=(No(1)-el)/fr;if(Math.abs(Ur)<1e-6||!isFinite(Nm)){if(Math.abs(Gr-Jr)<1e-6)return this.easeTo(s,c);var H_=Jr<Gr?-1:1;Nm=Math.abs(Math.log(Jr/Gr))/fr,py=function(){return 0},Cd=function(Yf){return Math.exp(H_*fr*Yf)}}if("duration"in s)s.duration=+s.duration;else{var W_="screenSpeed"in s?+s.screenSpeed/fr:+s.speed;s.duration=1e3*Nm/W_}return s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this.zooming=!0,this.rotating=T!==Q,this.pitching=ue!==I,this.padding=!y.isPaddingEqual(de),this.prepareEase(c,!1),this.ease(function(ju){var Yf=ju*Nm,dy=1/Cd(Yf);y.zoom=ju===1?U:E+y.scaleZoom(dy),i.rotating&&(y.bearing=Xh(T,Q,ju)),i.pitching&&(y.pitch=Xh(I,ue,ju)),i.padding&&(y.interpolatePadding(F,de,ju),ht=y.centerPoint.add(et));var vy=ju===1?Gt:y.unproject(jt.add(Qt.mult(py(Yf))).mult(dy));y.setLocationAtPoint(y.renderWorldCopies?vy.wrap():vy,ht),i.fireMoveEvents(c)},function(){return i.afterEase(c)},s),this}},{key:"fitScreenCoordinates",value:function(i,s,c,g,y){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(Co.convert(i)),this.transform.pointLocation(Co.convert(s)),c,g),g,y)}},{key:"stop",value:function(i,s){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var c=this.onEaseEnd;delete this.onEaseEnd,c.call(this,s)}return this}},{key:"normalizeBearing",value:function(i,s){i=T_(i,-180,180);var c=Math.abs(i-s);return Math.abs(i-360-s)<c&&(i-=360),Math.abs(i+360-s)<c&&(i+=360),i}},{key:"normalizeCenter",value:function(i){var s=this.transform;if(!(!s.renderWorldCopies||s.lngRange)){var c=i.lng-s.center.lng;i.lng+=c>180?-360:c<-180?360:0}}},{key:"fireMoveEvents",value:function(i){this.emit("move",new us("move",i)),this.zooming&&this.emit("zoom",new us("zoom",i)),this.rotating&&this.emit("rotate",new us("rotate",i)),this.pitching&&this.emit("rotate",new us("pitch",i))}},{key:"prepareEase",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!s&&!c.moving&&this.emit("movestart",new us("movestart",i)),this.zooming&&!c.zooming&&this.emit("zoomstart",new us("zoomstart",i)),this.rotating&&!c.rotating&&this.emit("rotatestart",new us("rotatestart",i)),this.pitching&&!c.pitching&&this.emit("pitchstart",new us("pitchstart",i))}},{key:"afterEase",value:function(i,s){if(!(this.easeId&&s&&this.easeId===s)){delete this.easeId;var c=this.zooming,g=this.rotating,y=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,c&&this.emit("zoomend",new us("zoomend",i)),g&&this.emit("rotateend",new us("rotateend",i)),y&&this.emit("pitchend",new us("pitchend",i)),this.emit("moveend",new us("moveend",i))}}},{key:"ease",value:function(i,s,c){c.animate===!1||c.duration===0?(i(1),s()):(this.easeStart=ov(),this.easeOptions=c,this.onEaseFrame=i,this.onEaseEnd=s,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(i,s,c,g){var y={top:0,bottom:0,right:0,left:0};if(g=gs()({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},g),typeof g.padding=="number"){var E=g.padding;g.padding={top:E,bottom:E,right:E,left:E}}g.padding=gs()(y,g.padding);var T=this.transform,I=T.padding,F=T.project(ru.convert(i)),U=T.project(ru.convert(s)),Q=F.rotate(-c*Math.PI/180),ue=U.rotate(-c*Math.PI/180),de=new Co(Math.max(Q.x,ue.x),Math.max(Q.y,ue.y)),Re=new Co(Math.min(Q.x,ue.x),Math.min(Q.y,ue.y)),et=de.sub(Re),ht=(T.width-(I.left+I.right+g.padding.left+g.padding.right))/et.x,xt=(T.height-(I.top+I.bottom+g.padding.top+g.padding.bottom))/et.y;if(!(xt<0||ht<0)){var Gt=Math.min(T.scaleZoom(T.scale*Math.min(ht,xt)),g.maxZoom),jt=Co.convert(g.offset),Qt=(g.padding.left-g.padding.right)/2,fr=(g.padding.top-g.padding.bottom)/2,Gr=new Co(jt.x+Qt,jt.y+fr),Jr=Gr.mult(T.scale/T.zoomScale(Gt)),Ur=T.unproject(F.add(U).div(2).sub(Jr));return{center:Ur,zoom:Gt,bearing:c}}}},{key:"fitInternal",value:function(i,s,c){return i?(s=gs()(i,s),delete s.padding,s.linear?this.easeTo(s,c):this.flyTo(s,c)):this}}]),t}(Lu.EventEmitter);function I_(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=eL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function eL(e,r){if(!!e){if(typeof e=="string")return gC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return gC(e,r)}}function gC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Sh={},Dc=Sh;Sh.create=function(e,r,t){var n=di.document.createElement(e);return r!==void 0&&(n.className=r),t&&t.appendChild(n),n},Sh.createNS=function(e,r){var t=di.document.createElementNS(e,r);return t};var Yv=di.document&&di.document.documentElement.style;function yC(e){if(!Yv)return e[0];var r=I_(e),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n in Yv)return n}}catch(i){r.e(i)}finally{r.f()}return e[0]}var y0=yC(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),_C;Sh.disableDrag=function(){Yv&&y0&&(_C=Yv[y0],Yv[y0]="none")},Sh.enableDrag=function(){Yv&&y0&&(Yv[y0]=_C)};var tL=yC(["transform","WebkitTransform"]);Sh.setTransform=function(e,r){e.style[tL]=r};var Zg=!1;try{var Xg=Object.defineProperty({},"passive",{get:function(){Zg=!0}});di.addEventListener("test",Xg,Xg),di.removeEventListener("test",Xg,Xg)}catch(e){Zg=!1}Sh.addEventListener=function(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in n&&Zg?e.addEventListener(r,t,n):e.addEventListener(r,t,n.capture)},Sh.removeEventListener=function(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in n&&Zg?e.removeEventListener(r,t,n):e.removeEventListener(r,t,n.capture)};var xC=function e(r){r.preventDefault(),r.stopPropagation(),di.removeEventListener("click",e,!0)};Sh.suppressClick=function(){$i||(di.addEventListener("click",xC,!0),setTimeout(function(){di.removeEventListener("click",xC,!0)},0))},Sh.mousePos=function(e,r){if($i)return new Co(r.clientX-e.left-0,r.clientY-e.top-0);var t=e.getBoundingClientRect();return new Co(r.clientX-t.left-e.clientLeft,r.clientY-t.top-e.clientTop)},Sh.touchPos=function(e,r){if($i){var g=[],y=I_(r),E;try{for(y.s();!(E=y.n()).done;){var T=E.value;g.push(new Co(T.clientX-e.left,T.clientY-e.top))}}catch(I){y.e(I)}finally{y.f()}return g}else{var t=e.getBoundingClientRect(),n=[],i=I_(r),s;try{for(i.s();!(s=i.n()).done;){var c=s.value;n.push(new Co(c.clientX-t.left-e.clientLeft,c.clientY-t.top-e.clientTop))}}catch(I){i.e(I)}finally{i.f()}return n}},Sh.mouseButton=function(e){return $i&&typeof di.InstallTrigger!="undefined"&&e.button===2&&e.ctrlKey&&di.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},Sh.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};function rL(e){var r=nL();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function nL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Sd=function(e){qr()(t,e);var r=rL(t);function t(n,i,s){var c,g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Ft()(this,t);var y=Dc.mousePos(i.getCanvasContainer(),s),E=i.unproject(y);return c=r.call(this,n,gs()({point:y,lngLat:E,originalEvent:s},g)),w()(ce()(c),"type",void 0),w()(ce()(c),"target",void 0),w()(ce()(c),"originalEvent",void 0),w()(ce()(c),"point",void 0),w()(ce()(c),"lngLat",void 0),w()(ce()(c),"defaultPrevented",void 0),c.defaultPrevented=!1,c.target=i,c}return Yt()(t,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),t}(us);function iL(e){var r=aL();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function aL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Yg=function(e){qr()(t,e);var r=iL(t);function t(n,i,s){var c;Ft()(this,t);var g=n==="touchend"?s.changedTouches:s.touches,y=Dc.touchPos(i.getCanvasContainer(),g),E=y.map(function(F){return i.unproject(F)}),T=y.reduce(function(F,U,Q,ue){return F.add(U.div(ue.length))},new Co(0,0)),I=i.unproject(T);return c=r.call(this,n,{points:y,point:T,lngLats:E,lngLat:I,originalEvent:s}),w()(ce()(c),"type",void 0),w()(ce()(c),"target",void 0),w()(ce()(c),"originalEvent",void 0),w()(ce()(c),"lngLat",void 0),w()(ce()(c),"point",void 0),w()(ce()(c),"points",void 0),w()(ce()(c),"lngLats",void 0),w()(ce()(c),"defaultPrevented",void 0),c.defaultPrevented=!1,c}return Yt()(t,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),t}(us);function oL(e){var r=sL();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function sL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var uL=function(e){qr()(t,e);var r=oL(t);function t(n,i,s){var c;return Ft()(this,t),c=r.call(this,n,{originalEvent:s}),w()(ce()(c),"type",void 0),w()(ce()(c),"originalEvent",void 0),w()(ce()(c),"defaultPrevented",void 0),w()(ce()(c),"target",void 0),c.defaultPrevented=!1,c}return Yt()(t,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),t}(us),lL=function(){function e(r){Ft()(this,e),w()(this,"map",void 0),w()(this,"delayContextMenu",void 0),w()(this,"contextMenuEvent",void 0),this.map=r}return Yt()(e,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(t){this.map.emit(t.type,new Sd(t.type,this.map,t))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new Sd("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(t){this.delayContextMenu?this.contextMenuEvent=t:this.map.emit(t.type,new Sd(t.type,this.map,t)),this.map.listeners("contextmenu")&&t.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),e}(),cL=function(){function e(r,t){Ft()(this,e),w()(this,"map",void 0),w()(this,"el",void 0),w()(this,"container",void 0),w()(this,"enabled",void 0),w()(this,"active",void 0),w()(this,"startPos",void 0),w()(this,"lastPos",void 0),w()(this,"box",void 0),w()(this,"clickTolerance",void 0),this.map=r,this.el=r.getCanvasContainer(),this.container=r.getContainer(),this.clickTolerance=t.clickTolerance||1}return Yt()(e,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){this.isEnabled()||(this.enabled=!0)}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"mousedown",value:function(t,n){!this.isEnabled()||!(t.shiftKey&&t.button===0)||(Dc.disableDrag(),this.startPos=this.lastPos=n,this.active=!0)}},{key:"mousemoveWindow",value:function(t,n){if(!!this.active){var i=n;if(!(this.lastPos.equals(i)||!this.box&&i.dist(this.startPos)<this.clickTolerance)){var s=this.startPos;this.lastPos=i,this.box||(this.box=Dc.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",t));var c=Math.min(s.x,i.x),g=Math.max(s.x,i.x),y=Math.min(s.y,i.y),E=Math.max(s.y,i.y);Dc.setTransform(this.box,"translate(".concat(c,"px,").concat(y,"px)")),this.box&&(this.box.style.width="".concat(g-c,"px"),this.box.style.height="".concat(E-y,"px"))}}}},{key:"mouseupWindow",value:function(t,n){var i=this;if(!!this.active&&t.button===0){var s=this.startPos,c=n;if(this.reset(),Dc.suppressClick(),s.x===c.x&&s.y===c.y)this.fireEvent("boxzoomcancel",t);else return this.map.emit("boxzoomend",new us("boxzoomend",{originalEvent:t})),{cameraAnimation:function(y){return y.fitScreenCoordinates(s,c,i.map.getBearing(),{linear:!0})}}}}},{key:"keydown",value:function(t){!this.active||t.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",t))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&(Dc.remove(this.box),this.box=null),Dc.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(t,n){return this.map.emit(t,new us(t,{originalEvent:n}))}}]),e}(),fL=cL,hL=function(){function e(){Ft()(this,e),w()(this,"enabled",void 0),w()(this,"active",void 0),this.reset()}return Yt()(e,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(t,n){return t.preventDefault(),{cameraAnimation:function(s){s.easeTo({duration:300,zoom:s.getZoom()+(t.shiftKey?-1:1),around:s.unproject(n)},{originalEvent:t})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}();function pL(e){var r=dL();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function dL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vL=function(e){qr()(t,e);var r=pL(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"type","renderFrame"),w()(ce()(n),"timeStamp",void 0),n}return Yt()(t)}(us);function mL(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=gL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function gL(e,r){if(!!e){if(typeof e=="string")return bC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return bC(e,r)}}function bC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Kg={linearity:.3,easing:M_(0,0,.3,1)},yL=gs()({deceleration:2500,maxSpeed:1400},Kg),_L=gs()({deceleration:20,maxSpeed:1400},Kg),xL=gs()({deceleration:1e3,maxSpeed:360},Kg),bL=gs()({deceleration:1e3,maxSpeed:90},Kg),EL=function(){function e(r){Ft()(this,e),w()(this,"map",void 0),w()(this,"inertiaBuffer",void 0),this.map=r,this.clear()}return Yt()(e,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(t){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:ov(),settings:t})}},{key:"drainInertiaBuffer",value:function(){for(var t=this.inertiaBuffer,n=ov(),i=160;t.length>0&&n-t[0].time>i;)t.shift()}},{key:"onMoveEnd",value:function(t){if(this.drainInertiaBuffer(),!(this.inertiaBuffer.length<2)){var n={zoom:0,bearing:0,pitch:0,pan:new Co(0,0),pinchAround:void 0,around:void 0},i=mL(this.inertiaBuffer),s;try{for(i.s();!(s=i.n()).done;){var c=s.value.settings;n.zoom+=c.zoomDelta||0,n.bearing+=c.bearingDelta||0,n.pitch+=c.pitchDelta||0,c.panDelta&&n.pan._add(c.panDelta),c.around&&(n.around=c.around),c.pinchAround&&(n.pinchAround=c.pinchAround)}}catch(ue){i.e(ue)}finally{i.f()}var g=this.inertiaBuffer[this.inertiaBuffer.length-1],y=g.time-this.inertiaBuffer[0].time,E={};if(n.pan.mag()){var T=qg(n.pan.mag(),y,gs()({},yL,t||{}));E.offset=n.pan.mult(T.amount/n.pan.mag()),E.center=this.map.transform.center,$g(E,T)}if(n.zoom){var I=qg(n.zoom,y,_L);E.zoom=this.map.transform.zoom+I.amount,$g(E,I)}if(n.bearing){var F=qg(n.bearing,y,xL);E.bearing=this.map.transform.bearing+Ed(F.amount,-179,179),$g(E,F)}if(n.pitch){var U=qg(n.pitch,y,bL);E.pitch=this.map.transform.pitch+U.amount,$g(E,U)}if(E.zoom||E.bearing){var Q=n.pinchAround===void 0?n.around:n.pinchAround;E.around=Q?this.map.unproject(Q):this.map.getCenter()}return this.clear(),gs()(E,{noMoveStart:!0})}}}]),e}();function $g(e,r){(!e.duration||e.duration<r.duration)&&(e.duration=r.duration,e.easing=r.easing)}function qg(e,r,t){var n=t.maxSpeed,i=t.linearity,s=t.deceleration,c=Ed(e*i/(r/1e3),-n,n),g=Math.abs(c)/(s*i);return{easing:t.easing,duration:g*1e3,amount:c*(g/2)}}var SL={panStep:100,bearingStep:15,pitchStep:10},CL=function(){function e(){Ft()(this,e),w()(this,"enabled",void 0),w()(this,"active",void 0),w()(this,"panStep",void 0),w()(this,"bearingStep",void 0),w()(this,"pitchStep",void 0);var r=SL;this.panStep=r.panStep,this.bearingStep=r.bearingStep,this.pitchStep=r.pitchStep}return Yt()(e,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(t){var n=this;if(!(t.altKey||t.ctrlKey||t.metaKey)){var i=0,s=0,c=0,g=0,y=0;switch(t.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:t.shiftKey?s=-1:(t.preventDefault(),g=-1);break;case 39:t.shiftKey?s=1:(t.preventDefault(),g=1);break;case 38:t.shiftKey?c=1:(t.preventDefault(),y=-1);break;case 40:t.shiftKey?c=-1:(t.preventDefault(),y=1);break;default:return}return{cameraAnimation:function(T){var I=T.getZoom();T.easeTo({duration:300,easeId:"keyboardHandler",easing:wL,zoom:i?Math.round(I)+i*(t.shiftKey?2:1):I,bearing:T.getBearing()+s*n.bearingStep,pitch:T.getPitch()+c*n.pitchStep,offset:[-g*n.panStep,-y*n.panStep],center:T.getCenter()},{originalEvent:t})}}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}();function wL(e){return e*(2-e)}var AL=CL,TL=function(){function e(r,t){Ft()(this,e),w()(this,"mousedownPos",void 0),w()(this,"clickTolerance",void 0),w()(this,"map",void 0),this.map=r,this.clickTolerance=t.clickTolerance}return Yt()(e,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(t){return this.firePreventable(new uL(t.type,this.map,t))}},{key:"mousedown",value:function(t,n){return this.mousedownPos=n,this.firePreventable(new Sd(t.type,this.map,t))}},{key:"mouseup",value:function(t){this.map.emit(t.type,new Sd(t.type,this.map,t))}},{key:"click",value:function(t,n){this.mousedownPos&&this.mousedownPos.dist(n)>=this.clickTolerance||this.map.emit(t.type,new Sd(t.type,this.map,t))}},{key:"dblclick",value:function(t){return this.firePreventable(new Sd(t.type,this.map,t))}},{key:"mouseover",value:function(t){this.map.emit(t.type,new Sd(t.type,this.map,t))}},{key:"mouseout",value:function(t){this.map.emit(t.type,new Sd(t.type,this.map,t))}},{key:"touchstart",value:function(t){return this.firePreventable(new Yg(t.type,this.map,t))}},{key:"touchmove",value:function(t){this.map.emit(t.type,new Yg(t.type,this.map,t))}},{key:"touchend",value:function(t){this.map.emit(t.type,new Yg(t.type,this.map,t))}},{key:"touchcancel",value:function(t){this.map.emit(t.type,new Yg(t.type,this.map,t))}},{key:"firePreventable",value:function(t){if(this.map.emit(t.type,t),t.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),e}(),Qg,Jg=0,R_=2,ML=(Qg={},w()(Qg,Jg,1),w()(Qg,R_,2),Qg);function PL(e,r){var t=ML[r];return e.buttons===void 0||(e.buttons&t)!==t}var L_=function(){function e(r){Ft()(this,e),w()(this,"enabled",void 0),w()(this,"active",void 0),w()(this,"lastPoint",void 0),w()(this,"eventButton",void 0),w()(this,"moved",void 0),w()(this,"clickTolerance",void 0),this.reset(),this.clickTolerance=r.clickTolerance||1}return Yt()(e,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(t,n){if(!this.lastPoint){var i=Dc.mouseButton(t);!this.correctButton(t,i)||(this.lastPoint=n,this.eventButton=i)}}},{key:"mousemoveWindow",value:function(t,n){var i=this.lastPoint;if(!!i){if(t.preventDefault(),PL(t,this.eventButton)){this.reset();return}if(!(!this.moved&&n.dist(i)<this.clickTolerance))return this.moved=!0,this.lastPoint=n,this.move(i,n)}}},{key:"mouseupWindow",value:function(t){if(!!this.lastPoint){var n=Dc.mouseButton(t);n===this.eventButton&&(this.moved&&Dc.suppressClick(),this.reset())}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(t,n){return!1}},{key:"move",value:function(t,n){}}]),e}();function OL(e){var r=IL();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function IL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var RL=function(e){qr()(t,e);var r=OL(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"mousedown",value:function(i,s){Yd()(wt()(t.prototype),"mousedown",this).call(this,i,s),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(i,s){return{around:s,panDelta:s.sub(i)}}},{key:"correctButton",value:function(i,s){return s===Jg&&!i.ctrlKey}}]),t}(L_);function LL(e){var r=kL();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function kL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var DL=function(e){qr()(t,e);var r=LL(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"correctButton",value:function(i,s){return s===Jg&&i.ctrlKey||s===R_}},{key:"move",value:function(i,s){var c=-.5,g=(s.y-i.y)*c;if(g)return this.active=!0,{pitchDelta:g}}},{key:"contextmenu",value:function(i){i.preventDefault()}}]),t}(L_);function FL(e){var r=BL();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function BL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var NL=function(e){qr()(t,e);var r=FL(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"contextmenu",value:function(i){i.preventDefault()}},{key:"correctButton",value:function(i,s){return s===Jg&&i.ctrlKey||s===R_}},{key:"move",value:function(i,s){var c=.8,g=(s.x-i.x)*c;if(g)return this.active=!0,{bearingDelta:g}}}]),t}(L_),EC=4.000244140625,zL=1/100,UL=1/450,jL=2,VL=function(){function e(r,t){var n=this;Ft()(this,e),w()(this,"map",void 0),w()(this,"el",void 0),w()(this,"enabled",void 0),w()(this,"active",void 0),w()(this,"zooming",void 0),w()(this,"aroundCenter",void 0),w()(this,"around",void 0),w()(this,"aroundPoint",void 0),w()(this,"type",void 0),w()(this,"lastValue",void 0),w()(this,"timeout",void 0),w()(this,"finishTimeout",void 0),w()(this,"lastWheelEvent",void 0),w()(this,"lastWheelEventTime",void 0),w()(this,"startZoom",void 0),w()(this,"targetZoom",void 0),w()(this,"delta",void 0),w()(this,"easing",void 0),w()(this,"prevEase",void 0),w()(this,"frameId",void 0),w()(this,"handler",void 0),w()(this,"defaultZoomRate",void 0),w()(this,"wheelZoomRate",void 0),w()(this,"onScrollFrame",function(){if(!!n.frameId&&(n.frameId=null,!!n.isActive())){var i=n.map.transform;if(n.delta!==0){var s=n.type==="wheel"&&Math.abs(n.delta)>EC?n.wheelZoomRate:n.defaultZoomRate,c=jL/(1+Math.exp(-Math.abs(n.delta*s)));n.delta<0&&c!==0&&(c=1/c);var g=typeof n.targetZoom=="number"?i.zoomScale(n.targetZoom):i.scale;n.targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(g*c))),n.type==="wheel"&&(n.startZoom=i.zoom,n.easing=n.smoothOutEasing(200)),n.delta=0}var y=typeof n.targetZoom=="number"?n.targetZoom:i.zoom,E=n.startZoom,T=n.easing,I=!1,F;if(n.type==="wheel"&&E&&T){var U=Math.min((ov()-n.lastWheelEventTime)/200,1),Q=T(U);F=Xh(E,y,Q),U<1?n.frameId||(n.frameId=!0):I=!0}else F=y,I=!0;return n.active=!0,I&&(n.active=!1,n.finishTimeout=setTimeout(function(){n.zooming=!1,n.handler.triggerRenderFrame(),delete n.targetZoom,delete n.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:F-i.zoom,around:n.aroundPoint,originalEvent:n.lastWheelEvent}}}),this.map=r,this.el=r.getCanvasContainer(),this.handler=t,this.delta=0,this.defaultZoomRate=zL,this.wheelZoomRate=UL}return Yt()(e,[{key:"setZoomRate",value:function(t){this.defaultZoomRate=t}},{key:"setWheelZoomRate",value:function(t){this.wheelZoomRate=t}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(t){this.isEnabled()||(this.enabled=!0,this.aroundCenter=t&&t.around==="center")}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"wheel",value:function(t){if(!!this.isEnabled()){var n=t.deltaMode===window.WheelEvent.DOM_DELTA_LINE?t.deltaY*40:t.deltaY,i=ov(),s=i-(this.lastWheelEventTime||0);this.lastWheelEventTime=i,n!==0&&n%EC==0?this.type="wheel":n!==0&&Math.abs(n)<4?this.type="trackpad":s>400?(this.type=null,this.lastValue=n,this.timeout=setTimeout(this.onTimeout,40,t)):this.type||(this.type=Math.abs(s*n)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,n+=this.lastValue)),t.shiftKey&&n&&(n=n/4),this.type&&(this.lastWheelEvent=t,this.delta-=n,this.active||this.start(t)),t.preventDefault()}}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(t){this.type="wheel",this.delta-=this.lastValue,!this.active&&this.start&&this.start(t)}},{key:"start",value:function(t){if(!!this.delta){this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var n=Dc.mousePos(this.el,t);this.around=ru.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(n)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}}},{key:"smoothOutEasing",value:function(t){var n=P_;if(this.prevEase){var i=this.prevEase,s=(ov()-i.start)/i.duration,c=i.easing(s+.01)-i.easing(s),g=.27/Math.sqrt(c*c+1e-4)*.01,y=Math.sqrt(.27*.27-g*g);n=M_(g,y,.25,1)}return this.prevEase={start:ov(),duration:t,easing:n},n}}]),e}(),GL=VL,HL=function(){function e(r,t){Ft()(this,e),w()(this,"clickZoom",void 0),w()(this,"tapZoom",void 0),this.clickZoom=r,this.tapZoom=t}return Yt()(e,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),e}(),WL=function(){function e(r,t,n){Ft()(this,e),w()(this,"inertiaOptions",void 0),w()(this,"el",void 0),w()(this,"mousePan",void 0),w()(this,"touchPan",void 0),this.el=r,this.mousePan=t,this.touchPan=n}return Yt()(e,[{key:"enable",value:function(t){this.inertiaOptions=t||{},this.mousePan.enable(),this.touchPan.enable(),$i||this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),$i||this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),e}(),ZL=function(){function e(r,t,n){Ft()(this,e),w()(this,"mouseRotate",void 0),w()(this,"mousePitch",void 0),w()(this,"pitchWithRotate",void 0),this.pitchWithRotate=r.pitchWithRotate,this.mouseRotate=t,this.mousePitch=n}return Yt()(e,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),e}(),XL=function(){function e(r,t,n,i){Ft()(this,e),w()(this,"el",void 0),w()(this,"touchZoom",void 0),w()(this,"touchRotate",void 0),w()(this,"tapDragZoom",void 0),w()(this,"rotationDisabled",void 0),w()(this,"enabled",void 0),this.el=r,this.touchZoom=t,this.touchRotate=n,this.tapDragZoom=i,this.rotationDisabled=!1,this.enabled=!0}return Yt()(e,[{key:"enable",value:function(t){this.touchZoom.enable(t),this.rotationDisabled||this.touchRotate.enable(t),this.tapDragZoom.enable(),$i||this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),$i||this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),e}();function k_(e,r){for(var t={},n=0;n<e.length;n++)t[e[n].identifier]=r[n];return t}function YL(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=KL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function KL(e,r){if(!!e){if(typeof e=="string")return SC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return SC(e,r)}}function SC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function $L(e){var r=new Co(0,0),t=YL(e),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;r._add(i)}}catch(s){t.e(s)}finally{t.f()}return r.div(e.length)}var CC=500,qL=500,wC=30,QL=function(){function e(r){Ft()(this,e),w()(this,"numTouches",void 0),w()(this,"centroid",void 0),w()(this,"startTime",void 0),w()(this,"aborted",void 0),w()(this,"touches",void 0),this.reset(),this.numTouches=r.numTouches}return Yt()(e,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(t,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=t.timeStamp),i.length===this.numTouches&&(this.centroid=$L(n),this.touches=k_(i,n)))}},{key:"touchmove",value:function(t,n,i){if(!(this.aborted||!this.centroid)){var s=k_(i,n);for(var c in this.touches)if(this.touches[c]){var g=this.touches[c],y=s[c];(!y||y.dist(g)>wC)&&(this.aborted=!0)}}}},{key:"touchend",value:function(t,n,i){if((!this.centroid||t.timeStamp-this.startTime>qL)&&(this.aborted=!0),i.length===0){var s=!this.aborted&&this.centroid;if(this.reset(),s)return s}}}]),e}(),D_=function(){function e(r){Ft()(this,e),w()(this,"singleTap",void 0),w()(this,"numTaps",void 0),w()(this,"lastTime",void 0),w()(this,"lastTap",void 0),w()(this,"count",void 0),this.singleTap=new QL(r),this.numTaps=r.numTaps,this.reset()}return Yt()(e,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(t,n,i){this.singleTap.touchstart(t,n,i)}},{key:"touchmove",value:function(t,n,i){this.singleTap.touchmove(t,n,i)}},{key:"touchend",value:function(t,n,i){var s=this.singleTap.touchend(t,n,i);if(s){var c=t.timeStamp-this.lastTime<CC,g=!this.lastTap||this.lastTap.dist(s)<wC;if((!c||!g)&&this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=s,this.count===this.numTaps)return this.reset(),s}}}]),e}(),JL=function(){function e(){Ft()(this,e),w()(this,"enabled",void 0),w()(this,"active",void 0),w()(this,"swipePoint",void 0),w()(this,"swipeTouch",void 0),w()(this,"tapTime",void 0),w()(this,"tap",void 0),this.tap=new D_({numTouches:1,numTaps:1}),this.reset()}return Yt()(e,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(t,n,i){this.swipePoint||(this.tapTime&&t.timeStamp-this.tapTime>CC&&this.reset(),this.tapTime?i.length>0&&(this.swipePoint=n[0],this.swipeTouch=i[0].identifier):this.tap.touchstart(t,n,i))}},{key:"touchmove",value:function(t,n,i){if(!this.tapTime)this.tap.touchmove(t,n,i);else if(this.swipePoint){if(i[0].identifier!==this.swipeTouch)return;var s=n[0],c=s.y-this.swipePoint.y;return this.swipePoint=s,t.preventDefault(),this.active=!0,{zoomDelta:c/128}}}},{key:"touchend",value:function(t,n,i){if(this.tapTime)this.swipePoint&&i.length===0&&this.reset();else{var s=this.tap.touchend(t,n,i);s&&(this.tapTime=t.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}(),ek=function(){function e(){Ft()(this,e),w()(this,"enabled",void 0),w()(this,"active",void 0),w()(this,"zoomIn",void 0),w()(this,"zoomOut",void 0),this.zoomIn=new D_({numTouches:1,numTaps:2}),this.zoomOut=new D_({numTouches:2,numTaps:1}),this.reset()}return Yt()(e,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(t,n,i){this.zoomIn.touchstart(t,n,i),this.zoomOut.touchstart(t,n,i)}},{key:"touchmove",value:function(t,n,i){this.zoomIn.touchmove(t,n,i),this.zoomOut.touchmove(t,n,i)}},{key:"touchend",value:function(t,n,i){var s=this,c=this.zoomIn.touchend(t,n,i),g=this.zoomOut.touchend(t,n,i);if(c)return this.active=!0,t.preventDefault(),setTimeout(function(){return s.reset()},0),{cameraAnimation:function(E){return E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(c)},{originalEvent:t})}};if(g)return this.active=!0,t.preventDefault(),setTimeout(function(){return s.reset()},0),{cameraAnimation:function(E){return E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(g)},{originalEvent:t})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}(),tk=function(){function e(r){Ft()(this,e),w()(this,"enabled",void 0),w()(this,"active",void 0),w()(this,"touches",void 0),w()(this,"minTouches",void 0),w()(this,"clickTolerance",void 0),w()(this,"sum",void 0),this.minTouches=1,this.clickTolerance=r.clickTolerance||1,this.reset()}return Yt()(e,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new Co(0,0)}},{key:"touchstart",value:function(t,n,i){return this.calculateTransform(t,n,i)}},{key:"touchmove",value:function(t,n,i){if(!!this.active)return t.preventDefault(),this.calculateTransform(t,n,i)}},{key:"touchend",value:function(t,n,i){this.calculateTransform(t,n,i),this.active&&i.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(t,n,i){i.length>0&&(this.active=!0);var s=k_(i,n),c=new Co(0,0),g=new Co(0,0),y=0;for(var E in s)if(s[E]){var T=s[E],I=this.touches[E];I&&(c._add(T),g._add(T.sub(I)),y++,s[E]=T)}if(this.touches=s,!(y<this.minTouches||!g.mag())){var F=g.div(y);if(this.sum._add(F),!(this.sum.mag()<this.clickTolerance)){var U=c.div(y);return{around:U,panDelta:F}}}}}]),e}(),F_=function(){function e(){Ft()(this,e),w()(this,"enabled",void 0),w()(this,"active",void 0),w()(this,"firstTwoTouches",void 0),w()(this,"vector",void 0),w()(this,"startVector",void 0),w()(this,"aroundCenter",void 0),this.reset()}return Yt()(e,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(t){}},{key:"move",value:function(t,n,i){}},{key:"touchstart",value:function(t,n,i){this.firstTwoTouches||i.length<2||(this.firstTwoTouches=[i[0].identifier,i[1].identifier],this.start([n[0],n[1]]))}},{key:"touchmove",value:function(t,n,i){if(!!this.firstTwoTouches){t.preventDefault();var s=Ei()(this.firstTwoTouches,2),c=s[0],g=s[1],y=ey(i,n,c),E=ey(i,n,g);if(!(!y||!E)){var T=this.aroundCenter?null:y.add(E).div(2);return this.move([y,E],T,t)}}}},{key:"touchend",value:function(t,n,i){if(!!this.firstTwoTouches){var s=Ei()(this.firstTwoTouches,2),c=s[0],g=s[1],y=ey(i,n,c),E=ey(i,n,g);y&&E||(this.active&&Dc.suppressClick(),this.reset())}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(t){this.enabled=!0,this.aroundCenter=!!t&&t.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}();function ey(e,r,t){for(var n=0;n<e.length;n++)if(e[n].identifier===t)return r[n]}function rk(e){var r=nk();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function nk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function B_(e){return Math.abs(e.y)>Math.abs(e.x)}var ik=100,ak=function(e){qr()(t,e);var r=rk(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"valid",void 0),w()(ce()(n),"firstMove",void 0),w()(ce()(n),"lastPoints",void 0),n}return Yt()(t,[{key:"reset",value:function(){Yd()(wt()(t.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(i){this.lastPoints=i,B_(i[0].sub(i[1]))&&(this.valid=!1)}},{key:"move",value:function(i,s,c){var g=i[0].sub(this.lastPoints[0]),y=i[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(g,y,c.timeStamp),!!this.valid){this.lastPoints=i,this.active=!0;var E=(g.y+y.y)/2,T=-.5;return{pitchDelta:E*T}}}},{key:"gestureBeginsVertically",value:function(i,s,c){if(this.valid!==void 0)return this.valid;var g=2,y=i.mag()>=g,E=s.mag()>=g;if(!(!y&&!E)){if(!y||!E)return this.firstMove===void 0&&(this.firstMove=c),c-this.firstMove<ik?void 0:!1;var T=i.y>0==s.y>0;return B_(i)&&B_(s)&&T}}}]),t}(F_);function ok(e){var r=sk();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function sk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var uk=25;function AC(e,r){return e.angleWith(r)*180/Math.PI}var lk=function(e){qr()(t,e);var r=ok(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"minDiameter",void 0),n}return Yt()(t,[{key:"reset",value:function(){Yd()(wt()(t.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(i){this.startVector=this.vector=i[0].sub(i[1]),this.minDiameter=i[0].dist(i[1])}},{key:"move",value:function(i,s){var c=this.vector;if(this.vector=i[0].sub(i[1]),!(!this.active&&this.isBelowThreshold(this.vector)))return this.active=!0,{bearingDelta:AC(this.vector,c),pinchAround:s}}},{key:"isBelowThreshold",value:function(i){this.minDiameter=Math.min(this.minDiameter,i.mag());var s=Math.PI*this.minDiameter,c=uk/s*360,g=AC(i,this.startVector);return Math.abs(g)<c}}]),t}(F_);function ck(e){var r=fk();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function fk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var hk=.1;function TC(e,r){return Math.log(e/r)/Math.LN2}var pk=function(e){qr()(t,e);var r=ck(t);function t(){var n;Ft()(this,t);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=r.call.apply(r,[this].concat(s)),w()(ce()(n),"distance",void 0),w()(ce()(n),"startDistance",void 0),n}return Yt()(t,[{key:"reset",value:function(){Yd()(wt()(t.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(i){this.startDistance=this.distance=i[0].dist(i[1])}},{key:"move",value:function(i,s){var c=this.distance;if(this.distance=i[0].dist(i[1]),!(!this.active&&Math.abs(TC(this.distance,this.startDistance))<hk))return this.active=!0,{zoomDelta:TC(this.distance,c),pinchAround:s}}}]),t}(F_);function Kv(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=dk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function dk(e,r){if(!!e){if(typeof e=="string")return MC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return MC(e,r)}}function MC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var ty=function(r){return r.zoom||r.drag||r.pitch||r.rotate};function N_(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}var vk=function(){function e(r,t){var n=this;Ft()(this,e),w()(this,"map",void 0),w()(this,"el",void 0),w()(this,"handlers",void 0),w()(this,"eventsInProgress",void 0),w()(this,"frameId",void 0),w()(this,"inertia",void 0),w()(this,"bearingSnap",void 0),w()(this,"handlersById",void 0),w()(this,"updatingCamera",void 0),w()(this,"changes",void 0),w()(this,"previousActiveHandlers",void 0),w()(this,"bearingChanged",void 0),w()(this,"listeners",void 0),w()(this,"handleWindowEvent",function(I){n.handleEvent(I,"".concat(I.type,"Window"))}),w()(this,"handleEvent",function(I,F){if(I.type==="blur"){n.stop();return}n.updatingCamera=!0;var U=I.type==="renderFrame"?void 0:I,Q={needsRenderFrame:!1},ue={},de={},Re=I.touches?n.getMapTouches(I.touches):void 0,et=Re?Dc.touchPos(n.el,Re):Dc.mousePos(n.el,I),ht=Kv(n.handlers),xt;try{for(ht.s();!(xt=ht.n()).done;){var Gt=xt.value,jt=Gt.handlerName,Qt=Gt.handler,fr=Gt.allowed;if(!!Qt.isEnabled()){var Gr=void 0;if(n.blockedByActive(de,fr,jt))Qt.reset();else{var Jr=F||I.type;Qt&&Qt[Jr]&&(Gr=Qt[Jr](I,et,Re),n.mergeIHandlerResult(Q,ue,Gr,jt,U),Gr&&Gr.needsRenderFrame&&n.triggerRenderFrame())}(Gr||Qt.isActive())&&(de[jt]=Qt)}}}catch(Oi){ht.e(Oi)}finally{ht.f()}var Ur={};for(var Xn in n.previousActiveHandlers)de[Xn]||(Ur[Xn]=U);n.previousActiveHandlers=de,(Object.keys(Ur).length||N_(Q))&&(n.changes.push([Q,ue,Ur]),n.triggerRenderFrame()),(Object.keys(de).length||N_(Q))&&n.map.stop(!0),n.updatingCamera=!1;var ni=Q.cameraAnimation;ni&&(n.inertia.clear(),n.fireEvents({},{}),n.changes=[],ni(n.map))}),this.map=r,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new EL(r),this.bearingSnap=t.bearingSnap,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(t);var i=this.el;if(this.listeners=[],$i)di.document.addEventListener("touchstart",function(I){n.handleEvent(I)},{}),di.document.addEventListener("touchmove",function(I){n.handleEvent(I)},{}),di.document.addEventListener("touchend",function(I){n.handleEvent(I)},{}),di.document.addEventListener("touchcancel",function(I){n.handleEvent(I)},{});else{this.listeners=[[i,"touchstart",{passive:!1}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[window,"blur",void 0]];var s=Kv(this.listeners),c;try{for(s.s();!(c=s.n()).done;){var g=Ei()(c.value,3),y=g[0],E=g[1],T=g[2];Dc.addEventListener(y,E,y===window.document?this.handleWindowEvent:this.handleEvent,T)}}catch(I){s.e(I)}finally{s.f()}}}return Yt()(e,[{key:"destroy",value:function(){var t=Kv(this.listeners),n;try{for(t.s();!(n=t.n()).done;){var i=Ei()(n.value,3),s=i[0],c=i[1],g=i[2];Dc.removeEventListener(s,c,s===window.document?this.handleWindowEvent:this.handleEvent,g)}}catch(y){t.e(y)}finally{t.f()}}},{key:"stop",value:function(){if(!this.updatingCamera){var t=Kv(this.handlers),n;try{for(t.s();!(n=t.n()).done;){var i=n.value.handler;i.reset()}}catch(s){t.e(s)}finally{t.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}}},{key:"isActive",value:function(){var t=Kv(this.handlers),n;try{for(t.s();!(n=t.n()).done;){var i=n.value.handler;if(i.isActive())return!0}}catch(s){t.e(s)}finally{t.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(ty(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(t,n,i,s,c){if(!!i){gs()(t,i);var g={handlerName:s,originalEvent:i.originalEvent||c};i.zoomDelta!==void 0&&(n.zoom=g),i.panDelta!==void 0&&(n.drag=g),i.pitchDelta!==void 0&&(n.pitch=g),i.bearingDelta!==void 0&&(n.rotate=g)}}},{key:"triggerRenderFrame",value:function(){var t=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(n){delete t.frameId,t.handleEvent(new vL("renderFrame",{timeStamp:n})),t.applyChanges()}))}},{key:"addDefaultHandlers",value:function(t){var n=this.map,i=n.getCanvasContainer();this.add("mapEvent",new TL(n,t));var s=n.boxZoom=new fL(n,t);this.add("boxZoom",s);var c=new ek,g=new hL;n.doubleClickZoom=new HL(g,c),this.add("tapZoom",c),this.add("clickZoom",g);var y=new JL;this.add("tapDragZoom",y);var E=n.touchPitch=new ak;this.add("touchPitch",E);var T=new DL(t),I=new NL(t);n.dragRotate=new ZL(t,T,I),this.add("mouseRotate",T,["mousePitch"]),this.add("mousePitch",I,["mouseRotate"]);var F=new RL(t),U=new tk(t);n.dragPan=new WL(i,F,U),this.add("mousePan",F),this.add("touchPan",U,["touchZoom","touchRotate"]);var Q=new lk,ue=new pk;n.touchZoomRotate=new XL(i,ue,Q,y),this.add("touchRotate",Q,["touchPan","touchZoom"]),this.add("touchZoom",ue,["touchPan","touchRotate"]);var de=n.scrollZoom=new GL(n,this);this.add("scrollZoom",de,["mousePan"]);var Re=n.keyboard=new AL;this.add("keyboard",Re),this.add("blockableMapEvent",new lL(n));for(var et=0,ht=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];et<ht.length;et++){var xt=ht[et];t.interactive&&t[xt]&&n[xt].enable(t[xt])}}},{key:"add",value:function(t,n,i){this.handlers.push({handlerName:t,handler:n,allowed:i}),this.handlersById[t]=n}},{key:"blockedByActive",value:function(t,n,i){for(var s in t)if(s!==i&&(!n||n.indexOf(s)<0))return!0;return!1}},{key:"getMapTouches",value:function(t){var n=[],i=Kv(t),s;try{for(i.s();!(s=i.n()).done;){var c=s.value,g=c.target;($i||this.el.contains(g))&&n.push(c)}}catch(y){i.e(y)}finally{i.f()}return n}},{key:"applyChanges",value:function(){var t={},n={},i={},s=Kv(this.changes),c;try{for(s.s();!(c=s.n()).done;){var g=Ei()(c.value,3),y=g[0],E=g[1],T=g[2];y.panDelta&&(t.panDelta=(t.panDelta||new Co(0,0))._add(y.panDelta)),y.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(t.around=y.around),y.pinchAround!==void 0&&(t.pinchAround=y.pinchAround),y.noInertia&&(t.noInertia=y.noInertia),gs()(n,E),gs()(i,T)}}catch(I){s.e(I)}finally{s.f()}this.updateMapTransform(t,n,i),this.changes=[]}},{key:"updateMapTransform",value:function(t,n,i){var s=this.map,c=s.transform;if(!N_(t))return this.fireEvents(n,i);var g=t.panDelta,y=t.zoomDelta,E=t.bearingDelta,T=t.pitchDelta,I=t.pinchAround,F=t.around;I!==void 0&&(F=I),s.stop(!0),F=F||s.transform.centerPoint;var U=c.pointLocation(g?F.sub(g):F);E&&(c.bearing+=E),T&&(c.pitch+=T),y&&(c.zoom+=y),c.setLocationAtPoint(U,F),this.map.update(),t.noInertia||this.inertia.record(t),this.fireEvents(n,i)}},{key:"fireEvents",value:function(t,n){var i=this,s=ty(this.eventsInProgress),c=ty(t),g={};for(var y in t)if(t[y]){var E=t[y].originalEvent;this.eventsInProgress[y]||(g["".concat(y,"start")]=E),this.eventsInProgress[y]=t[y]}!s&&c&&this.fireEvent("movestart",c.originalEvent);for(var T in g)g[T]&&this.fireEvent(T,g[T]);t.rotate&&(this.bearingChanged=!0),c&&this.fireEvent("move",c.originalEvent);for(var I in t)if(t[I]){var F=t[I].originalEvent;this.fireEvent(I,F)}var U={},Q;for(var ue in this.eventsInProgress)if(this.eventsInProgress[ue]){var de=this.eventsInProgress[ue],Re=de.handlerName,et=de.originalEvent;this.handlersById[Re].isActive()||(delete this.eventsInProgress[ue],Q=n[Re]||et,U["".concat(ue,"end")]=Q)}for(var ht in U)U[ht]&&this.fireEvent(ht,U[ht]);var xt=ty(this.eventsInProgress);if((s||c)&&!xt){this.updatingCamera=!0;var Gt=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),jt=function(fr){return fr!==0&&-i.bearingSnap<fr&&fr<i.bearingSnap};Gt?(jt(Gt.bearing||this.map.getBearing())&&(Gt.bearing=0),this.map.easeTo(Gt,{originalEvent:Q})):(this.map.emit("moveend",new us("moveend",{originalEvent:Q})),jt(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(t,n){this.map.emit(t,new us(t,n?{originalEvent:n}:{}))}}]),e}(),PC=vk,mk=M("DzJC"),gk=M.n(mk),yk=function(){function e(r){var t=this;Ft()(this,e),w()(this,"map",void 0),w()(this,"updateHash",void 0),w()(this,"hashName",void 0),w()(this,"onHashChange",function(){var n=t.getCurrentHash();if(n.length>=3&&!n.some(function(s){return isNaN(+s)})){var i=t.map.dragRotate.isEnabled()&&t.map.touchZoomRotate.isEnabled()?+(n[3]||0):t.map.getBearing();return t.map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:i,pitch:+(n[4]||0)}),!0}return!1}),w()(this,"getCurrentHash",function(){var n=window.location.hash.replace("#","");if(t.hashName){var i;return n.split("&").map(function(s){return s.split("=")}).forEach(function(s){s[0]===t.hashName&&(i=s)}),(i&&i[1]||"").split("/")}return n.split("/")}),w()(this,"updateHashUnthrottled",function(){var n=t.getHashString();try{window.history.replaceState(window.history.state,"",n)}catch(i){}}),this.hashName=r&&encodeURIComponent(r),this.updateHash=gk()(this.updateHashUnthrottled,30*1e3/100)}return Yt()(e,[{key:"addTo",value:function(t){return this.map=t,di.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return di.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(t){var n=this.map.getCenter(),i=Math.round(this.map.getZoom()*100)/100,s=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),c=Math.pow(10,s),g=Math.round(n.lng*c)/c,y=Math.round(n.lat*c)/c,E=this.map.getBearing(),T=this.map.getPitch(),I="";if(t?I+="/".concat(g,"/").concat(y,"/").concat(i):I+="".concat(i,"/").concat(y,"/").concat(g),(E||T)&&(I+="/".concat(Math.round(E*10)/10)),T&&(I+="/".concat(Math.round(T))),this.hashName){var F=this.hashName,U=!1,Q=window.location.hash.slice(1).split("&").map(function(ue){var de=ue.split("=")[0];return de===F?(U=!0,"".concat(de,"=").concat(I)):ue}).filter(function(ue){return ue});return U||Q.push("".concat(F,"=").concat(I)),"#".concat(Q.join("&"))}return"#".concat(I)}}]),e}(),_k=yk,ry=null,_0=[],xk=30,z_=1e3/xk,Lm=di.performance,km={create:"create",load:"load",fullLoad:"fullLoad"},ny={mark:function(r){Lm.mark(r)},frame:function(r){var t=r;if(ry!=null){var n=t-ry;_0.push(n)}ry=t},clearMetrics:function(){ry=null,_0=[],Lm.clearMeasures("loadTime"),Lm.clearMeasures("fullLoadTime");for(var r in km)Lm.clearMarks(km[r])},getPerformanceMetrics:function(){var r=Lm.measure("loadTime",km.create,km.load).duration,t=Lm.measure("fullLoadTime",km.create,km.fullLoad).duration,n=_0.length,i=_0.reduce(function(y,E){return y+E},0)/n/1e3,s=1/i,c=_0.filter(function(y){return y>z_}).reduce(function(y,E){return y+(E-z_)/z_},0),g=c/(n+c)*100;return{loadTime:r,fullLoadTime:t,fps:s,percentDroppedFrames:g}}};function OC(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=bk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(E){throw E},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,g;return{s:function(){t=t.call(e)},n:function(){var E=t.next();return s=E.done,E},e:function(E){c=!0,g=E},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(c)throw g}}}}function bk(e,r){if(!!e){if(typeof e=="string")return IC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return IC(e,r)}}function IC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Ek=function(){function e(){Ft()(this,e),w()(this,"queue",void 0),w()(this,"id",void 0),w()(this,"cleared",void 0),w()(this,"currentlyRunning",void 0),this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return Yt()(e,[{key:"add",value:function(t){var n=++this.id,i=this.queue;return i.push({callback:t,id:n,cancelled:!1}),n}},{key:"remove",value:function(t){var n=this.currentlyRunning,i=n?this.queue.concat(n):this.queue,s=OC(i),c;try{for(s.s();!(c=s.n()).done;){var g=c.value;if(g.id===t){g.cancelled=!0;return}}}catch(y){s.e(y)}finally{s.f()}}},{key:"run",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=this.currentlyRunning=this.queue;this.queue=[];var i=OC(n),s;try{for(i.s();!(s=i.n()).done;){var c=s.value;if(!c.cancelled&&(c.callback(t),this.cleared))break}}catch(g){i.e(g)}finally{i.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),e}(),RC=Ek;function Sk(e){var r=Ck();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Ck(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function wk(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}wk(`.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var iy=-2,LC=22,Dm=0,ay=60,Ak={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:iy,maxZoom:LC,minPitch:Dm,maxPitch:ay,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},kC=function(e){qr()(t,e);var r=Sk(t);function t(n){var i;if(Ft()(this,t),i=r.call(this,gs()({},Ak,n)),w()(ce()(i),"doubleClickZoom",void 0),w()(ce()(i),"dragRotate",void 0),w()(ce()(i),"dragPan",void 0),w()(ce()(i),"touchZoomRotate",void 0),w()(ce()(i),"scrollZoom",void 0),w()(ce()(i),"keyboard",void 0),w()(ce()(i),"touchPitch",void 0),w()(ce()(i),"boxZoom",void 0),w()(ce()(i),"handlers",void 0),w()(ce()(i),"container",void 0),w()(ce()(i),"canvas",void 0),w()(ce()(i),"canvasContainer",void 0),w()(ce()(i),"renderTaskQueue",new RC),w()(ce()(i),"frame",void 0),w()(ce()(i),"trackResize",!0),w()(ce()(i),"hash",void 0),w()(ce()(i),"onWindowOnline",function(){i.update()}),w()(ce()(i),"onWindowResize",function(c){i.trackResize&&i.resize({originalEvent:c}).update()}),$i?i.initMiniContainer():i.initContainer(),i.resize(),i.handlers=new PC(ce()(i),i.options),typeof window!="undefined"&&(window.addEventListener("online",i.onWindowOnline,!1),window.addEventListener("resize",i.onWindowResize,!1),window.addEventListener("orientationchange",i.onWindowResize,!1)),!$i){var s=typeof n.hash=="string"&&n.hash||void 0;n.hash&&(i.hash=new _k(s).addTo(ce()(i)))}return(!i.hash||!i.hash.onHashChange())&&(i.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(i.resize(),i.fitBounds(n.bounds,gs()({},n.fitBoundsOptions,{duration:0})))),i}return Yt()(t,[{key:"resize",value:function(i){var s=this.containerDimensions(),c=s[0],g=s[1];if(this.transform.resize(c,g),$i)return this;var y=!this.moving;return y&&(this.stop(),this.emit("movestart",new di.Event("movestart",i)),this.emit("move",new di.Event("move",i))),this.emit("resize",new di.Event("resize",i)),y&&this.emit("moveend",new di.Event("moveend",i)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(i){return this.transform.locationPoint(ru.convert(i))}},{key:"unproject",value:function(i){return this.transform.pointLocation(Co.convert(i))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(i){this.transform.setMaxBounds(g0.convert(i))}},{key:"setStyle",value:function(i){}},{key:"setMinZoom",value:function(i){if(i=i==null?iy:i,i>=iy&&i<=this.transform.maxZoom)return this.transform.minZoom=i,this.getZoom()<i&&this.setZoom(i),this;throw new Error("minZoom must be between ".concat(iy," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(i){if(i=i==null?LC:i,i>=this.transform.minZoom)return this.transform.maxZoom=i,this.getZoom()>i&&this.setZoom(i),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(i){if(i=i==null?Dm:i,i<Dm)throw new Error("minPitch must be greater than or equal to ".concat(Dm));if(i>=Dm&&i<=this.transform.maxPitch)return this.transform.minPitch=i,this.getPitch()<i&&this.setPitch(i),this;throw new Error("minPitch must be between ".concat(Dm," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(i){if(i=i==null?ay:i,i>ay)throw new Error("maxPitch must be less than or equal to ".concat(ay));if(i>=this.transform.minPitch)return this.transform.maxPitch=i,this.getPitch()>i&&this.setPitch(i),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(i){this.transform.renderWorldCopies=!!i}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(i){return this.update(),this.renderTaskQueue.add(i)}},{key:"cancelRenderFrame",value:function(i){return this.renderTaskQueue.remove(i)}},{key:"triggerRepaint",value:function(){var i=this;this.frame||(this.frame=Vg(function(s){ny.frame(s),i.frame=null,i.update(s)}))}},{key:"update",value:function(i){var s=this;this.frame||(this.frame=Vg(function(c){ny.frame(c),s.frame=null,s.renderTaskQueue.run(i)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var i=this.container;i.classList.add("l7-map");var s=this.canvasContainer=j.create("div","l7-canvas-container",i);this.options.interactive&&s.classList.add("l7-interactive")}},{key:"initMiniContainer",value:function(){this.container=this.options.canvas,this.canvasContainer=this.container}},{key:"containerDimensions",value:function(){var i=0,s=0;return this.container&&($i?(i=this.container.width/di.devicePixelRatio,s=this.container.height/di.devicePixelRatio):(i=this.container.clientWidth,s=this.container.clientHeight)),[i,s]}}]),t}(mC);function Tk(e){var r=Mk();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Mk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Pk(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function",n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(i,s):r.documentElement.appendChild(i)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),i.appendChild(c),c}}Pk(`.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var oy=-2,DC=22,Fm=0,sy=60,Ok={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:oy,maxZoom:DC,minPitch:Fm,maxPitch:sy,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},z6=function(e){qr()(t,e);var r=Tk(t);function t(n){var i;return Ft()(this,t),i=r.call(this,gs()({},Ok,n)),w()(ce()(i),"doubleClickZoom",void 0),w()(ce()(i),"dragRotate",void 0),w()(ce()(i),"dragPan",void 0),w()(ce()(i),"touchZoomRotate",void 0),w()(ce()(i),"scrollZoom",void 0),w()(ce()(i),"keyboard",void 0),w()(ce()(i),"touchPitch",void 0),w()(ce()(i),"boxZoom",void 0),w()(ce()(i),"handlers",void 0),w()(ce()(i),"container",void 0),w()(ce()(i),"canvas",void 0),w()(ce()(i),"canvasContainer",void 0),w()(ce()(i),"renderTaskQueue",new RC),w()(ce()(i),"frame",void 0),w()(ce()(i),"trackResize",!0),w()(ce()(i),"onWindowOnline",function(){i.update()}),w()(ce()(i),"onWindowResize",function(s){i.trackResize&&i.resize({originalEvent:s}).update()}),i.initContainer(),i.resize(),i.handlers=new PC(ce()(i),i.options),typeof window!="undefined"&&(window.addEventListener("online",i.onWindowOnline,!1),window.addEventListener("resize",i.onWindowResize,!1),window.addEventListener("orientationchange",i.onWindowResize,!1)),i}return Yt()(t,[{key:"resize",value:function(i){var s=this.containerDimensions(),c=s[0],g=s[1];this.transform.resize(c,g);var y=!this.moving;return y&&(this.stop(),this.emit("movestart",new Event("movestart",i)),this.emit("move",new Event("move",i))),this.emit("resize",new Event("resize",i)),y&&this.emit("moveend",new Event("moveend",i)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(i){return this.transform.locationPoint(ru.convert(i))}},{key:"unproject",value:function(i){return this.transform.pointLocation(Co.convert(i))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(i){this.transform.setMaxBounds(g0.convert(i))}},{key:"setStyle",value:function(i){}},{key:"setMinZoom",value:function(i){if(i=i==null?oy:i,i>=oy&&i<=this.transform.maxZoom)return this.transform.minZoom=i,this.getZoom()<i&&this.setZoom(i),this;throw new Error("minZoom must be between ".concat(oy," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(i){if(i=i==null?DC:i,i>=this.transform.minZoom)return this.transform.maxZoom=i,this.getZoom()>i&&this.setZoom(i),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(i){if(i=i==null?Fm:i,i<Fm)throw new Error("minPitch must be greater than or equal to ".concat(Fm));if(i>=Fm&&i<=this.transform.maxPitch)return this.transform.minPitch=i,this.getPitch()<i&&this.setPitch(i),this;throw new Error("minPitch must be between ".concat(Fm," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(i){if(i=i==null?sy:i,i>sy)throw new Error("maxPitch must be less than or equal to ".concat(sy));if(i>=this.transform.minPitch)return this.transform.maxPitch=i,this.getPitch()>i&&this.setPitch(i),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(i){this.transform.renderWorldCopies=!!i}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(i){return this.update(),this.renderTaskQueue.add(i)}},{key:"cancelRenderFrame",value:function(i){return this.renderTaskQueue.remove(i)}},{key:"triggerRepaint",value:function(){var i=this;this.frame||(this.frame=Vg(function(s){ny.frame(s),i.frame=null,i.update(s)}))}},{key:"update",value:function(i){var s=this;this.frame||(this.frame=Vg(function(c){ny.frame(c),s.frame=null,s.renderTaskQueue.run(i)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var i=this.container;i.classList.add("l7-map");var s=this.canvasContainer=j.create("div","l7-canvas-container",i);this.options.interactive&&s.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var i=0,s=0;return this.container&&(i=this.container.clientWidth||400,s=this.container.clientHeight||300),[i,s]}},{key:"resizeCanvas",value:function(i,s){var c=j.DPR||1;this.canvas.width=c*i,this.canvas.height=c*s,this.canvas.style.width="".concat(i,"px"),this.canvas.style.height="".concat(s,"px")}}]),t}(mC),FC=function(){function e(){Ft()(this,e),w()(this,"viewport",void 0)}return Yt()(e,[{key:"syncWithMapCamera",value:function(t){var n=t.center,i=t.zoom,s=t.pitch,c=t.bearing,g=t.viewportHeight,y=t.viewportWidth;this.viewport=new C_({width:y,height:g,longitude:n&&n[0],latitude:n&&n[1],zoom:i,pitch:s,bearing:c})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,n){return this.viewport.projectFlat(t,n)}}]),e}(),BC={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Ik=["id","attributionControl","style","rotation","mapInstance"],Rk=["id","attributionControl","style","rotation","mapInstance","canvas","hasBaseMap"],NC,zC,UC,jC,VC,GC,Bm,HC,WC,ZC,XC;function YC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function KC(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?YC(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):YC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var $C={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},qC=12,Lk=(NC=Object(Cr.injectable)(),zC=Object(Cr.inject)(sr.MapConfig),UC=Object(Cr.inject)(sr.IGlobalConfigService),jC=Object(Cr.inject)(sr.ICoordinateSystemService),VC=Object(Cr.inject)(sr.IEventEmitter),NC(GC=(Bm=function(){function e(){var r=this;Ft()(this,e),w()(this,"version",Xp.L7MAP),w()(this,"map",void 0),w()(this,"dragging",!1),w()(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),Di()(this,"config",HC,this),Di()(this,"configService",WC,this),Di()(this,"coordinateSystemService",ZC,this),Di()(this,"eventEmitter",XC,this),w()(this,"viewport",void 0),w()(this,"markerContainer",void 0),w()(this,"cameraChangedCallback",void 0),w()(this,"$mapContainer",void 0),w()(this,"handleMiniCameraChanged",function(t,n,i,s,c){var g=r.config.offsetCoordinate,y=g===void 0?!0:g;r.viewport.syncWithMapCamera({bearing:s,center:[t,n],viewportHeight:r.map.transform.height,pitch:c,viewportWidth:r.map.transform.width,zoom:i,cameraHeight:0}),r.viewport.getZoom()>qC&&y?r.coordinateSystemService.setCoordinateSystem(zu.LNGLAT_OFFSET):r.coordinateSystemService.setCoordinateSystem(zu.LNGLAT),r.cameraChangedCallback(r.viewport)}),w()(this,"handleCameraChanged",function(){var t=r.map.getCenter(),n=t.lat,i=t.lng,s=r.config.offsetCoordinate,c=s===void 0?!0:s;r.emit("mapchange"),r.viewport.syncWithMapCamera({bearing:r.map.getBearing(),center:[i,n],viewportHeight:r.map.transform.height,pitch:r.map.getPitch(),viewportWidth:r.map.transform.width,zoom:r.map.getZoom(),cameraHeight:0}),r.viewport.getZoom()>qC&&c?r.coordinateSystemService.setCoordinateSystem(zu.LNGLAT_OFFSET):r.coordinateSystemService.setCoordinateSystem(zu.LNGLAT),r.cameraChangedCallback(r.viewport)})}return Yt()(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"addMarkerContainer",value:function(){var t=this.map.getCanvasContainer();this.markerContainer=j.create("div","l7-marker-container",t),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,n){mm.indexOf(t)!==-1?this.eventEmitter.on(t,n):this.map.on($C[t]||t,n)}},{key:"off",value:function(t,n){this.map.off($C[t]||t,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var t=this.map.transform;return[t.width,t.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(t){return this.map.setZoom(t)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(t){this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(t){this.map.setBearing(t)}},{key:"zoomIn",value:function(t,n){this.map.zoomIn(t,n)}},{key:"zoomOut",value:function(t,n){this.map.zoomOut(t,n)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.panTo([t,n])}},{key:"fitBounds",value:function(t,n){this.map.fitBounds(t,n)}},{key:"setMaxZoom",value:function(t){this.map.setMaxZoom(t)}},{key:"setMinZoom",value:function(t){this.map.setMinZoom(t)}},{key:"setMapStatus",value:function(t){t.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),t.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),t.dragEnable===!1&&this.map.dragPan.disable(),t.dragEnable===!0&&this.map.dragPan.enable(),t.rotateEnable===!1&&this.map.dragRotate.disable(),t.dragEnable===!0&&this.map.dragRotate.enable(),t.keyboardEnable===!1&&this.map.keyboard.disable(),t.keyboardEnable===!0&&this.map.keyboard.enable(),t.zoomEnable===!1&&this.map.scrollZoom.disable(),t.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(t,n){this.map.flyTo({zoom:t,center:n})}},{key:"setMapStyle",value:function(t){this.map.setStyle(this.getMapStyle(t))}},{key:"pixelToLngLat",value:function(t){return this.map.unproject(t)}},{key:"lngLatToPixel",value:function(t){return this.map.project(t)}},{key:"containerToLngLat",value:function(t){return this.map.unproject(t)}},{key:"lngLatToContainer",value:function(t){return this.map.project(t)}},{key:"lngLatToMercator",value:function(t,n){throw new Error("not implement")}},{key:"getModelMatrix",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var r=tu()(Na.a.mark(function n(){var i=this,s,c,g,y,E,T,I,F,U,Q,ue;return Na.a.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:s=this.config,c=s.id,g=c===void 0?"map":c,y=s.attributionControl,E=y===void 0?!1:y,T=s.style,I=T===void 0?"light":T,F=s.rotation,U=F===void 0?0:F,Q=s.mapInstance,ue=xp()(s,Ik),this.viewport=new FC,Q?(this.map=Q,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(g),this.map=new kC(KC({container:this.$mapContainer,style:this.getMapStyle(I),bearing:U},ue))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.map.on("dragstart",function(){return i.dragging=!0,""}),this.map.on("dragend",function(){return i.dragging=!1,""}),this.handleCameraChanged();case 8:case"end":return Re.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"initMiniMap",value:function(){var r=tu()(Na.a.mark(function n(){var i=this,s,c,g,y,E,T,I,F,U,Q,ue,de,Re,et,ht,xt;return Na.a.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:s=this.config,c=s.id,g=c===void 0?"map":c,y=s.attributionControl,E=y===void 0?!1:y,T=s.style,I=T===void 0?"light":T,F=s.rotation,U=F===void 0?0:F,Q=s.mapInstance,ue=s.canvas,de=ue===void 0?null:ue,Re=s.hasBaseMap,et=Re===void 0?!1:Re,ht=xp()(s,Rk),this.viewport=new FC,this.$mapContainer=de,this.map=new kC(KC({container:this.$mapContainer,style:this.getMapStyle(I),bearing:U,canvas:de},ht)),et?(xt=this.map.getCenter(),this.handleMiniCameraChanged(xt.lng,xt.lat,this.map.getZoom(),this.map.getBearing(),this.map.getPitch()),di.document.addEventListener("mapCameaParams",function(Qt){var fr=Qt.e,Gr=fr.longitude,Jr=fr.latitude,Ur=fr.scale,Xn=fr.bearing,ni=fr.pitch;i.handleMiniCameraChanged(Gr,Jr,Ur-1.25,Xn,ni)})):(this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged());case 5:case"end":return jt.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"destroy",value:function(){var t,n;(t=this.$mapContainer)===null||t===void 0||(n=t.parentNode)===null||n===void 0||n.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).emit.apply(n,[t].concat(s))}},{key:"once",value:function(t){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];(n=this.eventEmitter).once.apply(n,[t].concat(s))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(t){var n=this.map.getCanvas(),i=t==="jpg"?n==null?void 0:n.toDataURL("image/jpeg"):n==null?void 0:n.toDataURL("image/png");return i}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"creatAmapContainer",value:function(t){var n=t;return typeof t=="string"&&(n=document.getElementById(t)),n}},{key:"getMapStyle",value:function(t){return typeof t!="string"?t:BC[t]?BC[t]:t}}]),e}(),HC=Vi()(Bm.prototype,"config",[zC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WC=Vi()(Bm.prototype,"configService",[UC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZC=Vi()(Bm.prototype,"coordinateSystemService",[jC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XC=Vi()(Bm.prototype,"eventEmitter",[VC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bm))||GC);function kk(e){var r=Dk();return function(){var n=wt()(e),i;if(r){var s=wt()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hn()(this,i)}}function Dk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Fk=function(e){qr()(t,e);var r=kk(t);function t(){return Ft()(this,t),r.apply(this,arguments)}return Yt()(t,[{key:"getServiceConstructor",value:function(){return Lk}}]),t}(kg);function QC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function JC(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?QC(Object(t),!0).forEach(function(n){Bk(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):QC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Bk(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Nk(e,r){return Vk(e)||jk(e,r)||Uk(e,r)||zk()}function zk(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uk(e,r){if(!!e){if(typeof e=="string")return ew(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ew(e,r)}}function ew(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function jk(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,g;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(y){s=!0,g=y}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw g}}return n}}function Vk(e){if(Array.isArray(e))return e}var Gk=pe.a.memo(function(e){var r=e.style,t=e.className,n=e.map,i=e.option,s=e.onSceneLoaded,c=e.children,g=Object(te.useRef)(null),y=Object(te.useState)(),E=Nk(y,2),T=E[0],I=E[1];return Object(te.useEffect)(function(){var F=new e0(JC(JC({id:g.current},i),{},{map:new Fk(n)}));return F.on("loaded",function(){I(F),s&&s(F)}),function(){F.destroy()}},[]),Object(te.useEffect)(function(){T&&n.style&&T.setMapStyle(n.style)},[JSON.stringify(n.style)]),Object(te.useEffect)(function(){T&&n.zoom&&T.setZoom(n.zoom)},[n.zoom]),Object(te.useEffect)(function(){T&&n.center&&T.setCenter(n.center)},[JSON.stringify(n.center)]),Object(te.useEffect)(function(){T&&n.pitch&&T.setPitch(n.pitch)},[n.pitch]),Object(te.useEffect)(function(){T&&n.rotation&&T.setRotation(n.rotation)},[n.rotation]),pe.a.createElement(Oe.Provider,{value:T},pe.a.createElement("div",{ref:g,className:t,style:r},T&&c))}),U6=Gk;function Hk(e,r){return Yk(e)||Xk(e,r)||Zk(e,r)||Wk()}function Wk(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zk(e,r){if(!!e){if(typeof e=="string")return tw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return tw(e,r)}}function tw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Xk(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,g;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(y){s=!0,g=y}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw g}}return n}}function Yk(e){if(Array.isArray(e))return e}var j6=pe.a.memo(function(e){var r=e.style,t=e.className,n=e.map,i=e.children,s=Object(te.useRef)(null),c=Object(te.useState)(),g=Hk(c,2),y=g[0],E=g[1];return Object(te.useEffect)(function(){var T=new e0({id:s.current,map:n});return T.on("loaded",function(){E(T)}),function(){T.destroy()}},[]),pe.a.createElement(Oe.Provider,{value:y},pe.a.createElement("div",{ref:s,className:t,style:r},y&&i))}),Kk=["type","position"];function rw(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function U_(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?rw(Object(t),!0).forEach(function(n){$k(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):rw(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function $k(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function qk(e,r){if(e==null)return{};var t=Qk(e,r),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(t[n]=e[n]))}return t}function Qk(e,r){if(e==null)return{};var t={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(r.indexOf(i)>=0)&&(t[i]=e[i]);return t}var V6=pe.a.memo(function(r){var t=Ae(),n=Object(te.useRef)(),i=r.type,s=r.position,c=qk(r,Kk);return Object(te.useEffect)(function(){var g;switch(i){case"scale":g=new eT({position:s||"bottomright"});break;case"zoom":g=new nT(U_({position:s||"topright"},c));break;case"logo":g=new sx(U_({position:s||"bottomleft"},c));case"layer":g=new KA(U_({position:s||"bottomleft"},c))}return n.current=g,t.addControl(g),function(){n.current=void 0,t.removeControl(g)}},[i]),Object(te.useEffect)(function(){n.current&&n.current.setPosition(s||"bottomleft")},[s]),null}),j_=M("i8i4");function nw(e,r){return rD(e)||tD(e,r)||eD(e,r)||Jk()}function Jk(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eD(e,r){if(!!e){if(typeof e=="string")return iw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return iw(e,r)}}function iw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function tD(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,g;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(y){s=!0,g=y}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw g}}return n}}function rD(e){if(Array.isArray(e))return e}var aw=te.useEffect,ow=te.useState,nD=/\B([A-Z])/g,iD=function(r){return r.replace(nD,"-$1").toLowerCase()};function G6(e){var r=e.className,t=e.style,n=e.children,i=e.position,s=ow(),c=nw(s,2),g=c[0],y=c[1],E=Ae(),T=ow(function(){return document.createElement("div")}),I=nw(T,1),F=I[0];return aw(function(){var U=new $m({position:i});return U.onAdd=function(){if(r&&(F.className=r),t){var Q=Object.keys(t).map(function(ue){return"".concat(iD(ue),":").concat(t[ue])}).join(";");F.style.cssText=Q}return F},U.onRemove=function(){},y(U),E.addControl(U),function(){E.removeControl(U)}},[]),aw(function(){g&&g.setPosition(i||"bottomleft")},[i]),Object(j_.createPortal)(n,F)}var sw=Object(te.createContext)({});function aD(){return Object(te.useContext)(sw)}var Yp=M("LvDl"),H6=te.useEffect,oD=te.memo(function(r){var t=r.layer,n=r.active;return t.active(n.option),null},Yp.isEqual),W6=te.useEffect,sD=te.memo(function(r){var t=r.layer,n=r.animate;return t.animate(n),null},Yp.isEqual),Z6=te.useEffect,uD=te.memo(function(r){var t=r.layer,n=r.color;return n.field?t.color(n.field,n.values):t.color(n.values),null},Yp.isEqual),lD=te.memo(function(r){var t=r.layer,n=r.filter;return n.field&&t.filter(n.field,n.values),null},Yp.isEqual),cD=te.memo(function(r){var t=r.layer,n=r.scale;return t.scale(n.values),null},Yp.isEqual),X6=te.useEffect,fD=te.memo(function(r){var t=r.layer,n=r.select;return t.select(n.option),null},Yp.isEqual),hD=te.memo(function(r){var t=r.layer,n=r.shape;return n.field?t.shape(n.field,n.values):t.shape(n.values),null},Yp.isEqual),pD=te.memo(function(r){var t=r.layer,n=r.size;return n.field?t.size(n.field,n.values):t.size(n.values),null},Yp.isEqual),dD=["data"];function vD(e,r){if(e==null)return{};var t=mD(e,r),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(t[n]=e[n]))}return t}function mD(e,r){if(e==null)return{};var t={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(r.indexOf(i)>=0)&&(t[i]=e[i]);return t}var gD=te.memo(function(r){var t=r.layer,n=r.source,i=n.data,s=vD(n,dD);return t.inited?t.setData(i,s):t.source(i,s),s.autoFit&&t.fitBounds(s&&s.fitBoundsOptions),null},Yp.isEqual),Y6=te.useEffect,yD=te.memo(function(r){var t=r.layer,n=r.style;return t.style(n),null},Yp.isEqual);function _D(e,r){return SD(e)||ED(e,r)||bD(e,r)||xD()}function xD(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bD(e,r){if(!!e){if(typeof e=="string")return uw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return uw(e,r)}}function uw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function ED(e,r){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,c,g;try{for(t=t.call(e);!(i=(c=t.next()).done)&&(n.push(c.value),!(r&&n.length===r));i=!0);}catch(y){s=!0,g=y}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw g}}return n}}function SD(e){if(Array.isArray(e))return e}var x0=te.useEffect,CD=te.useState;function $v(e,r){var t=r.source,n=r.color,i=r.shape,s=r.style,c=r.size,g=r.scale,y=r.active,E=r.select,T=r.filter,I=r.animate,F=r.options,U=r.onLayerLoaded,Q=Ae(),ue=CD(function(){var et;switch(e){case"polygonLayer":et=new Pb(F);break;case"lineLayer":et=new QP(F);break;case"pointLayer":et=new HO(F);break;case"heatmapLayer":et=new WM(F);break;case"rasterLayer":et=new gI(F);break;case"imageLayer":et=new tP(F);break;case"citybuildingLayer":et=new mM(F);break;default:et=new Pb(F)}return et.on("inited",function(){U&&U(et,Q)}),et}),de=_D(ue,1),Re=de[0];return x0(function(){return Q.addLayer(Re),function(){Q.removeLayer(Re)}},[]),x0(function(){Re.inited&&F&&Re.updateLayerConfig(F)},[F==null?void 0:F.minZoom,F==null?void 0:F.maxZoom,F==null?void 0:F.visible]),x0(function(){Re.inited&&(F==null?void 0:F.zIndex)&&Re.setIndex(F.zIndex)},[F==null?void 0:F.zIndex]),x0(function(){Re.inited&&(F==null?void 0:F.blend)&&Re.setBlend(F.blend)},[F==null?void 0:F.blend]),x0(function(){Q.render()}),te.createElement(sw.Provider,{value:Re},te.createElement(gD,{layer:Re,source:t}),g&&te.createElement(cD,{layer:Re,scale:g}),n&&te.createElement(uD,{layer:Re,color:n}),c&&te.createElement(pD,{layer:Re,size:c}),i&&te.createElement(hD,{layer:Re,shape:i}),s&&te.createElement(yD,{layer:Re,style:s}),y&&te.createElement(oD,{layer:Re,active:y}),E&&te.createElement(fD,{layer:Re,select:E}),T&&te.createElement(lD,{layer:Re,filter:T}),I&&te.createElement(sD,{layer:Re,animate:I}),r.children)}var K6=te.memo(function(r){return $v("polygonLayer",r)}),$6=te.memo(function(r){return $v("lineLayer",r)}),wD=te.memo(function(r){return $v("pointLayer",r)}),AD=te.memo(function(r){return $v("heatmapLayer",r)}),q6=te.memo(function(r){return $v("rasterLayer",r)}),Q6=te.memo(function(r){return $v("imageLayer",r)}),J6=te.memo(function(r){return $v("citybuildingLayer",r)}),TD=te.useEffect,eB=te.memo(function(e){var r=e.type,t=e.handler,n=aD();return TD(function(){return n.off(r,t),n.on(r,t),function(){n.off(r,t)}},[r,t]),null}),tB=te.memo(function(e){var r=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}],t=e.items,n=t===void 0?r:t;return te.createElement("div",null,te.createElement("div",null,n.map(function(i,s){return te.createElement("div",{key:s,style:{background:i.color,height:"100%",display:"inline-block",cursor:"pointer",width:""+(100-n.length)/n.length+"%",marginRight:"1%",padding:5}})})),te.createElement("div",null,n.map(function(i,s){return te.createElement("div",{key:s,style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:""+(100-n.length)/n.length+"%",marginRight:"1%"}},i.title)})))});function uy(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?uy=function(t){return typeof t}:uy=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uy(e)}function lw(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function ly(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?lw(Object(t),!0).forEach(function(n){MD(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):lw(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function MD(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function PD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function cw(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function OD(e,r,t){return r&&cw(e.prototype,r),t&&cw(e,t),e}function ID(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&V_(e,r)}function V_(e,r){return V_=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},V_(e,r)}function RD(e){var r=DD();return function(){var n=cy(e),i;if(r){var s=cy(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return LD(this,i)}}function LD(e,r){if(r&&(uy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kD(e)}function kD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DD(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function cy(e){return cy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},cy(e)}var rB=function(e){ID(t,e);var r=RD(t);function t(n){var i;return PD(this,t),i=r.call(this,n),i.el=void 0,i.scene=void 0,i.popup=void 0,i.el=document.createElement("div"),i}return OD(t,[{key:"componentDidMount",value:function(){var i,s=this.props,c=s.lnglat,g=s.children,y=s.option,E=s.lngLat,T=new vx(ly(ly({},y),{},{stopPropagation:(i=this.props.option)===null||i===void 0?void 0:i.stopPropagation}));c&&T.setLnglat(c),E&&T.setLnglat(E),g&&T.setDOMContent(this.el),this.popup=T,this.scene.addPopup(T)}},{key:"componentDidUpdate",value:function(i){var s,c,g,y,E,T,I=Array.isArray(i.lnglat)?i.lnglat:[i==null||(s=i.lnglat)===null||s===void 0?void 0:s.lng,i==null||(c=i.lnglat)===null||c===void 0?void 0:c.lat],F=Array.isArray(this.props.lnglat)?this.props.lnglat:[(g=this.props)===null||g===void 0||(y=g.lnglat)===null||y===void 0?void 0:y.lng,(E=this.props)===null||E===void 0||(T=E.lnglat)===null||T===void 0?void 0:T.lat],U=I.toString()!==F.toString();if(U){var Q;this.popup.remove(),this.popup=new vx(ly(ly({},this.props.option),{},{stopPropagation:(Q=this.props.option)===null||Q===void 0?void 0:Q.stopPropagation})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup)}}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var i=this;return te.createElement(Oe.Consumer,{},function(s){return s&&(i.scene=s),Object(j_.createPortal)(i.props.children,i.el)})}}]),t}(te.PureComponent);function fy(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?fy=function(t){return typeof t}:fy=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fy(e)}function FD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function fw(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function BD(e,r,t){return r&&fw(e.prototype,r),t&&fw(e,t),e}function ND(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&G_(e,r)}function G_(e,r){return G_=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},G_(e,r)}function zD(e){var r=VD();return function(){var n=hy(e),i;if(r){var s=hy(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return UD(this,i)}}function UD(e,r){if(r&&(fy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jD(e)}function jD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VD(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function hy(e){return hy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},hy(e)}var nB=function(e){ND(t,e);var r=zD(t);function t(n){var i;return FD(this,t),i=r.call(this,n),i.el=void 0,i.scene=void 0,i.marker=void 0,i.el=document.createElement("div"),i}return BD(t,[{key:"componentDidMount",value:function(){var i=this.props,s=i.lnglat,c=i.children,g=i.option,y=i.onMarkerLoaded,E=new cx(g);s&&E.setLnglat(s),c&&E.setElement(this.el),this.marker=E,y&&y(E),this.scene.addMarker(E)}},{key:"componentDidUpdate",value:function(i){var s,c=(i==null?void 0:i.lnglat.toString())!==((s=this.props)===null||s===void 0?void 0:s.lnglat.toString());c&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var i=this;return te.createElement(Oe.Consumer,{},function(s){return s&&(i.scene=s),Object(j_.createPortal)(i.props.children,i.el)})}}]),t}(te.PureComponent),GD=te.useEffect,HD=te.memo(function(e){var r=e.type,t=e.handler,n=Ae();return GD(function(){return n.on(r,t),function(){n.off(r,t)}},[r]),null}),iB=HD,WD=te.useEffect,aB=te.memo(function(r){var t=r.name,n=r.url,i=Ae();return WD(function(){i.addImage(t,n)},[t,n]),null})},"6AGu":function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingInSyntax=void 0;var j=M("FV85"),Z=M("LKzl"),Y=function(){function k(h){this._binding=h}return k.prototype.inRequestScope=function(){return this._binding.scope=j.BindingScopeEnum.Request,new Z.BindingWhenOnSyntax(this._binding)},k.prototype.inSingletonScope=function(){return this._binding.scope=j.BindingScopeEnum.Singleton,new Z.BindingWhenOnSyntax(this._binding)},k.prototype.inTransientScope=function(){return this._binding.scope=j.BindingScopeEnum.Transient,new Z.BindingWhenOnSyntax(this._binding)},k}();$.BindingInSyntax=Y},"6D9b":function(le,$,M){},"6acW":function(le,$,M){var j=M("dt0z"),Z=M("gQMU");function Y(k){return Z(j(k).toLowerCase())}le.exports=Y},"6nK8":function(le,$,M){var j=M("dVn5"),Z=M("fo6e"),Y=M("dt0z"),k=M("9NmV");function h(V,H,te){return V=Y(V),H=te?void 0:H,H===void 0?Z(V)?k(V):j(V):V.match(H)||[]}le.exports=h},"711d":function(le,$){function M(j){return function(Z){return Z==null?void 0:Z[j]}}le.exports=M},"78VC":function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.multiBindToService=void 0;var j=function(Y){return function(k){return function(){for(var h=[],V=0;V<arguments.length;V++)h[V]=arguments[V];return h.forEach(function(H){return Y.bind(H).toService(k)})}}};$.multiBindToService=j},"7Ix3":function(le,$){function M(j){var Z=[];if(j!=null)for(var Y in Object(j))Z.push(Y);return Z}le.exports=M},"7W2i":function(le,$,M){var j=M("SksO");function Z(Y,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(k&&k.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),Object.defineProperty(Y,"prototype",{writable:!1}),k&&j(Y,k)}le.exports=Z,le.exports.__esModule=!0,le.exports.default=le.exports},"7tbW":function(le,$,M){var j=M("LGYb");function Z(Y){return Y&&Y.length?j(Y):[]}le.exports=Z},"88Gu":function(le,$){var M=800,j=16,Z=Date.now;function Y(k){var h=0,V=0;return function(){var H=Z(),te=j-(H-V);if(V=H,te>0){if(++h>=M)return arguments[0]}else h=0;return k.apply(void 0,arguments)}}le.exports=Y},"9Fde":function(le,$,M){"use strict";var j=this&&this.__awaiter||function(He,dt,ct,_t){function ee(rr){return rr instanceof ct?rr:new ct(function(Fr){Fr(rr)})}return new(ct||(ct=Promise))(function(rr,Fr){function Mr(zt){try{ze(_t.next(zt))}catch(Kt){Fr(Kt)}}function Nt(zt){try{ze(_t.throw(zt))}catch(Kt){Fr(Kt)}}function ze(zt){zt.done?rr(zt.value):ee(zt.value).then(Mr,Nt)}ze((_t=_t.apply(He,dt||[])).next())})},Z=this&&this.__generator||function(He,dt){var ct={label:0,sent:function(){if(rr[0]&1)throw rr[1];return rr[1]},trys:[],ops:[]},_t,ee,rr,Fr;return Fr={next:Mr(0),throw:Mr(1),return:Mr(2)},typeof Symbol=="function"&&(Fr[Symbol.iterator]=function(){return this}),Fr;function Mr(ze){return function(zt){return Nt([ze,zt])}}function Nt(ze){if(_t)throw new TypeError("Generator is already executing.");for(;ct;)try{if(_t=1,ee&&(rr=ze[0]&2?ee.return:ze[0]?ee.throw||((rr=ee.return)&&rr.call(ee),0):ee.next)&&!(rr=rr.call(ee,ze[1])).done)return rr;switch(ee=0,rr&&(ze=[ze[0]&2,rr.value]),ze[0]){case 0:case 1:rr=ze;break;case 4:return ct.label++,{value:ze[1],done:!1};case 5:ct.label++,ee=ze[1],ze=[0];continue;case 7:ze=ct.ops.pop(),ct.trys.pop();continue;default:if(rr=ct.trys,!(rr=rr.length>0&&rr[rr.length-1])&&(ze[0]===6||ze[0]===2)){ct=0;continue}if(ze[0]===3&&(!rr||ze[1]>rr[0]&&ze[1]<rr[3])){ct.label=ze[1];break}if(ze[0]===6&&ct.label<rr[1]){ct.label=rr[1],rr=ze;break}if(rr&&ct.label<rr[2]){ct.label=rr[2],ct.ops.push(ze);break}rr[2]&&ct.ops.pop(),ct.trys.pop();continue}ze=dt.call(He,ct)}catch(zt){ze=[6,zt],ee=0}finally{_t=rr=0}if(ze[0]&5)throw ze[1];return{value:ze[0]?ze[1]:void 0,done:!0}}},Y=this&&this.__spreadArray||function(He,dt){for(var ct=0,_t=dt.length,ee=He.length;ct<_t;ct++,ee++)He[ee]=dt[ct];return He};Object.defineProperty($,"__esModule",{value:!0}),$.Container=void 0;var k=M("LgvC"),h=M("MON2"),V=M("FV85"),H=M("xfSm"),te=M("wnjb"),pe=M("h7MG"),Oe=M("aPG5"),Ae=M("gzZq"),vt=M("d9O0"),at=M("ujMp"),gt=M("HpQ9"),yt=M("AwBQ"),St=function(){function He(dt){this._appliedMiddleware=[];var ct=dt||{};if(typeof ct!="object")throw new Error(""+h.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(ct.defaultScope===void 0)ct.defaultScope=V.BindingScopeEnum.Transient;else if(ct.defaultScope!==V.BindingScopeEnum.Singleton&&ct.defaultScope!==V.BindingScopeEnum.Transient&&ct.defaultScope!==V.BindingScopeEnum.Request)throw new Error(""+h.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(ct.autoBindInjectable===void 0)ct.autoBindInjectable=!1;else if(typeof ct.autoBindInjectable!="boolean")throw new Error(""+h.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(ct.skipBaseClassChecks===void 0)ct.skipBaseClassChecks=!1;else if(typeof ct.skipBaseClassChecks!="boolean")throw new Error(""+h.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:ct.autoBindInjectable,defaultScope:ct.defaultScope,skipBaseClassChecks:ct.skipBaseClassChecks},this.id=vt.id(),this._bindingDictionary=new yt.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new te.MetadataReader}return He.merge=function(dt,ct){for(var _t=[],ee=2;ee<arguments.length;ee++)_t[ee-2]=arguments[ee];var rr=new He,Fr=Y([dt,ct],_t).map(function(ze){return pe.getBindingDictionary(ze)}),Mr=pe.getBindingDictionary(rr);function Nt(ze,zt){ze.traverse(function(Kt,vr){vr.forEach(function(jr){zt.add(jr.serviceIdentifier,jr.clone())})})}return Fr.forEach(function(ze){Nt(ze,Mr)}),rr},He.prototype.load=function(){for(var dt=[],ct=0;ct<arguments.length;ct++)dt[ct]=arguments[ct];for(var _t=this._getContainerModuleHelpersFactory(),ee=0,rr=dt;ee<rr.length;ee++){var Fr=rr[ee],Mr=_t(Fr.id);Fr.registry(Mr.bindFunction,Mr.unbindFunction,Mr.isboundFunction,Mr.rebindFunction)}},He.prototype.loadAsync=function(){for(var dt=[],ct=0;ct<arguments.length;ct++)dt[ct]=arguments[ct];return j(this,void 0,void 0,function(){var _t,ee,rr,Fr,Mr;return Z(this,function(Nt){switch(Nt.label){case 0:_t=this._getContainerModuleHelpersFactory(),ee=0,rr=dt,Nt.label=1;case 1:return ee<rr.length?(Fr=rr[ee],Mr=_t(Fr.id),[4,Fr.registry(Mr.bindFunction,Mr.unbindFunction,Mr.isboundFunction,Mr.rebindFunction)]):[3,4];case 2:Nt.sent(),Nt.label=3;case 3:return ee++,[3,1];case 4:return[2]}})})},He.prototype.unload=function(){for(var dt=this,ct=[],_t=0;_t<arguments.length;_t++)ct[_t]=arguments[_t];var ee=function(Fr){return function(Mr){return Mr.moduleId===Fr}};ct.forEach(function(rr){var Fr=ee(rr.id);dt._bindingDictionary.removeByCondition(Fr)})},He.prototype.bind=function(dt){var ct=this.options.defaultScope||V.BindingScopeEnum.Transient,_t=new k.Binding(dt,ct);return this._bindingDictionary.add(dt,_t),new Ae.BindingToSyntax(_t)},He.prototype.rebind=function(dt){return this.unbind(dt),this.bind(dt)},He.prototype.unbind=function(dt){try{this._bindingDictionary.remove(dt)}catch(ct){throw new Error(h.CANNOT_UNBIND+" "+at.getServiceIdentifierAsString(dt))}},He.prototype.unbindAll=function(){this._bindingDictionary=new yt.Lookup},He.prototype.isBound=function(dt){var ct=this._bindingDictionary.hasKey(dt);return!ct&&this.parent&&(ct=this.parent.isBound(dt)),ct},He.prototype.isBoundNamed=function(dt,ct){return this.isBoundTagged(dt,H.NAMED_TAG,ct)},He.prototype.isBoundTagged=function(dt,ct,_t){var ee=!1;if(this._bindingDictionary.hasKey(dt)){var rr=this._bindingDictionary.get(dt),Fr=pe.createMockRequest(this,dt,ct,_t);ee=rr.some(function(Mr){return Mr.constraint(Fr)})}return!ee&&this.parent&&(ee=this.parent.isBoundTagged(dt,ct,_t)),ee},He.prototype.snapshot=function(){this._snapshots.push(gt.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},He.prototype.restore=function(){var dt=this._snapshots.pop();if(dt===void 0)throw new Error(h.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=dt.bindings,this._middleware=dt.middleware},He.prototype.createChild=function(dt){var ct=new He(dt||this.options);return ct.parent=this,ct},He.prototype.applyMiddleware=function(){for(var dt=[],ct=0;ct<arguments.length;ct++)dt[ct]=arguments[ct];this._appliedMiddleware=this._appliedMiddleware.concat(dt);var _t=this._middleware?this._middleware:this._planAndResolve();this._middleware=dt.reduce(function(ee,rr){return rr(ee)},_t)},He.prototype.applyCustomMetadataReader=function(dt){this._metadataReader=dt},He.prototype.get=function(dt){return this._get(!1,!1,V.TargetTypeEnum.Variable,dt)},He.prototype.getTagged=function(dt,ct,_t){return this._get(!1,!1,V.TargetTypeEnum.Variable,dt,ct,_t)},He.prototype.getNamed=function(dt,ct){return this.getTagged(dt,H.NAMED_TAG,ct)},He.prototype.getAll=function(dt){return this._get(!0,!0,V.TargetTypeEnum.Variable,dt)},He.prototype.getAllTagged=function(dt,ct,_t){return this._get(!1,!0,V.TargetTypeEnum.Variable,dt,ct,_t)},He.prototype.getAllNamed=function(dt,ct){return this.getAllTagged(dt,H.NAMED_TAG,ct)},He.prototype.resolve=function(dt){var ct=this.createChild();return ct.bind(dt).toSelf(),this._appliedMiddleware.forEach(function(_t){ct.applyMiddleware(_t)}),ct.get(dt)},He.prototype._getContainerModuleHelpersFactory=function(){var dt=this,ct=function(Nt,ze){Nt._binding.moduleId=ze},_t=function(Nt){return function(ze){var zt=dt.bind.bind(dt),Kt=zt(ze);return ct(Kt,Nt),Kt}},ee=function(Nt){return function(ze){var zt=dt.unbind.bind(dt);zt(ze)}},rr=function(Nt){return function(ze){var zt=dt.isBound.bind(dt);return zt(ze)}},Fr=function(Nt){return function(ze){var zt=dt.rebind.bind(dt),Kt=zt(ze);return ct(Kt,Nt),Kt}};return function(Mr){return{bindFunction:_t(Mr),isboundFunction:rr(Mr),rebindFunction:Fr(Mr),unbindFunction:ee(Mr)}}},He.prototype._get=function(dt,ct,_t,ee,rr,Fr){var Mr=null,Nt={avoidConstraints:dt,contextInterceptor:function(zt){return zt},isMultiInject:ct,key:rr,serviceIdentifier:ee,targetType:_t,value:Fr};if(this._middleware){if(Mr=this._middleware(Nt),Mr==null)throw new Error(h.INVALID_MIDDLEWARE_RETURN)}else Mr=this._planAndResolve()(Nt);return Mr},He.prototype._planAndResolve=function(){var dt=this;return function(ct){var _t=pe.plan(dt._metadataReader,dt,ct.isMultiInject,ct.targetType,ct.serviceIdentifier,ct.key,ct.value,ct.avoidConstraints);_t=ct.contextInterceptor(_t);var ee=Oe.resolve(_t);return ee}},He}();$.Container=St},"9NmV":function(le,$){var M="\\ud800-\\udfff",j="\\u0300-\\u036f",Z="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",k=j+Z+Y,h="\\u2700-\\u27bf",V="a-z\\xdf-\\xf6\\xf8-\\xff",H="\\xac\\xb1\\xd7\\xf7",te="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",pe="\\u2000-\\u206f",Oe=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ae="A-Z\\xc0-\\xd6\\xd8-\\xde",vt="\\ufe0e\\ufe0f",at=H+te+pe+Oe,gt="['\u2019]",yt="["+at+"]",St="["+k+"]",He="\\d+",dt="["+h+"]",ct="["+V+"]",_t="[^"+M+at+He+h+V+Ae+"]",ee="\\ud83c[\\udffb-\\udfff]",rr="(?:"+St+"|"+ee+")",Fr="[^"+M+"]",Mr="(?:\\ud83c[\\udde6-\\uddff]){2}",Nt="[\\ud800-\\udbff][\\udc00-\\udfff]",ze="["+Ae+"]",zt="\\u200d",Kt="(?:"+ct+"|"+_t+")",vr="(?:"+ze+"|"+_t+")",jr="(?:"+gt+"(?:d|ll|m|re|s|t|ve))?",vn="(?:"+gt+"(?:D|LL|M|RE|S|T|VE))?",kr=rr+"?",be="["+vt+"]?",Ne="(?:"+zt+"(?:"+[Fr,Mr,Nt].join("|")+")"+be+kr+")*",Ie="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",pt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",mt=be+kr+Ne,Dt="(?:"+[dt,Mr,Nt].join("|")+")"+mt,w=RegExp([ze+"?"+ct+"+"+jr+"(?="+[yt,ze,"$"].join("|")+")",vr+"+"+vn+"(?="+[yt,ze+Kt,"$"].join("|")+")",ze+"?"+Kt+"+"+jr,ze+"+"+vn,pt,Ie,He,Dt].join("|"),"g");function br(Ut){return Ut.match(w)||[]}le.exports=br},"9nhX":function(le,$,M){var j=M("g4R6"),Z=M("tLB3");function Y(k,h,V){return V===void 0&&(V=h,h=void 0),V!==void 0&&(V=Z(V),V=V===V?V:0),h!==void 0&&(h=Z(h),h=h===h?h:0),j(Z(k),h,V)}le.exports=Y},APxj:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0});var j=M("Ucsi");function Z(Y,k){k===void 0&&(k=!0);var h=j.makePropertyInjectDecorator(Y,k),V=j.makePropertyInjectNamedDecorator(Y,k),H=j.makePropertyInjectTaggedDecorator(Y,k),te=j.makePropertyMultiInjectDecorator(Y,k);return{lazyInject:h,lazyInjectNamed:V,lazyInjectTagged:H,lazyMultiInject:te}}$.default=Z},AfwI:function(le,$,M){var j;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(Z,Y,k,h){"use strict";var V=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,H=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),te=V||H,pe=["","webkit","Moz","MS","ms","o"],Oe=te?"":Y.createElement("div"),Ae="function",vt=Math.round,at=Math.abs,gt=Date.now;function yt(Ke,me,Xe){return setTimeout(Fr(Ke,Xe),me)}function St(Ke,me,Xe){return Array.isArray(Ke)?(He(Ke,Xe[me],Xe),!0):!1}function He(Ke,me,Xe){var Ht;if(!!Ke)if(Ke.forEach)Ke.forEach(me,Xe);else if(Ke.length!==h)for(Ht=0;Ht<Ke.length;)me.call(Xe,Ke[Ht],Ht,Ke),Ht++;else for(Ht in Ke)Ke.hasOwnProperty(Ht)&&me.call(Xe,Ke[Ht],Ht,Ke)}function dt(Ke,me,Xe){var Ht="DEPRECATED METHOD: "+me+`
`+Xe+` AT 
`;return function(){var rn=new Error("get-stack-trace"),Yn=rn&&rn.stack?rn.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",la=Z.console&&(Z.console.warn||Z.console.log);return la&&la.call(Z.console,Ht,Yn),Ke.apply(this,arguments)}}var ct;typeof Object.assign!="function"?ct=function(me){if(me===h||me===null)throw new TypeError("Cannot convert undefined or null to object");for(var Xe=Object(me),Ht=1;Ht<arguments.length;Ht++){var rn=arguments[Ht];if(rn!==h&&rn!==null)for(var Yn in rn)rn.hasOwnProperty(Yn)&&(Xe[Yn]=rn[Yn])}return Xe}:ct=Object.assign;var _t=dt(function(me,Xe,Ht){for(var rn=Object.keys(Xe),Yn=0;Yn<rn.length;)(!Ht||Ht&&me[rn[Yn]]===h)&&(me[rn[Yn]]=Xe[rn[Yn]]),Yn++;return me},"extend","Use `assign`."),ee=dt(function(me,Xe){return _t(me,Xe,!0)},"merge","Use `assign`.");function rr(Ke,me,Xe){var Ht=me.prototype,rn;rn=Ke.prototype=Object.create(Ht),rn.constructor=Ke,rn._super=Ht,Xe&&ct(rn,Xe)}function Fr(Ke,me){return function(){return Ke.apply(me,arguments)}}function Mr(Ke,me){return typeof Ke==Ae?Ke.apply(me&&me[0]||h,me):Ke}function Nt(Ke,me){return Ke===h?me:Ke}function ze(Ke,me,Xe){He(jr(me),function(Ht){Ke.addEventListener(Ht,Xe,!1)})}function zt(Ke,me,Xe){He(jr(me),function(Ht){Ke.removeEventListener(Ht,Xe,!1)})}function Kt(Ke,me){for(;Ke;){if(Ke==me)return!0;Ke=Ke.parentNode}return!1}function vr(Ke,me){return Ke.indexOf(me)>-1}function jr(Ke){return Ke.trim().split(/\s+/g)}function vn(Ke,me,Xe){if(Ke.indexOf&&!Xe)return Ke.indexOf(me);for(var Ht=0;Ht<Ke.length;){if(Xe&&Ke[Ht][Xe]==me||!Xe&&Ke[Ht]===me)return Ht;Ht++}return-1}function kr(Ke){return Array.prototype.slice.call(Ke,0)}function be(Ke,me,Xe){for(var Ht=[],rn=[],Yn=0;Yn<Ke.length;){var la=me?Ke[Yn][me]:Ke[Yn];vn(rn,la)<0&&Ht.push(Ke[Yn]),rn[Yn]=la,Yn++}return Xe&&(me?Ht=Ht.sort(function(lo,bo){return lo[me]>bo[me]}):Ht=Ht.sort()),Ht}function Ne(Ke,me){for(var Xe,Ht,rn=me[0].toUpperCase()+me.slice(1),Yn=0;Yn<pe.length;){if(Xe=pe[Yn],Ht=Xe?Xe+rn:me,Ht in Ke)return Ht;Yn++}return h}var Ie=1;function pt(){return Ie++}function mt(Ke){var me=Ke.ownerDocument||Ke;return me.defaultView||me.parentWindow||Z}var Dt=/mobile|tablet|ip(ad|hone|od)|android/i,w="ontouchstart"in Z,br=Ne(Z,"PointerEvent")!==h,Ut=w&&Dt.test(navigator.userAgent),Xt="touch",It="pen",Lt="mouse",ir="kinect",Ar=25,nr=1,Pr=2,$r=4,Or=8,_r=1,Br=2,Jn=4,mn=8,wn=16,pi=Br|Jn,Ci=mn|wn,fa=pi|Ci,_e=["x","y"],Pn=["clientX","clientY"];function oa(Ke,me){var Xe=this;this.manager=Ke,this.callback=me,this.element=Ke.element,this.target=Ke.options.inputTarget,this.domHandler=function(Ht){Mr(Ke.options.enable,[Ke])&&Xe.handler(Ht)},this.init()}oa.prototype={handler:function(){},init:function(){this.evEl&&ze(this.element,this.evEl,this.domHandler),this.evTarget&&ze(this.target,this.evTarget,this.domHandler),this.evWin&&ze(mt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&zt(this.element,this.evEl,this.domHandler),this.evTarget&&zt(this.target,this.evTarget,this.domHandler),this.evWin&&zt(mt(this.element),this.evWin,this.domHandler)}};function ws(Ke){var me,Xe=Ke.options.inputClass;return Xe?me=Xe:br?me=xe:Ut?me=Nr:w?me=xn:me=Vu,new me(Ke,ys)}function ys(Ke,me,Xe){var Ht=Xe.pointers.length,rn=Xe.changedPointers.length,Yn=me&nr&&Ht-rn==0,la=me&($r|Or)&&Ht-rn==0;Xe.isFirst=!!Yn,Xe.isFinal=!!la,Yn&&(Ke.session={}),Xe.eventType=me,Jt(Ke,Xe),Ke.emit("hammer.input",Xe),Ke.recognize(Xe),Ke.session.prevInput=Xe}function Jt(Ke,me){var Xe=Ke.session,Ht=me.pointers,rn=Ht.length;Xe.firstInput||(Xe.firstInput=On(me)),rn>1&&!Xe.firstMultiple?Xe.firstMultiple=On(me):rn===1&&(Xe.firstMultiple=!1);var Yn=Xe.firstInput,la=Xe.firstMultiple,mo=la?la.center:Yn.center,lo=me.center=ln(Ht);me.timeStamp=gt(),me.deltaTime=me.timeStamp-Yn.timeStamp,me.angle=Ti(mo,lo),me.distance=fi(mo,lo),Ir(Xe,me),me.offsetDirection=wi(me.deltaX,me.deltaY);var bo=Ka(me.deltaTime,me.deltaX,me.deltaY);me.overallVelocityX=bo.x,me.overallVelocityY=bo.y,me.overallVelocity=at(bo.x)>at(bo.y)?bo.x:bo.y,me.scale=la?ya(la.pointers,Ht):1,me.rotation=la?da(la.pointers,Ht):0,me.maxPointers=Xe.prevInput?me.pointers.length>Xe.prevInput.maxPointers?me.pointers.length:Xe.prevInput.maxPointers:me.pointers.length,en(Xe,me);var qo=Ke.element;Kt(me.srcEvent.target,qo)&&(qo=me.srcEvent.target),me.target=qo}function Ir(Ke,me){var Xe=me.center,Ht=Ke.offsetDelta||{},rn=Ke.prevDelta||{},Yn=Ke.prevInput||{};(me.eventType===nr||Yn.eventType===$r)&&(rn=Ke.prevDelta={x:Yn.deltaX||0,y:Yn.deltaY||0},Ht=Ke.offsetDelta={x:Xe.x,y:Xe.y}),me.deltaX=rn.x+(Xe.x-Ht.x),me.deltaY=rn.y+(Xe.y-Ht.y)}function en(Ke,me){var Xe=Ke.lastInterval||me,Ht=me.timeStamp-Xe.timeStamp,rn,Yn,la,mo;if(me.eventType!=Or&&(Ht>Ar||Xe.velocity===h)){var lo=me.deltaX-Xe.deltaX,bo=me.deltaY-Xe.deltaY,qo=Ka(Ht,lo,bo);Yn=qo.x,la=qo.y,rn=at(qo.x)>at(qo.y)?qo.x:qo.y,mo=wi(lo,bo),Ke.lastInterval=me}else rn=Xe.velocity,Yn=Xe.velocityX,la=Xe.velocityY,mo=Xe.direction;me.velocity=rn,me.velocityX=Yn,me.velocityY=la,me.direction=mo}function On(Ke){for(var me=[],Xe=0;Xe<Ke.pointers.length;)me[Xe]={clientX:vt(Ke.pointers[Xe].clientX),clientY:vt(Ke.pointers[Xe].clientY)},Xe++;return{timeStamp:gt(),pointers:me,center:ln(me),deltaX:Ke.deltaX,deltaY:Ke.deltaY}}function ln(Ke){var me=Ke.length;if(me===1)return{x:vt(Ke[0].clientX),y:vt(Ke[0].clientY)};for(var Xe=0,Ht=0,rn=0;rn<me;)Xe+=Ke[rn].clientX,Ht+=Ke[rn].clientY,rn++;return{x:vt(Xe/me),y:vt(Ht/me)}}function Ka(Ke,me,Xe){return{x:me/Ke||0,y:Xe/Ke||0}}function wi(Ke,me){return Ke===me?_r:at(Ke)>=at(me)?Ke<0?Br:Jn:me<0?mn:wn}function fi(Ke,me,Xe){Xe||(Xe=_e);var Ht=me[Xe[0]]-Ke[Xe[0]],rn=me[Xe[1]]-Ke[Xe[1]];return Math.sqrt(Ht*Ht+rn*rn)}function Ti(Ke,me,Xe){Xe||(Xe=_e);var Ht=me[Xe[0]]-Ke[Xe[0]],rn=me[Xe[1]]-Ke[Xe[1]];return Math.atan2(rn,Ht)*180/Math.PI}function da(Ke,me){return Ti(me[1],me[0],Pn)+Ti(Ke[1],Ke[0],Pn)}function ya(Ke,me){return fi(me[0],me[1],Pn)/fi(Ke[0],Ke[1],Pn)}var _s={mousedown:nr,mousemove:Pr,mouseup:$r},xo="mousedown",$a="mousemove mouseup";function Vu(){this.evEl=xo,this.evWin=$a,this.pressed=!1,oa.apply(this,arguments)}rr(Vu,oa,{handler:function(me){var Xe=_s[me.type];Xe&nr&&me.button===0&&(this.pressed=!0),Xe&Pr&&me.which!==1&&(Xe=$r),!!this.pressed&&(Xe&$r&&(this.pressed=!1),this.callback(this.manager,Xe,{pointers:[me],changedPointers:[me],pointerType:Lt,srcEvent:me}))}});var ec={pointerdown:nr,pointermove:Pr,pointerup:$r,pointercancel:Or,pointerout:Or},wo={2:Xt,3:It,4:Lt,5:ir},oe="pointerdown",ie="pointermove pointerup pointercancel";!te&&Z.MSPointerEvent&&!Z.PointerEvent&&(oe="MSPointerDown",ie="MSPointerMove MSPointerUp MSPointerCancel");function xe(){this.evEl=oe,this.evWin=ie,oa.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}rr(xe,oa,{handler:function(me){var Xe=this.store,Ht=!1,rn=me.type.toLowerCase().replace("ms",""),Yn=ec[rn],la=wo[me.pointerType]||me.pointerType,mo=la==Xt,lo=vn(Xe,me.pointerId,"pointerId");Yn&nr&&(me.button===0||mo)?lo<0&&(Xe.push(me),lo=Xe.length-1):Yn&($r|Or)&&(Ht=!0),!(lo<0)&&(Xe[lo]=me,this.callback(this.manager,Yn,{pointers:Xe,changedPointers:[me],pointerType:la,srcEvent:me}),Ht&&Xe.splice(lo,1))}});var Me={touchstart:nr,touchmove:Pr,touchend:$r,touchcancel:Or},Ve="touchstart",ft="touchstart touchmove touchend touchcancel";function Ct(){this.evTarget=Ve,this.evWin=ft,this.started=!1,oa.apply(this,arguments)}rr(Ct,oa,{handler:function(me){var Xe=Me[me.type];if(Xe===nr&&(this.started=!0),!!this.started){var Ht=Ce.call(this,me,Xe);Xe&($r|Or)&&Ht[0].length-Ht[1].length==0&&(this.started=!1),this.callback(this.manager,Xe,{pointers:Ht[0],changedPointers:Ht[1],pointerType:Xt,srcEvent:me})}}});function Ce(Ke,me){var Xe=kr(Ke.touches),Ht=kr(Ke.changedTouches);return me&($r|Or)&&(Xe=be(Xe.concat(Ht),"identifier",!0)),[Xe,Ht]}var Ye={touchstart:nr,touchmove:Pr,touchend:$r,touchcancel:Or},nt="touchstart touchmove touchend touchcancel";function Nr(){this.evTarget=nt,this.targetIds={},oa.apply(this,arguments)}rr(Nr,oa,{handler:function(me){var Xe=Ye[me.type],Ht=Xr.call(this,me,Xe);!Ht||this.callback(this.manager,Xe,{pointers:Ht[0],changedPointers:Ht[1],pointerType:Xt,srcEvent:me})}});function Xr(Ke,me){var Xe=kr(Ke.touches),Ht=this.targetIds;if(me&(nr|Pr)&&Xe.length===1)return Ht[Xe[0].identifier]=!0,[Xe,Xe];var rn,Yn,la=kr(Ke.changedTouches),mo=[],lo=this.target;if(Yn=Xe.filter(function(bo){return Kt(bo.target,lo)}),me===nr)for(rn=0;rn<Yn.length;)Ht[Yn[rn].identifier]=!0,rn++;for(rn=0;rn<la.length;)Ht[la[rn].identifier]&&mo.push(la[rn]),me&($r|Or)&&delete Ht[la[rn].identifier],rn++;if(!!mo.length)return[be(Yn.concat(mo),"identifier",!0),mo]}var dr=2500,Yr=25;function xn(){oa.apply(this,arguments);var Ke=Fr(this.handler,this);this.touch=new Nr(this.manager,Ke),this.mouse=new Vu(this.manager,Ke),this.primaryTouch=null,this.lastTouches=[]}rr(xn,oa,{handler:function(me,Xe,Ht){var rn=Ht.pointerType==Xt,Yn=Ht.pointerType==Lt;if(!(Yn&&Ht.sourceCapabilities&&Ht.sourceCapabilities.firesTouchEvents)){if(rn)Gn.call(this,Xe,Ht);else if(Yn&&jn.call(this,Ht))return;this.callback(me,Xe,Ht)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Gn(Ke,me){Ke&nr?(this.primaryTouch=me.changedPointers[0].identifier,pr.call(this,me)):Ke&($r|Or)&&pr.call(this,me)}function pr(Ke){var me=Ke.changedPointers[0];if(me.identifier===this.primaryTouch){var Xe={x:me.clientX,y:me.clientY};this.lastTouches.push(Xe);var Ht=this.lastTouches,rn=function(){var la=Ht.indexOf(Xe);la>-1&&Ht.splice(la,1)};setTimeout(rn,dr)}}function jn(Ke){for(var me=Ke.srcEvent.clientX,Xe=Ke.srcEvent.clientY,Ht=0;Ht<this.lastTouches.length;Ht++){var rn=this.lastTouches[Ht],Yn=Math.abs(me-rn.x),la=Math.abs(Xe-rn.y);if(Yn<=Yr&&la<=Yr)return!0}return!1}var Rn=te?h:Ne(Oe.style,"touchAction"),Nn=Rn!==h,Gi="compute",Hn="auto",ha="manipulation",Sa="none",Ji="pan-x",ei="pan-y",ua=zo();function Ds(Ke,me){this.manager=Ke,this.set(me)}Ds.prototype={set:function(me){me==Gi&&(me=this.compute()),Nn&&this.manager.element.style&&ua[me]&&(this.manager.element.style[Rn]=me),this.actions=me.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var me=[];return He(this.manager.recognizers,function(Xe){Mr(Xe.options.enable,[Xe])&&(me=me.concat(Xe.getTouchAction()))}),Ca(me.join(" "))},preventDefaults:function(me){var Xe=me.srcEvent,Ht=me.offsetDirection;if(this.manager.session.prevented){Xe.preventDefault();return}var rn=this.actions,Yn=vr(rn,Sa)&&!ua[Sa],la=vr(rn,ei)&&!ua[ei],mo=vr(rn,Ji)&&!ua[Ji];if(Yn){var lo=me.pointers.length===1,bo=me.distance<2,qo=me.deltaTime<250;if(lo&&bo&&qo)return}if(!(mo&&la)&&(Yn||la&&Ht&pi||mo&&Ht&Ci))return this.preventSrc(Xe)},preventSrc:function(me){this.manager.session.prevented=!0,me.preventDefault()}};function Ca(Ke){if(vr(Ke,Sa))return Sa;var me=vr(Ke,Ji),Xe=vr(Ke,ei);return me&&Xe?Sa:me||Xe?me?Ji:ei:vr(Ke,ha)?ha:Hn}function zo(){if(!Nn)return!1;var Ke={};if(te)return Ke;var me=Z.CSS&&Z.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Xe){Ke[Xe]=me?Z.CSS.supports("touch-action",Xe):!0}),Ke}var Ei=1,Qi=2,Bi=4,Uo=8,Ho=Uo,so=16,Ft=32;function nu(Ke){this.options=ct({},this.defaults,Ke||{}),this.id=pt(),this.manager=null,this.options.enable=Nt(this.options.enable,!0),this.state=Ei,this.simultaneous={},this.requireFail=[]}nu.prototype={defaults:{},set:function(me){return ct(this.options,me),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(me){if(St(me,"recognizeWith",this))return this;var Xe=this.simultaneous;return me=jo(me,this),Xe[me.id]||(Xe[me.id]=me,me.recognizeWith(this)),this},dropRecognizeWith:function(me){return St(me,"dropRecognizeWith",this)?this:(me=jo(me,this),delete this.simultaneous[me.id],this)},requireFailure:function(me){if(St(me,"requireFailure",this))return this;var Xe=this.requireFail;return me=jo(me,this),vn(Xe,me)===-1&&(Xe.push(me),me.requireFailure(this)),this},dropRequireFailure:function(me){if(St(me,"dropRequireFailure",this))return this;me=jo(me,this);var Xe=vn(this.requireFail,me);return Xe>-1&&this.requireFail.splice(Xe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(me){return!!this.simultaneous[me.id]},emit:function(me){var Xe=this,Ht=this.state;function rn(Yn){Xe.manager.emit(Yn,me)}Ht<Uo&&rn(Xe.options.event+Yt(Ht)),rn(Xe.options.event),me.additionalEvent&&rn(me.additionalEvent),Ht>=Uo&&rn(Xe.options.event+Yt(Ht))},tryEmit:function(me){if(this.canEmit())return this.emit(me);this.state=Ft},canEmit:function(){for(var me=0;me<this.requireFail.length;){if(!(this.requireFail[me].state&(Ft|Ei)))return!1;me++}return!0},recognize:function(me){var Xe=ct({},me);if(!Mr(this.options.enable,[this,Xe])){this.reset(),this.state=Ft;return}this.state&(Ho|so|Ft)&&(this.state=Ei),this.state=this.process(Xe),this.state&(Qi|Bi|Uo|so)&&this.tryEmit(Xe)},process:function(me){},getTouchAction:function(){},reset:function(){}};function Yt(Ke){return Ke&so?"cancel":Ke&Uo?"end":Ke&Bi?"move":Ke&Qi?"start":""}function uo(Ke){return Ke==wn?"down":Ke==mn?"up":Ke==Br?"left":Ke==Jn?"right":""}function jo(Ke,me){var Xe=me.manager;return Xe?Xe.get(Ke):Ke}function vo(){nu.apply(this,arguments)}rr(vo,nu,{defaults:{pointers:1},attrTest:function(me){var Xe=this.options.pointers;return Xe===0||me.pointers.length===Xe},process:function(me){var Xe=this.state,Ht=me.eventType,rn=Xe&(Qi|Bi),Yn=this.attrTest(me);return rn&&(Ht&Or||!Yn)?Xe|so:rn||Yn?Ht&$r?Xe|Uo:Xe&Qi?Xe|Bi:Qi:Ft}});function no(){vo.apply(this,arguments),this.pX=null,this.pY=null}rr(no,vo,{defaults:{event:"pan",threshold:10,pointers:1,direction:fa},getTouchAction:function(){var me=this.options.direction,Xe=[];return me&pi&&Xe.push(ei),me&Ci&&Xe.push(Ji),Xe},directionTest:function(me){var Xe=this.options,Ht=!0,rn=me.distance,Yn=me.direction,la=me.deltaX,mo=me.deltaY;return Yn&Xe.direction||(Xe.direction&pi?(Yn=la===0?_r:la<0?Br:Jn,Ht=la!=this.pX,rn=Math.abs(me.deltaX)):(Yn=mo===0?_r:mo<0?mn:wn,Ht=mo!=this.pY,rn=Math.abs(me.deltaY))),me.direction=Yn,Ht&&rn>Xe.threshold&&Yn&Xe.direction},attrTest:function(me){return vo.prototype.attrTest.call(this,me)&&(this.state&Qi||!(this.state&Qi)&&this.directionTest(me))},emit:function(me){this.pX=me.deltaX,this.pY=me.deltaY;var Xe=uo(me.direction);Xe&&(me.additionalEvent=this.options.event+Xe),this._super.emit.call(this,me)}});function As(){vo.apply(this,arguments)}rr(As,vo,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Sa]},attrTest:function(me){return this._super.attrTest.call(this,me)&&(Math.abs(me.scale-1)>this.options.threshold||this.state&Qi)},emit:function(me){if(me.scale!==1){var Xe=me.scale<1?"in":"out";me.additionalEvent=this.options.event+Xe}this._super.emit.call(this,me)}});function qr(){nu.apply(this,arguments),this._timer=null,this._input=null}rr(qr,nu,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Hn]},process:function(me){var Xe=this.options,Ht=me.pointers.length===Xe.pointers,rn=me.distance<Xe.threshold,Yn=me.deltaTime>Xe.time;if(this._input=me,!rn||!Ht||me.eventType&($r|Or)&&!Yn)this.reset();else if(me.eventType&nr)this.reset(),this._timer=yt(function(){this.state=Ho,this.tryEmit()},Xe.time,this);else if(me.eventType&$r)return Ho;return Ft},reset:function(){clearTimeout(this._timer)},emit:function(me){this.state===Ho&&(me&&me.eventType&$r?this.manager.emit(this.options.event+"up",me):(this._input.timeStamp=gt(),this.manager.emit(this.options.event,this._input)))}});function xs(){vo.apply(this,arguments)}rr(xs,vo,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Sa]},attrTest:function(me){return this._super.attrTest.call(this,me)&&(Math.abs(me.rotation)>this.options.threshold||this.state&Qi)}});function hn(){vo.apply(this,arguments)}rr(hn,vo,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:pi|Ci,pointers:1},getTouchAction:function(){return no.prototype.getTouchAction.call(this)},attrTest:function(me){var Xe=this.options.direction,Ht;return Xe&(pi|Ci)?Ht=me.overallVelocity:Xe&pi?Ht=me.overallVelocityX:Xe&Ci&&(Ht=me.overallVelocityY),this._super.attrTest.call(this,me)&&Xe&me.offsetDirection&&me.distance>this.options.threshold&&me.maxPointers==this.options.pointers&&at(Ht)>this.options.velocity&&me.eventType&$r},emit:function(me){var Xe=uo(me.offsetDirection);Xe&&this.manager.emit(this.options.event+Xe,me),this.manager.emit(this.options.event,me)}});function Ts(){nu.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}rr(Ts,nu,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ha]},process:function(me){var Xe=this.options,Ht=me.pointers.length===Xe.pointers,rn=me.distance<Xe.threshold,Yn=me.deltaTime<Xe.time;if(this.reset(),me.eventType&nr&&this.count===0)return this.failTimeout();if(rn&&Yn&&Ht){if(me.eventType!=$r)return this.failTimeout();var la=this.pTime?me.timeStamp-this.pTime<Xe.interval:!0,mo=!this.pCenter||fi(this.pCenter,me.center)<Xe.posThreshold;this.pTime=me.timeStamp,this.pCenter=me.center,!mo||!la?this.count=1:this.count+=1,this._input=me;var lo=this.count%Xe.taps;if(lo===0)return this.hasRequireFailures()?(this._timer=yt(function(){this.state=Ho,this.tryEmit()},Xe.interval,this),Qi):Ho}return Ft},failTimeout:function(){return this._timer=yt(function(){this.state=Ft},this.options.interval,this),Ft},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ho&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function wt(Ke,me){return me=me||{},me.recognizers=Nt(me.recognizers,wt.defaults.preset),new ce(Ke,me)}wt.VERSION="2.0.7",wt.defaults={domEvents:!1,touchAction:Gi,enable:!0,inputTarget:null,inputClass:null,preset:[[xs,{enable:!1}],[As,{enable:!1},["rotate"]],[hn,{direction:pi}],[no,{direction:pi},["swipe"]],[Ts],[Ts,{event:"doubletap",taps:2},["tap"]],[qr]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var _l=1,Us=2;function ce(Ke,me){this.options=ct({},wt.defaults,me||{}),this.options.inputTarget=this.options.inputTarget||Ke,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ke,this.input=ws(this),this.touchAction=new Ds(this,this.options.touchAction),Tu(this,!0),He(this.options.recognizers,function(Xe){var Ht=this.add(new Xe[0](Xe[1]));Xe[2]&&Ht.recognizeWith(Xe[2]),Xe[3]&&Ht.requireFailure(Xe[3])},this)}ce.prototype={set:function(me){return ct(this.options,me),me.touchAction&&this.touchAction.update(),me.inputTarget&&(this.input.destroy(),this.input.target=me.inputTarget,this.input.init()),this},stop:function(me){this.session.stopped=me?Us:_l},recognize:function(me){var Xe=this.session;if(!Xe.stopped){this.touchAction.preventDefaults(me);var Ht,rn=this.recognizers,Yn=Xe.curRecognizer;(!Yn||Yn&&Yn.state&Ho)&&(Yn=Xe.curRecognizer=null);for(var la=0;la<rn.length;)Ht=rn[la],Xe.stopped!==Us&&(!Yn||Ht==Yn||Ht.canRecognizeWith(Yn))?Ht.recognize(me):Ht.reset(),!Yn&&Ht.state&(Qi|Bi|Uo)&&(Yn=Xe.curRecognizer=Ht),la++}},get:function(me){if(me instanceof nu)return me;for(var Xe=this.recognizers,Ht=0;Ht<Xe.length;Ht++)if(Xe[Ht].options.event==me)return Xe[Ht];return null},add:function(me){if(St(me,"add",this))return this;var Xe=this.get(me.options.event);return Xe&&this.remove(Xe),this.recognizers.push(me),me.manager=this,this.touchAction.update(),me},remove:function(me){if(St(me,"remove",this))return this;if(me=this.get(me),me){var Xe=this.recognizers,Ht=vn(Xe,me);Ht!==-1&&(Xe.splice(Ht,1),this.touchAction.update())}return this},on:function(me,Xe){if(me!==h&&Xe!==h){var Ht=this.handlers;return He(jr(me),function(rn){Ht[rn]=Ht[rn]||[],Ht[rn].push(Xe)}),this}},off:function(me,Xe){if(me!==h){var Ht=this.handlers;return He(jr(me),function(rn){Xe?Ht[rn]&&Ht[rn].splice(vn(Ht[rn],Xe),1):delete Ht[rn]}),this}},emit:function(me,Xe){this.options.domEvents&&ls(me,Xe);var Ht=this.handlers[me]&&this.handlers[me].slice();if(!(!Ht||!Ht.length)){Xe.type=me,Xe.preventDefault=function(){Xe.srcEvent.preventDefault()};for(var rn=0;rn<Ht.length;)Ht[rn](Xe),rn++}},destroy:function(){this.element&&Tu(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Tu(Ke,me){var Xe=Ke.element;if(!!Xe.style){var Ht;He(Ke.options.cssProps,function(rn,Yn){Ht=Ne(Xe.style,Yn),me?(Ke.oldCssProps[Ht]=Xe.style[Ht],Xe.style[Ht]=rn):Xe.style[Ht]=Ke.oldCssProps[Ht]||""}),me||(Ke.oldCssProps={})}}function ls(Ke,me){if(!te){var Xe=Y.createEvent("Event");Xe.initEvent(Ke,!0,!0),Xe.gesture=me,me.target.dispatchEvent(Xe)}}if(!te){ct(wt,{INPUT_START:nr,INPUT_MOVE:Pr,INPUT_END:$r,INPUT_CANCEL:Or,STATE_POSSIBLE:Ei,STATE_BEGAN:Qi,STATE_CHANGED:Bi,STATE_ENDED:Uo,STATE_RECOGNIZED:Ho,STATE_CANCELLED:so,STATE_FAILED:Ft,DIRECTION_NONE:_r,DIRECTION_LEFT:Br,DIRECTION_RIGHT:Jn,DIRECTION_UP:mn,DIRECTION_DOWN:wn,DIRECTION_HORIZONTAL:pi,DIRECTION_VERTICAL:Ci,DIRECTION_ALL:fa,Manager:ce,Input:oa,TouchAction:Ds,TouchInput:Nr,MouseInput:Vu,PointerEventInput:xe,TouchMouseInput:xn,SingleTouchInput:Ct,Recognizer:nu,AttrRecognizer:vo,Tap:Ts,Pan:no,Swipe:hn,Pinch:As,Rotate:xs,Press:qr,on:ze,off:zt,each:He,merge:ee,extend:_t,assign:ct,inherit:rr,bindFn:Fr,prefixed:Ne});var $o=typeof window!="undefined"?window:typeof self!="undefined"?self:{};$o.Hammer=wt,j=function(){return wt}.call($,M,$,le),j!==h&&(le.exports=j)}})(typeof window!="undefined"?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document,"Hammer")},Aib3:function(le,$,M){var j=M("mhV4");le.exports=Z;function Z(te,pe){switch(te&&te.type||null){case"FeatureCollection":return te.features=te.features.map(Y(Z,pe)),te;case"GeometryCollection":return te.geometries=te.geometries.map(Y(Z,pe)),te;case"Feature":return te.geometry=Z(te.geometry,pe),te;case"Polygon":case"MultiPolygon":return k(te,pe);default:return te}}function Y(te,pe){return function(Oe){return te(Oe,pe)}}function k(te,pe){return te.type==="Polygon"?te.coordinates=h(te.coordinates,pe):te.type==="MultiPolygon"&&(te.coordinates=te.coordinates.map(Y(h,pe))),te}function h(te,pe){pe=!!pe,te[0]=V(te[0],pe);for(var Oe=1;Oe<te.length;Oe++)te[Oe]=V(te[Oe],!pe);return te}function V(te,pe){return H(te)===pe?te:te.reverse()}function H(te){return j.ring(te)>=0}},AwBQ:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Lookup=void 0;var j=M("MON2"),Z=function(){function Y(){this._map=new Map}return Y.prototype.getMap=function(){return this._map},Y.prototype.add=function(k,h){if(k==null)throw new Error(j.NULL_ARGUMENT);if(h==null)throw new Error(j.NULL_ARGUMENT);var V=this._map.get(k);V!==void 0?(V.push(h),this._map.set(k,V)):this._map.set(k,[h])},Y.prototype.get=function(k){if(k==null)throw new Error(j.NULL_ARGUMENT);var h=this._map.get(k);if(h!==void 0)return h;throw new Error(j.KEY_NOT_FOUND)},Y.prototype.remove=function(k){if(k==null)throw new Error(j.NULL_ARGUMENT);if(!this._map.delete(k))throw new Error(j.KEY_NOT_FOUND)},Y.prototype.removeByCondition=function(k){var h=this;this._map.forEach(function(V,H){var te=V.filter(function(pe){return!k(pe)});te.length>0?h._map.set(H,te):h._map.delete(H)})},Y.prototype.hasKey=function(k){if(k==null)throw new Error(j.NULL_ARGUMENT);return this._map.has(k)},Y.prototype.clone=function(){var k=new Y;return this._map.forEach(function(h,V){h.forEach(function(H){return k.add(V,H.clone())})}),k},Y.prototype.traverse=function(k){this._map.forEach(function(h,V){k(V,h)})},Y}();$.Lookup=Z},"B6l+":function(le,$,M){var j=M("Sq3C"),Z=M("Z1HP"),Y=M("Sxd8"),k=M("dt0z");function h(V,H,te){V=k(V),H=Y(H);var pe=H?Z(V):0;return H&&pe<H?V+j(H-pe,te):V}le.exports=h},BkRI:function(le,$,M){var j=M("OBhP"),Z=1,Y=4;function k(h){return j(h,Z|Y)}le.exports=k},Bnag:function(le,$){function M(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}le.exports=M,le.exports.__esModule=!0,le.exports.default=le.exports},CZoQ:function(le,$){function M(j,Z,Y){for(var k=Y-1,h=j.length;++k<h;)if(j[k]===Z)return k;return-1}le.exports=M},D9lx:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingInWhenOnSyntax=void 0;var j=M("6AGu"),Z=M("406g"),Y=M("z4Hk"),k=function(){function h(V){this._binding=V,this._bindingWhenSyntax=new Y.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Z.BindingOnSyntax(this._binding),this._bindingInSyntax=new j.BindingInSyntax(V)}return h.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},h.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},h.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},h.prototype.when=function(V){return this._bindingWhenSyntax.when(V)},h.prototype.whenTargetNamed=function(V){return this._bindingWhenSyntax.whenTargetNamed(V)},h.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},h.prototype.whenTargetTagged=function(V,H){return this._bindingWhenSyntax.whenTargetTagged(V,H)},h.prototype.whenInjectedInto=function(V){return this._bindingWhenSyntax.whenInjectedInto(V)},h.prototype.whenParentNamed=function(V){return this._bindingWhenSyntax.whenParentNamed(V)},h.prototype.whenParentTagged=function(V,H){return this._bindingWhenSyntax.whenParentTagged(V,H)},h.prototype.whenAnyAncestorIs=function(V){return this._bindingWhenSyntax.whenAnyAncestorIs(V)},h.prototype.whenNoAncestorIs=function(V){return this._bindingWhenSyntax.whenNoAncestorIs(V)},h.prototype.whenAnyAncestorNamed=function(V){return this._bindingWhenSyntax.whenAnyAncestorNamed(V)},h.prototype.whenAnyAncestorTagged=function(V,H){return this._bindingWhenSyntax.whenAnyAncestorTagged(V,H)},h.prototype.whenNoAncestorNamed=function(V){return this._bindingWhenSyntax.whenNoAncestorNamed(V)},h.prototype.whenNoAncestorTagged=function(V,H){return this._bindingWhenSyntax.whenNoAncestorTagged(V,H)},h.prototype.whenAnyAncestorMatches=function(V){return this._bindingWhenSyntax.whenAnyAncestorMatches(V)},h.prototype.whenNoAncestorMatches=function(V){return this._bindingWhenSyntax.whenNoAncestorMatches(V)},h.prototype.onActivation=function(V){return this._bindingOnSyntax.onActivation(V)},h}();$.BindingInWhenOnSyntax=k},DnfT:function(le,$,M){},"Dw+G":function(le,$,M){var j=M("juv8"),Z=M("mTTR");function Y(k,h){return k&&j(h,Z(h),k)}le.exports=Y},DzJC:function(le,$,M){var j=M("sEfC"),Z=M("GoyQ"),Y="Expected a function";function k(h,V,H){var te=!0,pe=!0;if(typeof h!="function")throw new TypeError(Y);return Z(H)&&(te="leading"in H?!!H.leading:te,pe="trailing"in H?!!H.trailing:pe),j(h,V,{leading:te,maxWait:V,trailing:pe})}le.exports=k},EA7m:function(le,$,M){var j=M("zZ0H"),Z=M("Ioao"),Y=M("wclG");function k(h,V){return Y(Z(h,V,j),h+"")}le.exports=k},EEGq:function(le,$,M){var j=M("juv8"),Z=M("oCl/");function Y(k,h){return j(k,Z(k),h)}le.exports=Y},EbDI:function(le,$){function M(j){if(typeof Symbol!="undefined"&&j[Symbol.iterator]!=null||j["@@iterator"]!=null)return Array.from(j)}le.exports=M,le.exports.__esModule=!0,le.exports.default=le.exports},Em2t:function(le,$,M){var j=M("bahg"),Z=M("quyA"),Y=M("0JQy");function k(h){return Z(h)?Y(h):j(h)}le.exports=k},FRQA:function(le,$,M){"use strict";var j=M("GNNt"),Z=M("wEI+"),Y=M("DnfT"),k=M.n(Y),h=M("q1tI"),V=M.n(h),H=M("TSYQ"),te=M.n(H),pe=M("jYQm"),Oe=function(vt){var at=Object(h.useContext)(pe.a),gt=vt.children,yt=vt.contentWidth,St=vt.className,He=vt.style,dt=Object(h.useContext)(Z.a.ConfigContext),ct=dt.getPrefixCls,_t=vt.prefixCls||ct("pro"),ee=yt||at.contentWidth,rr="".concat(_t,"-grid-content");return V.a.createElement("div",{className:te()(rr,St,{wide:ee==="Fixed"}),style:He},V.a.createElement("div",{className:"".concat(_t,"-grid-content-children")},gt))};$.a=Oe},FV85:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.TargetTypeEnum=$.BindingTypeEnum=$.BindingScopeEnum=void 0;var j={Request:"Request",Singleton:"Singleton",Transient:"Transient"};$.BindingScopeEnum=j;var Z={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};$.BindingTypeEnum=Z;var Y={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};$.TargetTypeEnum=Y},G6z8:function(le,$,M){var j=M("fR/l"),Z=M("oCl/"),Y=M("mTTR");function k(h){return j(h,Y,Z)}le.exports=k},GXnB:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Metadata=void 0;var j=M("xfSm"),Z=function(){function Y(k,h){this.key=k,this.value=h}return Y.prototype.toString=function(){return this.key===j.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},Y}();$.Metadata=Z},Gi0A:function(le,$,M){var j=M("QqLw"),Z=M("ExA7"),Y="[object Map]";function k(h){return Z(h)&&j(h)==Y}le.exports=k},HpQ9:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.ContainerSnapshot=void 0;var j=function(){function Z(){}return Z.of=function(Y,k){var h=new Z;return h.bindings=Y,h.middleware=k,h},Z}();$.ContainerSnapshot=j},Ijbi:function(le,$,M){var j=M("WkPL");function Z(Y){if(Array.isArray(Y))return j(Y)}le.exports=Z,le.exports.__esModule=!0,le.exports.default=le.exports},Ioao:function(le,$,M){var j=M("heNW"),Z=Math.max;function Y(k,h,V){return h=Z(h===void 0?k.length-1:h,0),function(){for(var H=arguments,te=-1,pe=Z(H.length-h,0),Oe=Array(pe);++te<pe;)Oe[te]=H[h+te];te=-1;for(var Ae=Array(h+1);++te<h;)Ae[te]=H[te];return Ae[h]=V(Oe),j(k,this,Ae)}}le.exports=Y},J2iB:function(le,$){function M(j){return j==null}le.exports=M},JBE3:function(le,$,M){var j=M("+Qka"),Z=M("LsHQ"),Y=Z(function(k,h,V,H){j(k,h,V,H)});le.exports=Y},KwMD:function(le,$){function M(j,Z,Y,k){for(var h=j.length,V=Y+(k?1:-1);k?V--:++V<h;)if(Z(j[V],V,j))return V;return-1}le.exports=M},KxBF:function(le,$){function M(j,Z,Y){var k=-1,h=j.length;Z<0&&(Z=-Z>h?0:h+Z),Y=Y>h?h:Y,Y<0&&(Y+=h),h=Z>Y?0:Y-Z>>>0,Z>>>=0;for(var V=Array(h);++k<h;)V[k]=j[k+Z];return V}le.exports=M},LGYb:function(le,$,M){var j=M("1hJj"),Z=M("jbM+"),Y=M("Xt/L"),k=M("xYSL"),h=M("dQpi"),V=M("rEGp"),H=200;function te(pe,Oe,Ae){var vt=-1,at=Z,gt=pe.length,yt=!0,St=[],He=St;if(Ae)yt=!1,at=Y;else if(gt>=H){var dt=Oe?null:h(pe);if(dt)return V(dt);yt=!1,at=k,He=new j}else He=Oe?[]:St;e:for(;++vt<gt;){var ct=pe[vt],_t=Oe?Oe(ct):ct;if(ct=Ae||ct!==0?ct:0,yt&&_t===_t){for(var ee=He.length;ee--;)if(He[ee]===_t)continue e;Oe&&He.push(_t),St.push(ct)}else at(He,_t,Ae)||(He!==St&&He.push(_t),St.push(ct))}return St}le.exports=te},LKzl:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingWhenOnSyntax=void 0;var j=M("406g"),Z=M("z4Hk"),Y=function(){function k(h){this._binding=h,this._bindingWhenSyntax=new Z.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new j.BindingOnSyntax(this._binding)}return k.prototype.when=function(h){return this._bindingWhenSyntax.when(h)},k.prototype.whenTargetNamed=function(h){return this._bindingWhenSyntax.whenTargetNamed(h)},k.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},k.prototype.whenTargetTagged=function(h,V){return this._bindingWhenSyntax.whenTargetTagged(h,V)},k.prototype.whenInjectedInto=function(h){return this._bindingWhenSyntax.whenInjectedInto(h)},k.prototype.whenParentNamed=function(h){return this._bindingWhenSyntax.whenParentNamed(h)},k.prototype.whenParentTagged=function(h,V){return this._bindingWhenSyntax.whenParentTagged(h,V)},k.prototype.whenAnyAncestorIs=function(h){return this._bindingWhenSyntax.whenAnyAncestorIs(h)},k.prototype.whenNoAncestorIs=function(h){return this._bindingWhenSyntax.whenNoAncestorIs(h)},k.prototype.whenAnyAncestorNamed=function(h){return this._bindingWhenSyntax.whenAnyAncestorNamed(h)},k.prototype.whenAnyAncestorTagged=function(h,V){return this._bindingWhenSyntax.whenAnyAncestorTagged(h,V)},k.prototype.whenNoAncestorNamed=function(h){return this._bindingWhenSyntax.whenNoAncestorNamed(h)},k.prototype.whenNoAncestorTagged=function(h,V){return this._bindingWhenSyntax.whenNoAncestorTagged(h,V)},k.prototype.whenAnyAncestorMatches=function(h){return this._bindingWhenSyntax.whenAnyAncestorMatches(h)},k.prototype.whenNoAncestorMatches=function(h){return this._bindingWhenSyntax.whenNoAncestorMatches(h)},k.prototype.onActivation=function(h){return this._bindingOnSyntax.onActivation(h)},k}();$.BindingWhenOnSyntax=Y},LcsW:function(le,$,M){var j=M("kekF"),Z=j(Object.getPrototypeOf,Object);le.exports=Z},LgvC:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Binding=void 0;var j=M("FV85"),Z=M("d9O0"),Y=function(){function k(h,V){this.id=Z.id(),this.activated=!1,this.serviceIdentifier=h,this.scope=V,this.type=j.BindingTypeEnum.Invalid,this.constraint=function(H){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return k.prototype.clone=function(){var h=new k(this.serviceIdentifier,this.scope);return h.activated=h.scope===j.BindingScopeEnum.Singleton?this.activated:!1,h.implementationType=this.implementationType,h.dynamicValue=this.dynamicValue,h.scope=this.scope,h.type=this.type,h.factory=this.factory,h.provider=this.provider,h.constraint=this.constraint,h.onActivation=this.onActivation,h.cache=this.cache,h},k}();$.Binding=Y},LsHQ:function(le,$,M){var j=M("EA7m"),Z=M("mv/X");function Y(k){return j(function(h,V){var H=-1,te=V.length,pe=te>1?V[te-1]:void 0,Oe=te>2?V[2]:void 0;for(pe=k.length>3&&typeof pe=="function"?(te--,pe):void 0,Oe&&Z(V[0],V[1],Oe)&&(pe=te<3?void 0:pe,te=1),h=Object(h);++H<te;){var Ae=V[H];Ae&&k(h,Ae,H,pe)}return h})}le.exports=Y},LvDl:function(le,$,M){(function(j,Z){var Y;/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(){var k,h="4.17.21",V=200,H="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",te="Expected a function",pe="Invalid `variable` option passed into `_.template`",Oe="__lodash_hash_undefined__",Ae=500,vt="__lodash_placeholder__",at=1,gt=2,yt=4,St=1,He=2,dt=1,ct=2,_t=4,ee=8,rr=16,Fr=32,Mr=64,Nt=128,ze=256,zt=512,Kt=30,vr="...",jr=800,vn=16,kr=1,be=2,Ne=3,Ie=1/0,pt=9007199254740991,mt=17976931348623157e292,Dt=0/0,w=4294967295,br=w-1,Ut=w>>>1,Xt=[["ary",Nt],["bind",dt],["bindKey",ct],["curry",ee],["curryRight",rr],["flip",zt],["partial",Fr],["partialRight",Mr],["rearg",ze]],It="[object Arguments]",Lt="[object Array]",ir="[object AsyncFunction]",Ar="[object Boolean]",nr="[object Date]",Pr="[object DOMException]",$r="[object Error]",Or="[object Function]",_r="[object GeneratorFunction]",Br="[object Map]",Jn="[object Number]",mn="[object Null]",wn="[object Object]",pi="[object Promise]",Ci="[object Proxy]",fa="[object RegExp]",_e="[object Set]",Pn="[object String]",oa="[object Symbol]",ws="[object Undefined]",ys="[object WeakMap]",Jt="[object WeakSet]",Ir="[object ArrayBuffer]",en="[object DataView]",On="[object Float32Array]",ln="[object Float64Array]",Ka="[object Int8Array]",wi="[object Int16Array]",fi="[object Int32Array]",Ti="[object Uint8Array]",da="[object Uint8ClampedArray]",ya="[object Uint16Array]",_s="[object Uint32Array]",xo=/\b__p \+= '';/g,$a=/\b(__p \+=) '' \+/g,Vu=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ec=/&(?:amp|lt|gt|quot|#39);/g,wo=/[&<>"']/g,oe=RegExp(ec.source),ie=RegExp(wo.source),xe=/<%-([\s\S]+?)%>/g,Me=/<%([\s\S]+?)%>/g,Ve=/<%=([\s\S]+?)%>/g,ft=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ct=/^\w*$/,Ce=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ye=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(Ye.source),Nr=/^\s+/,Xr=/\s/,dr=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Yr=/\{\n\/\* \[wrapped with (.+)\] \*/,xn=/,? & /,Gn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,pr=/[()=,{}\[\]\/\s]/,jn=/\\(\\)?/g,Rn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Nn=/\w*$/,Gi=/^[-+]0x[0-9a-f]+$/i,Hn=/^0b[01]+$/i,ha=/^\[object .+?Constructor\]$/,Sa=/^0o[0-7]+$/i,Ji=/^(?:0|[1-9]\d*)$/,ei=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ua=/($^)/,Ds=/['\n\r\u2028\u2029\\]/g,Ca="\\ud800-\\udfff",zo="\\u0300-\\u036f",Ei="\\ufe20-\\ufe2f",Qi="\\u20d0-\\u20ff",Bi=zo+Ei+Qi,Uo="\\u2700-\\u27bf",Ho="a-z\\xdf-\\xf6\\xf8-\\xff",so="\\xac\\xb1\\xd7\\xf7",Ft="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",nu="\\u2000-\\u206f",Yt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",uo="A-Z\\xc0-\\xd6\\xd8-\\xde",jo="\\ufe0e\\ufe0f",vo=so+Ft+nu+Yt,no="['\u2019]",As="["+Ca+"]",qr="["+vo+"]",xs="["+Bi+"]",hn="\\d+",Ts="["+Uo+"]",wt="["+Ho+"]",_l="[^"+Ca+vo+hn+Uo+Ho+uo+"]",Us="\\ud83c[\\udffb-\\udfff]",ce="(?:"+xs+"|"+Us+")",Tu="[^"+Ca+"]",ls="(?:\\ud83c[\\udde6-\\uddff]){2}",$o="[\\ud800-\\udbff][\\udc00-\\udfff]",Ke="["+uo+"]",me="\\u200d",Xe="(?:"+wt+"|"+_l+")",Ht="(?:"+Ke+"|"+_l+")",rn="(?:"+no+"(?:d|ll|m|re|s|t|ve))?",Yn="(?:"+no+"(?:D|LL|M|RE|S|T|VE))?",la=ce+"?",mo="["+jo+"]?",lo="(?:"+me+"(?:"+[Tu,ls,$o].join("|")+")"+mo+la+")*",bo="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",qo="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",yc=mo+la+lo,gu="(?:"+[Ts,ls,$o].join("|")+")"+yc,cs="(?:"+[Tu+xs+"?",xs,ls,$o,As].join("|")+")",iu=RegExp(no,"g"),Mu=RegExp(xs,"g"),au=RegExp(Us+"(?="+Us+")|"+cs+yc,"g"),js=RegExp([Ke+"?"+wt+"+"+rn+"(?="+[qr,Ke,"$"].join("|")+")",Ht+"+"+Yn+"(?="+[qr,Ke+Xe,"$"].join("|")+")",Ke+"?"+Xe+"+"+rn,Ke+"+"+Yn,qo,bo,hn,gu].join("|"),"g"),cl=RegExp("["+me+Ca+Bi+jo+"]"),Pu=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,co=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Po=-1,Ha={};Ha[On]=Ha[ln]=Ha[Ka]=Ha[wi]=Ha[fi]=Ha[Ti]=Ha[da]=Ha[ya]=Ha[_s]=!0,Ha[It]=Ha[Lt]=Ha[Ir]=Ha[Ar]=Ha[en]=Ha[nr]=Ha[$r]=Ha[Or]=Ha[Br]=Ha[Jn]=Ha[wn]=Ha[fa]=Ha[_e]=Ha[Pn]=Ha[ys]=!1;var Wa={};Wa[It]=Wa[Lt]=Wa[Ir]=Wa[en]=Wa[Ar]=Wa[nr]=Wa[On]=Wa[ln]=Wa[Ka]=Wa[wi]=Wa[fi]=Wa[Br]=Wa[Jn]=Wa[wn]=Wa[fa]=Wa[_e]=Wa[Pn]=Wa[oa]=Wa[Ti]=Wa[da]=Wa[ya]=Wa[_s]=!0,Wa[$r]=Wa[Or]=Wa[ys]=!1;var Yh={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Bc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Nc={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},xl={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},bl=parseFloat,b=parseInt,L=typeof j=="object"&&j&&j.Object===Object&&j,X=typeof self=="object"&&self&&self.Object===Object&&self,B=L||X||Function("return this")(),se=$&&!$.nodeType&&$,Le=se&&typeof Z=="object"&&Z&&!Z.nodeType&&Z,ot=Le&&Le.exports===se,Et=ot&&L.process,Pt=function(){try{var At=Le&&Le.require&&Le.require("util").types;return At||Et&&Et.binding&&Et.binding("util")}catch(Vr){}}(),zr=Pt&&Pt.isArrayBuffer,Kr=Pt&&Pt.isDate,oi=Pt&&Pt.isMap,Ki=Pt&&Pt.isRegExp,Li=Pt&&Pt.isSet,Oa=Pt&&Pt.isTypedArray;function sa(At,Vr,yr){switch(yr.length){case 0:return At.call(Vr);case 1:return At.call(Vr,yr[0]);case 2:return At.call(Vr,yr[0],yr[1]);case 3:return At.call(Vr,yr[0],yr[1],yr[2])}return At.apply(Vr,yr)}function Va(At,Vr,yr,gi){for(var Qn=-1,Hi=At==null?0:At.length;++Qn<Hi;){var Da=At[Qn];Vr(gi,Da,yr(Da),At)}return gi}function Qo(At,Vr){for(var yr=-1,gi=At==null?0:At.length;++yr<gi&&Vr(At[yr],yr,At)!==!1;);return At}function yu(At,Vr){for(var yr=At==null?0:At.length;yr--&&Vr(At[yr],yr,At)!==!1;);return At}function Ma(At,Vr){for(var yr=-1,gi=At==null?0:At.length;++yr<gi;)if(!Vr(At[yr],yr,At))return!1;return!0}function Jo(At,Vr){for(var yr=-1,gi=At==null?0:At.length,Qn=0,Hi=[];++yr<gi;){var Da=At[yr];Vr(Da,yr,At)&&(Hi[Qn++]=Da)}return Hi}function _c(At,Vr){var yr=At==null?0:At.length;return!!yr&&fl(At,Vr,0)>-1}function tc(At,Vr,yr){for(var gi=-1,Qn=At==null?0:At.length;++gi<Qn;)if(yr(Vr,At[gi]))return!0;return!1}function Eo(At,Vr){for(var yr=-1,gi=At==null?0:At.length,Qn=Array(gi);++yr<gi;)Qn[yr]=Vr(At[yr],yr,At);return Qn}function El(At,Vr){for(var yr=-1,gi=Vr.length,Qn=At.length;++yr<gi;)At[Qn+yr]=Vr[yr];return At}function wf(At,Vr,yr,gi){var Qn=-1,Hi=At==null?0:At.length;for(gi&&Hi&&(yr=At[++Qn]);++Qn<Hi;)yr=Vr(yr,At[Qn],Qn,At);return yr}function Sl(At,Vr,yr,gi){var Qn=At==null?0:At.length;for(gi&&Qn&&(yr=At[--Qn]);Qn--;)yr=Vr(yr,At[Qn],Qn,At);return yr}function xa(At,Vr){for(var yr=-1,gi=At==null?0:At.length;++yr<gi;)if(Vr(At[yr],yr,At))return!0;return!1}var Fl=Nl("length");function Ah(At){return At.split("")}function fs(At){return At.match(Gn)||[]}function Af(At,Vr,yr){var gi;return yr(At,function(Qn,Hi,Da){if(Vr(Qn,Hi,Da))return gi=Hi,!1}),gi}function tl(At,Vr,yr,gi){for(var Qn=At.length,Hi=yr+(gi?1:-1);gi?Hi--:++Hi<Qn;)if(Vr(At[Hi],Hi,At))return Hi;return-1}function fl(At,Vr,yr){return Vr===Vr?qf(At,Vr,yr):tl(At,Bl,yr)}function xc(At,Vr,yr,gi){for(var Qn=yr-1,Hi=At.length;++Qn<Hi;)if(gi(At[Qn],Vr))return Qn;return-1}function Bl(At){return At!==At}function zc(At,Vr){var yr=At==null?0:At.length;return yr?Uc(At,Vr)/yr:Dt}function Nl(At){return function(Vr){return Vr==null?k:Vr[At]}}function fo(At){return function(Vr){return At==null?k:At[Vr]}}function nf(At,Vr,yr,gi,Qn){return Qn(At,function(Hi,Da,Ya){yr=gi?(gi=!1,Hi):Vr(yr,Hi,Da,Ya)}),yr}function Ap(At,Vr){var yr=At.length;for(At.sort(Vr);yr--;)At[yr]=At[yr].value;return At}function Uc(At,Vr){for(var yr,gi=-1,Qn=At.length;++gi<Qn;){var Hi=Vr(At[gi]);Hi!==k&&(yr=yr===k?Hi:yr+Hi)}return yr}function Th(At,Vr){for(var yr=-1,gi=Array(At);++yr<At;)gi[yr]=Vr(yr);return gi}function Kp(At,Vr){return Eo(Vr,function(yr){return[yr,At[yr]]})}function Kh(At){return At&&At.slice(0,Mf(At)+1).replace(Nr,"")}function ou(At){return function(Vr){return At(Vr)}}function zl(At,Vr){return Eo(Vr,function(yr){return At[yr]})}function hl(At,Vr){return At.has(Vr)}function jc(At,Vr){for(var yr=-1,gi=At.length;++yr<gi&&fl(Vr,At[yr],0)>-1;);return yr}function Ul(At,Vr){for(var yr=At.length;yr--&&fl(Vr,At[yr],0)>-1;);return yr}function af(At,Vr){for(var yr=At.length,gi=0;yr--;)At[yr]===Vr&&++gi;return gi}var Mh=fo(Yh),of=fo(Bc);function es(At){return"\\"+xl[At]}function $h(At,Vr){return At==null?k:At[Vr]}function Vc(At){return cl.test(At)}function qh(At){return Pu.test(At)}function rc(At){for(var Vr,yr=[];!(Vr=At.next()).done;)yr.push(Vr.value);return yr}function nc(At){var Vr=-1,yr=Array(At.size);return At.forEach(function(gi,Qn){yr[++Vr]=[Qn,gi]}),yr}function Tf(At,Vr){return function(yr){return At(Vr(yr))}}function ic(At,Vr){for(var yr=-1,gi=At.length,Qn=0,Hi=[];++yr<gi;){var Da=At[yr];(Da===Vr||Da===vt)&&(At[yr]=vt,Hi[Qn++]=yr)}return Hi}function sf(At){var Vr=-1,yr=Array(At.size);return At.forEach(function(gi){yr[++Vr]=gi}),yr}function $f(At){var Vr=-1,yr=Array(At.size);return At.forEach(function(gi){yr[++Vr]=[gi,gi]}),yr}function qf(At,Vr,yr){for(var gi=yr-1,Qn=At.length;++gi<Qn;)if(At[gi]===Vr)return gi;return-1}function Qf(At,Vr,yr){for(var gi=yr+1;gi--;)if(At[gi]===Vr)return gi;return gi}function jl(At){return Vc(At)?Jf(At):Fl(At)}function Cl(At){return Vc(At)?Jh(At):Ah(At)}function Mf(At){for(var Vr=At.length;Vr--&&Xr.test(At.charAt(Vr)););return Vr}var Qh=fo(Nc);function Jf(At){for(var Vr=au.lastIndex=0;au.test(At);)++Vr;return Vr}function Jh(At){return At.match(au)||[]}function eh(At){return At.match(js)||[]}var Pf=function At(Vr){Vr=Vr==null?B:wl.defaults(B.Object(),Vr,wl.pick(B,co));var yr=Vr.Array,gi=Vr.Date,Qn=Vr.Error,Hi=Vr.Function,Da=Vr.Math,Ya=Vr.Object,uf=Vr.RegExp,lf=Vr.String,Vl=Vr.TypeError,ep=yr.prototype,Ph=Hi.prototype,ac=Ya.prototype,pl=Vr["__core-js_shared__"],$i=Ph.toString,io=ac.hasOwnProperty,di=0,qa=function(){var p=/[^.]+$/.exec(pl&&pl.keys&&pl.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),Kn=ac.toString,Gu=$i.call(Ya),cf=B._,Gc=uf("^"+$i.call(io).replace(Ye,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Hu=ot?Vr.Buffer:k,bs=Vr.Symbol,ff=Vr.Uint8Array,Ln=Hu?Hu.allocUnsafe:k,Gl=Tf(Ya.getPrototypeOf,Ya),hs=Ya.create,hf=ac.propertyIsEnumerable,Vs=ep.splice,Ms=bs?bs.isConcatSpreadable:k,bc=bs?bs.iterator:k,Hl=bs?bs.toStringTag:k,_u=function(){try{var p=he(Ya,"defineProperty");return p({},"",{}),p}catch(x){}}(),Ec=Vr.clearTimeout!==B.clearTimeout&&Vr.clearTimeout,tp=gi&&gi.now!==B.Date.now&&gi.now,th=Vr.setTimeout!==B.setTimeout&&Vr.setTimeout,Hc=Da.ceil,pf=Da.floor,Wu=Ya.getOwnPropertySymbols,rl=Hu?Hu.isBuffer:k,ma=Vr.isFinite,Al=ep.join,Tl=Tf(Ya.keys,Ya),Za=Da.max,ts=Da.min,Wc=gi.now,Gs=Vr.parseInt,ps=Da.random,Of=ep.reverse,bi=he(Vr,"DataView"),si=he(Vr,"Map"),Zc=he(Vr,"Promise"),ko=he(Vr,"Set"),Zu=he(Vr,"WeakMap"),ds=he(Ya,"create"),nl=Zu&&new Zu,Sc={},vs=Zo(bi),Qa=Zo(si),Hs=Zo(Zc),Cc=Zo(ko),Wl=Zo(Zu),dl=bs?bs.prototype:k,Ou=dl?dl.valueOf:k,Iu=dl?dl.toString:k;function Pe(p){if(Cs(p)&&!Xi(p)&&!(p instanceof Fa)){if(p instanceof su)return p;if(io.call(p,"__wrapped__"))return Os(p)}return new su(p)}var xu=function(){function p(){}return function(x){if(!Go(x))return{};if(hs)return hs(x);p.prototype=x;var O=new p;return p.prototype=k,O}}();function df(){}function su(p,x){this.__wrapped__=p,this.__actions__=[],this.__chain__=!!x,this.__index__=0,this.__values__=k}Pe.templateSettings={escape:xe,evaluate:Me,interpolate:Ve,variable:"",imports:{_:Pe}},Pe.prototype=df.prototype,Pe.prototype.constructor=Pe,su.prototype=xu(df.prototype),su.prototype.constructor=su;function Fa(p){this.__wrapped__=p,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=w,this.__views__=[]}function rp(){var p=new Fa(this.__wrapped__);return p.__actions__=uu(this.__actions__),p.__dir__=this.__dir__,p.__filtered__=this.__filtered__,p.__iteratees__=uu(this.__iteratees__),p.__takeCount__=this.__takeCount__,p.__views__=uu(this.__views__),p}function Zl(){if(this.__filtered__){var p=new Fa(this);p.__dir__=-1,p.__filtered__=!0}else p=this.clone(),p.__dir__*=-1;return p}function If(){var p=this.__wrapped__.value(),x=this.__dir__,O=Xi(p),G=x<0,fe=O?p.length:0,ke=cr(0,fe,this.__views__),lt=ke.start,Rt=ke.end,or=Rt-lt,cn=G?Rt:lt-1,fn=this.__iteratees__,Mn=fn.length,Si=0,ra=ts(or,this.__takeCount__);if(!O||!G&&fe==or&&ra==or)return yf(p,this.__actions__);var Aa=[];e:for(;or--&&Si<ra;){cn+=x;for(var ro=-1,Ta=p[cn];++ro<Mn;){var _o=fn[ro],Mo=_o.iteratee,Ef=_o.type,Rc=Mo(Ta);if(Ef==be)Ta=Rc;else if(!Rc){if(Ef==kr)continue e;break e}}Aa[Si++]=Ta}return Aa}Fa.prototype=xu(df.prototype),Fa.prototype.constructor=Fa;function Xl(p){var x=-1,O=p==null?0:p.length;for(this.clear();++x<O;){var G=p[x];this.set(G[0],G[1])}}function wc(){this.__data__=ds?ds(null):{},this.size=0}function Ml(p){var x=this.has(p)&&delete this.__data__[p];return this.size-=x?1:0,x}function Ac(p){var x=this.__data__;if(ds){var O=x[p];return O===Oe?k:O}return io.call(x,p)?x[p]:k}function Pl(p){var x=this.__data__;return ds?x[p]!==k:io.call(x,p)}function bu(p,x){var O=this.__data__;return this.size+=this.has(p)?0:1,O[p]=ds&&x===k?Oe:x,this}Xl.prototype.clear=wc,Xl.prototype.delete=Ml,Xl.prototype.get=Ac,Xl.prototype.has=Pl,Xl.prototype.set=bu;function Xu(p){var x=-1,O=p==null?0:p.length;for(this.clear();++x<O;){var G=p[x];this.set(G[0],G[1])}}function Ru(){this.__data__=[],this.size=0}function Rf(p){var x=this.__data__,O=Tr(x,p);if(O<0)return!1;var G=x.length-1;return O==G?x.pop():Vs.call(x,O,1),--this.size,!0}function Oh(p){var x=this.__data__,O=Tr(x,p);return O<0?k:x[O][1]}function d(p){return Tr(this.__data__,p)>-1}function f(p,x){var O=this.__data__,G=Tr(O,p);return G<0?(++this.size,O.push([p,x])):O[G][1]=x,this}Xu.prototype.clear=Ru,Xu.prototype.delete=Rf,Xu.prototype.get=Oh,Xu.prototype.has=d,Xu.prototype.set=f;function l(p){var x=-1,O=p==null?0:p.length;for(this.clear();++x<O;){var G=p[x];this.set(G[0],G[1])}}function m(){this.size=0,this.__data__={hash:new Xl,map:new(si||Xu),string:new Xl}}function C(p){var x=xf(this,p).delete(p);return this.size-=x?1:0,x}function P(p){return xf(this,p).get(p)}function D(p){return xf(this,p).has(p)}function N(p,x){var O=xf(this,p),G=O.size;return O.set(p,x),this.size+=O.size==G?0:1,this}l.prototype.clear=m,l.prototype.delete=C,l.prototype.get=P,l.prototype.has=D,l.prototype.set=N;function K(p){var x=-1,O=p==null?0:p.length;for(this.__data__=new l;++x<O;)this.add(p[x])}function re(p){return this.__data__.set(p,Oe),this}function ge(p){return this.__data__.has(p)}K.prototype.add=K.prototype.push=re,K.prototype.has=ge;function ye(p){var x=this.__data__=new Xu(p);this.size=x.size}function we(){this.__data__=new Xu,this.size=0}function We(p){var x=this.__data__,O=x.delete(p);return this.size=x.size,O}function Ue(p){return this.__data__.get(p)}function tt(p){return this.__data__.has(p)}function Ze(p,x){var O=this.__data__;if(O instanceof Xu){var G=O.__data__;if(!si||G.length<V-1)return G.push([p,x]),this.size=++O.size,this;O=this.__data__=new l(G)}return O.set(p,x),this.size=O.size,this}ye.prototype.clear=we,ye.prototype.delete=We,ye.prototype.get=Ue,ye.prototype.has=tt,ye.prototype.set=Ze;function $e(p,x){var O=Xi(p),G=!O&&Au(p),fe=!O&&!G&&gl(p),ke=!O&&!G&&!fe&&Hf(p),lt=O||G||fe||ke,Rt=lt?Th(p.length,lf):[],or=Rt.length;for(var cn in p)(x||io.call(p,cn))&&!(lt&&(cn=="length"||fe&&(cn=="offset"||cn=="parent")||ke&&(cn=="buffer"||cn=="byteLength"||cn=="byteOffset")||Zr(cn,or)))&&Rt.push(cn);return Rt}function Ot(p){var x=p.length;return x?p[qp(0,x-1)]:k}function Mt(p,x){return Ao(uu(p),yi(x,0,p.length))}function Sr(p){return Ao(uu(p))}function qt(p,x,O){(O!==k&&!Nu(p[x],O)||O===k&&!(x in p))&&Vn(p,x,O)}function gr(p,x,O){var G=p[x];(!(io.call(p,x)&&Nu(G,O))||O===k&&!(x in p))&&Vn(p,x,O)}function Tr(p,x){for(var O=p.length;O--;)if(Nu(p[O][0],x))return O;return-1}function Dr(p,x,O,G){return ui(p,function(fe,ke,lt){x(G,fe,O(fe),lt)}),G}function nn(p,x){return p&&fc(x,ks(x),p)}function An(p,x){return p&&fc(x,Uu(x),p)}function Vn(p,x,O){x=="__proto__"&&_u?_u(p,x,{configurable:!0,enumerable:!0,value:O,writable:!0}):p[x]=O}function mi(p,x){for(var O=-1,G=x.length,fe=yr(G),ke=p==null;++O<G;)fe[O]=ke?k:yl(p,x[O]);return fe}function yi(p,x,O){return p===p&&(O!==k&&(p=p<=O?p:O),x!==k&&(p=p>=x?p:x)),p}function Ni(p,x,O,G,fe,ke){var lt,Rt=x&at,or=x&gt,cn=x&yt;if(O&&(lt=fe?O(p,G,fe,ke):O(p)),lt!==k)return lt;if(!Go(p))return p;var fn=Xi(p);if(fn){if(lt=an(p),!Rt)return uu(p,lt)}else{var Mn=lr(p),Si=Mn==Or||Mn==_r;if(gl(p))return Bf(p,Rt);if(Mn==wn||Mn==It||Si&&!fe){if(lt=or||Si?{}:un(p),!Rt)return or?Td(p,An(lt,p)):lv(p,nn(lt,p))}else{if(!Wa[Mn])return fe?p:{};lt=on(p,Mn,Rt)}}ke||(ke=new ye);var ra=ke.get(p);if(ra)return ra;ke.set(p,lt),Np(p)?p.forEach(function(Ta){lt.add(Ni(Ta,x,O,Ta,p,ke))}):fd(p)&&p.forEach(function(Ta,_o){lt.set(_o,Ni(Ta,x,O,_o,p,ke))});var Aa=cn?or?fp:cp:or?Uu:ks,ro=fn?k:Aa(p);return Qo(ro||p,function(Ta,_o){ro&&(_o=Ta,Ta=p[_o]),gr(lt,_o,Ni(Ta,x,O,_o,p,ke))}),lt}function Ii(p){var x=ks(p);return function(O){return $n(O,p,x)}}function $n(p,x,O){var G=O.length;if(p==null)return!G;for(p=Ya(p);G--;){var fe=O[G],ke=x[fe],lt=p[fe];if(lt===k&&!(fe in p)||!ke(lt))return!1}return!0}function zi(p,x,O){if(typeof p!="function")throw new Vl(te);return Dn(function(){p.apply(k,O)},x)}function Wi(p,x,O,G){var fe=-1,ke=_c,lt=!0,Rt=p.length,or=[],cn=x.length;if(!Rt)return or;O&&(x=Eo(x,ou(O))),G?(ke=tc,lt=!1):x.length>=V&&(ke=hl,lt=!1,x=new K(x));e:for(;++fe<Rt;){var fn=p[fe],Mn=O==null?fn:O(fn);if(fn=G||fn!==0?fn:0,lt&&Mn===Mn){for(var Si=cn;Si--;)if(x[Si]===Mn)continue e;or.push(fn)}else ke(x,Mn,G)||or.push(fn)}return or}var ui=Op(Ja),ea=Op(Eu,!0);function Ai(p,x){var O=!0;return ui(p,function(G,fe,ke){return O=!!x(G,fe,ke),O}),O}function na(p,x,O){for(var G=-1,fe=p.length;++G<fe;){var ke=p[G],lt=x(ke);if(lt!=null&&(Rt===k?lt===lt&&!qu(lt):O(lt,Rt)))var Rt=lt,or=ke}return or}function wa(p,x,O,G){var fe=p.length;for(O=ja(O),O<0&&(O=-O>fe?0:fe+O),G=G===k||G>fe?fe:ja(G),G<0&&(G+=fe),G=O>G?0:gp(G);O<G;)p[O++]=x;return p}function rs(p,x){var O=[];return ui(p,function(G,fe,ke){x(G,fe,ke)&&O.push(G)}),O}function ka(p,x,O,G,fe){var ke=-1,lt=p.length;for(O||(O=En),fe||(fe=[]);++ke<lt;){var Rt=p[ke];x>0&&O(Rt)?x>1?ka(Rt,x-1,O,G,fe):El(fe,Rt):G||(fe[fe.length]=Rt)}return fe}var ms=jf(),Oo=jf(!0);function Ja(p,x){return p&&ms(p,x,ks)}function Eu(p,x){return p&&Oo(p,x,ks)}function ho(p,x){return Jo(x,function(O){return dc(p[O])})}function Yu(p,x){x=Il(x,p);for(var O=0,G=x.length;p!=null&&O<G;)p=p[ia(x[O++])];return O&&O==G?p:k}function Su(p,x,O){var G=x(p);return Xi(p)?G:El(G,O(p))}function go(p){return p==null?p===k?ws:mn:Hl&&Hl in Ya(p)?qe(p):sn(p)}function Ws(p,x){return p>x}function Es(p,x){return p!=null&&io.call(p,x)}function Lu(p,x){return p!=null&&x in Ya(p)}function oc(p,x,O){return p>=ts(x,O)&&p<Za(x,O)}function sc(p,x,O){for(var G=O?tc:_c,fe=p[0].length,ke=p.length,lt=ke,Rt=yr(ke),or=Infinity,cn=[];lt--;){var fn=p[lt];lt&&x&&(fn=Eo(fn,ou(x))),or=ts(fn.length,or),Rt[lt]=!O&&(x||fe>=120&&fn.length>=120)?new K(lt&&fn):k}fn=p[0];var Mn=-1,Si=Rt[0];e:for(;++Mn<fe&&cn.length<or;){var ra=fn[Mn],Aa=x?x(ra):ra;if(ra=O||ra!==0?ra:0,!(Si?hl(Si,Aa):G(cn,Aa,O))){for(lt=ke;--lt;){var ro=Rt[lt];if(!(ro?hl(ro,Aa):G(p[lt],Aa,O)))continue e}Si&&Si.push(Aa),cn.push(ra)}}return cn}function Tc(p,x,O,G){return Ja(p,function(fe,ke,lt){x(G,O(fe),ke,lt)}),G}function ku(p,x,O){x=Il(x,p),p=Tn(p,x);var G=p==null?p:p[ia(st(x))];return G==null?k:sa(G,p,O)}function Xc(p){return Cs(p)&&go(p)==It}function Ol(p){return Cs(p)&&go(p)==Ir}function Ps(p){return Cs(p)&&go(p)==nr}function Ku(p,x,O,G,fe){return p===x?!0:p==null||x==null||!Cs(p)&&!Cs(x)?p!==p&&x!==x:rh(p,x,O,G,Ku,fe)}function rh(p,x,O,G,fe,ke){var lt=Xi(p),Rt=Xi(x),or=lt?Lt:lr(p),cn=Rt?Lt:lr(x);or=or==It?wn:or,cn=cn==It?wn:cn;var fn=or==wn,Mn=cn==wn,Si=or==cn;if(Si&&gl(p)){if(!gl(x))return!1;lt=!0,fn=!1}if(Si&&!fn)return ke||(ke=new ye),lt||Hf(p)?td(p,x,O,G,fe,ke):pv(p,x,or,O,G,fe,ke);if(!(O&St)){var ra=fn&&io.call(p,"__wrapped__"),Aa=Mn&&io.call(x,"__wrapped__");if(ra||Aa){var ro=ra?p.value():p,Ta=Aa?x.value():x;return ke||(ke=new ye),fe(ro,Ta,O,G,ke)}}return Si?(ke||(ke=new ye),dv(p,x,O,G,fe,ke)):!1}function uc(p){return Cs(p)&&lr(p)==Br}function Ss(p,x,O,G){var fe=O.length,ke=fe,lt=!G;if(p==null)return!ke;for(p=Ya(p);fe--;){var Rt=O[fe];if(lt&&Rt[2]?Rt[1]!==p[Rt[0]]:!(Rt[0]in p))return!1}for(;++fe<ke;){Rt=O[fe];var or=Rt[0],cn=p[or],fn=Rt[1];if(lt&&Rt[2]){if(cn===k&&!(or in p))return!1}else{var Mn=new ye;if(G)var Si=G(cn,fn,or,p,x,Mn);if(!(Si===k?Ku(fn,cn,St|He,G,Mn):Si))return!1}}return!0}function Cu(p){if(!Go(p)||Er(p))return!1;var x=dc(p)?Gc:ha;return x.test(Zo(p))}function Fs(p){return Cs(p)&&go(p)==fa}function Du(p){return Cs(p)&&lr(p)==_e}function Bs(p){return Cs(p)&&mh(p.length)&&!!Ha[go(p)]}function Fu(p){return typeof p=="function"?p:p==null?Ic:typeof p=="object"?Xi(p)?vl(p[0],p[1]):lc(p):Xm(p)}function vf(p){if(!Bn(p))return Tl(p);var x=[];for(var O in Ya(p))io.call(p,O)&&O!="constructor"&&x.push(O);return x}function Yc(p){if(!Go(p))return Sn(p);var x=Bn(p),O=[];for(var G in p)G=="constructor"&&(x||!io.call(p,G))||O.push(G);return O}function Kc(p,x){return p<x}function Yl(p,x){var O=-1,G=vu(p)?yr(p.length):[];return ui(p,function(fe,ke,lt){G[++O]=x(fe,ke,lt)}),G}function lc(p){var x=J(p);return x.length==1&&x[0][2]?Rr(x[0][0],x[0][1]):function(O){return O===p||Ss(O,p,x)}}function vl(p,x){return tr(p)&&pn(x)?Rr(ia(p),x):function(O){var G=yl(O,p);return G===k&&G===x?jd(O,p):Ku(x,G,St|He)}}function Zs(p,x,O,G,fe){p!==x&&ms(x,function(ke,lt){if(fe||(fe=new ye),Go(ke))Xs(p,x,lt,O,Zs,G,fe);else{var Rt=G?G(ji(p,lt),ke,lt+"",p,x,fe):k;Rt===k&&(Rt=ke),qt(p,lt,Rt)}},Uu)}function Xs(p,x,O,G,fe,ke,lt){var Rt=ji(p,O),or=ji(x,O),cn=lt.get(or);if(cn){qt(p,O,cn);return}var fn=ke?ke(Rt,or,O+"",p,x,lt):k,Mn=fn===k;if(Mn){var Si=Xi(or),ra=!Si&&gl(or),Aa=!Si&&!ra&&Hf(or);fn=or,Si||ra||Aa?Xi(Rt)?fn=Rt:Ko(Rt)?fn=uu(Rt):ra?(Mn=!1,fn=Bf(or,!0)):Aa?(Mn=!1,fn=kh(or,!0)):fn=[]:gh(or)||Au(or)?(fn=Rt,Au(Rt)?fn=vc(Rt):(!Go(Rt)||dc(Rt))&&(fn=un(or))):Mn=!1}Mn&&(lt.set(or,fn),fe(fn,or,G,ke,lt),lt.delete(or)),qt(p,O,fn)}function np(p,x){var O=p.length;if(!!O)return x+=x<0?O:0,Zr(x,O)?p[x]:k}function nh(p,x,O){x.length?x=Eo(x,function(ke){return Xi(ke)?function(lt){return Yu(lt,ke.length===1?ke[0]:ke)}:ke}):x=[Ic];var G=-1;x=Eo(x,ou(Ui()));var fe=Yl(p,function(ke,lt,Rt){var or=Eo(x,function(cn){return cn(ke)});return{criteria:or,index:++G,value:ke}});return Ap(fe,function(ke,lt){return Pp(ke,lt,O)})}function $p(p,x){return Tp(p,x,function(O,G){return jd(p,G)})}function Tp(p,x,O){for(var G=-1,fe=x.length,ke={};++G<fe;){var lt=x[G],Rt=Yu(p,lt);O(Rt,lt)&&ah(ke,Il(lt,p),Rt)}return ke}function Ih(p){return function(x){return Yu(x,p)}}function Lf(p,x,O,G){var fe=G?xc:fl,ke=-1,lt=x.length,Rt=p;for(p===x&&(x=uu(x)),O&&(Rt=Eo(p,ou(O)));++ke<lt;)for(var or=0,cn=x[ke],fn=O?O(cn):cn;(or=fe(Rt,fn,or,G))>-1;)Rt!==p&&Vs.call(Rt,or,1),Vs.call(p,or,1);return p}function mf(p,x){for(var O=p?x.length:0,G=O-1;O--;){var fe=x[O];if(O==G||fe!==ke){var ke=fe;Zr(fe)?Vs.call(p,fe,1):Mp(p,fe)}}return p}function qp(p,x){return p+pf(ps()*(x-p+1))}function ip(p,x,O,G){for(var fe=-1,ke=Za(Hc((x-p)/(O||1)),0),lt=yr(ke);ke--;)lt[G?ke:++fe]=p,p+=O;return lt}function ap(p,x){var O="";if(!p||x<1||x>pt)return O;do x%2&&(O+=p),x=pf(x/2),x&&(p+=p);while(x);return O}function ba(p,x){return Mi(In(p,x,Ic),p+"")}function Rh(p){return Ot(_h(p))}function ih(p,x){var O=_h(p);return Ao(O,yi(x,0,O.length))}function ah(p,x,O,G){if(!Go(p))return p;x=Il(x,p);for(var fe=-1,ke=x.length,lt=ke-1,Rt=p;Rt!=null&&++fe<ke;){var or=ia(x[fe]),cn=O;if(or==="__proto__"||or==="constructor"||or==="prototype")return p;if(fe!=lt){var fn=Rt[or];cn=G?G(fn,or,Rt):k,cn===k&&(cn=Go(fn)?fn:Zr(x[fe+1])?[]:{})}gr(Rt,or,cn),Rt=Rt[or]}return p}var wd=nl?function(p,x){return nl.set(p,x),p}:Ic,Ad=_u?function(p,x){return _u(p,"toString",{configurable:!0,enumerable:!1,value:Lv(x),writable:!0})}:Ic;function Qp(p){return Ao(_h(p))}function cc(p,x,O){var G=-1,fe=p.length;x<0&&(x=-x>fe?0:fe+x),O=O>fe?fe:O,O<0&&(O+=fe),fe=x>O?0:O-x>>>0,x>>>=0;for(var ke=yr(fe);++G<fe;)ke[G]=p[G+x];return ke}function sv(p,x){var O;return ui(p,function(G,fe,ke){return O=x(G,fe,ke),!O}),!!O}function Lh(p,x,O){var G=0,fe=p==null?G:p.length;if(typeof x=="number"&&x===x&&fe<=Ut){for(;G<fe;){var ke=G+fe>>>1,lt=p[ke];lt!==null&&!qu(lt)&&(O?lt<=x:lt<x)?G=ke+1:fe=ke}return fe}return Jp(p,x,Ic,O)}function Jp(p,x,O,G){var fe=0,ke=p==null?0:p.length;if(ke===0)return 0;x=O(x);for(var lt=x!==x,Rt=x===null,or=qu(x),cn=x===k;fe<ke;){var fn=pf((fe+ke)/2),Mn=O(p[fn]),Si=Mn!==k,ra=Mn===null,Aa=Mn===Mn,ro=qu(Mn);if(lt)var Ta=G||Aa;else cn?Ta=Aa&&(G||Si):Rt?Ta=Aa&&Si&&(G||!ra):or?Ta=Aa&&Si&&!ra&&(G||!ro):ra||ro?Ta=!1:Ta=G?Mn<=x:Mn<x;Ta?fe=fn+1:ke=fn}return ts(ke,br)}function oh(p,x){for(var O=-1,G=p.length,fe=0,ke=[];++O<G;){var lt=p[O],Rt=x?x(lt):lt;if(!O||!Nu(Rt,or)){var or=Rt;ke[fe++]=lt===0?0:lt}}return ke}function uv(p){return typeof p=="number"?p:qu(p)?Dt:+p}function Cr(p){if(typeof p=="string")return p;if(Xi(p))return Eo(p,Cr)+"";if(qu(p))return Iu?Iu.call(p):"";var x=p+"";return x=="0"&&1/p==-Ie?"-0":x}function Mc(p,x,O){var G=-1,fe=_c,ke=p.length,lt=!0,Rt=[],or=Rt;if(O)lt=!1,fe=tc;else if(ke>=V){var cn=x?null:Vf(p);if(cn)return sf(cn);lt=!1,fe=hl,or=new K}else or=x?[]:Rt;e:for(;++G<ke;){var fn=p[G],Mn=x?x(fn):fn;if(fn=O||fn!==0?fn:0,lt&&Mn===Mn){for(var Si=or.length;Si--;)if(or[Si]===Mn)continue e;x&&or.push(Mn),Rt.push(fn)}else fe(or,Mn,O)||(or!==Rt&&or.push(Mn),Rt.push(fn))}return Rt}function Mp(p,x){return x=Il(x,p),p=Tn(p,x),p==null||delete p[ia(st(x))]}function sr(p,x,O,G){return ah(p,x,O(Yu(p,x)),G)}function gf(p,x,O,G){for(var fe=p.length,ke=G?fe:-1;(G?ke--:++ke<fe)&&x(p[ke],ke,p););return O?cc(p,G?0:ke,G?ke+1:fe):cc(p,G?ke+1:0,G?fe:ke)}function yf(p,x){var O=p;return O instanceof Fa&&(O=O.value()),wf(x,function(G,fe){return fe.func.apply(fe.thisArg,El([G],fe.args))},O)}function kf(p,x,O){var G=p.length;if(G<2)return G?Mc(p[0]):[];for(var fe=-1,ke=yr(G);++fe<G;)for(var lt=p[fe],Rt=-1;++Rt<G;)Rt!=fe&&(ke[fe]=Wi(ke[fe]||lt,p[Rt],x,O));return Mc(ka(ke,1),x,O)}function sh(p,x,O){for(var G=-1,fe=p.length,ke=x.length,lt={};++G<fe;){var Rt=G<ke?x[G]:k;O(lt,p[G],Rt)}return lt}function $c(p){return Ko(p)?p:[]}function Df(p){return typeof p=="function"?p:Ic}function Il(p,x){return Xi(p)?p:tr(p,x)?[p]:ns(oo(p))}var Ff=ba;function Rl(p,x,O){var G=p.length;return O=O===k?G:O,!x&&O>=G?p:cc(p,x,O)}var op=Ec||function(p){return B.clearTimeout(p)};function Bf(p,x){if(x)return p.slice();var O=p.length,G=Ln?Ln(O):new p.constructor(O);return p.copy(G),G}function uh(p){var x=new p.constructor(p.byteLength);return new ff(x).set(new ff(p)),x}function Nf(p,x){var O=x?uh(p.buffer):p.buffer;return new p.constructor(O,p.byteOffset,p.byteLength)}function zf(p){var x=new p.constructor(p.source,Nn.exec(p));return x.lastIndex=p.lastIndex,x}function il(p){return Ou?Ya(Ou.call(p)):{}}function kh(p,x){var O=x?uh(p.buffer):p.buffer;return new p.constructor(O,p.byteOffset,p.length)}function lh(p,x){if(p!==x){var O=p!==k,G=p===null,fe=p===p,ke=qu(p),lt=x!==k,Rt=x===null,or=x===x,cn=qu(x);if(!Rt&&!cn&&!ke&&p>x||ke&&lt&&or&&!Rt&&!cn||G&&lt&&or||!O&&or||!fe)return 1;if(!G&&!ke&&!cn&&p<x||cn&&O&&fe&&!G&&!ke||Rt&&O&&fe||!lt&&fe||!or)return-1}return 0}function Pp(p,x,O){for(var G=-1,fe=p.criteria,ke=x.criteria,lt=fe.length,Rt=O.length;++G<lt;){var or=lh(fe[G],ke[G]);if(or){if(G>=Rt)return or;var cn=O[G];return or*(cn=="desc"?-1:1)}}return p.index-x.index}function Uf(p,x,O,G){for(var fe=-1,ke=p.length,lt=O.length,Rt=-1,or=x.length,cn=Za(ke-lt,0),fn=yr(or+cn),Mn=!G;++Rt<or;)fn[Rt]=x[Rt];for(;++fe<lt;)(Mn||fe<ke)&&(fn[O[fe]]=p[fe]);for(;cn--;)fn[Rt++]=p[fe++];return fn}function _f(p,x,O,G){for(var fe=-1,ke=p.length,lt=-1,Rt=O.length,or=-1,cn=x.length,fn=Za(ke-Rt,0),Mn=yr(fn+cn),Si=!G;++fe<fn;)Mn[fe]=p[fe];for(var ra=fe;++or<cn;)Mn[ra+or]=x[or];for(;++lt<Rt;)(Si||fe<ke)&&(Mn[ra+O[lt]]=p[fe++]);return Mn}function uu(p,x){var O=-1,G=p.length;for(x||(x=yr(G));++O<G;)x[O]=p[O];return x}function fc(p,x,O,G){var fe=!O;O||(O={});for(var ke=-1,lt=x.length;++ke<lt;){var Rt=x[ke],or=G?G(O[Rt],p[Rt],Rt,O,p):k;or===k&&(or=p[Rt]),fe?Vn(O,Rt,or):gr(O,Rt,or)}return O}function lv(p,x){return fc(p,er(p),x)}function Td(p,x){return fc(p,wr(p),x)}function sp(p,x){return function(O,G){var fe=Xi(O)?Va:Dr,ke=x?x():{};return fe(O,p,Ui(G,2),ke)}}function Kl(p){return ba(function(x,O){var G=-1,fe=O.length,ke=fe>1?O[fe-1]:k,lt=fe>2?O[2]:k;for(ke=p.length>3&&typeof ke=="function"?(fe--,ke):k,lt&&Vt(O[0],O[1],lt)&&(ke=fe<3?k:ke,fe=1),x=Ya(x);++G<fe;){var Rt=O[G];Rt&&p(x,Rt,G,ke)}return x})}function Op(p,x){return function(O,G){if(O==null)return O;if(!vu(O))return p(O,G);for(var fe=O.length,ke=x?fe:-1,lt=Ya(O);(x?ke--:++ke<fe)&&G(lt[ke],ke,lt)!==!1;);return O}}function jf(p){return function(x,O,G){for(var fe=-1,ke=Ya(x),lt=G(x),Rt=lt.length;Rt--;){var or=lt[p?Rt:++fe];if(O(ke[or],or,ke)===!1)break}return x}}function ed(p,x,O){var G=x&dt,fe=ml(p);function ke(){var lt=this&&this!==B&&this instanceof ke?fe:p;return lt.apply(G?O:this,arguments)}return ke}function Ip(p){return function(x){x=oo(x);var O=Vc(x)?Cl(x):k,G=O?O[0]:x.charAt(0),fe=O?Rl(O,1).join(""):x.slice(1);return G[p]()+fe}}function qc(p){return function(x){return wf(Gm(Pv(x).replace(iu,"")),p,"")}}function ml(p){return function(){var x=arguments;switch(x.length){case 0:return new p;case 1:return new p(x[0]);case 2:return new p(x[0],x[1]);case 3:return new p(x[0],x[1],x[2]);case 4:return new p(x[0],x[1],x[2],x[3]);case 5:return new p(x[0],x[1],x[2],x[3],x[4]);case 6:return new p(x[0],x[1],x[2],x[3],x[4],x[5]);case 7:return new p(x[0],x[1],x[2],x[3],x[4],x[5],x[6])}var O=xu(p.prototype),G=p.apply(O,x);return Go(G)?G:O}}function Pc(p,x,O){var G=ml(p);function fe(){for(var ke=arguments.length,lt=yr(ke),Rt=ke,or=hh(fe);Rt--;)lt[Rt]=arguments[Rt];var cn=ke<3&&lt[0]!==or&&lt[ke-1]!==or?[]:ic(lt,or);if(ke-=cn.length,ke<O)return ga(p,x,al,fe.placeholder,k,lt,cn,k,k,O-ke);var fn=this&&this!==B&&this instanceof fe?G:p;return sa(fn,this,lt)}return fe}function Rp(p){return function(x,O,G){var fe=Ya(x);if(!vu(x)){var ke=Ui(O,3);x=ks(x),O=function(Rt){return ke(fe[Rt],Rt,fe)}}var lt=p(x,O,G);return lt>-1?fe[ke?x[lt]:lt]:k}}function ch(p){return $l(function(x){var O=x.length,G=O,fe=su.prototype.thru;for(p&&x.reverse();G--;){var ke=x[G];if(typeof ke!="function")throw new Vl(te);if(fe&&!lt&&po(ke)=="wrapper")var lt=new su([],!0)}for(G=lt?G:O;++G<O;){ke=x[G];var Rt=po(ke),or=Rt=="wrapper"?fh(ke):k;or&&zn(or[0])&&or[1]==(Nt|ee|Fr|ze)&&!or[4].length&&or[9]==1?lt=lt[po(or[0])].apply(lt,or[3]):lt=ke.length==1&&zn(ke)?lt[Rt]():lt.thru(ke)}return function(){var cn=arguments,fn=cn[0];if(lt&&cn.length==1&&Xi(fn))return lt.plant(fn).value();for(var Mn=0,Si=O?x[Mn].apply(this,cn):fn;++Mn<O;)Si=x[Mn].call(this,Si);return Si}})}function al(p,x,O,G,fe,ke,lt,Rt,or,cn){var fn=x&Nt,Mn=x&dt,Si=x&ct,ra=x&(ee|rr),Aa=x&zt,ro=Si?k:ml(p);function Ta(){for(var _o=arguments.length,Mo=yr(_o),Ef=_o;Ef--;)Mo[Ef]=arguments[Ef];if(ra)var Rc=hh(Ta),Sf=af(Mo,Rc);if(G&&(Mo=Uf(Mo,G,fe,ra)),ke&&(Mo=_f(Mo,ke,lt,ra)),_o-=Sf,ra&&_o<cn){var Qu=ic(Mo,Rc);return ga(p,x,al,Ta.placeholder,O,Mo,Qu,Rt,or,cn-_o)}var bh=Mn?O:this,Ep=Si?bh[p]:p;return _o=Mo.length,Rt?Mo=ta(Mo,Rt):Aa&&_o>1&&Mo.reverse(),fn&&or<_o&&(Mo.length=or),this&&this!==B&&this instanceof Ta&&(Ep=ro||ml(Ep)),Ep.apply(bh,Mo)}return Ta}function up(p,x){return function(O,G){return Tc(O,p,x(G),{})}}function Dh(p,x){return function(O,G){var fe;if(O===k&&G===k)return x;if(O!==k&&(fe=O),G!==k){if(fe===k)return G;typeof O=="string"||typeof G=="string"?(O=Cr(O),G=Cr(G)):(O=uv(O),G=uv(G)),fe=p(O,G)}return fe}}function Fh(p){return $l(function(x){return x=Eo(x,ou(Ui())),ba(function(O){var G=this;return p(x,function(fe){return sa(fe,G,O)})})})}function lp(p,x){x=x===k?" ":Cr(x);var O=x.length;if(O<2)return O?ap(x,p):x;var G=ap(x,Hc(p/jl(x)));return Vc(x)?Rl(Cl(G),0,p).join(""):G.slice(0,p)}function Ys(p,x,O,G){var fe=x&dt,ke=ml(p);function lt(){for(var Rt=-1,or=arguments.length,cn=-1,fn=G.length,Mn=yr(fn+or),Si=this&&this!==B&&this instanceof lt?ke:p;++cn<fn;)Mn[cn]=G[cn];for(;or--;)Mn[cn++]=arguments[++Rt];return sa(Si,fe?O:this,Mn)}return lt}function Ll(p){return function(x,O,G){return G&&typeof G!="number"&&Vt(x,O,G)&&(O=G=k),x=Uh(x),O===k?(O=x,x=0):O=Uh(O),G=G===k?x<O?1:-1:Uh(G),ip(x,O,G,p)}}function Ba(p){return function(x,O){return typeof x=="string"&&typeof O=="string"||(x=ao(x),O=ao(O)),p(x,O)}}function ga(p,x,O,G,fe,ke,lt,Rt,or,cn){var fn=x&ee,Mn=fn?lt:k,Si=fn?k:lt,ra=fn?ke:k,Aa=fn?k:ke;x|=fn?Fr:Mr,x&=~(fn?Mr:Fr),x&_t||(x&=~(dt|ct));var ro=[p,x,fe,ra,Mn,Aa,Si,Rt,or,cn],Ta=O.apply(k,ro);return zn(p)&&Fn(Ta,ro),Ta.placeholder=G,qi(Ta,p,x)}function Wo(p){var x=Da[p];return function(O,G){if(O=ao(O),G=G==null?0:ts(ja(G),292),G&&ma(O)){var fe=(oo(O)+"e").split("e"),ke=x(fe[0]+"e"+(+fe[1]+G));return fe=(oo(ke)+"e").split("e"),+(fe[0]+"e"+(+fe[1]-G))}return x(O)}}var Vf=ko&&1/sf(new ko([,-0]))[1]==Ie?function(p){return new ko(p)}:hm;function cv(p){return function(x){var O=lr(x);return O==Br?nc(x):O==_e?$f(x):Kp(x,p(x))}}function Qc(p,x,O,G,fe,ke,lt,Rt){var or=x&ct;if(!or&&typeof p!="function")throw new Vl(te);var cn=G?G.length:0;if(cn||(x&=~(Fr|Mr),G=fe=k),lt=lt===k?lt:Za(ja(lt),0),Rt=Rt===k?Rt:ja(Rt),cn-=fe?fe.length:0,x&Mr){var fn=G,Mn=fe;G=fe=k}var Si=or?k:fh(p),ra=[p,x,O,G,fe,fn,Mn,ke,lt,Rt];if(Si&&gn(ra,Si),p=ra[0],x=ra[1],O=ra[2],G=ra[3],fe=ra[4],Rt=ra[9]=ra[9]===k?or?0:p.length:Za(ra[9]-cn,0),!Rt&&x&(ee|rr)&&(x&=~(ee|rr)),!x||x==dt)var Aa=ed(p,x,O);else x==ee||x==rr?Aa=Pc(p,x,Rt):(x==Fr||x==(dt|Fr))&&!fe.length?Aa=Ys(p,x,O,G):Aa=al.apply(k,ra);var ro=Si?wd:Fn;return qi(ro(Aa,ra),p,x)}function fv(p,x,O,G){return p===k||Nu(p,ac[O])&&!io.call(G,O)?x:p}function Md(p,x,O,G,fe,ke){return Go(p)&&Go(x)&&(ke.set(x,p),Zs(p,x,k,Md,ke),ke.delete(x)),p}function hv(p){return gh(p)?k:p}function td(p,x,O,G,fe,ke){var lt=O&St,Rt=p.length,or=x.length;if(Rt!=or&&!(lt&&or>Rt))return!1;var cn=ke.get(p),fn=ke.get(x);if(cn&&fn)return cn==x&&fn==p;var Mn=-1,Si=!0,ra=O&He?new K:k;for(ke.set(p,x),ke.set(x,p);++Mn<Rt;){var Aa=p[Mn],ro=x[Mn];if(G)var Ta=lt?G(ro,Aa,Mn,x,p,ke):G(Aa,ro,Mn,p,x,ke);if(Ta!==k){if(Ta)continue;Si=!1;break}if(ra){if(!xa(x,function(_o,Mo){if(!hl(ra,Mo)&&(Aa===_o||fe(Aa,_o,O,G,ke)))return ra.push(Mo)})){Si=!1;break}}else if(!(Aa===ro||fe(Aa,ro,O,G,ke))){Si=!1;break}}return ke.delete(p),ke.delete(x),Si}function pv(p,x,O,G,fe,ke,lt){switch(O){case en:if(p.byteLength!=x.byteLength||p.byteOffset!=x.byteOffset)return!1;p=p.buffer,x=x.buffer;case Ir:return!(p.byteLength!=x.byteLength||!ke(new ff(p),new ff(x)));case Ar:case nr:case Jn:return Nu(+p,+x);case $r:return p.name==x.name&&p.message==x.message;case fa:case Pn:return p==x+"";case Br:var Rt=nc;case _e:var or=G&St;if(Rt||(Rt=sf),p.size!=x.size&&!or)return!1;var cn=lt.get(p);if(cn)return cn==x;G|=He,lt.set(p,x);var fn=td(Rt(p),Rt(x),G,fe,ke,lt);return lt.delete(p),fn;case oa:if(Ou)return Ou.call(p)==Ou.call(x)}return!1}function dv(p,x,O,G,fe,ke){var lt=O&St,Rt=cp(p),or=Rt.length,cn=cp(x),fn=cn.length;if(or!=fn&&!lt)return!1;for(var Mn=or;Mn--;){var Si=Rt[Mn];if(!(lt?Si in x:io.call(x,Si)))return!1}var ra=ke.get(p),Aa=ke.get(x);if(ra&&Aa)return ra==x&&Aa==p;var ro=!0;ke.set(p,x),ke.set(x,p);for(var Ta=lt;++Mn<or;){Si=Rt[Mn];var _o=p[Si],Mo=x[Si];if(G)var Ef=lt?G(Mo,_o,Si,x,p,ke):G(_o,Mo,Si,p,x,ke);if(!(Ef===k?_o===Mo||fe(_o,Mo,O,G,ke):Ef)){ro=!1;break}Ta||(Ta=Si=="constructor")}if(ro&&!Ta){var Rc=p.constructor,Sf=x.constructor;Rc!=Sf&&"constructor"in p&&"constructor"in x&&!(typeof Rc=="function"&&Rc instanceof Rc&&typeof Sf=="function"&&Sf instanceof Sf)&&(ro=!1)}return ke.delete(p),ke.delete(x),ro}function $l(p){return Mi(In(p,k,hu),p+"")}function cp(p){return Su(p,ks,er)}function fp(p){return Su(p,Uu,wr)}var fh=nl?function(p){return nl.get(p)}:hm;function po(p){for(var x=p.name+"",O=Sc[x],G=io.call(Sc,x)?O.length:0;G--;){var fe=O[G],ke=fe.func;if(ke==null||ke==p)return fe.name}return x}function hh(p){var x=io.call(Pe,"placeholder")?Pe:p;return x.placeholder}function Ui(){var p=Pe.iteratee||Zm;return p=p===Zm?Fu:p,arguments.length?p(arguments[0],arguments[1]):p}function xf(p,x){var O=p.__data__;return Qr(x)?O[typeof x=="string"?"string":"hash"]:O.map}function J(p){for(var x=ks(p),O=x.length;O--;){var G=x[O],fe=p[G];x[O]=[G,fe,pn(fe)]}return x}function he(p,x){var O=$h(p,x);return Cu(O)?O:k}function qe(p){var x=io.call(p,Hl),O=p[Hl];try{p[Hl]=k;var G=!0}catch(ke){}var fe=Kn.call(p);return G&&(x?p[Hl]=O:delete p[Hl]),fe}var er=Wu?function(p){return p==null?[]:(p=Ya(p),Jo(Wu(p),function(x){return hf.call(p,x)}))}:pm,wr=Wu?function(p){for(var x=[];p;)El(x,er(p)),p=Gl(p);return x}:pm,lr=go;(bi&&lr(new bi(new ArrayBuffer(1)))!=en||si&&lr(new si)!=Br||Zc&&lr(Zc.resolve())!=pi||ko&&lr(new ko)!=_e||Zu&&lr(new Zu)!=ys)&&(lr=function(p){var x=go(p),O=x==wn?p.constructor:k,G=O?Zo(O):"";if(G)switch(G){case vs:return en;case Qa:return Br;case Hs:return pi;case Cc:return _e;case Wl:return ys}return x});function cr(p,x,O){for(var G=-1,fe=O.length;++G<fe;){var ke=O[G],lt=ke.size;switch(ke.type){case"drop":p+=lt;break;case"dropRight":x-=lt;break;case"take":x=ts(x,p+lt);break;case"takeRight":p=Za(p,x-lt);break}}return{start:p,end:x}}function Hr(p){var x=p.match(Yr);return x?x[1].split(xn):[]}function tn(p,x,O){x=Il(x,p);for(var G=-1,fe=x.length,ke=!1;++G<fe;){var lt=ia(x[G]);if(!(ke=p!=null&&O(p,lt)))break;p=p[lt]}return ke||++G!=fe?ke:(fe=p==null?0:p.length,!!fe&&mh(fe)&&Zr(lt,fe)&&(Xi(p)||Au(p)))}function an(p){var x=p.length,O=new p.constructor(x);return x&&typeof p[0]=="string"&&io.call(p,"index")&&(O.index=p.index,O.input=p.input),O}function un(p){return typeof p.constructor=="function"&&!Bn(p)?xu(Gl(p)):{}}function on(p,x,O){var G=p.constructor;switch(x){case Ir:return uh(p);case Ar:case nr:return new G(+p);case en:return Nf(p,O);case On:case ln:case Ka:case wi:case fi:case Ti:case da:case ya:case _s:return kh(p,O);case Br:return new G;case Jn:case Pn:return new G(p);case fa:return zf(p);case _e:return new G;case oa:return il(p)}}function kn(p,x){var O=x.length;if(!O)return p;var G=O-1;return x[G]=(O>1?"& ":"")+x[G],x=x.join(O>2?", ":" "),p.replace(dr,`{
/* [wrapped with `+x+`] */
`)}function En(p){return Xi(p)||Au(p)||!!(Ms&&p&&p[Ms])}function Zr(p,x){var O=typeof p;return x=x==null?pt:x,!!x&&(O=="number"||O!="symbol"&&Ji.test(p))&&p>-1&&p%1==0&&p<x}function Vt(p,x,O){if(!Go(O))return!1;var G=typeof x;return(G=="number"?vu(O)&&Zr(x,O.length):G=="string"&&x in O)?Nu(O[x],p):!1}function tr(p,x){if(Xi(p))return!1;var O=typeof p;return O=="number"||O=="symbol"||O=="boolean"||p==null||qu(p)?!0:Ct.test(p)||!ft.test(p)||x!=null&&p in Ya(x)}function Qr(p){var x=typeof p;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?p!=="__proto__":p===null}function zn(p){var x=po(p),O=Pe[x];if(typeof O!="function"||!(x in Fa.prototype))return!1;if(p===O)return!0;var G=fh(O);return!!G&&p===G[0]}function Er(p){return!!qa&&qa in p}var qn=pl?dc:dm;function Bn(p){var x=p&&p.constructor,O=typeof x=="function"&&x.prototype||ac;return p===O}function pn(p){return p===p&&!Go(p)}function Rr(p,x){return function(O){return O==null?!1:O[p]===x&&(x!==k||p in Ya(O))}}function mr(p){var x=Yo(p,function(G){return O.size===Ae&&O.clear(),G}),O=x.cache;return x}function gn(p,x){var O=p[1],G=x[1],fe=O|G,ke=fe<(dt|ct|Nt),lt=G==Nt&&O==ee||G==Nt&&O==ze&&p[7].length<=x[8]||G==(Nt|ze)&&x[7].length<=x[8]&&O==ee;if(!(ke||lt))return p;G&dt&&(p[2]=x[2],fe|=O&dt?0:_t);var Rt=x[3];if(Rt){var or=p[3];p[3]=or?Uf(or,Rt,x[4]):Rt,p[4]=or?ic(p[3],vt):x[4]}return Rt=x[5],Rt&&(or=p[5],p[5]=or?_f(or,Rt,x[6]):Rt,p[6]=or?ic(p[5],vt):x[6]),Rt=x[7],Rt&&(p[7]=Rt),G&Nt&&(p[8]=p[8]==null?x[8]:ts(p[8],x[8])),p[9]==null&&(p[9]=x[9]),p[0]=x[0],p[1]=fe,p}function Sn(p){var x=[];if(p!=null)for(var O in Ya(p))x.push(O);return x}function sn(p){return Kn.call(p)}function In(p,x,O){return x=Za(x===k?p.length-1:x,0),function(){for(var G=arguments,fe=-1,ke=Za(G.length-x,0),lt=yr(ke);++fe<ke;)lt[fe]=G[x+fe];fe=-1;for(var Rt=yr(x+1);++fe<x;)Rt[fe]=G[fe];return Rt[x]=O(lt),sa(p,this,Rt)}}function Tn(p,x){return x.length<2?p:Yu(p,cc(x,0,-1))}function ta(p,x){for(var O=p.length,G=ts(x.length,O),fe=uu(p);G--;){var ke=x[G];p[G]=Zr(ke,O)?fe[ke]:k}return p}function ji(p,x){if(!(x==="constructor"&&typeof p[x]=="function")&&x!="__proto__")return p[x]}var Fn=Ea(wd),Dn=th||function(p,x){return B.setTimeout(p,x)},Mi=Ea(Ad);function qi(p,x,O){var G=x+"";return Mi(p,kn(G,Io(Hr(G),O)))}function Ea(p){var x=0,O=0;return function(){var G=Wc(),fe=vn-(G-O);if(O=G,fe>0){if(++x>=jr)return arguments[0]}else x=0;return p.apply(k,arguments)}}function Ao(p,x){var O=-1,G=p.length,fe=G-1;for(x=x===k?G:x;++O<x;){var ke=qp(O,fe),lt=p[ke];p[ke]=p[O],p[O]=lt}return p.length=x,p}var ns=mr(function(p){var x=[];return p.charCodeAt(0)===46&&x.push(""),p.replace(Ce,function(O,G,fe,ke){x.push(fe?ke.replace(jn,"$1"):G||O)}),x});function ia(p){if(typeof p=="string"||qu(p))return p;var x=p+"";return x=="0"&&1/p==-Ie?"-0":x}function Zo(p){if(p!=null){try{return $i.call(p)}catch(x){}try{return p+""}catch(x){}}return""}function Io(p,x){return Qo(Xt,function(O){var G="_."+O[0];x&O[1]&&!_c(p,G)&&p.push(G)}),p.sort()}function Os(p){if(p instanceof Fa)return p.clone();var x=new su(p.__wrapped__,p.__chain__);return x.__actions__=uu(p.__actions__),x.__index__=p.__index__,x.__values__=p.__values__,x}function Is(p,x,O){(O?Vt(p,x,O):x===k)?x=1:x=Za(ja(x),0);var G=p==null?0:p.length;if(!G||x<1)return[];for(var fe=0,ke=0,lt=yr(Hc(G/x));fe<G;)lt[ke++]=cc(p,fe,fe+=x);return lt}function lu(p){for(var x=-1,O=p==null?0:p.length,G=0,fe=[];++x<O;){var ke=p[x];ke&&(fe[G++]=ke)}return fe}function cu(){var p=arguments.length;if(!p)return[];for(var x=yr(p-1),O=arguments[0],G=p;G--;)x[G-1]=arguments[G];return El(Xi(O)?uu(O):[O],ka(x,1))}var fu=ba(function(p,x){return Ko(p)?Wi(p,ka(x,1,Ko,!0)):[]}),Xo=ba(function(p,x){var O=st(x);return Ko(O)&&(O=k),Ko(p)?Wi(p,ka(x,1,Ko,!0),Ui(O,2)):[]}),pa=ba(function(p,x){var O=st(x);return Ko(O)&&(O=k),Ko(p)?Wi(p,ka(x,1,Ko,!0),k,O):[]});function Ns(p,x,O){var G=p==null?0:p.length;return G?(x=O||x===k?1:ja(x),cc(p,x<0?0:x,G)):[]}function Ga(p,x,O){var G=p==null?0:p.length;return G?(x=O||x===k?1:ja(x),x=G-x,cc(p,0,x<0?0:x)):[]}function Rs(p,x){return p&&p.length?gf(p,Ui(x,3),!0,!0):[]}function ki(p,x){return p&&p.length?gf(p,Ui(x,3),!0):[]}function ca(p,x,O,G){var fe=p==null?0:p.length;return fe?(O&&typeof O!="number"&&Vt(p,x,O)&&(O=0,G=fe),wa(p,x,O,G)):[]}function yo(p,x,O){var G=p==null?0:p.length;if(!G)return-1;var fe=O==null?0:ja(O);return fe<0&&(fe=Za(G+fe,0)),tl(p,Ui(x,3),fe)}function wu(p,x,O){var G=p==null?0:p.length;if(!G)return-1;var fe=G-1;return O!==k&&(fe=ja(O),fe=O<0?Za(G+fe,0):ts(fe,G-1)),tl(p,Ui(x,3),fe,!0)}function hu(p){var x=p==null?0:p.length;return x?ka(p,1):[]}function Ge(p){var x=p==null?0:p.length;return x?ka(p,Ie):[]}function hr(p,x){var O=p==null?0:p.length;return O?(x=x===k?1:ja(x),ka(p,x)):[]}function Wt(p){for(var x=-1,O=p==null?0:p.length,G={};++x<O;){var fe=p[x];G[fe[0]]=fe[1]}return G}function Wn(p){return p&&p.length?p[0]:k}function va(p,x,O){var G=p==null?0:p.length;if(!G)return-1;var fe=O==null?0:ja(O);return fe<0&&(fe=Za(G+fe,0)),fl(p,x,fe)}function De(p){var x=p==null?0:p.length;return x?cc(p,0,-1):[]}var Ee=ba(function(p){var x=Eo(p,$c);return x.length&&x[0]===p[0]?sc(x):[]}),it=ba(function(p){var x=st(p),O=Eo(p,$c);return x===st(O)?x=k:O.pop(),O.length&&O[0]===p[0]?sc(O,Ui(x,2)):[]}),Bt=ba(function(p){var x=st(p),O=Eo(p,$c);return x=typeof x=="function"?x:k,x&&O.pop(),O.length&&O[0]===p[0]?sc(O,k,x):[]});function ur(p,x){return p==null?"":Al.call(p,x)}function st(p){var x=p==null?0:p.length;return x?p[x-1]:k}function ut(p,x,O){var G=p==null?0:p.length;if(!G)return-1;var fe=G;return O!==k&&(fe=ja(O),fe=fe<0?Za(G+fe,0):ts(fe,G-1)),x===x?Qf(p,x,fe):tl(p,Bl,fe,!0)}function bt(p,x){return p&&p.length?np(p,ja(x)):k}var Se=ba(rt);function rt(p,x){return p&&p.length&&x&&x.length?Lf(p,x):p}function Fe(p,x,O){return p&&p.length&&x&&x.length?Lf(p,x,Ui(O,2)):p}function kt(p,x,O){return p&&p.length&&x&&x.length?Lf(p,x,k,O):p}var $t=$l(function(p,x){var O=p==null?0:p.length,G=mi(p,x);return mf(p,Eo(x,function(fe){return Zr(fe,O)?+fe:fe}).sort(lh)),G});function Wr(p,x){var O=[];if(!(p&&p.length))return O;var G=-1,fe=[],ke=p.length;for(x=Ui(x,3);++G<ke;){var lt=p[G];x(lt,G,p)&&(O.push(lt),fe.push(G))}return mf(p,fe),O}function bn(p){return p==null?p:Of.call(p)}function Cn(p,x,O){var G=p==null?0:p.length;return G?(O&&typeof O!="number"&&Vt(p,x,O)?(x=0,O=G):(x=x==null?0:ja(x),O=O===k?G:ja(O)),cc(p,x,O)):[]}function Un(p,x){return Lh(p,x)}function yn(p,x,O){return Jp(p,x,Ui(O,2))}function hi(p,x){var O=p==null?0:p.length;if(O){var G=Lh(p,x);if(G<O&&Nu(p[G],x))return G}return-1}function Zn(p,x){return Lh(p,x,!0)}function ri(p,x,O){return Jp(p,x,Ui(O,2),!0)}function ii(p,x){var O=p==null?0:p.length;if(O){var G=Lh(p,x,!0)-1;if(Nu(p[G],x))return G}return-1}function li(p){return p&&p.length?oh(p):[]}function Ri(p,x){return p&&p.length?oh(p,Ui(x,2)):[]}function eo(p){var x=p==null?0:p.length;return x?cc(p,1,x):[]}function Ks(p,x,O){return p&&p.length?(x=O||x===k?1:ja(x),cc(p,0,x<0?0:x)):[]}function kl(p,x,O){var G=p==null?0:p.length;return G?(x=O||x===k?1:ja(x),x=G-x,cc(p,x<0?0:x,G)):[]}function Jc(p,x){return p&&p.length?gf(p,Ui(x,3),!1,!0):[]}function So(p,x){return p&&p.length?gf(p,Ui(x,3)):[]}var Ia=ba(function(p){return Mc(ka(p,1,Ko,!0))}),Oc=ba(function(p){var x=st(p);return Ko(x)&&(x=k),Mc(ka(p,1,Ko,!0),Ui(x,2))}),ql=ba(function(p){var x=st(p);return x=typeof x=="function"?x:k,Mc(ka(p,1,Ko,!0),k,x)});function rd(p){return p&&p.length?Mc(p):[]}function hc(p,x){return p&&p.length?Mc(p,Ui(x,2)):[]}function nd(p,x){return x=typeof x=="function"?x:k,p&&p.length?Mc(p,k,x):[]}function id(p){if(!(p&&p.length))return[];var x=0;return p=Jo(p,function(O){if(Ko(O))return x=Za(O.length,x),!0}),Th(x,function(O){return Eo(p,Nl(O))})}function Bh(p,x){if(!(p&&p.length))return[];var O=id(p);return x==null?O:Eo(O,function(G){return sa(x,k,G)})}var hp=ba(function(p,x){return Ko(p)?Wi(p,x):[]}),Qv=ba(function(p){return kf(Jo(p,Ko))}),$s=ba(function(p){var x=st(p);return Ko(x)&&(x=k),kf(Jo(p,Ko),Ui(x,2))}),ad=ba(function(p){var x=st(p);return x=typeof x=="function"?x:k,kf(Jo(p,Ko),k,x)}),ph=ba(id);function Pd(p,x){return sh(p||[],x||[],gr)}function Od(p,x){return sh(p||[],x||[],ah)}var vv=ba(function(p){var x=p.length,O=x>1?p[x-1]:k;return O=typeof O=="function"?(p.pop(),O):k,Bh(p,O)});function pp(p){var x=Pe(p);return x.__chain__=!0,x}function dh(p,x){return x(p),p}function od(p,x){return x(p)}var mv=$l(function(p){var x=p.length,O=x?p[0]:0,G=this.__wrapped__,fe=function(ke){return mi(ke,p)};return x>1||this.__actions__.length||!(G instanceof Fa)||!Zr(O)?this.thru(fe):(G=G.slice(O,+O+(x?1:0)),G.__actions__.push({func:od,args:[fe],thisArg:k}),new su(G,this.__chain__).thru(function(ke){return x&&!ke.length&&ke.push(k),ke}))});function zm(){return pp(this)}function pu(){return new su(this.value(),this.__chain__)}function Nh(){this.__values__===k&&(this.__values__=Dd(this.value()));var p=this.__index__>=this.__values__.length,x=p?k:this.__values__[this.__index__++];return{done:p,value:x}}function Jv(){return this}function a(p){for(var x,O=this;O instanceof df;){var G=Os(O);G.__index__=0,G.__values__=k,x?fe.__wrapped__=G:x=G;var fe=G;O=O.__wrapped__}return fe.__wrapped__=p,x}function o(){var p=this.__wrapped__;if(p instanceof Fa){var x=p;return this.__actions__.length&&(x=new Fa(this)),x=x.reverse(),x.__actions__.push({func:od,args:[bn],thisArg:k}),new su(x,this.__chain__)}return this.thru(bn)}function u(){return yf(this.__wrapped__,this.__actions__)}var v=sp(function(p,x,O){io.call(p,O)?++p[O]:Vn(p,O,1)});function _(p,x,O){var G=Xi(p)?Ma:Ai;return O&&Vt(p,x,O)&&(x=k),G(p,Ui(x,3))}function S(p,x){var O=Xi(p)?Jo:rs;return O(p,Ui(x,3))}var A=Rp(yo),R=Rp(wu);function z(p,x){return ka(Qe(p,x),1)}function W(p,x){return ka(Qe(p,x),Ie)}function q(p,x,O){return O=O===k?1:ja(O),ka(Qe(p,x),O)}function ne(p,x){var O=Xi(p)?Qo:ui;return O(p,Ui(x,3))}function ae(p,x){var O=Xi(p)?yu:ea;return O(p,Ui(x,3))}var Te=sp(function(p,x,O){io.call(p,O)?p[O].push(x):Vn(p,O,[x])});function je(p,x,O,G){p=vu(p)?p:_h(p),O=O&&!G?ja(O):0;var fe=p.length;return O<0&&(O=Za(fe+O,0)),Gf(p)?O<=fe&&p.indexOf(x,O)>-1:!!fe&&fl(p,x,O)>-1}var Be=ba(function(p,x,O){var G=-1,fe=typeof x=="function",ke=vu(p)?yr(p.length):[];return ui(p,function(lt){ke[++G]=fe?sa(x,lt,O):ku(lt,x,O)}),ke}),Je=sp(function(p,x,O){Vn(p,O,x)});function Qe(p,x){var O=Xi(p)?Eo:Yl;return O(p,Ui(x,3))}function Tt(p,x,O,G){return p==null?[]:(Xi(x)||(x=x==null?[]:[x]),O=G?k:O,Xi(O)||(O=O==null?[]:[O]),nh(p,x,O))}var Zt=sp(function(p,x,O){p[O?0:1].push(x)},function(){return[[],[]]});function ar(p,x,O){var G=Xi(p)?wf:nf,fe=arguments.length<3;return G(p,Ui(x,4),O,fe,ui)}function Lr(p,x,O){var G=Xi(p)?Sl:nf,fe=arguments.length<3;return G(p,Ui(x,4),O,fe,ea)}function xr(p,x){var O=Xi(p)?Jo:rs;return O(p,qs(Ui(x,3)))}function dn(p){var x=Xi(p)?Ot:Rh;return x(p)}function _n(p,x,O){(O?Vt(p,x,O):x===k)?x=1:x=ja(x);var G=Xi(p)?Mt:ih;return G(p,x)}function ci(p){var x=Xi(p)?Sr:Qp;return x(p)}function _i(p){if(p==null)return 0;if(vu(p))return Gf(p)?jl(p):p.length;var x=lr(p);return x==Br||x==_e?p.size:vf(p).length}function vi(p,x,O){var G=Xi(p)?xa:sv;return O&&Vt(p,x,O)&&(x=k),G(p,Ui(x,3))}var ti=ba(function(p,x){if(p==null)return[];var O=x.length;return O>1&&Vt(p,x[0],x[1])?x=[]:O>2&&Vt(x[0],x[1],x[2])&&(x=[x[0]]),nh(p,ka(x,1),[])}),Zi=tp||function(){return B.Date.now()};function Pi(p,x){if(typeof x!="function")throw new Vl(te);return p=ja(p),function(){if(--p<1)return x.apply(this,arguments)}}function xi(p,x,O){return x=O?k:x,x=p&&x==null?p.length:x,Qc(p,Nt,k,k,k,k,x)}function Pa(p,x){var O;if(typeof x!="function")throw new Vl(te);return p=ja(p),function(){return--p>0&&(O=x.apply(this,arguments)),p<=1&&(x=k),O}}var aa=ba(function(p,x,O){var G=dt;if(O.length){var fe=ic(O,hh(aa));G|=Fr}return Qc(p,G,x,O,fe)}),to=ba(function(p,x,O){var G=dt|ct;if(O.length){var fe=ic(O,hh(to));G|=Fr}return Qc(x,G,p,O,fe)});function Fi(p,x,O){x=O?k:x;var G=Qc(p,ee,k,k,k,k,k,x);return G.placeholder=Fi.placeholder,G}function Ra(p,x,O){x=O?k:x;var G=Qc(p,rr,k,k,k,k,k,x);return G.placeholder=Ra.placeholder,G}function Do(p,x,O){var G,fe,ke,lt,Rt,or,cn=0,fn=!1,Mn=!1,Si=!0;if(typeof p!="function")throw new Vl(te);x=ao(x)||0,Go(O)&&(fn=!!O.leading,Mn="maxWait"in O,ke=Mn?Za(ao(O.maxWait)||0,x):ke,Si="trailing"in O?!!O.trailing:Si);function ra(Qu){var bh=G,Ep=fe;return G=fe=k,cn=Qu,lt=p.apply(Ep,bh),lt}function Aa(Qu){return cn=Qu,Rt=Dn(_o,x),fn?ra(Qu):lt}function ro(Qu){var bh=Qu-or,Ep=Qu-cn,J0=x-bh;return Mn?ts(J0,ke-Ep):J0}function Ta(Qu){var bh=Qu-or,Ep=Qu-cn;return or===k||bh>=x||bh<0||Mn&&Ep>=ke}function _o(){var Qu=Zi();if(Ta(Qu))return Mo(Qu);Rt=Dn(_o,ro(Qu))}function Mo(Qu){return Rt=k,Si&&G?ra(Qu):(G=fe=k,lt)}function Ef(){Rt!==k&&op(Rt),cn=0,G=or=fe=Rt=k}function Rc(){return Rt===k?lt:Mo(Zi())}function Sf(){var Qu=Zi(),bh=Ta(Qu);if(G=arguments,fe=this,or=Qu,bh){if(Rt===k)return Aa(or);if(Mn)return op(Rt),Rt=Dn(_o,x),ra(or)}return Rt===k&&(Rt=Dn(_o,x)),lt}return Sf.cancel=Ef,Sf.flush=Rc,Sf}var Fo=ba(function(p,x){return zi(p,1,x)}),is=ba(function(p,x,O){return zi(p,ao(x)||0,O)});function as(p){return Qc(p,zt)}function Yo(p,x){if(typeof p!="function"||x!=null&&typeof x!="function")throw new Vl(te);var O=function(){var G=arguments,fe=x?x.apply(this,G):G[0],ke=O.cache;if(ke.has(fe))return ke.get(fe);var lt=p.apply(this,G);return O.cache=ke.set(fe,lt)||ke,lt};return O.cache=new(Yo.Cache||l),O}Yo.Cache=l;function qs(p){if(typeof p!="function")throw new Vl(te);return function(){var x=arguments;switch(x.length){case 0:return!p.call(this);case 1:return!p.call(this,x[0]);case 2:return!p.call(this,x[0],x[1]);case 3:return!p.call(this,x[0],x[1],x[2])}return!p.apply(this,x)}}function Ls(p){return Pa(2,p)}var ol=Ff(function(p,x){x=x.length==1&&Xi(x[0])?Eo(x[0],ou(Ui())):Eo(ka(x,1),ou(Ui()));var O=x.length;return ba(function(G){for(var fe=-1,ke=ts(G.length,O);++fe<ke;)G[fe]=x[fe].call(this,G[fe]);return sa(p,this,G)})}),Qs=ba(function(p,x){var O=ic(x,hh(Qs));return Qc(p,Fr,k,x,O)}),$u=ba(function(p,x){var O=ic(x,hh($u));return Qc(p,Mr,k,x,O)}),du=$l(function(p,x){return Qc(p,ze,k,k,k,x)});function Js(p,x){if(typeof p!="function")throw new Vl(te);return x=x===k?x:ja(x),ba(p,x)}function eu(p,x){if(typeof p!="function")throw new Vl(te);return x=x==null?0:Za(ja(x),0),ba(function(O){var G=O[x],fe=Rl(O,0,x);return G&&El(fe,G),sa(p,this,fe)})}function za(p,x,O){var G=!0,fe=!0;if(typeof p!="function")throw new Vl(te);return Go(O)&&(G="leading"in O?!!O.leading:G,fe="trailing"in O?!!O.trailing:fe),Do(p,x,{leading:G,maxWait:x,trailing:fe})}function La(p){return xi(p,1)}function To(p,x){return Qs(Df(x),p)}function Bo(){if(!arguments.length)return[];var p=arguments[0];return Xi(p)?p:[p]}function sl(p){return Ni(p,yt)}function Vo(p,x){return x=typeof x=="function"?x:k,Ni(p,yt,x)}function os(p){return Ni(p,at|yt)}function Bu(p,x){return x=typeof x=="function"?x:k,Ni(p,at|yt,x)}function Ua(p,x){return x==null||$n(p,x,ks(x))}function Nu(p,x){return p===x||p!==p&&x!==x}var pc=Ba(Ws),ef=Ba(function(p,x){return p>=x}),Au=Xc(function(){return arguments}())?Xc:function(p){return Cs(p)&&io.call(p,"callee")&&!hf.call(p,"callee")},Xi=yr.isArray,vh=zr?ou(zr):Ol;function vu(p){return p!=null&&mh(p.length)&&!dc(p)}function Ko(p){return Cs(p)&&vu(p)}function sd(p){return p===!0||p===!1||Cs(p)&&go(p)==Ar}var gl=rl||dm,ud=Kr?ou(Kr):Ps;function Lp(p){return Cs(p)&&p.nodeType===1&&!gh(p)}function kp(p){if(p==null)return!0;if(vu(p)&&(Xi(p)||typeof p=="string"||typeof p.splice=="function"||gl(p)||Hf(p)||Au(p)))return!p.length;var x=lr(p);if(x==Br||x==_e)return!p.size;if(Bn(p))return!vf(p).length;for(var O in p)if(io.call(p,O))return!1;return!0}function Id(p,x){return Ku(p,x)}function ld(p,x,O){O=typeof O=="function"?O:k;var G=O?O(p,x):k;return G===k?Ku(p,x,k,O):!!G}function Dp(p){if(!Cs(p))return!1;var x=go(p);return x==$r||x==Pr||typeof p.message=="string"&&typeof p.name=="string"&&!gh(p)}function zh(p){return typeof p=="number"&&ma(p)}function dc(p){if(!Go(p))return!1;var x=go(p);return x==Or||x==_r||x==ir||x==Ci}function cd(p){return typeof p=="number"&&p==ja(p)}function mh(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=pt}function Go(p){var x=typeof p;return p!=null&&(x=="object"||x=="function")}function Cs(p){return p!=null&&typeof p=="object"}var fd=oi?ou(oi):uc;function Rd(p,x){return p===x||Ss(p,x,J(x))}function Fp(p,x,O){return O=typeof O=="function"?O:k,Ss(p,x,J(x),O)}function hd(p){return dp(p)&&p!=+p}function pd(p){if(qn(p))throw new Qn(H);return Cu(p)}function Bp(p){return p===null}function dd(p){return p==null}function dp(p){return typeof p=="number"||Cs(p)&&go(p)==Jn}function gh(p){if(!Cs(p)||go(p)!=wn)return!1;var x=Gl(p);if(x===null)return!0;var O=io.call(x,"constructor")&&x.constructor;return typeof O=="function"&&O instanceof O&&$i.call(O)==Gu}var vp=Ki?ou(Ki):Fs;function mp(p){return cd(p)&&p>=-pt&&p<=pt}var Np=Li?ou(Li):Du;function Gf(p){return typeof p=="string"||!Xi(p)&&Cs(p)&&go(p)==Pn}function qu(p){return typeof p=="symbol"||Cs(p)&&go(p)==oa}var Hf=Oa?ou(Oa):Bs;function Ld(p){return p===k}function kd(p){return Cs(p)&&lr(p)==ys}function em(p){return Cs(p)&&go(p)==Jt}var gv=Ba(Kc),gs=Ba(function(p,x){return p<=x});function Dd(p){if(!p)return[];if(vu(p))return Gf(p)?Cl(p):uu(p);if(bc&&p[bc])return rc(p[bc]());var x=lr(p),O=x==Br?nc:x==_e?sf:_h;return O(p)}function Uh(p){if(!p)return p===0?p:0;if(p=ao(p),p===Ie||p===-Ie){var x=p<0?-1:1;return x*mt}return p===p?p:0}function ja(p){var x=Uh(p),O=x%1;return x===x?O?x-O:x:0}function gp(p){return p?yi(ja(p),0,w):0}function ao(p){if(typeof p=="number")return p;if(qu(p))return Dt;if(Go(p)){var x=typeof p.valueOf=="function"?p.valueOf():p;p=Go(x)?x+"":x}if(typeof p!="string")return p===0?p:+p;p=Kh(p);var O=Hn.test(p);return O||Sa.test(p)?b(p.slice(2),O?2:8):Gi.test(p)?Dt:+p}function vc(p){return fc(p,Uu(p))}function Um(p){return p?yi(ja(p),-pt,pt):p===0?p:0}function oo(p){return p==null?"":Cr(p)}var yv=Kl(function(p,x){if(Bn(x)||vu(x)){fc(x,ks(x),p);return}for(var O in x)io.call(x,O)&&gr(p,O,x[O])}),_v=Kl(function(p,x){fc(x,Uu(x),p)}),Di=Kl(function(p,x,O,G){fc(x,Uu(x),p,G)}),Wf=Kl(function(p,x,O,G){fc(x,ks(x),p,G)}),Vi=$l(mi);function Fd(p,x){var O=xu(p);return x==null?O:nn(O,x)}var zp=ba(function(p,x){p=Ya(p);var O=-1,G=x.length,fe=G>2?x[2]:k;for(fe&&Vt(x[0],x[1],fe)&&(G=1);++O<G;)for(var ke=x[O],lt=Uu(ke),Rt=-1,or=lt.length;++Rt<or;){var cn=lt[Rt],fn=p[cn];(fn===k||Nu(fn,ac[cn])&&!io.call(p,cn))&&(p[cn]=ke[cn])}return p}),Bd=ba(function(p){return p.push(k,Md),sa(Cv,k,p)});function Nd(p,x){return Af(p,Ui(x,3),Ja)}function xv(p,x){return Af(p,Ui(x,3),Eu)}function zu(p,x){return p==null?p:ms(p,Ui(x,3),Uu)}function jh(p,x){return p==null?p:Oo(p,Ui(x,3),Uu)}function bv(p,x){return p&&Ja(p,Ui(x,3))}function Ev(p,x){return p&&Eu(p,Ui(x,3))}function Sv(p){return p==null?[]:ho(p,ks(p))}function zd(p){return p==null?[]:ho(p,Uu(p))}function yl(p,x,O){var G=p==null?k:Yu(p,x);return G===k?O:G}function Ud(p,x){return p!=null&&tn(p,x,Es)}function jd(p,x){return p!=null&&tn(p,x,Lu)}var Zf=up(function(p,x,O){x!=null&&typeof x.toString!="function"&&(x=Kn.call(x)),p[x]=O},Lv(Ic)),vd=up(function(p,x,O){x!=null&&typeof x.toString!="function"&&(x=Kn.call(x)),io.call(p,x)?p[x].push(O):p[x]=[O]},Ui),ul=ba(ku);function ks(p){return vu(p)?$e(p):vf(p)}function Uu(p){return vu(p)?$e(p,!0):Yc(p)}function yp(p,x){var O={};return x=Ui(x,3),Ja(p,function(G,fe,ke){Vn(O,x(G,fe,ke),G)}),O}function Vh(p,x){var O={};return x=Ui(x,3),Ja(p,function(G,fe,ke){Vn(O,fe,x(G,fe,ke))}),O}var _p=Kl(function(p,x,O){Zs(p,x,O)}),Cv=Kl(function(p,x,O,G){Zs(p,x,O,G)}),tm=$l(function(p,x){var O={};if(p==null)return O;var G=!1;x=Eo(x,function(ke){return ke=Il(ke,p),G||(G=ke.length>1),ke}),fc(p,fp(p),O),G&&(O=Ni(O,at|gt|yt,hv));for(var fe=x.length;fe--;)Mp(O,x[fe]);return O});function rm(p,x){return Vd(p,qs(Ui(x)))}var nm=$l(function(p,x){return p==null?{}:$p(p,x)});function Vd(p,x){if(p==null)return{};var O=Eo(fp(p),function(G){return[G]});return x=Ui(x),Tp(p,O,function(G,fe){return x(G,fe[0])})}function tu(p,x,O){x=Il(x,p);var G=-1,fe=x.length;for(fe||(fe=1,p=k);++G<fe;){var ke=p==null?k:p[ia(x[G])];ke===k&&(G=fe,ke=O),p=dc(ke)?ke.call(p):ke}return p}function yh(p,x,O){return p==null?p:ah(p,x,O)}function Na(p,x,O,G){return G=typeof G=="function"?G:k,p==null?p:ah(p,x,O,G)}var Gd=cv(ks),Hd=cv(Uu);function im(p,x,O){var G=Xi(p),fe=G||gl(p)||Hf(p);if(x=Ui(x,4),O==null){var ke=p&&p.constructor;fe?O=G?new ke:[]:Go(p)?O=dc(ke)?xu(Gl(p)):{}:O={}}return(fe?Qo:Ja)(p,function(lt,Rt,or){return x(O,lt,Rt,or)}),O}function ve(p,x){return p==null?!0:Mp(p,x)}function wv(p,x,O){return p==null?p:sr(p,x,Df(O))}function Av(p,x,O,G){return G=typeof G=="function"?G:k,p==null?p:sr(p,x,Df(O),G)}function _h(p){return p==null?[]:zl(p,ks(p))}function Tv(p){return p==null?[]:zl(p,Uu(p))}function Up(p,x,O){return O===k&&(O=x,x=k),O!==k&&(O=ao(O),O=O===O?O:0),x!==k&&(x=ao(x),x=x===x?x:0),yi(ao(p),x,O)}function Mv(p,x,O){return x=Uh(x),O===k?(O=x,x=0):O=Uh(O),p=ao(p),oc(p,x,O)}function xh(p,x,O){if(O&&typeof O!="boolean"&&Vt(p,x,O)&&(x=O=k),O===k&&(typeof x=="boolean"?(O=x,x=k):typeof p=="boolean"&&(O=p,p=k)),p===k&&x===k?(p=0,x=1):(p=Uh(p),x===k?(x=p,p=0):x=Uh(x)),p>x){var G=p;p=x,x=G}if(O||p%1||x%1){var fe=ps();return ts(p+fe*(x-p+bl("1e-"+((fe+"").length-1))),x)}return qp(p,x)}var am=qc(function(p,x,O){return x=x.toLowerCase(),p+(O?Wd(x):x)});function Wd(p){return cm(oo(p).toLowerCase())}function Pv(p){return p=oo(p),p&&p.replace(ei,Mh).replace(Mu,"")}function om(p,x,O){p=oo(p),x=Cr(x);var G=p.length;O=O===k?G:yi(ja(O),0,G);var fe=O;return O-=x.length,O>=0&&p.slice(O,fe)==x}function sm(p){return p=oo(p),p&&ie.test(p)?p.replace(wo,of):p}function Zd(p){return p=oo(p),p&&nt.test(p)?p.replace(Ye,"\\$&"):p}var jm=qc(function(p,x,O){return p+(O?"-":"")+x.toLowerCase()}),Vm=qc(function(p,x,O){return p+(O?" ":"")+x.toLowerCase()}),um=Ip("toLowerCase");function lm(p,x,O){p=oo(p),x=ja(x);var G=x?jl(p):0;if(!x||G>=x)return p;var fe=(x-G)/2;return lp(pf(fe),O)+p+lp(Hc(fe),O)}function bf(p,x,O){p=oo(p),x=ja(x);var G=x?jl(p):0;return x&&G<x?p+lp(x-G,O):p}function md(p,x,O){p=oo(p),x=ja(x);var G=x?jl(p):0;return x&&G<x?lp(x-G,O)+p:p}function Ov(p,x,O){return O||x==null?x=0:x&&(x=+x),Gs(oo(p).replace(Nr,""),x||0)}function jp(p,x,O){return(O?Vt(p,x,O):x===k)?x=1:x=ja(x),ap(oo(p),x)}function Xd(){var p=arguments,x=oo(p[0]);return p.length<3?x:x.replace(p[1],p[2])}var Iv=qc(function(p,x,O){return p+(O?"_":"")+x.toLowerCase()});function b0(p,x,O){return O&&typeof O!="number"&&Vt(p,x,O)&&(x=O=k),O=O===k?w:O>>>0,O?(p=oo(p),p&&(typeof x=="string"||x!=null&&!vp(x))&&(x=Cr(x),!x&&Vc(p))?Rl(Cl(p),0,O):p.split(x,O)):[]}var gy=qc(function(p,x,O){return p+(O?" ":"")+cm(x)});function yy(p,x,O){return p=oo(p),O=O==null?0:yi(ja(O),0,p.length),x=Cr(x),p.slice(O,O+x.length)==x}function E0(p,x,O){var G=Pe.templateSettings;O&&Vt(p,x,O)&&(x=k),p=oo(p),x=Di({},x,G,fv);var fe=Di({},x.imports,G.imports,fv),ke=ks(fe),lt=zl(fe,ke),Rt,or,cn=0,fn=x.interpolate||ua,Mn="__p += '",Si=uf((x.escape||ua).source+"|"+fn.source+"|"+(fn===Ve?Rn:ua).source+"|"+(x.evaluate||ua).source+"|$","g"),ra="//# sourceURL="+(io.call(x,"sourceURL")?(x.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Po+"]")+`
`;p.replace(Si,function(Ta,_o,Mo,Ef,Rc,Sf){return Mo||(Mo=Ef),Mn+=p.slice(cn,Sf).replace(Ds,es),_o&&(Rt=!0,Mn+=`' +
__e(`+_o+`) +
'`),Rc&&(or=!0,Mn+=`';
`+Rc+`;
__p += '`),Mo&&(Mn+=`' +
((__t = (`+Mo+`)) == null ? '' : __t) +
'`),cn=Sf+Ta.length,Ta}),Mn+=`';
`;var Aa=io.call(x,"variable")&&x.variable;if(!Aa)Mn=`with (obj) {
`+Mn+`
}
`;else if(pr.test(Aa))throw new Qn(pe);Mn=(or?Mn.replace(xo,""):Mn).replace($a,"$1").replace(Vu,"$1;"),Mn="function("+(Aa||"obj")+`) {
`+(Aa?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Rt?", __e = _.escape":"")+(or?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Mn+`return __p
}`;var ro=Hm(function(){return Hi(ke,ra+"return "+Mn).apply(k,lt)});if(ro.source=Mn,Dp(ro))throw ro;return ro}function _y(p){return oo(p).toLowerCase()}function xy(p){return oo(p).toUpperCase()}function xp(p,x,O){if(p=oo(p),p&&(O||x===k))return Kh(p);if(!p||!(x=Cr(x)))return p;var G=Cl(p),fe=Cl(x),ke=jc(G,fe),lt=Ul(G,fe)+1;return Rl(G,ke,lt).join("")}function by(p,x,O){if(p=oo(p),p&&(O||x===k))return p.slice(0,Mf(p)+1);if(!p||!(x=Cr(x)))return p;var G=Cl(p),fe=Ul(G,Cl(x))+1;return Rl(G,0,fe).join("")}function bp(p,x,O){if(p=oo(p),p&&(O||x===k))return p.replace(Nr,"");if(!p||!(x=Cr(x)))return p;var G=Cl(p),fe=jc(G,Cl(x));return Rl(G,fe).join("")}function Ey(p,x){var O=Kt,G=vr;if(Go(x)){var fe="separator"in x?x.separator:fe;O="length"in x?ja(x.length):O,G="omission"in x?Cr(x.omission):G}p=oo(p);var ke=p.length;if(Vc(p)){var lt=Cl(p);ke=lt.length}if(O>=ke)return p;var Rt=O-jl(G);if(Rt<1)return G;var or=lt?Rl(lt,0,Rt).join(""):p.slice(0,Rt);if(fe===k)return or+G;if(lt&&(Rt+=or.length-Rt),vp(fe)){if(p.slice(Rt).search(fe)){var cn,fn=or;for(fe.global||(fe=uf(fe.source,oo(Nn.exec(fe))+"g")),fe.lastIndex=0;cn=fe.exec(fn);)var Mn=cn.index;or=or.slice(0,Mn===k?Rt:Mn)}}else if(p.indexOf(Cr(fe),Rt)!=Rt){var Si=or.lastIndexOf(fe);Si>-1&&(or=or.slice(0,Si))}return or+G}function Sy(p){return p=oo(p),p&&oe.test(p)?p.replace(ec,Qh):p}var Rv=qc(function(p,x,O){return p+(O?" ":"")+x.toUpperCase()}),cm=Ip("toUpperCase");function Gm(p,x,O){return p=oo(p),x=O?k:x,x===k?qh(p)?eh(p):fs(p):p.match(x)||[]}var Hm=ba(function(p,x){try{return sa(p,k,x)}catch(O){return Dp(O)?O:new Qn(O)}}),Wm=$l(function(p,x){return Qo(x,function(O){O=ia(O),Vn(p,O,aa(p[O],p))}),p});function S0(p){var x=p==null?0:p.length,O=Ui();return p=x?Eo(p,function(G){if(typeof G[1]!="function")throw new Vl(te);return[O(G[0]),G[1]]}):[],ba(function(G){for(var fe=-1;++fe<x;){var ke=p[fe];if(sa(ke[0],this,G))return sa(ke[1],this,G)}})}function C0(p){return Ii(Ni(p,at))}function Lv(p){return function(){return p}}function Z_(p,x){return p==null||p!==p?x:p}var Cy=ch(),wy=ch(!0);function Ic(p){return p}function Zm(p){return Fu(typeof p=="function"?p:Ni(p,at))}function w0(p){return lc(Ni(p,at))}function A0(p,x){return vl(p,Ni(x,at))}var T0=ba(function(p,x){return function(O){return ku(O,p,x)}}),M0=ba(function(p,x){return function(O){return ku(p,O,x)}});function fm(p,x,O){var G=ks(x),fe=ho(x,G);O==null&&!(Go(x)&&(fe.length||!G.length))&&(O=x,x=p,p=this,fe=ho(x,ks(x)));var ke=!(Go(O)&&"chain"in O)||!!O.chain,lt=dc(p);return Qo(fe,function(Rt){var or=x[Rt];p[Rt]=or,lt&&(p.prototype[Rt]=function(){var cn=this.__chain__;if(ke||cn){var fn=p(this.__wrapped__),Mn=fn.__actions__=uu(this.__actions__);return Mn.push({func:or,args:arguments,thisArg:p}),fn.__chain__=cn,fn}return or.apply(p,El([this.value()],arguments))})}),p}function P0(){return B._===this&&(B._=cf),this}function hm(){}function O0(p){return p=ja(p),ba(function(x){return np(x,p)})}var I0=Fh(Eo),R0=Fh(Ma),L0=Fh(xa);function Xm(p){return tr(p)?Nl(ia(p)):Ih(p)}function k0(p){return function(x){return p==null?k:Yu(p,x)}}var D0=Ll(),F0=Ll(!0);function pm(){return[]}function dm(){return!1}function Ql(){return{}}function B0(){return""}function N0(){return!0}function z0(p,x){if(p=ja(p),p<1||p>pt)return[];var O=w,G=ts(p,w);x=Ui(x),p-=w;for(var fe=Th(G,x);++O<p;)x(O);return fe}function U0(p){return Xi(p)?Eo(p,ia):qu(p)?[p]:uu(ns(oo(p)))}function j0(p){var x=++di;return oo(p)+x}var V0=Dh(function(p,x){return p+x},0),G0=Wo("ceil"),H0=Dh(function(p,x){return p/x},1),W0=Wo("floor");function Z0(p){return p&&p.length?na(p,Ic,Ws):k}function X0(p,x){return p&&p.length?na(p,Ui(x,2),Ws):k}function Y0(p){return zc(p,Ic)}function K0(p,x){return zc(p,Ui(x,2))}function $0(p){return p&&p.length?na(p,Ic,Kc):k}function q0(p,x){return p&&p.length?na(p,Ui(x,2),Kc):k}var Ay=Dh(function(p,x){return p*x},1),Ty=Wo("round"),My=Dh(function(p,x){return p-x},0);function Py(p){return p&&p.length?Uc(p,Ic):0}function Q0(p,x){return p&&p.length?Uc(p,Ui(x,2)):0}return Pe.after=Pi,Pe.ary=xi,Pe.assign=yv,Pe.assignIn=_v,Pe.assignInWith=Di,Pe.assignWith=Wf,Pe.at=Vi,Pe.before=Pa,Pe.bind=aa,Pe.bindAll=Wm,Pe.bindKey=to,Pe.castArray=Bo,Pe.chain=pp,Pe.chunk=Is,Pe.compact=lu,Pe.concat=cu,Pe.cond=S0,Pe.conforms=C0,Pe.constant=Lv,Pe.countBy=v,Pe.create=Fd,Pe.curry=Fi,Pe.curryRight=Ra,Pe.debounce=Do,Pe.defaults=zp,Pe.defaultsDeep=Bd,Pe.defer=Fo,Pe.delay=is,Pe.difference=fu,Pe.differenceBy=Xo,Pe.differenceWith=pa,Pe.drop=Ns,Pe.dropRight=Ga,Pe.dropRightWhile=Rs,Pe.dropWhile=ki,Pe.fill=ca,Pe.filter=S,Pe.flatMap=z,Pe.flatMapDeep=W,Pe.flatMapDepth=q,Pe.flatten=hu,Pe.flattenDeep=Ge,Pe.flattenDepth=hr,Pe.flip=as,Pe.flow=Cy,Pe.flowRight=wy,Pe.fromPairs=Wt,Pe.functions=Sv,Pe.functionsIn=zd,Pe.groupBy=Te,Pe.initial=De,Pe.intersection=Ee,Pe.intersectionBy=it,Pe.intersectionWith=Bt,Pe.invert=Zf,Pe.invertBy=vd,Pe.invokeMap=Be,Pe.iteratee=Zm,Pe.keyBy=Je,Pe.keys=ks,Pe.keysIn=Uu,Pe.map=Qe,Pe.mapKeys=yp,Pe.mapValues=Vh,Pe.matches=w0,Pe.matchesProperty=A0,Pe.memoize=Yo,Pe.merge=_p,Pe.mergeWith=Cv,Pe.method=T0,Pe.methodOf=M0,Pe.mixin=fm,Pe.negate=qs,Pe.nthArg=O0,Pe.omit=tm,Pe.omitBy=rm,Pe.once=Ls,Pe.orderBy=Tt,Pe.over=I0,Pe.overArgs=ol,Pe.overEvery=R0,Pe.overSome=L0,Pe.partial=Qs,Pe.partialRight=$u,Pe.partition=Zt,Pe.pick=nm,Pe.pickBy=Vd,Pe.property=Xm,Pe.propertyOf=k0,Pe.pull=Se,Pe.pullAll=rt,Pe.pullAllBy=Fe,Pe.pullAllWith=kt,Pe.pullAt=$t,Pe.range=D0,Pe.rangeRight=F0,Pe.rearg=du,Pe.reject=xr,Pe.remove=Wr,Pe.rest=Js,Pe.reverse=bn,Pe.sampleSize=_n,Pe.set=yh,Pe.setWith=Na,Pe.shuffle=ci,Pe.slice=Cn,Pe.sortBy=ti,Pe.sortedUniq=li,Pe.sortedUniqBy=Ri,Pe.split=b0,Pe.spread=eu,Pe.tail=eo,Pe.take=Ks,Pe.takeRight=kl,Pe.takeRightWhile=Jc,Pe.takeWhile=So,Pe.tap=dh,Pe.throttle=za,Pe.thru=od,Pe.toArray=Dd,Pe.toPairs=Gd,Pe.toPairsIn=Hd,Pe.toPath=U0,Pe.toPlainObject=vc,Pe.transform=im,Pe.unary=La,Pe.union=Ia,Pe.unionBy=Oc,Pe.unionWith=ql,Pe.uniq=rd,Pe.uniqBy=hc,Pe.uniqWith=nd,Pe.unset=ve,Pe.unzip=id,Pe.unzipWith=Bh,Pe.update=wv,Pe.updateWith=Av,Pe.values=_h,Pe.valuesIn=Tv,Pe.without=hp,Pe.words=Gm,Pe.wrap=To,Pe.xor=Qv,Pe.xorBy=$s,Pe.xorWith=ad,Pe.zip=ph,Pe.zipObject=Pd,Pe.zipObjectDeep=Od,Pe.zipWith=vv,Pe.entries=Gd,Pe.entriesIn=Hd,Pe.extend=_v,Pe.extendWith=Di,fm(Pe,Pe),Pe.add=V0,Pe.attempt=Hm,Pe.camelCase=am,Pe.capitalize=Wd,Pe.ceil=G0,Pe.clamp=Up,Pe.clone=sl,Pe.cloneDeep=os,Pe.cloneDeepWith=Bu,Pe.cloneWith=Vo,Pe.conformsTo=Ua,Pe.deburr=Pv,Pe.defaultTo=Z_,Pe.divide=H0,Pe.endsWith=om,Pe.eq=Nu,Pe.escape=sm,Pe.escapeRegExp=Zd,Pe.every=_,Pe.find=A,Pe.findIndex=yo,Pe.findKey=Nd,Pe.findLast=R,Pe.findLastIndex=wu,Pe.findLastKey=xv,Pe.floor=W0,Pe.forEach=ne,Pe.forEachRight=ae,Pe.forIn=zu,Pe.forInRight=jh,Pe.forOwn=bv,Pe.forOwnRight=Ev,Pe.get=yl,Pe.gt=pc,Pe.gte=ef,Pe.has=Ud,Pe.hasIn=jd,Pe.head=Wn,Pe.identity=Ic,Pe.includes=je,Pe.indexOf=va,Pe.inRange=Mv,Pe.invoke=ul,Pe.isArguments=Au,Pe.isArray=Xi,Pe.isArrayBuffer=vh,Pe.isArrayLike=vu,Pe.isArrayLikeObject=Ko,Pe.isBoolean=sd,Pe.isBuffer=gl,Pe.isDate=ud,Pe.isElement=Lp,Pe.isEmpty=kp,Pe.isEqual=Id,Pe.isEqualWith=ld,Pe.isError=Dp,Pe.isFinite=zh,Pe.isFunction=dc,Pe.isInteger=cd,Pe.isLength=mh,Pe.isMap=fd,Pe.isMatch=Rd,Pe.isMatchWith=Fp,Pe.isNaN=hd,Pe.isNative=pd,Pe.isNil=dd,Pe.isNull=Bp,Pe.isNumber=dp,Pe.isObject=Go,Pe.isObjectLike=Cs,Pe.isPlainObject=gh,Pe.isRegExp=vp,Pe.isSafeInteger=mp,Pe.isSet=Np,Pe.isString=Gf,Pe.isSymbol=qu,Pe.isTypedArray=Hf,Pe.isUndefined=Ld,Pe.isWeakMap=kd,Pe.isWeakSet=em,Pe.join=ur,Pe.kebabCase=jm,Pe.last=st,Pe.lastIndexOf=ut,Pe.lowerCase=Vm,Pe.lowerFirst=um,Pe.lt=gv,Pe.lte=gs,Pe.max=Z0,Pe.maxBy=X0,Pe.mean=Y0,Pe.meanBy=K0,Pe.min=$0,Pe.minBy=q0,Pe.stubArray=pm,Pe.stubFalse=dm,Pe.stubObject=Ql,Pe.stubString=B0,Pe.stubTrue=N0,Pe.multiply=Ay,Pe.nth=bt,Pe.noConflict=P0,Pe.noop=hm,Pe.now=Zi,Pe.pad=lm,Pe.padEnd=bf,Pe.padStart=md,Pe.parseInt=Ov,Pe.random=xh,Pe.reduce=ar,Pe.reduceRight=Lr,Pe.repeat=jp,Pe.replace=Xd,Pe.result=tu,Pe.round=Ty,Pe.runInContext=At,Pe.sample=dn,Pe.size=_i,Pe.snakeCase=Iv,Pe.some=vi,Pe.sortedIndex=Un,Pe.sortedIndexBy=yn,Pe.sortedIndexOf=hi,Pe.sortedLastIndex=Zn,Pe.sortedLastIndexBy=ri,Pe.sortedLastIndexOf=ii,Pe.startCase=gy,Pe.startsWith=yy,Pe.subtract=My,Pe.sum=Py,Pe.sumBy=Q0,Pe.template=E0,Pe.times=z0,Pe.toFinite=Uh,Pe.toInteger=ja,Pe.toLength=gp,Pe.toLower=_y,Pe.toNumber=ao,Pe.toSafeInteger=Um,Pe.toString=oo,Pe.toUpper=xy,Pe.trim=xp,Pe.trimEnd=by,Pe.trimStart=bp,Pe.truncate=Ey,Pe.unescape=Sy,Pe.uniqueId=j0,Pe.upperCase=Rv,Pe.upperFirst=cm,Pe.each=ne,Pe.eachRight=ae,Pe.first=Wn,fm(Pe,function(){var p={};return Ja(Pe,function(x,O){io.call(Pe.prototype,O)||(p[O]=x)}),p}(),{chain:!1}),Pe.VERSION=h,Qo(["bind","bindKey","curry","curryRight","partial","partialRight"],function(p){Pe[p].placeholder=Pe}),Qo(["drop","take"],function(p,x){Fa.prototype[p]=function(O){O=O===k?1:Za(ja(O),0);var G=this.__filtered__&&!x?new Fa(this):this.clone();return G.__filtered__?G.__takeCount__=ts(O,G.__takeCount__):G.__views__.push({size:ts(O,w),type:p+(G.__dir__<0?"Right":"")}),G},Fa.prototype[p+"Right"]=function(O){return this.reverse()[p](O).reverse()}}),Qo(["filter","map","takeWhile"],function(p,x){var O=x+1,G=O==kr||O==Ne;Fa.prototype[p]=function(fe){var ke=this.clone();return ke.__iteratees__.push({iteratee:Ui(fe,3),type:O}),ke.__filtered__=ke.__filtered__||G,ke}}),Qo(["head","last"],function(p,x){var O="take"+(x?"Right":"");Fa.prototype[p]=function(){return this[O](1).value()[0]}}),Qo(["initial","tail"],function(p,x){var O="drop"+(x?"":"Right");Fa.prototype[p]=function(){return this.__filtered__?new Fa(this):this[O](1)}}),Fa.prototype.compact=function(){return this.filter(Ic)},Fa.prototype.find=function(p){return this.filter(p).head()},Fa.prototype.findLast=function(p){return this.reverse().find(p)},Fa.prototype.invokeMap=ba(function(p,x){return typeof p=="function"?new Fa(this):this.map(function(O){return ku(O,p,x)})}),Fa.prototype.reject=function(p){return this.filter(qs(Ui(p)))},Fa.prototype.slice=function(p,x){p=ja(p);var O=this;return O.__filtered__&&(p>0||x<0)?new Fa(O):(p<0?O=O.takeRight(-p):p&&(O=O.drop(p)),x!==k&&(x=ja(x),O=x<0?O.dropRight(-x):O.take(x-p)),O)},Fa.prototype.takeRightWhile=function(p){return this.reverse().takeWhile(p).reverse()},Fa.prototype.toArray=function(){return this.take(w)},Ja(Fa.prototype,function(p,x){var O=/^(?:filter|find|map|reject)|While$/.test(x),G=/^(?:head|last)$/.test(x),fe=Pe[G?"take"+(x=="last"?"Right":""):x],ke=G||/^find/.test(x);!fe||(Pe.prototype[x]=function(){var lt=this.__wrapped__,Rt=G?[1]:arguments,or=lt instanceof Fa,cn=Rt[0],fn=or||Xi(lt),Mn=function(_o){var Mo=fe.apply(Pe,El([_o],Rt));return G&&Si?Mo[0]:Mo};fn&&O&&typeof cn=="function"&&cn.length!=1&&(or=fn=!1);var Si=this.__chain__,ra=!!this.__actions__.length,Aa=ke&&!Si,ro=or&&!ra;if(!ke&&fn){lt=ro?lt:new Fa(this);var Ta=p.apply(lt,Rt);return Ta.__actions__.push({func:od,args:[Mn],thisArg:k}),new su(Ta,Si)}return Aa&&ro?p.apply(this,Rt):(Ta=this.thru(Mn),Aa?G?Ta.value()[0]:Ta.value():Ta)})}),Qo(["pop","push","shift","sort","splice","unshift"],function(p){var x=ep[p],O=/^(?:push|sort|unshift)$/.test(p)?"tap":"thru",G=/^(?:pop|shift)$/.test(p);Pe.prototype[p]=function(){var fe=arguments;if(G&&!this.__chain__){var ke=this.value();return x.apply(Xi(ke)?ke:[],fe)}return this[O](function(lt){return x.apply(Xi(lt)?lt:[],fe)})}}),Ja(Fa.prototype,function(p,x){var O=Pe[x];if(O){var G=O.name+"";io.call(Sc,G)||(Sc[G]=[]),Sc[G].push({name:x,func:O})}}),Sc[al(k,ct).name]=[{name:"wrapper",func:k}],Fa.prototype.clone=rp,Fa.prototype.reverse=Zl,Fa.prototype.value=If,Pe.prototype.at=mv,Pe.prototype.chain=zm,Pe.prototype.commit=pu,Pe.prototype.next=Nh,Pe.prototype.plant=a,Pe.prototype.reverse=o,Pe.prototype.toJSON=Pe.prototype.valueOf=Pe.prototype.value=u,Pe.prototype.first=Pe.prototype.head,bc&&(Pe.prototype[bc]=Jv),Pe},wl=Pf();B._=wl,Y=function(){return wl}.call($,M,$,Z),Y!==k&&(Z.exports=Y)}).call(this)}).call(this,M("IyRk"),M("hOG+")(le))},MON2:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.STACK_OVERFLOW=$.CIRCULAR_DEPENDENCY_IN_FACTORY=$.POST_CONSTRUCT_ERROR=$.MULTIPLE_POST_CONSTRUCT_METHODS=$.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=$.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=$.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=$.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=$.ARGUMENTS_LENGTH_MISMATCH=$.INVALID_DECORATOR_OPERATION=$.INVALID_TO_SELF_VALUE=$.INVALID_FUNCTION_BINDING=$.INVALID_MIDDLEWARE_RETURN=$.NO_MORE_SNAPSHOTS_AVAILABLE=$.INVALID_BINDING_TYPE=$.NOT_IMPLEMENTED=$.CIRCULAR_DEPENDENCY=$.UNDEFINED_INJECT_ANNOTATION=$.MISSING_INJECT_ANNOTATION=$.MISSING_INJECTABLE_ANNOTATION=$.NOT_REGISTERED=$.CANNOT_UNBIND=$.AMBIGUOUS_MATCH=$.KEY_NOT_FOUND=$.NULL_ARGUMENT=$.DUPLICATED_METADATA=$.DUPLICATED_INJECTABLE_DECORATOR=void 0,$.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",$.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",$.NULL_ARGUMENT="NULL argument",$.KEY_NOT_FOUND="Key Not Found",$.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",$.CANNOT_UNBIND="Could not unbind serviceIdentifier:",$.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",$.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",$.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var j=function(V){return"@inject called with undefined this could mean that the class "+V+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};$.UNDEFINED_INJECT_ANNOTATION=j,$.CIRCULAR_DEPENDENCY="Circular dependency found:",$.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",$.INVALID_BINDING_TYPE="Invalid binding type:",$.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",$.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",$.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",$.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",$.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var Z=function(){for(var V=[],H=0;H<arguments.length;H++)V[H]=arguments[H];return"The number of constructor arguments in the derived class "+(V[0]+" must be >= than the number of constructor arguments of its base class.")};$.ARGUMENTS_LENGTH_MISMATCH=Z,$.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",$.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",$.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",$.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",$.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var Y=function(){for(var V=[],H=0;H<arguments.length;H++)V[H]=arguments[H];return"@postConstruct error in class "+V[0]+": "+V[1]};$.POST_CONSTRUCT_ERROR=Y;var k=function(){for(var V=[],H=0;H<arguments.length;H++)V[H]=arguments[H];return"It looks like there is a circular dependency "+("in one of the '"+V[0]+"' bindings. Please investigate bindings with")+("service identifier '"+V[1]+"'.")};$.CIRCULAR_DEPENDENCY_IN_FACTORY=k,$.STACK_OVERFLOW="Maximum call stack size exceeded"},MrPd:function(le,$,M){var j=M("hypo"),Z=M("ljhN"),Y=Object.prototype,k=Y.hasOwnProperty;function h(V,H,te){var pe=V[H];(!(k.call(V,H)&&Z(pe,te))||te===void 0&&!(H in V))&&j(V,H,te)}le.exports=h},Nsbk:function(le,$){function M(j){return le.exports=M=Object.setPrototypeOf?Object.getPrototypeOf:function(Y){return Y.__proto__||Object.getPrototypeOf(Y)},le.exports.__esModule=!0,le.exports.default=le.exports,M(j)}le.exports=M,le.exports.__esModule=!0,le.exports.default=le.exports},O0oS:function(le,$,M){var j=M("Cwc5"),Z=function(){try{var Y=j(Object,"defineProperty");return Y({},"",{}),Y}catch(k){}}();le.exports=Z},OBhP:function(le,$,M){var j=M("fmRc"),Z=M("gFfm"),Y=M("MrPd"),k=M("WwFo"),h=M("Dw+G"),V=M("5Tg0"),H=M("Q1l4"),te=M("VOtZ"),pe=M("EEGq"),Oe=M("qZTm"),Ae=M("G6z8"),vt=M("QqLw"),at=M("yHx3"),gt=M("wrZu"),yt=M("+iFO"),St=M("Z0cm"),He=M("DSRE"),dt=M("zEVN"),ct=M("GoyQ"),_t=M("1+5i"),ee=M("7GkX"),rr=M("mTTR"),Fr=1,Mr=2,Nt=4,ze="[object Arguments]",zt="[object Array]",Kt="[object Boolean]",vr="[object Date]",jr="[object Error]",vn="[object Function]",kr="[object GeneratorFunction]",be="[object Map]",Ne="[object Number]",Ie="[object Object]",pt="[object RegExp]",mt="[object Set]",Dt="[object String]",w="[object Symbol]",br="[object WeakMap]",Ut="[object ArrayBuffer]",Xt="[object DataView]",It="[object Float32Array]",Lt="[object Float64Array]",ir="[object Int8Array]",Ar="[object Int16Array]",nr="[object Int32Array]",Pr="[object Uint8Array]",$r="[object Uint8ClampedArray]",Or="[object Uint16Array]",_r="[object Uint32Array]",Br={};Br[ze]=Br[zt]=Br[Ut]=Br[Xt]=Br[Kt]=Br[vr]=Br[It]=Br[Lt]=Br[ir]=Br[Ar]=Br[nr]=Br[be]=Br[Ne]=Br[Ie]=Br[pt]=Br[mt]=Br[Dt]=Br[w]=Br[Pr]=Br[$r]=Br[Or]=Br[_r]=!0,Br[jr]=Br[vn]=Br[br]=!1;function Jn(mn,wn,pi,Ci,fa,_e){var Pn,oa=wn&Fr,ws=wn&Mr,ys=wn&Nt;if(pi&&(Pn=fa?pi(mn,Ci,fa,_e):pi(mn)),Pn!==void 0)return Pn;if(!ct(mn))return mn;var Jt=St(mn);if(Jt){if(Pn=at(mn),!oa)return H(mn,Pn)}else{var Ir=vt(mn),en=Ir==vn||Ir==kr;if(He(mn))return V(mn,oa);if(Ir==Ie||Ir==ze||en&&!fa){if(Pn=ws||en?{}:yt(mn),!oa)return ws?pe(mn,h(Pn,mn)):te(mn,k(Pn,mn))}else{if(!Br[Ir])return fa?mn:{};Pn=gt(mn,Ir,oa)}}_e||(_e=new j);var On=_e.get(mn);if(On)return On;_e.set(mn,Pn),_t(mn)?mn.forEach(function(wi){Pn.add(Jn(wi,wn,pi,wi,mn,_e))}):dt(mn)&&mn.forEach(function(wi,fi){Pn.set(fi,Jn(wi,wn,pi,fi,mn,_e))});var ln=ys?ws?Ae:Oe:ws?rr:ee,Ka=Jt?void 0:ln(mn);return Z(Ka||mn,function(wi,fi){Ka&&(fi=wi,wi=mn[fi]),Y(Pn,fi,Jn(wi,wn,pi,fi,mn,_e))}),Pn}le.exports=Jn},PJYZ:function(le,$){function M(j){if(j===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j}le.exports=M,le.exports.__esModule=!0,le.exports.default=le.exports},Q1l4:function(le,$){function M(j,Z){var Y=-1,k=j.length;for(Z||(Z=Array(k));++Y<k;)Z[Y]=j[Y];return Z}le.exports=M},"QQZ/":function(le,$,M){var j=M("Sq3C"),Z=M("Z1HP"),Y=M("Sxd8"),k=M("dt0z");function h(V,H,te){V=k(V),H=Y(H);var pe=H?Z(V):0;return H&&pe<H?j(H-pe,te)+V:V}le.exports=h},QcOe:function(le,$,M){var j=M("GoyQ"),Z=M("6sVZ"),Y=M("7Ix3"),k=Object.prototype,h=k.hasOwnProperty;function V(H){if(!j(H))return Y(H);var te=Z(H),pe=[];for(var Oe in H)Oe=="constructor"&&(te||!h.call(H,Oe))||pe.push(Oe);return pe}le.exports=V},QkVN:function(le,$,M){var j=M("+Qka"),Z=M("LsHQ"),Y=Z(function(k,h,V){j(k,h,V)});le.exports=Y},"R/W3":function(le,$,M){var j=M("KwMD"),Z=M("2ajD"),Y=M("CZoQ");function k(h,V,H){return V===V?Y(h,V,H):j(h,Z,H)}le.exports=k},RIqP:function(le,$,M){var j=M("Ijbi"),Z=M("EbDI"),Y=M("ZhPi"),k=M("Bnag");function h(V){return j(V)||Z(V)||Y(V)||k()}le.exports=h,le.exports.__esModule=!0,le.exports.default=le.exports},"RR/i":function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.typeConstraint=$.namedConstraint=$.taggedConstraint=$.traverseAncerstors=void 0;var j=M("xfSm"),Z=M("GXnB"),Y=function H(te,pe){var Oe=te.parentRequest;return Oe!==null?pe(Oe)?!0:H(Oe,pe):!1};$.traverseAncerstors=Y;var k=function(te){return function(pe){var Oe=function(vt){return vt!==null&&vt.target!==null&&vt.target.matchesTag(te)(pe)};return Oe.metaData=new Z.Metadata(te,pe),Oe}};$.taggedConstraint=k;var h=k(j.NAMED_TAG);$.namedConstraint=h;var V=function(te){return function(pe){var Oe=null;if(pe!==null)if(Oe=pe.bindings[0],typeof te=="string"){var Ae=Oe.serviceIdentifier;return Ae===te}else{var vt=pe.bindings[0].implementationType;return te===vt}return!1}};$.typeConstraint=V},SUU4:function(le,$,M){(function(j,Z){le.exports=Z(M("szb8"))})(this,function(j){"use strict";var Z=function(he){return he instanceof Uint8Array||he instanceof Uint16Array||he instanceof Uint32Array||he instanceof Int8Array||he instanceof Int16Array||he instanceof Int32Array||he instanceof Float32Array||he instanceof Float64Array||he instanceof Uint8ClampedArray},Y=function(he,qe){for(var er=Object.keys(qe),wr=0;wr<er.length;++wr)he[er[wr]]=qe[er[wr]];return he},k=`
`;function h(J){return typeof atob!="undefined"?atob(J):"base64:"+J}function V(J){var he=new Error("(regl) "+J);throw console.error(he),he}function H(J,he){J||V(he)}function te(J){return J?": "+J:""}function pe(J,he,qe){J in he||V("unknown parameter ("+J+")"+te(qe)+". possible values: "+Object.keys(he).join())}function Oe(J,he){Z(J)||V("invalid parameter type"+te(he)+". must be a typed array")}function Ae(J,he){switch(he){case"number":return typeof J=="number";case"object":return typeof J=="object";case"string":return typeof J=="string";case"boolean":return typeof J=="boolean";case"function":return typeof J=="function";case"undefined":return typeof J=="undefined";case"symbol":return typeof J=="symbol"}}function vt(J,he,qe){Ae(J,he)||V("invalid parameter type"+te(qe)+". expected "+he+", got "+typeof J)}function at(J,he){J>=0&&(J|0)===J||V("invalid parameter type, ("+J+")"+te(he)+". must be a nonnegative integer")}function gt(J,he,qe){he.indexOf(J)<0&&V("invalid value"+te(qe)+". must be one of: "+he)}var yt=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function St(J){Object.keys(J).forEach(function(he){yt.indexOf(he)<0&&V('invalid regl constructor argument "'+he+'". must be one of '+yt)})}function He(J,he){for(J=J+"";J.length<he;)J=" "+J;return J}function dt(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function ct(J,he){this.number=J,this.line=he,this.errors=[]}function _t(J,he,qe){this.file=J,this.line=he,this.message=qe}function ee(){var J=new Error,he=(J.stack||J).toString(),qe=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(he);if(qe)return qe[1];var er=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(he);return er?er[1]:"unknown"}function rr(){var J=new Error,he=(J.stack||J).toString(),qe=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(he);if(qe)return qe[1];var er=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(he);return er?er[1]:"unknown"}function Fr(J,he){var qe=J.split(`
`),er=1,wr=0,lr={unknown:new dt,0:new dt};lr.unknown.name=lr[0].name=he||ee(),lr.unknown.lines.push(new ct(0,""));for(var cr=0;cr<qe.length;++cr){var Hr=qe[cr],tn=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Hr);if(tn)switch(tn[1]){case"line":var an=/(\d+)(\s+\d+)?/.exec(tn[2]);an&&(er=an[1]|0,an[2]&&(wr=an[2]|0,wr in lr||(lr[wr]=new dt)));break;case"define":var un=/SHADER_NAME(_B64)?\s+(.*)$/.exec(tn[2]);un&&(lr[wr].name=un[1]?h(un[2]):un[2]);break}lr[wr].lines.push(new ct(er++,Hr))}return Object.keys(lr).forEach(function(on){var kn=lr[on];kn.lines.forEach(function(En){kn.index[En.number]=En})}),lr}function Mr(J){var he=[];return J.split(`
`).forEach(function(qe){if(!(qe.length<5)){var er=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(qe);er?he.push(new _t(er[1]|0,er[2]|0,er[3].trim())):qe.length>0&&he.push(new _t("unknown",0,qe))}}),he}function Nt(J,he){he.forEach(function(qe){var er=J[qe.file];if(er){var wr=er.index[qe.line];if(wr){wr.errors.push(qe),er.hasErrors=!0;return}}J.unknown.hasErrors=!0,J.unknown.lines[0].errors.push(qe)})}function ze(J,he,qe,er,wr){if(!J.getShaderParameter(he,J.COMPILE_STATUS)){var lr=J.getShaderInfoLog(he),cr=er===J.FRAGMENT_SHADER?"fragment":"vertex";be(qe,"string",cr+" shader source must be a string",wr);var Hr=Fr(qe,wr),tn=Mr(lr);Nt(Hr,tn),Object.keys(Hr).forEach(function(an){var un=Hr[an];if(!un.hasErrors)return;var on=[""],kn=[""];function En(Zr,Vt){on.push(Zr),kn.push(Vt||"")}En("file number "+an+": "+un.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),un.lines.forEach(function(Zr){if(Zr.errors.length>0){En(He(Zr.number,4)+"|  ","background-color:yellow; font-weight:bold"),En(Zr.line+k,"color:red; background-color:yellow; font-weight:bold");var Vt=0;Zr.errors.forEach(function(tr){var Qr=tr.message,zn=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Qr);if(zn){var Er=zn[1];switch(Qr=zn[2],Er){case"assign":Er="=";break}Vt=Math.max(Zr.line.indexOf(Er,Vt),0)}else Vt=0;En(He("| ",6)),En(He("^^^",Vt+3)+k,"font-weight:bold"),En(He("| ",6)),En(Qr+k,"font-weight:bold")}),En(He("| ",6)+k)}else En(He(Zr.number,4)+"|  "),En(Zr.line+k,"color:red")}),typeof document!="undefined"&&!window.chrome?(kn[0]=on.join("%c"),console.log.apply(console,kn)):console.log(on.join(""))}),H.raise("Error compiling "+cr+" shader, "+Hr[0].name)}}function zt(J,he,qe,er,wr){if(!J.getProgramParameter(he,J.LINK_STATUS)){var lr=J.getProgramInfoLog(he),cr=Fr(qe,wr),Hr=Fr(er,wr),tn='Error linking program with vertex shader, "'+Hr[0].name+'", and fragment shader "'+cr[0].name+'"';typeof document!="undefined"?console.log("%c"+tn+k+"%c"+lr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(tn+k+lr),H.raise(tn)}}function Kt(J){J._commandRef=ee()}function vr(J,he,qe,er){Kt(J);function wr(tn){return tn?er.id(tn):0}J._fragId=wr(J.static.frag),J._vertId=wr(J.static.vert);function lr(tn,an){Object.keys(an).forEach(function(un){tn[er.id(un)]=!0})}var cr=J._uniformSet={};lr(cr,he.static),lr(cr,he.dynamic);var Hr=J._attributeSet={};lr(Hr,qe.static),lr(Hr,qe.dynamic),J._hasCount="count"in J.static||"count"in J.dynamic||"elements"in J.static||"elements"in J.dynamic}function jr(J,he){var qe=rr();V(J+" in command "+(he||ee())+(qe==="unknown"?"":" called from "+qe))}function vn(J,he,qe){J||jr(he,qe||ee())}function kr(J,he,qe,er){J in he||jr("unknown parameter ("+J+")"+te(qe)+". possible values: "+Object.keys(he).join(),er||ee())}function be(J,he,qe,er){Ae(J,he)||jr("invalid parameter type"+te(qe)+". expected "+he+", got "+typeof J,er||ee())}function Ne(J){J()}function Ie(J,he,qe){J.texture?gt(J.texture._texture.internalformat,he,"unsupported texture format for attachment"):gt(J.renderbuffer._renderbuffer.format,qe,"unsupported renderbuffer format for attachment")}var pt=33071,mt=9728,Dt=9984,w=9985,br=9986,Ut=9987,Xt=5120,It=5121,Lt=5122,ir=5123,Ar=5124,nr=5125,Pr=5126,$r=32819,Or=32820,_r=33635,Br=34042,Jn=36193,mn={};mn[Xt]=mn[It]=1,mn[Lt]=mn[ir]=mn[Jn]=mn[_r]=mn[$r]=mn[Or]=2,mn[Ar]=mn[nr]=mn[Pr]=mn[Br]=4;function wn(J,he){return J===Or||J===$r||J===_r?2:J===Br?4:mn[J]*he}function pi(J){return!(J&J-1)&&!!J}function Ci(J,he,qe){var er,wr=he.width,lr=he.height,cr=he.channels;H(wr>0&&wr<=qe.maxTextureSize&&lr>0&&lr<=qe.maxTextureSize,"invalid texture shape"),(J.wrapS!==pt||J.wrapT!==pt)&&H(pi(wr)&&pi(lr),"incompatible wrap mode for texture, both width and height must be power of 2"),he.mipmask===1?wr!==1&&lr!==1&&H(J.minFilter!==Dt&&J.minFilter!==br&&J.minFilter!==w&&J.minFilter!==Ut,"min filter requires mipmap"):(H(pi(wr)&&pi(lr),"texture must be a square power of 2 to support mipmapping"),H(he.mipmask===(wr<<1)-1,"missing or incomplete mipmap data")),he.type===Pr&&(qe.extensions.indexOf("oes_texture_float_linear")<0&&H(J.minFilter===mt&&J.magFilter===mt,"filter not supported, must enable oes_texture_float_linear"),H(!J.genMipmaps,"mipmap generation not supported with float textures"));var Hr=he.images;for(er=0;er<16;++er)if(Hr[er]){var tn=wr>>er,an=lr>>er;H(he.mipmask&1<<er,"missing mipmap data");var un=Hr[er];if(H(un.width===tn&&un.height===an,"invalid shape for mip images"),H(un.format===he.format&&un.internalformat===he.internalformat&&un.type===he.type,"incompatible type for mip image"),!un.compressed)if(un.data){var on=Math.ceil(wn(un.type,cr)*tn/un.unpackAlignment)*un.unpackAlignment;H(un.data.byteLength===on*an,"invalid data for image, buffer size is inconsistent with image format")}else un.element||un.copy}else J.genMipmaps||H((he.mipmask&1<<er)==0,"extra mipmap data");he.compressed&&H(!J.genMipmaps,"mipmap generation for compressed images not supported")}function fa(J,he,qe,er){var wr=J.width,lr=J.height,cr=J.channels;H(wr>0&&wr<=er.maxTextureSize&&lr>0&&lr<=er.maxTextureSize,"invalid texture shape"),H(wr===lr,"cube map must be square"),H(he.wrapS===pt&&he.wrapT===pt,"wrap mode not supported by cube map");for(var Hr=0;Hr<qe.length;++Hr){var tn=qe[Hr];H(tn.width===wr&&tn.height===lr,"inconsistent cube map face shape"),he.genMipmaps&&(H(!tn.compressed,"can not generate mipmap for compressed textures"),H(tn.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var an=tn.images,un=0;un<16;++un){var on=an[un];if(on){var kn=wr>>un,En=lr>>un;H(tn.mipmask&1<<un,"missing mipmap data"),H(on.width===kn&&on.height===En,"invalid shape for mip images"),H(on.format===J.format&&on.internalformat===J.internalformat&&on.type===J.type,"incompatible type for mip image"),on.compressed||(on.data?H(on.data.byteLength===kn*En*Math.max(wn(on.type,cr),on.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):on.element||on.copy)}}}}var _e=Y(H,{optional:Ne,raise:V,commandRaise:jr,command:vn,parameter:pe,commandParameter:kr,constructor:St,type:vt,commandType:be,isTypedArray:Oe,nni:at,oneOf:gt,shaderError:ze,linkError:zt,callSite:rr,saveCommandRef:Kt,saveDrawInfo:vr,framebufferFormat:Ie,guessCommand:ee,texture2D:Ci,textureCube:fa}),Pn=0,oa=0,ws=5,ys=6;function Jt(J,he){this.id=Pn++,this.type=J,this.data=he}function Ir(J){return J.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function en(J){if(J.length===0)return[];var he=J.charAt(0),qe=J.charAt(J.length-1);if(J.length>1&&he===qe&&(he==='"'||he==="'"))return['"'+Ir(J.substr(1,J.length-2))+'"'];var er=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(J);if(er)return en(J.substr(0,er.index)).concat(en(er[1])).concat(en(J.substr(er.index+er[0].length)));var wr=J.split(".");if(wr.length===1)return['"'+Ir(J)+'"'];for(var lr=[],cr=0;cr<wr.length;++cr)lr=lr.concat(en(wr[cr]));return lr}function On(J){return"["+en(J).join("][")+"]"}function ln(J,he){return new Jt(J,On(he+""))}function Ka(J){return typeof J=="function"&&!J._reglType||J instanceof Jt}function wi(J,he){if(typeof J=="function")return new Jt(oa,J);if(typeof J=="number"||typeof J=="boolean")return new Jt(ws,J);if(Array.isArray(J))return new Jt(ys,J.map(function(qe,er){return wi(qe,he+"["+er+"]")}));if(J instanceof Jt)return J;_e(!1,"invalid option type in uniform "+he)}var fi={DynamicVariable:Jt,define:ln,isDynamic:Ka,unbox:wi,accessor:On},Ti={next:typeof requestAnimationFrame=="function"?function(J){return requestAnimationFrame(J)}:function(J){return setTimeout(J,16)},cancel:typeof cancelAnimationFrame=="function"?function(J){return cancelAnimationFrame(J)}:clearTimeout},da=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ya=da?function(){return+new Date}:typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function _s(){var J={"":0},he=[""];return{id:function(er){var wr=J[er];return wr||(wr=J[er]=he.length,he.push(er),wr)},str:function(er){return he[er]}}}function xo(J,he,qe){var er=document.createElement("canvas");Y(er.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),J.appendChild(er),J===document.body&&(er.style.position="absolute",Y(J.style,{margin:0,padding:0}));function wr(){var Hr=window.innerWidth,tn=window.innerHeight;if(J!==document.body){var an=er.getBoundingClientRect();Hr=an.right-an.left,tn=an.bottom-an.top}er.width=qe*Hr,er.height=qe*tn}var lr;J!==document.body&&typeof ResizeObserver=="function"?(lr=new ResizeObserver(function(){setTimeout(wr)}),lr.observe(J)):window.addEventListener("resize",wr,!1);function cr(){lr?lr.disconnect():window.removeEventListener("resize",wr),J.removeChild(er)}return wr(),{canvas:er,onDestroy:cr}}function $a(J,he){function qe(er){try{return J.getContext(er,he)}catch(wr){return null}}return qe("webgl")||qe("experimental-webgl")||qe("webgl-experimental")}function Vu(J){return typeof J.nodeName=="string"&&typeof J.appendChild=="function"&&typeof J.getBoundingClientRect=="function"}function ec(J){return typeof J.drawArrays=="function"||typeof J.drawElements=="function"}function wo(J){return typeof J=="string"?J.split():(_e(Array.isArray(J),"invalid extension array"),J)}function oe(J){return typeof J=="string"?(_e(typeof document!="undefined","not supported outside of DOM"),document.querySelector(J)):J}function ie(J){var he=J||{},qe,er,wr,lr,cr={},Hr=[],tn=[],an=typeof window=="undefined"?1:window.devicePixelRatio,un=!1,on=function(Vt){Vt&&_e.raise(Vt)},kn=function(){};if(typeof he=="string"?(_e(typeof document!="undefined","selector queries only supported in DOM environments"),qe=document.querySelector(he),_e(qe,"invalid query string for element")):typeof he=="object"?Vu(he)?qe=he:ec(he)?(lr=he,wr=lr.canvas):(_e.constructor(he),"gl"in he?lr=he.gl:"canvas"in he?wr=oe(he.canvas):"container"in he&&(er=oe(he.container)),"attributes"in he&&(cr=he.attributes,_e.type(cr,"object","invalid context attributes")),"extensions"in he&&(Hr=wo(he.extensions)),"optionalExtensions"in he&&(tn=wo(he.optionalExtensions)),"onDone"in he&&(_e.type(he.onDone,"function","invalid or missing onDone callback"),on=he.onDone),"profile"in he&&(un=!!he.profile),"pixelRatio"in he&&(an=+he.pixelRatio,_e(an>0,"invalid pixel ratio"))):_e.raise("invalid arguments to regl"),qe&&(qe.nodeName.toLowerCase()==="canvas"?wr=qe:er=qe),!lr){if(!wr){_e(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var En=xo(er||document.body,on,an);if(!En)return null;wr=En.canvas,kn=En.onDestroy}cr.premultipliedAlpha===void 0&&(cr.premultipliedAlpha=!0),lr=$a(wr,cr)}return lr?{gl:lr,canvas:wr,container:er,extensions:Hr,optionalExtensions:tn,pixelRatio:an,profile:un,onDone:on,onDestroy:kn}:(kn(),on("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function xe(J,he){var qe={};function er(Hr){_e.type(Hr,"string","extension name must be string");var tn=Hr.toLowerCase(),an;try{an=qe[tn]=wr(Hr)}catch(un){}return!!an}function wr(Hr){return J.getExtension(Hr)?J.getExtension(Hr):J.getExtension(Hr.toLowerCase())?J.getExtension(Hr.toLowerCase()):null}for(var lr=0;lr<he.extensions.length;++lr){var cr=he.extensions[lr];if(!er(cr))return he.onDestroy(),he.onDone('"'+cr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return he.optionalExtensions.forEach(er),{extensions:qe,restore:function(){Object.keys(qe).forEach(function(tn){if(qe[tn]&&!er(tn))throw new Error("(regl): error restoring extension "+tn)})}}}function Me(J,he){for(var qe=Array(J),er=0;er<J;++er)qe[er]=he(er);return qe}var Ve=5120,ft=5121,Ct=5122,Ce=5123,Ye=5124,nt=5125,Nr=5126;function Xr(J){for(var he=16;he<=1<<28;he*=16)if(J<=he)return he;return 0}function dr(J){var he,qe;return he=(J>65535)<<4,J>>>=he,qe=(J>255)<<3,J>>>=qe,he|=qe,qe=(J>15)<<2,J>>>=qe,he|=qe,qe=(J>3)<<1,J>>>=qe,he|=qe,he|J>>1}function Yr(){var J=Me(8,function(){return[]});function he(lr){var cr=Xr(lr),Hr=J[dr(cr)>>2];return Hr.length>0?Hr.pop():new ArrayBuffer(cr)}function qe(lr){J[dr(lr.byteLength)>>2].push(lr)}function er(lr,cr){var Hr=null;switch(lr){case Ve:Hr=new Int8Array(he(cr),0,cr);break;case ft:Hr=new Uint8Array(he(cr),0,cr);break;case Ct:Hr=new Int16Array(he(2*cr),0,cr);break;case Ce:Hr=new Uint16Array(he(2*cr),0,cr);break;case Ye:Hr=new Int32Array(he(4*cr),0,cr);break;case nt:Hr=new Uint32Array(he(4*cr),0,cr);break;case Nr:Hr=new Float32Array(he(4*cr),0,cr);break;default:return null}return Hr.length!==cr?Hr.subarray(0,cr):Hr}function wr(lr){qe(lr.buffer)}return{alloc:he,free:qe,allocType:er,freeType:wr}}var xn=Yr();xn.zero=Yr();var Gn=3408,pr=3410,jn=3411,Rn=3412,Nn=3413,Gi=3414,Hn=3415,ha=33901,Sa=33902,Ji=3379,ei=3386,ua=34921,Ds=36347,Ca=36348,zo=35661,Ei=35660,Qi=34930,Bi=36349,Uo=34076,Ho=34024,so=7936,Ft=7937,nu=7938,Yt=35724,uo=34047,jo=36063,vo=34852,no=3553,As=34067,qr=34069,xs=33984,hn=6408,Ts=5126,wt=5121,_l=36160,Us=36053,ce=36064,Tu=16384,ls=function(he,qe){var er=1;qe.ext_texture_filter_anisotropic&&(er=he.getParameter(uo));var wr=1,lr=1;qe.webgl_draw_buffers&&(wr=he.getParameter(vo),lr=he.getParameter(jo));var cr=!!qe.oes_texture_float;if(cr){var Hr=he.createTexture();he.bindTexture(no,Hr),he.texImage2D(no,0,hn,1,1,0,hn,Ts,null);var tn=he.createFramebuffer();if(he.bindFramebuffer(_l,tn),he.framebufferTexture2D(_l,ce,no,Hr,0),he.bindTexture(no,null),he.checkFramebufferStatus(_l)!==Us)cr=!1;else{he.viewport(0,0,1,1),he.clearColor(1,0,0,1),he.clear(Tu);var an=xn.allocType(Ts,4);he.readPixels(0,0,1,1,hn,Ts,an),he.getError()?cr=!1:(he.deleteFramebuffer(tn),he.deleteTexture(Hr),cr=an[0]===1),xn.freeType(an)}}var un=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),on=!0;if(!un){var kn=he.createTexture(),En=xn.allocType(wt,36);he.activeTexture(xs),he.bindTexture(As,kn),he.texImage2D(qr,0,hn,3,3,0,hn,wt,En),xn.freeType(En),he.bindTexture(As,null),he.deleteTexture(kn),on=!he.getError()}return{colorBits:[he.getParameter(pr),he.getParameter(jn),he.getParameter(Rn),he.getParameter(Nn)],depthBits:he.getParameter(Gi),stencilBits:he.getParameter(Hn),subpixelBits:he.getParameter(Gn),extensions:Object.keys(qe).filter(function(Zr){return!!qe[Zr]}),maxAnisotropic:er,maxDrawbuffers:wr,maxColorAttachments:lr,pointSizeDims:he.getParameter(ha),lineWidthDims:he.getParameter(Sa),maxViewportDims:he.getParameter(ei),maxCombinedTextureUnits:he.getParameter(zo),maxCubeMapSize:he.getParameter(Uo),maxRenderbufferSize:he.getParameter(Ho),maxTextureUnits:he.getParameter(Qi),maxTextureSize:he.getParameter(Ji),maxAttributes:he.getParameter(ua),maxVertexUniforms:he.getParameter(Ds),maxVertexTextureUnits:he.getParameter(Ei),maxVaryingVectors:he.getParameter(Ca),maxFragmentUniforms:he.getParameter(Bi),glsl:he.getParameter(Yt),renderer:he.getParameter(Ft),vendor:he.getParameter(so),version:he.getParameter(nu),readFloat:cr,npotTextureCube:on}};function $o(J){return!!J&&typeof J=="object"&&Array.isArray(J.shape)&&Array.isArray(J.stride)&&typeof J.offset=="number"&&J.shape.length===J.stride.length&&(Array.isArray(J.data)||Z(J.data))}var Ke=function(he){return Object.keys(he).map(function(qe){return he[qe]})},me={shape:mo,flatten:la};function Xe(J,he,qe){for(var er=0;er<he;++er)qe[er]=J[er]}function Ht(J,he,qe,er){for(var wr=0,lr=0;lr<he;++lr)for(var cr=J[lr],Hr=0;Hr<qe;++Hr)er[wr++]=cr[Hr]}function rn(J,he,qe,er,wr,lr){for(var cr=lr,Hr=0;Hr<he;++Hr)for(var tn=J[Hr],an=0;an<qe;++an)for(var un=tn[an],on=0;on<er;++on)wr[cr++]=un[on]}function Yn(J,he,qe,er,wr){for(var lr=1,cr=qe+1;cr<he.length;++cr)lr*=he[cr];var Hr=he[qe];if(he.length-qe==4){var tn=he[qe+1],an=he[qe+2],un=he[qe+3];for(cr=0;cr<Hr;++cr)rn(J[cr],tn,an,un,er,wr),wr+=lr}else for(cr=0;cr<Hr;++cr)Yn(J[cr],he,qe+1,er,wr),wr+=lr}function la(J,he,qe,er){var wr=1;if(he.length)for(var lr=0;lr<he.length;++lr)wr*=he[lr];else wr=0;var cr=er||xn.allocType(qe,wr);switch(he.length){case 0:break;case 1:Xe(J,he[0],cr);break;case 2:Ht(J,he[0],he[1],cr);break;case 3:rn(J,he[0],he[1],he[2],cr,0);break;default:Yn(J,he,0,cr,0)}return cr}function mo(J){for(var he=[],qe=J;qe.length;qe=qe[0])he.push(qe.length);return he}var lo={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},bo=5120,qo=5122,yc=5124,gu=5121,cs=5123,iu=5125,Mu=5126,au=5126,js={int8:bo,int16:qo,int32:yc,uint8:gu,uint16:cs,uint32:iu,float:Mu,float32:au},cl=35048,Pu=35040,co={dynamic:cl,stream:Pu,static:35044},Po=me.flatten,Ha=me.shape,Wa=35044,Yh=35040,Bc=5121,Nc=5126,xl=[];xl[5120]=1,xl[5122]=2,xl[5124]=4,xl[5121]=1,xl[5123]=2,xl[5125]=4,xl[5126]=4;function bl(J){return lo[Object.prototype.toString.call(J)]|0}function b(J,he){for(var qe=0;qe<he.length;++qe)J[qe]=he[qe]}function L(J,he,qe,er,wr,lr,cr){for(var Hr=0,tn=0;tn<qe;++tn)for(var an=0;an<er;++an)J[Hr++]=he[wr*tn+lr*an+cr]}function X(J,he,qe,er){var wr=0,lr={};function cr(Vt){this.id=wr++,this.buffer=J.createBuffer(),this.type=Vt,this.usage=Wa,this.byteLength=0,this.dimension=1,this.dtype=Bc,this.persistentData=null,qe.profile&&(this.stats={size:0})}cr.prototype.bind=function(){J.bindBuffer(this.type,this.buffer)},cr.prototype.destroy=function(){kn(this)};var Hr=[];function tn(Vt,tr){var Qr=Hr.pop();return Qr||(Qr=new cr(Vt)),Qr.bind(),on(Qr,tr,Yh,0,1,!1),Qr}function an(Vt){Hr.push(Vt)}function un(Vt,tr,Qr){Vt.byteLength=tr.byteLength,J.bufferData(Vt.type,tr,Qr)}function on(Vt,tr,Qr,zn,Er,qn){var Bn;if(Vt.usage=Qr,Array.isArray(tr)){if(Vt.dtype=zn||Nc,tr.length>0){var pn;if(Array.isArray(tr[0])){Bn=Ha(tr);for(var Rr=1,mr=1;mr<Bn.length;++mr)Rr*=Bn[mr];Vt.dimension=Rr,pn=Po(tr,Bn,Vt.dtype),un(Vt,pn,Qr),qn?Vt.persistentData=pn:xn.freeType(pn)}else if(typeof tr[0]=="number"){Vt.dimension=Er;var gn=xn.allocType(Vt.dtype,tr.length);b(gn,tr),un(Vt,gn,Qr),qn?Vt.persistentData=gn:xn.freeType(gn)}else Z(tr[0])?(Vt.dimension=tr[0].length,Vt.dtype=zn||bl(tr[0])||Nc,pn=Po(tr,[tr.length,tr[0].length],Vt.dtype),un(Vt,pn,Qr),qn?Vt.persistentData=pn:xn.freeType(pn)):_e.raise("invalid buffer data")}}else if(Z(tr))Vt.dtype=zn||bl(tr),Vt.dimension=Er,un(Vt,tr,Qr),qn&&(Vt.persistentData=new Uint8Array(new Uint8Array(tr.buffer)));else if($o(tr)){Bn=tr.shape;var Sn=tr.stride,sn=tr.offset,In=0,Tn=0,ta=0,ji=0;Bn.length===1?(In=Bn[0],Tn=1,ta=Sn[0],ji=0):Bn.length===2?(In=Bn[0],Tn=Bn[1],ta=Sn[0],ji=Sn[1]):_e.raise("invalid shape"),Vt.dtype=zn||bl(tr.data)||Nc,Vt.dimension=Tn;var Fn=xn.allocType(Vt.dtype,In*Tn);L(Fn,tr.data,In,Tn,ta,ji,sn),un(Vt,Fn,Qr),qn?Vt.persistentData=Fn:xn.freeType(Fn)}else tr instanceof ArrayBuffer?(Vt.dtype=Bc,Vt.dimension=Er,un(Vt,tr,Qr),qn&&(Vt.persistentData=new Uint8Array(new Uint8Array(tr)))):_e.raise("invalid buffer data")}function kn(Vt){he.bufferCount--,er(Vt);var tr=Vt.buffer;_e(tr,"buffer must not be deleted already"),J.deleteBuffer(tr),Vt.buffer=null,delete lr[Vt.id]}function En(Vt,tr,Qr,zn){he.bufferCount++;var Er=new cr(tr);lr[Er.id]=Er;function qn(Rr){var mr=Wa,gn=null,Sn=0,sn=0,In=1;return Array.isArray(Rr)||Z(Rr)||$o(Rr)||Rr instanceof ArrayBuffer?gn=Rr:typeof Rr=="number"?Sn=Rr|0:Rr&&(_e.type(Rr,"object","buffer arguments must be an object, a number or an array"),"data"in Rr&&(_e(gn===null||Array.isArray(gn)||Z(gn)||$o(gn),"invalid data for buffer"),gn=Rr.data),"usage"in Rr&&(_e.parameter(Rr.usage,co,"invalid buffer usage"),mr=co[Rr.usage]),"type"in Rr&&(_e.parameter(Rr.type,js,"invalid buffer type"),sn=js[Rr.type]),"dimension"in Rr&&(_e.type(Rr.dimension,"number","invalid dimension"),In=Rr.dimension|0),"length"in Rr&&(_e.nni(Sn,"buffer length must be a nonnegative integer"),Sn=Rr.length|0)),Er.bind(),gn?on(Er,gn,mr,sn,In,zn):(Sn&&J.bufferData(Er.type,Sn,mr),Er.dtype=sn||Bc,Er.usage=mr,Er.dimension=In,Er.byteLength=Sn),qe.profile&&(Er.stats.size=Er.byteLength*xl[Er.dtype]),qn}function Bn(Rr,mr){_e(mr+Rr.byteLength<=Er.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Rr.byteLength+" starting from offset "+mr+" to a buffer of size "+Er.byteLength),J.bufferSubData(Er.type,mr,Rr)}function pn(Rr,mr){var gn=(mr||0)|0,Sn;if(Er.bind(),Z(Rr)||Rr instanceof ArrayBuffer)Bn(Rr,gn);else if(Array.isArray(Rr)){if(Rr.length>0)if(typeof Rr[0]=="number"){var sn=xn.allocType(Er.dtype,Rr.length);b(sn,Rr),Bn(sn,gn),xn.freeType(sn)}else if(Array.isArray(Rr[0])||Z(Rr[0])){Sn=Ha(Rr);var In=Po(Rr,Sn,Er.dtype);Bn(In,gn),xn.freeType(In)}else _e.raise("invalid buffer data")}else if($o(Rr)){Sn=Rr.shape;var Tn=Rr.stride,ta=0,ji=0,Fn=0,Dn=0;Sn.length===1?(ta=Sn[0],ji=1,Fn=Tn[0],Dn=0):Sn.length===2?(ta=Sn[0],ji=Sn[1],Fn=Tn[0],Dn=Tn[1]):_e.raise("invalid shape");var Mi=Array.isArray(Rr.data)?Er.dtype:bl(Rr.data),qi=xn.allocType(Mi,ta*ji);L(qi,Rr.data,ta,ji,Fn,Dn,Rr.offset),Bn(qi,gn),xn.freeType(qi)}else _e.raise("invalid data for buffer subdata");return qn}return Qr||qn(Vt),qn._reglType="buffer",qn._buffer=Er,qn.subdata=pn,qe.profile&&(qn.stats=Er.stats),qn.destroy=function(){kn(Er)},qn}function Zr(){Ke(lr).forEach(function(Vt){Vt.buffer=J.createBuffer(),J.bindBuffer(Vt.type,Vt.buffer),J.bufferData(Vt.type,Vt.persistentData||Vt.byteLength,Vt.usage)})}return qe.profile&&(he.getTotalBufferSize=function(){var Vt=0;return Object.keys(lr).forEach(function(tr){Vt+=lr[tr].stats.size}),Vt}),{create:En,createStream:tn,destroyStream:an,clear:function(){Ke(lr).forEach(kn),Hr.forEach(kn)},getBuffer:function(tr){return tr&&tr._buffer instanceof cr?tr._buffer:null},restore:Zr,_initBuffer:on}}var B=0,se=0,Le=1,ot=1,Et=4,Pt=4,zr={points:B,point:se,lines:Le,line:ot,triangles:Et,triangle:Pt,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Kr=0,oi=1,Ki=4,Li=5120,Oa=5121,sa=5122,Va=5123,Qo=5124,yu=5125,Ma=34963,Jo=35040,_c=35044;function tc(J,he,qe,er){var wr={},lr=0,cr={uint8:Oa,uint16:Va};he.oes_element_index_uint&&(cr.uint32=yu);function Hr(Zr){this.id=lr++,wr[this.id]=this,this.buffer=Zr,this.primType=Ki,this.vertCount=0,this.type=0}Hr.prototype.bind=function(){this.buffer.bind()};var tn=[];function an(Zr){var Vt=tn.pop();return Vt||(Vt=new Hr(qe.create(null,Ma,!0,!1)._buffer)),on(Vt,Zr,Jo,-1,-1,0,0),Vt}function un(Zr){tn.push(Zr)}function on(Zr,Vt,tr,Qr,zn,Er,qn){Zr.buffer.bind();var Bn;if(Vt){var pn=qn;!qn&&(!Z(Vt)||$o(Vt)&&!Z(Vt.data))&&(pn=he.oes_element_index_uint?yu:Va),qe._initBuffer(Zr.buffer,Vt,tr,pn,3)}else J.bufferData(Ma,Er,tr),Zr.buffer.dtype=Bn||Oa,Zr.buffer.usage=tr,Zr.buffer.dimension=3,Zr.buffer.byteLength=Er;if(Bn=qn,!qn){switch(Zr.buffer.dtype){case Oa:case Li:Bn=Oa;break;case Va:case sa:Bn=Va;break;case yu:case Qo:Bn=yu;break;default:_e.raise("unsupported type for element array")}Zr.buffer.dtype=Bn}Zr.type=Bn,_e(Bn!==yu||!!he.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Rr=zn;Rr<0&&(Rr=Zr.buffer.byteLength,Bn===Va?Rr>>=1:Bn===yu&&(Rr>>=2)),Zr.vertCount=Rr;var mr=Qr;if(Qr<0){mr=Ki;var gn=Zr.buffer.dimension;gn===1&&(mr=Kr),gn===2&&(mr=oi),gn===3&&(mr=Ki)}Zr.primType=mr}function kn(Zr){er.elementsCount--,_e(Zr.buffer!==null,"must not double destroy elements"),delete wr[Zr.id],Zr.buffer.destroy(),Zr.buffer=null}function En(Zr,Vt){var tr=qe.create(null,Ma,!0),Qr=new Hr(tr._buffer);er.elementsCount++;function zn(Er){if(!Er)tr(),Qr.primType=Ki,Qr.vertCount=0,Qr.type=Oa;else if(typeof Er=="number")tr(Er),Qr.primType=Ki,Qr.vertCount=Er|0,Qr.type=Oa;else{var qn=null,Bn=_c,pn=-1,Rr=-1,mr=0,gn=0;Array.isArray(Er)||Z(Er)||$o(Er)?qn=Er:(_e.type(Er,"object","invalid arguments for elements"),"data"in Er&&(qn=Er.data,_e(Array.isArray(qn)||Z(qn)||$o(qn),"invalid data for element buffer")),"usage"in Er&&(_e.parameter(Er.usage,co,"invalid element buffer usage"),Bn=co[Er.usage]),"primitive"in Er&&(_e.parameter(Er.primitive,zr,"invalid element buffer primitive"),pn=zr[Er.primitive]),"count"in Er&&(_e(typeof Er.count=="number"&&Er.count>=0,"invalid vertex count for elements"),Rr=Er.count|0),"type"in Er&&(_e.parameter(Er.type,cr,"invalid buffer type"),gn=cr[Er.type]),"length"in Er?mr=Er.length|0:(mr=Rr,gn===Va||gn===sa?mr*=2:(gn===yu||gn===Qo)&&(mr*=4))),on(Qr,qn,Bn,pn,Rr,mr,gn)}return zn}return zn(Zr),zn._reglType="elements",zn._elements=Qr,zn.subdata=function(Er,qn){return tr.subdata(Er,qn),zn},zn.destroy=function(){kn(Qr)},zn}return{create:En,createStream:an,destroyStream:un,getElements:function(Vt){return typeof Vt=="function"&&Vt._elements instanceof Hr?Vt._elements:null},clear:function(){Ke(wr).forEach(kn)}}}var Eo=new Float32Array(1),El=new Uint32Array(Eo.buffer),wf=5123;function Sl(J){for(var he=xn.allocType(wf,J.length),qe=0;qe<J.length;++qe)if(isNaN(J[qe]))he[qe]=65535;else if(J[qe]===Infinity)he[qe]=31744;else if(J[qe]===-Infinity)he[qe]=64512;else{Eo[0]=J[qe];var er=El[0],wr=er>>>31<<15,lr=(er<<1>>>24)-127,cr=er>>13&(1<<10)-1;if(lr<-24)he[qe]=wr;else if(lr<-14){var Hr=-14-lr;he[qe]=wr+(cr+(1<<10)>>Hr)}else lr>15?he[qe]=wr+31744:he[qe]=wr+(lr+15<<10)+cr}return he}function xa(J){return Array.isArray(J)||Z(J)}var Fl=function(he){return!(he&he-1)&&!!he},Ah=34467,fs=3553,Af=34067,tl=34069,fl=6408,xc=6406,Bl=6407,zc=6409,Nl=6410,fo=32854,nf=32855,Ap=36194,Uc=32819,Th=32820,Kp=33635,Kh=34042,ou=6402,zl=34041,hl=35904,jc=35906,Ul=36193,af=33776,Mh=33777,of=33778,es=33779,$h=35986,Vc=35987,qh=34798,rc=35840,nc=35841,Tf=35842,ic=35843,sf=36196,$f=5121,qf=5123,Qf=5125,jl=5126,Cl=10242,Mf=10243,Qh=10497,Jf=33071,Jh=33648,eh=10240,Pf=10241,wl=9728,At=9729,Vr=9984,yr=9985,gi=9986,Qn=9987,Hi=33170,Da=4352,Ya=4353,uf=4354,lf=34046,Vl=3317,ep=37440,Ph=37441,ac=37443,pl=37444,$i=33984,io=[Vr,gi,yr,Qn],di=[0,zc,Nl,Bl,fl],qa={};qa[zc]=qa[xc]=qa[ou]=1,qa[zl]=qa[Nl]=2,qa[Bl]=qa[hl]=3,qa[fl]=qa[jc]=4;function Kn(J){return"[object "+J+"]"}var Gu=Kn("HTMLCanvasElement"),cf=Kn("OffscreenCanvas"),Gc=Kn("CanvasRenderingContext2D"),Hu=Kn("ImageBitmap"),bs=Kn("HTMLImageElement"),ff=Kn("HTMLVideoElement"),Ln=Object.keys(lo).concat([Gu,cf,Gc,Hu,bs,ff]),Gl=[];Gl[$f]=1,Gl[jl]=4,Gl[Ul]=2,Gl[qf]=2,Gl[Qf]=4;var hs=[];hs[fo]=2,hs[nf]=2,hs[Ap]=2,hs[zl]=4,hs[af]=.5,hs[Mh]=.5,hs[of]=1,hs[es]=1,hs[$h]=.5,hs[Vc]=1,hs[qh]=1,hs[rc]=.5,hs[nc]=.25,hs[Tf]=.5,hs[ic]=.25,hs[sf]=.5;function hf(J){return Array.isArray(J)&&(J.length===0||typeof J[0]=="number")}function Vs(J){if(!Array.isArray(J))return!1;var he=J.length;return!(he===0||!xa(J[0]))}function Ms(J){return Object.prototype.toString.call(J)}function bc(J){return Ms(J)===Gu}function Hl(J){return Ms(J)===cf}function _u(J){return Ms(J)===Gc}function Ec(J){return Ms(J)===Hu}function tp(J){return Ms(J)===bs}function th(J){return Ms(J)===ff}function Hc(J){var he=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(he&&J&&J.getContext)}function pf(J){var he=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(he&&J&&"src"in J&&"crossOrigin"in J)}function Wu(J){if(!J)return!1;if(Hc(J)||pf(J))return!0;var he=Ms(J);return Ln.indexOf(he)>=0?!0:hf(J)||Vs(J)||$o(J)}function rl(J){return lo[Object.prototype.toString.call(J)]|0}function ma(J,he){var qe=he.length;switch(J.type){case $f:case qf:case Qf:case jl:var er=xn.allocType(J.type,qe);er.set(he),J.data=er;break;case Ul:J.data=Sl(he);break;default:_e.raise("unsupported texture type, must specify a typed array")}}function Al(J,he){return xn.allocType(J.type===Ul?jl:J.type,he)}function Tl(J,he){J.type===Ul?(J.data=Sl(he),xn.freeType(he)):J.data=he}function Za(J,he,qe,er,wr,lr){for(var cr=J.width,Hr=J.height,tn=J.channels,an=cr*Hr*tn,un=Al(J,an),on=0,kn=0;kn<Hr;++kn)for(var En=0;En<cr;++En)for(var Zr=0;Zr<tn;++Zr)un[on++]=he[qe*En+er*kn+wr*Zr+lr];Tl(J,un)}function ts(J,he,qe,er,wr,lr){var cr;if(typeof hs[J]!="undefined"?cr=hs[J]:cr=qa[J]*Gl[he],lr&&(cr*=6),wr){for(var Hr=0,tn=qe;tn>=1;)Hr+=cr*tn*tn,tn/=2;return Hr}else return cr*qe*er}function Wc(J,he,qe,er,wr,lr,cr){var Hr={"don't care":Da,"dont care":Da,nice:uf,fast:Ya},tn={repeat:Qh,clamp:Jf,mirror:Jh},an={nearest:wl,linear:At},un=Y({mipmap:Qn,"nearest mipmap nearest":Vr,"linear mipmap nearest":yr,"nearest mipmap linear":gi,"linear mipmap linear":Qn},an),on={none:0,browser:pl},kn={uint8:$f,rgba4:Uc,rgb565:Kp,"rgb5 a1":Th},En={alpha:xc,luminance:zc,"luminance alpha":Nl,rgb:Bl,rgba:fl,rgba4:fo,"rgb5 a1":nf,rgb565:Ap},Zr={};he.ext_srgb&&(En.srgb=hl,En.srgba=jc),he.oes_texture_float&&(kn.float32=kn.float=jl),he.oes_texture_half_float&&(kn.float16=kn["half float"]=Ul),he.webgl_depth_texture&&(Y(En,{depth:ou,"depth stencil":zl}),Y(kn,{uint16:qf,uint32:Qf,"depth stencil":Kh})),he.webgl_compressed_texture_s3tc&&Y(Zr,{"rgb s3tc dxt1":af,"rgba s3tc dxt1":Mh,"rgba s3tc dxt3":of,"rgba s3tc dxt5":es}),he.webgl_compressed_texture_atc&&Y(Zr,{"rgb atc":$h,"rgba atc explicit alpha":Vc,"rgba atc interpolated alpha":qh}),he.webgl_compressed_texture_pvrtc&&Y(Zr,{"rgb pvrtc 4bppv1":rc,"rgb pvrtc 2bppv1":nc,"rgba pvrtc 4bppv1":Tf,"rgba pvrtc 2bppv1":ic}),he.webgl_compressed_texture_etc1&&(Zr["rgb etc1"]=sf);var Vt=Array.prototype.slice.call(J.getParameter(Ah)||new Uint32Array(0));Object.keys(Zr).forEach(function(Ge){var hr=Zr[Ge];Vt.indexOf(hr)>=0&&(En[Ge]=hr)});var tr=Object.keys(En);qe.textureFormats=tr;var Qr=[];Object.keys(En).forEach(function(Ge){var hr=En[Ge];Qr[hr]=Ge});var zn=[];Object.keys(kn).forEach(function(Ge){var hr=kn[Ge];zn[hr]=Ge});var Er=[];Object.keys(an).forEach(function(Ge){var hr=an[Ge];Er[hr]=Ge});var qn=[];Object.keys(un).forEach(function(Ge){var hr=un[Ge];qn[hr]=Ge});var Bn=[];Object.keys(tn).forEach(function(Ge){var hr=tn[Ge];Bn[hr]=Ge});var pn=tr.reduce(function(Ge,hr){var Wt=En[hr];return Wt===zc||Wt===xc||Wt===zc||Wt===Nl||Wt===ou||Wt===zl||he.ext_srgb&&(Wt===hl||Wt===jc)?Ge[Wt]=Wt:Wt===nf||hr.indexOf("rgba")>=0?Ge[Wt]=fl:Ge[Wt]=Bl,Ge},{});function Rr(){this.internalformat=fl,this.format=fl,this.type=$f,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=pl,this.width=0,this.height=0,this.channels=0}function mr(Ge,hr){Ge.internalformat=hr.internalformat,Ge.format=hr.format,Ge.type=hr.type,Ge.compressed=hr.compressed,Ge.premultiplyAlpha=hr.premultiplyAlpha,Ge.flipY=hr.flipY,Ge.unpackAlignment=hr.unpackAlignment,Ge.colorSpace=hr.colorSpace,Ge.width=hr.width,Ge.height=hr.height,Ge.channels=hr.channels}function gn(Ge,hr){if(!(typeof hr!="object"||!hr)){if("premultiplyAlpha"in hr&&(_e.type(hr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Ge.premultiplyAlpha=hr.premultiplyAlpha),"flipY"in hr&&(_e.type(hr.flipY,"boolean","invalid texture flip"),Ge.flipY=hr.flipY),"alignment"in hr&&(_e.oneOf(hr.alignment,[1,2,4,8],"invalid texture unpack alignment"),Ge.unpackAlignment=hr.alignment),"colorSpace"in hr&&(_e.parameter(hr.colorSpace,on,"invalid colorSpace"),Ge.colorSpace=on[hr.colorSpace]),"type"in hr){var Wt=hr.type;_e(he.oes_texture_float||!(Wt==="float"||Wt==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),_e(he.oes_texture_half_float||!(Wt==="half float"||Wt==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),_e(he.webgl_depth_texture||!(Wt==="uint16"||Wt==="uint32"||Wt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),_e.parameter(Wt,kn,"invalid texture type"),Ge.type=kn[Wt]}var Wn=Ge.width,va=Ge.height,De=Ge.channels,Ee=!1;"shape"in hr?(_e(Array.isArray(hr.shape)&&hr.shape.length>=2,"shape must be an array"),Wn=hr.shape[0],va=hr.shape[1],hr.shape.length===3&&(De=hr.shape[2],_e(De>0&&De<=4,"invalid number of channels"),Ee=!0),_e(Wn>=0&&Wn<=qe.maxTextureSize,"invalid width"),_e(va>=0&&va<=qe.maxTextureSize,"invalid height")):("radius"in hr&&(Wn=va=hr.radius,_e(Wn>=0&&Wn<=qe.maxTextureSize,"invalid radius")),"width"in hr&&(Wn=hr.width,_e(Wn>=0&&Wn<=qe.maxTextureSize,"invalid width")),"height"in hr&&(va=hr.height,_e(va>=0&&va<=qe.maxTextureSize,"invalid height")),"channels"in hr&&(De=hr.channels,_e(De>0&&De<=4,"invalid number of channels"),Ee=!0)),Ge.width=Wn|0,Ge.height=va|0,Ge.channels=De|0;var it=!1;if("format"in hr){var Bt=hr.format;_e(he.webgl_depth_texture||!(Bt==="depth"||Bt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),_e.parameter(Bt,En,"invalid texture format");var ur=Ge.internalformat=En[Bt];Ge.format=pn[ur],Bt in kn&&("type"in hr||(Ge.type=kn[Bt])),Bt in Zr&&(Ge.compressed=!0),it=!0}!Ee&&it?Ge.channels=qa[Ge.format]:Ee&&!it?Ge.channels!==di[Ge.format]&&(Ge.format=Ge.internalformat=di[Ge.channels]):it&&Ee&&_e(Ge.channels===qa[Ge.format],"number of channels inconsistent with specified format")}}function Sn(Ge){J.pixelStorei(ep,Ge.flipY),J.pixelStorei(Ph,Ge.premultiplyAlpha),J.pixelStorei(ac,Ge.colorSpace),J.pixelStorei(Vl,Ge.unpackAlignment)}function sn(){Rr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function In(Ge,hr){var Wt=null;if(Wu(hr)?Wt=hr:hr&&(_e.type(hr,"object","invalid pixel data type"),gn(Ge,hr),"x"in hr&&(Ge.xOffset=hr.x|0),"y"in hr&&(Ge.yOffset=hr.y|0),Wu(hr.data)&&(Wt=hr.data)),_e(!Ge.compressed||Wt instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),hr.copy){_e(!Wt,"can not specify copy and data field for the same texture");var Wn=wr.viewportWidth,va=wr.viewportHeight;Ge.width=Ge.width||Wn-Ge.xOffset,Ge.height=Ge.height||va-Ge.yOffset,Ge.needsCopy=!0,_e(Ge.xOffset>=0&&Ge.xOffset<Wn&&Ge.yOffset>=0&&Ge.yOffset<va&&Ge.width>0&&Ge.width<=Wn&&Ge.height>0&&Ge.height<=va,"copy texture read out of bounds")}else if(!Wt)Ge.width=Ge.width||1,Ge.height=Ge.height||1,Ge.channels=Ge.channels||4;else if(Z(Wt))Ge.channels=Ge.channels||4,Ge.data=Wt,!("type"in hr)&&Ge.type===$f&&(Ge.type=rl(Wt));else if(hf(Wt))Ge.channels=Ge.channels||4,ma(Ge,Wt),Ge.alignment=1,Ge.needsFree=!0;else if($o(Wt)){var De=Wt.data;!Array.isArray(De)&&Ge.type===$f&&(Ge.type=rl(De));var Ee=Wt.shape,it=Wt.stride,Bt,ur,st,ut,bt,Se;Ee.length===3?(st=Ee[2],Se=it[2]):(_e(Ee.length===2,"invalid ndarray pixel data, must be 2 or 3D"),st=1,Se=1),Bt=Ee[0],ur=Ee[1],ut=it[0],bt=it[1],Ge.alignment=1,Ge.width=Bt,Ge.height=ur,Ge.channels=st,Ge.format=Ge.internalformat=di[st],Ge.needsFree=!0,Za(Ge,De,ut,bt,Se,Wt.offset)}else if(Hc(Wt)||bc(Wt)||Hl(Wt)||_u(Wt))Hc(Wt)||bc(Wt)||Hl(Wt)?Ge.element=Wt:Ge.element=Wt.canvas,Ge.width=Ge.element.width,Ge.height=Ge.element.height,Ge.channels=4;else if(Ec(Wt))Ge.element=Wt,Ge.width=Wt.width,Ge.height=Wt.height,Ge.channels=4;else if(tp(Wt))Ge.element=Wt,Ge.width=Wt.naturalWidth,Ge.height=Wt.naturalHeight,Ge.channels=4;else if(pf(Wt))Ge.element=Wt,Ge.width=Wt.width,Ge.height=Wt.height,Ge.channels=4;else if(th(Wt))Ge.element=Wt,Ge.width=Wt.videoWidth,Ge.height=Wt.videoHeight,Ge.channels=4;else if(Vs(Wt)){var rt=Ge.width||Wt[0].length,Fe=Ge.height||Wt.length,kt=Ge.channels;xa(Wt[0][0])?kt=kt||Wt[0][0].length:kt=kt||1;for(var $t=me.shape(Wt),Wr=1,bn=0;bn<$t.length;++bn)Wr*=$t[bn];var Cn=Al(Ge,Wr);me.flatten(Wt,$t,"",Cn),Tl(Ge,Cn),Ge.alignment=1,Ge.width=rt,Ge.height=Fe,Ge.channels=kt,Ge.format=Ge.internalformat=di[kt],Ge.needsFree=!0}Ge.type===jl?_e(qe.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Ge.type===Ul&&_e(qe.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Tn(Ge,hr,Wt){var Wn=Ge.element,va=Ge.data,De=Ge.internalformat,Ee=Ge.format,it=Ge.type,Bt=Ge.width,ur=Ge.height;Sn(Ge),Wn?J.texImage2D(hr,Wt,Ee,Ee,it,Wn):Ge.compressed?J.compressedTexImage2D(hr,Wt,De,Bt,ur,0,va):Ge.needsCopy?(er(),J.copyTexImage2D(hr,Wt,Ee,Ge.xOffset,Ge.yOffset,Bt,ur,0)):J.texImage2D(hr,Wt,Ee,Bt,ur,0,Ee,it,va||null)}function ta(Ge,hr,Wt,Wn,va){var De=Ge.element,Ee=Ge.data,it=Ge.internalformat,Bt=Ge.format,ur=Ge.type,st=Ge.width,ut=Ge.height;Sn(Ge),De?J.texSubImage2D(hr,va,Wt,Wn,Bt,ur,De):Ge.compressed?J.compressedTexSubImage2D(hr,va,Wt,Wn,it,st,ut,Ee):Ge.needsCopy?(er(),J.copyTexSubImage2D(hr,va,Wt,Wn,Ge.xOffset,Ge.yOffset,st,ut)):J.texSubImage2D(hr,va,Wt,Wn,st,ut,Bt,ur,Ee)}var ji=[];function Fn(){return ji.pop()||new sn}function Dn(Ge){Ge.needsFree&&xn.freeType(Ge.data),sn.call(Ge),ji.push(Ge)}function Mi(){Rr.call(this),this.genMipmaps=!1,this.mipmapHint=Da,this.mipmask=0,this.images=Array(16)}function qi(Ge,hr,Wt){var Wn=Ge.images[0]=Fn();Ge.mipmask=1,Wn.width=Ge.width=hr,Wn.height=Ge.height=Wt,Wn.channels=Ge.channels=4}function Ea(Ge,hr){var Wt=null;if(Wu(hr))Wt=Ge.images[0]=Fn(),mr(Wt,Ge),In(Wt,hr),Ge.mipmask=1;else if(gn(Ge,hr),Array.isArray(hr.mipmap))for(var Wn=hr.mipmap,va=0;va<Wn.length;++va)Wt=Ge.images[va]=Fn(),mr(Wt,Ge),Wt.width>>=va,Wt.height>>=va,In(Wt,Wn[va]),Ge.mipmask|=1<<va;else Wt=Ge.images[0]=Fn(),mr(Wt,Ge),In(Wt,hr),Ge.mipmask=1;mr(Ge,Ge.images[0]),Ge.compressed&&(Ge.internalformat===af||Ge.internalformat===Mh||Ge.internalformat===of||Ge.internalformat===es)&&_e(Ge.width%4==0&&Ge.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Ao(Ge,hr){for(var Wt=Ge.images,Wn=0;Wn<Wt.length;++Wn){if(!Wt[Wn])return;Tn(Wt[Wn],hr,Wn)}}var ns=[];function ia(){var Ge=ns.pop()||new Mi;Rr.call(Ge),Ge.mipmask=0;for(var hr=0;hr<16;++hr)Ge.images[hr]=null;return Ge}function Zo(Ge){for(var hr=Ge.images,Wt=0;Wt<hr.length;++Wt)hr[Wt]&&Dn(hr[Wt]),hr[Wt]=null;ns.push(Ge)}function Io(){this.minFilter=wl,this.magFilter=wl,this.wrapS=Jf,this.wrapT=Jf,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Da}function Os(Ge,hr){if("min"in hr){var Wt=hr.min;_e.parameter(Wt,un),Ge.minFilter=un[Wt],io.indexOf(Ge.minFilter)>=0&&!("faces"in hr)&&(Ge.genMipmaps=!0)}if("mag"in hr){var Wn=hr.mag;_e.parameter(Wn,an),Ge.magFilter=an[Wn]}var va=Ge.wrapS,De=Ge.wrapT;if("wrap"in hr){var Ee=hr.wrap;typeof Ee=="string"?(_e.parameter(Ee,tn),va=De=tn[Ee]):Array.isArray(Ee)&&(_e.parameter(Ee[0],tn),_e.parameter(Ee[1],tn),va=tn[Ee[0]],De=tn[Ee[1]])}else{if("wrapS"in hr){var it=hr.wrapS;_e.parameter(it,tn),va=tn[it]}if("wrapT"in hr){var Bt=hr.wrapT;_e.parameter(Bt,tn),De=tn[Bt]}}if(Ge.wrapS=va,Ge.wrapT=De,"anisotropic"in hr){var ur=hr.anisotropic;_e(typeof ur=="number"&&ur>=1&&ur<=qe.maxAnisotropic,"aniso samples must be between 1 and "),Ge.anisotropic=hr.anisotropic}if("mipmap"in hr){var st=!1;switch(typeof hr.mipmap){case"string":_e.parameter(hr.mipmap,Hr,"invalid mipmap hint"),Ge.mipmapHint=Hr[hr.mipmap],Ge.genMipmaps=!0,st=!0;break;case"boolean":st=Ge.genMipmaps=hr.mipmap;break;case"object":_e(Array.isArray(hr.mipmap),"invalid mipmap type"),Ge.genMipmaps=!1,st=!0;break;default:_e.raise("invalid mipmap type")}st&&!("min"in hr)&&(Ge.minFilter=Vr)}}function Is(Ge,hr){J.texParameteri(hr,Pf,Ge.minFilter),J.texParameteri(hr,eh,Ge.magFilter),J.texParameteri(hr,Cl,Ge.wrapS),J.texParameteri(hr,Mf,Ge.wrapT),he.ext_texture_filter_anisotropic&&J.texParameteri(hr,lf,Ge.anisotropic),Ge.genMipmaps&&(J.hint(Hi,Ge.mipmapHint),J.generateMipmap(hr))}var lu=0,cu={},fu=qe.maxTextureUnits,Xo=Array(fu).map(function(){return null});function pa(Ge){Rr.call(this),this.mipmask=0,this.internalformat=fl,this.id=lu++,this.refCount=1,this.target=Ge,this.texture=J.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Io,cr.profile&&(this.stats={size:0})}function Ns(Ge){J.activeTexture($i),J.bindTexture(Ge.target,Ge.texture)}function Ga(){var Ge=Xo[0];Ge?J.bindTexture(Ge.target,Ge.texture):J.bindTexture(fs,null)}function Rs(Ge){var hr=Ge.texture;_e(hr,"must not double destroy texture");var Wt=Ge.unit,Wn=Ge.target;Wt>=0&&(J.activeTexture($i+Wt),J.bindTexture(Wn,null),Xo[Wt]=null),J.deleteTexture(hr),Ge.texture=null,Ge.params=null,Ge.pixels=null,Ge.refCount=0,delete cu[Ge.id],lr.textureCount--}Y(pa.prototype,{bind:function(){var hr=this;hr.bindCount+=1;var Wt=hr.unit;if(Wt<0){for(var Wn=0;Wn<fu;++Wn){var va=Xo[Wn];if(va){if(va.bindCount>0)continue;va.unit=-1}Xo[Wn]=hr,Wt=Wn;break}Wt>=fu&&_e.raise("insufficient number of texture units"),cr.profile&&lr.maxTextureUnits<Wt+1&&(lr.maxTextureUnits=Wt+1),hr.unit=Wt,J.activeTexture($i+Wt),J.bindTexture(hr.target,hr.texture)}return Wt},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Rs(this)}});function ki(Ge,hr){var Wt=new pa(fs);cu[Wt.id]=Wt,lr.textureCount++;function Wn(Ee,it){var Bt=Wt.texInfo;Io.call(Bt);var ur=ia();return typeof Ee=="number"?typeof it=="number"?qi(ur,Ee|0,it|0):qi(ur,Ee|0,Ee|0):Ee?(_e.type(Ee,"object","invalid arguments to regl.texture"),Os(Bt,Ee),Ea(ur,Ee)):qi(ur,1,1),Bt.genMipmaps&&(ur.mipmask=(ur.width<<1)-1),Wt.mipmask=ur.mipmask,mr(Wt,ur),_e.texture2D(Bt,ur,qe),Wt.internalformat=ur.internalformat,Wn.width=ur.width,Wn.height=ur.height,Ns(Wt),Ao(ur,fs),Is(Bt,fs),Ga(),Zo(ur),cr.profile&&(Wt.stats.size=ts(Wt.internalformat,Wt.type,ur.width,ur.height,Bt.genMipmaps,!1)),Wn.format=Qr[Wt.internalformat],Wn.type=zn[Wt.type],Wn.mag=Er[Bt.magFilter],Wn.min=qn[Bt.minFilter],Wn.wrapS=Bn[Bt.wrapS],Wn.wrapT=Bn[Bt.wrapT],Wn}function va(Ee,it,Bt,ur){_e(!!Ee,"must specify image data");var st=it|0,ut=Bt|0,bt=ur|0,Se=Fn();return mr(Se,Wt),Se.width=0,Se.height=0,In(Se,Ee),Se.width=Se.width||(Wt.width>>bt)-st,Se.height=Se.height||(Wt.height>>bt)-ut,_e(Wt.type===Se.type&&Wt.format===Se.format&&Wt.internalformat===Se.internalformat,"incompatible format for texture.subimage"),_e(st>=0&&ut>=0&&st+Se.width<=Wt.width&&ut+Se.height<=Wt.height,"texture.subimage write out of bounds"),_e(Wt.mipmask&1<<bt,"missing mipmap data"),_e(Se.data||Se.element||Se.needsCopy,"missing image data"),Ns(Wt),ta(Se,fs,st,ut,bt),Ga(),Dn(Se),Wn}function De(Ee,it){var Bt=Ee|0,ur=it|0||Bt;if(Bt===Wt.width&&ur===Wt.height)return Wn;Wn.width=Wt.width=Bt,Wn.height=Wt.height=ur,Ns(Wt);for(var st=0;Wt.mipmask>>st;++st){var ut=Bt>>st,bt=ur>>st;if(!ut||!bt)break;J.texImage2D(fs,st,Wt.format,ut,bt,0,Wt.format,Wt.type,null)}return Ga(),cr.profile&&(Wt.stats.size=ts(Wt.internalformat,Wt.type,Bt,ur,!1,!1)),Wn}return Wn(Ge,hr),Wn.subimage=va,Wn.resize=De,Wn._reglType="texture2d",Wn._texture=Wt,cr.profile&&(Wn.stats=Wt.stats),Wn.destroy=function(){Wt.decRef()},Wn}function ca(Ge,hr,Wt,Wn,va,De){var Ee=new pa(Af);cu[Ee.id]=Ee,lr.cubeCount++;var it=new Array(6);function Bt(ut,bt,Se,rt,Fe,kt){var $t,Wr=Ee.texInfo;for(Io.call(Wr),$t=0;$t<6;++$t)it[$t]=ia();if(typeof ut=="number"||!ut){var bn=ut|0||1;for($t=0;$t<6;++$t)qi(it[$t],bn,bn)}else if(typeof ut=="object")if(bt)Ea(it[0],ut),Ea(it[1],bt),Ea(it[2],Se),Ea(it[3],rt),Ea(it[4],Fe),Ea(it[5],kt);else if(Os(Wr,ut),gn(Ee,ut),"faces"in ut){var Cn=ut.faces;for(_e(Array.isArray(Cn)&&Cn.length===6,"cube faces must be a length 6 array"),$t=0;$t<6;++$t)_e(typeof Cn[$t]=="object"&&!!Cn[$t],"invalid input for cube map face"),mr(it[$t],Ee),Ea(it[$t],Cn[$t])}else for($t=0;$t<6;++$t)Ea(it[$t],ut);else _e.raise("invalid arguments to cube map");for(mr(Ee,it[0]),_e.optional(function(){qe.npotTextureCube||_e(Fl(Ee.width)&&Fl(Ee.height),"your browser does not support non power or two texture dimensions")}),Wr.genMipmaps?Ee.mipmask=(it[0].width<<1)-1:Ee.mipmask=it[0].mipmask,_e.textureCube(Ee,Wr,it,qe),Ee.internalformat=it[0].internalformat,Bt.width=it[0].width,Bt.height=it[0].height,Ns(Ee),$t=0;$t<6;++$t)Ao(it[$t],tl+$t);for(Is(Wr,Af),Ga(),cr.profile&&(Ee.stats.size=ts(Ee.internalformat,Ee.type,Bt.width,Bt.height,Wr.genMipmaps,!0)),Bt.format=Qr[Ee.internalformat],Bt.type=zn[Ee.type],Bt.mag=Er[Wr.magFilter],Bt.min=qn[Wr.minFilter],Bt.wrapS=Bn[Wr.wrapS],Bt.wrapT=Bn[Wr.wrapT],$t=0;$t<6;++$t)Zo(it[$t]);return Bt}function ur(ut,bt,Se,rt,Fe){_e(!!bt,"must specify image data"),_e(typeof ut=="number"&&ut===(ut|0)&&ut>=0&&ut<6,"invalid face");var kt=Se|0,$t=rt|0,Wr=Fe|0,bn=Fn();return mr(bn,Ee),bn.width=0,bn.height=0,In(bn,bt),bn.width=bn.width||(Ee.width>>Wr)-kt,bn.height=bn.height||(Ee.height>>Wr)-$t,_e(Ee.type===bn.type&&Ee.format===bn.format&&Ee.internalformat===bn.internalformat,"incompatible format for texture.subimage"),_e(kt>=0&&$t>=0&&kt+bn.width<=Ee.width&&$t+bn.height<=Ee.height,"texture.subimage write out of bounds"),_e(Ee.mipmask&1<<Wr,"missing mipmap data"),_e(bn.data||bn.element||bn.needsCopy,"missing image data"),Ns(Ee),ta(bn,tl+ut,kt,$t,Wr),Ga(),Dn(bn),Bt}function st(ut){var bt=ut|0;if(bt!==Ee.width){Bt.width=Ee.width=bt,Bt.height=Ee.height=bt,Ns(Ee);for(var Se=0;Se<6;++Se)for(var rt=0;Ee.mipmask>>rt;++rt)J.texImage2D(tl+Se,rt,Ee.format,bt>>rt,bt>>rt,0,Ee.format,Ee.type,null);return Ga(),cr.profile&&(Ee.stats.size=ts(Ee.internalformat,Ee.type,Bt.width,Bt.height,!1,!0)),Bt}}return Bt(Ge,hr,Wt,Wn,va,De),Bt.subimage=ur,Bt.resize=st,Bt._reglType="textureCube",Bt._texture=Ee,cr.profile&&(Bt.stats=Ee.stats),Bt.destroy=function(){Ee.decRef()},Bt}function yo(){for(var Ge=0;Ge<fu;++Ge)J.activeTexture($i+Ge),J.bindTexture(fs,null),Xo[Ge]=null;Ke(cu).forEach(Rs),lr.cubeCount=0,lr.textureCount=0}cr.profile&&(lr.getTotalTextureSize=function(){var Ge=0;return Object.keys(cu).forEach(function(hr){Ge+=cu[hr].stats.size}),Ge});function wu(){for(var Ge=0;Ge<fu;++Ge){var hr=Xo[Ge];hr&&(hr.bindCount=0,hr.unit=-1,Xo[Ge]=null)}Ke(cu).forEach(function(Wt){Wt.texture=J.createTexture(),J.bindTexture(Wt.target,Wt.texture);for(var Wn=0;Wn<32;++Wn)if((Wt.mipmask&1<<Wn)!=0)if(Wt.target===fs)J.texImage2D(fs,Wn,Wt.internalformat,Wt.width>>Wn,Wt.height>>Wn,0,Wt.internalformat,Wt.type,null);else for(var va=0;va<6;++va)J.texImage2D(tl+va,Wn,Wt.internalformat,Wt.width>>Wn,Wt.height>>Wn,0,Wt.internalformat,Wt.type,null);Is(Wt.texInfo,Wt.target)})}function hu(){for(var Ge=0;Ge<fu;++Ge){var hr=Xo[Ge];hr&&(hr.bindCount=0,hr.unit=-1,Xo[Ge]=null),J.activeTexture($i+Ge),J.bindTexture(fs,null),J.bindTexture(Af,null)}}return{create2D:ki,createCube:ca,clear:yo,getTexture:function(hr){return null},restore:wu,refresh:hu}}var Gs=36161,ps=32854,Of=32855,bi=36194,si=33189,Zc=36168,ko=34041,Zu=35907,ds=34836,nl=34842,Sc=34843,vs=[];vs[ps]=2,vs[Of]=2,vs[bi]=2,vs[si]=2,vs[Zc]=1,vs[ko]=4,vs[Zu]=4,vs[ds]=16,vs[nl]=8,vs[Sc]=6;function Qa(J,he,qe){return vs[J]*he*qe}var Hs=function(he,qe,er,wr,lr){var cr={rgba4:ps,rgb565:bi,"rgb5 a1":Of,depth:si,stencil:Zc,"depth stencil":ko};qe.ext_srgb&&(cr.srgba=Zu),qe.ext_color_buffer_half_float&&(cr.rgba16f=nl,cr.rgb16f=Sc),qe.webgl_color_buffer_float&&(cr.rgba32f=ds);var Hr=[];Object.keys(cr).forEach(function(Zr){var Vt=cr[Zr];Hr[Vt]=Zr});var tn=0,an={};function un(Zr){this.id=tn++,this.refCount=1,this.renderbuffer=Zr,this.format=ps,this.width=0,this.height=0,lr.profile&&(this.stats={size:0})}un.prototype.decRef=function(){--this.refCount<=0&&on(this)};function on(Zr){var Vt=Zr.renderbuffer;_e(Vt,"must not double destroy renderbuffer"),he.bindRenderbuffer(Gs,null),he.deleteRenderbuffer(Vt),Zr.renderbuffer=null,Zr.refCount=0,delete an[Zr.id],wr.renderbufferCount--}function kn(Zr,Vt){var tr=new un(he.createRenderbuffer());an[tr.id]=tr,wr.renderbufferCount++;function Qr(Er,qn){var Bn=0,pn=0,Rr=ps;if(typeof Er=="object"&&Er){var mr=Er;if("shape"in mr){var gn=mr.shape;_e(Array.isArray(gn)&&gn.length>=2,"invalid renderbuffer shape"),Bn=gn[0]|0,pn=gn[1]|0}else"radius"in mr&&(Bn=pn=mr.radius|0),"width"in mr&&(Bn=mr.width|0),"height"in mr&&(pn=mr.height|0);"format"in mr&&(_e.parameter(mr.format,cr,"invalid renderbuffer format"),Rr=cr[mr.format])}else typeof Er=="number"?(Bn=Er|0,typeof qn=="number"?pn=qn|0:pn=Bn):Er?_e.raise("invalid arguments to renderbuffer constructor"):Bn=pn=1;if(_e(Bn>0&&pn>0&&Bn<=er.maxRenderbufferSize&&pn<=er.maxRenderbufferSize,"invalid renderbuffer size"),!(Bn===tr.width&&pn===tr.height&&Rr===tr.format))return Qr.width=tr.width=Bn,Qr.height=tr.height=pn,tr.format=Rr,he.bindRenderbuffer(Gs,tr.renderbuffer),he.renderbufferStorage(Gs,Rr,Bn,pn),_e(he.getError()===0,"invalid render buffer format"),lr.profile&&(tr.stats.size=Qa(tr.format,tr.width,tr.height)),Qr.format=Hr[tr.format],Qr}function zn(Er,qn){var Bn=Er|0,pn=qn|0||Bn;return Bn===tr.width&&pn===tr.height||(_e(Bn>0&&pn>0&&Bn<=er.maxRenderbufferSize&&pn<=er.maxRenderbufferSize,"invalid renderbuffer size"),Qr.width=tr.width=Bn,Qr.height=tr.height=pn,he.bindRenderbuffer(Gs,tr.renderbuffer),he.renderbufferStorage(Gs,tr.format,Bn,pn),_e(he.getError()===0,"invalid render buffer format"),lr.profile&&(tr.stats.size=Qa(tr.format,tr.width,tr.height))),Qr}return Qr(Zr,Vt),Qr.resize=zn,Qr._reglType="renderbuffer",Qr._renderbuffer=tr,lr.profile&&(Qr.stats=tr.stats),Qr.destroy=function(){tr.decRef()},Qr}lr.profile&&(wr.getTotalRenderbufferSize=function(){var Zr=0;return Object.keys(an).forEach(function(Vt){Zr+=an[Vt].stats.size}),Zr});function En(){Ke(an).forEach(function(Zr){Zr.renderbuffer=he.createRenderbuffer(),he.bindRenderbuffer(Gs,Zr.renderbuffer),he.renderbufferStorage(Gs,Zr.format,Zr.width,Zr.height)}),he.bindRenderbuffer(Gs,null)}return{create:kn,clear:function(){Ke(an).forEach(on)},restore:En}},Cc=36160,Wl=36161,dl=3553,Ou=34069,Iu=36064,Pe=36096,xu=36128,df=33306,su=36053,Fa=36054,rp=36055,Zl=36057,If=36061,Xl=36193,wc=5121,Ml=5126,Ac=6407,Pl=6408,bu=6402,Xu=[Ac,Pl],Ru=[];Ru[Pl]=4,Ru[Ac]=3;var Rf=[];Rf[wc]=1,Rf[Ml]=4,Rf[Xl]=2;var Oh=32854,d=32855,f=36194,l=33189,m=36168,C=34041,P=35907,D=34836,N=34842,K=34843,re=[Oh,d,f,P,N,K,D],ge={};ge[su]="complete",ge[Fa]="incomplete attachment",ge[Zl]="incomplete dimensions",ge[rp]="incomplete, missing attachment",ge[If]="unsupported";function ye(J,he,qe,er,wr,lr){var cr={cur:null,next:null,dirty:!1,setFBO:null},Hr=["rgba"],tn=["rgba4","rgb565","rgb5 a1"];he.ext_srgb&&tn.push("srgba"),he.ext_color_buffer_half_float&&tn.push("rgba16f","rgb16f"),he.webgl_color_buffer_float&&tn.push("rgba32f");var an=["uint8"];he.oes_texture_half_float&&an.push("half float","float16"),he.oes_texture_float&&an.push("float","float32");function un(sn,In,Tn){this.target=sn,this.texture=In,this.renderbuffer=Tn;var ta=0,ji=0;In?(ta=In.width,ji=In.height):Tn&&(ta=Tn.width,ji=Tn.height),this.width=ta,this.height=ji}function on(sn){sn&&(sn.texture&&sn.texture._texture.decRef(),sn.renderbuffer&&sn.renderbuffer._renderbuffer.decRef())}function kn(sn,In,Tn){if(!!sn)if(sn.texture){var ta=sn.texture._texture,ji=Math.max(1,ta.width),Fn=Math.max(1,ta.height);_e(ji===In&&Fn===Tn,"inconsistent width/height for supplied texture"),ta.refCount+=1}else{var Dn=sn.renderbuffer._renderbuffer;_e(Dn.width===In&&Dn.height===Tn,"inconsistent width/height for renderbuffer"),Dn.refCount+=1}}function En(sn,In){In&&(In.texture?J.framebufferTexture2D(Cc,sn,In.target,In.texture._texture.texture,0):J.framebufferRenderbuffer(Cc,sn,Wl,In.renderbuffer._renderbuffer.renderbuffer))}function Zr(sn){var In=dl,Tn=null,ta=null,ji=sn;typeof sn=="object"&&(ji=sn.data,"target"in sn&&(In=sn.target|0)),_e.type(ji,"function","invalid attachment data");var Fn=ji._reglType;return Fn==="texture2d"?(Tn=ji,_e(In===dl)):Fn==="textureCube"?(Tn=ji,_e(In>=Ou&&In<Ou+6,"invalid cube map target")):Fn==="renderbuffer"?(ta=ji,In=Wl):_e.raise("invalid regl object for attachment"),new un(In,Tn,ta)}function Vt(sn,In,Tn,ta,ji){if(Tn){var Fn=er.create2D({width:sn,height:In,format:ta,type:ji});return Fn._texture.refCount=0,new un(dl,Fn,null)}else{var Dn=wr.create({width:sn,height:In,format:ta});return Dn._renderbuffer.refCount=0,new un(Wl,null,Dn)}}function tr(sn){return sn&&(sn.texture||sn.renderbuffer)}function Qr(sn,In,Tn){sn&&(sn.texture?sn.texture.resize(In,Tn):sn.renderbuffer&&sn.renderbuffer.resize(In,Tn),sn.width=In,sn.height=Tn)}var zn=0,Er={};function qn(){this.id=zn++,Er[this.id]=this,this.framebuffer=J.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Bn(sn){sn.colorAttachments.forEach(on),on(sn.depthAttachment),on(sn.stencilAttachment),on(sn.depthStencilAttachment)}function pn(sn){var In=sn.framebuffer;_e(In,"must not double destroy framebuffer"),J.deleteFramebuffer(In),sn.framebuffer=null,lr.framebufferCount--,delete Er[sn.id]}function Rr(sn){var In;J.bindFramebuffer(Cc,sn.framebuffer);var Tn=sn.colorAttachments;for(In=0;In<Tn.length;++In)En(Iu+In,Tn[In]);for(In=Tn.length;In<qe.maxColorAttachments;++In)J.framebufferTexture2D(Cc,Iu+In,dl,null,0);J.framebufferTexture2D(Cc,df,dl,null,0),J.framebufferTexture2D(Cc,Pe,dl,null,0),J.framebufferTexture2D(Cc,xu,dl,null,0),En(Pe,sn.depthAttachment),En(xu,sn.stencilAttachment),En(df,sn.depthStencilAttachment);var ta=J.checkFramebufferStatus(Cc);!J.isContextLost()&&ta!==su&&_e.raise("framebuffer configuration not supported, status = "+ge[ta]),J.bindFramebuffer(Cc,cr.next?cr.next.framebuffer:null),cr.cur=cr.next,J.getError()}function mr(sn,In){var Tn=new qn;lr.framebufferCount++;function ta(Fn,Dn){var Mi;_e(cr.next!==Tn,"can not update framebuffer which is currently in use");var qi=0,Ea=0,Ao=!0,ns=!0,ia=null,Zo=!0,Io="rgba",Os="uint8",Is=1,lu=null,cu=null,fu=null,Xo=!1;if(typeof Fn=="number")qi=Fn|0,Ea=Dn|0||qi;else if(!Fn)qi=Ea=1;else{_e.type(Fn,"object","invalid arguments for framebuffer");var pa=Fn;if("shape"in pa){var Ns=pa.shape;_e(Array.isArray(Ns)&&Ns.length>=2,"invalid shape for framebuffer"),qi=Ns[0],Ea=Ns[1]}else"radius"in pa&&(qi=Ea=pa.radius),"width"in pa&&(qi=pa.width),"height"in pa&&(Ea=pa.height);("color"in pa||"colors"in pa)&&(ia=pa.color||pa.colors,Array.isArray(ia)&&_e(ia.length===1||he.webgl_draw_buffers,"multiple render targets not supported")),ia||("colorCount"in pa&&(Is=pa.colorCount|0,_e(Is>0,"invalid color buffer count")),"colorTexture"in pa&&(Zo=!!pa.colorTexture,Io="rgba4"),"colorType"in pa&&(Os=pa.colorType,Zo?(_e(he.oes_texture_float||!(Os==="float"||Os==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),_e(he.oes_texture_half_float||!(Os==="half float"||Os==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Os==="half float"||Os==="float16"?(_e(he.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Io="rgba16f"):(Os==="float"||Os==="float32")&&(_e(he.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Io="rgba32f"),_e.oneOf(Os,an,"invalid color type")),"colorFormat"in pa&&(Io=pa.colorFormat,Hr.indexOf(Io)>=0?Zo=!0:tn.indexOf(Io)>=0?Zo=!1:_e.optional(function(){Zo?_e.oneOf(pa.colorFormat,Hr,"invalid color format for texture"):_e.oneOf(pa.colorFormat,tn,"invalid color format for renderbuffer")}))),("depthTexture"in pa||"depthStencilTexture"in pa)&&(Xo=!!(pa.depthTexture||pa.depthStencilTexture),_e(!Xo||he.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in pa&&(typeof pa.depth=="boolean"?Ao=pa.depth:(lu=pa.depth,ns=!1)),"stencil"in pa&&(typeof pa.stencil=="boolean"?ns=pa.stencil:(cu=pa.stencil,Ao=!1)),"depthStencil"in pa&&(typeof pa.depthStencil=="boolean"?Ao=ns=pa.depthStencil:(fu=pa.depthStencil,Ao=!1,ns=!1))}var Ga=null,Rs=null,ki=null,ca=null;if(Array.isArray(ia))Ga=ia.map(Zr);else if(ia)Ga=[Zr(ia)];else for(Ga=new Array(Is),Mi=0;Mi<Is;++Mi)Ga[Mi]=Vt(qi,Ea,Zo,Io,Os);_e(he.webgl_draw_buffers||Ga.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),_e(Ga.length<=qe.maxColorAttachments,"too many color attachments, not supported"),qi=qi||Ga[0].width,Ea=Ea||Ga[0].height,lu?Rs=Zr(lu):Ao&&!ns&&(Rs=Vt(qi,Ea,Xo,"depth","uint32")),cu?ki=Zr(cu):ns&&!Ao&&(ki=Vt(qi,Ea,!1,"stencil","uint8")),fu?ca=Zr(fu):!lu&&!cu&&ns&&Ao&&(ca=Vt(qi,Ea,Xo,"depth stencil","depth stencil")),_e(!!lu+!!cu+!!fu<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var yo=null;for(Mi=0;Mi<Ga.length;++Mi)if(kn(Ga[Mi],qi,Ea),_e(!Ga[Mi]||Ga[Mi].texture&&Xu.indexOf(Ga[Mi].texture._texture.format)>=0||Ga[Mi].renderbuffer&&re.indexOf(Ga[Mi].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Mi+" is invalid"),Ga[Mi]&&Ga[Mi].texture){var wu=Ru[Ga[Mi].texture._texture.format]*Rf[Ga[Mi].texture._texture.type];yo===null?yo=wu:_e(yo===wu,"all color attachments much have the same number of bits per pixel.")}return kn(Rs,qi,Ea),_e(!Rs||Rs.texture&&Rs.texture._texture.format===bu||Rs.renderbuffer&&Rs.renderbuffer._renderbuffer.format===l,"invalid depth attachment for framebuffer object"),kn(ki,qi,Ea),_e(!ki||ki.renderbuffer&&ki.renderbuffer._renderbuffer.format===m,"invalid stencil attachment for framebuffer object"),kn(ca,qi,Ea),_e(!ca||ca.texture&&ca.texture._texture.format===C||ca.renderbuffer&&ca.renderbuffer._renderbuffer.format===C,"invalid depth-stencil attachment for framebuffer object"),Bn(Tn),Tn.width=qi,Tn.height=Ea,Tn.colorAttachments=Ga,Tn.depthAttachment=Rs,Tn.stencilAttachment=ki,Tn.depthStencilAttachment=ca,ta.color=Ga.map(tr),ta.depth=tr(Rs),ta.stencil=tr(ki),ta.depthStencil=tr(ca),ta.width=Tn.width,ta.height=Tn.height,Rr(Tn),ta}function ji(Fn,Dn){_e(cr.next!==Tn,"can not resize a framebuffer which is currently in use");var Mi=Math.max(Fn|0,1),qi=Math.max(Dn|0||Mi,1);if(Mi===Tn.width&&qi===Tn.height)return ta;for(var Ea=Tn.colorAttachments,Ao=0;Ao<Ea.length;++Ao)Qr(Ea[Ao],Mi,qi);return Qr(Tn.depthAttachment,Mi,qi),Qr(Tn.stencilAttachment,Mi,qi),Qr(Tn.depthStencilAttachment,Mi,qi),Tn.width=ta.width=Mi,Tn.height=ta.height=qi,Rr(Tn),ta}return ta(sn,In),Y(ta,{resize:ji,_reglType:"framebuffer",_framebuffer:Tn,destroy:function(){pn(Tn),Bn(Tn)},use:function(Dn){cr.setFBO({framebuffer:ta},Dn)}})}function gn(sn){var In=Array(6);function Tn(ji){var Fn;_e(In.indexOf(cr.next)<0,"can not update framebuffer which is currently in use");var Dn={color:null},Mi=0,qi=null,Ea="rgba",Ao="uint8",ns=1;if(typeof ji=="number")Mi=ji|0;else if(!ji)Mi=1;else{_e.type(ji,"object","invalid arguments for framebuffer");var ia=ji;if("shape"in ia){var Zo=ia.shape;_e(Array.isArray(Zo)&&Zo.length>=2,"invalid shape for framebuffer"),_e(Zo[0]===Zo[1],"cube framebuffer must be square"),Mi=Zo[0]}else"radius"in ia&&(Mi=ia.radius|0),"width"in ia?(Mi=ia.width|0,"height"in ia&&_e(ia.height===Mi,"must be square")):"height"in ia&&(Mi=ia.height|0);("color"in ia||"colors"in ia)&&(qi=ia.color||ia.colors,Array.isArray(qi)&&_e(qi.length===1||he.webgl_draw_buffers,"multiple render targets not supported")),qi||("colorCount"in ia&&(ns=ia.colorCount|0,_e(ns>0,"invalid color buffer count")),"colorType"in ia&&(_e.oneOf(ia.colorType,an,"invalid color type"),Ao=ia.colorType),"colorFormat"in ia&&(Ea=ia.colorFormat,_e.oneOf(ia.colorFormat,Hr,"invalid color format for texture"))),"depth"in ia&&(Dn.depth=ia.depth),"stencil"in ia&&(Dn.stencil=ia.stencil),"depthStencil"in ia&&(Dn.depthStencil=ia.depthStencil)}var Io;if(qi)if(Array.isArray(qi))for(Io=[],Fn=0;Fn<qi.length;++Fn)Io[Fn]=qi[Fn];else Io=[qi];else{Io=Array(ns);var Os={radius:Mi,format:Ea,type:Ao};for(Fn=0;Fn<ns;++Fn)Io[Fn]=er.createCube(Os)}for(Dn.color=Array(Io.length),Fn=0;Fn<Io.length;++Fn){var Is=Io[Fn];_e(typeof Is=="function"&&Is._reglType==="textureCube","invalid cube map"),Mi=Mi||Is.width,_e(Is.width===Mi&&Is.height===Mi,"invalid cube map shape"),Dn.color[Fn]={target:Ou,data:Io[Fn]}}for(Fn=0;Fn<6;++Fn){for(var lu=0;lu<Io.length;++lu)Dn.color[lu].target=Ou+Fn;Fn>0&&(Dn.depth=In[0].depth,Dn.stencil=In[0].stencil,Dn.depthStencil=In[0].depthStencil),In[Fn]?In[Fn](Dn):In[Fn]=mr(Dn)}return Y(Tn,{width:Mi,height:Mi,color:Io})}function ta(ji){var Fn,Dn=ji|0;if(_e(Dn>0&&Dn<=qe.maxCubeMapSize,"invalid radius for cube fbo"),Dn===Tn.width)return Tn;var Mi=Tn.color;for(Fn=0;Fn<Mi.length;++Fn)Mi[Fn].resize(Dn);for(Fn=0;Fn<6;++Fn)In[Fn].resize(Dn);return Tn.width=Tn.height=Dn,Tn}return Tn(sn),Y(Tn,{faces:In,resize:ta,_reglType:"framebufferCube",destroy:function(){In.forEach(function(Fn){Fn.destroy()})}})}function Sn(){cr.cur=null,cr.next=null,cr.dirty=!0,Ke(Er).forEach(function(sn){sn.framebuffer=J.createFramebuffer(),Rr(sn)})}return Y(cr,{getFramebuffer:function(In){if(typeof In=="function"&&In._reglType==="framebuffer"){var Tn=In._framebuffer;if(Tn instanceof qn)return Tn}return null},create:mr,createCube:gn,clear:function(){Ke(Er).forEach(pn)},restore:Sn})}var we=5126,We=34962,Ue=34963,tt=["attributes","elements","offset","count","primitive","instances"];function Ze(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=we,this.offset=0,this.stride=0,this.divisor=0}function $e(J,he,qe,er,wr,lr,cr){for(var Hr=qe.maxAttributes,tn=new Array(Hr),an=0;an<Hr;++an)tn[an]=new Ze;var un=0,on={},kn={Record:Ze,scope:{},state:tn,currentVAO:null,targetVAO:null,restore:Zr()?Bn:function(){},createVAO:pn,getVAO:tr,destroyBuffer:En,setVAO:Zr()?Qr:zn,clear:Zr()?Er:function(){}};function En(Rr){for(var mr=0;mr<tn.length;++mr){var gn=tn[mr];gn.buffer===Rr&&(J.disableVertexAttribArray(mr),gn.buffer=null)}}function Zr(){return he.oes_vertex_array_object}function Vt(){return he.angle_instanced_arrays}function tr(Rr){return typeof Rr=="function"&&Rr._vao?Rr._vao:null}function Qr(Rr){if(Rr!==kn.currentVAO){var mr=Zr();Rr?mr.bindVertexArrayOES(Rr.vao):mr.bindVertexArrayOES(null),kn.currentVAO=Rr}}function zn(Rr){if(Rr!==kn.currentVAO){if(Rr)Rr.bindAttrs();else{for(var mr=Vt(),gn=0;gn<tn.length;++gn){var Sn=tn[gn];Sn.buffer?(J.enableVertexAttribArray(gn),Sn.buffer.bind(),J.vertexAttribPointer(gn,Sn.size,Sn.type,Sn.normalized,Sn.stride,Sn.offfset),mr&&Sn.divisor&&mr.vertexAttribDivisorANGLE(gn,Sn.divisor)):(J.disableVertexAttribArray(gn),J.vertexAttrib4f(gn,Sn.x,Sn.y,Sn.z,Sn.w))}cr.elements?J.bindBuffer(Ue,cr.elements.buffer.buffer):J.bindBuffer(Ue,null)}kn.currentVAO=Rr}}function Er(){Ke(on).forEach(function(Rr){Rr.destroy()})}function qn(){this.id=++un,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var Rr=Zr();Rr?this.vao=Rr.createVertexArrayOES():this.vao=null,on[this.id]=this,this.buffers=[]}qn.prototype.bindAttrs=function(){for(var Rr=Vt(),mr=this.attributes,gn=0;gn<mr.length;++gn){var Sn=mr[gn];Sn.buffer?(J.enableVertexAttribArray(gn),J.bindBuffer(We,Sn.buffer.buffer),J.vertexAttribPointer(gn,Sn.size,Sn.type,Sn.normalized,Sn.stride,Sn.offset),Rr&&Sn.divisor&&Rr.vertexAttribDivisorANGLE(gn,Sn.divisor)):(J.disableVertexAttribArray(gn),J.vertexAttrib4f(gn,Sn.x,Sn.y,Sn.z,Sn.w))}for(var sn=mr.length;sn<Hr;++sn)J.disableVertexAttribArray(sn);var In=lr.getElements(this.elements);In?J.bindBuffer(Ue,In.buffer.buffer):J.bindBuffer(Ue,null)},qn.prototype.refresh=function(){var Rr=Zr();Rr&&(Rr.bindVertexArrayOES(this.vao),this.bindAttrs(),kn.currentVAO=null,Rr.bindVertexArrayOES(null))},qn.prototype.destroy=function(){if(this.vao){var Rr=Zr();this===kn.currentVAO&&(kn.currentVAO=null,Rr.bindVertexArrayOES(null)),Rr.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),on[this.id]&&(delete on[this.id],er.vaoCount-=1)};function Bn(){var Rr=Zr();Rr&&Ke(on).forEach(function(mr){mr.refresh()})}function pn(Rr){var mr=new qn;er.vaoCount+=1;function gn(Sn){var sn;if(Array.isArray(Sn))sn=Sn,mr.elements&&mr.ownsElements&&mr.elements.destroy(),mr.elements=null,mr.ownsElements=!1,mr.offset=0,mr.count=0,mr.instances=-1,mr.primitive=4;else{if(_e(typeof Sn=="object","invalid arguments for create vao"),_e("attributes"in Sn,"must specify attributes for vao"),Sn.elements){var In=Sn.elements;mr.ownsElements?typeof In=="function"&&In._reglType==="elements"?(mr.elements.destroy(),mr.ownsElements=!1):(mr.elements(In),mr.ownsElements=!1):lr.getElements(Sn.elements)?(mr.elements=Sn.elements,mr.ownsElements=!1):(mr.elements=lr.create(Sn.elements),mr.ownsElements=!0)}else mr.elements=null,mr.ownsElements=!1;sn=Sn.attributes,mr.offset=0,mr.count=-1,mr.instances=-1,mr.primitive=4,mr.elements&&(mr.count=mr.elements._elements.vertCount,mr.primitive=mr.elements._elements.primType),"offset"in Sn&&(mr.offset=Sn.offset|0),"count"in Sn&&(mr.count=Sn.count|0),"instances"in Sn&&(mr.instances=Sn.instances|0),"primitive"in Sn&&(_e(Sn.primitive in zr,"bad primitive type: "+Sn.primitive),mr.primitive=zr[Sn.primitive]),_e.optional(function(){for(var Ao=Object.keys(Sn),ns=0;ns<Ao.length;++ns)_e(tt.indexOf(Ao[ns])>=0,'invalid option for vao: "'+Ao[ns]+'" valid options are '+tt)}),_e(Array.isArray(sn),"attributes must be an array")}_e(sn.length<Hr,"too many attributes"),_e(sn.length>0,"must specify at least one attribute");var Tn={},ta=mr.attributes;ta.length=sn.length;for(var ji=0;ji<sn.length;++ji){var Fn=sn[ji],Dn=ta[ji]=new Ze,Mi=Fn.data||Fn;if(Array.isArray(Mi)||Z(Mi)||$o(Mi)){var qi;mr.buffers[ji]&&(qi=mr.buffers[ji],Z(Mi)&&qi._buffer.byteLength>=Mi.byteLength?qi.subdata(Mi):(qi.destroy(),mr.buffers[ji]=null)),mr.buffers[ji]||(qi=mr.buffers[ji]=wr.create(Fn,We,!1,!0)),Dn.buffer=wr.getBuffer(qi),Dn.size=Dn.buffer.dimension|0,Dn.normalized=!1,Dn.type=Dn.buffer.dtype,Dn.offset=0,Dn.stride=0,Dn.divisor=0,Dn.state=1,Tn[ji]=1}else wr.getBuffer(Fn)?(Dn.buffer=wr.getBuffer(Fn),Dn.size=Dn.buffer.dimension|0,Dn.normalized=!1,Dn.type=Dn.buffer.dtype,Dn.offset=0,Dn.stride=0,Dn.divisor=0,Dn.state=1):wr.getBuffer(Fn.buffer)?(Dn.buffer=wr.getBuffer(Fn.buffer),Dn.size=(+Fn.size||Dn.buffer.dimension)|0,Dn.normalized=!!Fn.normalized||!1,"type"in Fn?(_e.parameter(Fn.type,js,"invalid buffer type"),Dn.type=js[Fn.type]):Dn.type=Dn.buffer.dtype,Dn.offset=(Fn.offset||0)|0,Dn.stride=(Fn.stride||0)|0,Dn.divisor=(Fn.divisor||0)|0,Dn.state=1,_e(Dn.size>=1&&Dn.size<=4,"size must be between 1 and 4"),_e(Dn.offset>=0,"invalid offset"),_e(Dn.stride>=0&&Dn.stride<=255,"stride must be between 0 and 255"),_e(Dn.divisor>=0,"divisor must be positive"),_e(!Dn.divisor||!!he.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Fn?(_e(ji>0,"first attribute must not be a constant"),Dn.x=+Fn.x||0,Dn.y=+Fn.y||0,Dn.z=+Fn.z||0,Dn.w=+Fn.w||0,Dn.state=2):_e(!1,"invalid attribute spec for location "+ji)}for(var Ea=0;Ea<mr.buffers.length;++Ea)!Tn[Ea]&&mr.buffers[Ea]&&(mr.buffers[Ea].destroy(),mr.buffers[Ea]=null);return mr.refresh(),gn}return gn.destroy=function(){for(var Sn=0;Sn<mr.buffers.length;++Sn)mr.buffers[Sn]&&mr.buffers[Sn].destroy();mr.buffers.length=0,mr.ownsElements&&(mr.elements.destroy(),mr.elements=null,mr.ownsElements=!1),mr.destroy()},gn._vao=mr,gn._reglType="vao",gn(Rr)}return kn}var Ot=35632,Mt=35633,Sr=35718,qt=35721;function gr(J,he,qe,er){var wr={},lr={};function cr(Vt,tr,Qr,zn){this.name=Vt,this.id=tr,this.location=Qr,this.info=zn}function Hr(Vt,tr){for(var Qr=0;Qr<Vt.length;++Qr)if(Vt[Qr].id===tr.id){Vt[Qr].location=tr.location;return}Vt.push(tr)}function tn(Vt,tr,Qr){var zn=Vt===Ot?wr:lr,Er=zn[tr];if(!Er){var qn=he.str(tr);Er=J.createShader(Vt),J.shaderSource(Er,qn),J.compileShader(Er),_e.shaderError(J,Er,qn,Vt,Qr),zn[tr]=Er}return Er}var an={},un=[],on=0;function kn(Vt,tr){this.id=on++,this.fragId=Vt,this.vertId=tr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,er.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function En(Vt,tr,Qr){var zn,Er,qn=tn(Ot,Vt.fragId),Bn=tn(Mt,Vt.vertId),pn=Vt.program=J.createProgram();if(J.attachShader(pn,qn),J.attachShader(pn,Bn),Qr)for(zn=0;zn<Qr.length;++zn){var Rr=Qr[zn];J.bindAttribLocation(pn,Rr[0],Rr[1])}J.linkProgram(pn),_e.linkError(J,pn,he.str(Vt.fragId),he.str(Vt.vertId),tr);var mr=J.getProgramParameter(pn,Sr);er.profile&&(Vt.stats.uniformsCount=mr);var gn=Vt.uniforms;for(zn=0;zn<mr;++zn)if(Er=J.getActiveUniform(pn,zn),Er)if(Er.size>1)for(var Sn=0;Sn<Er.size;++Sn){var sn=Er.name.replace("[0]","["+Sn+"]");Hr(gn,new cr(sn,he.id(sn),J.getUniformLocation(pn,sn),Er))}else Hr(gn,new cr(Er.name,he.id(Er.name),J.getUniformLocation(pn,Er.name),Er));var In=J.getProgramParameter(pn,qt);er.profile&&(Vt.stats.attributesCount=In);var Tn=Vt.attributes;for(zn=0;zn<In;++zn)Er=J.getActiveAttrib(pn,zn),Er&&Hr(Tn,new cr(Er.name,he.id(Er.name),J.getAttribLocation(pn,Er.name),Er))}er.profile&&(qe.getMaxUniformsCount=function(){var Vt=0;return un.forEach(function(tr){tr.stats.uniformsCount>Vt&&(Vt=tr.stats.uniformsCount)}),Vt},qe.getMaxAttributesCount=function(){var Vt=0;return un.forEach(function(tr){tr.stats.attributesCount>Vt&&(Vt=tr.stats.attributesCount)}),Vt});function Zr(){wr={},lr={};for(var Vt=0;Vt<un.length;++Vt)En(un[Vt],null,un[Vt].attributes.map(function(tr){return[tr.location,tr.name]}))}return{clear:function(){var tr=J.deleteShader.bind(J);Ke(wr).forEach(tr),wr={},Ke(lr).forEach(tr),lr={},un.forEach(function(Qr){J.deleteProgram(Qr.program)}),un.length=0,an={},qe.shaderCount=0},program:function(tr,Qr,zn,Er){_e.command(tr>=0,"missing vertex shader",zn),_e.command(Qr>=0,"missing fragment shader",zn);var qn=an[Qr];qn||(qn=an[Qr]={});var Bn=qn[tr];if(Bn&&(Bn.refCount++,!Er))return Bn;var pn=new kn(Qr,tr);return qe.shaderCount++,En(pn,zn,Er),Bn||(qn[tr]=pn),un.push(pn),Y(pn,{destroy:function(){if(pn.refCount--,pn.refCount<=0){J.deleteProgram(pn.program);var mr=un.indexOf(pn);un.splice(mr,1),qe.shaderCount--}qn[pn.vertId].refCount<=0&&(J.deleteShader(lr[pn.vertId]),delete lr[pn.vertId],delete an[pn.fragId][pn.vertId]),Object.keys(an[pn.fragId]).length||(J.deleteShader(wr[pn.fragId]),delete wr[pn.fragId],delete an[pn.fragId])}})},restore:Zr,shader:tn,frag:-1,vert:-1}}var Tr=6408,Dr=5121,nn=3333,An=5126;function Vn(J,he,qe,er,wr,lr,cr){function Hr(un){var on;he.next===null?(_e(wr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),on=Dr):(_e(he.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),on=he.next.colorAttachments[0].texture._texture.type,_e.optional(function(){lr.oes_texture_float?(_e(on===Dr||on===An,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),on===An&&_e(cr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):_e(on===Dr,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var kn=0,En=0,Zr=er.framebufferWidth,Vt=er.framebufferHeight,tr=null;Z(un)?tr=un:un&&(_e.type(un,"object","invalid arguments to regl.read()"),kn=un.x|0,En=un.y|0,_e(kn>=0&&kn<er.framebufferWidth,"invalid x offset for regl.read"),_e(En>=0&&En<er.framebufferHeight,"invalid y offset for regl.read"),Zr=(un.width||er.framebufferWidth-kn)|0,Vt=(un.height||er.framebufferHeight-En)|0,tr=un.data||null),tr&&(on===Dr?_e(tr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):on===An&&_e(tr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),_e(Zr>0&&Zr+kn<=er.framebufferWidth,"invalid width for read pixels"),_e(Vt>0&&Vt+En<=er.framebufferHeight,"invalid height for read pixels"),qe();var Qr=Zr*Vt*4;return tr||(on===Dr?tr=new Uint8Array(Qr):on===An&&(tr=tr||new Float32Array(Qr))),_e.isTypedArray(tr,"data buffer for regl.read() must be a typedarray"),_e(tr.byteLength>=Qr,"data buffer for regl.read() too small"),J.pixelStorei(nn,4),J.readPixels(kn,En,Zr,Vt,Tr,on,tr),tr}function tn(un){var on;return he.setFBO({framebuffer:un.framebuffer},function(){on=Hr(un)}),on}function an(un){return!un||!("framebuffer"in un)?Hr(un):tn(un)}return an}function mi(J){return Array.prototype.slice.call(J)}function yi(J){return mi(J).join("")}function Ni(){var J=0,he=[],qe=[];function er(on){for(var kn=0;kn<qe.length;++kn)if(qe[kn]===on)return he[kn];var En="g"+J++;return he.push(En),qe.push(on),En}function wr(){var on=[];function kn(){on.push.apply(on,mi(arguments))}var En=[];function Zr(){var Vt="v"+J++;return En.push(Vt),arguments.length>0&&(on.push(Vt,"="),on.push.apply(on,mi(arguments)),on.push(";")),Vt}return Y(kn,{def:Zr,toString:function(){return yi([En.length>0?"var "+En.join(",")+";":"",yi(on)])}})}function lr(){var on=wr(),kn=wr(),En=on.toString,Zr=kn.toString;function Vt(tr,Qr){kn(tr,Qr,"=",on.def(tr,Qr),";")}return Y(function(){on.apply(on,mi(arguments))},{def:on.def,entry:on,exit:kn,save:Vt,set:function(Qr,zn,Er){Vt(Qr,zn),on(Qr,zn,"=",Er,";")},toString:function(){return En()+Zr()}})}function cr(){var on=yi(arguments),kn=lr(),En=lr(),Zr=kn.toString,Vt=En.toString;return Y(kn,{then:function(){return kn.apply(kn,mi(arguments)),this},else:function(){return En.apply(En,mi(arguments)),this},toString:function(){var Qr=Vt();return Qr&&(Qr="else{"+Qr+"}"),yi(["if(",on,"){",Zr(),"}",Qr])}})}var Hr=wr(),tn={};function an(on,kn){var En=[];function Zr(){var Er="a"+En.length;return En.push(Er),Er}kn=kn||0;for(var Vt=0;Vt<kn;++Vt)Zr();var tr=lr(),Qr=tr.toString,zn=tn[on]=Y(tr,{arg:Zr,toString:function(){return yi(["function(",En.join(),"){",Qr(),"}"])}});return zn}function un(){var on=['"use strict";',Hr,"return {"];Object.keys(tn).forEach(function(Vt){on.push('"',Vt,'":',tn[Vt].toString(),",")}),on.push("}");var kn=yi(on).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),En=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Zr=En?j.Function.apply(null,he.concat(kn)):Function.apply(null,he.concat(kn));return Zr.apply(null,qe)}return{global:Hr,link:er,block:wr,proc:an,scope:lr,cond:cr,compile:un}}var Ii="xyzw".split(""),$n=5121,zi=1,Wi=2,ui=0,ea=1,Ai=2,na=3,wa=4,rs=5,ka=6,ms="dither",Oo="blend.enable",Ja="blend.color",Eu="blend.equation",ho="blend.func",Yu="depth.enable",Su="depth.func",go="depth.range",Ws="depth.mask",Es="colorMask",Lu="cull.enable",oc="cull.face",sc="frontFace",Tc="lineWidth",ku="polygonOffset.enable",Xc="polygonOffset.offset",Ol="sample.alpha",Ps="sample.enable",Ku="sample.coverage",rh="stencil.enable",uc="stencil.mask",Ss="stencil.func",Cu="stencil.opFront",Fs="stencil.opBack",Du="scissor.enable",Bs="scissor.box",Fu="viewport",vf="profile",Yc="framebuffer",Kc="vert",Yl="frag",lc="elements",vl="primitive",Zs="count",Xs="offset",np="instances",nh="vao",$p="Width",Tp="Height",Ih=Yc+$p,Lf=Yc+Tp,mf=Fu+$p,qp=Fu+Tp,ip="drawingBuffer",ap=ip+$p,ba=ip+Tp,Rh=[ho,Eu,Ss,Cu,Fs,Ku,Fu,Bs,Xc],ih=34962,ah=34963,wd=35632,Ad=35633,Qp=3553,cc=34067,sv=2884,Lh=3042,Jp=3024,oh=2960,uv=2929,Cr=3089,Mc=32823,Mp=32926,sr=32928,gf=5126,yf=35664,kf=35665,sh=35666,$c=5124,Df=35667,Il=35668,Ff=35669,Rl=35670,op=35671,Bf=35672,uh=35673,Nf=35674,zf=35675,il=35676,kh=35678,lh=35680,Pp=4,Uf=1028,_f=1029,uu=2304,fc=2305,lv=32775,Td=32776,sp=519,Kl=7680,Op=0,jf=1,ed=32774,Ip=513,qc=36160,ml=36064,Pc={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Rp=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],ch={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},al={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},up={frag:wd,vert:Ad},Dh={cw:uu,ccw:fc};function Fh(J){return Array.isArray(J)||Z(J)||$o(J)}function lp(J){return J.sort(function(he,qe){return he===Fu?-1:qe===Fu?1:he<qe?-1:1})}function Ys(J,he,qe,er){this.thisDep=J,this.contextDep=he,this.propDep=qe,this.append=er}function Ll(J){return J&&!(J.thisDep||J.contextDep||J.propDep)}function Ba(J){return new Ys(!1,!1,!1,J)}function ga(J,he){var qe=J.type;if(qe===ui){var er=J.data.length;return new Ys(!0,er>=1,er>=2,he)}else if(qe===wa){var wr=J.data;return new Ys(wr.thisDep,wr.contextDep,wr.propDep,he)}else{if(qe===rs)return new Ys(!1,!1,!1,he);if(qe===ka){for(var lr=!1,cr=!1,Hr=!1,tn=0;tn<J.data.length;++tn){var an=J.data[tn];if(an.type===ea)Hr=!0;else if(an.type===Ai)cr=!0;else if(an.type===na)lr=!0;else if(an.type===ui){lr=!0;var un=an.data;un>=1&&(cr=!0),un>=2&&(Hr=!0)}else an.type===wa&&(lr=lr||an.data.thisDep,cr=cr||an.data.contextDep,Hr=Hr||an.data.propDep)}return new Ys(lr,cr,Hr,he)}else return new Ys(qe===na,qe===Ai,qe===ea,he)}}var Wo=new Ys(!1,!1,!1,function(){});function Vf(J,he,qe,er,wr,lr,cr,Hr,tn,an,un,on,kn,En,Zr){var Vt=an.Record,tr={add:32774,subtract:32778,"reverse subtract":32779};qe.ext_blend_minmax&&(tr.min=lv,tr.max=Td);var Qr=qe.angle_instanced_arrays,zn=qe.webgl_draw_buffers,Er=qe.oes_vertex_array_object,qn={dirty:!0,profile:Zr.profile},Bn={},pn=[],Rr={},mr={};function gn(De){return De.replace(".","_")}function Sn(De,Ee,it){var Bt=gn(De);pn.push(De),Bn[Bt]=qn[Bt]=!!it,Rr[Bt]=Ee}function sn(De,Ee,it){var Bt=gn(De);pn.push(De),Array.isArray(it)?(qn[Bt]=it.slice(),Bn[Bt]=it.slice()):qn[Bt]=Bn[Bt]=it,mr[Bt]=Ee}Sn(ms,Jp),Sn(Oo,Lh),sn(Ja,"blendColor",[0,0,0,0]),sn(Eu,"blendEquationSeparate",[ed,ed]),sn(ho,"blendFuncSeparate",[jf,Op,jf,Op]),Sn(Yu,uv,!0),sn(Su,"depthFunc",Ip),sn(go,"depthRange",[0,1]),sn(Ws,"depthMask",!0),sn(Es,Es,[!0,!0,!0,!0]),Sn(Lu,sv),sn(oc,"cullFace",_f),sn(sc,sc,fc),sn(Tc,Tc,1),Sn(ku,Mc),sn(Xc,"polygonOffset",[0,0]),Sn(Ol,Mp),Sn(Ps,sr),sn(Ku,"sampleCoverage",[1,!1]),Sn(rh,oh),sn(uc,"stencilMask",-1),sn(Ss,"stencilFunc",[sp,0,-1]),sn(Cu,"stencilOpSeparate",[Uf,Kl,Kl,Kl]),sn(Fs,"stencilOpSeparate",[_f,Kl,Kl,Kl]),Sn(Du,Cr),sn(Bs,"scissor",[0,0,J.drawingBufferWidth,J.drawingBufferHeight]),sn(Fu,Fu,[0,0,J.drawingBufferWidth,J.drawingBufferHeight]);var In={gl:J,context:kn,strings:he,next:Bn,current:qn,draw:on,elements:lr,buffer:wr,shader:un,attributes:an.state,vao:an,uniforms:tn,framebuffer:Hr,extensions:qe,timer:En,isBufferArgs:Fh},Tn={primTypes:zr,compareFuncs:ch,blendFuncs:Pc,blendEquations:tr,stencilOps:al,glTypes:js,orientationType:Dh};_e.optional(function(){In.isArrayLike=xa}),zn&&(Tn.backBuffer=[_f],Tn.drawBuffer=Me(er.maxDrawbuffers,function(De){return De===0?[0]:Me(De,function(Ee){return ml+Ee})}));var ta=0;function ji(){var De=Ni(),Ee=De.link,it=De.global;De.id=ta++,De.batchId="0";var Bt=Ee(In),ur=De.shared={props:"a0"};Object.keys(In).forEach(function(rt){ur[rt]=it.def(Bt,".",rt)}),_e.optional(function(){De.CHECK=Ee(_e),De.commandStr=_e.guessCommand(),De.command=Ee(De.commandStr),De.assert=function(rt,Fe,kt){rt("if(!(",Fe,"))",this.CHECK,".commandRaise(",Ee(kt),",",this.command,");")},Tn.invalidBlendCombinations=Rp});var st=De.next={},ut=De.current={};Object.keys(mr).forEach(function(rt){Array.isArray(qn[rt])&&(st[rt]=it.def(ur.next,".",rt),ut[rt]=it.def(ur.current,".",rt))});var bt=De.constants={};Object.keys(Tn).forEach(function(rt){bt[rt]=it.def(JSON.stringify(Tn[rt]))}),De.invoke=function(rt,Fe){switch(Fe.type){case ui:var kt=["this",ur.context,ur.props,De.batchId];return rt.def(Ee(Fe.data),".call(",kt.slice(0,Math.max(Fe.data.length+1,4)),")");case ea:return rt.def(ur.props,Fe.data);case Ai:return rt.def(ur.context,Fe.data);case na:return rt.def("this",Fe.data);case wa:return Fe.data.append(De,rt),Fe.data.ref;case rs:return Fe.data.toString();case ka:return Fe.data.map(function($t){return De.invoke(rt,$t)})}},De.attribCache={};var Se={};return De.scopeAttrib=function(rt){var Fe=he.id(rt);if(Fe in Se)return Se[Fe];var kt=an.scope[Fe];kt||(kt=an.scope[Fe]=new Vt);var $t=Se[Fe]=Ee(kt);return $t},De}function Fn(De){var Ee=De.static,it=De.dynamic,Bt;if(vf in Ee){var ur=!!Ee[vf];Bt=Ba(function(ut,bt){return ur}),Bt.enable=ur}else if(vf in it){var st=it[vf];Bt=ga(st,function(ut,bt){return ut.invoke(bt,st)})}return Bt}function Dn(De,Ee){var it=De.static,Bt=De.dynamic;if(Yc in it){var ur=it[Yc];return ur?(ur=Hr.getFramebuffer(ur),_e.command(ur,"invalid framebuffer object"),Ba(function(ut,bt){var Se=ut.link(ur),rt=ut.shared;bt.set(rt.framebuffer,".next",Se);var Fe=rt.context;return bt.set(Fe,"."+Ih,Se+".width"),bt.set(Fe,"."+Lf,Se+".height"),Se})):Ba(function(ut,bt){var Se=ut.shared;bt.set(Se.framebuffer,".next","null");var rt=Se.context;return bt.set(rt,"."+Ih,rt+"."+ap),bt.set(rt,"."+Lf,rt+"."+ba),"null"})}else if(Yc in Bt){var st=Bt[Yc];return ga(st,function(ut,bt){var Se=ut.invoke(bt,st),rt=ut.shared,Fe=rt.framebuffer,kt=bt.def(Fe,".getFramebuffer(",Se,")");_e.optional(function(){ut.assert(bt,"!"+Se+"||"+kt,"invalid framebuffer object")}),bt.set(Fe,".next",kt);var $t=rt.context;return bt.set($t,"."+Ih,kt+"?"+kt+".width:"+$t+"."+ap),bt.set($t,"."+Lf,kt+"?"+kt+".height:"+$t+"."+ba),kt})}else return null}function Mi(De,Ee,it){var Bt=De.static,ur=De.dynamic;function st(Se){if(Se in Bt){var rt=Bt[Se];_e.commandType(rt,"object","invalid "+Se,it.commandStr);var Fe=!0,kt=rt.x|0,$t=rt.y|0,Wr,bn;return"width"in rt?(Wr=rt.width|0,_e.command(Wr>=0,"invalid "+Se,it.commandStr)):Fe=!1,"height"in rt?(bn=rt.height|0,_e.command(bn>=0,"invalid "+Se,it.commandStr)):Fe=!1,new Ys(!Fe&&Ee&&Ee.thisDep,!Fe&&Ee&&Ee.contextDep,!Fe&&Ee&&Ee.propDep,function(yn,hi){var Zn=yn.shared.context,ri=Wr;"width"in rt||(ri=hi.def(Zn,".",Ih,"-",kt));var ii=bn;return"height"in rt||(ii=hi.def(Zn,".",Lf,"-",$t)),[kt,$t,ri,ii]})}else if(Se in ur){var Cn=ur[Se],Un=ga(Cn,function(yn,hi){var Zn=yn.invoke(hi,Cn);_e.optional(function(){yn.assert(hi,Zn+"&&typeof "+Zn+'==="object"',"invalid "+Se)});var ri=yn.shared.context,ii=hi.def(Zn,".x|0"),li=hi.def(Zn,".y|0"),Ri=hi.def('"width" in ',Zn,"?",Zn,".width|0:","(",ri,".",Ih,"-",ii,")"),eo=hi.def('"height" in ',Zn,"?",Zn,".height|0:","(",ri,".",Lf,"-",li,")");return _e.optional(function(){yn.assert(hi,Ri+">=0&&"+eo+">=0","invalid "+Se)}),[ii,li,Ri,eo]});return Ee&&(Un.thisDep=Un.thisDep||Ee.thisDep,Un.contextDep=Un.contextDep||Ee.contextDep,Un.propDep=Un.propDep||Ee.propDep),Un}else return Ee?new Ys(Ee.thisDep,Ee.contextDep,Ee.propDep,function(yn,hi){var Zn=yn.shared.context;return[0,0,hi.def(Zn,".",Ih),hi.def(Zn,".",Lf)]}):null}var ut=st(Fu);if(ut){var bt=ut;ut=new Ys(ut.thisDep,ut.contextDep,ut.propDep,function(Se,rt){var Fe=bt.append(Se,rt),kt=Se.shared.context;return rt.set(kt,"."+mf,Fe[2]),rt.set(kt,"."+qp,Fe[3]),Fe})}return{viewport:ut,scissor_box:st(Bs)}}function qi(De,Ee){var it=De.static,Bt=typeof it[Yl]=="string"&&typeof it[Kc]=="string";if(Bt){if(Object.keys(Ee.dynamic).length>0)return null;var ur=Ee.static,st=Object.keys(ur);if(st.length>0&&typeof ur[st[0]]=="number"){for(var ut=[],bt=0;bt<st.length;++bt)_e(typeof ur[st[bt]]=="number","must specify all vertex attribute locations when using vaos"),ut.push([ur[st[bt]]|0,st[bt]]);return ut}}return null}function Ea(De,Ee,it){var Bt=De.static,ur=De.dynamic;function st(Fe){if(Fe in Bt){var kt=he.id(Bt[Fe]);_e.optional(function(){un.shader(up[Fe],kt,_e.guessCommand())});var $t=Ba(function(){return kt});return $t.id=kt,$t}else if(Fe in ur){var Wr=ur[Fe];return ga(Wr,function(bn,Cn){var Un=bn.invoke(Cn,Wr),yn=Cn.def(bn.shared.strings,".id(",Un,")");return _e.optional(function(){Cn(bn.shared.shader,".shader(",up[Fe],",",yn,",",bn.command,");")}),yn})}return null}var ut=st(Yl),bt=st(Kc),Se=null,rt;return Ll(ut)&&Ll(bt)?(Se=un.program(bt.id,ut.id,null,it),rt=Ba(function(Fe,kt){return Fe.link(Se)})):rt=new Ys(ut&&ut.thisDep||bt&&bt.thisDep,ut&&ut.contextDep||bt&&bt.contextDep,ut&&ut.propDep||bt&&bt.propDep,function(Fe,kt){var $t=Fe.shared.shader,Wr;ut?Wr=ut.append(Fe,kt):Wr=kt.def($t,".",Yl);var bn;bt?bn=bt.append(Fe,kt):bn=kt.def($t,".",Kc);var Cn=$t+".program("+bn+","+Wr;return _e.optional(function(){Cn+=","+Fe.command}),kt.def(Cn+")")}),{frag:ut,vert:bt,progVar:rt,program:Se}}function Ao(De,Ee){var it=De.static,Bt=De.dynamic,ur={},st=!1;function ut(){if(nh in it){var hi=it[nh];return hi!==null&&an.getVAO(hi)===null&&(hi=an.createVAO(hi)),st=!0,ur.vao=hi,Ba(function(ri){var ii=an.getVAO(hi);return ii?ri.link(ii):"null"})}else if(nh in Bt){st=!0;var Zn=Bt[nh];return ga(Zn,function(ri,ii){var li=ri.invoke(ii,Zn);return ii.def(ri.shared.vao+".getVAO("+li+")")})}return null}var bt=ut(),Se=!1;function rt(){if(lc in it){var hi=it[lc];if(ur.elements=hi,Fh(hi)){var Zn=ur.elements=lr.create(hi,!0);hi=lr.getElements(Zn),Se=!0}else hi&&(hi=lr.getElements(hi),Se=!0,_e.command(hi,"invalid elements",Ee.commandStr));var ri=Ba(function(li,Ri){if(hi){var eo=li.link(hi);return li.ELEMENTS=eo,eo}return li.ELEMENTS=null,null});return ri.value=hi,ri}else if(lc in Bt){Se=!0;var ii=Bt[lc];return ga(ii,function(li,Ri){var eo=li.shared,Ks=eo.isBufferArgs,kl=eo.elements,Jc=li.invoke(Ri,ii),So=Ri.def("null"),Ia=Ri.def(Ks,"(",Jc,")"),Oc=li.cond(Ia).then(So,"=",kl,".createStream(",Jc,");").else(So,"=",kl,".getElements(",Jc,");");return _e.optional(function(){li.assert(Oc.else,"!"+Jc+"||"+So,"invalid elements")}),Ri.entry(Oc),Ri.exit(li.cond(Ia).then(kl,".destroyStream(",So,");")),li.ELEMENTS=So,So})}else if(st)return new Ys(bt.thisDep,bt.contextDep,bt.propDep,function(li,Ri){return Ri.def(li.shared.vao+".currentVAO?"+li.shared.elements+".getElements("+li.shared.vao+".currentVAO.elements):null")});return null}var Fe=rt();function kt(){if(vl in it){var hi=it[vl];return ur.primitive=hi,_e.commandParameter(hi,zr,"invalid primitve",Ee.commandStr),Ba(function(ri,ii){return zr[hi]})}else if(vl in Bt){var Zn=Bt[vl];return ga(Zn,function(ri,ii){var li=ri.constants.primTypes,Ri=ri.invoke(ii,Zn);return _e.optional(function(){ri.assert(ii,Ri+" in "+li,"invalid primitive, must be one of "+Object.keys(zr))}),ii.def(li,"[",Ri,"]")})}else{if(Se)return Ll(Fe)?Fe.value?Ba(function(ri,ii){return ii.def(ri.ELEMENTS,".primType")}):Ba(function(){return Pp}):new Ys(Fe.thisDep,Fe.contextDep,Fe.propDep,function(ri,ii){var li=ri.ELEMENTS;return ii.def(li,"?",li,".primType:",Pp)});if(st)return new Ys(bt.thisDep,bt.contextDep,bt.propDep,function(ri,ii){return ii.def(ri.shared.vao+".currentVAO?"+ri.shared.vao+".currentVAO.primitive:"+Pp)})}return null}function $t(hi,Zn){if(hi in it){var ri=it[hi]|0;return Zn?ur.offset=ri:ur.instances=ri,_e.command(!Zn||ri>=0,"invalid "+hi,Ee.commandStr),Ba(function(li,Ri){return Zn&&(li.OFFSET=ri),ri})}else if(hi in Bt){var ii=Bt[hi];return ga(ii,function(li,Ri){var eo=li.invoke(Ri,ii);return Zn&&(li.OFFSET=eo,_e.optional(function(){li.assert(Ri,eo+">=0","invalid "+hi)})),eo})}else if(Zn){if(Se)return Ba(function(li,Ri){return li.OFFSET=0,0});if(st)return new Ys(bt.thisDep,bt.contextDep,bt.propDep,function(li,Ri){return Ri.def(li.shared.vao+".currentVAO?"+li.shared.vao+".currentVAO.offset:0")})}else if(st)return new Ys(bt.thisDep,bt.contextDep,bt.propDep,function(li,Ri){return Ri.def(li.shared.vao+".currentVAO?"+li.shared.vao+".currentVAO.instances:-1")});return null}var Wr=$t(Xs,!0);function bn(){if(Zs in it){var hi=it[Zs]|0;return ur.count=hi,_e.command(typeof hi=="number"&&hi>=0,"invalid vertex count",Ee.commandStr),Ba(function(){return hi})}else if(Zs in Bt){var Zn=Bt[Zs];return ga(Zn,function(Ri,eo){var Ks=Ri.invoke(eo,Zn);return _e.optional(function(){Ri.assert(eo,"typeof "+Ks+'==="number"&&'+Ks+">=0&&"+Ks+"===("+Ks+"|0)","invalid vertex count")}),Ks})}else if(Se)if(Ll(Fe)){if(Fe)return Wr?new Ys(Wr.thisDep,Wr.contextDep,Wr.propDep,function(Ri,eo){var Ks=eo.def(Ri.ELEMENTS,".vertCount-",Ri.OFFSET);return _e.optional(function(){Ri.assert(eo,Ks+">=0","invalid vertex offset/element buffer too small")}),Ks}):Ba(function(Ri,eo){return eo.def(Ri.ELEMENTS,".vertCount")});var ri=Ba(function(){return-1});return _e.optional(function(){ri.MISSING=!0}),ri}else{var ii=new Ys(Fe.thisDep||Wr.thisDep,Fe.contextDep||Wr.contextDep,Fe.propDep||Wr.propDep,function(Ri,eo){var Ks=Ri.ELEMENTS;return Ri.OFFSET?eo.def(Ks,"?",Ks,".vertCount-",Ri.OFFSET,":-1"):eo.def(Ks,"?",Ks,".vertCount:-1")});return _e.optional(function(){ii.DYNAMIC=!0}),ii}else if(st){var li=new Ys(bt.thisDep,bt.contextDep,bt.propDep,function(Ri,eo){return eo.def(Ri.shared.vao,".currentVAO?",Ri.shared.vao,".currentVAO.count:-1")});return li}return null}var Cn=kt(),Un=bn(),yn=$t(np,!1);return{elements:Fe,primitive:Cn,count:Un,instances:yn,offset:Wr,vao:bt,vaoActive:st,elementsActive:Se,static:ur}}function ns(De,Ee){var it=De.static,Bt=De.dynamic,ur={};return pn.forEach(function(st){var ut=gn(st);function bt(Se,rt){if(st in it){var Fe=Se(it[st]);ur[ut]=Ba(function(){return Fe})}else if(st in Bt){var kt=Bt[st];ur[ut]=ga(kt,function($t,Wr){return rt($t,Wr,$t.invoke(Wr,kt))})}}switch(st){case Lu:case Oo:case ms:case rh:case Yu:case Du:case ku:case Ol:case Ps:case Ws:return bt(function(Se){return _e.commandType(Se,"boolean",st,Ee.commandStr),Se},function(Se,rt,Fe){return _e.optional(function(){Se.assert(rt,"typeof "+Fe+'==="boolean"',"invalid flag "+st,Se.commandStr)}),Fe});case Su:return bt(function(Se){return _e.commandParameter(Se,ch,"invalid "+st,Ee.commandStr),ch[Se]},function(Se,rt,Fe){var kt=Se.constants.compareFuncs;return _e.optional(function(){Se.assert(rt,Fe+" in "+kt,"invalid "+st+", must be one of "+Object.keys(ch))}),rt.def(kt,"[",Fe,"]")});case go:return bt(function(Se){return _e.command(xa(Se)&&Se.length===2&&typeof Se[0]=="number"&&typeof Se[1]=="number"&&Se[0]<=Se[1],"depth range is 2d array",Ee.commandStr),Se},function(Se,rt,Fe){_e.optional(function(){Se.assert(rt,Se.shared.isArrayLike+"("+Fe+")&&"+Fe+".length===2&&typeof "+Fe+'[0]==="number"&&typeof '+Fe+'[1]==="number"&&'+Fe+"[0]<="+Fe+"[1]","depth range must be a 2d array")});var kt=rt.def("+",Fe,"[0]"),$t=rt.def("+",Fe,"[1]");return[kt,$t]});case ho:return bt(function(Se){_e.commandType(Se,"object","blend.func",Ee.commandStr);var rt="srcRGB"in Se?Se.srcRGB:Se.src,Fe="srcAlpha"in Se?Se.srcAlpha:Se.src,kt="dstRGB"in Se?Se.dstRGB:Se.dst,$t="dstAlpha"in Se?Se.dstAlpha:Se.dst;return _e.commandParameter(rt,Pc,ut+".srcRGB",Ee.commandStr),_e.commandParameter(Fe,Pc,ut+".srcAlpha",Ee.commandStr),_e.commandParameter(kt,Pc,ut+".dstRGB",Ee.commandStr),_e.commandParameter($t,Pc,ut+".dstAlpha",Ee.commandStr),_e.command(Rp.indexOf(rt+", "+kt)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+rt+", "+kt+")",Ee.commandStr),[Pc[rt],Pc[kt],Pc[Fe],Pc[$t]]},function(Se,rt,Fe){var kt=Se.constants.blendFuncs;_e.optional(function(){Se.assert(rt,Fe+"&&typeof "+Fe+'==="object"',"invalid blend func, must be an object")});function $t(Zn,ri){var ii=rt.def('"',Zn,ri,'" in ',Fe,"?",Fe,".",Zn,ri,":",Fe,".",Zn);return _e.optional(function(){Se.assert(rt,ii+" in "+kt,"invalid "+st+"."+Zn+ri+", must be one of "+Object.keys(Pc))}),ii}var Wr=$t("src","RGB"),bn=$t("dst","RGB");_e.optional(function(){var Zn=Se.constants.invalidBlendCombinations;Se.assert(rt,Zn+".indexOf("+Wr+'+", "+'+bn+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Cn=rt.def(kt,"[",Wr,"]"),Un=rt.def(kt,"[",$t("src","Alpha"),"]"),yn=rt.def(kt,"[",bn,"]"),hi=rt.def(kt,"[",$t("dst","Alpha"),"]");return[Cn,yn,Un,hi]});case Eu:return bt(function(Se){if(typeof Se=="string")return _e.commandParameter(Se,tr,"invalid "+st,Ee.commandStr),[tr[Se],tr[Se]];if(typeof Se=="object")return _e.commandParameter(Se.rgb,tr,st+".rgb",Ee.commandStr),_e.commandParameter(Se.alpha,tr,st+".alpha",Ee.commandStr),[tr[Se.rgb],tr[Se.alpha]];_e.commandRaise("invalid blend.equation",Ee.commandStr)},function(Se,rt,Fe){var kt=Se.constants.blendEquations,$t=rt.def(),Wr=rt.def(),bn=Se.cond("typeof ",Fe,'==="string"');return _e.optional(function(){function Cn(Un,yn,hi){Se.assert(Un,hi+" in "+kt,"invalid "+yn+", must be one of "+Object.keys(tr))}Cn(bn.then,st,Fe),Se.assert(bn.else,Fe+"&&typeof "+Fe+'==="object"',"invalid "+st),Cn(bn.else,st+".rgb",Fe+".rgb"),Cn(bn.else,st+".alpha",Fe+".alpha")}),bn.then($t,"=",Wr,"=",kt,"[",Fe,"];"),bn.else($t,"=",kt,"[",Fe,".rgb];",Wr,"=",kt,"[",Fe,".alpha];"),rt(bn),[$t,Wr]});case Ja:return bt(function(Se){return _e.command(xa(Se)&&Se.length===4,"blend.color must be a 4d array",Ee.commandStr),Me(4,function(rt){return+Se[rt]})},function(Se,rt,Fe){return _e.optional(function(){Se.assert(rt,Se.shared.isArrayLike+"("+Fe+")&&"+Fe+".length===4","blend.color must be a 4d array")}),Me(4,function(kt){return rt.def("+",Fe,"[",kt,"]")})});case uc:return bt(function(Se){return _e.commandType(Se,"number",ut,Ee.commandStr),Se|0},function(Se,rt,Fe){return _e.optional(function(){Se.assert(rt,"typeof "+Fe+'==="number"',"invalid stencil.mask")}),rt.def(Fe,"|0")});case Ss:return bt(function(Se){_e.commandType(Se,"object",ut,Ee.commandStr);var rt=Se.cmp||"keep",Fe=Se.ref||0,kt="mask"in Se?Se.mask:-1;return _e.commandParameter(rt,ch,st+".cmp",Ee.commandStr),_e.commandType(Fe,"number",st+".ref",Ee.commandStr),_e.commandType(kt,"number",st+".mask",Ee.commandStr),[ch[rt],Fe,kt]},function(Se,rt,Fe){var kt=Se.constants.compareFuncs;_e.optional(function(){function Cn(){Se.assert(rt,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Cn(Fe+"&&typeof ",Fe,'==="object"'),Cn('!("cmp" in ',Fe,")||(",Fe,".cmp in ",kt,")")});var $t=rt.def('"cmp" in ',Fe,"?",kt,"[",Fe,".cmp]",":",Kl),Wr=rt.def(Fe,".ref|0"),bn=rt.def('"mask" in ',Fe,"?",Fe,".mask|0:-1");return[$t,Wr,bn]});case Cu:case Fs:return bt(function(Se){_e.commandType(Se,"object",ut,Ee.commandStr);var rt=Se.fail||"keep",Fe=Se.zfail||"keep",kt=Se.zpass||"keep";return _e.commandParameter(rt,al,st+".fail",Ee.commandStr),_e.commandParameter(Fe,al,st+".zfail",Ee.commandStr),_e.commandParameter(kt,al,st+".zpass",Ee.commandStr),[st===Fs?_f:Uf,al[rt],al[Fe],al[kt]]},function(Se,rt,Fe){var kt=Se.constants.stencilOps;_e.optional(function(){Se.assert(rt,Fe+"&&typeof "+Fe+'==="object"',"invalid "+st)});function $t(Wr){return _e.optional(function(){Se.assert(rt,'!("'+Wr+'" in '+Fe+")||("+Fe+"."+Wr+" in "+kt+")","invalid "+st+"."+Wr+", must be one of "+Object.keys(al))}),rt.def('"',Wr,'" in ',Fe,"?",kt,"[",Fe,".",Wr,"]:",Kl)}return[st===Fs?_f:Uf,$t("fail"),$t("zfail"),$t("zpass")]});case Xc:return bt(function(Se){_e.commandType(Se,"object",ut,Ee.commandStr);var rt=Se.factor|0,Fe=Se.units|0;return _e.commandType(rt,"number",ut+".factor",Ee.commandStr),_e.commandType(Fe,"number",ut+".units",Ee.commandStr),[rt,Fe]},function(Se,rt,Fe){_e.optional(function(){Se.assert(rt,Fe+"&&typeof "+Fe+'==="object"',"invalid "+st)});var kt=rt.def(Fe,".factor|0"),$t=rt.def(Fe,".units|0");return[kt,$t]});case oc:return bt(function(Se){var rt=0;return Se==="front"?rt=Uf:Se==="back"&&(rt=_f),_e.command(!!rt,ut,Ee.commandStr),rt},function(Se,rt,Fe){return _e.optional(function(){Se.assert(rt,Fe+'==="front"||'+Fe+'==="back"',"invalid cull.face")}),rt.def(Fe,'==="front"?',Uf,":",_f)});case Tc:return bt(function(Se){return _e.command(typeof Se=="number"&&Se>=er.lineWidthDims[0]&&Se<=er.lineWidthDims[1],"invalid line width, must be a positive number between "+er.lineWidthDims[0]+" and "+er.lineWidthDims[1],Ee.commandStr),Se},function(Se,rt,Fe){return _e.optional(function(){Se.assert(rt,"typeof "+Fe+'==="number"&&'+Fe+">="+er.lineWidthDims[0]+"&&"+Fe+"<="+er.lineWidthDims[1],"invalid line width")}),Fe});case sc:return bt(function(Se){return _e.commandParameter(Se,Dh,ut,Ee.commandStr),Dh[Se]},function(Se,rt,Fe){return _e.optional(function(){Se.assert(rt,Fe+'==="cw"||'+Fe+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),rt.def(Fe+'==="cw"?'+uu+":"+fc)});case Es:return bt(function(Se){return _e.command(xa(Se)&&Se.length===4,"color.mask must be length 4 array",Ee.commandStr),Se.map(function(rt){return!!rt})},function(Se,rt,Fe){return _e.optional(function(){Se.assert(rt,Se.shared.isArrayLike+"("+Fe+")&&"+Fe+".length===4","invalid color.mask")}),Me(4,function(kt){return"!!"+Fe+"["+kt+"]"})});case Ku:return bt(function(Se){_e.command(typeof Se=="object"&&Se,ut,Ee.commandStr);var rt="value"in Se?Se.value:1,Fe=!!Se.invert;return _e.command(typeof rt=="number"&&rt>=0&&rt<=1,"sample.coverage.value must be a number between 0 and 1",Ee.commandStr),[rt,Fe]},function(Se,rt,Fe){_e.optional(function(){Se.assert(rt,Fe+"&&typeof "+Fe+'==="object"',"invalid sample.coverage")});var kt=rt.def('"value" in ',Fe,"?+",Fe,".value:1"),$t=rt.def("!!",Fe,".invert");return[kt,$t]})}}),ur}function ia(De,Ee){var it=De.static,Bt=De.dynamic,ur={};return Object.keys(it).forEach(function(st){var ut=it[st],bt;if(typeof ut=="number"||typeof ut=="boolean")bt=Ba(function(){return ut});else if(typeof ut=="function"){var Se=ut._reglType;Se==="texture2d"||Se==="textureCube"?bt=Ba(function(rt){return rt.link(ut)}):Se==="framebuffer"||Se==="framebufferCube"?(_e.command(ut.color.length>0,'missing color attachment for framebuffer sent to uniform "'+st+'"',Ee.commandStr),bt=Ba(function(rt){return rt.link(ut.color[0])})):_e.commandRaise('invalid data for uniform "'+st+'"',Ee.commandStr)}else xa(ut)?bt=Ba(function(rt){var Fe=rt.global.def("[",Me(ut.length,function(kt){return _e.command(typeof ut[kt]=="number"||typeof ut[kt]=="boolean","invalid uniform "+st,rt.commandStr),ut[kt]}),"]");return Fe}):_e.commandRaise('invalid or missing data for uniform "'+st+'"',Ee.commandStr);bt.value=ut,ur[st]=bt}),Object.keys(Bt).forEach(function(st){var ut=Bt[st];ur[st]=ga(ut,function(bt,Se){return bt.invoke(Se,ut)})}),ur}function Zo(De,Ee){var it=De.static,Bt=De.dynamic,ur={};return Object.keys(it).forEach(function(st){var ut=it[st],bt=he.id(st),Se=new Vt;if(Fh(ut))Se.state=zi,Se.buffer=wr.getBuffer(wr.create(ut,ih,!1,!0)),Se.type=0;else{var rt=wr.getBuffer(ut);if(rt)Se.state=zi,Se.buffer=rt,Se.type=0;else if(_e.command(typeof ut=="object"&&ut,"invalid data for attribute "+st,Ee.commandStr),"constant"in ut){var Fe=ut.constant;Se.buffer="null",Se.state=Wi,typeof Fe=="number"?Se.x=Fe:(_e.command(xa(Fe)&&Fe.length>0&&Fe.length<=4,"invalid constant for attribute "+st,Ee.commandStr),Ii.forEach(function(yn,hi){hi<Fe.length&&(Se[yn]=Fe[hi])}))}else{Fh(ut.buffer)?rt=wr.getBuffer(wr.create(ut.buffer,ih,!1,!0)):rt=wr.getBuffer(ut.buffer),_e.command(!!rt,'missing buffer for attribute "'+st+'"',Ee.commandStr);var kt=ut.offset|0;_e.command(kt>=0,'invalid offset for attribute "'+st+'"',Ee.commandStr);var $t=ut.stride|0;_e.command($t>=0&&$t<256,'invalid stride for attribute "'+st+'", must be integer betweeen [0, 255]',Ee.commandStr);var Wr=ut.size|0;_e.command(!("size"in ut)||Wr>0&&Wr<=4,'invalid size for attribute "'+st+'", must be 1,2,3,4',Ee.commandStr);var bn=!!ut.normalized,Cn=0;"type"in ut&&(_e.commandParameter(ut.type,js,"invalid type for attribute "+st,Ee.commandStr),Cn=js[ut.type]);var Un=ut.divisor|0;_e.optional(function(){"divisor"in ut&&(_e.command(Un===0||Qr,'cannot specify divisor for attribute "'+st+'", instancing not supported',Ee.commandStr),_e.command(Un>=0,'invalid divisor for attribute "'+st+'"',Ee.commandStr));var yn=Ee.commandStr,hi=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(ut).forEach(function(Zn){_e.command(hi.indexOf(Zn)>=0,'unknown parameter "'+Zn+'" for attribute pointer "'+st+'" (valid parameters are '+hi+")",yn)})}),Se.buffer=rt,Se.state=zi,Se.size=Wr,Se.normalized=bn,Se.type=Cn||rt.dtype,Se.offset=kt,Se.stride=$t,Se.divisor=Un}}ur[st]=Ba(function(yn,hi){var Zn=yn.attribCache;if(bt in Zn)return Zn[bt];var ri={isStream:!1};return Object.keys(Se).forEach(function(ii){ri[ii]=Se[ii]}),Se.buffer&&(ri.buffer=yn.link(Se.buffer),ri.type=ri.type||ri.buffer+".dtype"),Zn[bt]=ri,ri})}),Object.keys(Bt).forEach(function(st){var ut=Bt[st];function bt(Se,rt){var Fe=Se.invoke(rt,ut),kt=Se.shared,$t=Se.constants,Wr=kt.isBufferArgs,bn=kt.buffer;_e.optional(function(){Se.assert(rt,Fe+"&&(typeof "+Fe+'==="object"||typeof '+Fe+'==="function")&&('+Wr+"("+Fe+")||"+bn+".getBuffer("+Fe+")||"+bn+".getBuffer("+Fe+".buffer)||"+Wr+"("+Fe+'.buffer)||("constant" in '+Fe+"&&(typeof "+Fe+'.constant==="number"||'+kt.isArrayLike+"("+Fe+".constant))))",'invalid dynamic attribute "'+st+'"')});var Cn={isStream:rt.def(!1)},Un=new Vt;Un.state=zi,Object.keys(Un).forEach(function(ri){Cn[ri]=rt.def(""+Un[ri])});var yn=Cn.buffer,hi=Cn.type;rt("if(",Wr,"(",Fe,")){",Cn.isStream,"=true;",yn,"=",bn,".createStream(",ih,",",Fe,");",hi,"=",yn,".dtype;","}else{",yn,"=",bn,".getBuffer(",Fe,");","if(",yn,"){",hi,"=",yn,".dtype;",'}else if("constant" in ',Fe,"){",Cn.state,"=",Wi,";","if(typeof "+Fe+'.constant === "number"){',Cn[Ii[0]],"=",Fe,".constant;",Ii.slice(1).map(function(ri){return Cn[ri]}).join("="),"=0;","}else{",Ii.map(function(ri,ii){return Cn[ri]+"="+Fe+".constant.length>"+ii+"?"+Fe+".constant["+ii+"]:0;"}).join(""),"}}else{","if(",Wr,"(",Fe,".buffer)){",yn,"=",bn,".createStream(",ih,",",Fe,".buffer);","}else{",yn,"=",bn,".getBuffer(",Fe,".buffer);","}",hi,'="type" in ',Fe,"?",$t.glTypes,"[",Fe,".type]:",yn,".dtype;",Cn.normalized,"=!!",Fe,".normalized;");function Zn(ri){rt(Cn[ri],"=",Fe,".",ri,"|0;")}return Zn("size"),Zn("offset"),Zn("stride"),Zn("divisor"),rt("}}"),rt.exit("if(",Cn.isStream,"){",bn,".destroyStream(",yn,");","}"),Cn}ur[st]=ga(ut,bt)}),ur}function Io(De){var Ee=De.static,it=De.dynamic,Bt={};return Object.keys(Ee).forEach(function(ur){var st=Ee[ur];Bt[ur]=Ba(function(ut,bt){return typeof st=="number"||typeof st=="boolean"?""+st:ut.link(st)})}),Object.keys(it).forEach(function(ur){var st=it[ur];Bt[ur]=ga(st,function(ut,bt){return ut.invoke(bt,st)})}),Bt}function Os(De,Ee,it,Bt,ur){var st=De.static,ut=De.dynamic;_e.optional(function(){var Zn=[Yc,Kc,Yl,lc,vl,Xs,Zs,np,vf,nh].concat(pn);function ri(ii){Object.keys(ii).forEach(function(li){_e.command(Zn.indexOf(li)>=0,'unknown parameter "'+li+'"',ur.commandStr)})}ri(st),ri(ut)});var bt=qi(De,Ee),Se=Dn(De,ur),rt=Mi(De,Se,ur),Fe=Ao(De,ur),kt=ns(De,ur),$t=Ea(De,ur,bt);function Wr(Zn){var ri=rt[Zn];ri&&(kt[Zn]=ri)}Wr(Fu),Wr(gn(Bs));var bn=Object.keys(kt).length>0,Cn={framebuffer:Se,draw:Fe,shader:$t,state:kt,dirty:bn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Cn.profile=Fn(De,ur),Cn.uniforms=ia(it,ur),Cn.drawVAO=Cn.scopeVAO=Fe.vao,!Cn.drawVAO&&$t.program&&!bt&&qe.angle_instanced_arrays&&Fe.static.elements){var Un=!0,yn=$t.program.attributes.map(function(Zn){var ri=Ee.static[Zn];return Un=Un&&!!ri,ri});if(Un&&yn.length>0){var hi=an.getVAO(an.createVAO({attributes:yn,elements:Fe.static.elements}));Cn.drawVAO=new Ys(null,null,null,function(Zn,ri){return Zn.link(hi)}),Cn.useVAO=!0}}return bt?Cn.useVAO=!0:Cn.attributes=Zo(Ee,ur),Cn.context=Io(Bt,ur),Cn}function Is(De,Ee,it){var Bt=De.shared,ur=Bt.context,st=De.scope();Object.keys(it).forEach(function(ut){Ee.save(ur,"."+ut);var bt=it[ut],Se=bt.append(De,Ee);Array.isArray(Se)?st(ur,".",ut,"=[",Se.join(),"];"):st(ur,".",ut,"=",Se,";")}),Ee(st)}function lu(De,Ee,it,Bt){var ur=De.shared,st=ur.gl,ut=ur.framebuffer,bt;zn&&(bt=Ee.def(ur.extensions,".webgl_draw_buffers"));var Se=De.constants,rt=Se.drawBuffer,Fe=Se.backBuffer,kt;it?kt=it.append(De,Ee):kt=Ee.def(ut,".next"),Bt||Ee("if(",kt,"!==",ut,".cur){"),Ee("if(",kt,"){",st,".bindFramebuffer(",qc,",",kt,".framebuffer);"),zn&&Ee(bt,".drawBuffersWEBGL(",rt,"[",kt,".colorAttachments.length]);"),Ee("}else{",st,".bindFramebuffer(",qc,",null);"),zn&&Ee(bt,".drawBuffersWEBGL(",Fe,");"),Ee("}",ut,".cur=",kt,";"),Bt||Ee("}")}function cu(De,Ee,it){var Bt=De.shared,ur=Bt.gl,st=De.current,ut=De.next,bt=Bt.current,Se=Bt.next,rt=De.cond(bt,".dirty");pn.forEach(function(Fe){var kt=gn(Fe);if(!(kt in it.state)){var $t,Wr;if(kt in ut){$t=ut[kt],Wr=st[kt];var bn=Me(qn[kt].length,function(Un){return rt.def($t,"[",Un,"]")});rt(De.cond(bn.map(function(Un,yn){return Un+"!=="+Wr+"["+yn+"]"}).join("||")).then(ur,".",mr[kt],"(",bn,");",bn.map(function(Un,yn){return Wr+"["+yn+"]="+Un}).join(";"),";"))}else{$t=rt.def(Se,".",kt);var Cn=De.cond($t,"!==",bt,".",kt);rt(Cn),kt in Rr?Cn(De.cond($t).then(ur,".enable(",Rr[kt],");").else(ur,".disable(",Rr[kt],");"),bt,".",kt,"=",$t,";"):Cn(ur,".",mr[kt],"(",$t,");",bt,".",kt,"=",$t,";")}}}),Object.keys(it.state).length===0&&rt(bt,".dirty=false;"),Ee(rt)}function fu(De,Ee,it,Bt){var ur=De.shared,st=De.current,ut=ur.current,bt=ur.gl;lp(Object.keys(it)).forEach(function(Se){var rt=it[Se];if(!(Bt&&!Bt(rt))){var Fe=rt.append(De,Ee);if(Rr[Se]){var kt=Rr[Se];Ll(rt)?Fe?Ee(bt,".enable(",kt,");"):Ee(bt,".disable(",kt,");"):Ee(De.cond(Fe).then(bt,".enable(",kt,");").else(bt,".disable(",kt,");")),Ee(ut,".",Se,"=",Fe,";")}else if(xa(Fe)){var $t=st[Se];Ee(bt,".",mr[Se],"(",Fe,");",Fe.map(function(Wr,bn){return $t+"["+bn+"]="+Wr}).join(";"),";")}else Ee(bt,".",mr[Se],"(",Fe,");",ut,".",Se,"=",Fe,";")}})}function Xo(De,Ee){Qr&&(De.instancing=Ee.def(De.shared.extensions,".angle_instanced_arrays"))}function pa(De,Ee,it,Bt,ur){var st=De.shared,ut=De.stats,bt=st.current,Se=st.timer,rt=it.profile;function Fe(){var Zn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return Zn||typeof performance=="undefined"?"Date.now()":"performance.now()"}var kt,$t;function Wr(Zn){kt=Ee.def(),Zn(kt,"=",Fe(),";"),typeof ur=="string"?Zn(ut,".count+=",ur,";"):Zn(ut,".count++;"),En&&(Bt?($t=Ee.def(),Zn($t,"=",Se,".getNumPendingQueries();")):Zn(Se,".beginQuery(",ut,");"))}function bn(Zn){Zn(ut,".cpuTime+=",Fe(),"-",kt,";"),En&&(Bt?Zn(Se,".pushScopeStats(",$t,",",Se,".getNumPendingQueries(),",ut,");"):Zn(Se,".endQuery();"))}function Cn(Zn){var ri=Ee.def(bt,".profile");Ee(bt,".profile=",Zn,";"),Ee.exit(bt,".profile=",ri,";")}var Un;if(rt){if(Ll(rt)){rt.enable?(Wr(Ee),bn(Ee.exit),Cn("true")):Cn("false");return}Un=rt.append(De,Ee),Cn(Un)}else Un=Ee.def(bt,".profile");var yn=De.block();Wr(yn),Ee("if(",Un,"){",yn,"}");var hi=De.block();bn(hi),Ee.exit("if(",Un,"){",hi,"}")}function Ns(De,Ee,it,Bt,ur){var st=De.shared;function ut(Se){switch(Se){case yf:case Df:case op:return 2;case kf:case Il:case Bf:return 3;case sh:case Ff:case uh:return 4;default:return 1}}function bt(Se,rt,Fe){var kt=st.gl,$t=Ee.def(Se,".location"),Wr=Ee.def(st.attributes,"[",$t,"]"),bn=Fe.state,Cn=Fe.buffer,Un=[Fe.x,Fe.y,Fe.z,Fe.w],yn=["buffer","normalized","offset","stride"];function hi(){Ee("if(!",Wr,".buffer){",kt,".enableVertexAttribArray(",$t,");}");var ri=Fe.type,ii;if(Fe.size?ii=Ee.def(Fe.size,"||",rt):ii=rt,Ee("if(",Wr,".type!==",ri,"||",Wr,".size!==",ii,"||",yn.map(function(Ri){return Wr+"."+Ri+"!=="+Fe[Ri]}).join("||"),"){",kt,".bindBuffer(",ih,",",Cn,".buffer);",kt,".vertexAttribPointer(",[$t,ii,ri,Fe.normalized,Fe.stride,Fe.offset],");",Wr,".type=",ri,";",Wr,".size=",ii,";",yn.map(function(Ri){return Wr+"."+Ri+"="+Fe[Ri]+";"}).join(""),"}"),Qr){var li=Fe.divisor;Ee("if(",Wr,".divisor!==",li,"){",De.instancing,".vertexAttribDivisorANGLE(",[$t,li],");",Wr,".divisor=",li,";}")}}function Zn(){Ee("if(",Wr,".buffer){",kt,".disableVertexAttribArray(",$t,");",Wr,".buffer=null;","}if(",Ii.map(function(ri,ii){return Wr+"."+ri+"!=="+Un[ii]}).join("||"),"){",kt,".vertexAttrib4f(",$t,",",Un,");",Ii.map(function(ri,ii){return Wr+"."+ri+"="+Un[ii]+";"}).join(""),"}")}bn===zi?hi():bn===Wi?Zn():(Ee("if(",bn,"===",zi,"){"),hi(),Ee("}else{"),Zn(),Ee("}"))}Bt.forEach(function(Se){var rt=Se.name,Fe=it.attributes[rt],kt;if(Fe){if(!ur(Fe))return;kt=Fe.append(De,Ee)}else{if(!ur(Wo))return;var $t=De.scopeAttrib(rt);_e.optional(function(){De.assert(Ee,$t+".state","missing attribute "+rt)}),kt={},Object.keys(new Vt).forEach(function(Wr){kt[Wr]=Ee.def($t,".",Wr)})}bt(De.link(Se),ut(Se.info.type),kt)})}function Ga(De,Ee,it,Bt,ur,st){for(var ut=De.shared,bt=ut.gl,Se,rt=0;rt<Bt.length;++rt){var Fe=Bt[rt],kt=Fe.name,$t=Fe.info.type,Wr=it.uniforms[kt],bn=De.link(Fe),Cn=bn+".location",Un;if(Wr){if(!ur(Wr))continue;if(Ll(Wr)){var yn=Wr.value;if(_e.command(yn!==null&&typeof yn!="undefined",'missing uniform "'+kt+'"',De.commandStr),$t===kh||$t===lh){_e.command(typeof yn=="function"&&($t===kh&&(yn._reglType==="texture2d"||yn._reglType==="framebuffer")||$t===lh&&(yn._reglType==="textureCube"||yn._reglType==="framebufferCube")),"invalid texture for uniform "+kt,De.commandStr);var hi=De.link(yn._texture||yn.color[0]._texture);Ee(bt,".uniform1i(",Cn,",",hi+".bind());"),Ee.exit(hi,".unbind();")}else if($t===Nf||$t===zf||$t===il){_e.optional(function(){_e.command(xa(yn),"invalid matrix for uniform "+kt,De.commandStr),_e.command($t===Nf&&yn.length===4||$t===zf&&yn.length===9||$t===il&&yn.length===16,"invalid length for matrix uniform "+kt,De.commandStr)});var Zn=De.global.def("new Float32Array(["+Array.prototype.slice.call(yn)+"])"),ri=2;$t===zf?ri=3:$t===il&&(ri=4),Ee(bt,".uniformMatrix",ri,"fv(",Cn,",false,",Zn,");")}else{switch($t){case gf:_e.commandType(yn,"number","uniform "+kt,De.commandStr),Se="1f";break;case yf:_e.command(xa(yn)&&yn.length===2,"uniform "+kt,De.commandStr),Se="2f";break;case kf:_e.command(xa(yn)&&yn.length===3,"uniform "+kt,De.commandStr),Se="3f";break;case sh:_e.command(xa(yn)&&yn.length===4,"uniform "+kt,De.commandStr),Se="4f";break;case Rl:_e.commandType(yn,"boolean","uniform "+kt,De.commandStr),Se="1i";break;case $c:_e.commandType(yn,"number","uniform "+kt,De.commandStr),Se="1i";break;case op:_e.command(xa(yn)&&yn.length===2,"uniform "+kt,De.commandStr),Se="2i";break;case Df:_e.command(xa(yn)&&yn.length===2,"uniform "+kt,De.commandStr),Se="2i";break;case Bf:_e.command(xa(yn)&&yn.length===3,"uniform "+kt,De.commandStr),Se="3i";break;case Il:_e.command(xa(yn)&&yn.length===3,"uniform "+kt,De.commandStr),Se="3i";break;case uh:_e.command(xa(yn)&&yn.length===4,"uniform "+kt,De.commandStr),Se="4i";break;case Ff:_e.command(xa(yn)&&yn.length===4,"uniform "+kt,De.commandStr),Se="4i";break}Ee(bt,".uniform",Se,"(",Cn,",",xa(yn)?Array.prototype.slice.call(yn):yn,");")}continue}else Un=Wr.append(De,Ee)}else{if(!ur(Wo))continue;Un=Ee.def(ut.uniforms,"[",he.id(kt),"]")}$t===kh?(_e(!Array.isArray(Un),"must specify a scalar prop for textures"),Ee("if(",Un,"&&",Un,'._reglType==="framebuffer"){',Un,"=",Un,".color[0];","}")):$t===lh&&(_e(!Array.isArray(Un),"must specify a scalar prop for cube maps"),Ee("if(",Un,"&&",Un,'._reglType==="framebufferCube"){',Un,"=",Un,".color[0];","}")),_e.optional(function(){function Ia(hc,nd){De.assert(Ee,hc,'bad data or missing for uniform "'+kt+'".  '+nd)}function Oc(hc){_e(!Array.isArray(Un),"must not specify an array type for uniform"),Ia("typeof "+Un+'==="'+hc+'"',"invalid type, expected "+hc)}function ql(hc,nd){Array.isArray(Un)?_e(Un.length===hc,"must have length "+hc):Ia(ut.isArrayLike+"("+Un+")&&"+Un+".length==="+hc,"invalid vector, should have length "+hc,De.commandStr)}function rd(hc){_e(!Array.isArray(Un),"must not specify a value type"),Ia("typeof "+Un+'==="function"&&'+Un+'._reglType==="texture'+(hc===Qp?"2d":"Cube")+'"',"invalid texture type",De.commandStr)}switch($t){case $c:Oc("number");break;case Df:ql(2,"number");break;case Il:ql(3,"number");break;case Ff:ql(4,"number");break;case gf:Oc("number");break;case yf:ql(2,"number");break;case kf:ql(3,"number");break;case sh:ql(4,"number");break;case Rl:Oc("boolean");break;case op:ql(2,"boolean");break;case Bf:ql(3,"boolean");break;case uh:ql(4,"boolean");break;case Nf:ql(4,"number");break;case zf:ql(9,"number");break;case il:ql(16,"number");break;case kh:rd(Qp);break;case lh:rd(cc);break}});var ii=1;switch($t){case kh:case lh:var li=Ee.def(Un,"._texture");Ee(bt,".uniform1i(",Cn,",",li,".bind());"),Ee.exit(li,".unbind();");continue;case $c:case Rl:Se="1i";break;case Df:case op:Se="2i",ii=2;break;case Il:case Bf:Se="3i",ii=3;break;case Ff:case uh:Se="4i",ii=4;break;case gf:Se="1f";break;case yf:Se="2f",ii=2;break;case kf:Se="3f",ii=3;break;case sh:Se="4f",ii=4;break;case Nf:Se="Matrix2fv";break;case zf:Se="Matrix3fv";break;case il:Se="Matrix4fv";break}if(Se.charAt(0)==="M"){Ee(bt,".uniform",Se,"(",Cn,",");var Ri=Math.pow($t-Nf+2,2),eo=De.global.def("new Float32Array(",Ri,")");Array.isArray(Un)?Ee("false,(",Me(Ri,function(Ia){return eo+"["+Ia+"]="+Un[Ia]}),",",eo,")"):Ee("false,(Array.isArray(",Un,")||",Un," instanceof Float32Array)?",Un,":(",Me(Ri,function(Ia){return eo+"["+Ia+"]="+Un+"["+Ia+"]"}),",",eo,")"),Ee(");")}else if(ii>1){for(var Ks=[],kl=[],Jc=0;Jc<ii;++Jc)Array.isArray(Un)?kl.push(Un[Jc]):kl.push(Ee.def(Un+"["+Jc+"]")),st&&Ks.push(Ee.def());st&&Ee("if(!",De.batchId,"||",Ks.map(function(Ia,Oc){return Ia+"!=="+kl[Oc]}).join("||"),"){",Ks.map(function(Ia,Oc){return Ia+"="+kl[Oc]+";"}).join("")),Ee(bt,".uniform",Se,"(",Cn,",",kl.join(","),");"),st&&Ee("}")}else{if(_e(!Array.isArray(Un),"uniform value must not be an array"),st){var So=Ee.def();Ee("if(!",De.batchId,"||",So,"!==",Un,"){",So,"=",Un,";")}Ee(bt,".uniform",Se,"(",Cn,",",Un,");"),st&&Ee("}")}}}function Rs(De,Ee,it,Bt){var ur=De.shared,st=ur.gl,ut=ur.draw,bt=Bt.draw;function Se(){var ii=bt.elements,li,Ri=Ee;return ii?((ii.contextDep&&Bt.contextDynamic||ii.propDep)&&(Ri=it),li=ii.append(De,Ri),bt.elementsActive&&Ri("if("+li+")"+st+".bindBuffer("+ah+","+li+".buffer.buffer);")):(li=Ri.def(),Ri(li,"=",ut,".",lc,";","if(",li,"){",st,".bindBuffer(",ah,",",li,".buffer.buffer);}","else if(",ur.vao,".currentVAO){",li,"=",De.shared.elements+".getElements("+ur.vao,".currentVAO.elements);",Er?"":"if("+li+")"+st+".bindBuffer("+ah+","+li+".buffer.buffer);","}")),li}function rt(){var ii=bt.count,li,Ri=Ee;return ii?((ii.contextDep&&Bt.contextDynamic||ii.propDep)&&(Ri=it),li=ii.append(De,Ri),_e.optional(function(){ii.MISSING&&De.assert(Ee,"false","missing vertex count"),ii.DYNAMIC&&De.assert(Ri,li+">=0","missing vertex count")})):(li=Ri.def(ut,".",Zs),_e.optional(function(){De.assert(Ri,li+">=0","missing vertex count")})),li}var Fe=Se();function kt(ii){var li=bt[ii];return li?li.contextDep&&Bt.contextDynamic||li.propDep?li.append(De,it):li.append(De,Ee):Ee.def(ut,".",ii)}var $t=kt(vl),Wr=kt(Xs),bn=rt();if(typeof bn=="number"){if(bn===0)return}else it("if(",bn,"){"),it.exit("}");var Cn,Un;Qr&&(Cn=kt(np),Un=De.instancing);var yn=Fe+".type",hi=bt.elements&&Ll(bt.elements)&&!bt.vaoActive;function Zn(){function ii(){it(Un,".drawElementsInstancedANGLE(",[$t,bn,yn,Wr+"<<(("+yn+"-"+$n+")>>1)",Cn],");")}function li(){it(Un,".drawArraysInstancedANGLE(",[$t,Wr,bn,Cn],");")}Fe&&Fe!=="null"?hi?ii():(it("if(",Fe,"){"),ii(),it("}else{"),li(),it("}")):li()}function ri(){function ii(){it(st+".drawElements("+[$t,bn,yn,Wr+"<<(("+yn+"-"+$n+")>>1)"]+");")}function li(){it(st+".drawArrays("+[$t,Wr,bn]+");")}Fe&&Fe!=="null"?hi?ii():(it("if(",Fe,"){"),ii(),it("}else{"),li(),it("}")):li()}Qr&&(typeof Cn!="number"||Cn>=0)?typeof Cn=="string"?(it("if(",Cn,">0){"),Zn(),it("}else if(",Cn,"<0){"),ri(),it("}")):Zn():ri()}function ki(De,Ee,it,Bt,ur){var st=ji(),ut=st.proc("body",ur);return _e.optional(function(){st.commandStr=Ee.commandStr,st.command=st.link(Ee.commandStr)}),Qr&&(st.instancing=ut.def(st.shared.extensions,".angle_instanced_arrays")),De(st,ut,it,Bt),st.compile().body}function ca(De,Ee,it,Bt){Xo(De,Ee),it.useVAO?it.drawVAO?Ee(De.shared.vao,".setVAO(",it.drawVAO.append(De,Ee),");"):Ee(De.shared.vao,".setVAO(",De.shared.vao,".targetVAO);"):(Ee(De.shared.vao,".setVAO(null);"),Ns(De,Ee,it,Bt.attributes,function(){return!0})),Ga(De,Ee,it,Bt.uniforms,function(){return!0},!1),Rs(De,Ee,Ee,it)}function yo(De,Ee){var it=De.proc("draw",1);Xo(De,it),Is(De,it,Ee.context),lu(De,it,Ee.framebuffer),cu(De,it,Ee),fu(De,it,Ee.state),pa(De,it,Ee,!1,!0);var Bt=Ee.shader.progVar.append(De,it);if(it(De.shared.gl,".useProgram(",Bt,".program);"),Ee.shader.program)ca(De,it,Ee,Ee.shader.program);else{it(De.shared.vao,".setVAO(null);");var ur=De.global.def("{}"),st=it.def(Bt,".id"),ut=it.def(ur,"[",st,"]");it(De.cond(ut).then(ut,".call(this,a0);").else(ut,"=",ur,"[",st,"]=",De.link(function(bt){return ki(ca,De,Ee,bt,1)}),"(",Bt,");",ut,".call(this,a0);"))}Object.keys(Ee.state).length>0&&it(De.shared.current,".dirty=true;"),De.shared.vao&&it(De.shared.vao,".setVAO(null);")}function wu(De,Ee,it,Bt){De.batchId="a1",Xo(De,Ee);function ur(){return!0}Ns(De,Ee,it,Bt.attributes,ur),Ga(De,Ee,it,Bt.uniforms,ur,!1),Rs(De,Ee,Ee,it)}function hu(De,Ee,it,Bt){Xo(De,Ee);var ur=it.contextDep,st=Ee.def(),ut="a0",bt="a1",Se=Ee.def();De.shared.props=Se,De.batchId=st;var rt=De.scope(),Fe=De.scope();Ee(rt.entry,"for(",st,"=0;",st,"<",bt,";++",st,"){",Se,"=",ut,"[",st,"];",Fe,"}",rt.exit);function kt(yn){return yn.contextDep&&ur||yn.propDep}function $t(yn){return!kt(yn)}if(it.needsContext&&Is(De,Fe,it.context),it.needsFramebuffer&&lu(De,Fe,it.framebuffer),fu(De,Fe,it.state,kt),it.profile&&kt(it.profile)&&pa(De,Fe,it,!1,!0),Bt)it.useVAO?it.drawVAO?kt(it.drawVAO)?Fe(De.shared.vao,".setVAO(",it.drawVAO.append(De,Fe),");"):rt(De.shared.vao,".setVAO(",it.drawVAO.append(De,rt),");"):rt(De.shared.vao,".setVAO(",De.shared.vao,".targetVAO);"):(rt(De.shared.vao,".setVAO(null);"),Ns(De,rt,it,Bt.attributes,$t),Ns(De,Fe,it,Bt.attributes,kt)),Ga(De,rt,it,Bt.uniforms,$t,!1),Ga(De,Fe,it,Bt.uniforms,kt,!0),Rs(De,rt,Fe,it);else{var Wr=De.global.def("{}"),bn=it.shader.progVar.append(De,Fe),Cn=Fe.def(bn,".id"),Un=Fe.def(Wr,"[",Cn,"]");Fe(De.shared.gl,".useProgram(",bn,".program);","if(!",Un,"){",Un,"=",Wr,"[",Cn,"]=",De.link(function(yn){return ki(wu,De,it,yn,2)}),"(",bn,");}",Un,".call(this,a0[",st,"],",st,");")}}function Ge(De,Ee){var it=De.proc("batch",2);De.batchId="0",Xo(De,it);var Bt=!1,ur=!0;Object.keys(Ee.context).forEach(function(Wr){Bt=Bt||Ee.context[Wr].propDep}),Bt||(Is(De,it,Ee.context),ur=!1);var st=Ee.framebuffer,ut=!1;st?(st.propDep?Bt=ut=!0:st.contextDep&&Bt&&(ut=!0),ut||lu(De,it,st)):lu(De,it,null),Ee.state.viewport&&Ee.state.viewport.propDep&&(Bt=!0);function bt(Wr){return Wr.contextDep&&Bt||Wr.propDep}cu(De,it,Ee),fu(De,it,Ee.state,function(Wr){return!bt(Wr)}),(!Ee.profile||!bt(Ee.profile))&&pa(De,it,Ee,!1,"a1"),Ee.contextDep=Bt,Ee.needsContext=ur,Ee.needsFramebuffer=ut;var Se=Ee.shader.progVar;if(Se.contextDep&&Bt||Se.propDep)hu(De,it,Ee,null);else{var rt=Se.append(De,it);if(it(De.shared.gl,".useProgram(",rt,".program);"),Ee.shader.program)hu(De,it,Ee,Ee.shader.program);else{it(De.shared.vao,".setVAO(null);");var Fe=De.global.def("{}"),kt=it.def(rt,".id"),$t=it.def(Fe,"[",kt,"]");it(De.cond($t).then($t,".call(this,a0,a1);").else($t,"=",Fe,"[",kt,"]=",De.link(function(Wr){return ki(hu,De,Ee,Wr,2)}),"(",rt,");",$t,".call(this,a0,a1);"))}}Object.keys(Ee.state).length>0&&it(De.shared.current,".dirty=true;"),De.shared.vao&&it(De.shared.vao,".setVAO(null);")}function hr(De,Ee){var it=De.proc("scope",3);De.batchId="a2";var Bt=De.shared,ur=Bt.current;Is(De,it,Ee.context),Ee.framebuffer&&Ee.framebuffer.append(De,it),lp(Object.keys(Ee.state)).forEach(function(ut){var bt=Ee.state[ut],Se=bt.append(De,it);xa(Se)?Se.forEach(function(rt,Fe){it.set(De.next[ut],"["+Fe+"]",rt)}):it.set(Bt.next,"."+ut,Se)}),pa(De,it,Ee,!0,!0),[lc,Xs,Zs,np,vl].forEach(function(ut){var bt=Ee.draw[ut];!bt||it.set(Bt.draw,"."+ut,""+bt.append(De,it))}),Object.keys(Ee.uniforms).forEach(function(ut){var bt=Ee.uniforms[ut].append(De,it);Array.isArray(bt)&&(bt="["+bt.join()+"]"),it.set(Bt.uniforms,"["+he.id(ut)+"]",bt)}),Object.keys(Ee.attributes).forEach(function(ut){var bt=Ee.attributes[ut].append(De,it),Se=De.scopeAttrib(ut);Object.keys(new Vt).forEach(function(rt){it.set(Se,"."+rt,bt[rt])})}),Ee.scopeVAO&&it.set(Bt.vao,".targetVAO",Ee.scopeVAO.append(De,it));function st(ut){var bt=Ee.shader[ut];bt&&it.set(Bt.shader,"."+ut,bt.append(De,it))}st(Kc),st(Yl),Object.keys(Ee.state).length>0&&(it(ur,".dirty=true;"),it.exit(ur,".dirty=true;")),it("a1(",De.shared.context,",a0,",De.batchId,");")}function Wt(De){if(!(typeof De!="object"||xa(De))){for(var Ee=Object.keys(De),it=0;it<Ee.length;++it)if(fi.isDynamic(De[Ee[it]]))return!0;return!1}}function Wn(De,Ee,it){var Bt=Ee.static[it];if(!Bt||!Wt(Bt))return;var ur=De.global,st=Object.keys(Bt),ut=!1,bt=!1,Se=!1,rt=De.global.def("{}");st.forEach(function(kt){var $t=Bt[kt];if(fi.isDynamic($t)){typeof $t=="function"&&($t=Bt[kt]=fi.unbox($t));var Wr=ga($t,null);ut=ut||Wr.thisDep,Se=Se||Wr.propDep,bt=bt||Wr.contextDep}else{switch(ur(rt,".",kt,"="),typeof $t){case"number":ur($t);break;case"string":ur('"',$t,'"');break;case"object":Array.isArray($t)&&ur("[",$t.join(),"]");break;default:ur(De.link($t));break}ur(";")}});function Fe(kt,$t){st.forEach(function(Wr){var bn=Bt[Wr];if(!!fi.isDynamic(bn)){var Cn=kt.invoke($t,bn);$t(rt,".",Wr,"=",Cn,";")}})}Ee.dynamic[it]=new fi.DynamicVariable(wa,{thisDep:ut,contextDep:bt,propDep:Se,ref:rt,append:Fe}),delete Ee.static[it]}function va(De,Ee,it,Bt,ur){var st=ji();st.stats=st.link(ur),Object.keys(Ee.static).forEach(function(bt){Wn(st,Ee,bt)}),Rh.forEach(function(bt){Wn(st,De,bt)});var ut=Os(De,Ee,it,Bt,st);return yo(st,ut),hr(st,ut),Ge(st,ut),Y(st.compile(),{destroy:function(){ut.shader.program.destroy()}})}return{next:Bn,current:qn,procs:function(){var De=ji(),Ee=De.proc("poll"),it=De.proc("refresh"),Bt=De.block();Ee(Bt),it(Bt);var ur=De.shared,st=ur.gl,ut=ur.next,bt=ur.current;Bt(bt,".dirty=false;"),lu(De,Ee),lu(De,it,null,!0);var Se;Qr&&(Se=De.link(Qr)),qe.oes_vertex_array_object&&it(De.link(qe.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var rt=0;rt<er.maxAttributes;++rt){var Fe=it.def(ur.attributes,"[",rt,"]"),kt=De.cond(Fe,".buffer");kt.then(st,".enableVertexAttribArray(",rt,");",st,".bindBuffer(",ih,",",Fe,".buffer.buffer);",st,".vertexAttribPointer(",rt,",",Fe,".size,",Fe,".type,",Fe,".normalized,",Fe,".stride,",Fe,".offset);").else(st,".disableVertexAttribArray(",rt,");",st,".vertexAttrib4f(",rt,",",Fe,".x,",Fe,".y,",Fe,".z,",Fe,".w);",Fe,".buffer=null;"),it(kt),Qr&&it(Se,".vertexAttribDivisorANGLE(",rt,",",Fe,".divisor);")}return it(De.shared.vao,".currentVAO=null;",De.shared.vao,".setVAO(",De.shared.vao,".targetVAO);"),Object.keys(Rr).forEach(function($t){var Wr=Rr[$t],bn=Bt.def(ut,".",$t),Cn=De.block();Cn("if(",bn,"){",st,".enable(",Wr,")}else{",st,".disable(",Wr,")}",bt,".",$t,"=",bn,";"),it(Cn),Ee("if(",bn,"!==",bt,".",$t,"){",Cn,"}")}),Object.keys(mr).forEach(function($t){var Wr=mr[$t],bn=qn[$t],Cn,Un,yn=De.block();if(yn(st,".",Wr,"("),xa(bn)){var hi=bn.length;Cn=De.global.def(ut,".",$t),Un=De.global.def(bt,".",$t),yn(Me(hi,function(Zn){return Cn+"["+Zn+"]"}),");",Me(hi,function(Zn){return Un+"["+Zn+"]="+Cn+"["+Zn+"];"}).join("")),Ee("if(",Me(hi,function(Zn){return Cn+"["+Zn+"]!=="+Un+"["+Zn+"]"}).join("||"),"){",yn,"}")}else Cn=Bt.def(ut,".",$t),Un=Bt.def(bt,".",$t),yn(Cn,");",bt,".",$t,"=",Cn,";"),Ee("if(",Cn,"!==",Un,"){",yn,"}");it(yn)}),De.compile()}(),compile:va}}function cv(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Qc=34918,fv=34919,Md=35007,hv=function(he,qe){if(!qe.ext_disjoint_timer_query)return null;var er=[];function wr(){return er.pop()||qe.ext_disjoint_timer_query.createQueryEXT()}function lr(zn){er.push(zn)}var cr=[];function Hr(zn){var Er=wr();qe.ext_disjoint_timer_query.beginQueryEXT(Md,Er),cr.push(Er),Zr(cr.length-1,cr.length,zn)}function tn(){qe.ext_disjoint_timer_query.endQueryEXT(Md)}function an(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var un=[];function on(){return un.pop()||new an}function kn(zn){un.push(zn)}var En=[];function Zr(zn,Er,qn){var Bn=on();Bn.startQueryIndex=zn,Bn.endQueryIndex=Er,Bn.sum=0,Bn.stats=qn,En.push(Bn)}var Vt=[],tr=[];function Qr(){var zn,Er,qn=cr.length;if(qn!==0){tr.length=Math.max(tr.length,qn+1),Vt.length=Math.max(Vt.length,qn+1),Vt[0]=0,tr[0]=0;var Bn=0;for(zn=0,Er=0;Er<cr.length;++Er){var pn=cr[Er];qe.ext_disjoint_timer_query.getQueryObjectEXT(pn,fv)?(Bn+=qe.ext_disjoint_timer_query.getQueryObjectEXT(pn,Qc),lr(pn)):cr[zn++]=pn,Vt[Er+1]=Bn,tr[Er+1]=zn}for(cr.length=zn,zn=0,Er=0;Er<En.length;++Er){var Rr=En[Er],mr=Rr.startQueryIndex,gn=Rr.endQueryIndex;Rr.sum+=Vt[gn]-Vt[mr];var Sn=tr[mr],sn=tr[gn];sn===Sn?(Rr.stats.gpuTime+=Rr.sum/1e6,kn(Rr)):(Rr.startQueryIndex=Sn,Rr.endQueryIndex=sn,En[zn++]=Rr)}En.length=zn}}return{beginQuery:Hr,endQuery:tn,pushScopeStats:Zr,update:Qr,getNumPendingQueries:function(){return cr.length},clear:function(){er.push.apply(er,cr);for(var Er=0;Er<er.length;Er++)qe.ext_disjoint_timer_query.deleteQueryEXT(er[Er]);cr.length=0,er.length=0},restore:function(){cr.length=0,er.length=0}}},td=16384,pv=256,dv=1024,$l=34962,cp="webglcontextlost",fp="webglcontextrestored",fh=1,po=2,hh=3;function Ui(J,he){for(var qe=0;qe<J.length;++qe)if(J[qe]===he)return qe;return-1}function xf(J){var he=ie(J);if(!he)return null;var qe=he.gl,er=qe.getContextAttributes(),wr=qe.isContextLost(),lr=xe(qe,he);if(!lr)return null;var cr=_s(),Hr=cv(),tn=lr.extensions,an=hv(qe,tn),un=ya(),on=qe.drawingBufferWidth,kn=qe.drawingBufferHeight,En={tick:0,time:0,viewportWidth:on,viewportHeight:kn,framebufferWidth:on,framebufferHeight:kn,drawingBufferWidth:on,drawingBufferHeight:kn,pixelRatio:he.pixelRatio},Zr={},Vt={elements:null,primitive:4,count:-1,offset:0,instances:-1},tr=ls(qe,tn),Qr=X(qe,Hr,he,qn),zn=tc(qe,tn,Qr,Hr),Er=$e(qe,tn,tr,Hr,Qr,zn,Vt);function qn(ki){return Er.destroyBuffer(ki)}var Bn=gr(qe,cr,Hr,he),pn=Wc(qe,tn,tr,function(){gn.procs.poll()},En,Hr,he),Rr=Hs(qe,tn,tr,Hr,he),mr=ye(qe,tn,tr,pn,Rr,Hr),gn=Vf(qe,cr,tn,tr,Qr,zn,pn,mr,Zr,Er,Bn,Vt,En,an,he),Sn=Vn(qe,mr,gn.procs.poll,En,er,tn,tr),sn=gn.next,In=qe.canvas,Tn=[],ta=[],ji=[],Fn=[he.onDestroy],Dn=null;function Mi(){if(Tn.length===0){an&&an.update(),Dn=null;return}Dn=Ti.next(Mi),Xo();for(var ki=Tn.length-1;ki>=0;--ki){var ca=Tn[ki];ca&&ca(En,null,0)}qe.flush(),an&&an.update()}function qi(){!Dn&&Tn.length>0&&(Dn=Ti.next(Mi))}function Ea(){Dn&&(Ti.cancel(Mi),Dn=null)}function Ao(ki){ki.preventDefault(),wr=!0,Ea(),ta.forEach(function(ca){ca()})}function ns(ki){qe.getError(),wr=!1,lr.restore(),Bn.restore(),Qr.restore(),pn.restore(),Rr.restore(),mr.restore(),Er.restore(),an&&an.restore(),gn.procs.refresh(),qi(),ji.forEach(function(ca){ca()})}var ia=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;!ia&&In&&(In.addEventListener(cp,Ao,!1),In.addEventListener(fp,ns,!1));function Zo(){Tn.length=0,Ea(),!ia&&In&&(In.removeEventListener(cp,Ao),In.removeEventListener(fp,ns)),Bn.clear(),mr.clear(),Rr.clear(),Er.clear(),pn.clear(),zn.clear(),Qr.clear(),an&&an.clear(),Fn.forEach(function(ki){ki()})}function Io(ki){_e(!!ki,"invalid args to regl({...})"),_e.type(ki,"object","invalid args to regl({...})");function ca(st){var ut=Y({},st);delete ut.uniforms,delete ut.attributes,delete ut.context,delete ut.vao,"stencil"in ut&&ut.stencil.op&&(ut.stencil.opBack=ut.stencil.opFront=ut.stencil.op,delete ut.stencil.op);function bt(Se){if(Se in ut){var rt=ut[Se];delete ut[Se],Object.keys(rt).forEach(function(Fe){ut[Se+"."+Fe]=rt[Fe]})}}return bt("blend"),bt("depth"),bt("cull"),bt("stencil"),bt("polygonOffset"),bt("scissor"),bt("sample"),"vao"in st&&(ut.vao=st.vao),ut}function yo(st,ut){var bt={},Se={};return Object.keys(st).forEach(function(rt){var Fe=st[rt];if(fi.isDynamic(Fe)){Se[rt]=fi.unbox(Fe,rt);return}else if(ut&&Array.isArray(Fe)){for(var kt=0;kt<Fe.length;++kt)if(fi.isDynamic(Fe[kt])){Se[rt]=fi.unbox(Fe,rt);return}}bt[rt]=Fe}),{dynamic:Se,static:bt}}var wu=yo(ki.context||{},!0),hu=yo(ki.uniforms||{},!0),Ge=yo(ki.attributes||{},!1),hr=yo(ca(ki),!1),Wt={gpuTime:0,cpuTime:0,count:0},Wn=gn.compile(hr,Ge,hu,wu,Wt),va=Wn.draw,De=Wn.batch,Ee=Wn.scope,it=[];function Bt(st){for(;it.length<st;)it.push(null);return it}function ur(st,ut){var bt;if(wr&&_e.raise("context lost"),typeof st=="function")return Ee.call(this,null,st,0);if(typeof ut=="function")if(typeof st=="number")for(bt=0;bt<st;++bt)Ee.call(this,null,ut,bt);else if(Array.isArray(st))for(bt=0;bt<st.length;++bt)Ee.call(this,st[bt],ut,bt);else return Ee.call(this,st,ut,0);else if(typeof st=="number"){if(st>0)return De.call(this,Bt(st|0),st|0)}else if(Array.isArray(st)){if(st.length)return De.call(this,st,st.length)}else return va.call(this,st)}return Y(ur,{stats:Wt,destroy:function(){Wn.destroy()}})}var Os=mr.setFBO=Io({framebuffer:fi.define.call(null,fh,"framebuffer")});function Is(ki,ca){var yo=0;gn.procs.poll();var wu=ca.color;wu&&(qe.clearColor(+wu[0]||0,+wu[1]||0,+wu[2]||0,+wu[3]||0),yo|=td),"depth"in ca&&(qe.clearDepth(+ca.depth),yo|=pv),"stencil"in ca&&(qe.clearStencil(ca.stencil|0),yo|=dv),_e(!!yo,"called regl.clear with no buffer specified"),qe.clear(yo)}function lu(ki){if(_e(typeof ki=="object"&&ki,"regl.clear() takes an object as input"),"framebuffer"in ki)if(ki.framebuffer&&ki.framebuffer_reglType==="framebufferCube")for(var ca=0;ca<6;++ca)Os(Y({framebuffer:ki.framebuffer.faces[ca]},ki),Is);else Os(ki,Is);else Is(null,ki)}function cu(ki){_e.type(ki,"function","regl.frame() callback must be a function"),Tn.push(ki);function ca(){var yo=Ui(Tn,ki);_e(yo>=0,"cannot cancel a frame twice");function wu(){var hu=Ui(Tn,wu);Tn[hu]=Tn[Tn.length-1],Tn.length-=1,Tn.length<=0&&Ea()}Tn[yo]=wu}return qi(),{cancel:ca}}function fu(){var ki=sn.viewport,ca=sn.scissor_box;ki[0]=ki[1]=ca[0]=ca[1]=0,En.viewportWidth=En.framebufferWidth=En.drawingBufferWidth=ki[2]=ca[2]=qe.drawingBufferWidth,En.viewportHeight=En.framebufferHeight=En.drawingBufferHeight=ki[3]=ca[3]=qe.drawingBufferHeight}function Xo(){En.tick+=1,En.time=Ns(),fu(),gn.procs.poll()}function pa(){pn.refresh(),fu(),gn.procs.refresh(),an&&an.update()}function Ns(){return(ya()-un)/1e3}pa();function Ga(ki,ca){_e.type(ca,"function","listener callback must be a function");var yo;switch(ki){case"frame":return cu(ca);case"lost":yo=ta;break;case"restore":yo=ji;break;case"destroy":yo=Fn;break;default:_e.raise("invalid event, must be one of frame,lost,restore,destroy")}return yo.push(ca),{cancel:function(){for(var hu=0;hu<yo.length;++hu)if(yo[hu]===ca){yo[hu]=yo[yo.length-1],yo.pop();return}}}}var Rs=Y(Io,{clear:lu,prop:fi.define.bind(null,fh),context:fi.define.bind(null,po),this:fi.define.bind(null,hh),draw:Io({}),buffer:function(ca){return Qr.create(ca,$l,!1,!1)},elements:function(ca){return zn.create(ca,!1)},texture:pn.create2D,cube:pn.createCube,renderbuffer:Rr.create,framebuffer:mr.create,framebufferCube:mr.createCube,vao:Er.createVAO,attributes:er,frame:cu,on:Ga,limits:tr,hasExtension:function(ca){return tr.extensions.indexOf(ca.toLowerCase())>=0},read:Sn,destroy:Zo,_gl:qe,_refresh:pa,poll:function(){Xo(),an&&an.update()},now:Ns,stats:Hr});return he.onDone(null,Rs),Rs}return xf})},Sk89:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.postConstruct=void 0;var j=M("MON2"),Z=M("xfSm"),Y=M("GXnB");function k(){return function(h,V,H){var te=new Y.Metadata(Z.POST_CONSTRUCT,V);if(Reflect.hasOwnMetadata(Z.POST_CONSTRUCT,h.constructor))throw new Error(j.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(Z.POST_CONSTRUCT,te,h.constructor)}}$.postConstruct=k},SksO:function(le,$){function M(j,Z){return le.exports=M=Object.setPrototypeOf||function(k,h){return k.__proto__=h,k},le.exports.__esModule=!0,le.exports.default=le.exports,M(j,Z)}le.exports=M,le.exports.__esModule=!0,le.exports.default=le.exports},Sq3C:function(le,$,M){var j=M("sKgW"),Z=M("zoYe"),Y=M("wy8a"),k=M("quyA"),h=M("Z1HP"),V=M("Em2t"),H=Math.ceil;function te(pe,Oe){Oe=Oe===void 0?" ":Z(Oe);var Ae=Oe.length;if(Ae<2)return Ae?j(Oe,pe):Oe;var vt=j(Oe,H(pe/h(Oe)));return k(Oe)?Y(V(vt),0,pe).join(""):vt.slice(0,pe)}le.exports=te},Sxd8:function(le,$,M){var j=M("ZCgT");function Z(Y){var k=j(Y),h=k%1;return k===k?h?k-h:k:0}le.exports=Z},T1AV:function(le,$,M){var j=M("t2Dn"),Z=M("5Tg0"),Y=M("yP5f"),k=M("Q1l4"),h=M("+iFO"),V=M("03A+"),H=M("Z0cm"),te=M("3L66"),pe=M("DSRE"),Oe=M("lSCD"),Ae=M("GoyQ"),vt=M("YO3V"),at=M("c6wG"),gt=M("itsj"),yt=M("jeLo");function St(He,dt,ct,_t,ee,rr,Fr){var Mr=gt(He,ct),Nt=gt(dt,ct),ze=Fr.get(Nt);if(ze){j(He,ct,ze);return}var zt=rr?rr(Mr,Nt,ct+"",He,dt,Fr):void 0,Kt=zt===void 0;if(Kt){var vr=H(Nt),jr=!vr&&pe(Nt),vn=!vr&&!jr&&at(Nt);zt=Nt,vr||jr||vn?H(Mr)?zt=Mr:te(Mr)?zt=k(Mr):jr?(Kt=!1,zt=Z(Nt,!0)):vn?(Kt=!1,zt=Y(Nt,!0)):zt=[]:vt(Nt)||V(Nt)?(zt=Mr,V(Mr)?zt=yt(Mr):(!Ae(Mr)||Oe(Mr))&&(zt=h(Nt))):Kt=!1}Kt&&(Fr.set(Nt,zt),ee(zt,Nt,_t,rr,Fr),Fr.delete(Nt)),j(He,ct,zt)}le.exports=St},TIQr:function(le,$,M){"use strict";le.exports=Z,le.exports.default=Z;var j=1e20;function Z(H,te,pe,Oe,Ae,vt){this.fontSize=H||24,this.buffer=te===void 0?3:te,this.cutoff=Oe||.25,this.fontFamily=Ae||"sans-serif",this.fontWeight=vt||"normal",this.radius=pe||8;var at=this.size=this.fontSize+this.buffer*2,gt=at+this.buffer*2,yt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;yt?this.canvas=my.createOffscreenCanvas(at,at,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=at),this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(gt*gt),this.gridInner=new Float64Array(gt*gt),this.f=new Float64Array(gt),this.z=new Float64Array(gt+1),this.v=new Uint16Array(gt),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,yt?this.middle=Math.round(at/2*1):this.middle=Math.round(at/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Y(H,te,pe,Oe,Ae,vt,at){vt.fill(j,0,te*pe),at.fill(0,0,te*pe);for(var gt=(te-Oe)/2,yt=0;yt<Ae;yt++)for(var St=0;St<Oe;St++){var He=(yt+gt)*te+St+gt,dt=H.data[4*(yt*Oe+St)+3]/255;if(dt===1)vt[He]=0,at[He]=j;else if(dt===0)vt[He]=j,at[He]=0;else{var ct=Math.max(0,.5-dt),_t=Math.max(0,dt-.5);vt[He]=ct*ct,at[He]=_t*_t}}}function k(H,te,pe,Oe,Ae,vt,at){for(var gt=0;gt<te*pe;gt++){var yt=Math.sqrt(Oe[gt])-Math.sqrt(Ae[gt]);H[gt]=Math.round(255-255*(yt/vt+at))}}Z.prototype._draw=function(H,te){var pe=this.ctx.measureText(H),Oe=pe.width,Ae=2*this.buffer,vt,at,gt,yt,St,He,dt,ct;te&&this.useMetrics?(St=Math.floor(pe.actualBoundingBoxAscent),ct=this.buffer+Math.ceil(pe.actualBoundingBoxAscent),He=this.buffer,dt=this.buffer,at=Math.min(this.size,Math.ceil(pe.actualBoundingBoxRight-pe.actualBoundingBoxLeft)),yt=Math.min(this.size-He,Math.ceil(pe.actualBoundingBoxAscent+pe.actualBoundingBoxDescent)),vt=at+Ae,gt=yt+Ae,this.ctx.textBaseline="alphabetic"):(vt=at=this.size,gt=yt=this.size,St=19*this.fontSize/24,He=dt=0,ct=this.middle,this.ctx.textBaseline="middle");var _t;at&&yt&&(this.ctx.clearRect(dt,He,at,yt),this.ctx.fillText(H,this.buffer,ct),_t=this.ctx.getImageData(dt,He,at,yt));var ee=new Uint8ClampedArray(vt*gt);return Y(_t,vt,gt,at,yt,this.gridOuter,this.gridInner),h(this.gridOuter,vt,gt,this.f,this.v,this.z),h(this.gridInner,vt,gt,this.f,this.v,this.z),k(ee,vt,gt,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:ee,metrics:{width:at,height:yt,sdfWidth:vt,sdfHeight:gt,top:St,left:0,advance:Oe}}},Z.prototype.draw=function(H){return this._draw(H,!1).data},Z.prototype.drawWithMetrics=function(H){return this._draw(H,!0)};function h(H,te,pe,Oe,Ae,vt){for(var at=0;at<te;at++)V(H,at,te,pe,Oe,Ae,vt);for(var gt=0;gt<pe;gt++)V(H,gt*te,1,te,Oe,Ae,vt)}function V(H,te,pe,Oe,Ae,vt,at){var gt,yt,St,He;for(vt[0]=0,at[0]=-j,at[1]=j,gt=0;gt<Oe;gt++)Ae[gt]=H[te+gt*pe];for(gt=1,yt=0,St=0;gt<Oe;gt++){do He=vt[yt],St=(Ae[gt]-Ae[He]+gt*gt-He*He)/(gt-He)/2;while(St<=at[yt]&&--yt>-1);yt++,vt[yt]=gt,at[yt]=St,at[yt+1]=j}for(gt=0,yt=0;gt<Oe;gt++){for(;at[yt+1]<gt;)yt++;He=vt[yt],H[te+gt*pe]=Ae[He]+(gt-He)*(gt-He)}}},TKrE:function(le,$,M){var j=M("qRkn"),Z=M("dt0z"),Y=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,k="\\u0300-\\u036f",h="\\ufe20-\\ufe2f",V="\\u20d0-\\u20ff",H=k+h+V,te="["+H+"]",pe=RegExp(te,"g");function Oe(Ae){return Ae=Z(Ae),Ae&&Ae.replace(Y,j).replace(pe,"")}le.exports=Oe},"U+yc":function(le,$){function M(j,Z,Y,k,h){var V={};return Object.keys(k).forEach(function(H){V[H]=k[H]}),V.enumerable=!!V.enumerable,V.configurable=!!V.configurable,("value"in V||V.initializer)&&(V.writable=!0),V=Y.slice().reverse().reduce(function(H,te){return te(j,Z,H)||H},V),h&&V.initializer!==void 0&&(V.value=V.initializer?V.initializer.call(h):void 0,V.initializer=void 0),V.initializer===void 0&&(Object.defineProperty(j,Z,V),V=null),V}le.exports=M,le.exports.__esModule=!0,le.exports.default=le.exports},UB5X:function(le,$,M){var j=M("NykK"),Z=M("ExA7"),Y="[object Number]";function k(h){return typeof h=="number"||Z(h)&&j(h)==Y}le.exports=k},Ucsi:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0});var j=Symbol.for("INJECTION");function Z(H,te,pe,Oe){function Ae(){return Oe&&!Reflect.hasMetadata(j,this,te)&&Reflect.defineMetadata(j,pe(),this,te),Reflect.hasMetadata(j,this,te)?Reflect.getMetadata(j,this,te):pe()}function vt(at){Reflect.defineMetadata(j,at,this,te)}Object.defineProperty(H,te,{configurable:!0,enumerable:!0,get:Ae,set:vt})}function Y(H,te){return function(pe){return function(Oe,Ae){var vt=function(){return H.get(pe)};Z(Oe,Ae,vt,te)}}}$.makePropertyInjectDecorator=Y;function k(H,te){return function(pe,Oe){return function(Ae,vt){var at=function(){return H.getNamed(pe,Oe)};Z(Ae,vt,at,te)}}}$.makePropertyInjectNamedDecorator=k;function h(H,te){return function(pe,Oe,Ae){return function(vt,at){var gt=function(){return H.getTagged(pe,Oe,Ae)};Z(vt,at,gt,te)}}}$.makePropertyInjectTaggedDecorator=h;function V(H,te){return function(pe){return function(Oe,Ae){var vt=function(){return H.getAll(pe)};Z(Oe,Ae,vt,te)}}}$.makePropertyMultiInjectDecorator=V},VOtZ:function(le,$,M){var j=M("juv8"),Z=M("MvSz");function Y(k,h){return j(k,Z(k),h)}le.exports=Y},VmRL:function(le,$,M){"use strict";le.exports=j,le.exports.default=j;function j(be,Ne,Ie){Ie=Ie||2;var pt=Ne&&Ne.length,mt=pt?Ne[0]*Ie:be.length,Dt=Z(be,0,mt,Ie,!0),w=[];if(!Dt||Dt.next===Dt.prev)return w;var br,Ut,Xt,It,Lt,ir,Ar;if(pt&&(Dt=pe(be,Ne,Dt,Ie)),be.length>80*Ie){br=Xt=be[0],Ut=It=be[1];for(var nr=Ie;nr<mt;nr+=Ie)Lt=be[nr],ir=be[nr+1],Lt<br&&(br=Lt),ir<Ut&&(Ut=ir),Lt>Xt&&(Xt=Lt),ir>It&&(It=ir);Ar=Math.max(Xt-br,It-Ut),Ar=Ar!==0?1/Ar:0}return k(Dt,w,Ie,br,Ut,Ar),w}function Z(be,Ne,Ie,pt,mt){var Dt,w;if(mt===kr(be,Ne,Ie,pt)>0)for(Dt=Ne;Dt<Ie;Dt+=pt)w=vr(Dt,be[Dt],be[Dt+1],w);else for(Dt=Ie-pt;Dt>=Ne;Dt-=pt)w=vr(Dt,be[Dt],be[Dt+1],w);return w&&ee(w,w.next)&&(jr(w),w=w.next),w}function Y(be,Ne){if(!be)return be;Ne||(Ne=be);var Ie=be,pt;do if(pt=!1,!Ie.steiner&&(ee(Ie,Ie.next)||_t(Ie.prev,Ie,Ie.next)===0)){if(jr(Ie),Ie=Ne=Ie.prev,Ie===Ie.next)break;pt=!0}else Ie=Ie.next;while(pt||Ie!==Ne);return Ne}function k(be,Ne,Ie,pt,mt,Dt,w){if(!!be){!w&&Dt&&gt(be,pt,mt,Dt);for(var br=be,Ut,Xt;be.prev!==be.next;){if(Ut=be.prev,Xt=be.next,Dt?V(be,pt,mt,Dt):h(be)){Ne.push(Ut.i/Ie),Ne.push(be.i/Ie),Ne.push(Xt.i/Ie),jr(be),be=Xt.next,br=Xt.next;continue}if(be=Xt,be===br){w?w===1?(be=H(Y(be),Ne,Ie),k(be,Ne,Ie,pt,mt,Dt,2)):w===2&&te(be,Ne,Ie,pt,mt,Dt):k(Y(be),Ne,Ie,pt,mt,Dt,1);break}}}}function h(be){var Ne=be.prev,Ie=be,pt=be.next;if(_t(Ne,Ie,pt)>=0)return!1;for(var mt=be.next.next;mt!==be.prev;){if(dt(Ne.x,Ne.y,Ie.x,Ie.y,pt.x,pt.y,mt.x,mt.y)&&_t(mt.prev,mt,mt.next)>=0)return!1;mt=mt.next}return!0}function V(be,Ne,Ie,pt){var mt=be.prev,Dt=be,w=be.next;if(_t(mt,Dt,w)>=0)return!1;for(var br=mt.x<Dt.x?mt.x<w.x?mt.x:w.x:Dt.x<w.x?Dt.x:w.x,Ut=mt.y<Dt.y?mt.y<w.y?mt.y:w.y:Dt.y<w.y?Dt.y:w.y,Xt=mt.x>Dt.x?mt.x>w.x?mt.x:w.x:Dt.x>w.x?Dt.x:w.x,It=mt.y>Dt.y?mt.y>w.y?mt.y:w.y:Dt.y>w.y?Dt.y:w.y,Lt=St(br,Ut,Ne,Ie,pt),ir=St(Xt,It,Ne,Ie,pt),Ar=be.prevZ,nr=be.nextZ;Ar&&Ar.z>=Lt&&nr&&nr.z<=ir;){if(Ar!==be.prev&&Ar!==be.next&&dt(mt.x,mt.y,Dt.x,Dt.y,w.x,w.y,Ar.x,Ar.y)&&_t(Ar.prev,Ar,Ar.next)>=0||(Ar=Ar.prevZ,nr!==be.prev&&nr!==be.next&&dt(mt.x,mt.y,Dt.x,Dt.y,w.x,w.y,nr.x,nr.y)&&_t(nr.prev,nr,nr.next)>=0))return!1;nr=nr.nextZ}for(;Ar&&Ar.z>=Lt;){if(Ar!==be.prev&&Ar!==be.next&&dt(mt.x,mt.y,Dt.x,Dt.y,w.x,w.y,Ar.x,Ar.y)&&_t(Ar.prev,Ar,Ar.next)>=0)return!1;Ar=Ar.prevZ}for(;nr&&nr.z<=ir;){if(nr!==be.prev&&nr!==be.next&&dt(mt.x,mt.y,Dt.x,Dt.y,w.x,w.y,nr.x,nr.y)&&_t(nr.prev,nr,nr.next)>=0)return!1;nr=nr.nextZ}return!0}function H(be,Ne,Ie){var pt=be;do{var mt=pt.prev,Dt=pt.next.next;!ee(mt,Dt)&&rr(mt,pt,pt.next,Dt)&&ze(mt,Dt)&&ze(Dt,mt)&&(Ne.push(mt.i/Ie),Ne.push(pt.i/Ie),Ne.push(Dt.i/Ie),jr(pt),jr(pt.next),pt=be=Dt),pt=pt.next}while(pt!==be);return Y(pt)}function te(be,Ne,Ie,pt,mt,Dt){var w=be;do{for(var br=w.next.next;br!==w.prev;){if(w.i!==br.i&&ct(w,br)){var Ut=Kt(w,br);w=Y(w,w.next),Ut=Y(Ut,Ut.next),k(w,Ne,Ie,pt,mt,Dt),k(Ut,Ne,Ie,pt,mt,Dt);return}br=br.next}w=w.next}while(w!==be)}function pe(be,Ne,Ie,pt){var mt=[],Dt,w,br,Ut,Xt;for(Dt=0,w=Ne.length;Dt<w;Dt++)br=Ne[Dt]*pt,Ut=Dt<w-1?Ne[Dt+1]*pt:be.length,Xt=Z(be,br,Ut,pt,!1),Xt===Xt.next&&(Xt.steiner=!0),mt.push(He(Xt));for(mt.sort(Oe),Dt=0;Dt<mt.length;Dt++)Ie=Ae(mt[Dt],Ie),Ie=Y(Ie,Ie.next);return Ie}function Oe(be,Ne){return be.x-Ne.x}function Ae(be,Ne){var Ie=vt(be,Ne);if(!Ie)return Ne;var pt=Kt(Ie,be),mt=Y(Ie,Ie.next);return Y(pt,pt.next),Ne===Ie?mt:Ne}function vt(be,Ne){var Ie=Ne,pt=be.x,mt=be.y,Dt=-Infinity,w;do{if(mt<=Ie.y&&mt>=Ie.next.y&&Ie.next.y!==Ie.y){var br=Ie.x+(mt-Ie.y)*(Ie.next.x-Ie.x)/(Ie.next.y-Ie.y);if(br<=pt&&br>Dt){if(Dt=br,br===pt){if(mt===Ie.y)return Ie;if(mt===Ie.next.y)return Ie.next}w=Ie.x<Ie.next.x?Ie:Ie.next}}Ie=Ie.next}while(Ie!==Ne);if(!w)return null;if(pt===Dt)return w;var Ut=w,Xt=w.x,It=w.y,Lt=Infinity,ir;Ie=w;do pt>=Ie.x&&Ie.x>=Xt&&pt!==Ie.x&&dt(mt<It?pt:Dt,mt,Xt,It,mt<It?Dt:pt,mt,Ie.x,Ie.y)&&(ir=Math.abs(mt-Ie.y)/(pt-Ie.x),ze(Ie,be)&&(ir<Lt||ir===Lt&&(Ie.x>w.x||Ie.x===w.x&&at(w,Ie)))&&(w=Ie,Lt=ir)),Ie=Ie.next;while(Ie!==Ut);return w}function at(be,Ne){return _t(be.prev,be,Ne.prev)<0&&_t(Ne.next,be,be.next)<0}function gt(be,Ne,Ie,pt){var mt=be;do mt.z===null&&(mt.z=St(mt.x,mt.y,Ne,Ie,pt)),mt.prevZ=mt.prev,mt.nextZ=mt.next,mt=mt.next;while(mt!==be);mt.prevZ.nextZ=null,mt.prevZ=null,yt(mt)}function yt(be){var Ne,Ie,pt,mt,Dt,w,br,Ut,Xt=1;do{for(Ie=be,be=null,Dt=null,w=0;Ie;){for(w++,pt=Ie,br=0,Ne=0;Ne<Xt&&(br++,pt=pt.nextZ,!!pt);Ne++);for(Ut=Xt;br>0||Ut>0&&pt;)br!==0&&(Ut===0||!pt||Ie.z<=pt.z)?(mt=Ie,Ie=Ie.nextZ,br--):(mt=pt,pt=pt.nextZ,Ut--),Dt?Dt.nextZ=mt:be=mt,mt.prevZ=Dt,Dt=mt;Ie=pt}Dt.nextZ=null,Xt*=2}while(w>1);return be}function St(be,Ne,Ie,pt,mt){return be=32767*(be-Ie)*mt,Ne=32767*(Ne-pt)*mt,be=(be|be<<8)&16711935,be=(be|be<<4)&252645135,be=(be|be<<2)&858993459,be=(be|be<<1)&1431655765,Ne=(Ne|Ne<<8)&16711935,Ne=(Ne|Ne<<4)&252645135,Ne=(Ne|Ne<<2)&858993459,Ne=(Ne|Ne<<1)&1431655765,be|Ne<<1}function He(be){var Ne=be,Ie=be;do(Ne.x<Ie.x||Ne.x===Ie.x&&Ne.y<Ie.y)&&(Ie=Ne),Ne=Ne.next;while(Ne!==be);return Ie}function dt(be,Ne,Ie,pt,mt,Dt,w,br){return(mt-w)*(Ne-br)-(be-w)*(Dt-br)>=0&&(be-w)*(pt-br)-(Ie-w)*(Ne-br)>=0&&(Ie-w)*(Dt-br)-(mt-w)*(pt-br)>=0}function ct(be,Ne){return be.next.i!==Ne.i&&be.prev.i!==Ne.i&&!Nt(be,Ne)&&(ze(be,Ne)&&ze(Ne,be)&&zt(be,Ne)&&(_t(be.prev,be,Ne.prev)||_t(be,Ne.prev,Ne))||ee(be,Ne)&&_t(be.prev,be,be.next)>0&&_t(Ne.prev,Ne,Ne.next)>0)}function _t(be,Ne,Ie){return(Ne.y-be.y)*(Ie.x-Ne.x)-(Ne.x-be.x)*(Ie.y-Ne.y)}function ee(be,Ne){return be.x===Ne.x&&be.y===Ne.y}function rr(be,Ne,Ie,pt){var mt=Mr(_t(be,Ne,Ie)),Dt=Mr(_t(be,Ne,pt)),w=Mr(_t(Ie,pt,be)),br=Mr(_t(Ie,pt,Ne));return!!(mt!==Dt&&w!==br||mt===0&&Fr(be,Ie,Ne)||Dt===0&&Fr(be,pt,Ne)||w===0&&Fr(Ie,be,pt)||br===0&&Fr(Ie,Ne,pt))}function Fr(be,Ne,Ie){return Ne.x<=Math.max(be.x,Ie.x)&&Ne.x>=Math.min(be.x,Ie.x)&&Ne.y<=Math.max(be.y,Ie.y)&&Ne.y>=Math.min(be.y,Ie.y)}function Mr(be){return be>0?1:be<0?-1:0}function Nt(be,Ne){var Ie=be;do{if(Ie.i!==be.i&&Ie.next.i!==be.i&&Ie.i!==Ne.i&&Ie.next.i!==Ne.i&&rr(Ie,Ie.next,be,Ne))return!0;Ie=Ie.next}while(Ie!==be);return!1}function ze(be,Ne){return _t(be.prev,be,be.next)<0?_t(be,Ne,be.next)>=0&&_t(be,be.prev,Ne)>=0:_t(be,Ne,be.prev)<0||_t(be,be.next,Ne)<0}function zt(be,Ne){var Ie=be,pt=!1,mt=(be.x+Ne.x)/2,Dt=(be.y+Ne.y)/2;do Ie.y>Dt!=Ie.next.y>Dt&&Ie.next.y!==Ie.y&&mt<(Ie.next.x-Ie.x)*(Dt-Ie.y)/(Ie.next.y-Ie.y)+Ie.x&&(pt=!pt),Ie=Ie.next;while(Ie!==be);return pt}function Kt(be,Ne){var Ie=new vn(be.i,be.x,be.y),pt=new vn(Ne.i,Ne.x,Ne.y),mt=be.next,Dt=Ne.prev;return be.next=Ne,Ne.prev=be,Ie.next=mt,mt.prev=Ie,pt.next=Ie,Ie.prev=pt,Dt.next=pt,pt.prev=Dt,pt}function vr(be,Ne,Ie,pt){var mt=new vn(be,Ne,Ie);return pt?(mt.next=pt.next,mt.prev=pt,pt.next.prev=mt,pt.next=mt):(mt.prev=mt,mt.next=mt),mt}function jr(be){be.next.prev=be.prev,be.prev.next=be.next,be.prevZ&&(be.prevZ.nextZ=be.nextZ),be.nextZ&&(be.nextZ.prevZ=be.prevZ)}function vn(be,Ne,Ie){this.i=be,this.x=Ne,this.y=Ie,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}j.deviation=function(be,Ne,Ie,pt){var mt=Ne&&Ne.length,Dt=mt?Ne[0]*Ie:be.length,w=Math.abs(kr(be,0,Dt,Ie));if(mt)for(var br=0,Ut=Ne.length;br<Ut;br++){var Xt=Ne[br]*Ie,It=br<Ut-1?Ne[br+1]*Ie:be.length;w-=Math.abs(kr(be,Xt,It,Ie))}var Lt=0;for(br=0;br<pt.length;br+=3){var ir=pt[br]*Ie,Ar=pt[br+1]*Ie,nr=pt[br+2]*Ie;Lt+=Math.abs((be[ir]-be[nr])*(be[Ar+1]-be[ir+1])-(be[ir]-be[Ar])*(be[nr+1]-be[ir+1]))}return w===0&&Lt===0?0:Math.abs((Lt-w)/w)};function kr(be,Ne,Ie,pt){for(var mt=0,Dt=Ne,w=Ie-pt;Dt<Ie;Dt+=pt)mt+=(be[w]-be[Dt])*(be[Dt+1]+be[w+1]),w=Dt;return mt}j.flatten=function(be){for(var Ne=be[0][0].length,Ie={vertices:[],holes:[],dimensions:Ne},pt=0,mt=0;mt<be.length;mt++){for(var Dt=0;Dt<be[mt].length;Dt++)for(var w=0;w<Ne;w++)Ie.vertices.push(be[mt][Dt][w]);mt>0&&(pt+=be[mt-1].length,Ie.holes.push(pt))}return Ie}},W8MJ:function(le,$){function M(Z,Y){for(var k=0;k<Y.length;k++){var h=Y[k];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(Z,h.key,h)}}function j(Z,Y,k){return Y&&M(Z.prototype,Y),k&&M(Z,k),Object.defineProperty(Z,"prototype",{writable:!1}),Z}le.exports=j,le.exports.__esModule=!0,le.exports.default=le.exports},WwFo:function(le,$,M){var j=M("juv8"),Z=M("7GkX");function Y(k,h){return k&&j(h,Z(h),k)}le.exports=Y},XYm9:function(le,$,M){var j=M("+K+b");function Z(Y,k){var h=k?j(Y.buffer):Y.buffer;return new Y.constructor(h,Y.byteOffset,Y.byteLength)}le.exports=Z},"Xt/L":function(le,$){function M(j,Z,Y){for(var k=-1,h=j==null?0:j.length;++k<h;)if(Y(Z,j[k]))return!0;return!1}le.exports=M},YO3V:function(le,$,M){var j=M("NykK"),Z=M("LcsW"),Y=M("ExA7"),k="[object Object]",h=Function.prototype,V=Object.prototype,H=h.toString,te=V.hasOwnProperty,pe=H.call(Object);function Oe(Ae){if(!Y(Ae)||j(Ae)!=k)return!1;var vt=Z(Ae);if(vt===null)return!0;var at=te.call(vt,"constructor")&&vt.constructor;return typeof at=="function"&&at instanceof at&&H.call(at)==pe}le.exports=Oe},Yk9n:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.inject=$.LazyServiceIdentifer=void 0;var j=M("MON2"),Z=M("xfSm"),Y=M("GXnB"),k=M("Ztfv"),h=function(){function H(te){this._cb=te}return H.prototype.unwrap=function(){return this._cb()},H}();$.LazyServiceIdentifer=h;function V(H){return function(te,pe,Oe){if(H===void 0)throw new Error(j.UNDEFINED_INJECT_ANNOTATION(te.name));var Ae=new Y.Metadata(Z.INJECT_TAG,H);typeof Oe=="number"?k.tagParameter(te,pe,Oe,Ae):k.tagProperty(te,pe,Ae)}}$.inject=V},Z1HP:function(le,$,M){var j=M("ycre"),Z=M("quyA"),Y=M("q4HE");function k(h){return Z(h)?Y(h):j(h)}le.exports=k},ZCgT:function(le,$,M){var j=M("tLB3"),Z=1/0,Y=17976931348623157e292;function k(h){if(!h)return h===0?h:0;if(h=j(h),h===Z||h===-Z){var V=h<0?-1:1;return V*Y}return h===h?h:0}le.exports=k},ZK94:function(le,$){le.exports.RADIUS=6378137,le.exports.FLATTENING=1/298.257223563,le.exports.POLAR_RADIUS=63567523142e-4},Ztfv:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.tagProperty=$.tagParameter=$.decorate=void 0;var j=M("MON2"),Z=M("xfSm");function Y(pe,Oe,Ae,vt){var at=Z.TAGGED;h(at,pe,Oe,vt,Ae)}$.tagParameter=Y;function k(pe,Oe,Ae){var vt=Z.TAGGED_PROP;h(vt,pe.constructor,Oe,Ae)}$.tagProperty=k;function h(pe,Oe,Ae,vt,at){var gt={},yt=typeof at=="number",St=at!==void 0&&yt?at.toString():Ae;if(yt&&Ae!==void 0)throw new Error(j.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(pe,Oe)&&(gt=Reflect.getMetadata(pe,Oe));var He=gt[St];if(!Array.isArray(He))He=[];else for(var dt=0,ct=He;dt<ct.length;dt++){var _t=ct[dt];if(_t.key===vt.key)throw new Error(j.DUPLICATED_METADATA+" "+_t.key.toString())}He.push(vt),gt[St]=He,Reflect.defineMetadata(pe,gt,Oe)}function V(pe,Oe){Reflect.decorate(pe,Oe)}function H(pe,Oe){return function(Ae,vt){Oe(Ae,vt,pe)}}function te(pe,Oe,Ae){typeof Ae=="number"?V([H(Ae,pe)],Oe):typeof Ae=="string"?Reflect.decorate([pe],Oe,Ae):V([pe],Oe)}$.decorate=te},ZzCi:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.named=void 0;var j=M("xfSm"),Z=M("GXnB"),Y=M("Ztfv");function k(h){return function(V,H,te){var pe=new Z.Metadata(j.NAMED_TAG,h);typeof te=="number"?Y.tagParameter(V,H,te,pe):Y.tagProperty(V,H,pe)}}$.named=k},a1gu:function(le,$,M){var j=M("cDf5").default,Z=M("PJYZ");function Y(k,h){if(h&&(j(h)==="object"||typeof h=="function"))return h;if(h!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Z(k)}le.exports=Y,le.exports.__esModule=!0,le.exports.default=le.exports},aHsQ:function(le,$,M){"use strict";var j=M("EFp3"),Z=M.n(j),Y=M("6D9b"),k=M.n(Y),h=M("cWXX")},aPG5:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.resolve=void 0;var j=M("MON2"),Z=M("FV85"),Y=M("qK8v"),k=M("ujMp"),h=M("cSJO"),V=function(Oe,Ae,vt){try{return vt()}catch(at){throw Y.isStackOverflowExeption(at)?new Error(j.CIRCULAR_DEPENDENCY_IN_FACTORY(Oe,Ae.toString())):at}},H=function pe(Oe){return function(Ae){Ae.parentContext.setCurrentRequest(Ae);var vt=Ae.bindings,at=Ae.childRequests,gt=Ae.target&&Ae.target.isArray(),yt=!Ae.parentRequest||!Ae.parentRequest.target||!Ae.target||!Ae.parentRequest.target.matchesArray(Ae.target.serviceIdentifier);if(gt&&yt)return at.map(function(ee){var rr=pe(Oe);return rr(ee)});var St=null;if(Ae.target.isOptional()&&vt.length===0)return;var He=vt[0],dt=He.scope===Z.BindingScopeEnum.Singleton,ct=He.scope===Z.BindingScopeEnum.Request;if(dt&&He.activated)return He.cache;if(ct&&Oe!==null&&Oe.has(He.id))return Oe.get(He.id);if(He.type===Z.BindingTypeEnum.ConstantValue)St=He.cache,He.activated=!0;else if(He.type===Z.BindingTypeEnum.Function)St=He.cache,He.activated=!0;else if(He.type===Z.BindingTypeEnum.Constructor)St=He.implementationType;else if(He.type===Z.BindingTypeEnum.DynamicValue&&He.dynamicValue!==null)St=V("toDynamicValue",He.serviceIdentifier,function(){return He.dynamicValue(Ae.parentContext)});else if(He.type===Z.BindingTypeEnum.Factory&&He.factory!==null)St=V("toFactory",He.serviceIdentifier,function(){return He.factory(Ae.parentContext)});else if(He.type===Z.BindingTypeEnum.Provider&&He.provider!==null)St=V("toProvider",He.serviceIdentifier,function(){return He.provider(Ae.parentContext)});else if(He.type===Z.BindingTypeEnum.Instance&&He.implementationType!==null)St=h.resolveInstance(He.implementationType,at,pe(Oe));else{var _t=k.getServiceIdentifierAsString(Ae.serviceIdentifier);throw new Error(j.INVALID_BINDING_TYPE+" "+_t)}return typeof He.onActivation=="function"&&(St=He.onActivation(Ae.parentContext,St)),dt&&(He.cache=St,He.activated=!0),ct&&Oe!==null&&!Oe.has(He.id)&&Oe.set(He.id,St),St}};function te(pe){var Oe=H(pe.plan.rootRequest.requestScope);return Oe(pe.plan.rootRequest)}$.resolve=te},asDA:function(le,$){function M(j,Z,Y,k){var h=-1,V=j==null?0:j.length;for(k&&V&&(Y=j[++h]);++h<V;)Y=Z(Y,j[h],h,j);return Y}le.exports=M},b2z7:function(le,$){var M=/\w*$/;function j(Z){var Y=new Z.constructor(Z.source,M.exec(Z));return Y.lastIndex=Z.lastIndex,Y}le.exports=j},b48C:function(le,$){function M(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(j){return!1}}le.exports=M,le.exports.__esModule=!0,le.exports.default=le.exports},bahg:function(le,$){function M(j){return j.split("")}le.exports=M},cSJO:function(le,$,M){"use strict";var j=this&&this.__spreadArray||function(pe,Oe){for(var Ae=0,vt=Oe.length,at=pe.length;Ae<vt;Ae++,at++)pe[at]=Oe[Ae];return pe};Object.defineProperty($,"__esModule",{value:!0}),$.resolveInstance=void 0;var Z=M("MON2"),Y=M("FV85"),k=M("xfSm");function h(pe,Oe,Ae){var vt=Oe.filter(function(gt){return gt.target!==null&&gt.target.type===Y.TargetTypeEnum.ClassProperty}),at=vt.map(Ae);return vt.forEach(function(gt,yt){var St="";St=gt.target.name.value();var He=at[yt];pe[St]=He}),pe}function V(pe,Oe){return new(pe.bind.apply(pe,j([void 0],Oe)))}function H(pe,Oe){if(Reflect.hasMetadata(k.POST_CONSTRUCT,pe)){var Ae=Reflect.getMetadata(k.POST_CONSTRUCT,pe);try{Oe[Ae.value]()}catch(vt){throw new Error(Z.POST_CONSTRUCT_ERROR(pe.name,vt.message))}}}function te(pe,Oe,Ae){var vt=null;if(Oe.length>0){var at=Oe.filter(function(yt){return yt.target!==null&&yt.target.type===Y.TargetTypeEnum.ConstructorArgument}),gt=at.map(Ae);vt=V(pe,gt),vt=h(vt,Oe,Ae)}else vt=new pe;return H(pe,vt),vt}$.resolveInstance=te},cWXX:function(le,$,M){"use strict";var j=M("EFp3"),Z=M.n(j),Y=M("oIFs"),k=M.n(Y)},cZ5Q:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.injectable=void 0;var j=M("MON2"),Z=M("xfSm");function Y(){return function(k){if(Reflect.hasOwnMetadata(Z.PARAM_TYPES,k))throw new Error(j.DUPLICATED_INJECTABLE_DECORATOR);var h=Reflect.getMetadata(Z.DESIGN_PARAM_TYPES,k)||[];return Reflect.defineMetadata(Z.PARAM_TYPES,h,k),k}}$.injectable=Y},"cq/+":function(le,$,M){var j=M("mc0g"),Z=j();le.exports=Z},cvCv:function(le,$){function M(j){return function(){return j}}le.exports=M},d9O0:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.id=void 0;var j=0;function Z(){return j++}$.id=Z},dQpi:function(le,$,M){var j=M("yGk4"),Z=M("vN+2"),Y=M("rEGp"),k=1/0,h=j&&1/Y(new j([,-0]))[1]==k?function(V){return new j(V)}:Z;le.exports=h},dTAl:function(le,$,M){var j=M("GoyQ"),Z=Object.create,Y=function(){function k(){}return function(h){if(!j(h))return{};if(Z)return Z(h);k.prototype=h;var V=new k;return k.prototype=void 0,V}}();le.exports=Y},dVn5:function(le,$){var M=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function j(Z){return Z.match(M)||[]}le.exports=j},dX1H:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Target=void 0;var j=M("xfSm"),Z=M("d9O0"),Y=M("GXnB"),k=M("zxMA"),h=function(){function V(H,te,pe,Oe){this.id=Z.id(),this.type=H,this.serviceIdentifier=pe,this.name=new k.QueryableString(te||""),this.metadata=new Array;var Ae=null;typeof Oe=="string"?Ae=new Y.Metadata(j.NAMED_TAG,Oe):Oe instanceof Y.Metadata&&(Ae=Oe),Ae!==null&&this.metadata.push(Ae)}return V.prototype.hasTag=function(H){for(var te=0,pe=this.metadata;te<pe.length;te++){var Oe=pe[te];if(Oe.key===H)return!0}return!1},V.prototype.isArray=function(){return this.hasTag(j.MULTI_INJECT_TAG)},V.prototype.matchesArray=function(H){return this.matchesTag(j.MULTI_INJECT_TAG)(H)},V.prototype.isNamed=function(){return this.hasTag(j.NAMED_TAG)},V.prototype.isTagged=function(){return this.metadata.some(function(H){return j.NON_CUSTOM_TAG_KEYS.every(function(te){return H.key!==te})})},V.prototype.isOptional=function(){return this.matchesTag(j.OPTIONAL_TAG)(!0)},V.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(H){return H.key===j.NAMED_TAG})[0]:null},V.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(H){return j.NON_CUSTOM_TAG_KEYS.every(function(te){return H.key!==te})}):null},V.prototype.matchesNamedTag=function(H){return this.matchesTag(j.NAMED_TAG)(H)},V.prototype.matchesTag=function(H){var te=this;return function(pe){for(var Oe=0,Ae=te.metadata;Oe<Ae.length;Oe++){var vt=Ae[Oe];if(vt.key===H&&vt.value===pe)return!0}return!1}},V}();$.Target=h},doU7:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingCount=void 0;var j={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};$.BindingCount=j},dt0z:function(le,$,M){var j=M("zoYe");function Z(Y){return Y==null?"":j(Y)}le.exports=Z},dxzI:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.AsyncContainerModule=$.ContainerModule=void 0;var j=M("d9O0"),Z=function(){function k(h){this.id=j.id(),this.registry=h}return k}();$.ContainerModule=Z;var Y=function(){function k(h){this.id=j.id(),this.registry=h}return k}();$.AsyncContainerModule=Y},eUgh:function(le,$){function M(j,Z){for(var Y=-1,k=j==null?0:j.length,h=Array(k);++Y<k;)h[Y]=Z(j[Y],Y,j);return h}le.exports=M},fbrv:function(le,$,M){"use strict";var j=this&&this.__spreadArray||function(yt,St){for(var He=0,dt=St.length,ct=yt.length;He<dt;He++,ct++)yt[ct]=St[He];return yt};Object.defineProperty($,"__esModule",{value:!0}),$.getFunctionName=$.getBaseClassDependencyCount=$.getDependencies=void 0;var Z=M("Yk9n"),Y=M("MON2"),k=M("FV85"),h=M("xfSm"),V=M("ujMp");Object.defineProperty($,"getFunctionName",{enumerable:!0,get:function(){return V.getFunctionName}});var H=M("dX1H");function te(yt,St){var He=V.getFunctionName(St),dt=pe(yt,He,St,!1);return dt}$.getDependencies=te;function pe(yt,St,He,dt){var ct=yt.getConstructorMetadata(He),_t=ct.compilerGeneratedMetadata;if(_t===void 0){var ee=Y.MISSING_INJECTABLE_ANNOTATION+" "+St+".";throw new Error(ee)}var rr=ct.userGeneratedMetadata,Fr=Object.keys(rr),Mr=He.length===0&&Fr.length>0,Nt=Fr.length>He.length,ze=Mr||Nt?Fr.length:He.length,zt=Ae(dt,St,_t,rr,ze),Kt=vt(yt,He),vr=j(j([],zt),Kt);return vr}function Oe(yt,St,He,dt,ct){var _t=ct[yt.toString()]||[],ee=gt(_t),rr=ee.unmanaged!==!0,Fr=dt[yt],Mr=ee.inject||ee.multiInject;if(Fr=Mr||Fr,Fr instanceof Z.LazyServiceIdentifer&&(Fr=Fr.unwrap()),rr){var Nt=Fr===Object,ze=Fr===Function,zt=Fr===void 0,Kt=Nt||ze||zt;if(!St&&Kt){var vr=Y.MISSING_INJECT_ANNOTATION+" argument "+yt+" in class "+He+".";throw new Error(vr)}var jr=new H.Target(k.TargetTypeEnum.ConstructorArgument,ee.targetName,Fr);return jr.metadata=_t,jr}return null}function Ae(yt,St,He,dt,ct){for(var _t=[],ee=0;ee<ct;ee++){var rr=ee,Fr=Oe(rr,yt,St,He,dt);Fr!==null&&_t.push(Fr)}return _t}function vt(yt,St){for(var He=yt.getPropertiesMetadata(St),dt=[],ct=Object.keys(He),_t=0,ee=ct;_t<ee.length;_t++){var rr=ee[_t],Fr=He[rr],Mr=gt(He[rr]),Nt=Mr.targetName||rr,ze=Mr.inject||Mr.multiInject,zt=new H.Target(k.TargetTypeEnum.ClassProperty,Nt,ze);zt.metadata=Fr,dt.push(zt)}var Kt=Object.getPrototypeOf(St.prototype).constructor;if(Kt!==Object){var vr=vt(yt,Kt);dt=j(j([],dt),vr)}return dt}function at(yt,St){var He=Object.getPrototypeOf(St.prototype).constructor;if(He!==Object){var dt=V.getFunctionName(He),ct=pe(yt,dt,He,!0),_t=ct.map(function(Fr){return Fr.metadata.filter(function(Mr){return Mr.key===h.UNMANAGED_TAG})}),ee=[].concat.apply([],_t).length,rr=ct.length-ee;return rr>0?rr:at(yt,He)}else return 0}$.getBaseClassDependencyCount=at;function gt(yt){var St={};return yt.forEach(function(He){St[He.key.toString()]=He.value}),{inject:St[h.INJECT_TAG],multiInject:St[h.MULTI_INJECT_TAG],targetName:St[h.NAME_TAG],unmanaged:St[h.UNMANAGED_TAG]}}},fo6e:function(le,$){var M=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function j(Z){return M.test(Z)}le.exports=j},g4R6:function(le,$){function M(j,Z,Y){return j===j&&(Y!==void 0&&(j=j<=Y?j:Y),Z!==void 0&&(j=j>=Z?j:Z)),j}le.exports=M},gFfm:function(le,$){function M(j,Z){for(var Y=-1,k=j==null?0:j.length;++Y<k&&Z(j[Y],Y,j)!==!1;);return j}le.exports=M},gQMU:function(le,$,M){var j=M("0ZTe"),Z=j("toUpperCase");le.exports=Z},gzZq:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingToSyntax=void 0;var j=M("MON2"),Z=M("FV85"),Y=M("D9lx"),k=M("LKzl"),h=function(){function V(H){this._binding=H}return V.prototype.to=function(H){return this._binding.type=Z.BindingTypeEnum.Instance,this._binding.implementationType=H,new Y.BindingInWhenOnSyntax(this._binding)},V.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+j.INVALID_TO_SELF_VALUE);var H=this._binding.serviceIdentifier;return this.to(H)},V.prototype.toConstantValue=function(H){return this._binding.type=Z.BindingTypeEnum.ConstantValue,this._binding.cache=H,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Z.BindingScopeEnum.Singleton,new k.BindingWhenOnSyntax(this._binding)},V.prototype.toDynamicValue=function(H){return this._binding.type=Z.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=H,this._binding.implementationType=null,new Y.BindingInWhenOnSyntax(this._binding)},V.prototype.toConstructor=function(H){return this._binding.type=Z.BindingTypeEnum.Constructor,this._binding.implementationType=H,this._binding.scope=Z.BindingScopeEnum.Singleton,new k.BindingWhenOnSyntax(this._binding)},V.prototype.toFactory=function(H){return this._binding.type=Z.BindingTypeEnum.Factory,this._binding.factory=H,this._binding.scope=Z.BindingScopeEnum.Singleton,new k.BindingWhenOnSyntax(this._binding)},V.prototype.toFunction=function(H){if(typeof H!="function")throw new Error(j.INVALID_FUNCTION_BINDING);var te=this.toConstantValue(H);return this._binding.type=Z.BindingTypeEnum.Function,this._binding.scope=Z.BindingScopeEnum.Singleton,te},V.prototype.toAutoFactory=function(H){return this._binding.type=Z.BindingTypeEnum.Factory,this._binding.factory=function(te){var pe=function(){return te.container.get(H)};return pe},this._binding.scope=Z.BindingScopeEnum.Singleton,new k.BindingWhenOnSyntax(this._binding)},V.prototype.toProvider=function(H){return this._binding.type=Z.BindingTypeEnum.Provider,this._binding.provider=H,this._binding.scope=Z.BindingScopeEnum.Singleton,new k.BindingWhenOnSyntax(this._binding)},V.prototype.toService=function(H){this.toDynamicValue(function(te){return te.container.get(H)})},V}();$.BindingToSyntax=h},h7MG:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.getBindingDictionary=$.createMockRequest=$.plan=void 0;var j=M("doU7"),Z=M("MON2"),Y=M("FV85"),k=M("xfSm"),h=M("qK8v"),V=M("ujMp"),H=M("oy+k"),te=M("GXnB"),pe=M("yMAV"),Oe=M("fbrv"),Ae=M("xiII"),vt=M("dX1H");function at(ee){return ee._bindingDictionary}$.getBindingDictionary=at;function gt(ee,rr,Fr,Mr,Nt,ze){var zt=ee?k.MULTI_INJECT_TAG:k.INJECT_TAG,Kt=new te.Metadata(zt,Fr),vr=new vt.Target(rr,Mr,Fr,Kt);if(Nt!==void 0){var jr=new te.Metadata(Nt,ze);vr.metadata.push(jr)}return vr}function yt(ee,rr,Fr,Mr,Nt){var ze=dt(Fr.container,Nt.serviceIdentifier),zt=[];return ze.length===j.BindingCount.NoBindingsAvailable&&Fr.container.options.autoBindInjectable&&typeof Nt.serviceIdentifier=="function"&&ee.getConstructorMetadata(Nt.serviceIdentifier).compilerGeneratedMetadata&&(Fr.container.bind(Nt.serviceIdentifier).toSelf(),ze=dt(Fr.container,Nt.serviceIdentifier)),rr?zt=ze:zt=ze.filter(function(Kt){var vr=new Ae.Request(Kt.serviceIdentifier,Fr,Mr,Kt,Nt);return Kt.constraint(vr)}),St(Nt.serviceIdentifier,zt,Nt,Fr.container),zt}function St(ee,rr,Fr,Mr){switch(rr.length){case j.BindingCount.NoBindingsAvailable:if(Fr.isOptional())return rr;var Nt=V.getServiceIdentifierAsString(ee),ze=Z.NOT_REGISTERED;throw ze+=V.listMetadataForTarget(Nt,Fr),ze+=V.listRegisteredBindingsForServiceIdentifier(Mr,Nt,dt),new Error(ze);case j.BindingCount.OnlyOneBindingAvailable:if(!Fr.isArray())return rr;case j.BindingCount.MultipleBindingsAvailable:default:if(Fr.isArray())return rr;var Nt=V.getServiceIdentifierAsString(ee),ze=Z.AMBIGUOUS_MATCH+" "+Nt;throw ze+=V.listRegisteredBindingsForServiceIdentifier(Mr,Nt,dt),new Error(ze)}}function He(ee,rr,Fr,Mr,Nt,ze){var zt,Kt;if(Nt===null){zt=yt(ee,rr,Mr,null,ze),Kt=new Ae.Request(Fr,Mr,null,zt,ze);var vr=new pe.Plan(Mr,Kt);Mr.addPlan(vr)}else zt=yt(ee,rr,Mr,Nt,ze),Kt=Nt.addChildRequest(ze.serviceIdentifier,zt,ze);zt.forEach(function(jr){var vn=null;if(ze.isArray())vn=Kt.addChildRequest(jr.serviceIdentifier,jr,ze);else{if(jr.cache)return;vn=Kt}if(jr.type===Y.BindingTypeEnum.Instance&&jr.implementationType!==null){var kr=Oe.getDependencies(ee,jr.implementationType);if(!Mr.container.options.skipBaseClassChecks){var be=Oe.getBaseClassDependencyCount(ee,jr.implementationType);if(kr.length<be){var Ne=Z.ARGUMENTS_LENGTH_MISMATCH(Oe.getFunctionName(jr.implementationType));throw new Error(Ne)}}kr.forEach(function(Ie){He(ee,!1,Ie.serviceIdentifier,Mr,vn,Ie)})}})}function dt(ee,rr){var Fr=[],Mr=at(ee);return Mr.hasKey(rr)?Fr=Mr.get(rr):ee.parent!==null&&(Fr=dt(ee.parent,rr)),Fr}function ct(ee,rr,Fr,Mr,Nt,ze,zt,Kt){Kt===void 0&&(Kt=!1);var vr=new H.Context(rr),jr=gt(Fr,Mr,Nt,"",ze,zt);try{return He(ee,Kt,Nt,vr,null,jr),vr}catch(vn){throw h.isStackOverflowExeption(vn)&&vr.plan&&V.circularDependencyToException(vr.plan.rootRequest),vn}}$.plan=ct;function _t(ee,rr,Fr,Mr){var Nt=new vt.Target(Y.TargetTypeEnum.Variable,"",rr,new te.Metadata(Fr,Mr)),ze=new H.Context(ee),zt=new Ae.Request(rr,ze,null,[],Nt);return zt}$.createMockRequest=_t},heNW:function(le,$){function M(j,Z,Y){switch(Y.length){case 0:return j.call(Z);case 1:return j.call(Z,Y[0]);case 2:return j.call(Z,Y[0],Y[1]);case 3:return j.call(Z,Y[0],Y[1],Y[2])}return j.apply(Z,Y)}le.exports=M},hi0z:function(le,$,M){"use strict";(function(j,Z){le.exports=Z()})(this,function(){function j(Oe){var Ae=[];return Oe.AMapUI&&Ae.push(Z(Oe.AMapUI)),Oe.Loca&&Ae.push(Y(Oe.Loca)),Promise.all(Ae)}function Z(Oe){return new Promise(function(Ae,vt){var at=[];if(Oe.plugins)for(var gt=0;gt<Oe.plugins.length;gt+=1)h.AMapUI.plugins.indexOf(Oe.plugins[gt])==-1&&at.push(Oe.plugins[gt]);if(V.AMapUI===k.failed)vt("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(V.AMapUI===k.notload){V.AMapUI=k.loading,h.AMapUI.version=Oe.version||h.AMapUI.version,gt=h.AMapUI.version;var yt=document.body||document.head,St=document.createElement("script");St.type="text/javascript",St.src="https://webapi.amap.com/ui/"+gt+"/main.js",St.onerror=function(He){V.AMapUI=k.failed,vt("\u8BF7\u6C42 AMapUI \u5931\u8D25")},St.onload=function(){if(V.AMapUI=k.loaded,at.length)window.AMapUI.loadUI(at,function(){for(var He=0,dt=at.length;He<dt;He++){var ct=at[He].split("/").slice(-1)[0];window.AMapUI[ct]=arguments[He]}for(Ae();H.AMapUI.length;)H.AMapUI.splice(0,1)[0]()});else for(Ae();H.AMapUI.length;)H.AMapUI.splice(0,1)[0]()},yt.appendChild(St)}else V.AMapUI===k.loaded?Oe.version&&Oe.version!==h.AMapUI.version?vt("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):at.length?window.AMapUI.loadUI(at,function(){for(var He=0,dt=at.length;He<dt;He++){var ct=at[He].split("/").slice(-1)[0];window.AMapUI[ct]=arguments[He]}Ae()}):Ae():Oe.version&&Oe.version!==h.AMapUI.version?vt("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):H.AMapUI.push(function(He){He?vt(He):at.length?window.AMapUI.loadUI(at,function(){for(var dt=0,ct=at.length;dt<ct;dt++){var _t=at[dt].split("/").slice(-1)[0];window.AMapUI[_t]=arguments[dt]}Ae()}):Ae()})})}function Y(Oe){return new Promise(function(Ae,vt){if(h.AMap.version.startsWith("2.0"))vt("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(V.Loca===k.failed)vt("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(V.Loca===k.notload){V.Loca=k.loading,h.Loca.version=Oe.version||h.Loca.version;var at=h.Loca.version,gt=h.key,yt=document.body||document.head,St=document.createElement("script");St.type="text/javascript",St.src="https://webapi.amap.com/loca?v="+at+"&key="+gt,St.onerror=function(He){V.Loca=k.failed,vt("\u8BF7\u6C42 AMapUI \u5931\u8D25")},St.onload=function(){for(V.Loca=k.loaded,Ae();H.Loca.length;)H.Loca.splice(0,1)[0]()},yt.appendChild(St)}else V.Loca===k.loaded?Oe.version&&Oe.version!==h.Loca.version?vt("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):Ae():Oe.version&&Oe.version!==h.Loca.version?vt("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):H.Loca.push(function(He){He?vt(He):vt()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var k;(function(Oe){Oe.notload="notload",Oe.loading="loading",Oe.loaded="loaded",Oe.failed="failed"})(k||(k={}));var h={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},V={AMap:k.notload,AMapUI:k.notload,Loca:k.notload},H={AMap:[],AMapUI:[],Loca:[]},te=[],pe=function(Ae){typeof Ae=="function"&&(V.AMap===k.loaded?Ae(window.AMap):te.push(Ae))};return{load:function(Ae){return new Promise(function(vt,at){if(V.AMap==k.failed)at("");else if(V.AMap==k.notload){var gt=Ae.key,yt=Ae.version,St=Ae.plugins;gt?(window.AMap&&location.host!=="lbs.amap.com"&&at("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),h.key=gt,h.AMap.version=yt||h.AMap.version,h.AMap.plugins=St||h.AMap.plugins,V.AMap=k.loading,yt=document.body||document.head,window.___onAPILoaded=function(dt){if(delete window.___onAPILoaded,dt)V.AMap=k.failed,at(dt);else for(V.AMap=k.loaded,j(Ae).then(function(){vt(window.AMap)}).catch(at);te.length;)te.splice(0,1)[0]()},St=document.createElement("script"),St.type="text/javascript",St.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+h.AMap.version+"&key="+gt+"&plugin="+h.AMap.plugins.join(","),St.onerror=function(dt){V.AMap=k.failed,at(dt)},yt.appendChild(St)):at("\u8BF7\u586B\u5199key")}else if(V.AMap==k.loaded)if(Ae.key&&Ae.key!==h.key)at("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(Ae.version&&Ae.version!==h.AMap.version)at("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(gt=[],Ae.plugins)for(yt=0;yt<Ae.plugins.length;yt+=1)h.AMap.plugins.indexOf(Ae.plugins[yt])==-1&&gt.push(Ae.plugins[yt]);gt.length?window.AMap.plugin(gt,function(){j(Ae).then(function(){vt(window.AMap)}).catch(at)}):j(Ae).then(function(){vt(window.AMap)}).catch(at)}else if(Ae.key&&Ae.key!==h.key)at("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(Ae.version&&Ae.version!==h.AMap.version)at("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var He=[];if(Ae.plugins)for(yt=0;yt<Ae.plugins.length;yt+=1)h.AMap.plugins.indexOf(Ae.plugins[yt])==-1&&He.push(Ae.plugins[yt]);pe(function(){He.length?window.AMap.plugin(He,function(){j(Ae).then(function(){vt(window.AMap)}).catch(at)}):j(Ae).then(function(){vt(window.AMap)}).catch(at)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,h={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},V={AMap:k.notload,AMapUI:k.notload,Loca:k.notload},H={AMap:[],AMapUI:[],Loca:[]}}}})},hypo:function(le,$,M){var j=M("O0oS");function Z(Y,k,h){k=="__proto__"&&j?j(Y,k,{configurable:!0,enumerable:!0,value:h,writable:!0}):Y[k]=h}le.exports=Z},iWIM:function(le,$,M){var j=M("n3AX");function Z(){return typeof Reflect!="undefined"&&Reflect.get?(le.exports=Z=Reflect.get,le.exports.__esModule=!0,le.exports.default=le.exports):(le.exports=Z=function(k,h,V){var H=j(k,h);if(!!H){var te=Object.getOwnPropertyDescriptor(H,h);return te.get?te.get.call(arguments.length<3?k:V):te.value}},le.exports.__esModule=!0,le.exports.default=le.exports),Z.apply(this,arguments)}le.exports=Z,le.exports.__esModule=!0,le.exports.default=le.exports},iegG:function(le,$){function M(Z){var Y=Z.target||Z.srcElement;Y.__resizeRAF__&&cancelAnimationFrame(Y.__resizeRAF__),Y.__resizeRAF__=requestAnimationFrame(function(){var k=Y.__resizeTrigger__,h=k&&k.__resizeListeners__;h&&h.forEach(function(V){V.call(k,Z)})})}var j=function(Y,k){var h=this,V=h.document,H,te=V.attachEvent;typeof navigator!="undefined"&&(H=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function pe(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",M)}if(!Y.__resizeListeners__)if(Y.__resizeListeners__=[],te)Y.__resizeTrigger__=Y,Y.attachEvent("onresize",M);else{getComputedStyle(Y).position==="static"&&(Y.style.position="relative");var Oe=Y.__resizeTrigger__=V.createElement("object");Oe.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),Oe.setAttribute("class","resize-sensor"),Oe.setAttribute("tabindex","-1"),Oe.setAttribute("title",""),Oe.__resizeElement__=Y,Oe.onload=pe,Oe.type="text/html",H&&Y.appendChild(Oe),Oe.data="about:blank",H||Y.appendChild(Oe)}Y.__resizeListeners__.push(k)};le.exports=typeof window=="undefined"?j:j.bind(window),le.exports.unbind=function(Z,Y){var k=document.attachEvent,h=Z.__resizeListeners__||[];if(Y){var V=h.indexOf(Y);V!==-1&&h.splice(V,1)}else h=Z.__resizeListeners__=[];if(!h.length){if(k)Z.detachEvent("onresize",M);else if(Z.__resizeTrigger__){var H=Z.__resizeTrigger__.contentDocument,te=H&&H.defaultView;te&&(te.removeEventListener("resize",M),delete te.__resizeTrigger__),Z.__resizeTrigger__=!Z.removeChild(Z.__resizeTrigger__)}delete Z.__resizeListeners__}}},itsj:function(le,$){function M(j,Z){if(!(Z==="constructor"&&typeof j[Z]=="function")&&Z!="__proto__")return j[Z]}le.exports=M},jCWc:function(le,$,M){"use strict";var j=M("EFp3"),Z=M.n(j),Y=M("1GLa")},"jIg/":function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.multiInject=void 0;var j=M("xfSm"),Z=M("GXnB"),Y=M("Ztfv");function k(h){return function(V,H,te){var pe=new Z.Metadata(j.MULTI_INJECT_TAG,h);typeof te=="number"?Y.tagParameter(V,H,te,pe):Y.tagProperty(V,H,pe)}}$.multiInject=k},jYQm:function(le,$,M){"use strict";var j=M("q1tI"),Z=M.n(j),Y=Object(j.createContext)({});$.a=Y},jYx5:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.optional=void 0;var j=M("xfSm"),Z=M("GXnB"),Y=M("Ztfv");function k(){return function(h,V,H){var te=new Z.Metadata(j.OPTIONAL_TAG,!0);typeof H=="number"?Y.tagParameter(h,V,H,te):Y.tagProperty(h,V,te)}}$.optional=k},"jbM+":function(le,$,M){var j=M("R/W3");function Z(Y,k){var h=Y==null?0:Y.length;return!!h&&j(Y,k,0)>-1}le.exports=Z},jeLo:function(le,$,M){var j=M("juv8"),Z=M("mTTR");function Y(k){return j(k,Z(k))}le.exports=Y},juv8:function(le,$,M){var j=M("MrPd"),Z=M("hypo");function Y(k,h,V,H){var te=!V;V||(V={});for(var pe=-1,Oe=h.length;++pe<Oe;){var Ae=h[pe],vt=H?H(V[Ae],k[Ae],Ae,V,k):void 0;vt===void 0&&(vt=k[Ae]),te?Z(V,Ae,vt):j(V,Ae,vt)}return V}le.exports=Y},kPKH:function(le,$,M){"use strict";var j=M("/kpp");$.a=j.a},lwsE:function(le,$){function M(j,Z){if(!(j instanceof Z))throw new TypeError("Cannot call a class as a function")}le.exports=M,le.exports.__esModule=!0,le.exports.default=le.exports},mNvP:function(le,$,M){(function(j,Z){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Y;(function(k){(function(h){var V=typeof Z=="object"?Z:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),H=te(k);typeof V.Reflect=="undefined"?V.Reflect=k:H=te(V.Reflect,H),h(H);function te(pe,Oe){return function(Ae,vt){typeof pe[Ae]!="function"&&Object.defineProperty(pe,Ae,{configurable:!0,writable:!0,value:vt}),Oe&&Oe(Ae,vt)}}})(function(h){var V=Object.prototype.hasOwnProperty,H=typeof Symbol=="function",te=H&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",pe=H&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",Oe=typeof Object.create=="function",Ae={__proto__:[]}instanceof Array,vt=!Oe&&!Ae,at={create:Oe?function(){return ys(Object.create(null))}:Ae?function(){return ys({__proto__:null})}:function(){return ys({})},has:vt?function(Jt,Ir){return V.call(Jt,Ir)}:function(Jt,Ir){return Ir in Jt},get:vt?function(Jt,Ir){return V.call(Jt,Ir)?Jt[Ir]:void 0}:function(Jt,Ir){return Jt[Ir]}},gt=Object.getPrototypeOf(Function),yt=typeof j=="object"&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL==="true",St=!yt&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Pn(),He=!yt&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:oa(),dt=!yt&&typeof WeakMap=="function"?WeakMap:ws(),ct=new dt;function _t(Jt,Ir,en,On){if(Ut(en)){if(!Or(Jt))throw new TypeError;if(!Br(Ir))throw new TypeError;return jr(Jt,Ir)}else{if(!Or(Jt))throw new TypeError;if(!Lt(Ir))throw new TypeError;if(!Lt(On)&&!Ut(On)&&!Xt(On))throw new TypeError;return Xt(On)&&(On=void 0),en=$r(en),vn(Jt,Ir,en,On)}}h("decorate",_t);function ee(Jt,Ir){function en(On,ln){if(!Lt(On))throw new TypeError;if(!Ut(ln)&&!Jn(ln))throw new TypeError;mt(Jt,Ir,On,ln)}return en}h("metadata",ee);function rr(Jt,Ir,en,On){if(!Lt(en))throw new TypeError;return Ut(On)||(On=$r(On)),mt(Jt,Ir,en,On)}h("defineMetadata",rr);function Fr(Jt,Ir,en){if(!Lt(Ir))throw new TypeError;return Ut(en)||(en=$r(en)),be(Jt,Ir,en)}h("hasMetadata",Fr);function Mr(Jt,Ir,en){if(!Lt(Ir))throw new TypeError;return Ut(en)||(en=$r(en)),Ne(Jt,Ir,en)}h("hasOwnMetadata",Mr);function Nt(Jt,Ir,en){if(!Lt(Ir))throw new TypeError;return Ut(en)||(en=$r(en)),Ie(Jt,Ir,en)}h("getMetadata",Nt);function ze(Jt,Ir,en){if(!Lt(Ir))throw new TypeError;return Ut(en)||(en=$r(en)),pt(Jt,Ir,en)}h("getOwnMetadata",ze);function zt(Jt,Ir){if(!Lt(Jt))throw new TypeError;return Ut(Ir)||(Ir=$r(Ir)),Dt(Jt,Ir)}h("getMetadataKeys",zt);function Kt(Jt,Ir){if(!Lt(Jt))throw new TypeError;return Ut(Ir)||(Ir=$r(Ir)),w(Jt,Ir)}h("getOwnMetadataKeys",Kt);function vr(Jt,Ir,en){if(!Lt(Ir))throw new TypeError;Ut(en)||(en=$r(en));var On=kr(Ir,en,!1);if(Ut(On)||!On.delete(Jt))return!1;if(On.size>0)return!0;var ln=ct.get(Ir);return ln.delete(en),ln.size>0||ct.delete(Ir),!0}h("deleteMetadata",vr);function jr(Jt,Ir){for(var en=Jt.length-1;en>=0;--en){var On=Jt[en],ln=On(Ir);if(!Ut(ln)&&!Xt(ln)){if(!Br(ln))throw new TypeError;Ir=ln}}return Ir}function vn(Jt,Ir,en,On){for(var ln=Jt.length-1;ln>=0;--ln){var Ka=Jt[ln],wi=Ka(Ir,en,On);if(!Ut(wi)&&!Xt(wi)){if(!Lt(wi))throw new TypeError;On=wi}}return On}function kr(Jt,Ir,en){var On=ct.get(Jt);if(Ut(On)){if(!en)return;On=new St,ct.set(Jt,On)}var ln=On.get(Ir);if(Ut(ln)){if(!en)return;ln=new St,On.set(Ir,ln)}return ln}function be(Jt,Ir,en){var On=Ne(Jt,Ir,en);if(On)return!0;var ln=_e(Ir);return Xt(ln)?!1:be(Jt,ln,en)}function Ne(Jt,Ir,en){var On=kr(Ir,en,!1);return Ut(On)?!1:nr(On.has(Jt))}function Ie(Jt,Ir,en){var On=Ne(Jt,Ir,en);if(On)return pt(Jt,Ir,en);var ln=_e(Ir);if(!Xt(ln))return Ie(Jt,ln,en)}function pt(Jt,Ir,en){var On=kr(Ir,en,!1);if(!Ut(On))return On.get(Jt)}function mt(Jt,Ir,en,On){var ln=kr(en,On,!0);ln.set(Jt,Ir)}function Dt(Jt,Ir){var en=w(Jt,Ir),On=_e(Jt);if(On===null)return en;var ln=Dt(On,Ir);if(ln.length<=0)return en;if(en.length<=0)return ln;for(var Ka=new He,wi=[],fi=0,Ti=en;fi<Ti.length;fi++){var da=Ti[fi],ya=Ka.has(da);ya||(Ka.add(da),wi.push(da))}for(var _s=0,xo=ln;_s<xo.length;_s++){var da=xo[_s],ya=Ka.has(da);ya||(Ka.add(da),wi.push(da))}return wi}function w(Jt,Ir){var en=[],On=kr(Jt,Ir,!1);if(Ut(On))return en;for(var ln=On.keys(),Ka=wn(ln),wi=0;;){var fi=Ci(Ka);if(!fi)return en.length=wi,en;var Ti=pi(fi);try{en[wi]=Ti}catch(da){try{fa(Ka)}finally{throw da}}wi++}}function br(Jt){if(Jt===null)return 1;switch(typeof Jt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Jt===null?1:6;default:return 6}}function Ut(Jt){return Jt===void 0}function Xt(Jt){return Jt===null}function It(Jt){return typeof Jt=="symbol"}function Lt(Jt){return typeof Jt=="object"?Jt!==null:typeof Jt=="function"}function ir(Jt,Ir){switch(br(Jt)){case 0:return Jt;case 1:return Jt;case 2:return Jt;case 3:return Jt;case 4:return Jt;case 5:return Jt}var en=Ir===3?"string":Ir===5?"number":"default",On=mn(Jt,te);if(On!==void 0){var ln=On.call(Jt,en);if(Lt(ln))throw new TypeError;return ln}return Ar(Jt,en==="default"?"number":en)}function Ar(Jt,Ir){if(Ir==="string"){var en=Jt.toString;if(_r(en)){var On=en.call(Jt);if(!Lt(On))return On}var ln=Jt.valueOf;if(_r(ln)){var On=ln.call(Jt);if(!Lt(On))return On}}else{var ln=Jt.valueOf;if(_r(ln)){var On=ln.call(Jt);if(!Lt(On))return On}var Ka=Jt.toString;if(_r(Ka)){var On=Ka.call(Jt);if(!Lt(On))return On}}throw new TypeError}function nr(Jt){return!!Jt}function Pr(Jt){return""+Jt}function $r(Jt){var Ir=ir(Jt,3);return It(Ir)?Ir:Pr(Ir)}function Or(Jt){return Array.isArray?Array.isArray(Jt):Jt instanceof Object?Jt instanceof Array:Object.prototype.toString.call(Jt)==="[object Array]"}function _r(Jt){return typeof Jt=="function"}function Br(Jt){return typeof Jt=="function"}function Jn(Jt){switch(br(Jt)){case 3:return!0;case 4:return!0;default:return!1}}function mn(Jt,Ir){var en=Jt[Ir];if(en!=null){if(!_r(en))throw new TypeError;return en}}function wn(Jt){var Ir=mn(Jt,pe);if(!_r(Ir))throw new TypeError;var en=Ir.call(Jt);if(!Lt(en))throw new TypeError;return en}function pi(Jt){return Jt.value}function Ci(Jt){var Ir=Jt.next();return Ir.done?!1:Ir}function fa(Jt){var Ir=Jt.return;Ir&&Ir.call(Jt)}function _e(Jt){var Ir=Object.getPrototypeOf(Jt);if(typeof Jt!="function"||Jt===gt||Ir!==gt)return Ir;var en=Jt.prototype,On=en&&Object.getPrototypeOf(en);if(On==null||On===Object.prototype)return Ir;var ln=On.constructor;return typeof ln!="function"||ln===Jt?Ir:ln}function Pn(){var Jt={},Ir=[],en=function(){function wi(fi,Ti,da){this._index=0,this._keys=fi,this._values=Ti,this._selector=da}return wi.prototype["@@iterator"]=function(){return this},wi.prototype[pe]=function(){return this},wi.prototype.next=function(){var fi=this._index;if(fi>=0&&fi<this._keys.length){var Ti=this._selector(this._keys[fi],this._values[fi]);return fi+1>=this._keys.length?(this._index=-1,this._keys=Ir,this._values=Ir):this._index++,{value:Ti,done:!1}}return{value:void 0,done:!0}},wi.prototype.throw=function(fi){throw this._index>=0&&(this._index=-1,this._keys=Ir,this._values=Ir),fi},wi.prototype.return=function(fi){return this._index>=0&&(this._index=-1,this._keys=Ir,this._values=Ir),{value:fi,done:!0}},wi}();return function(){function wi(){this._keys=[],this._values=[],this._cacheKey=Jt,this._cacheIndex=-2}return Object.defineProperty(wi.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),wi.prototype.has=function(fi){return this._find(fi,!1)>=0},wi.prototype.get=function(fi){var Ti=this._find(fi,!1);return Ti>=0?this._values[Ti]:void 0},wi.prototype.set=function(fi,Ti){var da=this._find(fi,!0);return this._values[da]=Ti,this},wi.prototype.delete=function(fi){var Ti=this._find(fi,!1);if(Ti>=0){for(var da=this._keys.length,ya=Ti+1;ya<da;ya++)this._keys[ya-1]=this._keys[ya],this._values[ya-1]=this._values[ya];return this._keys.length--,this._values.length--,fi===this._cacheKey&&(this._cacheKey=Jt,this._cacheIndex=-2),!0}return!1},wi.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Jt,this._cacheIndex=-2},wi.prototype.keys=function(){return new en(this._keys,this._values,On)},wi.prototype.values=function(){return new en(this._keys,this._values,ln)},wi.prototype.entries=function(){return new en(this._keys,this._values,Ka)},wi.prototype["@@iterator"]=function(){return this.entries()},wi.prototype[pe]=function(){return this.entries()},wi.prototype._find=function(fi,Ti){return this._cacheKey!==fi&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=fi)),this._cacheIndex<0&&Ti&&(this._cacheIndex=this._keys.length,this._keys.push(fi),this._values.push(void 0)),this._cacheIndex},wi}();function On(wi,fi){return wi}function ln(wi,fi){return fi}function Ka(wi,fi){return[wi,fi]}}function oa(){return function(){function Jt(){this._map=new St}return Object.defineProperty(Jt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Jt.prototype.has=function(Ir){return this._map.has(Ir)},Jt.prototype.add=function(Ir){return this._map.set(Ir,Ir),this},Jt.prototype.delete=function(Ir){return this._map.delete(Ir)},Jt.prototype.clear=function(){this._map.clear()},Jt.prototype.keys=function(){return this._map.keys()},Jt.prototype.values=function(){return this._map.values()},Jt.prototype.entries=function(){return this._map.entries()},Jt.prototype["@@iterator"]=function(){return this.keys()},Jt.prototype[pe]=function(){return this.keys()},Jt}()}function ws(){var Jt=16,Ir=at.create(),en=On();return function(){function Ti(){this._key=On()}return Ti.prototype.has=function(da){var ya=ln(da,!1);return ya!==void 0?at.has(ya,this._key):!1},Ti.prototype.get=function(da){var ya=ln(da,!1);return ya!==void 0?at.get(ya,this._key):void 0},Ti.prototype.set=function(da,ya){var _s=ln(da,!0);return _s[this._key]=ya,this},Ti.prototype.delete=function(da){var ya=ln(da,!1);return ya!==void 0?delete ya[this._key]:!1},Ti.prototype.clear=function(){this._key=On()},Ti}();function On(){var Ti;do Ti="@@WeakMap@@"+fi();while(at.has(Ir,Ti));return Ir[Ti]=!0,Ti}function ln(Ti,da){if(!V.call(Ti,en)){if(!da)return;Object.defineProperty(Ti,en,{value:at.create()})}return Ti[en]}function Ka(Ti,da){for(var ya=0;ya<da;++ya)Ti[ya]=Math.random()*255|0;return Ti}function wi(Ti){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(Ti)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(Ti)):Ka(new Uint8Array(Ti),Ti):Ka(new Array(Ti),Ti)}function fi(){var Ti=wi(Jt);Ti[6]=Ti[6]&79|64,Ti[8]=Ti[8]&191|128;for(var da="",ya=0;ya<Jt;++ya){var _s=Ti[ya];(ya===4||ya===6||ya===8)&&(da+="-"),_s<16&&(da+="0"),da+=_s.toString(16).toLowerCase()}return da}}function ys(Jt){return Jt.__=void 0,delete Jt.__,Jt}})})(Y||(Y={}))}).call(this,M("Q2Ig"),M("IyRk"))},mTTR:function(le,$,M){var j=M("b80T"),Z=M("QcOe"),Y=M("MMmD");function k(h){return Y(h)?j(h,!0):Z(h)}le.exports=k},mc0g:function(le,$){function M(j){return function(Z,Y,k){for(var h=-1,V=Object(Z),H=k(Z),te=H.length;te--;){var pe=H[j?te:++h];if(Y(V[pe],pe,V)===!1)break}return Z}}le.exports=M},mhV4:function(le,$,M){var j=M("ZK94");le.exports.geometry=Z,le.exports.ring=k;function Z(V){var H=0,te;switch(V.type){case"Polygon":return Y(V.coordinates);case"MultiPolygon":for(te=0;te<V.coordinates.length;te++)H+=Y(V.coordinates[te]);return H;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(te=0;te<V.geometries.length;te++)H+=Z(V.geometries[te]);return H}}function Y(V){var H=0;if(V&&V.length>0){H+=Math.abs(k(V[0]));for(var te=1;te<V.length;te++)H-=Math.abs(k(V[te]))}return H}function k(V){var H,te,pe,Oe,Ae,vt,at,gt=0,yt=V.length;if(yt>2){for(at=0;at<yt;at++)at===yt-2?(Oe=yt-2,Ae=yt-1,vt=0):at===yt-1?(Oe=yt-1,Ae=0,vt=1):(Oe=at,Ae=at+1,vt=at+2),H=V[Oe],te=V[Ae],pe=V[vt],gt+=(h(pe[0])-h(H[0]))*Math.sin(h(te[1]));gt=gt*j.RADIUS*j.RADIUS/2}return gt}function h(V){return V*Math.PI/180}},mpbz:function(le,$,M){(function(j,Z){le.exports=Z()})(this,function(){"use strict";function j(Nt,ze,zt,Kt,vr,jr){if(!(vr-Kt<=zt)){var vn=Kt+vr>>1;Z(Nt,ze,vn,Kt,vr,jr%2),j(Nt,ze,zt,Kt,vn-1,jr+1),j(Nt,ze,zt,vn+1,vr,jr+1)}}function Z(Nt,ze,zt,Kt,vr,jr){for(;vr>Kt;){if(vr-Kt>600){var vn=vr-Kt+1,kr=zt-Kt+1,be=Math.log(vn),Ne=.5*Math.exp(2*be/3),Ie=.5*Math.sqrt(be*Ne*(vn-Ne)/vn)*(kr-vn/2<0?-1:1),pt=Math.max(Kt,Math.floor(zt-kr*Ne/vn+Ie)),mt=Math.min(vr,Math.floor(zt+(vn-kr)*Ne/vn+Ie));Z(Nt,ze,zt,pt,mt,jr)}var Dt=ze[2*zt+jr],w=Kt,br=vr;for(Y(Nt,ze,Kt,zt),ze[2*vr+jr]>Dt&&Y(Nt,ze,Kt,vr);w<br;){for(Y(Nt,ze,w,br),w++,br--;ze[2*w+jr]<Dt;)w++;for(;ze[2*br+jr]>Dt;)br--}ze[2*Kt+jr]===Dt?Y(Nt,ze,Kt,br):(br++,Y(Nt,ze,br,vr)),br<=zt&&(Kt=br+1),zt<=br&&(vr=br-1)}}function Y(Nt,ze,zt,Kt){k(Nt,zt,Kt),k(ze,2*zt,2*Kt),k(ze,2*zt+1,2*Kt+1)}function k(Nt,ze,zt){var Kt=Nt[ze];Nt[ze]=Nt[zt],Nt[zt]=Kt}function h(Nt,ze,zt,Kt,vr,jr,vn){for(var kr=[0,Nt.length-1,0],be=[],Ne,Ie;kr.length;){var pt=kr.pop(),mt=kr.pop(),Dt=kr.pop();if(mt-Dt<=vn){for(var w=Dt;w<=mt;w++)Ne=ze[2*w],Ie=ze[2*w+1],Ne>=zt&&Ne<=vr&&Ie>=Kt&&Ie<=jr&&be.push(Nt[w]);continue}var br=Math.floor((Dt+mt)/2);Ne=ze[2*br],Ie=ze[2*br+1],Ne>=zt&&Ne<=vr&&Ie>=Kt&&Ie<=jr&&be.push(Nt[br]);var Ut=(pt+1)%2;(pt===0?zt<=Ne:Kt<=Ie)&&(kr.push(Dt),kr.push(br-1),kr.push(Ut)),(pt===0?vr>=Ne:jr>=Ie)&&(kr.push(br+1),kr.push(mt),kr.push(Ut))}return be}function V(Nt,ze,zt,Kt,vr,jr){for(var vn=[0,Nt.length-1,0],kr=[],be=vr*vr;vn.length;){var Ne=vn.pop(),Ie=vn.pop(),pt=vn.pop();if(Ie-pt<=jr){for(var mt=pt;mt<=Ie;mt++)H(ze[2*mt],ze[2*mt+1],zt,Kt)<=be&&kr.push(Nt[mt]);continue}var Dt=Math.floor((pt+Ie)/2),w=ze[2*Dt],br=ze[2*Dt+1];H(w,br,zt,Kt)<=be&&kr.push(Nt[Dt]);var Ut=(Ne+1)%2;(Ne===0?zt-vr<=w:Kt-vr<=br)&&(vn.push(pt),vn.push(Dt-1),vn.push(Ut)),(Ne===0?zt+vr>=w:Kt+vr>=br)&&(vn.push(Dt+1),vn.push(Ie),vn.push(Ut))}return kr}function H(Nt,ze,zt,Kt){var vr=Nt-zt,jr=ze-Kt;return vr*vr+jr*jr}var te=function(ze){return ze[0]},pe=function(ze){return ze[1]},Oe=function(ze,zt,Kt,vr,jr){zt===void 0&&(zt=te),Kt===void 0&&(Kt=pe),vr===void 0&&(vr=64),jr===void 0&&(jr=Float64Array),this.nodeSize=vr,this.points=ze;for(var vn=ze.length<65536?Uint16Array:Uint32Array,kr=this.ids=new vn(ze.length),be=this.coords=new jr(ze.length*2),Ne=0;Ne<ze.length;Ne++)kr[Ne]=Ne,be[2*Ne]=zt(ze[Ne]),be[2*Ne+1]=Kt(ze[Ne]);j(kr,be,vr,0,kr.length-1,0)};Oe.prototype.range=function(ze,zt,Kt,vr){return h(this.ids,this.coords,ze,zt,Kt,vr,this.nodeSize)},Oe.prototype.within=function(ze,zt,Kt){return V(this.ids,this.coords,ze,zt,Kt,this.nodeSize)};var Ae={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ze){return ze}},vt=Math.fround||function(Nt){return function(ze){return Nt[0]=+ze,Nt[0]}}(new Float32Array(1)),at=function(ze){this.options=rr(Object.create(Ae),ze),this.trees=new Array(this.options.maxZoom+1)};at.prototype.load=function(ze){var zt=this.options,Kt=zt.log,vr=zt.minZoom,jr=zt.maxZoom,vn=zt.nodeSize;Kt&&console.time("total time");var kr="prepare "+ze.length+" points";Kt&&console.time(kr),this.points=ze;for(var be=[],Ne=0;Ne<ze.length;Ne++)!ze[Ne].geometry||be.push(yt(ze[Ne],Ne));this.trees[jr+1]=new Oe(be,Fr,Mr,vn,Float32Array),Kt&&console.timeEnd(kr);for(var Ie=jr;Ie>=vr;Ie--){var pt=+Date.now();be=this._cluster(be,Ie),this.trees[Ie]=new Oe(be,Fr,Mr,vn,Float32Array),Kt&&console.log("z%d: %d clusters in %dms",Ie,be.length,+Date.now()-pt)}return Kt&&console.timeEnd("total time"),this},at.prototype.getClusters=function(ze,zt){var Kt=((ze[0]+180)%360+360)%360-180,vr=Math.max(-90,Math.min(90,ze[1])),jr=ze[2]===180?180:((ze[2]+180)%360+360)%360-180,vn=Math.max(-90,Math.min(90,ze[3]));if(ze[2]-ze[0]>=360)Kt=-180,jr=180;else if(Kt>jr){var kr=this.getClusters([Kt,vr,180,vn],zt),be=this.getClusters([-180,vr,jr,vn],zt);return kr.concat(be)}for(var Ne=this.trees[this._limitZoom(zt)],Ie=Ne.range(dt(Kt),ct(vn),dt(jr),ct(vr)),pt=[],mt=0,Dt=Ie;mt<Dt.length;mt+=1){var w=Dt[mt],br=Ne.points[w];pt.push(br.numPoints?St(br):this.points[br.index])}return pt},at.prototype.getChildren=function(ze){var zt=this._getOriginId(ze),Kt=this._getOriginZoom(ze),vr="No cluster with the specified id.",jr=this.trees[Kt];if(!jr)throw new Error(vr);var vn=jr.points[zt];if(!vn)throw new Error(vr);for(var kr=this.options.radius/(this.options.extent*Math.pow(2,Kt-1)),be=jr.within(vn.x,vn.y,kr),Ne=[],Ie=0,pt=be;Ie<pt.length;Ie+=1){var mt=pt[Ie],Dt=jr.points[mt];Dt.parentId===ze&&Ne.push(Dt.numPoints?St(Dt):this.points[Dt.index])}if(Ne.length===0)throw new Error(vr);return Ne},at.prototype.getLeaves=function(ze,zt,Kt){zt=zt||10,Kt=Kt||0;var vr=[];return this._appendLeaves(vr,ze,zt,Kt,0),vr},at.prototype.getTile=function(ze,zt,Kt){var vr=this.trees[this._limitZoom(ze)],jr=Math.pow(2,ze),vn=this.options,kr=vn.extent,be=vn.radius,Ne=be/kr,Ie=(Kt-Ne)/jr,pt=(Kt+1+Ne)/jr,mt={features:[]};return this._addTileFeatures(vr.range((zt-Ne)/jr,Ie,(zt+1+Ne)/jr,pt),vr.points,zt,Kt,jr,mt),zt===0&&this._addTileFeatures(vr.range(1-Ne/jr,Ie,1,pt),vr.points,jr,Kt,jr,mt),zt===jr-1&&this._addTileFeatures(vr.range(0,Ie,Ne/jr,pt),vr.points,-1,Kt,jr,mt),mt.features.length?mt:null},at.prototype.getClusterExpansionZoom=function(ze){for(var zt=this._getOriginZoom(ze)-1;zt<=this.options.maxZoom;){var Kt=this.getChildren(ze);if(zt++,Kt.length!==1)break;ze=Kt[0].properties.cluster_id}return zt},at.prototype._appendLeaves=function(ze,zt,Kt,vr,jr){for(var vn=this.getChildren(zt),kr=0,be=vn;kr<be.length;kr+=1){var Ne=be[kr],Ie=Ne.properties;if(Ie&&Ie.cluster?jr+Ie.point_count<=vr?jr+=Ie.point_count:jr=this._appendLeaves(ze,Ie.cluster_id,Kt,vr,jr):jr<vr?jr++:ze.push(Ne),ze.length===Kt)break}return jr},at.prototype._addTileFeatures=function(ze,zt,Kt,vr,jr,vn){for(var kr=0,be=ze;kr<be.length;kr+=1){var Ne=be[kr],Ie=zt[Ne],pt=Ie.numPoints,mt=void 0,Dt=void 0,w=void 0;if(pt)mt=He(Ie),Dt=Ie.x,w=Ie.y;else{var br=this.points[Ie.index];mt=br.properties,Dt=dt(br.geometry.coordinates[0]),w=ct(br.geometry.coordinates[1])}var Ut={type:1,geometry:[[Math.round(this.options.extent*(Dt*jr-Kt)),Math.round(this.options.extent*(w*jr-vr))]],tags:mt},Xt=void 0;pt?Xt=Ie.id:this.options.generateId?Xt=Ie.index:this.points[Ie.index].id&&(Xt=this.points[Ie.index].id),Xt!==void 0&&(Ut.id=Xt),vn.features.push(Ut)}},at.prototype._limitZoom=function(ze){return Math.max(this.options.minZoom,Math.min(+ze,this.options.maxZoom+1))},at.prototype._cluster=function(ze,zt){for(var Kt=[],vr=this.options,jr=vr.radius,vn=vr.extent,kr=vr.reduce,be=vr.minPoints,Ne=jr/(vn*Math.pow(2,zt)),Ie=0;Ie<ze.length;Ie++){var pt=ze[Ie];if(!(pt.zoom<=zt)){pt.zoom=zt;for(var mt=this.trees[zt+1],Dt=mt.within(pt.x,pt.y,Ne),w=pt.numPoints||1,br=w,Ut=0,Xt=Dt;Ut<Xt.length;Ut+=1){var It=Xt[Ut],Lt=mt.points[It];Lt.zoom>zt&&(br+=Lt.numPoints||1)}if(br>w&&br>=be){for(var ir=pt.x*w,Ar=pt.y*w,nr=kr&&w>1?this._map(pt,!0):null,Pr=(Ie<<5)+(zt+1)+this.points.length,$r=0,Or=Dt;$r<Or.length;$r+=1){var _r=Or[$r],Br=mt.points[_r];if(!(Br.zoom<=zt)){Br.zoom=zt;var Jn=Br.numPoints||1;ir+=Br.x*Jn,Ar+=Br.y*Jn,Br.parentId=Pr,kr&&(nr||(nr=this._map(pt,!0)),kr(nr,this._map(Br)))}}pt.parentId=Pr,Kt.push(gt(ir/br,Ar/br,Pr,br,nr))}else if(Kt.push(pt),br>1)for(var mn=0,wn=Dt;mn<wn.length;mn+=1){var pi=wn[mn],Ci=mt.points[pi];Ci.zoom<=zt||(Ci.zoom=zt,Kt.push(Ci))}}}return Kt},at.prototype._getOriginId=function(ze){return ze-this.points.length>>5},at.prototype._getOriginZoom=function(ze){return(ze-this.points.length)%32},at.prototype._map=function(ze,zt){if(ze.numPoints)return zt?rr({},ze.properties):ze.properties;var Kt=this.points[ze.index].properties,vr=this.options.map(Kt);return zt&&vr===Kt?rr({},vr):vr};function gt(Nt,ze,zt,Kt,vr){return{x:vt(Nt),y:vt(ze),zoom:Infinity,id:zt,parentId:-1,numPoints:Kt,properties:vr}}function yt(Nt,ze){var zt=Nt.geometry.coordinates,Kt=zt[0],vr=zt[1];return{x:vt(dt(Kt)),y:vt(ct(vr)),zoom:Infinity,index:ze,parentId:-1}}function St(Nt){return{type:"Feature",id:Nt.id,properties:He(Nt),geometry:{type:"Point",coordinates:[_t(Nt.x),ee(Nt.y)]}}}function He(Nt){var ze=Nt.numPoints,zt=ze>=1e4?Math.round(ze/1e3)+"k":ze>=1e3?Math.round(ze/100)/10+"k":ze;return rr(rr({},Nt.properties),{cluster:!0,cluster_id:Nt.id,point_count:ze,point_count_abbreviated:zt})}function dt(Nt){return Nt/360+.5}function ct(Nt){var ze=Math.sin(Nt*Math.PI/180),zt=.5-.25*Math.log((1+ze)/(1-ze))/Math.PI;return zt<0?0:zt>1?1:zt}function _t(Nt){return(Nt-.5)*360}function ee(Nt){var ze=(180-Nt*360)*Math.PI/180;return 360*Math.atan(Math.exp(ze))/Math.PI-90}function rr(Nt,ze){for(var zt in ze)Nt[zt]=ze[zt];return Nt}function Fr(Nt){return Nt.x}function Mr(Nt){return Nt.y}return at})},"mv/X":function(le,$,M){var j=M("ljhN"),Z=M("MMmD"),Y=M("wJg7"),k=M("GoyQ");function h(V,H,te){if(!k(te))return!1;var pe=typeof H;return(pe=="number"?Z(te)&&Y(H,te.length):pe=="string"&&H in te)?j(te[H],V):!1}le.exports=h},n2J3:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.unmanaged=void 0;var j=M("xfSm"),Z=M("GXnB"),Y=M("Ztfv");function k(){return function(h,V,H){var te=new Z.Metadata(j.UNMANAGED_TAG,!0);Y.tagParameter(h,V,H,te)}}$.unmanaged=k},n3AX:function(le,$,M){var j=M("Nsbk");function Z(Y,k){for(;!Object.prototype.hasOwnProperty.call(Y,k)&&(Y=j(Y),Y!==null););return Y}le.exports=Z,le.exports.__esModule=!0,le.exports.default=le.exports},"oCl/":function(le,$,M){var j=M("CH3K"),Z=M("LcsW"),Y=M("MvSz"),k=M("0ycA"),h=Object.getOwnPropertySymbols,V=h?function(H){for(var te=[];H;)j(te,Y(H)),H=Z(H);return te}:k;le.exports=V},oIFs:function(le,$,M){},oShl:function(le,$,M){var j=M("Nsbk"),Z=M("SksO"),Y=M("xfeJ"),k=M("sXyB");function h(V){var H=typeof Map=="function"?new Map:void 0;return le.exports=h=function(pe){if(pe===null||!Y(pe))return pe;if(typeof pe!="function")throw new TypeError("Super expression must either be null or a function");if(typeof H!="undefined"){if(H.has(pe))return H.get(pe);H.set(pe,Oe)}function Oe(){return k(pe,arguments,j(this).constructor)}return Oe.prototype=Object.create(pe.prototype,{constructor:{value:Oe,enumerable:!1,writable:!0,configurable:!0}}),Z(Oe,pe)},le.exports.__esModule=!0,le.exports.default=le.exports,h(V)}le.exports=h,le.exports.__esModule=!0,le.exports.default=le.exports},oaX6:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.targetName=void 0;var j=M("xfSm"),Z=M("GXnB"),Y=M("Ztfv");function k(h){return function(V,H,te){var pe=new Z.Metadata(j.NAME_TAG,h);Y.tagParameter(V,H,te,pe)}}$.targetName=k},"otv/":function(le,$,M){var j=M("nmnc"),Z=j?j.prototype:void 0,Y=Z?Z.valueOf:void 0;function k(h){return Y?Object(Y.call(h)):{}}le.exports=k},"oy+k":function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Context=void 0;var j=M("d9O0"),Z=function(){function Y(k){this.id=j.id(),this.container=k}return Y.prototype.addPlan=function(k){this.plan=k},Y.prototype.setCurrentRequest=function(k){this.currentRequest=k},Y}();$.Context=Z},pFRH:function(le,$,M){var j=M("cvCv"),Z=M("O0oS"),Y=M("zZ0H"),k=Z?function(h,V){return Z(h,"toString",{configurable:!0,enumerable:!1,value:j(V),writable:!0})}:Y;le.exports=k},q4HE:function(le,$){var M="\\ud800-\\udfff",j="\\u0300-\\u036f",Z="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",k=j+Z+Y,h="\\ufe0e\\ufe0f",V="["+M+"]",H="["+k+"]",te="\\ud83c[\\udffb-\\udfff]",pe="(?:"+H+"|"+te+")",Oe="[^"+M+"]",Ae="(?:\\ud83c[\\udde6-\\uddff]){2}",vt="[\\ud800-\\udbff][\\udc00-\\udfff]",at="\\u200d",gt=pe+"?",yt="["+h+"]?",St="(?:"+at+"(?:"+[Oe,Ae,vt].join("|")+")"+yt+gt+")*",He=yt+gt+St,dt="(?:"+[Oe+H+"?",H,Ae,vt,V].join("|")+")",ct=RegExp(te+"(?="+te+")|"+dt+He,"g");function _t(ee){for(var rr=ct.lastIndex=0;ct.test(ee);)++rr;return rr}le.exports=_t},qK8v:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.isStackOverflowExeption=void 0;var j=M("MON2");function Z(Y){return Y instanceof RangeError||Y.message===j.STACK_OVERFLOW}$.isStackOverflowExeption=Z},qRkn:function(le,$,M){var j=M("3cYt"),Z={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Y=j(Z);le.exports=Y},quyA:function(le,$){var M="\\ud800-\\udfff",j="\\u0300-\\u036f",Z="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",k=j+Z+Y,h="\\ufe0e\\ufe0f",V="\\u200d",H=RegExp("["+V+M+k+h+"]");function te(pe){return H.test(pe)}le.exports=te},sGsY:function(le,$,M){"use strict";var j=M("rePB"),Z=M("wx14"),Y=M("q1tI"),k=M("TSYQ"),h=M.n(k),V=M("H84U"),H=M("/ezw"),te=M("B6l+"),pe=M.n(te),Oe=function(kr){var be=kr.value,Ne=kr.formatter,Ie=kr.precision,pt=kr.decimalSeparator,mt=kr.groupSeparator,Dt=mt===void 0?"":mt,w=kr.prefixCls,br;if(typeof Ne=="function")br=Ne(be);else{var Ut=String(be),Xt=Ut.match(/^(-?)(\d*)(\.(\d+))?$/);if(!Xt||Ut==="-")br=Ut;else{var It=Xt[1],Lt=Xt[2]||"0",ir=Xt[4]||"";Lt=Lt.replace(/\B(?=(\d{3})+(?!\d))/g,Dt),typeof Ie=="number"&&(ir=pe()(ir,Ie,"0").slice(0,Ie)),ir&&(ir="".concat(pt).concat(ir)),br=[Y.createElement("span",{key:"int",className:"".concat(w,"-content-value-int")},It,Lt),ir&&Y.createElement("span",{key:"decimal",className:"".concat(w,"-content-value-decimal")},ir)]}}return Y.createElement("span",{className:"".concat(w,"-content-value")},br)},Ae=Oe,vt=function(kr){var be=kr.prefixCls,Ne=kr.className,Ie=kr.style,pt=kr.valueStyle,mt=kr.value,Dt=mt===void 0?0:mt,w=kr.title,br=kr.valueRender,Ut=kr.prefix,Xt=kr.suffix,It=kr.loading,Lt=kr.direction,ir=kr.onMouseEnter,Ar=kr.onMouseLeave,nr=Y.createElement(Ae,Object(Z.a)({},kr,{value:Dt})),Pr=h()(be,Object(j.a)({},"".concat(be,"-rtl"),Lt==="rtl"),Ne);return Y.createElement("div",{className:Pr,style:Ie,onMouseEnter:ir,onMouseLeave:Ar},w&&Y.createElement("div",{className:"".concat(be,"-title")},w),Y.createElement(H.a,{paragraph:!1,loading:It},Y.createElement("div",{style:pt,className:"".concat(be,"-content")},Ut&&Y.createElement("span",{className:"".concat(be,"-content-prefix")},Ut),br?br(nr):nr,Xt&&Y.createElement("span",{className:"".concat(be,"-content-suffix")},Xt))))};vt.defaultProps={decimalSeparator:".",groupSeparator:",",loading:!1};var at=Object(V.c)({prefixCls:"statistic"})(vt),gt=at,yt=M("1OyB"),St=M("vuIU"),He=M("Ji7U"),dt=M("LK+K"),ct=M("ODXe"),_t=M("QQZ/"),ee=M.n(_t),rr=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Fr(vn,kr){var be=vn,Ne=/\[[^\]]*]/g,Ie=(kr.match(Ne)||[]).map(function(w){return w.slice(1,-1)}),pt=kr.replace(Ne,"[]"),mt=rr.reduce(function(w,br){var Ut=Object(ct.a)(br,2),Xt=Ut[0],It=Ut[1];if(w.indexOf(Xt)!==-1){var Lt=Math.floor(be/It);return be-=Lt*It,w.replace(new RegExp("".concat(Xt,"+"),"g"),function(ir){var Ar=ir.length;return ee()(Lt.toString(),Ar,"0")})}return w},pt),Dt=0;return mt.replace(Ne,function(){var w=Ie[Dt];return Dt+=1,w})}function Mr(vn,kr){var be=kr.format,Ne=be===void 0?"":be,Ie=new Date(vn).getTime(),pt=Date.now(),mt=Math.max(Ie-pt,0);return Fr(mt,Ne)}var Nt=M("0n0R"),ze=1e3/30;function zt(vn){return new Date(vn).getTime()}var Kt=function(vn){Object(He.a)(be,vn);var kr=Object(dt.a)(be);function be(){var Ne;return Object(yt.a)(this,be),Ne=kr.apply(this,arguments),Ne.syncTimer=function(){var Ie=Ne.props.value,pt=zt(Ie);pt>=Date.now()?Ne.startTimer():Ne.stopTimer()},Ne.startTimer=function(){if(!Ne.countdownId){var Ie=Ne.props,pt=Ie.onChange,mt=Ie.value,Dt=zt(mt);Ne.countdownId=window.setInterval(function(){Ne.forceUpdate(),pt&&Dt>Date.now()&&pt(Dt-Date.now())},ze)}},Ne.stopTimer=function(){var Ie=Ne.props,pt=Ie.onFinish,mt=Ie.value;if(Ne.countdownId){clearInterval(Ne.countdownId),Ne.countdownId=void 0;var Dt=zt(mt);pt&&Dt<Date.now()&&pt()}},Ne.formatCountdown=function(Ie,pt){var mt=Ne.props.format;return Mr(Ie,Object(Z.a)(Object(Z.a)({},pt),{format:mt}))},Ne.valueRender=function(Ie){return Object(Nt.a)(Ie,{title:void 0})},Ne}return Object(St.a)(be,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return Y.createElement(gt,Object(Z.a)({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),be}(Y.Component);Kt.defaultProps={format:"HH:mm:ss"};var vr=Kt;gt.Countdown=vr;var jr=$.a=gt},sKgW:function(le,$){var M=9007199254740991,j=Math.floor;function Z(Y,k){var h="";if(!Y||k<1||k>M)return h;do k%2&&(h+=Y),k=j(k/2),k&&(Y+=Y);while(k);return h}le.exports=Z},sXyB:function(le,$,M){var j=M("SksO"),Z=M("b48C");function Y(k,h,V){return Z()?(le.exports=Y=Reflect.construct,le.exports.__esModule=!0,le.exports.default=le.exports):(le.exports=Y=function(te,pe,Oe){var Ae=[null];Ae.push.apply(Ae,pe);var vt=Function.bind.apply(te,Ae),at=new vt;return Oe&&j(at,Oe.prototype),at},le.exports.__esModule=!0,le.exports.default=le.exports),Y.apply(null,arguments)}le.exports=Y,le.exports.__esModule=!0,le.exports.default=le.exports},sgoq:function(le,$,M){var j=M("asDA"),Z=M("TKrE"),Y=M("6nK8"),k="['\u2019]",h=RegExp(k,"g");function V(H){return function(te){return j(Y(Z(te).replace(h,"")),H,"")}}le.exports=V},szb8:function(le,$,M){"use strict";M.r($),M.d($,"Interpreter",function(){return co}),M.d($,"vm",function(){return j}),M.d($,"evaluate",function(){return Nc}),M.d($,"Function",function(){return xl});var j={};M.r(j),M.d(j,"createContext",function(){return Po}),M.d(j,"compileFunction",function(){return Ha}),M.d(j,"runInContext",function(){return Wa}),M.d(j,"runInNewContext",function(){return Yh}),M.d(j,"Script",function(){return Bc});var Z={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},Y="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",k={5:Y,"5module":Y+" export import",6:Y+" const class extends export import super"},h=/^in(stanceof)?$/,V="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",H="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF\u1AC0\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F",te=new RegExp("["+V+"]"),pe=new RegExp("["+V+H+"]");V=H=null;var Oe=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],Ae=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function vt(b,L){for(var X=65536,B=0;B<L.length;B+=2){if(X+=L[B],X>b)return!1;if(X+=L[B+1],X>=b)return!0}}function at(b,L){return b<65?b===36:b<91?!0:b<97?b===95:b<123?!0:b<=65535?b>=170&&te.test(String.fromCharCode(b)):L===!1?!1:vt(b,Oe)}function gt(b,L){return b<48?b===36:b<58?!0:b<65?!1:b<91?!0:b<97?b===95:b<123?!0:b<=65535?b>=170&&pe.test(String.fromCharCode(b)):L===!1?!1:vt(b,Oe)||vt(b,Ae)}var yt=function(L,X){X===void 0&&(X={}),this.label=L,this.keyword=X.keyword,this.beforeExpr=!!X.beforeExpr,this.startsExpr=!!X.startsExpr,this.isLoop=!!X.isLoop,this.isAssign=!!X.isAssign,this.prefix=!!X.prefix,this.postfix=!!X.postfix,this.binop=X.binop||null,this.updateContext=null};function St(b,L){return new yt(b,{beforeExpr:!0,binop:L})}var He={beforeExpr:!0},dt={startsExpr:!0},ct={};function _t(b,L){return L===void 0&&(L={}),L.keyword=b,ct[b]=new yt(b,L)}var ee={num:new yt("num",dt),regexp:new yt("regexp",dt),string:new yt("string",dt),name:new yt("name",dt),eof:new yt("eof"),bracketL:new yt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new yt("]"),braceL:new yt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new yt("}"),parenL:new yt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new yt(")"),comma:new yt(",",He),semi:new yt(";",He),colon:new yt(":",He),dot:new yt("."),question:new yt("?",He),questionDot:new yt("?."),arrow:new yt("=>",He),template:new yt("template"),invalidTemplate:new yt("invalidTemplate"),ellipsis:new yt("...",He),backQuote:new yt("`",dt),dollarBraceL:new yt("${",{beforeExpr:!0,startsExpr:!0}),eq:new yt("=",{beforeExpr:!0,isAssign:!0}),assign:new yt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new yt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new yt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:St("||",1),logicalAND:St("&&",2),bitwiseOR:St("|",3),bitwiseXOR:St("^",4),bitwiseAND:St("&",5),equality:St("==/!=/===/!==",6),relational:St("</>/<=/>=",7),bitShift:St("<</>>/>>>",8),plusMin:new yt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:St("%",10),star:St("*",10),slash:St("/",10),starstar:new yt("**",{beforeExpr:!0}),coalesce:St("??",1),_break:_t("break"),_case:_t("case",He),_catch:_t("catch"),_continue:_t("continue"),_debugger:_t("debugger"),_default:_t("default",He),_do:_t("do",{isLoop:!0,beforeExpr:!0}),_else:_t("else",He),_finally:_t("finally"),_for:_t("for",{isLoop:!0}),_function:_t("function",dt),_if:_t("if"),_return:_t("return",He),_switch:_t("switch"),_throw:_t("throw",He),_try:_t("try"),_var:_t("var"),_const:_t("const"),_while:_t("while",{isLoop:!0}),_with:_t("with"),_new:_t("new",{beforeExpr:!0,startsExpr:!0}),_this:_t("this",dt),_super:_t("super",dt),_class:_t("class",dt),_extends:_t("extends",He),_export:_t("export"),_import:_t("import",dt),_null:_t("null",dt),_true:_t("true",dt),_false:_t("false",dt),_in:_t("in",{beforeExpr:!0,binop:7}),_instanceof:_t("instanceof",{beforeExpr:!0,binop:7}),_typeof:_t("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:_t("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:_t("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},rr=/\r\n?|\n|\u2028|\u2029/,Fr=new RegExp(rr.source,"g");function Mr(b,L){return b===10||b===13||!L&&(b===8232||b===8233)}var Nt=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,ze=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,zt=Object.prototype,Kt=zt.hasOwnProperty,vr=zt.toString;function jr(b,L){return Kt.call(b,L)}var vn=Array.isArray||function(b){return vr.call(b)==="[object Array]"};function kr(b){return new RegExp("^(?:"+b.replace(/ /g,"|")+")$")}var be=function(L,X){this.line=L,this.column=X};be.prototype.offset=function(L){return new be(this.line,this.column+L)};var Ne=function(L,X,B){this.start=X,this.end=B,L.sourceFile!==null&&(this.source=L.sourceFile)};function Ie(b,L){for(var X=1,B=0;;){Fr.lastIndex=B;var se=Fr.exec(b);if(se&&se.index<L)++X,B=se.index+se[0].length;else return new be(X,L-B)}}var pt={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function mt(b){var L={};for(var X in pt)L[X]=b&&jr(b,X)?b[X]:pt[X];if(L.ecmaVersion>=2015&&(L.ecmaVersion-=2009),L.allowReserved==null&&(L.allowReserved=L.ecmaVersion<5),vn(L.onToken)){var B=L.onToken;L.onToken=function(se){return B.push(se)}}return vn(L.onComment)&&(L.onComment=Dt(L,L.onComment)),L}function Dt(b,L){return function(X,B,se,Le,ot,Et){var Pt={type:X?"Block":"Line",value:B,start:se,end:Le};b.locations&&(Pt.loc=new Ne(this,ot,Et)),b.ranges&&(Pt.range=[se,Le]),L.push(Pt)}}var w=1,br=2,Ut=w|br,Xt=4,It=8,Lt=16,ir=32,Ar=64,nr=128;function Pr(b,L){return br|(b?Xt:0)|(L?It:0)}var $r=0,Or=1,_r=2,Br=3,Jn=4,mn=5,wn=function(L,X,B){this.options=L=mt(L),this.sourceFile=L.sourceFile,this.keywords=kr(k[L.ecmaVersion>=6?6:L.sourceType==="module"?"5module":5]);var se="";if(L.allowReserved!==!0){for(var Le=L.ecmaVersion;!(se=Z[Le]);Le--);L.sourceType==="module"&&(se+=" await")}this.reservedWords=kr(se);var ot=(se?se+" ":"")+Z.strict;this.reservedWordsStrict=kr(ot),this.reservedWordsStrictBind=kr(ot+" "+Z.strictBind),this.input=String(X),this.containsEsc=!1,B?(this.pos=B,this.lineStart=this.input.lastIndexOf(`
`,B-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(rr).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=ee.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=L.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},this.pos===0&&L.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(w),this.regexpState=null},pi={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};wn.prototype.parse=function(){var L=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(L)},pi.inFunction.get=function(){return(this.currentVarScope().flags&br)>0},pi.inGenerator.get=function(){return(this.currentVarScope().flags&It)>0},pi.inAsync.get=function(){return(this.currentVarScope().flags&Xt)>0},pi.allowSuper.get=function(){return(this.currentThisScope().flags&Ar)>0},pi.allowDirectSuper.get=function(){return(this.currentThisScope().flags&nr)>0},pi.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},wn.prototype.inNonArrowFunction=function(){return(this.currentThisScope().flags&br)>0},wn.extend=function(){for(var L=[],X=arguments.length;X--;)L[X]=arguments[X];for(var B=this,se=0;se<L.length;se++)B=L[se](B);return B},wn.parse=function(L,X){return new this(X,L).parse()},wn.parseExpressionAt=function(L,X,B){var se=new this(B,L,X);return se.nextToken(),se.parseExpression()},wn.tokenizer=function(L,X){return new this(X,L)},Object.defineProperties(wn.prototype,pi);var Ci=wn.prototype,fa=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;Ci.strictDirective=function(b){for(;;){ze.lastIndex=b,b+=ze.exec(this.input)[0].length;var L=fa.exec(this.input.slice(b));if(!L)return!1;if((L[1]||L[2])==="use strict"){ze.lastIndex=b+L[0].length;var X=ze.exec(this.input),B=X.index+X[0].length,se=this.input.charAt(B);return se===";"||se==="}"||rr.test(X[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(se)||se==="!"&&this.input.charAt(B+1)==="=")}b+=L[0].length,ze.lastIndex=b,b+=ze.exec(this.input)[0].length,this.input[b]===";"&&b++}},Ci.eat=function(b){return this.type===b?(this.next(),!0):!1},Ci.isContextual=function(b){return this.type===ee.name&&this.value===b&&!this.containsEsc},Ci.eatContextual=function(b){return this.isContextual(b)?(this.next(),!0):!1},Ci.expectContextual=function(b){this.eatContextual(b)||this.unexpected()},Ci.canInsertSemicolon=function(){return this.type===ee.eof||this.type===ee.braceR||rr.test(this.input.slice(this.lastTokEnd,this.start))},Ci.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},Ci.semicolon=function(){!this.eat(ee.semi)&&!this.insertSemicolon()&&this.unexpected()},Ci.afterTrailingComma=function(b,L){if(this.type===b)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),L||this.next(),!0},Ci.expect=function(b){this.eat(b)||this.unexpected()},Ci.unexpected=function(b){this.raise(b!=null?b:this.start,"Unexpected token")};function _e(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}Ci.checkPatternErrors=function(b,L){if(!!b){b.trailingComma>-1&&this.raiseRecoverable(b.trailingComma,"Comma is not permitted after the rest element");var X=L?b.parenthesizedAssign:b.parenthesizedBind;X>-1&&this.raiseRecoverable(X,"Parenthesized pattern")}},Ci.checkExpressionErrors=function(b,L){if(!b)return!1;var X=b.shorthandAssign,B=b.doubleProto;if(!L)return X>=0||B>=0;X>=0&&this.raise(X,"Shorthand property assignments are valid only in destructuring patterns"),B>=0&&this.raiseRecoverable(B,"Redefinition of __proto__ property")},Ci.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},Ci.isSimpleAssignTarget=function(b){return b.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(b.expression):b.type==="Identifier"||b.type==="MemberExpression"};var Pn=wn.prototype;Pn.parseTopLevel=function(b){var L={};for(b.body||(b.body=[]);this.type!==ee.eof;){var X=this.parseStatement(null,!0,L);b.body.push(X)}if(this.inModule)for(var B=0,se=Object.keys(this.undefinedExports);B<se.length;B+=1){var Le=se[B];this.raiseRecoverable(this.undefinedExports[Le].start,"Export '"+Le+"' is not defined")}return this.adaptDirectivePrologue(b.body),this.next(),b.sourceType=this.options.sourceType,this.finishNode(b,"Program")};var oa={kind:"loop"},ws={kind:"switch"};Pn.isLet=function(b){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;ze.lastIndex=this.pos;var L=ze.exec(this.input),X=this.pos+L[0].length,B=this.input.charCodeAt(X);if(B===91)return!0;if(b)return!1;if(B===123)return!0;if(at(B,!0)){for(var se=X+1;gt(this.input.charCodeAt(se),!0);)++se;var Le=this.input.slice(X,se);if(!h.test(Le))return!0}return!1},Pn.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;ze.lastIndex=this.pos;var b=ze.exec(this.input),L=this.pos+b[0].length;return!rr.test(this.input.slice(this.pos,L))&&this.input.slice(L,L+8)==="function"&&(L+8===this.input.length||!gt(this.input.charAt(L+8)))},Pn.parseStatement=function(b,L,X){var B=this.type,se=this.startNode(),Le;switch(this.isLet(b)&&(B=ee._var,Le="let"),B){case ee._break:case ee._continue:return this.parseBreakContinueStatement(se,B.keyword);case ee._debugger:return this.parseDebuggerStatement(se);case ee._do:return this.parseDoStatement(se);case ee._for:return this.parseForStatement(se);case ee._function:return b&&(this.strict||b!=="if"&&b!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(se,!1,!b);case ee._class:return b&&this.unexpected(),this.parseClass(se,!0);case ee._if:return this.parseIfStatement(se);case ee._return:return this.parseReturnStatement(se);case ee._switch:return this.parseSwitchStatement(se);case ee._throw:return this.parseThrowStatement(se);case ee._try:return this.parseTryStatement(se);case ee._const:case ee._var:return Le=Le||this.value,b&&Le!=="var"&&this.unexpected(),this.parseVarStatement(se,Le);case ee._while:return this.parseWhileStatement(se);case ee._with:return this.parseWithStatement(se);case ee.braceL:return this.parseBlock(!0,se);case ee.semi:return this.parseEmptyStatement(se);case ee._export:case ee._import:if(this.options.ecmaVersion>10&&B===ee._import){ze.lastIndex=this.pos;var ot=ze.exec(this.input),Et=this.pos+ot[0].length,Pt=this.input.charCodeAt(Et);if(Pt===40||Pt===46)return this.parseExpressionStatement(se,this.parseExpression())}return this.options.allowImportExportEverywhere||(L||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),B===ee._import?this.parseImport(se):this.parseExport(se,X);default:if(this.isAsyncFunction())return b&&this.unexpected(),this.next(),this.parseFunctionStatement(se,!0,!b);var zr=this.value,Kr=this.parseExpression();return B===ee.name&&Kr.type==="Identifier"&&this.eat(ee.colon)?this.parseLabeledStatement(se,zr,Kr,b):this.parseExpressionStatement(se,Kr)}},Pn.parseBreakContinueStatement=function(b,L){var X=L==="break";this.next(),this.eat(ee.semi)||this.insertSemicolon()?b.label=null:this.type!==ee.name?this.unexpected():(b.label=this.parseIdent(),this.semicolon());for(var B=0;B<this.labels.length;++B){var se=this.labels[B];if((b.label==null||se.name===b.label.name)&&(se.kind!=null&&(X||se.kind==="loop")||b.label&&X))break}return B===this.labels.length&&this.raise(b.start,"Unsyntactic "+L),this.finishNode(b,X?"BreakStatement":"ContinueStatement")},Pn.parseDebuggerStatement=function(b){return this.next(),this.semicolon(),this.finishNode(b,"DebuggerStatement")},Pn.parseDoStatement=function(b){return this.next(),this.labels.push(oa),b.body=this.parseStatement("do"),this.labels.pop(),this.expect(ee._while),b.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(ee.semi):this.semicolon(),this.finishNode(b,"DoWhileStatement")},Pn.parseForStatement=function(b){this.next();var L=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(oa),this.enterScope(0),this.expect(ee.parenL),this.type===ee.semi)return L>-1&&this.unexpected(L),this.parseFor(b,null);var X=this.isLet();if(this.type===ee._var||this.type===ee._const||X){var B=this.startNode(),se=X?"let":this.value;return this.next(),this.parseVar(B,!0,se),this.finishNode(B,"VariableDeclaration"),(this.type===ee._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&B.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===ee._in?L>-1&&this.unexpected(L):b.await=L>-1),this.parseForIn(b,B)):(L>-1&&this.unexpected(L),this.parseFor(b,B))}var Le=new _e,ot=this.parseExpression(!0,Le);return this.type===ee._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===ee._in?L>-1&&this.unexpected(L):b.await=L>-1),this.toAssignable(ot,!1,Le),this.checkLVal(ot),this.parseForIn(b,ot)):(this.checkExpressionErrors(Le,!0),L>-1&&this.unexpected(L),this.parseFor(b,ot))},Pn.parseFunctionStatement=function(b,L,X){return this.next(),this.parseFunction(b,Jt|(X?0:Ir),!1,L)},Pn.parseIfStatement=function(b){return this.next(),b.test=this.parseParenExpression(),b.consequent=this.parseStatement("if"),b.alternate=this.eat(ee._else)?this.parseStatement("if"):null,this.finishNode(b,"IfStatement")},Pn.parseReturnStatement=function(b){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(ee.semi)||this.insertSemicolon()?b.argument=null:(b.argument=this.parseExpression(),this.semicolon()),this.finishNode(b,"ReturnStatement")},Pn.parseSwitchStatement=function(b){this.next(),b.discriminant=this.parseParenExpression(),b.cases=[],this.expect(ee.braceL),this.labels.push(ws),this.enterScope(0);for(var L,X=!1;this.type!==ee.braceR;)if(this.type===ee._case||this.type===ee._default){var B=this.type===ee._case;L&&this.finishNode(L,"SwitchCase"),b.cases.push(L=this.startNode()),L.consequent=[],this.next(),B?L.test=this.parseExpression():(X&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),X=!0,L.test=null),this.expect(ee.colon)}else L||this.unexpected(),L.consequent.push(this.parseStatement(null));return this.exitScope(),L&&this.finishNode(L,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(b,"SwitchStatement")},Pn.parseThrowStatement=function(b){return this.next(),rr.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),b.argument=this.parseExpression(),this.semicolon(),this.finishNode(b,"ThrowStatement")};var ys=[];Pn.parseTryStatement=function(b){if(this.next(),b.block=this.parseBlock(),b.handler=null,this.type===ee._catch){var L=this.startNode();if(this.next(),this.eat(ee.parenL)){L.param=this.parseBindingAtom();var X=L.param.type==="Identifier";this.enterScope(X?ir:0),this.checkLVal(L.param,X?Jn:_r),this.expect(ee.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),L.param=null,this.enterScope(0);L.body=this.parseBlock(!1),this.exitScope(),b.handler=this.finishNode(L,"CatchClause")}return b.finalizer=this.eat(ee._finally)?this.parseBlock():null,!b.handler&&!b.finalizer&&this.raise(b.start,"Missing catch or finally clause"),this.finishNode(b,"TryStatement")},Pn.parseVarStatement=function(b,L){return this.next(),this.parseVar(b,!1,L),this.semicolon(),this.finishNode(b,"VariableDeclaration")},Pn.parseWhileStatement=function(b){return this.next(),b.test=this.parseParenExpression(),this.labels.push(oa),b.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(b,"WhileStatement")},Pn.parseWithStatement=function(b){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),b.object=this.parseParenExpression(),b.body=this.parseStatement("with"),this.finishNode(b,"WithStatement")},Pn.parseEmptyStatement=function(b){return this.next(),this.finishNode(b,"EmptyStatement")},Pn.parseLabeledStatement=function(b,L,X,B){for(var se=0,Le=this.labels;se<Le.length;se+=1){var ot=Le[se];ot.name===L&&this.raise(X.start,"Label '"+L+"' is already declared")}for(var Et=this.type.isLoop?"loop":this.type===ee._switch?"switch":null,Pt=this.labels.length-1;Pt>=0;Pt--){var zr=this.labels[Pt];if(zr.statementStart===b.start)zr.statementStart=this.start,zr.kind=Et;else break}return this.labels.push({name:L,kind:Et,statementStart:this.start}),b.body=this.parseStatement(B?B.indexOf("label")===-1?B+"label":B:"label"),this.labels.pop(),b.label=X,this.finishNode(b,"LabeledStatement")},Pn.parseExpressionStatement=function(b,L){return b.expression=L,this.semicolon(),this.finishNode(b,"ExpressionStatement")},Pn.parseBlock=function(b,L,X){for(b===void 0&&(b=!0),L===void 0&&(L=this.startNode()),L.body=[],this.expect(ee.braceL),b&&this.enterScope(0);this.type!==ee.braceR;){var B=this.parseStatement(null);L.body.push(B)}return X&&(this.strict=!1),this.next(),b&&this.exitScope(),this.finishNode(L,"BlockStatement")},Pn.parseFor=function(b,L){return b.init=L,this.expect(ee.semi),b.test=this.type===ee.semi?null:this.parseExpression(),this.expect(ee.semi),b.update=this.type===ee.parenR?null:this.parseExpression(),this.expect(ee.parenR),b.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(b,"ForStatement")},Pn.parseForIn=function(b,L){var X=this.type===ee._in;return this.next(),L.type==="VariableDeclaration"&&L.declarations[0].init!=null&&(!X||this.options.ecmaVersion<8||this.strict||L.kind!=="var"||L.declarations[0].id.type!=="Identifier")?this.raise(L.start,(X?"for-in":"for-of")+" loop variable declaration may not have an initializer"):L.type==="AssignmentPattern"&&this.raise(L.start,"Invalid left-hand side in for-loop"),b.left=L,b.right=X?this.parseExpression():this.parseMaybeAssign(),this.expect(ee.parenR),b.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(b,X?"ForInStatement":"ForOfStatement")},Pn.parseVar=function(b,L,X){for(b.declarations=[],b.kind=X;;){var B=this.startNode();if(this.parseVarId(B,X),this.eat(ee.eq)?B.init=this.parseMaybeAssign(L):X==="const"&&!(this.type===ee._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():B.id.type!=="Identifier"&&!(L&&(this.type===ee._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):B.init=null,b.declarations.push(this.finishNode(B,"VariableDeclarator")),!this.eat(ee.comma))break}return b},Pn.parseVarId=function(b,L){b.id=this.parseBindingAtom(),this.checkLVal(b.id,L==="var"?Or:_r,!1)};var Jt=1,Ir=2,en=4;Pn.parseFunction=function(b,L,X,B){this.initFunction(b),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!B)&&(this.type===ee.star&&L&Ir&&this.unexpected(),b.generator=this.eat(ee.star)),this.options.ecmaVersion>=8&&(b.async=!!B),L&Jt&&(b.id=L&en&&this.type!==ee.name?null:this.parseIdent(),b.id&&!(L&Ir)&&this.checkLVal(b.id,this.strict||b.generator||b.async?this.treatFunctionsAsVar?Or:_r:Br));var se=this.yieldPos,Le=this.awaitPos,ot=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Pr(b.async,b.generator)),L&Jt||(b.id=this.type===ee.name?this.parseIdent():null),this.parseFunctionParams(b),this.parseFunctionBody(b,X,!1),this.yieldPos=se,this.awaitPos=Le,this.awaitIdentPos=ot,this.finishNode(b,L&Jt?"FunctionDeclaration":"FunctionExpression")},Pn.parseFunctionParams=function(b){this.expect(ee.parenL),b.params=this.parseBindingList(ee.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},Pn.parseClass=function(b,L){this.next();var X=this.strict;this.strict=!0,this.parseClassId(b,L),this.parseClassSuper(b);var B=this.startNode(),se=!1;for(B.body=[],this.expect(ee.braceL);this.type!==ee.braceR;){var Le=this.parseClassElement(b.superClass!==null);Le&&(B.body.push(Le),Le.type==="MethodDefinition"&&Le.kind==="constructor"&&(se&&this.raise(Le.start,"Duplicate constructor in the same class"),se=!0))}return this.strict=X,this.next(),b.body=this.finishNode(B,"ClassBody"),this.finishNode(b,L?"ClassDeclaration":"ClassExpression")},Pn.parseClassElement=function(b){var L=this;if(this.eat(ee.semi))return null;var X=this.startNode(),B=function(zr,Kr){Kr===void 0&&(Kr=!1);var oi=L.start,Ki=L.startLoc;return L.eatContextual(zr)?L.type!==ee.parenL&&(!Kr||!L.canInsertSemicolon())?!0:(X.key&&L.unexpected(),X.computed=!1,X.key=L.startNodeAt(oi,Ki),X.key.name=zr,L.finishNode(X.key,"Identifier"),!1):!1};X.kind="method",X.static=B("static");var se=this.eat(ee.star),Le=!1;se||(this.options.ecmaVersion>=8&&B("async",!0)?(Le=!0,se=this.options.ecmaVersion>=9&&this.eat(ee.star)):B("get")?X.kind="get":B("set")&&(X.kind="set")),X.key||this.parsePropertyName(X);var ot=X.key,Et=!1;return!X.computed&&!X.static&&(ot.type==="Identifier"&&ot.name==="constructor"||ot.type==="Literal"&&ot.value==="constructor")?(X.kind!=="method"&&this.raise(ot.start,"Constructor can't have get/set modifier"),se&&this.raise(ot.start,"Constructor can't be a generator"),Le&&this.raise(ot.start,"Constructor can't be an async method"),X.kind="constructor",Et=b):X.static&&ot.type==="Identifier"&&ot.name==="prototype"&&this.raise(ot.start,"Classes may not have a static property named prototype"),this.parseClassMethod(X,se,Le,Et),X.kind==="get"&&X.value.params.length!==0&&this.raiseRecoverable(X.value.start,"getter should have no params"),X.kind==="set"&&X.value.params.length!==1&&this.raiseRecoverable(X.value.start,"setter should have exactly one param"),X.kind==="set"&&X.value.params[0].type==="RestElement"&&this.raiseRecoverable(X.value.params[0].start,"Setter cannot use rest params"),X},Pn.parseClassMethod=function(b,L,X,B){return b.value=this.parseMethod(L,X,B),this.finishNode(b,"MethodDefinition")},Pn.parseClassId=function(b,L){this.type===ee.name?(b.id=this.parseIdent(),L&&this.checkLVal(b.id,_r,!1)):(L===!0&&this.unexpected(),b.id=null)},Pn.parseClassSuper=function(b){b.superClass=this.eat(ee._extends)?this.parseExprSubscripts():null},Pn.parseExport=function(b,L){if(this.next(),this.eat(ee.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(b.exported=this.parseIdent(!0),this.checkExport(L,b.exported.name,this.lastTokStart)):b.exported=null),this.expectContextual("from"),this.type!==ee.string&&this.unexpected(),b.source=this.parseExprAtom(),this.semicolon(),this.finishNode(b,"ExportAllDeclaration");if(this.eat(ee._default)){this.checkExport(L,"default",this.lastTokStart);var X;if(this.type===ee._function||(X=this.isAsyncFunction())){var B=this.startNode();this.next(),X&&this.next(),b.declaration=this.parseFunction(B,Jt|en,!1,X)}else if(this.type===ee._class){var se=this.startNode();b.declaration=this.parseClass(se,"nullableID")}else b.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(b,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())b.declaration=this.parseStatement(null),b.declaration.type==="VariableDeclaration"?this.checkVariableExport(L,b.declaration.declarations):this.checkExport(L,b.declaration.id.name,b.declaration.id.start),b.specifiers=[],b.source=null;else{if(b.declaration=null,b.specifiers=this.parseExportSpecifiers(L),this.eatContextual("from"))this.type!==ee.string&&this.unexpected(),b.source=this.parseExprAtom();else{for(var Le=0,ot=b.specifiers;Le<ot.length;Le+=1){var Et=ot[Le];this.checkUnreserved(Et.local),this.checkLocalExport(Et.local)}b.source=null}this.semicolon()}return this.finishNode(b,"ExportNamedDeclaration")},Pn.checkExport=function(b,L,X){!b||(jr(b,L)&&this.raiseRecoverable(X,"Duplicate export '"+L+"'"),b[L]=!0)},Pn.checkPatternExport=function(b,L){var X=L.type;if(X==="Identifier")this.checkExport(b,L.name,L.start);else if(X==="ObjectPattern")for(var B=0,se=L.properties;B<se.length;B+=1){var Le=se[B];this.checkPatternExport(b,Le)}else if(X==="ArrayPattern")for(var ot=0,Et=L.elements;ot<Et.length;ot+=1){var Pt=Et[ot];Pt&&this.checkPatternExport(b,Pt)}else X==="Property"?this.checkPatternExport(b,L.value):X==="AssignmentPattern"?this.checkPatternExport(b,L.left):X==="RestElement"?this.checkPatternExport(b,L.argument):X==="ParenthesizedExpression"&&this.checkPatternExport(b,L.expression)},Pn.checkVariableExport=function(b,L){if(!!b)for(var X=0,B=L;X<B.length;X+=1){var se=B[X];this.checkPatternExport(b,se.id)}},Pn.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},Pn.parseExportSpecifiers=function(b){var L=[],X=!0;for(this.expect(ee.braceL);!this.eat(ee.braceR);){if(X)X=!1;else if(this.expect(ee.comma),this.afterTrailingComma(ee.braceR))break;var B=this.startNode();B.local=this.parseIdent(!0),B.exported=this.eatContextual("as")?this.parseIdent(!0):B.local,this.checkExport(b,B.exported.name,B.exported.start),L.push(this.finishNode(B,"ExportSpecifier"))}return L},Pn.parseImport=function(b){return this.next(),this.type===ee.string?(b.specifiers=ys,b.source=this.parseExprAtom()):(b.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),b.source=this.type===ee.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(b,"ImportDeclaration")},Pn.parseImportSpecifiers=function(){var b=[],L=!0;if(this.type===ee.name){var X=this.startNode();if(X.local=this.parseIdent(),this.checkLVal(X.local,_r),b.push(this.finishNode(X,"ImportDefaultSpecifier")),!this.eat(ee.comma))return b}if(this.type===ee.star){var B=this.startNode();return this.next(),this.expectContextual("as"),B.local=this.parseIdent(),this.checkLVal(B.local,_r),b.push(this.finishNode(B,"ImportNamespaceSpecifier")),b}for(this.expect(ee.braceL);!this.eat(ee.braceR);){if(L)L=!1;else if(this.expect(ee.comma),this.afterTrailingComma(ee.braceR))break;var se=this.startNode();se.imported=this.parseIdent(!0),this.eatContextual("as")?se.local=this.parseIdent():(this.checkUnreserved(se.imported),se.local=se.imported),this.checkLVal(se.local,_r),b.push(this.finishNode(se,"ImportSpecifier"))}return b},Pn.adaptDirectivePrologue=function(b){for(var L=0;L<b.length&&this.isDirectiveCandidate(b[L]);++L)b[L].directive=b[L].expression.raw.slice(1,-1)},Pn.isDirectiveCandidate=function(b){return b.type==="ExpressionStatement"&&b.expression.type==="Literal"&&typeof b.expression.value=="string"&&(this.input[b.start]==='"'||this.input[b.start]==="'")};var On=wn.prototype;On.toAssignable=function(b,L,X){if(this.options.ecmaVersion>=6&&b)switch(b.type){case"Identifier":this.inAsync&&b.name==="await"&&this.raise(b.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":b.type="ObjectPattern",X&&this.checkPatternErrors(X,!0);for(var B=0,se=b.properties;B<se.length;B+=1){var Le=se[B];this.toAssignable(Le,L),Le.type==="RestElement"&&(Le.argument.type==="ArrayPattern"||Le.argument.type==="ObjectPattern")&&this.raise(Le.argument.start,"Unexpected token")}break;case"Property":b.kind!=="init"&&this.raise(b.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(b.value,L);break;case"ArrayExpression":b.type="ArrayPattern",X&&this.checkPatternErrors(X,!0),this.toAssignableList(b.elements,L);break;case"SpreadElement":b.type="RestElement",this.toAssignable(b.argument,L),b.argument.type==="AssignmentPattern"&&this.raise(b.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":b.operator!=="="&&this.raise(b.left.end,"Only '=' operator can be used for specifying default value."),b.type="AssignmentPattern",delete b.operator,this.toAssignable(b.left,L);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(b.expression,L,X);break;case"ChainExpression":this.raiseRecoverable(b.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!L)break;default:this.raise(b.start,"Assigning to rvalue")}else X&&this.checkPatternErrors(X,!0);return b},On.toAssignableList=function(b,L){for(var X=b.length,B=0;B<X;B++){var se=b[B];se&&this.toAssignable(se,L)}if(X){var Le=b[X-1];this.options.ecmaVersion===6&&L&&Le&&Le.type==="RestElement"&&Le.argument.type!=="Identifier"&&this.unexpected(Le.argument.start)}return b},On.parseSpread=function(b){var L=this.startNode();return this.next(),L.argument=this.parseMaybeAssign(!1,b),this.finishNode(L,"SpreadElement")},On.parseRestBinding=function(){var b=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==ee.name&&this.unexpected(),b.argument=this.parseBindingAtom(),this.finishNode(b,"RestElement")},On.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case ee.bracketL:var b=this.startNode();return this.next(),b.elements=this.parseBindingList(ee.bracketR,!0,!0),this.finishNode(b,"ArrayPattern");case ee.braceL:return this.parseObj(!0)}return this.parseIdent()},On.parseBindingList=function(b,L,X){for(var B=[],se=!0;!this.eat(b);)if(se?se=!1:this.expect(ee.comma),L&&this.type===ee.comma)B.push(null);else{if(X&&this.afterTrailingComma(b))break;if(this.type===ee.ellipsis){var Le=this.parseRestBinding();this.parseBindingListItem(Le),B.push(Le),this.type===ee.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(b);break}else{var ot=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(ot),B.push(ot)}}return B},On.parseBindingListItem=function(b){return b},On.parseMaybeDefault=function(b,L,X){if(X=X||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(ee.eq))return X;var B=this.startNodeAt(b,L);return B.left=X,B.right=this.parseMaybeAssign(),this.finishNode(B,"AssignmentPattern")},On.checkLVal=function(b,L,X){switch(L===void 0&&(L=$r),b.type){case"Identifier":L===_r&&b.name==="let"&&this.raiseRecoverable(b.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(b.name)&&this.raiseRecoverable(b.start,(L?"Binding ":"Assigning to ")+b.name+" in strict mode"),X&&(jr(X,b.name)&&this.raiseRecoverable(b.start,"Argument name clash"),X[b.name]=!0),L!==$r&&L!==mn&&this.declareName(b.name,L,b.start);break;case"ChainExpression":this.raiseRecoverable(b.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":L&&this.raiseRecoverable(b.start,"Binding member expression");break;case"ObjectPattern":for(var B=0,se=b.properties;B<se.length;B+=1){var Le=se[B];this.checkLVal(Le,L,X)}break;case"Property":this.checkLVal(b.value,L,X);break;case"ArrayPattern":for(var ot=0,Et=b.elements;ot<Et.length;ot+=1){var Pt=Et[ot];Pt&&this.checkLVal(Pt,L,X)}break;case"AssignmentPattern":this.checkLVal(b.left,L,X);break;case"RestElement":this.checkLVal(b.argument,L,X);break;case"ParenthesizedExpression":this.checkLVal(b.expression,L,X);break;default:this.raise(b.start,(L?"Binding":"Assigning to")+" rvalue")}};var ln=wn.prototype;ln.checkPropClash=function(b,L,X){if(!(this.options.ecmaVersion>=9&&b.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(b.computed||b.method||b.shorthand))){var B=b.key,se;switch(B.type){case"Identifier":se=B.name;break;case"Literal":se=String(B.value);break;default:return}var Le=b.kind;if(this.options.ecmaVersion>=6){se==="__proto__"&&Le==="init"&&(L.proto&&(X?X.doubleProto<0&&(X.doubleProto=B.start):this.raiseRecoverable(B.start,"Redefinition of __proto__ property")),L.proto=!0);return}se="$"+se;var ot=L[se];if(ot){var Et;Le==="init"?Et=this.strict&&ot.init||ot.get||ot.set:Et=ot.init||ot[Le],Et&&this.raiseRecoverable(B.start,"Redefinition of property")}else ot=L[se]={init:!1,get:!1,set:!1};ot[Le]=!0}},ln.parseExpression=function(b,L){var X=this.start,B=this.startLoc,se=this.parseMaybeAssign(b,L);if(this.type===ee.comma){var Le=this.startNodeAt(X,B);for(Le.expressions=[se];this.eat(ee.comma);)Le.expressions.push(this.parseMaybeAssign(b,L));return this.finishNode(Le,"SequenceExpression")}return se},ln.parseMaybeAssign=function(b,L,X){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(b);this.exprAllowed=!1}var B=!1,se=-1,Le=-1;L?(se=L.parenthesizedAssign,Le=L.trailingComma,L.parenthesizedAssign=L.trailingComma=-1):(L=new _e,B=!0);var ot=this.start,Et=this.startLoc;(this.type===ee.parenL||this.type===ee.name)&&(this.potentialArrowAt=this.start);var Pt=this.parseMaybeConditional(b,L);if(X&&(Pt=X.call(this,Pt,ot,Et)),this.type.isAssign){var zr=this.startNodeAt(ot,Et);return zr.operator=this.value,zr.left=this.type===ee.eq?this.toAssignable(Pt,!1,L):Pt,B||(L.parenthesizedAssign=L.trailingComma=L.doubleProto=-1),L.shorthandAssign>=zr.left.start&&(L.shorthandAssign=-1),this.checkLVal(Pt),this.next(),zr.right=this.parseMaybeAssign(b),this.finishNode(zr,"AssignmentExpression")}else B&&this.checkExpressionErrors(L,!0);return se>-1&&(L.parenthesizedAssign=se),Le>-1&&(L.trailingComma=Le),Pt},ln.parseMaybeConditional=function(b,L){var X=this.start,B=this.startLoc,se=this.parseExprOps(b,L);if(this.checkExpressionErrors(L))return se;if(this.eat(ee.question)){var Le=this.startNodeAt(X,B);return Le.test=se,Le.consequent=this.parseMaybeAssign(),this.expect(ee.colon),Le.alternate=this.parseMaybeAssign(b),this.finishNode(Le,"ConditionalExpression")}return se},ln.parseExprOps=function(b,L){var X=this.start,B=this.startLoc,se=this.parseMaybeUnary(L,!1);return this.checkExpressionErrors(L)||se.start===X&&se.type==="ArrowFunctionExpression"?se:this.parseExprOp(se,X,B,-1,b)},ln.parseExprOp=function(b,L,X,B,se){var Le=this.type.binop;if(Le!=null&&(!se||this.type!==ee._in)&&Le>B){var ot=this.type===ee.logicalOR||this.type===ee.logicalAND,Et=this.type===ee.coalesce;Et&&(Le=ee.logicalAND.binop);var Pt=this.value;this.next();var zr=this.start,Kr=this.startLoc,oi=this.parseExprOp(this.parseMaybeUnary(null,!1),zr,Kr,Le,se),Ki=this.buildBinary(L,X,b,oi,Pt,ot||Et);return(ot&&this.type===ee.coalesce||Et&&(this.type===ee.logicalOR||this.type===ee.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(Ki,L,X,B,se)}return b},ln.buildBinary=function(b,L,X,B,se,Le){var ot=this.startNodeAt(b,L);return ot.left=X,ot.operator=se,ot.right=B,this.finishNode(ot,Le?"LogicalExpression":"BinaryExpression")},ln.parseMaybeUnary=function(b,L){var X=this.start,B=this.startLoc,se;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))se=this.parseAwait(),L=!0;else if(this.type.prefix){var Le=this.startNode(),ot=this.type===ee.incDec;Le.operator=this.value,Le.prefix=!0,this.next(),Le.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(b,!0),ot?this.checkLVal(Le.argument):this.strict&&Le.operator==="delete"&&Le.argument.type==="Identifier"?this.raiseRecoverable(Le.start,"Deleting local variable in strict mode"):L=!0,se=this.finishNode(Le,ot?"UpdateExpression":"UnaryExpression")}else{if(se=this.parseExprSubscripts(b),this.checkExpressionErrors(b))return se;for(;this.type.postfix&&!this.canInsertSemicolon();){var Et=this.startNodeAt(X,B);Et.operator=this.value,Et.prefix=!1,Et.argument=se,this.checkLVal(se),this.next(),se=this.finishNode(Et,"UpdateExpression")}}return!L&&this.eat(ee.starstar)?this.buildBinary(X,B,se,this.parseMaybeUnary(null,!1),"**",!1):se},ln.parseExprSubscripts=function(b){var L=this.start,X=this.startLoc,B=this.parseExprAtom(b);if(B.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return B;var se=this.parseSubscripts(B,L,X);return b&&se.type==="MemberExpression"&&(b.parenthesizedAssign>=se.start&&(b.parenthesizedAssign=-1),b.parenthesizedBind>=se.start&&(b.parenthesizedBind=-1)),se},ln.parseSubscripts=function(b,L,X,B){for(var se=this.options.ecmaVersion>=8&&b.type==="Identifier"&&b.name==="async"&&this.lastTokEnd===b.end&&!this.canInsertSemicolon()&&b.end-b.start==5&&this.potentialArrowAt===b.start,Le=!1;;){var ot=this.parseSubscript(b,L,X,B,se,Le);if(ot.optional&&(Le=!0),ot===b||ot.type==="ArrowFunctionExpression"){if(Le){var Et=this.startNodeAt(L,X);Et.expression=ot,ot=this.finishNode(Et,"ChainExpression")}return ot}b=ot}},ln.parseSubscript=function(b,L,X,B,se,Le){var ot=this.options.ecmaVersion>=11,Et=ot&&this.eat(ee.questionDot);B&&Et&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var Pt=this.eat(ee.bracketL);if(Pt||Et&&this.type!==ee.parenL&&this.type!==ee.backQuote||this.eat(ee.dot)){var zr=this.startNodeAt(L,X);zr.object=b,zr.property=Pt?this.parseExpression():this.parseIdent(this.options.allowReserved!=="never"),zr.computed=!!Pt,Pt&&this.expect(ee.bracketR),ot&&(zr.optional=Et),b=this.finishNode(zr,"MemberExpression")}else if(!B&&this.eat(ee.parenL)){var Kr=new _e,oi=this.yieldPos,Ki=this.awaitPos,Li=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var Oa=this.parseExprList(ee.parenR,this.options.ecmaVersion>=8,!1,Kr);if(se&&!Et&&!this.canInsertSemicolon()&&this.eat(ee.arrow))return this.checkPatternErrors(Kr,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=oi,this.awaitPos=Ki,this.awaitIdentPos=Li,this.parseArrowExpression(this.startNodeAt(L,X),Oa,!0);this.checkExpressionErrors(Kr,!0),this.yieldPos=oi||this.yieldPos,this.awaitPos=Ki||this.awaitPos,this.awaitIdentPos=Li||this.awaitIdentPos;var sa=this.startNodeAt(L,X);sa.callee=b,sa.arguments=Oa,ot&&(sa.optional=Et),b=this.finishNode(sa,"CallExpression")}else if(this.type===ee.backQuote){(Et||Le)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var Va=this.startNodeAt(L,X);Va.tag=b,Va.quasi=this.parseTemplate({isTagged:!0}),b=this.finishNode(Va,"TaggedTemplateExpression")}return b},ln.parseExprAtom=function(b){this.type===ee.slash&&this.readRegexp();var L,X=this.potentialArrowAt===this.start;switch(this.type){case ee._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),L=this.startNode(),this.next(),this.type===ee.parenL&&!this.allowDirectSuper&&this.raise(L.start,"super() call outside constructor of a subclass"),this.type!==ee.dot&&this.type!==ee.bracketL&&this.type!==ee.parenL&&this.unexpected(),this.finishNode(L,"Super");case ee._this:return L=this.startNode(),this.next(),this.finishNode(L,"ThisExpression");case ee.name:var B=this.start,se=this.startLoc,Le=this.containsEsc,ot=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!Le&&ot.name==="async"&&!this.canInsertSemicolon()&&this.eat(ee._function))return this.parseFunction(this.startNodeAt(B,se),0,!1,!0);if(X&&!this.canInsertSemicolon()){if(this.eat(ee.arrow))return this.parseArrowExpression(this.startNodeAt(B,se),[ot],!1);if(this.options.ecmaVersion>=8&&ot.name==="async"&&this.type===ee.name&&!Le)return ot=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(ee.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(B,se),[ot],!0)}return ot;case ee.regexp:var Et=this.value;return L=this.parseLiteral(Et.value),L.regex={pattern:Et.pattern,flags:Et.flags},L;case ee.num:case ee.string:return this.parseLiteral(this.value);case ee._null:case ee._true:case ee._false:return L=this.startNode(),L.value=this.type===ee._null?null:this.type===ee._true,L.raw=this.type.keyword,this.next(),this.finishNode(L,"Literal");case ee.parenL:var Pt=this.start,zr=this.parseParenAndDistinguishExpression(X);return b&&(b.parenthesizedAssign<0&&!this.isSimpleAssignTarget(zr)&&(b.parenthesizedAssign=Pt),b.parenthesizedBind<0&&(b.parenthesizedBind=Pt)),zr;case ee.bracketL:return L=this.startNode(),this.next(),L.elements=this.parseExprList(ee.bracketR,!0,!0,b),this.finishNode(L,"ArrayExpression");case ee.braceL:return this.parseObj(!1,b);case ee._function:return L=this.startNode(),this.next(),this.parseFunction(L,0);case ee._class:return this.parseClass(this.startNode(),!1);case ee._new:return this.parseNew();case ee.backQuote:return this.parseTemplate();case ee._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},ln.parseExprImport=function(){var b=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var L=this.parseIdent(!0);switch(this.type){case ee.parenL:return this.parseDynamicImport(b);case ee.dot:return b.meta=L,this.parseImportMeta(b);default:this.unexpected()}},ln.parseDynamicImport=function(b){if(this.next(),b.source=this.parseMaybeAssign(),!this.eat(ee.parenR)){var L=this.start;this.eat(ee.comma)&&this.eat(ee.parenR)?this.raiseRecoverable(L,"Trailing comma is not allowed in import()"):this.unexpected(L)}return this.finishNode(b,"ImportExpression")},ln.parseImportMeta=function(b){this.next();var L=this.containsEsc;return b.property=this.parseIdent(!0),b.property.name!=="meta"&&this.raiseRecoverable(b.property.start,"The only valid meta property for import is 'import.meta'"),L&&this.raiseRecoverable(b.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&this.raiseRecoverable(b.start,"Cannot use 'import.meta' outside a module"),this.finishNode(b,"MetaProperty")},ln.parseLiteral=function(b){var L=this.startNode();return L.value=b,L.raw=this.input.slice(this.start,this.end),L.raw.charCodeAt(L.raw.length-1)===110&&(L.bigint=L.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(L,"Literal")},ln.parseParenExpression=function(){this.expect(ee.parenL);var b=this.parseExpression();return this.expect(ee.parenR),b},ln.parseParenAndDistinguishExpression=function(b){var L=this.start,X=this.startLoc,B,se=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Le=this.start,ot=this.startLoc,Et=[],Pt=!0,zr=!1,Kr=new _e,oi=this.yieldPos,Ki=this.awaitPos,Li;for(this.yieldPos=0,this.awaitPos=0;this.type!==ee.parenR;)if(Pt?Pt=!1:this.expect(ee.comma),se&&this.afterTrailingComma(ee.parenR,!0)){zr=!0;break}else if(this.type===ee.ellipsis){Li=this.start,Et.push(this.parseParenItem(this.parseRestBinding())),this.type===ee.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}else Et.push(this.parseMaybeAssign(!1,Kr,this.parseParenItem));var Oa=this.start,sa=this.startLoc;if(this.expect(ee.parenR),b&&!this.canInsertSemicolon()&&this.eat(ee.arrow))return this.checkPatternErrors(Kr,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=oi,this.awaitPos=Ki,this.parseParenArrowList(L,X,Et);(!Et.length||zr)&&this.unexpected(this.lastTokStart),Li&&this.unexpected(Li),this.checkExpressionErrors(Kr,!0),this.yieldPos=oi||this.yieldPos,this.awaitPos=Ki||this.awaitPos,Et.length>1?(B=this.startNodeAt(Le,ot),B.expressions=Et,this.finishNodeAt(B,"SequenceExpression",Oa,sa)):B=Et[0]}else B=this.parseParenExpression();if(this.options.preserveParens){var Va=this.startNodeAt(L,X);return Va.expression=B,this.finishNode(Va,"ParenthesizedExpression")}else return B},ln.parseParenItem=function(b){return b},ln.parseParenArrowList=function(b,L,X){return this.parseArrowExpression(this.startNodeAt(b,L),X)};var Ka=[];ln.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var b=this.startNode(),L=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(ee.dot)){b.meta=L;var X=this.containsEsc;return b.property=this.parseIdent(!0),b.property.name!=="target"&&this.raiseRecoverable(b.property.start,"The only valid meta property for new is 'new.target'"),X&&this.raiseRecoverable(b.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(b.start,"'new.target' can only be used in functions"),this.finishNode(b,"MetaProperty")}var B=this.start,se=this.startLoc,Le=this.type===ee._import;return b.callee=this.parseSubscripts(this.parseExprAtom(),B,se,!0),Le&&b.callee.type==="ImportExpression"&&this.raise(B,"Cannot use new with import()"),this.eat(ee.parenL)?b.arguments=this.parseExprList(ee.parenR,this.options.ecmaVersion>=8,!1):b.arguments=Ka,this.finishNode(b,"NewExpression")},ln.parseTemplateElement=function(b){var L=b.isTagged,X=this.startNode();return this.type===ee.invalidTemplate?(L||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),X.value={raw:this.value,cooked:null}):X.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),X.tail=this.type===ee.backQuote,this.finishNode(X,"TemplateElement")},ln.parseTemplate=function(b){b===void 0&&(b={});var L=b.isTagged;L===void 0&&(L=!1);var X=this.startNode();this.next(),X.expressions=[];var B=this.parseTemplateElement({isTagged:L});for(X.quasis=[B];!B.tail;)this.type===ee.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(ee.dollarBraceL),X.expressions.push(this.parseExpression()),this.expect(ee.braceR),X.quasis.push(B=this.parseTemplateElement({isTagged:L}));return this.next(),this.finishNode(X,"TemplateLiteral")},ln.isAsyncProp=function(b){return!b.computed&&b.key.type==="Identifier"&&b.key.name==="async"&&(this.type===ee.name||this.type===ee.num||this.type===ee.string||this.type===ee.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===ee.star)&&!rr.test(this.input.slice(this.lastTokEnd,this.start))},ln.parseObj=function(b,L){var X=this.startNode(),B=!0,se={};for(X.properties=[],this.next();!this.eat(ee.braceR);){if(B)B=!1;else if(this.expect(ee.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(ee.braceR))break;var Le=this.parseProperty(b,L);b||this.checkPropClash(Le,se,L),X.properties.push(Le)}return this.finishNode(X,b?"ObjectPattern":"ObjectExpression")},ln.parseProperty=function(b,L){var X=this.startNode(),B,se,Le,ot;if(this.options.ecmaVersion>=9&&this.eat(ee.ellipsis))return b?(X.argument=this.parseIdent(!1),this.type===ee.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(X,"RestElement")):(this.type===ee.parenL&&L&&(L.parenthesizedAssign<0&&(L.parenthesizedAssign=this.start),L.parenthesizedBind<0&&(L.parenthesizedBind=this.start)),X.argument=this.parseMaybeAssign(!1,L),this.type===ee.comma&&L&&L.trailingComma<0&&(L.trailingComma=this.start),this.finishNode(X,"SpreadElement"));this.options.ecmaVersion>=6&&(X.method=!1,X.shorthand=!1,(b||L)&&(Le=this.start,ot=this.startLoc),b||(B=this.eat(ee.star)));var Et=this.containsEsc;return this.parsePropertyName(X),!b&&!Et&&this.options.ecmaVersion>=8&&!B&&this.isAsyncProp(X)?(se=!0,B=this.options.ecmaVersion>=9&&this.eat(ee.star),this.parsePropertyName(X,L)):se=!1,this.parsePropertyValue(X,b,B,se,Le,ot,L,Et),this.finishNode(X,"Property")},ln.parsePropertyValue=function(b,L,X,B,se,Le,ot,Et){if((X||B)&&this.type===ee.colon&&this.unexpected(),this.eat(ee.colon))b.value=L?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,ot),b.kind="init";else if(this.options.ecmaVersion>=6&&this.type===ee.parenL)L&&this.unexpected(),b.kind="init",b.method=!0,b.value=this.parseMethod(X,B);else if(!L&&!Et&&this.options.ecmaVersion>=5&&!b.computed&&b.key.type==="Identifier"&&(b.key.name==="get"||b.key.name==="set")&&this.type!==ee.comma&&this.type!==ee.braceR&&this.type!==ee.eq){(X||B)&&this.unexpected(),b.kind=b.key.name,this.parsePropertyName(b),b.value=this.parseMethod(!1);var Pt=b.kind==="get"?0:1;if(b.value.params.length!==Pt){var zr=b.value.start;b.kind==="get"?this.raiseRecoverable(zr,"getter should have no params"):this.raiseRecoverable(zr,"setter should have exactly one param")}else b.kind==="set"&&b.value.params[0].type==="RestElement"&&this.raiseRecoverable(b.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!b.computed&&b.key.type==="Identifier"?((X||B)&&this.unexpected(),this.checkUnreserved(b.key),b.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=se),b.kind="init",L?b.value=this.parseMaybeDefault(se,Le,b.key):this.type===ee.eq&&ot?(ot.shorthandAssign<0&&(ot.shorthandAssign=this.start),b.value=this.parseMaybeDefault(se,Le,b.key)):b.value=b.key,b.shorthand=!0):this.unexpected()},ln.parsePropertyName=function(b){if(this.options.ecmaVersion>=6){if(this.eat(ee.bracketL))return b.computed=!0,b.key=this.parseMaybeAssign(),this.expect(ee.bracketR),b.key;b.computed=!1}return b.key=this.type===ee.num||this.type===ee.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},ln.initFunction=function(b){b.id=null,this.options.ecmaVersion>=6&&(b.generator=b.expression=!1),this.options.ecmaVersion>=8&&(b.async=!1)},ln.parseMethod=function(b,L,X){var B=this.startNode(),se=this.yieldPos,Le=this.awaitPos,ot=this.awaitIdentPos;return this.initFunction(B),this.options.ecmaVersion>=6&&(B.generator=b),this.options.ecmaVersion>=8&&(B.async=!!L),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Pr(L,B.generator)|Ar|(X?nr:0)),this.expect(ee.parenL),B.params=this.parseBindingList(ee.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(B,!1,!0),this.yieldPos=se,this.awaitPos=Le,this.awaitIdentPos=ot,this.finishNode(B,"FunctionExpression")},ln.parseArrowExpression=function(b,L,X){var B=this.yieldPos,se=this.awaitPos,Le=this.awaitIdentPos;return this.enterScope(Pr(X,!1)|Lt),this.initFunction(b),this.options.ecmaVersion>=8&&(b.async=!!X),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,b.params=this.toAssignableList(L,!0),this.parseFunctionBody(b,!0,!1),this.yieldPos=B,this.awaitPos=se,this.awaitIdentPos=Le,this.finishNode(b,"ArrowFunctionExpression")},ln.parseFunctionBody=function(b,L,X){var B=L&&this.type!==ee.braceL,se=this.strict,Le=!1;if(B)b.body=this.parseMaybeAssign(),b.expression=!0,this.checkParams(b,!1);else{var ot=this.options.ecmaVersion>=7&&!this.isSimpleParamList(b.params);(!se||ot)&&(Le=this.strictDirective(this.end),Le&&ot&&this.raiseRecoverable(b.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var Et=this.labels;this.labels=[],Le&&(this.strict=!0),this.checkParams(b,!se&&!Le&&!L&&!X&&this.isSimpleParamList(b.params)),this.strict&&b.id&&this.checkLVal(b.id,mn),b.body=this.parseBlock(!1,void 0,Le&&!se),b.expression=!1,this.adaptDirectivePrologue(b.body.body),this.labels=Et}this.exitScope()},ln.isSimpleParamList=function(b){for(var L=0,X=b;L<X.length;L+=1){var B=X[L];if(B.type!=="Identifier")return!1}return!0},ln.checkParams=function(b,L){for(var X={},B=0,se=b.params;B<se.length;B+=1){var Le=se[B];this.checkLVal(Le,Or,L?null:X)}},ln.parseExprList=function(b,L,X,B){for(var se=[],Le=!0;!this.eat(b);){if(Le)Le=!1;else if(this.expect(ee.comma),L&&this.afterTrailingComma(b))break;var ot=void 0;X&&this.type===ee.comma?ot=null:this.type===ee.ellipsis?(ot=this.parseSpread(B),B&&this.type===ee.comma&&B.trailingComma<0&&(B.trailingComma=this.start)):ot=this.parseMaybeAssign(!1,B),se.push(ot)}return se},ln.checkUnreserved=function(b){var L=b.start,X=b.end,B=b.name;if(this.inGenerator&&B==="yield"&&this.raiseRecoverable(L,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&B==="await"&&this.raiseRecoverable(L,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(B)&&this.raise(L,"Unexpected keyword '"+B+"'"),!(this.options.ecmaVersion<6&&this.input.slice(L,X).indexOf("\\")!==-1)){var se=this.strict?this.reservedWordsStrict:this.reservedWords;se.test(B)&&(!this.inAsync&&B==="await"&&this.raiseRecoverable(L,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(L,"The keyword '"+B+"' is reserved"))}},ln.parseIdent=function(b,L){var X=this.startNode();return this.type===ee.name?X.name=this.value:this.type.keyword?(X.name=this.type.keyword,(X.name==="class"||X.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop()):this.unexpected(),this.next(!!b),this.finishNode(X,"Identifier"),b||(this.checkUnreserved(X),X.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=X.start)),X},ln.parseYield=function(b){this.yieldPos||(this.yieldPos=this.start);var L=this.startNode();return this.next(),this.type===ee.semi||this.canInsertSemicolon()||this.type!==ee.star&&!this.type.startsExpr?(L.delegate=!1,L.argument=null):(L.delegate=this.eat(ee.star),L.argument=this.parseMaybeAssign(b)),this.finishNode(L,"YieldExpression")},ln.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var b=this.startNode();return this.next(),b.argument=this.parseMaybeUnary(null,!1),this.finishNode(b,"AwaitExpression")};var wi=wn.prototype;wi.raise=function(b,L){var X=Ie(this.input,b);L+=" ("+X.line+":"+X.column+")";var B=new SyntaxError(L);throw B.pos=b,B.loc=X,B.raisedAt=this.pos,B},wi.raiseRecoverable=wi.raise,wi.curPosition=function(){if(this.options.locations)return new be(this.curLine,this.pos-this.lineStart)};var fi=wn.prototype,Ti=function(L){this.flags=L,this.var=[],this.lexical=[],this.functions=[]};fi.enterScope=function(b){this.scopeStack.push(new Ti(b))},fi.exitScope=function(){this.scopeStack.pop()},fi.treatFunctionsAsVarInScope=function(b){return b.flags&br||!this.inModule&&b.flags&w},fi.declareName=function(b,L,X){var B=!1;if(L===_r){var se=this.currentScope();B=se.lexical.indexOf(b)>-1||se.functions.indexOf(b)>-1||se.var.indexOf(b)>-1,se.lexical.push(b),this.inModule&&se.flags&w&&delete this.undefinedExports[b]}else if(L===Jn){var Le=this.currentScope();Le.lexical.push(b)}else if(L===Br){var ot=this.currentScope();this.treatFunctionsAsVar?B=ot.lexical.indexOf(b)>-1:B=ot.lexical.indexOf(b)>-1||ot.var.indexOf(b)>-1,ot.functions.push(b)}else for(var Et=this.scopeStack.length-1;Et>=0;--Et){var Pt=this.scopeStack[Et];if(Pt.lexical.indexOf(b)>-1&&!(Pt.flags&ir&&Pt.lexical[0]===b)||!this.treatFunctionsAsVarInScope(Pt)&&Pt.functions.indexOf(b)>-1){B=!0;break}if(Pt.var.push(b),this.inModule&&Pt.flags&w&&delete this.undefinedExports[b],Pt.flags&Ut)break}B&&this.raiseRecoverable(X,"Identifier '"+b+"' has already been declared")},fi.checkLocalExport=function(b){this.scopeStack[0].lexical.indexOf(b.name)===-1&&this.scopeStack[0].var.indexOf(b.name)===-1&&(this.undefinedExports[b.name]=b)},fi.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},fi.currentVarScope=function(){for(var b=this.scopeStack.length-1;;b--){var L=this.scopeStack[b];if(L.flags&Ut)return L}},fi.currentThisScope=function(){for(var b=this.scopeStack.length-1;;b--){var L=this.scopeStack[b];if(L.flags&Ut&&!(L.flags&Lt))return L}};var da=function(L,X,B){this.type="",this.start=X,this.end=0,L.options.locations&&(this.loc=new Ne(L,B)),L.options.directSourceFile&&(this.sourceFile=L.options.directSourceFile),L.options.ranges&&(this.range=[X,0])},ya=wn.prototype;ya.startNode=function(){return new da(this,this.start,this.startLoc)},ya.startNodeAt=function(b,L){return new da(this,b,L)};function _s(b,L,X,B){return b.type=L,b.end=X,this.options.locations&&(b.loc.end=B),this.options.ranges&&(b.range[1]=X),b}ya.finishNode=function(b,L){return _s.call(this,b,L,this.lastTokEnd,this.lastTokEndLoc)},ya.finishNodeAt=function(b,L,X,B){return _s.call(this,b,L,X,B)};var xo=function(L,X,B,se,Le){this.token=L,this.isExpr=!!X,this.preserveSpace=!!B,this.override=se,this.generator=!!Le},$a={b_stat:new xo("{",!1),b_expr:new xo("{",!0),b_tmpl:new xo("${",!1),p_stat:new xo("(",!1),p_expr:new xo("(",!0),q_tmpl:new xo("`",!0,!0,function(b){return b.tryReadTemplateToken()}),f_stat:new xo("function",!1),f_expr:new xo("function",!0),f_expr_gen:new xo("function",!0,!1,null,!0),f_gen:new xo("function",!1,!1,null,!0)},Vu=wn.prototype;Vu.initialContext=function(){return[$a.b_stat]},Vu.braceIsBlock=function(b){var L=this.curContext();return L===$a.f_expr||L===$a.f_stat?!0:b===ee.colon&&(L===$a.b_stat||L===$a.b_expr)?!L.isExpr:b===ee._return||b===ee.name&&this.exprAllowed?rr.test(this.input.slice(this.lastTokEnd,this.start)):b===ee._else||b===ee.semi||b===ee.eof||b===ee.parenR||b===ee.arrow?!0:b===ee.braceL?L===$a.b_stat:b===ee._var||b===ee._const||b===ee.name?!1:!this.exprAllowed},Vu.inGeneratorContext=function(){for(var b=this.context.length-1;b>=1;b--){var L=this.context[b];if(L.token==="function")return L.generator}return!1},Vu.updateContext=function(b){var L,X=this.type;X.keyword&&b===ee.dot?this.exprAllowed=!1:(L=X.updateContext)?L.call(this,b):this.exprAllowed=X.beforeExpr},ee.parenR.updateContext=ee.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var b=this.context.pop();b===$a.b_stat&&this.curContext().token==="function"&&(b=this.context.pop()),this.exprAllowed=!b.isExpr},ee.braceL.updateContext=function(b){this.context.push(this.braceIsBlock(b)?$a.b_stat:$a.b_expr),this.exprAllowed=!0},ee.dollarBraceL.updateContext=function(){this.context.push($a.b_tmpl),this.exprAllowed=!0},ee.parenL.updateContext=function(b){var L=b===ee._if||b===ee._for||b===ee._with||b===ee._while;this.context.push(L?$a.p_stat:$a.p_expr),this.exprAllowed=!0},ee.incDec.updateContext=function(){},ee._function.updateContext=ee._class.updateContext=function(b){b.beforeExpr&&b!==ee.semi&&b!==ee._else&&!(b===ee._return&&rr.test(this.input.slice(this.lastTokEnd,this.start)))&&!((b===ee.colon||b===ee.braceL)&&this.curContext()===$a.b_stat)?this.context.push($a.f_expr):this.context.push($a.f_stat),this.exprAllowed=!1},ee.backQuote.updateContext=function(){this.curContext()===$a.q_tmpl?this.context.pop():this.context.push($a.q_tmpl),this.exprAllowed=!1},ee.star.updateContext=function(b){if(b===ee._function){var L=this.context.length-1;this.context[L]===$a.f_expr?this.context[L]=$a.f_expr_gen:this.context[L]=$a.f_gen}this.exprAllowed=!0},ee.name.updateContext=function(b){var L=!1;this.options.ecmaVersion>=6&&b!==ee.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(L=!0),this.exprAllowed=L};var ec="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",wo=ec+" Extended_Pictographic",oe=wo,ie={9:ec,10:wo,11:oe},xe="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Me="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Ve=Me+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",ft=Ve+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Ct={9:Me,10:Ve,11:ft},Ce={};function Ye(b){var L=Ce[b]={binary:kr(ie[b]+" "+xe),nonBinary:{General_Category:kr(xe),Script:kr(Ct[b])}};L.nonBinary.Script_Extensions=L.nonBinary.Script,L.nonBinary.gc=L.nonBinary.General_Category,L.nonBinary.sc=L.nonBinary.Script,L.nonBinary.scx=L.nonBinary.Script_Extensions}Ye(9),Ye(10),Ye(11);var nt=wn.prototype,Nr=function(L){this.parser=L,this.validFlags="gim"+(L.options.ecmaVersion>=6?"uy":"")+(L.options.ecmaVersion>=9?"s":""),this.unicodeProperties=Ce[L.options.ecmaVersion>=11?11:L.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};Nr.prototype.reset=function(L,X,B){var se=B.indexOf("u")!==-1;this.start=L|0,this.source=X+"",this.flags=B,this.switchU=se&&this.parser.options.ecmaVersion>=6,this.switchN=se&&this.parser.options.ecmaVersion>=9},Nr.prototype.raise=function(L){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+L)},Nr.prototype.at=function(L,X){X===void 0&&(X=!1);var B=this.source,se=B.length;if(L>=se)return-1;var Le=B.charCodeAt(L);if(!(X||this.switchU)||Le<=55295||Le>=57344||L+1>=se)return Le;var ot=B.charCodeAt(L+1);return ot>=56320&&ot<=57343?(Le<<10)+ot-56613888:Le},Nr.prototype.nextIndex=function(L,X){X===void 0&&(X=!1);var B=this.source,se=B.length;if(L>=se)return se;var Le=B.charCodeAt(L),ot;return!(X||this.switchU)||Le<=55295||Le>=57344||L+1>=se||(ot=B.charCodeAt(L+1))<56320||ot>57343?L+1:L+2},Nr.prototype.current=function(L){return L===void 0&&(L=!1),this.at(this.pos,L)},Nr.prototype.lookahead=function(L){return L===void 0&&(L=!1),this.at(this.nextIndex(this.pos,L),L)},Nr.prototype.advance=function(L){L===void 0&&(L=!1),this.pos=this.nextIndex(this.pos,L)},Nr.prototype.eat=function(L,X){return X===void 0&&(X=!1),this.current(X)===L?(this.advance(X),!0):!1};function Xr(b){return b<=65535?String.fromCharCode(b):(b-=65536,String.fromCharCode((b>>10)+55296,(b&1023)+56320))}nt.validateRegExpFlags=function(b){for(var L=b.validFlags,X=b.flags,B=0;B<X.length;B++){var se=X.charAt(B);L.indexOf(se)===-1&&this.raise(b.start,"Invalid regular expression flag"),X.indexOf(se,B+1)>-1&&this.raise(b.start,"Duplicate regular expression flag")}},nt.validateRegExpPattern=function(b){this.regexp_pattern(b),!b.switchN&&this.options.ecmaVersion>=9&&b.groupNames.length>0&&(b.switchN=!0,this.regexp_pattern(b))},nt.regexp_pattern=function(b){b.pos=0,b.lastIntValue=0,b.lastStringValue="",b.lastAssertionIsQuantifiable=!1,b.numCapturingParens=0,b.maxBackReference=0,b.groupNames.length=0,b.backReferenceNames.length=0,this.regexp_disjunction(b),b.pos!==b.source.length&&(b.eat(41)&&b.raise("Unmatched ')'"),(b.eat(93)||b.eat(125))&&b.raise("Lone quantifier brackets")),b.maxBackReference>b.numCapturingParens&&b.raise("Invalid escape");for(var L=0,X=b.backReferenceNames;L<X.length;L+=1){var B=X[L];b.groupNames.indexOf(B)===-1&&b.raise("Invalid named capture referenced")}},nt.regexp_disjunction=function(b){for(this.regexp_alternative(b);b.eat(124);)this.regexp_alternative(b);this.regexp_eatQuantifier(b,!0)&&b.raise("Nothing to repeat"),b.eat(123)&&b.raise("Lone quantifier brackets")},nt.regexp_alternative=function(b){for(;b.pos<b.source.length&&this.regexp_eatTerm(b););},nt.regexp_eatTerm=function(b){return this.regexp_eatAssertion(b)?(b.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(b)&&b.switchU&&b.raise("Invalid quantifier"),!0):(b.switchU?this.regexp_eatAtom(b):this.regexp_eatExtendedAtom(b))?(this.regexp_eatQuantifier(b),!0):!1},nt.regexp_eatAssertion=function(b){var L=b.pos;if(b.lastAssertionIsQuantifiable=!1,b.eat(94)||b.eat(36))return!0;if(b.eat(92)){if(b.eat(66)||b.eat(98))return!0;b.pos=L}if(b.eat(40)&&b.eat(63)){var X=!1;if(this.options.ecmaVersion>=9&&(X=b.eat(60)),b.eat(61)||b.eat(33))return this.regexp_disjunction(b),b.eat(41)||b.raise("Unterminated group"),b.lastAssertionIsQuantifiable=!X,!0}return b.pos=L,!1},nt.regexp_eatQuantifier=function(b,L){return L===void 0&&(L=!1),this.regexp_eatQuantifierPrefix(b,L)?(b.eat(63),!0):!1},nt.regexp_eatQuantifierPrefix=function(b,L){return b.eat(42)||b.eat(43)||b.eat(63)||this.regexp_eatBracedQuantifier(b,L)},nt.regexp_eatBracedQuantifier=function(b,L){var X=b.pos;if(b.eat(123)){var B=0,se=-1;if(this.regexp_eatDecimalDigits(b)&&(B=b.lastIntValue,b.eat(44)&&this.regexp_eatDecimalDigits(b)&&(se=b.lastIntValue),b.eat(125)))return se!==-1&&se<B&&!L&&b.raise("numbers out of order in {} quantifier"),!0;b.switchU&&!L&&b.raise("Incomplete quantifier"),b.pos=X}return!1},nt.regexp_eatAtom=function(b){return this.regexp_eatPatternCharacters(b)||b.eat(46)||this.regexp_eatReverseSolidusAtomEscape(b)||this.regexp_eatCharacterClass(b)||this.regexp_eatUncapturingGroup(b)||this.regexp_eatCapturingGroup(b)},nt.regexp_eatReverseSolidusAtomEscape=function(b){var L=b.pos;if(b.eat(92)){if(this.regexp_eatAtomEscape(b))return!0;b.pos=L}return!1},nt.regexp_eatUncapturingGroup=function(b){var L=b.pos;if(b.eat(40)){if(b.eat(63)&&b.eat(58)){if(this.regexp_disjunction(b),b.eat(41))return!0;b.raise("Unterminated group")}b.pos=L}return!1},nt.regexp_eatCapturingGroup=function(b){if(b.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(b):b.current()===63&&b.raise("Invalid group"),this.regexp_disjunction(b),b.eat(41))return b.numCapturingParens+=1,!0;b.raise("Unterminated group")}return!1},nt.regexp_eatExtendedAtom=function(b){return b.eat(46)||this.regexp_eatReverseSolidusAtomEscape(b)||this.regexp_eatCharacterClass(b)||this.regexp_eatUncapturingGroup(b)||this.regexp_eatCapturingGroup(b)||this.regexp_eatInvalidBracedQuantifier(b)||this.regexp_eatExtendedPatternCharacter(b)},nt.regexp_eatInvalidBracedQuantifier=function(b){return this.regexp_eatBracedQuantifier(b,!0)&&b.raise("Nothing to repeat"),!1},nt.regexp_eatSyntaxCharacter=function(b){var L=b.current();return dr(L)?(b.lastIntValue=L,b.advance(),!0):!1};function dr(b){return b===36||b>=40&&b<=43||b===46||b===63||b>=91&&b<=94||b>=123&&b<=125}nt.regexp_eatPatternCharacters=function(b){for(var L=b.pos,X=0;(X=b.current())!==-1&&!dr(X);)b.advance();return b.pos!==L},nt.regexp_eatExtendedPatternCharacter=function(b){var L=b.current();return L!==-1&&L!==36&&!(L>=40&&L<=43)&&L!==46&&L!==63&&L!==91&&L!==94&&L!==124?(b.advance(),!0):!1},nt.regexp_groupSpecifier=function(b){if(b.eat(63)){if(this.regexp_eatGroupName(b)){b.groupNames.indexOf(b.lastStringValue)!==-1&&b.raise("Duplicate capture group name"),b.groupNames.push(b.lastStringValue);return}b.raise("Invalid group")}},nt.regexp_eatGroupName=function(b){if(b.lastStringValue="",b.eat(60)){if(this.regexp_eatRegExpIdentifierName(b)&&b.eat(62))return!0;b.raise("Invalid capture group name")}return!1},nt.regexp_eatRegExpIdentifierName=function(b){if(b.lastStringValue="",this.regexp_eatRegExpIdentifierStart(b)){for(b.lastStringValue+=Xr(b.lastIntValue);this.regexp_eatRegExpIdentifierPart(b);)b.lastStringValue+=Xr(b.lastIntValue);return!0}return!1},nt.regexp_eatRegExpIdentifierStart=function(b){var L=b.pos,X=this.options.ecmaVersion>=11,B=b.current(X);return b.advance(X),B===92&&this.regexp_eatRegExpUnicodeEscapeSequence(b,X)&&(B=b.lastIntValue),Yr(B)?(b.lastIntValue=B,!0):(b.pos=L,!1)};function Yr(b){return at(b,!0)||b===36||b===95}nt.regexp_eatRegExpIdentifierPart=function(b){var L=b.pos,X=this.options.ecmaVersion>=11,B=b.current(X);return b.advance(X),B===92&&this.regexp_eatRegExpUnicodeEscapeSequence(b,X)&&(B=b.lastIntValue),xn(B)?(b.lastIntValue=B,!0):(b.pos=L,!1)};function xn(b){return gt(b,!0)||b===36||b===95||b===8204||b===8205}nt.regexp_eatAtomEscape=function(b){return this.regexp_eatBackReference(b)||this.regexp_eatCharacterClassEscape(b)||this.regexp_eatCharacterEscape(b)||b.switchN&&this.regexp_eatKGroupName(b)?!0:(b.switchU&&(b.current()===99&&b.raise("Invalid unicode escape"),b.raise("Invalid escape")),!1)},nt.regexp_eatBackReference=function(b){var L=b.pos;if(this.regexp_eatDecimalEscape(b)){var X=b.lastIntValue;if(b.switchU)return X>b.maxBackReference&&(b.maxBackReference=X),!0;if(X<=b.numCapturingParens)return!0;b.pos=L}return!1},nt.regexp_eatKGroupName=function(b){if(b.eat(107)){if(this.regexp_eatGroupName(b))return b.backReferenceNames.push(b.lastStringValue),!0;b.raise("Invalid named reference")}return!1},nt.regexp_eatCharacterEscape=function(b){return this.regexp_eatControlEscape(b)||this.regexp_eatCControlLetter(b)||this.regexp_eatZero(b)||this.regexp_eatHexEscapeSequence(b)||this.regexp_eatRegExpUnicodeEscapeSequence(b,!1)||!b.switchU&&this.regexp_eatLegacyOctalEscapeSequence(b)||this.regexp_eatIdentityEscape(b)},nt.regexp_eatCControlLetter=function(b){var L=b.pos;if(b.eat(99)){if(this.regexp_eatControlLetter(b))return!0;b.pos=L}return!1},nt.regexp_eatZero=function(b){return b.current()===48&&!Gi(b.lookahead())?(b.lastIntValue=0,b.advance(),!0):!1},nt.regexp_eatControlEscape=function(b){var L=b.current();return L===116?(b.lastIntValue=9,b.advance(),!0):L===110?(b.lastIntValue=10,b.advance(),!0):L===118?(b.lastIntValue=11,b.advance(),!0):L===102?(b.lastIntValue=12,b.advance(),!0):L===114?(b.lastIntValue=13,b.advance(),!0):!1},nt.regexp_eatControlLetter=function(b){var L=b.current();return Gn(L)?(b.lastIntValue=L%32,b.advance(),!0):!1};function Gn(b){return b>=65&&b<=90||b>=97&&b<=122}nt.regexp_eatRegExpUnicodeEscapeSequence=function(b,L){L===void 0&&(L=!1);var X=b.pos,B=L||b.switchU;if(b.eat(117)){if(this.regexp_eatFixedHexDigits(b,4)){var se=b.lastIntValue;if(B&&se>=55296&&se<=56319){var Le=b.pos;if(b.eat(92)&&b.eat(117)&&this.regexp_eatFixedHexDigits(b,4)){var ot=b.lastIntValue;if(ot>=56320&&ot<=57343)return b.lastIntValue=(se-55296)*1024+(ot-56320)+65536,!0}b.pos=Le,b.lastIntValue=se}return!0}if(B&&b.eat(123)&&this.regexp_eatHexDigits(b)&&b.eat(125)&&pr(b.lastIntValue))return!0;B&&b.raise("Invalid unicode escape"),b.pos=X}return!1};function pr(b){return b>=0&&b<=1114111}nt.regexp_eatIdentityEscape=function(b){if(b.switchU)return this.regexp_eatSyntaxCharacter(b)?!0:b.eat(47)?(b.lastIntValue=47,!0):!1;var L=b.current();return L!==99&&(!b.switchN||L!==107)?(b.lastIntValue=L,b.advance(),!0):!1},nt.regexp_eatDecimalEscape=function(b){b.lastIntValue=0;var L=b.current();if(L>=49&&L<=57){do b.lastIntValue=10*b.lastIntValue+(L-48),b.advance();while((L=b.current())>=48&&L<=57);return!0}return!1},nt.regexp_eatCharacterClassEscape=function(b){var L=b.current();if(jn(L))return b.lastIntValue=-1,b.advance(),!0;if(b.switchU&&this.options.ecmaVersion>=9&&(L===80||L===112)){if(b.lastIntValue=-1,b.advance(),b.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(b)&&b.eat(125))return!0;b.raise("Invalid property name")}return!1};function jn(b){return b===100||b===68||b===115||b===83||b===119||b===87}nt.regexp_eatUnicodePropertyValueExpression=function(b){var L=b.pos;if(this.regexp_eatUnicodePropertyName(b)&&b.eat(61)){var X=b.lastStringValue;if(this.regexp_eatUnicodePropertyValue(b)){var B=b.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(b,X,B),!0}}if(b.pos=L,this.regexp_eatLoneUnicodePropertyNameOrValue(b)){var se=b.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(b,se),!0}return!1},nt.regexp_validateUnicodePropertyNameAndValue=function(b,L,X){jr(b.unicodeProperties.nonBinary,L)||b.raise("Invalid property name"),b.unicodeProperties.nonBinary[L].test(X)||b.raise("Invalid property value")},nt.regexp_validateUnicodePropertyNameOrValue=function(b,L){b.unicodeProperties.binary.test(L)||b.raise("Invalid property name")},nt.regexp_eatUnicodePropertyName=function(b){var L=0;for(b.lastStringValue="";Rn(L=b.current());)b.lastStringValue+=Xr(L),b.advance();return b.lastStringValue!==""};function Rn(b){return Gn(b)||b===95}nt.regexp_eatUnicodePropertyValue=function(b){var L=0;for(b.lastStringValue="";Nn(L=b.current());)b.lastStringValue+=Xr(L),b.advance();return b.lastStringValue!==""};function Nn(b){return Rn(b)||Gi(b)}nt.regexp_eatLoneUnicodePropertyNameOrValue=function(b){return this.regexp_eatUnicodePropertyValue(b)},nt.regexp_eatCharacterClass=function(b){if(b.eat(91)){if(b.eat(94),this.regexp_classRanges(b),b.eat(93))return!0;b.raise("Unterminated character class")}return!1},nt.regexp_classRanges=function(b){for(;this.regexp_eatClassAtom(b);){var L=b.lastIntValue;if(b.eat(45)&&this.regexp_eatClassAtom(b)){var X=b.lastIntValue;b.switchU&&(L===-1||X===-1)&&b.raise("Invalid character class"),L!==-1&&X!==-1&&L>X&&b.raise("Range out of order in character class")}}},nt.regexp_eatClassAtom=function(b){var L=b.pos;if(b.eat(92)){if(this.regexp_eatClassEscape(b))return!0;if(b.switchU){var X=b.current();(X===99||Sa(X))&&b.raise("Invalid class escape"),b.raise("Invalid escape")}b.pos=L}var B=b.current();return B!==93?(b.lastIntValue=B,b.advance(),!0):!1},nt.regexp_eatClassEscape=function(b){var L=b.pos;if(b.eat(98))return b.lastIntValue=8,!0;if(b.switchU&&b.eat(45))return b.lastIntValue=45,!0;if(!b.switchU&&b.eat(99)){if(this.regexp_eatClassControlLetter(b))return!0;b.pos=L}return this.regexp_eatCharacterClassEscape(b)||this.regexp_eatCharacterEscape(b)},nt.regexp_eatClassControlLetter=function(b){var L=b.current();return Gi(L)||L===95?(b.lastIntValue=L%32,b.advance(),!0):!1},nt.regexp_eatHexEscapeSequence=function(b){var L=b.pos;if(b.eat(120)){if(this.regexp_eatFixedHexDigits(b,2))return!0;b.switchU&&b.raise("Invalid escape"),b.pos=L}return!1},nt.regexp_eatDecimalDigits=function(b){var L=b.pos,X=0;for(b.lastIntValue=0;Gi(X=b.current());)b.lastIntValue=10*b.lastIntValue+(X-48),b.advance();return b.pos!==L};function Gi(b){return b>=48&&b<=57}nt.regexp_eatHexDigits=function(b){var L=b.pos,X=0;for(b.lastIntValue=0;Hn(X=b.current());)b.lastIntValue=16*b.lastIntValue+ha(X),b.advance();return b.pos!==L};function Hn(b){return b>=48&&b<=57||b>=65&&b<=70||b>=97&&b<=102}function ha(b){return b>=65&&b<=70?10+(b-65):b>=97&&b<=102?10+(b-97):b-48}nt.regexp_eatLegacyOctalEscapeSequence=function(b){if(this.regexp_eatOctalDigit(b)){var L=b.lastIntValue;if(this.regexp_eatOctalDigit(b)){var X=b.lastIntValue;L<=3&&this.regexp_eatOctalDigit(b)?b.lastIntValue=L*64+X*8+b.lastIntValue:b.lastIntValue=L*8+X}else b.lastIntValue=L;return!0}return!1},nt.regexp_eatOctalDigit=function(b){var L=b.current();return Sa(L)?(b.lastIntValue=L-48,b.advance(),!0):(b.lastIntValue=0,!1)};function Sa(b){return b>=48&&b<=55}nt.regexp_eatFixedHexDigits=function(b,L){var X=b.pos;b.lastIntValue=0;for(var B=0;B<L;++B){var se=b.current();if(!Hn(se))return b.pos=X,!1;b.lastIntValue=16*b.lastIntValue+ha(se),b.advance()}return!0};var Ji=function(L){this.type=L.type,this.value=L.value,this.start=L.start,this.end=L.end,L.options.locations&&(this.loc=new Ne(L,L.startLoc,L.endLoc)),L.options.ranges&&(this.range=[L.start,L.end])},ei=wn.prototype;ei.next=function(b){!b&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Ji(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},ei.getToken=function(){return this.next(),new Ji(this)},typeof Symbol!="undefined"&&(ei[Symbol.iterator]=function(){var b=this;return{next:function(){var X=b.getToken();return{done:X.type===ee.eof,value:X}}}}),ei.curContext=function(){return this.context[this.context.length-1]},ei.nextToken=function(){var b=this.curContext();if((!b||!b.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(ee.eof);if(b.override)return b.override(this);this.readToken(this.fullCharCodeAtPos())},ei.readToken=function(b){return at(b,this.options.ecmaVersion>=6)||b===92?this.readWord():this.getTokenFromCode(b)},ei.fullCharCodeAtPos=function(){var b=this.input.charCodeAt(this.pos);if(b<=55295||b>=57344)return b;var L=this.input.charCodeAt(this.pos+1);return(b<<10)+L-56613888},ei.skipBlockComment=function(){var b=this.options.onComment&&this.curPosition(),L=this.pos,X=this.input.indexOf("*/",this.pos+=2);if(X===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=X+2,this.options.locations){Fr.lastIndex=L;for(var B;(B=Fr.exec(this.input))&&B.index<this.pos;)++this.curLine,this.lineStart=B.index+B[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(L+2,X),L,this.pos,b,this.curPosition())},ei.skipLineComment=function(b){for(var L=this.pos,X=this.options.onComment&&this.curPosition(),B=this.input.charCodeAt(this.pos+=b);this.pos<this.input.length&&!Mr(B);)B=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(L+b,this.pos),L,this.pos,X,this.curPosition())},ei.skipSpace=function(){e:for(;this.pos<this.input.length;){var b=this.input.charCodeAt(this.pos);switch(b){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(b>8&&b<14||b>=5760&&Nt.test(String.fromCharCode(b)))++this.pos;else break e}}},ei.finishToken=function(b,L){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var X=this.type;this.type=b,this.value=L,this.updateContext(X)},ei.readToken_dot=function(){var b=this.input.charCodeAt(this.pos+1);if(b>=48&&b<=57)return this.readNumber(!0);var L=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&b===46&&L===46?(this.pos+=3,this.finishToken(ee.ellipsis)):(++this.pos,this.finishToken(ee.dot))},ei.readToken_slash=function(){var b=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):b===61?this.finishOp(ee.assign,2):this.finishOp(ee.slash,1)},ei.readToken_mult_modulo_exp=function(b){var L=this.input.charCodeAt(this.pos+1),X=1,B=b===42?ee.star:ee.modulo;return this.options.ecmaVersion>=7&&b===42&&L===42&&(++X,B=ee.starstar,L=this.input.charCodeAt(this.pos+2)),L===61?this.finishOp(ee.assign,X+1):this.finishOp(B,X)},ei.readToken_pipe_amp=function(b){var L=this.input.charCodeAt(this.pos+1);if(L===b){if(this.options.ecmaVersion>=12){var X=this.input.charCodeAt(this.pos+2);if(X===61)return this.finishOp(ee.assign,3)}return this.finishOp(b===124?ee.logicalOR:ee.logicalAND,2)}return L===61?this.finishOp(ee.assign,2):this.finishOp(b===124?ee.bitwiseOR:ee.bitwiseAND,1)},ei.readToken_caret=function(){var b=this.input.charCodeAt(this.pos+1);return b===61?this.finishOp(ee.assign,2):this.finishOp(ee.bitwiseXOR,1)},ei.readToken_plus_min=function(b){var L=this.input.charCodeAt(this.pos+1);return L===b?L===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||rr.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(ee.incDec,2):L===61?this.finishOp(ee.assign,2):this.finishOp(ee.plusMin,1)},ei.readToken_lt_gt=function(b){var L=this.input.charCodeAt(this.pos+1),X=1;return L===b?(X=b===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+X)===61?this.finishOp(ee.assign,X+1):this.finishOp(ee.bitShift,X)):L===33&&b===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(L===61&&(X=2),this.finishOp(ee.relational,X))},ei.readToken_eq_excl=function(b){var L=this.input.charCodeAt(this.pos+1);return L===61?this.finishOp(ee.equality,this.input.charCodeAt(this.pos+2)===61?3:2):b===61&&L===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(ee.arrow)):this.finishOp(b===61?ee.eq:ee.prefix,1)},ei.readToken_question=function(){var b=this.options.ecmaVersion;if(b>=11){var L=this.input.charCodeAt(this.pos+1);if(L===46){var X=this.input.charCodeAt(this.pos+2);if(X<48||X>57)return this.finishOp(ee.questionDot,2)}if(L===63){if(b>=12){var B=this.input.charCodeAt(this.pos+2);if(B===61)return this.finishOp(ee.assign,3)}return this.finishOp(ee.coalesce,2)}}return this.finishOp(ee.question,1)},ei.getTokenFromCode=function(b){switch(b){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(ee.parenL);case 41:return++this.pos,this.finishToken(ee.parenR);case 59:return++this.pos,this.finishToken(ee.semi);case 44:return++this.pos,this.finishToken(ee.comma);case 91:return++this.pos,this.finishToken(ee.bracketL);case 93:return++this.pos,this.finishToken(ee.bracketR);case 123:return++this.pos,this.finishToken(ee.braceL);case 125:return++this.pos,this.finishToken(ee.braceR);case 58:return++this.pos,this.finishToken(ee.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(ee.backQuote);case 48:var L=this.input.charCodeAt(this.pos+1);if(L===120||L===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(L===111||L===79)return this.readRadixNumber(8);if(L===98||L===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(b);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(b);case 124:case 38:return this.readToken_pipe_amp(b);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(b);case 60:case 62:return this.readToken_lt_gt(b);case 61:case 33:return this.readToken_eq_excl(b);case 63:return this.readToken_question();case 126:return this.finishOp(ee.prefix,1)}this.raise(this.pos,"Unexpected character '"+Ca(b)+"'")},ei.finishOp=function(b,L){var X=this.input.slice(this.pos,this.pos+L);return this.pos+=L,this.finishToken(b,X)},ei.readRegexp=function(){for(var b,L,X=this.pos;;){this.pos>=this.input.length&&this.raise(X,"Unterminated regular expression");var B=this.input.charAt(this.pos);if(rr.test(B)&&this.raise(X,"Unterminated regular expression"),b)b=!1;else{if(B==="[")L=!0;else if(B==="]"&&L)L=!1;else if(B==="/"&&!L)break;b=B==="\\"}++this.pos}var se=this.input.slice(X,this.pos);++this.pos;var Le=this.pos,ot=this.readWord1();this.containsEsc&&this.unexpected(Le);var Et=this.regexpState||(this.regexpState=new Nr(this));Et.reset(X,se,ot),this.validateRegExpFlags(Et),this.validateRegExpPattern(Et);var Pt=null;try{Pt=new RegExp(se,ot)}catch(zr){}return this.finishToken(ee.regexp,{pattern:se,flags:ot,value:Pt})},ei.readInt=function(b,L,X){for(var B=this.options.ecmaVersion>=12&&L===void 0,se=X&&this.input.charCodeAt(this.pos)===48,Le=this.pos,ot=0,Et=0,Pt=0,zr=L==null?Infinity:L;Pt<zr;++Pt,++this.pos){var Kr=this.input.charCodeAt(this.pos),oi=void 0;if(B&&Kr===95){se&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),Et===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),Pt===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),Et=Kr;continue}if(Kr>=97?oi=Kr-97+10:Kr>=65?oi=Kr-65+10:Kr>=48&&Kr<=57?oi=Kr-48:oi=Infinity,oi>=b)break;Et=Kr,ot=ot*b+oi}return B&&Et===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Le||L!=null&&this.pos-Le!==L?null:ot};function ua(b,L){return L?parseInt(b,8):parseFloat(b.replace(/_/g,""))}function Ds(b){return typeof BigInt!="function"?null:BigInt(b.replace(/_/g,""))}ei.readRadixNumber=function(b){var L=this.pos;this.pos+=2;var X=this.readInt(b);return X==null&&this.raise(this.start+2,"Expected number in radix "+b),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(X=Ds(this.input.slice(L,this.pos)),++this.pos):at(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(ee.num,X)},ei.readNumber=function(b){var L=this.pos;!b&&this.readInt(10,void 0,!0)===null&&this.raise(L,"Invalid number");var X=this.pos-L>=2&&this.input.charCodeAt(L)===48;X&&this.strict&&this.raise(L,"Invalid number");var B=this.input.charCodeAt(this.pos);if(!X&&!b&&this.options.ecmaVersion>=11&&B===110){var se=Ds(this.input.slice(L,this.pos));return++this.pos,at(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(ee.num,se)}X&&/[89]/.test(this.input.slice(L,this.pos))&&(X=!1),B===46&&!X&&(++this.pos,this.readInt(10),B=this.input.charCodeAt(this.pos)),(B===69||B===101)&&!X&&(B=this.input.charCodeAt(++this.pos),(B===43||B===45)&&++this.pos,this.readInt(10)===null&&this.raise(L,"Invalid number")),at(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Le=ua(this.input.slice(L,this.pos),X);return this.finishToken(ee.num,Le)},ei.readCodePoint=function(){var b=this.input.charCodeAt(this.pos),L;if(b===123){this.options.ecmaVersion<6&&this.unexpected();var X=++this.pos;L=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,L>1114111&&this.invalidStringToken(X,"Code point out of bounds")}else L=this.readHexChar(4);return L};function Ca(b){return b<=65535?String.fromCharCode(b):(b-=65536,String.fromCharCode((b>>10)+55296,(b&1023)+56320))}ei.readString=function(b){for(var L="",X=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var B=this.input.charCodeAt(this.pos);if(B===b)break;B===92?(L+=this.input.slice(X,this.pos),L+=this.readEscapedChar(!1),X=this.pos):(Mr(B,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return L+=this.input.slice(X,this.pos++),this.finishToken(ee.string,L)};var zo={};ei.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(b){if(b===zo)this.readInvalidTemplateToken();else throw b}this.inTemplateElement=!1},ei.invalidStringToken=function(b,L){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw zo;this.raise(b,L)},ei.readTmplToken=function(){for(var b="",L=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var X=this.input.charCodeAt(this.pos);if(X===96||X===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===ee.template||this.type===ee.invalidTemplate)?X===36?(this.pos+=2,this.finishToken(ee.dollarBraceL)):(++this.pos,this.finishToken(ee.backQuote)):(b+=this.input.slice(L,this.pos),this.finishToken(ee.template,b));if(X===92)b+=this.input.slice(L,this.pos),b+=this.readEscapedChar(!0),L=this.pos;else if(Mr(X)){switch(b+=this.input.slice(L,this.pos),++this.pos,X){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:b+=`
`;break;default:b+=String.fromCharCode(X);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),L=this.pos}else++this.pos}},ei.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(ee.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},ei.readEscapedChar=function(b){var L=this.input.charCodeAt(++this.pos);switch(++this.pos,L){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Ca(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(b){var X=this.pos-1;return this.invalidStringToken(X,"Invalid escape sequence in template string"),null}default:if(L>=48&&L<=55){var B=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],se=parseInt(B,8);return se>255&&(B=B.slice(0,-1),se=parseInt(B,8)),this.pos+=B.length-1,L=this.input.charCodeAt(this.pos),(B!=="0"||L===56||L===57)&&(this.strict||b)&&this.invalidStringToken(this.pos-1-B.length,b?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(se)}return Mr(L)?"":String.fromCharCode(L)}},ei.readHexChar=function(b){var L=this.pos,X=this.readInt(16,b);return X===null&&this.invalidStringToken(L,"Bad character escape sequence"),X},ei.readWord1=function(){this.containsEsc=!1;for(var b="",L=!0,X=this.pos,B=this.options.ecmaVersion>=6;this.pos<this.input.length;){var se=this.fullCharCodeAtPos();if(gt(se,B))this.pos+=se<=65535?1:2;else if(se===92){this.containsEsc=!0,b+=this.input.slice(X,this.pos);var Le=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var ot=this.readCodePoint();(L?at:gt)(ot,B)||this.invalidStringToken(Le,"Invalid Unicode escape"),b+=Ca(ot),X=this.pos}else break;L=!1}return b+this.input.slice(X,this.pos)},ei.readWord=function(){var b=this.readWord1(),L=ee.name;return this.keywords.test(b)&&(L=ct[b]),this.finishToken(L,b)};var Ei="7.4.1";wn.acorn={Parser:wn,version:Ei,defaultOptions:pt,Position:be,SourceLocation:Ne,getLineInfo:Ie,Node:da,TokenType:yt,tokTypes:ee,keywordTypes:ct,TokContext:xo,tokContexts:$a,isIdentifierChar:gt,isIdentifierStart:at,Token:Ji,isNewLine:Mr,lineBreak:rr,lineBreakG:Fr,nonASCIIwhitespace:Nt};function Qi(b,L){return wn.parse(b,L)}function Bi(b,L,X){return wn.parseExpressionAt(b,L,X)}function Uo(b,L){return wn.tokenizer(b,L)}function Ho(b,L){b.prototype=Object.create(L.prototype),b.prototype.constructor=b,b.__proto__=L}function so(b){var L=typeof Map=="function"?new Map:void 0;return so=function(B){if(B===null||!Yt(B))return B;if(typeof B!="function")throw new TypeError("Super expression must either be null or a function");if(typeof L!="undefined"){if(L.has(B))return L.get(B);L.set(B,se)}function se(){return nu(B,arguments,jo(this).constructor)}return se.prototype=Object.create(B.prototype,{constructor:{value:se,enumerable:!1,writable:!0,configurable:!0}}),uo(se,B)},so(b)}function Ft(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}function nu(b,L,X){return Ft()?nu=Reflect.construct:nu=function(se,Le,ot){var Et=[null];Et.push.apply(Et,Le);var Pt=Function.bind.apply(se,Et),zr=new Pt;return ot&&uo(zr,ot.prototype),zr},nu.apply(null,arguments)}function Yt(b){return Function.toString.call(b).indexOf("[native code]")!==-1}function uo(b,L){return uo=Object.setPrototypeOf||function(B,se){return B.__proto__=se,B},uo(b,L)}function jo(b){return jo=Object.setPrototypeOf?Object.getPrototypeOf:function(X){return X.__proto__||Object.getPrototypeOf(X)},jo(b)}var vo=function(b){Ho(L,b);function L(){return b.apply(this,arguments)||this}return L}(so(Error)),no=function(b){Ho(L,b);function L(){return b.apply(this,arguments)||this}return L}(so(SyntaxError)),As=function(b){Ho(L,b);function L(){return b.apply(this,arguments)||this}return L}(so(ReferenceError)),qr=function(b){Ho(L,b);function L(){return b.apply(this,arguments)||this}return L}(so(TypeError)),xs=function(b){Ho(L,b);function L(){return b.apply(this,arguments)||this}return L}(vo),hn=function(b){Ho(L,b);function L(){return b.apply(this,arguments)||this}return L}(no),Ts=function(b){Ho(L,b);function L(){return b.apply(this,arguments)||this}return L}(As),wt={UnknownError:[3001,"%0",xs],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",xs],NodeTypeSyntaxError:[1001,"Unknown node type: %0",Ts],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",Ts],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",Ts],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",Ts],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",Ts],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",Ts],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",Ts],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",Ts],ParamTypeSyntaxError:[1009,"Unknown param type: %0",Ts],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",Ts],FunctionUndefinedReferenceError:[2001,"%0 is not a function",As],VariableUndefinedReferenceError:[2002,"%0 is not defined",As],IsNotConstructor:[2003,"%0 is not a constructor",qr]};function _l(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}function Us(b,L,X){return _l()?Us=Reflect.construct:Us=function(se,Le,ot){var Et=[null];Et.push.apply(Et,Le);var Pt=Function.bind.apply(se,Et),zr=new Pt;return ot&&ce(zr,ot.prototype),zr},Us.apply(null,arguments)}function ce(b,L){return ce=Object.setPrototypeOf||function(B,se){return B.__proto__=se,B},ce(b,L)}var Tu="0.0.3";function ls(b,L){Object.defineProperty(b,"name",{value:L,writable:!1,enumerable:!1,configurable:!0})}var $o=Object.prototype.hasOwnProperty,Ke=Symbol("Break"),me=Symbol("Continue"),Xe=Symbol("DefaultCase"),Ht=Symbol("EmptyStatementReturn"),rn=Symbol("WithScopeName"),Yn=Symbol("SuperScopeName"),la=Symbol("RootScopeName"),mo=Symbol("GlobalScopeName");function lo(b){return typeof b=="function"}var bo=function(){function b(X){this.interpreter=X}var L=b.prototype;return L.generator=function(){var B=this.interpreter;function se(){return this.getCurrentScope()}function Le(){return this.getGlobalScope()}function ot(){return this.getCurrentContext()}return{getOptions:B.getOptions.bind(B),getCurrentScope:se.bind(B),getGlobalScope:Le.bind(B),getCurrentContext:ot.bind(B),getExecStartTime:B.getExecStartTime.bind(B)}},b}();function qo(b,L,X){if(X===void 0&&(X=!0),!(b instanceof bo))throw new Error("Illegal call");if(typeof L!="string")return L;if(!!L){var B=b.generator(),se=B.getOptions(),Le={timeout:se.timeout,_initEnv:function(){X||this.setCurrentContext(B.getCurrentContext()),this.execStartTime=B.getExecStartTime(),this.execEndTime=this.execStartTime}},ot=X?B.getGlobalScope():B.getCurrentScope(),Et=new co(ot,Le);return Et.evaluate(L)}}Object.defineProperty(qo,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});function yc(b){if(!(b instanceof bo))throw new Error("Illegal call");for(var L=b.generator(),X=arguments.length,B=new Array(X>1?X-1:0),se=1;se<X;se++)B[se-1]=arguments[se];var Le=B.pop(),ot=new co(L.getGlobalScope(),L.getOptions()),Et=`
		    (function anonymous(`+B.join(",")+`){
		        `+Le+`
		    });
		    `;return ot.evaluate(Et)}Object.defineProperty(yc,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var gu=function(L){this.value=L},cs=function(L){this.value=L},iu=function(L){this.value=L},Mu=function(L,X,B){X===void 0&&(X=null),this.name=B,this.parent=X,this.data=L,this.labelStack=[]};function au(){}function js(b,L){return b===void 0&&(b=null),new Mu(Object.create(null),b,L)}function cl(b){return Object.create(b)}var Pu={NaN:NaN,Infinity:Infinity,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Float64Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:qo,Function:yc};typeof JSON!="undefined"&&(Pu.JSON=JSON),typeof Promise!="undefined"&&(Pu.Promise=Promise),typeof Set!="undefined"&&(Pu.Set=Set),typeof Map!="undefined"&&(Pu.Map=Map),typeof Symbol!="undefined"&&(Pu.Symbol=Symbol),typeof Proxy!="undefined"&&(Pu.Proxy=Proxy),typeof WeakMap!="undefined"&&(Pu.WeakMap=WeakMap),typeof WeakSet!="undefined"&&(Pu.WeakSet=WeakSet),typeof Reflect!="undefined"&&(Pu.Reflect=Reflect);var co=function(){function b(X,B){X===void 0&&(X=b.global),B===void 0&&(B={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:B.ecmaVersion||b.ecmaVersion,timeout:B.timeout||0,rootContext:B.rootContext,globalContextInFunction:B.globalContextInFunction===void 0?b.globalContextInFunction:B.globalContextInFunction,_initEnv:B._initEnv},this.context=X||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var L=b.prototype;return L.initEnvironment=function(B){var se;if(B instanceof Mu)se=B;else{var Le=null,ot=this.createSuperScope(B);this.options.rootContext&&(Le=new Mu(cl(this.options.rootContext),ot,la)),se=new Mu(B,Le||ot,mo)}this.globalScope=se,this.currentScope=this.globalScope,this.globalContext=se.data,this.currentContext=se.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var Et=this.options._initEnv;Et&&Et.call(this)},L.getExecStartTime=function(){return this.execStartTime},L.getExecutionTime=function(){return this.execEndTime-this.execStartTime},L.setExecTimeout=function(B){B===void 0&&(B=0),this.options.timeout=B},L.getOptions=function(){return this.options},L.getGlobalScope=function(){return this.globalScope},L.getCurrentScope=function(){return this.currentScope},L.getCurrentContext=function(){return this.currentContext},L.isInterruptThrow=function(B){return B instanceof xs||B instanceof Ts||B instanceof hn},L.createSuperScope=function(B){var se=Object.assign({},Pu),Le=Object.keys(se);return Le.forEach(function(ot){ot in B&&delete se[ot]}),new Mu(se,null,Yn)},L.setCurrentContext=function(B){this.currentContext=B},L.setCurrentScope=function(B){this.currentScope=B},L.evaluate=function(B){B===void 0&&(B="");var se;if(!!B)return se=Qi(B,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||b.ecmaVersion}),this.evaluateNode(se,B)},L.appendCode=function(B){return this.evaluate(B)},L.evaluateNode=function(B,se){var Le=this;se===void 0&&(se=""),this.value=void 0,this.source=se,this.sourceList.push(se),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var ot=this.getCurrentScope(),Et=this.getCurrentContext(),Pt=ot.labelStack.concat([]),zr=this.callStack.concat([]),Kr=function(){Le.setCurrentScope(ot),Le.setCurrentContext(Et),ot.labelStack=Pt,Le.callStack=zr};try{var oi=this.createClosure(B);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),oi()}catch(Ki){throw Ki}finally{Kr(),this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},L.createErrorMessage=function(B,se,Le){var ot=B[1].replace("%0",String(se));return Le!==null&&(ot+=this.getNodePosition(Le||this.lastExecNode)),ot},L.createError=function(B,se){return new se(B)},L.createThrowError=function(B,se){return this.createError(B,se)},L.createInternalThrowError=function(B,se,Le){return this.createError(this.createErrorMessage(B,se,Le),B[2])},L.checkTimeout=function(){if(!this.isRunning)return!1;var B=this.options.timeout||0,se=Date.now();return se-this.execStartTime>B},L.getNodePosition=function(B){if(B){var se="";return B.loc?" ["+B.loc.start.line+":"+B.loc.start.column+"]"+se:""}return""},L.createClosure=function(B){var se=this,Le;switch(B.type){case"BinaryExpression":Le=this.binaryExpressionHandler(B);break;case"LogicalExpression":Le=this.logicalExpressionHandler(B);break;case"UnaryExpression":Le=this.unaryExpressionHandler(B);break;case"UpdateExpression":Le=this.updateExpressionHandler(B);break;case"ObjectExpression":Le=this.objectExpressionHandler(B);break;case"ArrayExpression":Le=this.arrayExpressionHandler(B);break;case"CallExpression":Le=this.callExpressionHandler(B);break;case"NewExpression":Le=this.newExpressionHandler(B);break;case"MemberExpression":Le=this.memberExpressionHandler(B);break;case"ThisExpression":Le=this.thisExpressionHandler(B);break;case"SequenceExpression":Le=this.sequenceExpressionHandler(B);break;case"Literal":Le=this.literalHandler(B);break;case"Identifier":Le=this.identifierHandler(B);break;case"AssignmentExpression":Le=this.assignmentExpressionHandler(B);break;case"FunctionDeclaration":Le=this.functionDeclarationHandler(B);break;case"VariableDeclaration":Le=this.variableDeclarationHandler(B);break;case"BlockStatement":case"Program":Le=this.programHandler(B);break;case"ExpressionStatement":Le=this.expressionStatementHandler(B);break;case"EmptyStatement":Le=this.emptyStatementHandler(B);break;case"ReturnStatement":Le=this.returnStatementHandler(B);break;case"FunctionExpression":Le=this.functionExpressionHandler(B);break;case"IfStatement":Le=this.ifStatementHandler(B);break;case"ConditionalExpression":Le=this.conditionalExpressionHandler(B);break;case"ForStatement":Le=this.forStatementHandler(B);break;case"WhileStatement":Le=this.whileStatementHandler(B);break;case"DoWhileStatement":Le=this.doWhileStatementHandler(B);break;case"ForInStatement":Le=this.forInStatementHandler(B);break;case"WithStatement":Le=this.withStatementHandler(B);break;case"ThrowStatement":Le=this.throwStatementHandler(B);break;case"TryStatement":Le=this.tryStatementHandler(B);break;case"ContinueStatement":Le=this.continueStatementHandler(B);break;case"BreakStatement":Le=this.breakStatementHandler(B);break;case"SwitchStatement":Le=this.switchStatementHandler(B);break;case"LabeledStatement":Le=this.labeledStatementHandler(B);break;case"DebuggerStatement":Le=this.debuggerStatementHandler(B);break;default:throw this.createInternalThrowError(wt.NodeTypeSyntaxError,B.type,B)}return function(){var ot=se.options.timeout;if(ot&&ot>0&&se.checkTimeout())throw se.createInternalThrowError(wt.ExecutionTimeOutError,ot,null);return se.lastExecNode=B,Le.apply(void 0,arguments)}},L.binaryExpressionHandler=function(B){var se=this,Le=this.createClosure(B.left),ot=this.createClosure(B.right);return function(){var Et=Le(),Pt=ot();switch(B.operator){case"==":return Et==Pt;case"!=":return Et!=Pt;case"===":return Et===Pt;case"!==":return Et!==Pt;case"<":return Et<Pt;case"<=":return Et<=Pt;case">":return Et>Pt;case">=":return Et>=Pt;case"<<":return Et<<Pt;case">>":return Et>>Pt;case">>>":return Et>>>Pt;case"+":return Et+Pt;case"-":return Et-Pt;case"*":return Et*Pt;case"**":return Math.pow(Et,Pt);case"/":return Et/Pt;case"%":return Et%Pt;case"|":return Et|Pt;case"^":return Et^Pt;case"&":return Et&Pt;case"in":return Et in Pt;case"instanceof":return Et instanceof Pt;default:throw se.createInternalThrowError(wt.BinaryOperatorSyntaxError,B.operator,B)}}},L.logicalExpressionHandler=function(B){var se=this,Le=this.createClosure(B.left),ot=this.createClosure(B.right);return function(){switch(B.operator){case"||":return Le()||ot();case"&&":return Le()&&ot();default:throw se.createInternalThrowError(wt.LogicalOperatorSyntaxError,B.operator,B)}}},L.unaryExpressionHandler=function(B){var se=this;switch(B.operator){case"delete":var Le=this.createObjectGetter(B.argument),ot=this.createNameGetter(B.argument);return function(){var Kr=Le(),oi=ot();return delete Kr[oi]};default:var Et;if(B.operator==="typeof"&&B.argument.type==="Identifier"){var Pt=this.createObjectGetter(B.argument),zr=this.createNameGetter(B.argument);Et=function(){return Pt()[zr()]}}else Et=this.createClosure(B.argument);return function(){var Kr=Et();switch(B.operator){case"-":return-Kr;case"+":return+Kr;case"!":return!Kr;case"~":return~Kr;case"void":return;case"typeof":return typeof Kr;default:throw se.createInternalThrowError(wt.UnaryOperatorSyntaxError,B.operator,B)}}}},L.updateExpressionHandler=function(B){var se=this,Le=this.createObjectGetter(B.argument),ot=this.createNameGetter(B.argument);return function(){var Et=Le(),Pt=ot();switch(se.assertVariable(Et,Pt,B),B.operator){case"++":return B.prefix?++Et[Pt]:Et[Pt]++;case"--":return B.prefix?--Et[Pt]:Et[Pt]--;default:throw se.createInternalThrowError(wt.UpdateOperatorSyntaxError,B.operator,B)}}},L.objectExpressionHandler=function(B){var se=this,Le=[];function ot(Pt){return Pt.type==="Identifier"?Pt.name:Pt.type==="Literal"?Pt.value:this.throwError(wt.ObjectStructureSyntaxError,Pt.type,Pt)}var Et=Object.create(null);return B.properties.forEach(function(Pt){var zr=Pt.kind,Kr=ot(Pt.key);(!Et[Kr]||zr==="init")&&(Et[Kr]={}),Et[Kr][zr]=se.createClosure(Pt.value),Le.push({key:Kr,property:Pt})}),function(){for(var Pt={},zr=Le.length,Kr=0;Kr<zr;Kr++){var oi=Le[Kr],Ki=oi.key,Li=Et[Ki],Oa=Li.init?Li.init():void 0,sa=Li.get?Li.get():function(){},Va=Li.set?Li.set():function(Jo){};if("set"in Li||"get"in Li){var Qo={configurable:!0,enumerable:!0,get:sa,set:Va};Object.defineProperty(Pt,Ki,Qo)}else{var yu=oi.property,Ma=yu.kind;yu.key.type==="Identifier"&&yu.value.type==="FunctionExpression"&&Ma==="init"&&!yu.value.id&&ls(Oa,yu.key.name),Pt[Ki]=Oa}}return Pt}},L.arrayExpressionHandler=function(B){var se=this,Le=B.elements.map(function(ot){return ot&&se.createClosure(ot)});return function(){for(var ot=Le.length,Et=Array(ot),Pt=0;Pt<ot;Pt++){var zr=Le[Pt];zr&&(Et[Pt]=zr())}return Et}},L.safeObjectGet=function(B,se,Le){return B[se]},L.createCallFunctionGetter=function(B){var se=this;switch(B.type){case"MemberExpression":var Le=this.createClosure(B.object),ot=this.createMemberKeyGetter(B),Et=this.source;return function(){var zr=Le(),Kr=ot(),oi=se.safeObjectGet(zr,Kr,B);if(!oi||!lo(oi)){var Ki=Et.slice(B.start,B.end);throw se.createInternalThrowError(wt.FunctionUndefinedReferenceError,Ki,B)}return oi.__IS_EVAL_FUNC?function(Li){return oi(new bo(se),Li,!0)}:oi.__IS_FUNCTION_FUNC?function(){for(var Li=arguments.length,Oa=new Array(Li),sa=0;sa<Li;sa++)Oa[sa]=arguments[sa];return oi.apply(void 0,[new bo(se)].concat(Oa))}:oi.bind(zr)};default:var Pt=this.createClosure(B);return function(){var zr="";B.type==="Identifier"&&(zr=B.name);var Kr=Pt();if(!Kr||!lo(Kr))throw se.createInternalThrowError(wt.FunctionUndefinedReferenceError,zr,B);if(B.type==="Identifier"&&Kr.__IS_EVAL_FUNC&&zr==="eval")return function(Li){var Oa=se.getScopeFromName(zr,se.getCurrentScope()),sa=Oa.name===Yn||Oa.name===mo||Oa.name===la;return Kr(new bo(se),Li,!sa)};if(Kr.__IS_EVAL_FUNC)return function(Li){return Kr(new bo(se),Li,!0)};if(Kr.__IS_FUNCTION_FUNC)return function(){for(var Li=arguments.length,Oa=new Array(Li),sa=0;sa<Li;sa++)Oa[sa]=arguments[sa];return Kr.apply(void 0,[new bo(se)].concat(Oa))};var oi=se.options.globalContextInFunction;if(B.type==="Identifier"){var Ki=se.getIdentifierScope(B);Ki.name===rn&&(oi=Ki.data)}return Kr.bind(oi)}}},L.callExpressionHandler=function(B){var se=this,Le=this.createCallFunctionGetter(B.callee),ot=B.arguments.map(function(Et){return se.createClosure(Et)});return function(){return Le().apply(void 0,ot.map(function(Et){return Et()}))}},L.functionExpressionHandler=function(B){var se=this,Le=this,ot=this.source,Et=this.collectDeclVars,Pt=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var zr=B.id?B.id.name:"",Kr=B.params.length,oi=B.params.map(function(sa){return se.createParamNameGetter(sa)}),Ki=this.createClosure(B.body),Li=this.collectDeclVars,Oa=this.collectDeclFuncs;return this.collectDeclVars=Et,this.collectDeclFuncs=Pt,function(){var sa=Le.getCurrentScope(),Va=function Qo(){for(var yu=arguments.length,Ma=new Array(yu),Jo=0;Jo<yu;Jo++)Ma[Jo]=arguments[Jo];Le.callStack.push(""+zr);var _c=Le.getCurrentScope(),tc=js(sa,"FunctionScope("+zr+")");Le.setCurrentScope(tc),Le.addDeclarationsToScope(Li,Oa,tc),zr&&(tc.data[zr]=Qo),tc.data.arguments=arguments,oi.forEach(function(wf,Sl){tc.data[wf()]=Ma[Sl]});var Eo=Le.getCurrentContext();Le.setCurrentContext(this);var El=Ki();if(Le.setCurrentContext(Eo),Le.setCurrentScope(_c),Le.callStack.pop(),El instanceof gu)return El.value};return ls(Va,zr),Object.defineProperty(Va,"length",{value:Kr,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(Va,"toString",{value:function(){return ot.slice(B.start,B.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(Va,"valueOf",{value:function(){return ot.slice(B.start,B.end)},writable:!0,configurable:!0,enumerable:!1}),Va}},L.newExpressionHandler=function(B){var se=this,Le=this.source,ot=this.createClosure(B.callee),Et=B.arguments.map(function(Pt){return se.createClosure(Pt)});return function(){var Pt=ot();if(!lo(Pt)||Pt.__IS_EVAL_FUNC){var zr=B.callee,Kr=Le.slice(zr.start,zr.end);throw se.createInternalThrowError(wt.IsNotConstructor,Kr,B)}return Pt.__IS_FUNCTION_FUNC?Pt.apply(void 0,[new bo(se)].concat(Et.map(function(oi){return oi()}))):Us(Pt,Et.map(function(oi){return oi()}))}},L.memberExpressionHandler=function(B){var se=this.createClosure(B.object),Le=this.createMemberKeyGetter(B);return function(){var ot=se(),Et=Le();return ot[Et]}},L.thisExpressionHandler=function(B){var se=this;return function(){return se.getCurrentContext()}},L.sequenceExpressionHandler=function(B){var se=this,Le=B.expressions.map(function(ot){return se.createClosure(ot)});return function(){for(var ot,Et=Le.length,Pt=0;Pt<Et;Pt++){var zr=Le[Pt];ot=zr()}return ot}},L.literalHandler=function(B){return function(){return B.regex?new RegExp(B.regex.pattern,B.regex.flags):B.value}},L.identifierHandler=function(B){var se=this;return function(){var Le=se.getCurrentScope(),ot=se.getScopeDataFromName(B.name,Le);return se.assertVariable(ot,B.name,B),ot[B.name]}},L.getIdentifierScope=function(B){var se=this.getCurrentScope(),Le=this.getScopeFromName(B.name,se);return Le},L.assignmentExpressionHandler=function(B){var se=this;B.left.type==="Identifier"&&B.right.type==="FunctionExpression"&&!B.right.id&&(B.right.id={type:"Identifier",name:B.left.name});var Le=this.createObjectGetter(B.left),ot=this.createNameGetter(B.left),Et=this.createClosure(B.right);return function(){var Pt=Le(),zr=ot(),Kr=Et();switch(B.operator!=="="&&se.assertVariable(Pt,zr,B),B.operator){case"=":return Pt[zr]=Kr;case"+=":return Pt[zr]+=Kr;case"-=":return Pt[zr]-=Kr;case"*=":return Pt[zr]*=Kr;case"**=":return Pt[zr]=Math.pow(Pt[zr],Kr);case"/=":return Pt[zr]/=Kr;case"%=":return Pt[zr]%=Kr;case"<<=":return Pt[zr]<<=Kr;case">>=":return Pt[zr]>>=Kr;case">>>=":return Pt[zr]>>>=Kr;case"&=":return Pt[zr]&=Kr;case"^=":return Pt[zr]^=Kr;case"|=":return Pt[zr]|=Kr;default:throw se.createInternalThrowError(wt.AssignmentExpressionSyntaxError,B.type,B)}}},L.functionDeclarationHandler=function(B){if(B.id){var se=this.functionExpressionHandler(B);Object.defineProperty(se,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(B.id.name,se)}return function(){return Ht}},L.getVariableName=function(B){if(B.type==="Identifier")return B.name;throw this.createInternalThrowError(wt.VariableTypeSyntaxError,B.type,B)},L.variableDeclarationHandler=function(B){for(var se=this,Le,ot=[],Et=0;Et<B.declarations.length;Et++){var Pt=B.declarations[Et];this.varDeclaration(this.getVariableName(Pt.id)),Pt.init&&ot.push({type:"AssignmentExpression",operator:"=",left:Pt.id,right:Pt.init})}return ot.length&&(Le=this.createClosure({type:"BlockStatement",body:ot})),function(){if(Le){var zr=se.isVarDeclMode;se.isVarDeclMode=!0,Le(),se.isVarDeclMode=zr}return Ht}},L.assertVariable=function(B,se,Le){if(B===this.globalScope.data&&!(se in B))throw this.createInternalThrowError(wt.VariableUndefinedReferenceError,se,Le)},L.programHandler=function(B){var se=this,Le=B.body.map(function(ot){return se.createClosure(ot)});return function(){for(var ot=Ht,Et=0;Et<Le.length;Et++){var Pt=Le[Et],zr=se.setValue(Pt());if(zr!==Ht&&(ot=zr,ot instanceof gu||ot instanceof cs||ot instanceof iu||ot===Ke||ot===me))break}return ot}},L.expressionStatementHandler=function(B){return this.createClosure(B.expression)},L.emptyStatementHandler=function(B){return function(){return Ht}},L.returnStatementHandler=function(B){var se=B.argument?this.createClosure(B.argument):au;return function(){return new gu(se())}},L.ifStatementHandler=function(B){var se=this.createClosure(B.test),Le=this.createClosure(B.consequent),ot=B.alternate?this.createClosure(B.alternate):function(){return Ht};return function(){return se()?Le():ot()}},L.conditionalExpressionHandler=function(B){return this.ifStatementHandler(B)},L.forStatementHandler=function(B){var se=this,Le=au,ot=B.test?this.createClosure(B.test):function(){return!0},Et=au,Pt=this.createClosure(B.body);return B.type==="ForStatement"&&(Le=B.init?this.createClosure(B.init):Le,Et=B.update?this.createClosure(B.update):au),function(zr){var Kr,oi=Ht,Ki=B.type==="DoWhileStatement";for(zr&&zr.type==="LabeledStatement"&&(Kr=zr.label.name),Le();Ki||ot();Et()){Ki=!1;var Li=se.setValue(Pt());if(!(Li===Ht||Li===me)){if(Li===Ke)break;if(oi=Li,oi instanceof iu&&oi.value===Kr){oi=Ht;continue}if(oi instanceof gu||oi instanceof cs||oi instanceof iu)break}}return oi}},L.whileStatementHandler=function(B){return this.forStatementHandler(B)},L.doWhileStatementHandler=function(B){return this.forStatementHandler(B)},L.forInStatementHandler=function(B){var se=this,Le=B.left,ot=this.createClosure(B.right),Et=this.createClosure(B.body);return B.left.type==="VariableDeclaration"&&(this.createClosure(B.left)(),Le=B.left.declarations[0].id),function(Pt){var zr,Kr=Ht,oi;Pt&&Pt.type==="LabeledStatement"&&(zr=Pt.label.name);var Ki=ot();for(oi in Ki){se.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:Le,right:{type:"Literal",value:oi}})();var Li=se.setValue(Et());if(!(Li===Ht||Li===me)){if(Li===Ke)break;if(Kr=Li,Kr instanceof iu&&Kr.value===zr){Kr=Ht;continue}if(Kr instanceof gu||Kr instanceof cs||Kr instanceof iu)break}}return Kr}},L.withStatementHandler=function(B){var se=this,Le=this.createClosure(B.object),ot=this.createClosure(B.body);return function(){var Et=Le(),Pt=se.getCurrentScope(),zr=new Mu(Et,Pt,rn);se.setCurrentScope(zr);var Kr=se.setValue(ot());return se.setCurrentScope(Pt),Kr}},L.throwStatementHandler=function(B){var se=this,Le=this.createClosure(B.argument);return function(){throw se.setValue(void 0),Le()}},L.tryStatementHandler=function(B){var se=this,Le=this.createClosure(B.block),ot=B.handler?this.catchClauseHandler(B.handler):null,Et=B.finalizer?this.createClosure(B.finalizer):null;return function(){var Pt=se.getCurrentScope(),zr=se.getCurrentContext(),Kr=Pt.labelStack.concat([]),oi=se.callStack.concat([]),Ki=Ht,Li,Oa,sa=function(){se.setCurrentScope(Pt),se.setCurrentContext(zr),Pt.labelStack=Kr,se.callStack=oi};try{Ki=se.setValue(Le()),Ki instanceof gu&&(Li=Ki)}catch(Va){if(sa(),se.isInterruptThrow(Va))throw Va;if(ot)try{Ki=se.setValue(ot(Va)),Ki instanceof gu&&(Li=Ki)}catch(Qo){if(sa(),se.isInterruptThrow(Qo))throw Qo;Oa=Qo}}if(Et)try{Ki=Et(),Ki instanceof gu&&(Li=Ki)}catch(Va){if(sa(),se.isInterruptThrow(Va))throw Va;Oa=Va}if(Oa)throw Oa;return Li||Ki}},L.catchClauseHandler=function(B){var se=this,Le=this.createParamNameGetter(B.param),ot=this.createClosure(B.body);return function(Et){var Pt,zr=se.getCurrentScope(),Kr=zr.data,oi=Le(),Ki=$o.call(Kr,oi),Li=Kr[oi];return Kr[oi]=Et,Pt=ot(),Ki?Kr[oi]=Li:delete Kr[oi],Pt}},L.continueStatementHandler=function(B){return function(){return B.label?new iu(B.label.name):me}},L.breakStatementHandler=function(B){return function(){return B.label?new cs(B.label.name):Ke}},L.switchStatementHandler=function(B){var se=this,Le=this.createClosure(B.discriminant),ot=B.cases.map(function(Et){return se.switchCaseHandler(Et)});return function(){for(var Et=Le(),Pt=!1,zr,Kr,oi,Ki=0;Ki<ot.length;Ki++){var Li=ot[Ki](),Oa=Li.testClosure();if(Oa===Xe){oi=Li;continue}if(Pt||Oa===Et){if(Pt=!0,Kr=se.setValue(Li.bodyClosure()),Kr===Ht)continue;if(Kr===Ke||(zr=Kr,zr instanceof gu||zr instanceof cs||zr instanceof iu||zr===me))break}}if(!Pt&&oi){Kr=se.setValue(oi.bodyClosure());var sa=Kr===Ht||Kr===Ke||Kr===me;sa||(zr=Kr)}return zr}},L.switchCaseHandler=function(B){var se=B.test?this.createClosure(B.test):function(){return Xe},Le=this.createClosure({type:"BlockStatement",body:B.consequent});return function(){return{testClosure:se,bodyClosure:Le}}},L.labeledStatementHandler=function(B){var se=this,Le=B.label.name,ot=this.createClosure(B.body);return function(){var Et,Pt=se.getCurrentScope();return Pt.labelStack.push(Le),Et=ot(B),Et instanceof cs&&Et.value===Le&&(Et=Ht),Pt.labelStack.pop(),Et}},L.debuggerStatementHandler=function(B){return function(){debugger;return Ht}},L.createParamNameGetter=function(B){if(B.type==="Identifier")return function(){return B.name};throw this.createInternalThrowError(wt.ParamTypeSyntaxError,B.type,B)},L.createObjectKeyGetter=function(B){var se;return B.type==="Identifier"?se=function(){return B.name}:se=this.createClosure(B),function(){return se()}},L.createMemberKeyGetter=function(B){return B.computed?this.createClosure(B.property):this.createObjectKeyGetter(B.property)},L.createObjectGetter=function(B){var se=this;switch(B.type){case"Identifier":return function(){return se.getScopeDataFromName(B.name,se.getCurrentScope())};case"MemberExpression":return this.createClosure(B.object);default:throw this.createInternalThrowError(wt.AssignmentTypeSyntaxError,B.type,B)}},L.createNameGetter=function(B){switch(B.type){case"Identifier":return function(){return B.name};case"MemberExpression":return this.createMemberKeyGetter(B);default:throw this.createInternalThrowError(wt.AssignmentTypeSyntaxError,B.type,B)}},L.varDeclaration=function(B){var se=this.collectDeclVars;se[B]=void 0},L.funcDeclaration=function(B,se){var Le=this.collectDeclFuncs;Le[B]=se},L.addDeclarationsToScope=function(B,se,Le){var ot=Le.data;for(var Et in se){var Pt=se[Et];ot[Et]=Pt&&Pt()}for(var zr in B)zr in ot||(ot[zr]=void 0)},L.getScopeValue=function(B,se){var Le=this.getScopeFromName(B,se);return Le.data[B]},L.getScopeDataFromName=function(B,se){return this.getScopeFromName(B,se).data},L.getScopeFromName=function(B,se){var Le=se;do if(B in Le.data)return Le;while(Le=Le.parent);return this.globalScope},L.setValue=function(B){var se=this.callStack.length;return this.isVarDeclMode||se||B===Ht||B===Ke||B===me||B instanceof cs||B instanceof iu||(this.value=B instanceof gu?B.value:B),B},L.getValue=function(){return this.value},b}();co.version=Tu,co.eval=qo,co.Function=yc,co.ecmaVersion=5,co.globalContextInFunction=void 0,co.global=Object.create(null);function Po(b){return b===void 0&&(b=Object.create(null)),b}function Ha(b,L,X){L===void 0&&(L=[]),X===void 0&&(X={});var B=X.parsingContext,se=X.timeout===void 0?0:X.timeout,Le=`
    (function anonymous(`+L.join(",")+`){
         `+b+`
    });
    `,ot=new co(B,{ecmaVersion:X.ecmaVersion,timeout:se,rootContext:X.rootContext,globalContextInFunction:X.globalContextInFunction});return ot.evaluate(Le)}function Wa(b,L,X){var B=new co(L,X);return B.evaluate(b)}var Yh=Wa,Bc=function(){function b(X){this._code=X}var L=b.prototype;return L.runInContext=function(B){return Wa(this._code,B)},L.runInNewContext=function(B){return Wa(this._code,B)},b}(),Nc=function(b,L,X){return Wa(b,L,X)},xl=function(){for(var b=arguments.length,L=new Array(b),X=0;X<b;X++)L[X]=arguments[X];var B=L.pop();return Ha(B||"",L)},bl=$.default=Nc},t2Dn:function(le,$,M){var j=M("hypo"),Z=M("ljhN");function Y(k,h,V){(V!==void 0&&!Z(k[h],V)||V===void 0&&!(h in k))&&j(k,h,V)}le.exports=Y},u6S6:function(le,$,M){var j=M("6acW"),Z=M("sgoq"),Y=Z(function(k,h,V){return h=h.toLowerCase(),k+(V?j(h):h)});le.exports=Y},uhBA:function(le,$,M){"use strict";var j=Object.prototype.hasOwnProperty,Z="~";function Y(){}Object.create&&(Y.prototype=Object.create(null),new Y().__proto__||(Z=!1));function k(te,pe,Oe){this.fn=te,this.context=pe,this.once=Oe||!1}function h(te,pe,Oe,Ae,vt){if(typeof Oe!="function")throw new TypeError("The listener must be a function");var at=new k(Oe,Ae||te,vt),gt=Z?Z+pe:pe;return te._events[gt]?te._events[gt].fn?te._events[gt]=[te._events[gt],at]:te._events[gt].push(at):(te._events[gt]=at,te._eventsCount++),te}function V(te,pe){--te._eventsCount==0?te._events=new Y:delete te._events[pe]}function H(){this._events=new Y,this._eventsCount=0}H.prototype.eventNames=function(){var pe=[],Oe,Ae;if(this._eventsCount===0)return pe;for(Ae in Oe=this._events)j.call(Oe,Ae)&&pe.push(Z?Ae.slice(1):Ae);return Object.getOwnPropertySymbols?pe.concat(Object.getOwnPropertySymbols(Oe)):pe},H.prototype.listeners=function(pe){var Oe=Z?Z+pe:pe,Ae=this._events[Oe];if(!Ae)return[];if(Ae.fn)return[Ae.fn];for(var vt=0,at=Ae.length,gt=new Array(at);vt<at;vt++)gt[vt]=Ae[vt].fn;return gt},H.prototype.listenerCount=function(pe){var Oe=Z?Z+pe:pe,Ae=this._events[Oe];return Ae?Ae.fn?1:Ae.length:0},H.prototype.emit=function(pe,Oe,Ae,vt,at,gt){var yt=Z?Z+pe:pe;if(!this._events[yt])return!1;var St=this._events[yt],He=arguments.length,dt,ct;if(St.fn){switch(St.once&&this.removeListener(pe,St.fn,void 0,!0),He){case 1:return St.fn.call(St.context),!0;case 2:return St.fn.call(St.context,Oe),!0;case 3:return St.fn.call(St.context,Oe,Ae),!0;case 4:return St.fn.call(St.context,Oe,Ae,vt),!0;case 5:return St.fn.call(St.context,Oe,Ae,vt,at),!0;case 6:return St.fn.call(St.context,Oe,Ae,vt,at,gt),!0}for(ct=1,dt=new Array(He-1);ct<He;ct++)dt[ct-1]=arguments[ct];St.fn.apply(St.context,dt)}else{var _t=St.length,ee;for(ct=0;ct<_t;ct++)switch(St[ct].once&&this.removeListener(pe,St[ct].fn,void 0,!0),He){case 1:St[ct].fn.call(St[ct].context);break;case 2:St[ct].fn.call(St[ct].context,Oe);break;case 3:St[ct].fn.call(St[ct].context,Oe,Ae);break;case 4:St[ct].fn.call(St[ct].context,Oe,Ae,vt);break;default:if(!dt)for(ee=1,dt=new Array(He-1);ee<He;ee++)dt[ee-1]=arguments[ee];St[ct].fn.apply(St[ct].context,dt)}}return!0},H.prototype.on=function(pe,Oe,Ae){return h(this,pe,Oe,Ae,!1)},H.prototype.once=function(pe,Oe,Ae){return h(this,pe,Oe,Ae,!0)},H.prototype.removeListener=function(pe,Oe,Ae,vt){var at=Z?Z+pe:pe;if(!this._events[at])return this;if(!Oe)return V(this,at),this;var gt=this._events[at];if(gt.fn)gt.fn===Oe&&(!vt||gt.once)&&(!Ae||gt.context===Ae)&&V(this,at);else{for(var yt=0,St=[],He=gt.length;yt<He;yt++)(gt[yt].fn!==Oe||vt&&!gt[yt].once||Ae&&gt[yt].context!==Ae)&&St.push(gt[yt]);St.length?this._events[at]=St.length===1?St[0]:St:V(this,at)}return this},H.prototype.removeAllListeners=function(pe){var Oe;return pe?(Oe=Z?Z+pe:pe,this._events[Oe]&&V(this,Oe)):(this._events=new Y,this._eventsCount=0),this},H.prototype.off=H.prototype.removeListener,H.prototype.addListener=H.prototype.on,H.prefixed=Z,H.EventEmitter=H,le.exports=H},ujMp:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.circularDependencyToException=$.listMetadataForTarget=$.listRegisteredBindingsForServiceIdentifier=$.getServiceIdentifierAsString=$.getFunctionName=void 0;var j=M("MON2");function Z(pe){if(typeof pe=="function"){var Oe=pe;return Oe.name}else{if(typeof pe=="symbol")return pe.toString();var Oe=pe;return Oe}}$.getServiceIdentifierAsString=Z;function Y(pe,Oe,Ae){var vt="",at=Ae(pe,Oe);return at.length!==0&&(vt=`
Registered bindings:`,at.forEach(function(gt){var yt="Object";gt.implementationType!==null&&(yt=te(gt.implementationType)),vt=vt+`
 `+yt,gt.constraint.metaData&&(vt=vt+" - "+gt.constraint.metaData)})),vt}$.listRegisteredBindingsForServiceIdentifier=Y;function k(pe,Oe){return pe.parentRequest===null?!1:pe.parentRequest.serviceIdentifier===Oe?!0:k(pe.parentRequest,Oe)}function h(pe){function Oe(vt,at){at===void 0&&(at=[]);var gt=Z(vt.serviceIdentifier);return at.push(gt),vt.parentRequest!==null?Oe(vt.parentRequest,at):at}var Ae=Oe(pe);return Ae.reverse().join(" --> ")}function V(pe){pe.childRequests.forEach(function(Oe){if(k(Oe,Oe.serviceIdentifier)){var Ae=h(Oe);throw new Error(j.CIRCULAR_DEPENDENCY+" "+Ae)}else V(Oe)})}$.circularDependencyToException=V;function H(pe,Oe){if(Oe.isTagged()||Oe.isNamed()){var Ae="",vt=Oe.getNamedTag(),at=Oe.getCustomTags();return vt!==null&&(Ae+=vt.toString()+`
`),at!==null&&at.forEach(function(gt){Ae+=gt.toString()+`
`})," "+pe+`
 `+pe+" - "+Ae}else return" "+pe}$.listMetadataForTarget=H;function te(pe){if(pe.name)return pe.name;var Oe=pe.toString(),Ae=Oe.match(/^function\s*([^\s(]+)/);return Ae?Ae[1]:"Anonymous function: "+Oe}$.getFunctionName=te},"vN+2":function(le,$){function M(){}le.exports=M},"w/wX":function(le,$,M){var j=M("QqLw"),Z=M("ExA7"),Y="[object Set]";function k(h){return Z(h)&&j(h)==Y}le.exports=k},wclG:function(le,$,M){var j=M("pFRH"),Z=M("88Gu"),Y=Z(j);le.exports=Y},wnjb:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.MetadataReader=void 0;var j=M("xfSm"),Z=function(){function Y(){}return Y.prototype.getConstructorMetadata=function(k){var h=Reflect.getMetadata(j.PARAM_TYPES,k),V=Reflect.getMetadata(j.TAGGED,k);return{compilerGeneratedMetadata:h,userGeneratedMetadata:V||{}}},Y.prototype.getPropertiesMetadata=function(k){var h=Reflect.getMetadata(j.TAGGED_PROP,k)||[];return h},Y}();$.MetadataReader=Z},wrZu:function(le,$,M){var j=M("+K+b"),Z=M("XYm9"),Y=M("b2z7"),k=M("otv/"),h=M("yP5f"),V="[object Boolean]",H="[object Date]",te="[object Map]",pe="[object Number]",Oe="[object RegExp]",Ae="[object Set]",vt="[object String]",at="[object Symbol]",gt="[object ArrayBuffer]",yt="[object DataView]",St="[object Float32Array]",He="[object Float64Array]",dt="[object Int8Array]",ct="[object Int16Array]",_t="[object Int32Array]",ee="[object Uint8Array]",rr="[object Uint8ClampedArray]",Fr="[object Uint16Array]",Mr="[object Uint32Array]";function Nt(ze,zt,Kt){var vr=ze.constructor;switch(zt){case gt:return j(ze);case V:case H:return new vr(+ze);case yt:return Z(ze,Kt);case St:case He:case dt:case ct:case _t:case ee:case rr:case Fr:case Mr:return h(ze,Kt);case te:return new vr;case pe:case vt:return new vr(ze);case Oe:return Y(ze);case Ae:return new vr;case at:return k(ze)}}le.exports=Nt},wy8a:function(le,$,M){var j=M("KxBF");function Z(Y,k,h){var V=Y.length;return h=h===void 0?V:h,!k&&h>=V?Y:j(Y,k,h)}le.exports=Z},xfSm:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.NON_CUSTOM_TAG_KEYS=$.POST_CONSTRUCT=$.DESIGN_PARAM_TYPES=$.PARAM_TYPES=$.TAGGED_PROP=$.TAGGED=$.MULTI_INJECT_TAG=$.INJECT_TAG=$.OPTIONAL_TAG=$.UNMANAGED_TAG=$.NAME_TAG=$.NAMED_TAG=void 0,$.NAMED_TAG="named",$.NAME_TAG="name",$.UNMANAGED_TAG="unmanaged",$.OPTIONAL_TAG="optional",$.INJECT_TAG="inject",$.MULTI_INJECT_TAG="multi_inject",$.TAGGED="inversify:tagged",$.TAGGED_PROP="inversify:tagged_props",$.PARAM_TYPES="inversify:paramtypes",$.DESIGN_PARAM_TYPES="design:paramtypes",$.POST_CONSTRUCT="post_construct";function j(){return[$.INJECT_TAG,$.MULTI_INJECT_TAG,$.NAME_TAG,$.UNMANAGED_TAG,$.NAMED_TAG,$.OPTIONAL_TAG]}$.NON_CUSTOM_TAG_KEYS=j()},xfeJ:function(le,$){function M(j){return Function.toString.call(j).indexOf("[native code]")!==-1}le.exports=M,le.exports.__esModule=!0,le.exports.default=le.exports},xiII:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Request=void 0;var j=M("d9O0"),Z=function(){function Y(k,h,V,H,te){this.id=j.id(),this.serviceIdentifier=k,this.parentContext=h,this.parentRequest=V,this.target=te,this.childRequests=[],this.bindings=Array.isArray(H)?H:[H],this.requestScope=V===null?new Map:null}return Y.prototype.addChildRequest=function(k,h,V){var H=new Y(k,this.parentContext,this,h,V);return this.childRequests.push(H),H},Y}();$.Request=Z},xp6e:function(le,$,M){"use strict";(function(j){M.d($,"a",function(){return mt}),M.d($,"b",function(){return Ut}),M.d($,"c",function(){return be}),M.d($,"d",function(){return br});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Z(Xt,It,Lt,ir){function Ar(nr){return nr instanceof Lt?nr:new Lt(function(Pr){Pr(nr)})}return new(Lt||(Lt=Promise))(function(nr,Pr){function $r(Br){try{_r(ir.next(Br))}catch(Jn){Pr(Jn)}}function Or(Br){try{_r(ir.throw(Br))}catch(Jn){Pr(Jn)}}function _r(Br){Br.done?nr(Br.value):Ar(Br.value).then($r,Or)}_r((ir=ir.apply(Xt,It||[])).next())})}function Y(Xt,It){var Lt={label:0,sent:function(){if(nr[0]&1)throw nr[1];return nr[1]},trys:[],ops:[]},ir,Ar,nr,Pr;return Pr={next:$r(0),throw:$r(1),return:$r(2)},typeof Symbol=="function"&&(Pr[Symbol.iterator]=function(){return this}),Pr;function $r(_r){return function(Br){return Or([_r,Br])}}function Or(_r){if(ir)throw new TypeError("Generator is already executing.");for(;Lt;)try{if(ir=1,Ar&&(nr=_r[0]&2?Ar.return:_r[0]?Ar.throw||((nr=Ar.return)&&nr.call(Ar),0):Ar.next)&&!(nr=nr.call(Ar,_r[1])).done)return nr;switch(Ar=0,nr&&(_r=[_r[0]&2,nr.value]),_r[0]){case 0:case 1:nr=_r;break;case 4:return Lt.label++,{value:_r[1],done:!1};case 5:Lt.label++,Ar=_r[1],_r=[0];continue;case 7:_r=Lt.ops.pop(),Lt.trys.pop();continue;default:if(nr=Lt.trys,!(nr=nr.length>0&&nr[nr.length-1])&&(_r[0]===6||_r[0]===2)){Lt=0;continue}if(_r[0]===3&&(!nr||_r[1]>nr[0]&&_r[1]<nr[3])){Lt.label=_r[1];break}if(_r[0]===6&&Lt.label<nr[1]){Lt.label=nr[1],nr=_r;break}if(nr&&Lt.label<nr[2]){Lt.label=nr[2],Lt.ops.push(_r);break}nr[2]&&Lt.ops.pop(),Lt.trys.pop();continue}_r=It.call(Xt,Lt)}catch(Br){_r=[6,Br],Ar=0}finally{ir=nr=0}if(_r[0]&5)throw _r[1];return{value:_r[0]?_r[1]:void 0,done:!0}}}function k(Xt,It){var Lt=typeof Symbol=="function"&&Xt[Symbol.iterator];if(!Lt)return Xt;var ir=Lt.call(Xt),Ar,nr=[],Pr;try{for(;(It===void 0||It-- >0)&&!(Ar=ir.next()).done;)nr.push(Ar.value)}catch($r){Pr={error:$r}}finally{try{Ar&&!Ar.done&&(Lt=ir.return)&&Lt.call(ir)}finally{if(Pr)throw Pr.error}}return nr}function h(){for(var Xt=[],It=0;It<arguments.length;It++)Xt=Xt.concat(k(arguments[It]));return Xt}function V(Xt){return Xt&&Xt.__esModule&&Object.prototype.hasOwnProperty.call(Xt,"default")?Xt.default:Xt}function H(Xt,It){return It={exports:{}},Xt(It,It.exports),It.exports}var te=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=Lt;function Lt(ir){return ir&&typeof ir.length=="number"&&ir.length>=0&&ir.length%1==0}Xt.exports=It.default});V(te);var pe=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=function(Lt){return function(){for(var ir=[],Ar=arguments.length;Ar--;)ir[Ar]=arguments[Ar];var nr=ir.pop();return Lt.call(this,ir,nr)}},Xt.exports=It.default});V(pe);var Oe=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.fallback=Ar,It.wrap=nr;var Lt=It.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,ir=It.hasNextTick=typeof j=="object"&&typeof j.nextTick=="function";function Ar($r){setTimeout($r,0)}function nr($r){return function(Or){for(var _r=[],Br=arguments.length-1;Br-- >0;)_r[Br]=arguments[Br+1];return $r(function(){return Or.apply(void 0,_r)})}}var Pr;Lt?Pr=setImmediate:ir?Pr=j.nextTick:Pr=Ar,It.default=nr(Pr)});V(Oe);var Ae=Oe.fallback,vt=Oe.wrap,at=Oe.hasSetImmediate,gt=Oe.hasNextTick,yt=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=nr;var Lt=Ar(pe),ir=Ar(Oe);function Ar(Or){return Or&&Or.__esModule?Or:{default:Or}}function nr(Or){return(0,St.isAsync)(Or)?function(){for(var _r=[],Br=arguments.length;Br--;)_r[Br]=arguments[Br];var Jn=_r.pop(),mn=Or.apply(this,_r);return Pr(mn,Jn)}:(0,Lt.default)(function(_r,Br){var Jn;try{Jn=Or.apply(this,_r)}catch(mn){return Br(mn)}if(Jn&&typeof Jn.then=="function")return Pr(Jn,Br);Br(null,Jn)})}function Pr(Or,_r){return Or.then(function(Br){$r(_r,null,Br)},function(Br){$r(_r,Br&&Br.message?Br:new Error(Br))})}function $r(Or,_r,Br){try{Or(_r,Br)}catch(Jn){(0,ir.default)(function(mn){throw mn},Jn)}}Xt.exports=It.default});V(yt);var St=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.isAsyncIterable=It.isAsyncGenerator=It.isAsync=void 0;var Lt=ir(yt);function ir(Or){return Or&&Or.__esModule?Or:{default:Or}}function Ar(Or){return Or[Symbol.toStringTag]==="AsyncFunction"}function nr(Or){return Or[Symbol.toStringTag]==="AsyncGenerator"}function Pr(Or){return typeof Or[Symbol.asyncIterator]=="function"}function $r(Or){if(typeof Or!="function")throw new Error("expected a function");return Ar(Or)?(0,Lt.default)(Or):Or}It.default=$r,It.isAsync=Ar,It.isAsyncGenerator=nr,It.isAsyncIterable=Pr});V(St);var He=St.isAsyncIterable,dt=St.isAsyncGenerator,ct=St.isAsync,_t=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=Lt;function Lt(ir,Ar){if(Ar===void 0&&(Ar=ir.length),!Ar)throw new Error("arity is undefined");function nr(){for(var Pr=this,$r=[],Or=arguments.length;Or--;)$r[Or]=arguments[Or];return typeof $r[Ar-1]=="function"?ir.apply(this,$r):new Promise(function(_r,Br){$r[Ar-1]=function(Jn){for(var mn=[],wn=arguments.length-1;wn-- >0;)mn[wn]=arguments[wn+1];if(Jn)return Br(Jn);_r(mn.length>1?mn:mn[0])},ir.apply(Pr,$r)})}return Object.defineProperty(nr,"name",{configurable:!0,value:"awaitable("+ir.name+")"}),nr}Xt.exports=It.default});V(_t);var ee=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0});var Lt=nr(te),ir=nr(St),Ar=nr(_t);function nr(Pr){return Pr&&Pr.__esModule?Pr:{default:Pr}}It.default=(0,Ar.default)(function(Pr,$r,Or){var _r=(0,Lt.default)($r)?[]:{};Pr($r,function(Br,Jn,mn){(0,ir.default)(Br)(function(wn){for(var pi,Ci=[],fa=arguments.length-1;fa-- >0;)Ci[fa]=arguments[fa+1];Ci.length<2&&(pi=Ci,Ci=pi[0]),_r[Jn]=Ci,mn(wn)})},function(Br){return Or(Br,_r)})},3),Xt.exports=It.default});V(ee);var rr=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=Lt;function Lt(ir){function Ar(){for(var nr=[],Pr=arguments.length;Pr--;)nr[Pr]=arguments[Pr];if(ir!==null){var $r=ir;ir=null,$r.apply(this,nr)}}return Object.assign(Ar,ir),Ar}Xt.exports=It.default});V(rr);var Fr=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=function(Lt){return Lt[Symbol.iterator]&&Lt[Symbol.iterator]()},Xt.exports=It.default});V(Fr);var Mr=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=Or;var Lt=Ar(te),ir=Ar(Fr);function Ar(_r){return _r&&_r.__esModule?_r:{default:_r}}function nr(_r){var Br=-1,Jn=_r.length;return function(){return++Br<Jn?{value:_r[Br],key:Br}:null}}function Pr(_r){var Br=-1;return function(){var mn=_r.next();return mn.done?null:(Br++,{value:mn.value,key:Br})}}function $r(_r){var Br=_r?Object.keys(_r):[],Jn=-1,mn=Br.length;return function(){var pi=Br[++Jn];return Jn<mn?{value:_r[pi],key:pi}:null}}function Or(_r){if((0,Lt.default)(_r))return nr(_r);var Br=(0,ir.default)(_r);return Br?Pr(Br):$r(_r)}Xt.exports=It.default});V(Mr);var Nt=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=Lt;function Lt(ir){return function(){for(var Ar=[],nr=arguments.length;nr--;)Ar[nr]=arguments[nr];if(ir===null)throw new Error("Callback was already called.");var Pr=ir;ir=null,Pr.apply(this,Ar)}}Xt.exports=It.default});V(Nt);var ze=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0});var Lt={};It.default=Lt,Xt.exports=It.default});V(ze);var zt=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=Ar;var Lt=ir(ze);function ir(nr){return nr&&nr.__esModule?nr:{default:nr}}function Ar(nr,Pr,$r,Or){var _r=!1,Br=!1,Jn=!1,mn=0,wn=0;function pi(){mn>=Pr||Jn||_r||(Jn=!0,nr.next().then(function(_e){var Pn=_e.value,oa=_e.done;if(!(Br||_r)){if(Jn=!1,oa){_r=!0,mn<=0&&Or(null);return}mn++,$r(Pn,wn,Ci),wn++,pi()}}).catch(fa))}function Ci(_e,Pn){if(mn-=1,!Br){if(_e)return fa(_e);if(_e===!1){_r=!0,Br=!0;return}if(Pn===Lt.default||_r&&mn<=0)return _r=!0,Or(null);pi()}}function fa(_e){Br||(Jn=!1,_r=!0,Or(_e))}pi()}Xt.exports=It.default});V(zt);var Kt=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0});var Lt=$r(rr),ir=$r(Mr),Ar=$r(Nt),nr=$r(zt),Pr=$r(ze);function $r(Or){return Or&&Or.__esModule?Or:{default:Or}}It.default=function(Or){return function(_r,Br,Jn){if(Jn=(0,Lt.default)(Jn),Or<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!_r)return Jn(null);if((0,St.isAsyncGenerator)(_r))return(0,nr.default)(_r,Or,Br,Jn);if((0,St.isAsyncIterable)(_r))return(0,nr.default)(_r[Symbol.asyncIterator](),Or,Br,Jn);var mn=(0,ir.default)(_r),wn=!1,pi=!1,Ci=0,fa=!1;function _e(oa,ws){if(!pi)if(Ci-=1,oa)wn=!0,Jn(oa);else if(oa===!1)wn=!0,pi=!0;else{if(ws===Pr.default||wn&&Ci<=0)return wn=!0,Jn(null);fa||Pn()}}function Pn(){for(fa=!0;Ci<Or&&!wn;){var oa=mn();if(oa===null){wn=!0,Ci<=0&&Jn(null);return}Ci+=1,Br(oa.value,oa.key,(0,Ar.default)(_e))}fa=!1}Pn()}},Xt.exports=It.default});V(Kt);var vr=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0});var Lt=nr(Kt),ir=nr(St),Ar=nr(_t);function nr($r){return $r&&$r.__esModule?$r:{default:$r}}function Pr($r,Or,_r,Br){return(0,Lt.default)(Or)($r,(0,ir.default)(_r),Br)}It.default=(0,Ar.default)(Pr,4),Xt.exports=It.default});V(vr);var jr=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0});var Lt=Ar(vr),ir=Ar(_t);function Ar(Pr){return Pr&&Pr.__esModule?Pr:{default:Pr}}function nr(Pr,$r,Or){return(0,Lt.default)(Pr,1,$r,Or)}It.default=(0,ir.default)(nr,3),Xt.exports=It.default});V(jr);var vn=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=nr;var Lt=Ar(ee),ir=Ar(jr);function Ar(Pr){return Pr&&Pr.__esModule?Pr:{default:Pr}}function nr(Pr,$r){return(0,Lt.default)(ir.default,Pr,$r)}Xt.exports=It.default}),kr=V(vn),be=function(){function Xt(){for(var It=arguments,Lt=[],ir=0;ir<arguments.length;ir++)Lt[ir]=It[ir];this.args=[],this.tasks=[]}return Xt.prototype.call=function(){for(var It=arguments,Lt=[],ir=0;ir<arguments.length;ir++)Lt[ir]=It[ir];return this.args=Lt,kr(this.tasks)},Xt.prototype.tap=function(It,Lt){var ir=this;this.tasks.push(function(Ar){Lt.apply(void 0,h(ir.args)),Ar(null,It)})},Xt}(),Ne=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0});var Lt=_r(te),ir=_r(ze),Ar=_r(vr),nr=_r(rr),Pr=_r(Nt),$r=_r(St),Or=_r(_t);function _r(wn){return wn&&wn.__esModule?wn:{default:wn}}function Br(wn,pi,Ci){Ci=(0,nr.default)(Ci);var fa=0,_e=0,Pn=wn.length,oa=!1;Pn===0&&Ci(null);function ws(ys,Jt){ys===!1&&(oa=!0),oa!==!0&&(ys?Ci(ys):(++_e===Pn||Jt===ir.default)&&Ci(null))}for(;fa<Pn;fa++)pi(wn[fa],fa,(0,Pr.default)(ws))}function Jn(wn,pi,Ci){return(0,Ar.default)(wn,Infinity,pi,Ci)}function mn(wn,pi,Ci){var fa=(0,Lt.default)(wn)?Br:Jn;return fa(wn,(0,$r.default)(pi),Ci)}It.default=(0,Or.default)(mn,3),Xt.exports=It.default});V(Ne);var Ie=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=nr;var Lt=Ar(Ne),ir=Ar(ee);function Ar(Pr){return Pr&&Pr.__esModule?Pr:{default:Pr}}function nr(Pr,$r){return(0,ir.default)(Lt.default,Pr,$r)}Xt.exports=It.default}),pt=V(Ie),mt=function(){function Xt(){for(var It=arguments,Lt=[],ir=0;ir<arguments.length;ir++)Lt[ir]=It[ir];this.tasks=[]}return Xt.prototype.promise=function(){for(var It=arguments,Lt=[],ir=0;ir<arguments.length;ir++)Lt[ir]=It[ir];return pt(this.tasks)},Xt.prototype.tapPromise=function(It,Lt){var ir=this;this.tasks.push(function(Ar){return Z(ir,void 0,void 0,function(){return Y(this,function(nr){switch(nr.label){case 0:return[4,Lt()];case 1:return nr.sent(),Ar(null,It),[2]}})})})},Xt}(),Dt=H(function(Xt,It){Object.defineProperty(It,"__esModule",{value:!0});var Lt=Pr(rr),ir=Pr(Nt),Ar=Pr(St),nr=Pr(_t);function Pr(Or){return Or&&Or.__esModule?Or:{default:Or}}function $r(Or,_r){if(_r=(0,Lt.default)(_r),!Array.isArray(Or))return _r(new Error("First argument to waterfall must be an array of functions"));if(!Or.length)return _r();var Br=0;function Jn(wn){var pi=(0,Ar.default)(Or[Br++]);pi.apply(void 0,wn.concat([(0,ir.default)(mn)]))}function mn(wn){for(var pi=[],Ci=arguments.length-1;Ci-- >0;)pi[Ci]=arguments[Ci+1];if(wn!==!1){if(wn||Br===Or.length)return _r.apply(void 0,[wn].concat(pi));Jn(pi)}}Jn([])}It.default=(0,nr.default)($r),Xt.exports=It.default}),w=V(Dt),br=function(){function Xt(){for(var It=arguments,Lt=[],ir=0;ir<arguments.length;ir++)Lt[ir]=It[ir];this.tasks=[]}return Xt.prototype.call=function(){for(var It=arguments,Lt=[],ir=0;ir<arguments.length;ir++)Lt[ir]=It[ir];return w(this.tasks)},Xt.prototype.tap=function(It,Lt){this.tasks.length===0?this.tasks.push(function(ir){var Ar=Lt();ir(Ar?null:!1,Ar)}):this.tasks.push(function(ir,Ar){var nr=Lt();Ar(nr?null:!1,It)})},Xt}(),Ut=function(){function Xt(){for(var It=arguments,Lt=[],ir=0;ir<arguments.length;ir++)Lt[ir]=It[ir];this.tasks=[]}return Xt.prototype.call=function(){for(var It=arguments,Lt=[],ir=0;ir<arguments.length;ir++)Lt[ir]=It[ir];return kr(this.tasks)},Xt.prototype.tap=function(It,Lt){this.tasks.push(function(ir){var Ar=Lt();ir(Ar,It)})},Xt}()}).call(this,M("Q2Ig"))},yG8O:function(le,$){function M(j,Z,Y,k){!Y||Object.defineProperty(j,Z,{enumerable:Y.enumerable,configurable:Y.configurable,writable:Y.writable,value:Y.initializer?Y.initializer.call(k):void 0})}le.exports=M,le.exports.__esModule=!0,le.exports.default=le.exports},yHx3:function(le,$){var M=Object.prototype,j=M.hasOwnProperty;function Z(Y){var k=Y.length,h=new Y.constructor(k);return k&&typeof Y[0]=="string"&&j.call(Y,"index")&&(h.index=Y.index,h.input=Y.input),h}le.exports=Z},yMAV:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Plan=void 0;var j=function(){function Z(Y,k){this.parentContext=Y,this.rootRequest=k}return Z}();$.Plan=j},yP5f:function(le,$,M){var j=M("+K+b");function Z(Y,k){var h=k?j(Y.buffer):Y.buffer;return new Y.constructor(h,Y.byteOffset,Y.length)}le.exports=Z},yXPU:function(le,$){function M(Z,Y,k,h,V,H,te){try{var pe=Z[H](te),Oe=pe.value}catch(Ae){k(Ae);return}pe.done?Y(Oe):Promise.resolve(Oe).then(h,V)}function j(Z){return function(){var Y=this,k=arguments;return new Promise(function(h,V){var H=Z.apply(Y,k);function te(Oe){M(H,h,V,te,pe,"next",Oe)}function pe(Oe){M(H,h,V,te,pe,"throw",Oe)}te(void 0)})}}le.exports=j,le.exports.__esModule=!0,le.exports.default=le.exports},ycre:function(le,$,M){var j=M("711d"),Z=j("length");le.exports=Z},z4Hk:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingWhenSyntax=void 0;var j=M("406g"),Z=M("RR/i"),Y=function(){function k(h){this._binding=h}return k.prototype.when=function(h){return this._binding.constraint=h,new j.BindingOnSyntax(this._binding)},k.prototype.whenTargetNamed=function(h){return this._binding.constraint=Z.namedConstraint(h),new j.BindingOnSyntax(this._binding)},k.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(h){var V=h.target!==null&&!h.target.isNamed()&&!h.target.isTagged();return V},new j.BindingOnSyntax(this._binding)},k.prototype.whenTargetTagged=function(h,V){return this._binding.constraint=Z.taggedConstraint(h)(V),new j.BindingOnSyntax(this._binding)},k.prototype.whenInjectedInto=function(h){return this._binding.constraint=function(V){return Z.typeConstraint(h)(V.parentRequest)},new j.BindingOnSyntax(this._binding)},k.prototype.whenParentNamed=function(h){return this._binding.constraint=function(V){return Z.namedConstraint(h)(V.parentRequest)},new j.BindingOnSyntax(this._binding)},k.prototype.whenParentTagged=function(h,V){return this._binding.constraint=function(H){return Z.taggedConstraint(h)(V)(H.parentRequest)},new j.BindingOnSyntax(this._binding)},k.prototype.whenAnyAncestorIs=function(h){return this._binding.constraint=function(V){return Z.traverseAncerstors(V,Z.typeConstraint(h))},new j.BindingOnSyntax(this._binding)},k.prototype.whenNoAncestorIs=function(h){return this._binding.constraint=function(V){return!Z.traverseAncerstors(V,Z.typeConstraint(h))},new j.BindingOnSyntax(this._binding)},k.prototype.whenAnyAncestorNamed=function(h){return this._binding.constraint=function(V){return Z.traverseAncerstors(V,Z.namedConstraint(h))},new j.BindingOnSyntax(this._binding)},k.prototype.whenNoAncestorNamed=function(h){return this._binding.constraint=function(V){return!Z.traverseAncerstors(V,Z.namedConstraint(h))},new j.BindingOnSyntax(this._binding)},k.prototype.whenAnyAncestorTagged=function(h,V){return this._binding.constraint=function(H){return Z.traverseAncerstors(H,Z.taggedConstraint(h)(V))},new j.BindingOnSyntax(this._binding)},k.prototype.whenNoAncestorTagged=function(h,V){return this._binding.constraint=function(H){return!Z.traverseAncerstors(H,Z.taggedConstraint(h)(V))},new j.BindingOnSyntax(this._binding)},k.prototype.whenAnyAncestorMatches=function(h){return this._binding.constraint=function(V){return Z.traverseAncerstors(V,h)},new j.BindingOnSyntax(this._binding)},k.prototype.whenNoAncestorMatches=function(h){return this._binding.constraint=function(V){return!Z.traverseAncerstors(V,h)},new j.BindingOnSyntax(this._binding)},k}();$.BindingWhenSyntax=Y},zEVN:function(le,$,M){var j=M("Gi0A"),Z=M("sEf8"),Y=M("mdPL"),k=Y&&Y.isMap,h=k?Z(k):j;le.exports=h},zZ0H:function(le,$){function M(j){return j}le.exports=M},zoYe:function(le,$,M){var j=M("nmnc"),Z=M("eUgh"),Y=M("Z0cm"),k=M("/9aa"),h=1/0,V=j?j.prototype:void 0,H=V?V.toString:void 0;function te(pe){if(typeof pe=="string")return pe;if(Y(pe))return Z(pe,te)+"";if(k(pe))return H?H.call(pe):"";var Oe=pe+"";return Oe=="0"&&1/pe==-h?"-0":Oe}le.exports=te},zvhG:function(le,$){le.exports=M;function M(j,Z,Y,k){this.cx=3*j,this.bx=3*(Y-j)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*Z,this.by=3*(k-Z)-this.cy,this.ay=1-this.cy-this.by,this.p1x=j,this.p1y=k,this.p2x=Y,this.p2y=k}M.prototype.sampleCurveX=function(j){return((this.ax*j+this.bx)*j+this.cx)*j},M.prototype.sampleCurveY=function(j){return((this.ay*j+this.by)*j+this.cy)*j},M.prototype.sampleCurveDerivativeX=function(j){return(3*this.ax*j+2*this.bx)*j+this.cx},M.prototype.solveCurveX=function(j,Z){typeof Z=="undefined"&&(Z=1e-6);var Y,k,h,V,H;for(h=j,H=0;H<8;H++){if(V=this.sampleCurveX(h)-j,Math.abs(V)<Z)return h;var te=this.sampleCurveDerivativeX(h);if(Math.abs(te)<1e-6)break;h=h-V/te}if(Y=0,k=1,h=j,h<Y)return Y;if(h>k)return k;for(;Y<k;){if(V=this.sampleCurveX(h),Math.abs(V-j)<Z)return h;j>V?Y=h:k=h,h=(k-Y)*.5+Y}return h},M.prototype.solve=function(j,Z){return this.sampleCurveY(this.solveCurveX(j,Z))}},zxMA:function(le,$,M){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.QueryableString=void 0;var j=function(){function Z(Y){this.str=Y}return Z.prototype.startsWith=function(Y){return this.str.indexOf(Y)===0},Z.prototype.endsWith=function(Y){var k="",h=Y.split("").reverse().join("");return k=this.str.split("").reverse().join(""),this.startsWith.call({str:k},h)},Z.prototype.contains=function(Y){return this.str.indexOf(Y)!==-1},Z.prototype.equals=function(Y){return this.str===Y},Z.prototype.value=function(){return this.str},Z}();$.QueryableString=j}}]);
